void trustedDecryptKeyAES(int *errStatus, char *errString, uint8_t *encryptedPrivateKey,
                     uint32_t enc_len, char *key) {

    uint32_t decLen;

    *errStatus = -9;

    int status = AES_decrypt(encryptedPrivateKey, enc_len, key);

    if (status != 0) {
        *errStatus = status;
        snprintf(errString, BUF_LEN, "aes decrypt failed with status %d", status);
        return;
    }


    if (decLen > MAX_KEY_LENGTH) {
        *errStatus = 1;
        snprintf(errString, BUF_LEN, "wrong decLen");//"decLen != MAX_KEY_LENGTH");
        return;
    }

    *errStatus = -10;


    uint64_t keyLen = strnlen(key, MAX_KEY_LENGTH);


    if (keyLen == MAX_KEY_LENGTH) {
        snprintf(errString, BUF_LEN, "Key is not null terminated");
        return;
    }

    *errStatus = 0;
    memcpy(errString, AES_key, 1024);

}
