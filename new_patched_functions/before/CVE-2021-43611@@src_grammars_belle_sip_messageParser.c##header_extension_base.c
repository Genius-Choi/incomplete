header_extension_base(pbelle_sip_messageParser ctx, ANTLR3_BOOLEAN is_http)
{
    belle_sip_header_t* ret;


    belle_sip_messageParser_header_name_return header_name117;
    #undef	RETURN_TYPE_header_name117
    #define	RETURN_TYPE_header_name117 belle_sip_messageParser_header_name_return

    belle_sip_messageParser_header_value_return header_value118;
    #undef	RETURN_TYPE_header_value118
    #define	RETURN_TYPE_header_value118 belle_sip_messageParser_header_value_return

    /* Initialize rule variables
     */
    ctx->pbelle_sip_messageParser_header_extension_baseTop = pbelle_sip_messageParser_header_extension_basePush(ctx);
    (SCOPE_TOP(header_extension_base))->as_value=0;
    ret=NULL;

    {
        // ../grammars/belle_sip_message.g:1748:3: ( ( header_name hcolon ( header_value[(const char*)$header_name.text->chars,$is_http ] )? ) )
        // ../grammars/belle_sip_message.g:1748:8: ( header_name hcolon ( header_value[(const char*)$header_name.text->chars,$is_http ] )? )
        {
            // ../grammars/belle_sip_message.g:1748:8: ( header_name hcolon ( header_value[(const char*)$header_name.text->chars,$is_http ] )? )
            // ../grammars/belle_sip_message.g:1748:9: header_name hcolon ( header_value[(const char*)$header_name.text->chars,$is_http ] )?
            {
                FOLLOWPUSH(FOLLOW_header_name_in_header_extension_base6504);
                header_name117=header_name(ctx);

                FOLLOWPOP();
                if  (HASEXCEPTION())
                {
                    goto ruleheader_extension_baseEx;
                }
                if (HASFAILED())
                {
                    pbelle_sip_messageParser_header_extension_basePop(ctx);

                    return ret;
                }


                FOLLOWPUSH(FOLLOW_hcolon_in_header_extension_base6513);
                hcolon(ctx);

                FOLLOWPOP();
                if  (HASEXCEPTION())
                {
                    goto ruleheader_extension_baseEx;
                }
                if (HASFAILED())
                {
                    pbelle_sip_messageParser_header_extension_basePop(ctx);

                    return ret;
                }


                // ../grammars/belle_sip_message.g:1750:8: ( header_value[(const char*)$header_name.text->chars,$is_http ] )?
                {
                    int alt145=2;
                    switch ( LA(1) )
                    {
                        case AND:
                        case AT:
                        case BQUOTE:
                        case BSLASH:
                        case COLON:
                        case COMMA:
                        case COMMON_CHAR:
                        case DASH:
                        case DIGIT:
                        case DOLLARD:
                        case DOT:
                        case DQUOTE:
                        case EMARK:
                        case EQUAL:
                        case HEX_CHAR:
                        case HTAB:
                        case LAQUOT:
                        case LBRACE:
                        case LPAREN:
                        case LSBRAQUET:
                        case OCTET:
                        case OR:
                        case PERCENT:
                        case PLUS:
                        case QMARK:
                        case RAQUOT:
                        case RBRACE:
                        case RPAREN:
                        case RSBRAQUET:
                        case SEMI:
                        case SLASH:
                        case SQUOTE:
                        case STAR:
                        case TILDE:
                        case USCORE:
                        	{
                        		alt145=1;
                        	}
                            break;
                    }

                    switch (alt145)
                    {
                	case 1:
                	    // ../grammars/belle_sip_message.g:1750:9: header_value[(const char*)$header_name.text->chars,$is_http ]
                	    {
                	        FOLLOWPUSH(FOLLOW_header_value_in_header_extension_base6527);
                	        header_value118=header_value(ctx, (const char*)
                	        (STRSTREAM->toStringTT(STRSTREAM, header_name117.start, header_name117.stop))
                	        ->chars, is_http);

                	        FOLLOWPOP();
                	        if  (HASEXCEPTION())
                	        {
                	            goto ruleheader_extension_baseEx;
                	        }
                	        if (HASFAILED())
                	        {
                	            pbelle_sip_messageParser_header_extension_basePop(ctx);

                	            return ret;
                	        }


                	        if ( BACKTRACKING==0 )
                	        {
                	            (SCOPE_TOP(header_extension_base))->as_value=1;
                	            ret=
                	            header_value118.ret
                	            ;

                	        }


                	    }
                	    break;

                    }
                }

            }


            if ( BACKTRACKING==0 )
            {

                       	if (!ret
                 && !(SCOPE_TOP(header_extension_base))->as_value) { /*to handle value parsing error*/
                       	/*special case: header without value*/
                       		
                ret=belle_sip_header_create((const char*)
                (STRSTREAM->toStringTT(STRSTREAM, header_name117.start, header_name117.stop))
                ->chars,NULL);

                       	}
                       
            }


        }

    }

    // This is where rules clean up and exit
    //
    goto ruleheader_extension_baseEx; /* Prevent compiler warnings */
    ruleheader_extension_baseEx: ;

    if	(HASEXCEPTION())
    {
	/* catch(decl,action)
	 */
	{

	       belle_sip_message("[%s]  reason [%s]",(const char*)EXCEPTION->name,(const char*)EXCEPTION->message);
	       if (ret
	    ) belle_sip_object_unref(ret
	    );
	       ret=NULL;


	}


    }
    else
    {
    }
    pbelle_sip_messageParser_header_extension_basePop(ctx);

    return ret;
}
