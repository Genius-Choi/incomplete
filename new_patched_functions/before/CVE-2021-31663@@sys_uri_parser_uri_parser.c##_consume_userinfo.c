void _consume_userinfo(uri_parser_result_t *result, char *uri,
                       char *authority_end)
{
    /* check for userinfo within authority */
    char *userinfo_end = _strchrb(uri, authority_end, '@');

    /* check if match */
    if (userinfo_end) {
        result->userinfo = uri;
        result->userinfo_len = userinfo_end - uri;
        /* shift host part beyond userinfo and '@' */
        result->host += result->userinfo_len + 1;
        result->host_len -= result->userinfo_len + 1;
    }
}
