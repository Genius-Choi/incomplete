void HHVM_FUNCTION(closedir,
                   const Variant& dir_handle /* = null */) {
  const Resource& res_dir_handle = dir_handle.isNull()
                                 ? null_resource
                                 : dir_handle.toResource();
  auto d = get_dir(res_dir_handle);
  if (!d) {
    return;
  }
  if (s_directory_data->defaultDirectory == d) {
    s_directory_data->defaultDirectory = nullptr;
  }
  d->close();
}
