trustedGetBlsPubKeyAES(int *errStatus, char *errString, uint8_t *encryptedPrivateKey, uint64_t key_len, char *bls_pub_key) {

    LOG_DEBUG (__FUNCTION__);

    char skey_hex[ECDSA_SKEY_LEN];

    uint32_t len = key_len;

    int status = AES_decrypt(encryptedPrivateKey, key_len, skey_hex);
    if (status != SGX_SUCCESS) {
        *errStatus = 1;
        snprintf(errString, BUF_LEN, "aes_decrypt failed with status %d", status);
        return;
    }

    skey_hex[ECDSA_SKEY_LEN - 1] = 0;

    if (calc_bls_public_key(skey_hex, bls_pub_key) != 0) {
        *errStatus = -1;
        snprintf(errString, BUF_LEN, "could not calculate bls public key");
        return;
    }
}
