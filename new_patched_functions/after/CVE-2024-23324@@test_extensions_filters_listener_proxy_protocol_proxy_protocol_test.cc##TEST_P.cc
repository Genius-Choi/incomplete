TEST_P(WildcardProxyProtocolTest, BasicV6) {
  connect();
  write("PROXY TCP6 1:2:3::4 5:6::7:8 65535 1234\r\nmore data");

  expectData("more data");

  EXPECT_EQ(server_connection_->connectionInfoProvider().remoteAddress()->asString(),
            "[1:2:3::4]:65535");
  EXPECT_EQ(server_connection_->connectionInfoProvider().localAddress()->asString(),
            "[5:6::7:8]:1234");
  EXPECT_TRUE(server_connection_->connectionInfoProvider().localAddressRestored());

  disconnect();
}
