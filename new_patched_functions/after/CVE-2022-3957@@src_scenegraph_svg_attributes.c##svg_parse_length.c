static u32 svg_parse_length(SVG_Number *number, char *value_string, Bool clamp0to1, GF_Err *out_e)
{
	char c = '\0';
	char *unit = NULL;
	u32 len = 0;
	u32 unit_pos = 0;
	u32 unit_len = 0;
	u32 read_chars;
	if (!number || !value_string) return 0;

	if (!strcmp(value_string, "inherit")) {
		number->type = SVG_NUMBER_INHERIT;
		return 7;
	} else if (!strcmp(value_string, "auto")) {
		number->type = SVG_NUMBER_AUTO;
		return 4;
	} else if (!strcmp(value_string, "auto-reverse")) {
		number->type = SVG_NUMBER_AUTO_REVERSE;
		return 12;
	} else if ((unit = strstr(value_string, "%")) ) {
		number->type = SVG_NUMBER_PERCENTAGE;
		unit_len = 1;
	} else if ((unit = strstr(value_string, "em"))) {
		number->type = SVG_NUMBER_EMS;
	} else if ((unit = strstr(value_string, "ex"))) {
		number->type = SVG_NUMBER_EXS;
	} else if ((unit = strstr(value_string, "px"))) {
		number->type = SVG_NUMBER_PX;
	} else if ((unit = strstr(value_string, "cm"))) {
		number->type = SVG_NUMBER_CM;
	} else if ((unit = strstr(value_string, "mm"))) {
		number->type = SVG_NUMBER_MM;
	} else if ((unit = strstr(value_string, "in"))) {
		number->type = SVG_NUMBER_IN;
	} else if ((unit = strstr(value_string, "pt"))) {
		number->type = SVG_NUMBER_PT;
	} else if ((unit = strstr(value_string, "pc"))) {
		number->type = SVG_NUMBER_PC;
	} else {
		number->type = SVG_NUMBER_VALUE;
	}
	if (unit) {
		if (!unit_len) unit_len = 2;
		unit_pos = (u32) (unit - value_string);
		/* setting the first unit character to 0 for the svg_parse_number method to finish */
		c = value_string[unit_pos];
		value_string[unit_pos] = 0;
	}
	read_chars = svg_parse_number(value_string, &(number->value), 0, out_e);
	if (unit) {
		value_string[unit_pos] = c;
	}
	if (!read_chars) {
		GF_LOG(GF_LOG_ERROR, GF_LOG_PARSER, ("[SVG Parsing] Error in parsing: %s\n", value_string));
		len = 0;
		*out_e = GF_NON_COMPLIANT_BITSTREAM;
	} else {
		len = unit_len + read_chars;
	}

	if (clamp0to1) number->value = MAX(0, MIN(1, number->value));
	return len;
}
