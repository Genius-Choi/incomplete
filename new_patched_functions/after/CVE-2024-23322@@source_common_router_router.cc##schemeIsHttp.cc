bool schemeIsHttp(const Http::RequestHeaderMap& downstream_headers,
                  OptRef<const Network::Connection> connection) {
  if (Http::Utility::schemeIsHttp(downstream_headers.getSchemeValue())) {
    return true;
  }
  if (connection.has_value() && !connection->ssl()) {
    return true;
  }
  return false;
}
