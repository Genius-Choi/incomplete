test_iov_large_asn1_wrapper(gss_ctx_id_t ctx)
{
    OM_uint32 minor, major;
    uint8_t databuf[10] = { 0 };
    gss_iov_buffer_desc iov[2];

    /*
     * In this IOV array, the header contains a DER tag with a dangling eight
     * bytes of length field.  The data IOV indicates a total token length
     * sufficient to contain the length bytes.
     */
    iov[0].type = GSS_IOV_BUFFER_TYPE_HEADER;
    iov[0].buffer.value = ealloc(2);
    iov[0].buffer.length = 2;
    memcpy(iov[0].buffer.value, "\x60\x88", 2);
    iov[1].type = GSS_IOV_BUFFER_TYPE_DATA;
    iov[1].buffer.value = databuf;
    iov[1].buffer.length = 10;
    major = gss_unwrap_iov(&minor, ctx, NULL, NULL, iov, 2);
    if (major != GSS_S_DEFECTIVE_TOKEN)
        abort();
    free(iov[0].buffer.value);
}
