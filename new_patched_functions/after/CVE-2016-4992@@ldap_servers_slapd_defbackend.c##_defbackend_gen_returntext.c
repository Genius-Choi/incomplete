_defbackend_gen_returntext(char *buffer, size_t buflen, char **dns)
{
    int dnidx;
    int sidx;
    struct suffix_repeat {
        char *suffix;
        int size;
    } candidates[] = {
        {"dc=", 3}, /* dc could be repeated.  otherwise the last rdn is used. */
        {NULL, 0}
    };
    PR_snprintf(buffer, buflen, "%s (", DEFBE_NO_SUCH_SUFFIX);
    for (dnidx = 0; dns[dnidx]; dnidx++) ; /* finding the last */
    dnidx--; /* last rdn */
    for (sidx = 0; candidates[sidx].suffix; sidx++) {
        if (!PL_strncasecmp(dns[dnidx], candidates[sidx].suffix, candidates[sidx].size)) {
            while (!PL_strncasecmp(dns[--dnidx], candidates[sidx].suffix, candidates[sidx].size)) ;
            PL_strcat(buffer, dns[++dnidx]); /* the first "dn=", e.g. */
            for (++dnidx; dns[dnidx]; dnidx++) {
                PL_strcat(buffer, ",");
                PL_strcat(buffer, dns[dnidx]);
            }
            PL_strcat(buffer, ")");
            return; /* finished the task */
        }
    }
    PL_strcat(buffer, dns[dnidx]);
    PL_strcat(buffer, ")");
    return;
}
