main(int argc, char **argv)
{
    krb5_keyblock kb;
    krb5_key cfx_subkey;
    gss_ctx_id_t ctx;
    size_t i;

    kb.enctype = ENCTYPE_AES128_CTS_HMAC_SHA1_96;
    kb.length = 16;
    kb.contents = (unsigned char *)"1234567887654321";
    if (krb5_k_create_key(NULL, &kb, &cfx_subkey) != 0)
        abort();

    ctx = make_fake_cfx_context(cfx_subkey);
    test_bogus_1964_token(ctx);
    test_cfx_altered_ec(ctx, cfx_subkey);
    test_cfx_short_plaintext(ctx, cfx_subkey);
    test_cfx_large_ec(ctx, cfx_subkey);
    test_iov_large_asn1_wrapper(ctx);
    free_fake_context(ctx);

    for (i = 0; i < sizeof(tests) / sizeof(*tests); i++) {
        ctx = make_fake_context(&tests[i]);
        test_short_header(ctx);
        test_short_header_iov(ctx, &tests[i]);
        test_short_checksum(ctx, &tests[i]);
        test_bad_pad(ctx, &tests[i]);
        free_fake_context(ctx);
    }

    test_short_encapsulation();

    return 0;
}
