static int start_connection(uint32_t *client_id) {
	// clear any previous garbage in errno for error returns
	errno = 0;

	// open character device
	int _cleanup_close_ fd = open("/dev/vboxguest", O_RDWR | O_CLOEXEC);
	if (fd == -1) {
		return VERR_GENERAL_FAILURE;
	}

	// negotiate protocol version
	int ret = version_info(fd);
	if (ret != VINF_SUCCESS) {
		return ret;
	}

	// connect to property service
	ret = connect(fd, client_id);
	if (ret != VINF_SUCCESS) {
		return ret;
	}

	// return fd
	ret = fd;
	fd = -1;
	return ret;
}
