static int cjwt_update_key( cjwt_t *p_cjwt, const uint8_t *key, size_t key_len )
{
    int ret = 0;

    if( ( NULL != key ) && ( key_len > 0 ) ) {
        p_cjwt->header.key = malloc( key_len );

        if( !p_cjwt->header.key ) {
            ret = ENOMEM;
            return ret;
        }

        memcpy( p_cjwt->header.key, key, key_len );
        p_cjwt->header.key_len = key_len;
    }

    return ret;
}
