sslmodule_init_types(PyObject *module)
{
    PySSLContext_Type = (PyTypeObject *)PyType_FromModuleAndSpec(
        module, &PySSLContext_spec, NULL
    );
    if (PySSLContext_Type == NULL)
        return -1;

    PySSLSocket_Type = (PyTypeObject *)PyType_FromModuleAndSpec(
        module, &PySSLSocket_spec, NULL
    );
    if (PySSLSocket_Type == NULL)
        return -1;

    PySSLMemoryBIO_Type = (PyTypeObject *)PyType_FromModuleAndSpec(
        module, &PySSLMemoryBIO_spec, NULL
    );
    if (PySSLMemoryBIO_Type == NULL)
        return -1;

    PySSLSession_Type = (PyTypeObject *)PyType_FromModuleAndSpec(
        module, &PySSLSession_spec, NULL
    );
    if (PySSLSession_Type == NULL)
        return -1;

    if (PyModule_AddType(module, PySSLContext_Type))
        return -1;
    if (PyModule_AddType(module, PySSLSocket_Type))
        return -1;
    if (PyModule_AddType(module, PySSLMemoryBIO_Type))
        return -1;
    if (PyModule_AddType(module, PySSLSession_Type))
        return -1;

    return 0;
}
