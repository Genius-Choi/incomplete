free_json_items(struct json_item_list *items)
{
    struct json_item *item;
    debug_decl(free_json_items, SUDO_DEBUG_UTIL);

    while ((item = TAILQ_FIRST(items)) != NULL) {
	TAILQ_REMOVE(items, item, entries);
	switch (item->type) {
	case JSON_STRING:
	    free(item->u.string);
	    break;
	case JSON_ARRAY:
	case JSON_OBJECT:
	    free_json_items(&item->u.child.items);
	    break;
	case JSON_ID:
	case JSON_NUMBER:
	case JSON_BOOL:
	case JSON_NULL:
	    /* Nothing to free. */
	    break;
	default:
	    sudo_warnx("%s: internal error, invalid JSON type %d",
		__func__, item->type);
	    break;
	}
	free(item->name);
	free(item);
    }

    debug_return;
}
