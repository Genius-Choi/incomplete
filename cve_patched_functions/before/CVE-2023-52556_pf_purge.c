pf_purge(void *null)
{
	unsigned int interval = max(1, pf_default_rule.timeout[PFTM_INTERVAL]);

	PF_LOCK();

	pf_purge_expired_src_nodes();

	PF_UNLOCK();
 
	/*
	 * Fragments don't require PF_LOCK(), they use their own lock.
	 */
	pf_purge_expired_fragments();
 
	/* interpret the interval as idle time between runs */
	timeout_add_sec(&pf_purge_to, interval);
}
