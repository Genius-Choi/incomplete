static int is_sig_alg_valid(struct _oidc_config * config, json_t * j_client, jwa_alg alg, int auth_type) {
  int is_valid = 1;

  switch (auth_type) {
    case GLEWLWYD_AUTH_REQUEST_OBJECT:
      if (json_object_get(j_client, "request_object_signing_alg") != NULL) {
        if (r_str_to_jwa_alg(json_string_value(json_object_get(j_client, "request_object_signing_alg"))) != alg) {
          y_log_message(Y_LOG_LEVEL_DEBUG, "is_sig_alg_valid - Error request_object_signing_alg invalid for client %s", json_string_value(json_object_get(j_client, "client_id")));
          is_valid = 0;
        }
      } else if (json_object_get(config->j_params, "request-parameter-ietf-strict") == json_true()) {
        y_log_message(Y_LOG_LEVEL_DEBUG, "is_sig_alg_valid - Error client %s has no property request_object_signing_alg", json_string_value(json_object_get(j_client, "client_id")));
        is_valid = 0;
      }
      break;
    case GLEWLWYD_AUTH_TOKEN_ENDPOINT:
      if (json_object_get(j_client, "token_endpoint_signing_alg") != NULL) {
        if (r_str_to_jwa_alg(json_string_value(json_object_get(j_client, "token_endpoint_signing_alg"))) != alg) {
          y_log_message(Y_LOG_LEVEL_DEBUG, "is_sig_alg_valid - Error token_endpoint_signing_alg invalid for client %s", json_string_value(json_object_get(j_client, "client_id")));
          is_valid = 0;
        }
      } else if (json_object_get(config->j_params, "request-parameter-ietf-strict") == json_true()) {
        y_log_message(Y_LOG_LEVEL_DEBUG, "is_sig_alg_valid - Error client %s has no property token_endpoint_signing_alg", json_string_value(json_object_get(j_client, "client_id")));
        is_valid = 0;
      }
      break;
    case GLEWLWYD_AUTH_CIBA:
      if (json_object_get(j_client, "backchannel_authentication_request_signing_alg") != NULL) {
        if (r_str_to_jwa_alg(json_string_value(json_object_get(j_client, "backchannel_authentication_request_signing_alg"))) != alg) {
          y_log_message(Y_LOG_LEVEL_DEBUG, "is_sig_alg_valid - Error backchannel_authentication_request_signing_alg invalid for client %s", json_string_value(json_object_get(j_client, "client_id")));
          is_valid = 0;
        }
      } else if (json_object_get(config->j_params, "request-parameter-ietf-strict") == json_true()) {
        y_log_message(Y_LOG_LEVEL_DEBUG, "is_sig_alg_valid - Error client %s has no property backchannel_authentication_request_signing_alg", json_string_value(json_object_get(j_client, "client_id")));
        is_valid = 0;
      }
      break;
    default:
      is_valid = 0;
      break;
  }
  return is_valid;
}
