bool ServerConnectionImpl::checkInboundFrameLimits() {
  ASSERT(dispatching_downstream_data_);

  if (consecutive_inbound_frames_with_empty_payload_ >
      max_consecutive_inbound_frames_with_empty_payload_) {
    ENVOY_CONN_LOG(trace,
                   "error reading frame: Too many consecutive frames with an empty payload "
                   "received in this HTTP/2 session.",
                   connection_);
    stats_.inbound_empty_frames_flood_.inc();
    return false;
  }

  if (inbound_priority_frames_ > max_inbound_priority_frames_per_stream_ * (1 + inbound_streams_)) {
    ENVOY_CONN_LOG(trace,
                   "error reading frame: Too many PRIORITY frames received in this HTTP/2 session.",
                   connection_);
    stats_.inbound_priority_frames_flood_.inc();
    return false;
  }

  if (inbound_window_update_frames_ >
      1 + 2 * (inbound_streams_ +
               max_inbound_window_update_frames_per_data_frame_sent_ * outbound_data_frames_)) {
    ENVOY_CONN_LOG(
        trace,
        "error reading frame: Too many WINDOW_UPDATE frames received in this HTTP/2 session.",
        connection_);
    stats_.inbound_window_update_frames_flood_.inc();
    return false;
  }

  return true;
}
