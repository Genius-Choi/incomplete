extern "C" HRESULT DAPI CoreWaitForUnelevatedLoggingThread(
    __in HANDLE hUnelevatedLoggingThread
    )
{
    HRESULT hr = S_OK;

    if (INVALID_HANDLE_VALUE == hUnelevatedLoggingThread)
    {
        ExitFunction();
    }

    // Give the thread 15 seconds to exit.
    hr = AppWaitForSingleObject(hUnelevatedLoggingThread, 15 * 1000);
    ExitOnFailure(hr, "Failed to wait for unelevated logging thread.");

LExit:
    return hr;
}
