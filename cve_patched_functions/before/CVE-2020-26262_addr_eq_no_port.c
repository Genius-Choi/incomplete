int addr_eq_no_port(const ioa_addr* a1, const ioa_addr *a2) {

  if(!a1) return (!a2);
  else if(!a2) return (!a1);
  
  if(a1->ss.sa_family == a2->ss.sa_family) {
    if(a1->ss.sa_family == AF_INET) {
      if((int)a1->s4.sin_addr.s_addr == (int)a2->s4.sin_addr.s_addr) {
	return 1;
      }
    } else if(a1->ss.sa_family == AF_INET6) {
      if( memcmp(&(a1->s6.sin6_addr), &(a2->s6.sin6_addr) ,sizeof(struct in6_addr)) == 0 ) {
        return 1;
      }
    }
  }
  return 0;
}
