static int tcpopt_len_check(uint32_t *idx, uint8_t len, uint8_t expected)
{
    if (len != expected) {
        if (len < 2)
            return -1;
        *idx = *idx + len - 2;
        return -1;
    }

    return 0;
}
