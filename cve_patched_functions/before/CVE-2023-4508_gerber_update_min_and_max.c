gerber_update_min_and_max(gerbv_render_size_t *boundingBox,
			  gdouble x, gdouble y, gdouble apertureSizeX1,
			  gdouble apertureSizeX2,gdouble apertureSizeY1,
			  gdouble apertureSizeY2)
{
    gdouble ourX1 = x - apertureSizeX1, ourY1 = y - apertureSizeY1;
    gdouble ourX2 = x + apertureSizeX2, ourY2 = y + apertureSizeY2;
    
    /* transform the point to the final rendered position, accounting
       for any scaling, offsets, mirroring, etc */
    /* NOTE: we need to already add/subtract in the aperture size since
       the final rendering may be scaled */
    cairo_matrix_transform_point (&currentMatrix, &ourX1, &ourY1);
    cairo_matrix_transform_point (&currentMatrix, &ourX2, &ourY2);

    /* check both points against the min/max, since depending on the rotation,
       mirroring, etc, either point could possibly be a min or max */

    boundingBox->left =   MIN(boundingBox->left,   ourX1);
    boundingBox->left =   MIN(boundingBox->left,   ourX2);
    boundingBox->right =  MAX(boundingBox->right,  ourX1);
    boundingBox->right =  MAX(boundingBox->right,  ourX2);
    boundingBox->bottom = MIN(boundingBox->bottom, ourY1);
    boundingBox->bottom = MIN(boundingBox->bottom, ourY2);
    boundingBox->top =    MAX(boundingBox->top,    ourY1);
    boundingBox->top =    MAX(boundingBox->top,    ourY2);
} /* gerber_update_min_and_max */
