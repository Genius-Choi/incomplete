static bool get_versym_entry_sdb_from_verneed(ELFOBJ *bin, Sdb *sdb, const char *key, Elf_(Versym) versym) {
	ut64 verneed_addr;
	ut64 verneed_num;

	if (!Elf_(rz_bin_elf_get_dt_info)(bin, DT_VERNEED, &verneed_addr) || !Elf_(rz_bin_elf_get_dt_info)(bin, DT_VERNEEDNUM, &verneed_num)) {
		return false;
	}

	ut64 verneed_offset = Elf_(rz_bin_elf_v2p(bin, verneed_addr));

	if (verneed_offset == UT64_MAX) {
		return false;
	}

	ut64 verneed_entry_offset = verneed_offset;

	for (size_t i = 0; i < verneed_num; i++) {
		Elf_(Verneed) verneed_entry;
		if (!get_verneed_entry(bin, verneed_entry_offset, &verneed_entry)) {
			return false;
		}

		ut64 vernaux_entry_offset = verneed_entry_offset + verneed_entry.vn_aux;

		for (size_t j = 0; j < verneed_entry.vn_cnt; j++) {
			Elf_(Vernaux) vernaux_entry;
			if (!get_vernaux_entry(bin, vernaux_entry_offset, &vernaux_entry)) {
				return false;
			}

			if (vernaux_entry.vna_other != versym) {
				vernaux_entry_offset += vernaux_entry.vna_next;
				continue;
			}

			const char *tmp = Elf_(rz_bin_elf_strtab_get)(bin->dynstr, vernaux_entry.vna_name);
			if (!tmp) {
				return false;
			}

			char *value = rz_str_newf("%u (%s)", versym & VERSYM_VERSION, tmp);
			if (!value) {
				return false;
			}

			if (!sdb_set_owned(sdb, key, value, 0)) {
				return false;
			}

			return true;
		}

		verneed_entry_offset += verneed_entry.vn_next;
	}

	return false;
}
