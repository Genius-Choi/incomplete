build_ha_chassis_group_ref_chassis(struct ovsdb_idl_index *ha_ch_grp_by_name,
                                   struct hmapx *lr_groups,
                                   struct shash *ha_ref_chassis_map)
{
    struct hmapx_node *node;

    HMAPX_FOR_EACH (node, lr_groups) {
        struct lrouter_group *lr_group = node->data;
        const char *ha_group_name;

        SSET_FOR_EACH (ha_group_name, &lr_group->ha_chassis_groups) {
            const struct sbrec_ha_chassis_group *sb_ha_chassis_grp;

            sb_ha_chassis_grp = ha_chassis_group_lookup_by_name(
                                    ha_ch_grp_by_name, ha_group_name);
            if (!sb_ha_chassis_grp) {
                continue;
            }

            struct ha_ref_chassis_info *ref_ch_info =
                shash_find_data(ha_ref_chassis_map, sb_ha_chassis_grp->name);
            ovs_assert(ref_ch_info);

            add_to_ha_ref_chassis_info(ref_ch_info, &lr_group->tmp_ha_chassis);
        }

        hmapx_destroy(&lr_group->tmp_ha_chassis);
        hmapx_init(&lr_group->tmp_ha_chassis);
    }
}
