int cp_pbpsi_gen(bn_t sk, g1_t ss, g2_t s[], size_t m) {
	int i, result = RLC_OK;
	bn_t q;

	bn_null(q);

	RLC_TRY {
		bn_new(q);

		pc_get_ord(q);
		bn_rand_mod(sk, q);
		g1_mul_gen(ss, sk);

		g2_get_gen(s[0]);
		for (i = 1; i <= m; i++) {
			g2_mul(s[i], s[i - 1], sk);
		}
	}
	RLC_CATCH_ANY {
		result = RLC_ERR;
	}
	RLC_FINALLY {
		bn_free(q);
	}
	return result;
}
