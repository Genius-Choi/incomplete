int main(void) {
	int r0, r1;
	if (core_init() != RLC_OK) {
		core_clean();
		return 1;
	}

	conf_print();

	util_banner("Benchmarks for the EPX module:", 0);

	if (ep_param_set_any_pairf() != RLC_OK) {
		RLC_THROW(ERR_NO_CURVE);
		core_clean();
		return 0;
	}

	if ((r0 = ep2_curve_is_twist())) {
		ep_param_print();

		util_banner("Utilities:", 1);
		memory2();
		util2();

		util_banner("Arithmetic:", 1);
		arith2();
	}

	if ((r1 = ep4_curve_is_twist())) {
		ep_param_print();

		util_banner("Utilities:", 1);
		memory4();
		util4();

		util_banner("Arithmetic:", 1);
		arith4();
	}

	if (!r0 && !r1) {
		RLC_THROW(ERR_NO_CURVE);
		core_clean();
		return 0;
	}

	core_clean();
	return 0;
}
