char *cpdbPrintFile(cpdb_printer_obj_t *p,
                    const char *file_path)
{
    char *jobid, *absolute_file_path;
    GError *error = NULL;
    
    absolute_file_path = cpdbGetAbsolutePath(file_path);
    logdebug("Printing file %s on %s %s\n",
                absolute_file_path, p->id, p->backend_name);
    cpdbDebugPrintSettings(p->settings);
    print_backend_call_print_file_sync(p->backend_proxy,
                                       p->id,
                                       absolute_file_path,
                                       p->settings->count,
                                       cpdbSerializeToGVariant(p->settings),
                                       "final-file-path-not-required",
                                       &jobid,
                                       NULL,
                                       &error);
                                       
    if (error)
    {
        logerror("Error printing file %s on %s %s : %s\n", 
                    absolute_file_path, p->id, p->backend_name, error->message);
        return NULL;
    }
    
    if (jobid == NULL || jobid == "")
    {
        logerror("Error printing file %s on %s %s : Couldn't create a job\n", 
                    absolute_file_path, p->id, p->backend_name);
        return NULL;
    }
    
    loginfo("File %s sent for printing on %s %s successfully\n",
                absolute_file_path, p->id, p->backend_name);
    cpdbSaveSettingsToDisk(p->settings);
    free(absolute_file_path);
    return jobid;
}
