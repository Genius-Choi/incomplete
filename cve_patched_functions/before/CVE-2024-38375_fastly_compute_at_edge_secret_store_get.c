bool fastly_compute_at_edge_secret_store_get(
    fastly_compute_at_edge_secret_store_store_handle_t store, fastly_world_string_t *key,
    fastly_world_option_secret_handle_t *ret, fastly_compute_at_edge_types_error_t *err) {
  ret->val = INVALID_HANDLE;
  bool ok = convert_result(
      fastly::secret_store_get(store, reinterpret_cast<char *>(key->ptr), key->len, &ret->val),
      err);
  if ((!ok && *err == FASTLY_COMPUTE_AT_EDGE_TYPES_ERROR_OPTIONAL_NONE) ||
      ret->val == INVALID_HANDLE) {
    ret->is_some = false;
    return true;
  }
  ret->is_some = true;
  return ok;
}
