uint32_t mobi_get_exthsize(const MOBIData *m) {
    if (m == NULL || m->eh == NULL) {
        return 0;
    }
    size_t size = 0;
    MOBIExthHeader *curr = m->eh;
    while (curr) {
        size += curr->size + 8;
        curr = curr->next;
    }
    if (size > 0) {
        /* add header size */
        size += 12;
        /* add padding */
        size += size % 4;
    }
    if (size > UINT32_MAX) {
        return 0;
    }
    return (uint32_t) size;
}
