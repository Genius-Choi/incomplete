static int simultaneous1(void) {
	int code = RLC_ERR;
	g1_t p, q, r;
	bn_t n, k, l;

	bn_null(n);
	bn_null(k);
	bn_null(l);
	g1_null(p);
	g1_null(q);
	g1_null(r);

	RLC_TRY {
		bn_new(n);
		bn_new(k);
		bn_new(l);
		g1_new(p);
		g1_new(q);
		g1_new(r);

		g1_get_gen(p);
		pc_get_ord(n);

		TEST_CASE("simultaneous point multiplication is correct") {
			bn_zero(k);
			bn_rand_mod(l, n);
			g1_mul(q, p, l);
			g1_mul_sim(r, p, k, p, l);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_rand_mod(k, n);
			bn_zero(l);
			g1_mul(q, p, k);
			g1_mul_sim(r, p, k, p, l);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_rand_mod(k, n);
			bn_rand_mod(l, n);
			g1_mul_sim(r, p, k, q, l);
			g1_mul(p, p, k);
			g1_mul(q, q, l);
			g1_add(q, q, p);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_neg(k, k);
			g1_mul_sim(r, p, k, q, l);
			g1_mul(p, p, k);
			g1_mul(q, q, l);
			g1_add(q, q, p);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_neg(l, l);
			g1_mul_sim(r, p, k, q, l);
			g1_mul(p, p, k);
			g1_mul(q, q, l);
			g1_add(q, q, p);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("simultaneous multiplication with generator is correct") {
			bn_zero(k);
			bn_rand_mod(l, n);
			g1_mul(q, p, l);
			g1_mul_sim_gen(r, k, p, l);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_rand_mod(k, n);
			bn_zero(l);
			g1_mul_gen(q, k);
			g1_mul_sim_gen(r, k, p, l);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_rand_mod(k, n);
			bn_rand_mod(l, n);
			g1_mul_sim_gen(r, k, q, l);
			g1_get_gen(p);
			g1_mul_sim(q, p, k, q, l);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_neg(k, k);
			g1_mul_sim_gen(r, k, q, l);
			g1_get_gen(p);
			g1_mul_sim(q, p, k, q, l);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_neg(l, l);
			g1_mul_sim_gen(r, k, q, l);
			g1_get_gen(p);
			g1_mul_sim(q, p, k, q, l);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
		} TEST_END;
	}
	RLC_CATCH_ANY {
		util_print("FATAL ERROR!\n");
		RLC_ERROR(end);
	}
	code = RLC_OK;
  end:
	bn_free(n);
	bn_free(k);
	bn_free(l);
	g1_free(p);
	g1_free(q);
	g1_free(r);
	return code;
}
