NOEXPORT int ecdh_init(SERVICE_OPTIONS *section) {
    s_log(LOG_DEBUG, "ECDH initialization");
    if(!SSL_CTX_set1_groups_list(section->ctx, section->curves)) {
#if OPENSSL_VERSION_NUMBER >= 0x10101000L
        sslerror("SSL_CTX_set1_groups_list");
#endif /* OpenSSL version >= 1.1.1 */
        return 1; /* FAILED */
    }
    s_log(LOG_DEBUG, "ECDH initialized with curves %s", section->curves);
    return 0; /* OK */
}
