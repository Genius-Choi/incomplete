encode_CHECK_PKT_LARGER(const struct ofpact_check_pkt_larger *check_pkt_larger,
                 enum ofp_version ofp_version OVS_UNUSED,
                 struct ofpbuf *out)
{
    struct nx_action_check_pkt_larger *ncpl = put_NXAST_CHECK_PKT_LARGER(out);
    ncpl->pkt_len = htons(check_pkt_larger->pkt_len);
    ncpl->offset = htons(check_pkt_larger->dst.ofs);

    if (check_pkt_larger->dst.field) {
        size_t size = out->size;
        out->size = size - sizeof ncpl->pad;
        nx_put_mff_header(out, check_pkt_larger->dst.field, 0, false);
        out->size = size;
    }
}
