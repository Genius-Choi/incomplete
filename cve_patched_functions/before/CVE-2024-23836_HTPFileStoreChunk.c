int HTPFileStoreChunk(
        HtpState *s, HtpTxUserData *tx, const uint8_t *data, uint32_t data_len, uint8_t direction)
{
    SCEnter();

    int retval = 0;
    int result = 0;
    FileContainer *files = NULL;

    if (direction & STREAM_TOCLIENT) {
        files = &tx->files_tc;
    } else {
        files = &tx->files_ts;
    }
    SCLogDebug("files %p data %p data_len %" PRIu32, files, data, data_len);

    if (files == NULL) {
        SCLogDebug("no files in state");
        retval = -1;
        goto end;
    }

    if (tx->file_range != NULL) {
        if (HttpRangeAppendData(&htp_sbcfg, tx->file_range, data, data_len) < 0) {
            SCLogDebug("Failed to append data");
        }
    }

    result = FileAppendData(files, &htp_sbcfg, data, data_len);
    if (result == -1) {
        SCLogDebug("appending data failed");
        retval = -1;
    } else if (result == -2) {
        retval = -2;
    }
    SCLogDebug("result %u", result);

end:
    SCReturnInt(retval);
}
