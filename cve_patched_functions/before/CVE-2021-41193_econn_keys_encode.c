static int econn_keys_encode(struct json_object *jobj,
			     const struct list *keyl)
{
	struct le *le;
	struct json_object *jkeys;
	int err = 0;

	jkeys = jzon_alloc_array();
	if (!jkeys)
		return ENOMEM;
	
	LIST_FOREACH(keyl, le) {
		struct econn_key_info *key = le->data;
		struct json_object *jkey;

		jkey = jzon_alloc_object();
		if (!jkey) {
			err = ENOMEM;
			goto out;
		}
		jzon_add_int(jkey, "idx", key->idx);
		jzon_add_base64(jkey, "data",
				key->data, key->dlen);

		json_object_array_add(jkeys, jkey);
	}

	json_object_object_add(jobj, "keys", jkeys);

 out:
	return err;
}
