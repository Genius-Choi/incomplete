uint8_t BraveContentBrowserClient::WorkerGetBraveFarblingLevel(
    const GURL& url,
    content::BrowserContext* browser_context) {
  HostContentSettingsMap* host_content_settings_map =
      HostContentSettingsMapFactory::GetForProfile(browser_context);
  const bool shields_up =
      brave_shields::GetBraveShieldsEnabled(host_content_settings_map, url);
  if (!shields_up)
    return BraveFarblingLevel::OFF;
  auto fingerprinting_type = brave_shields::GetFingerprintingControlType(
      host_content_settings_map, url);
  if (fingerprinting_type == ControlType::BLOCK)
    return BraveFarblingLevel::MAXIMUM;
  if (fingerprinting_type == ControlType::ALLOW)
    return BraveFarblingLevel::OFF;
  return BraveFarblingLevel::BALANCED;
}
