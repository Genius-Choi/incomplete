void trustedGenDkgSecret(int *errStatus, char *errString, uint8_t *encrypted_dkg_secret, uint32_t *enc_len, size_t _t) {

    LOG_DEBUG (__FUNCTION__);

    char dkg_secret[DKG_BUFER_LENGTH];

    if (gen_dkg_poly(dkg_secret, _t) != 0) {
        *errStatus = -1;
        return;
    }

    snprintf(errString, BUF_LEN, "poly is %s ", dkg_secret);

    uint32_t sealedLen = sgx_calc_sealed_data_size(0,
                                                   DKG_BUFER_LENGTH);//sizeof(sgx_sealed_data_t) +  sizeof(dkg_secret);

    sgx_status_t status = sgx_seal_data(0, NULL, DKG_BUFER_LENGTH, (uint8_t *) dkg_secret, sealedLen,
                                        (sgx_sealed_data_t *) encrypted_dkg_secret);

    if (status != SGX_SUCCESS) {
        snprintf(errString, BUF_LEN, "SGX seal data failed");
        *errStatus = status;
        return;
    }

    *enc_len = sealedLen;
    //free(dkg_secret);
}
