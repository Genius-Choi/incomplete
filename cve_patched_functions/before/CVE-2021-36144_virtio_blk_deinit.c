virtio_blk_deinit(struct vmctx *ctx, struct pci_vdev *dev, char *opts)
{
	struct blockif_ctxt *bctxt;
	struct virtio_blk *blk;

	if (dev->arg) {
		DPRINTF(("virtio_blk: deinit\n"));
		blk = (struct virtio_blk *) dev->arg;
		/* De-init virtio-blk device only on valid bctxt*/
		if (!blk->dummy_bctxt) {
			bctxt = blk->bc;
			if (blockif_flush_all(bctxt))
				WPRINTF(("vrito_blk: Failed to flush before close\n"));
			blockif_close(bctxt);
		}
		free(blk);
	}
}
