static void parse_bandwidth(sdp_parser_t *p, char *r, sdp_bandwidth_t **result)
{
  /*
   bandwidth-fields =    *("b=" bwtype ":" bandwidth CRLF)
   bwtype =              token
   bandwidth =           1*(DIGIT)
   */
  /* NOTE: bwtype can also be like X-barf */
  sdp_bandwidth_e modifier;
  char *name;
  unsigned long value;

  name = token(&r, ":", TOKEN, SPACE TAB);

  if (name == NULL || parse_ul(p, &r, &value, 0)) {
    parsing_error(p, "invalid bandwidth");
    return;
  }

  if (su_casematch(name, "CT"))
    modifier = sdp_bw_ct, name = "CT";
  else if (su_casematch(name, "TIAS") == 1)
    modifier = sdp_bw_tias, name = "TIAS";
  else if (su_casematch(name, "AS") == 1)
    modifier = sdp_bw_as, name = "AS";
  else if (su_casematch(name, "RS") == 1)
    modifier = sdp_bw_rs, name = "RS";
  else if (su_casematch(name, "RR") == 1)
    modifier = sdp_bw_rr, name = "RR";
  else
	modifier = sdp_bw_x, name = "BW-X";

  if (STRICT(p))
    PARSE_CHECK_REST(p, r, "b");

  {
    PARSE_ALLOC(p, sdp_bandwidth_t, b);
    *result = b;
    b->b_modifier = modifier;
    b->b_modifier_name = name;
    b->b_value = value;
  }
}
