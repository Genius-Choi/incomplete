njs_addr2line_test(njs_vm_t *vm, njs_opts_t *opts, njs_stat_t *stat)
{
    njs_str_t   v;
    njs_uint_t  i;
    u_char      buf[512];

    static const struct {
        void         *fp;
        const char   *name;
    } tests[] = {
        { njs_addr2line_test, njs_stringify(njs_addr2line_test) },
        { njs_to_int32_test, njs_stringify(njs_to_int32_test) },
    };

    for (i = 0; i < njs_nitems(tests); i++) {
        v.start = buf;
        v.length = njs_sprintf(buf, &buf[512], "%P", tests[i].fp) - buf;

        if (memcmp(buf, tests[i].name, njs_strlen(tests[i].name))) {
            njs_printf("njs_addr2line_test(%p):\n"
                       "expected: %s\n     got: %V\n",
                       tests[i].fp, tests[i].name, &v);

            stat->failed++;
            continue;
        }

        stat->passed++;
    }

    return NJS_OK;
}
