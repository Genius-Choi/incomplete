void fp54_exp_cyc(fp54_t c, const fp54_t a, const bn_t b) {
	int i, j, k, w = bn_ham(b);

	if (bn_is_zero(b)) {
		return fp54_set_dig(c, 1);
	}

	if ((bn_bits(b) > RLC_DIG) && ((w << 3) > bn_bits(b))) {
		fp54_t t;

		fp54_null(t)

		RLC_TRY {
			fp54_new(t);

			fp54_copy(t, a);

			for (i = bn_bits(b) - 2; i >= 0; i--) {
				fp54_sqr_cyc(t, t);
				if (bn_get_bit(b, i)) {
					fp54_mul(t, t, a);
				}
			}

			fp54_copy(c, t);
			if (bn_sign(b) == RLC_NEG) {
				fp54_inv_cyc(c, c);
			}
		}
		RLC_CATCH_ANY {
			RLC_THROW(ERR_CAUGHT);
		}
		RLC_FINALLY {
			fp54_free(t);
		}
	} else {
		fp54_t t, *u = RLC_ALLOCA(fp54_t, w);

		fp54_null(t);

		RLC_TRY {
			if (u == NULL) {
				RLC_THROW(ERR_NO_MEMORY)
			}
			for (i = 0; i < w; i++) {
				fp54_null(u[i]);
				fp54_new(u[i]);
			}
			fp54_new(t);

			j = 0;
			fp54_copy(t, a);
			for (i = 1; i < bn_bits(b); i++) {
				fp54_sqr_pck(t, t);
				if (bn_get_bit(b, i)) {
					fp54_copy(u[j++], t);
				}
			}

			if (!bn_is_even(b)) {
				j = 0;
				k = w - 1;
			} else {
				j = 1;
				k = w;
			}

			fp54_back_cyc_sim(u, u, k);

			if (!bn_is_even(b)) {
				fp54_copy(c, a);
			} else {
				fp54_copy(c, u[0]);
			}

			for (i = j; i < k; i++) {
				fp54_mul(c, c, u[i]);
			}

			if (bn_sign(b) == RLC_NEG) {
				fp54_inv_cyc(c, c);
			}
		}
		RLC_CATCH_ANY {
			RLC_THROW(ERR_CAUGHT);
		}
		RLC_FINALLY {
			for (i = 0; i < w; i++) {
				fp54_free(u[i]);
			}
			fp54_free(t);
			RLC_FREE(u);
		}
	}
}
