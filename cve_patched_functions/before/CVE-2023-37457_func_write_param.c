static int func_write_param(struct ast_channel *chan, const char *cmd, char *data, const char *value)
{
	struct ast_sip_channel_pvt *channel = chan ? ast_channel_tech_pvt(chan) : NULL;
	struct param_data param_data;
	AST_DECLARE_APP_ARGS(args,
		AST_APP_ARG(header_name);
		AST_APP_ARG(param_type);
		AST_APP_ARG(param_name);
	);

	AST_STANDARD_APP_ARGS(args, data);

	param_data.channel = channel;

	if (!channel || strncmp(ast_channel_name(chan), "PJSIP/", 6)) {
		ast_log(LOG_ERROR, "This function requires a PJSIP channel.\n");
		return -1;
	}
	if (ast_strlen_zero(args.param_type)) {
		ast_log(AST_LOG_ERROR, "This function requires a parameter type.\n");
		return -1;
	}
	if (ast_strlen_zero(args.param_name)) {
		ast_log(AST_LOG_ERROR, "This function requires a parameter name.\n");
		return -1;
	}

	/* Currently, only From is supported, but this could be extended in the future. */
	if (ast_strlen_zero(args.header_name) || strcasecmp(args.header_name, "From")) {
		ast_log(LOG_WARNING, "Only the From header is currently supported\n");
		return -1;
	}

	param_data.param_name = args.param_name;
	if (!strcasecmp(args.param_type, "header")) {
		param_data.paramtype = PARAMETER_HEADER;
	} else if (!strcasecmp(args.param_type, "uri")) {
		param_data.paramtype = PARAMETER_URI;
	} else {
		ast_log(LOG_WARNING, "Parameter type '%s' is invalid: must be 'header' or 'uri'\n", args.param_type);
		return -1;
	}
	param_data.param_value = value;

	return ast_sip_push_task_wait_serializer(channel->session->serializer, add_param, &param_data);
}
