static int BFInfo_RedisCommand(RedisModuleCtx *ctx, RedisModuleString **argv, int argc) {
    RedisModule_AutoMemory(ctx);
    if (argc != 2 && argc != 3) {
        return RedisModule_WrongArity(ctx);
    }

    SBChain *bf;
    RedisModuleKey *key = RedisModule_OpenKey(ctx, argv[1], REDISMODULE_READ);
    int status = bfGetChain(key, &bf);
    if (status != REDISMODULE_OK) {
        return RedisModule_ReplyWithError(ctx, statusStrerror(status));
    }

    if (argc == 3) {
        if (!rsStrcasecmp(argv[2], "capacity")) {
            RedisModule_ReplyWithMapOrArray(ctx, 1, false);
            if (_ReplyMap(ctx)) {
                RedisModule_ReplyWithSimpleString(ctx, "Capacity");
            }
            RedisModule_ReplyWithLongLong(ctx, BFCapacity(bf));
        } else if (!rsStrcasecmp(argv[2], "size")) {
            RedisModule_ReplyWithMapOrArray(ctx, 1, false);
            if (_ReplyMap(ctx)) {
                RedisModule_ReplyWithSimpleString(ctx, "Size");
            }
            RedisModule_ReplyWithLongLong(ctx, BFMemUsage(bf));
        } else if (!rsStrcasecmp(argv[2], "filters")) {
            RedisModule_ReplyWithMapOrArray(ctx, 1, false);
            if (_ReplyMap(ctx)) {
                RedisModule_ReplyWithSimpleString(ctx, "Number of filters");
            }
            RedisModule_ReplyWithLongLong(ctx, bf->nfilters);
        } else if (!rsStrcasecmp(argv[2], "items")) {
            RedisModule_ReplyWithMapOrArray(ctx, 1, false);
            if (_ReplyMap(ctx)) {
                RedisModule_ReplyWithSimpleString(ctx, "Number of items inserted");
            }
            RedisModule_ReplyWithLongLong(ctx, bf->size);
        } else if (!rsStrcasecmp(argv[2], "expansion")) {
            RedisModule_ReplyWithMapOrArray(ctx, 1, false);
            if (_ReplyMap(ctx)) {
                RedisModule_ReplyWithSimpleString(ctx, "Expansion rate");
            }
            bf->options &BLOOM_OPT_NO_SCALING ? RedisModule_ReplyWithNull(ctx)
                                              : RedisModule_ReplyWithLongLong(ctx, bf->growth);
        } else {
            return RedisModule_ReplyWithError(ctx, "Invalid information value");
        }

        return REDISMODULE_OK;
    }

    RedisModule_ReplyWithMapOrArray(ctx, 5 * 2, true);
    RedisModule_ReplyWithSimpleString(ctx, "Capacity");
    RedisModule_ReplyWithLongLong(ctx, BFCapacity(bf));
    RedisModule_ReplyWithSimpleString(ctx, "Size");
    RedisModule_ReplyWithLongLong(ctx, BFMemUsage(bf));
    RedisModule_ReplyWithSimpleString(ctx, "Number of filters");
    RedisModule_ReplyWithLongLong(ctx, bf->nfilters);
    RedisModule_ReplyWithSimpleString(ctx, "Number of items inserted");
    RedisModule_ReplyWithLongLong(ctx, bf->size);
    RedisModule_ReplyWithSimpleString(ctx, "Expansion rate");
    bf->options &BLOOM_OPT_NO_SCALING ? RedisModule_ReplyWithNull(ctx)
                                      : RedisModule_ReplyWithLongLong(ctx, bf->growth);

    return REDISMODULE_OK;
}
