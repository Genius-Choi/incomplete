int uri_parser_process(uri_parser_result_t *result, const char *uri,
                       size_t uri_len)
{
    /* uri cannot be empty */
    if ((NULL == uri) || (uri[0] == '\0')) {
        return -1;
    }

    memset(result, 0, sizeof(*result));

    if (uri_parser_is_absolute(uri, uri_len)) {
        return _parse_absolute(result, (char *)uri, (char *)(uri + uri_len));
    }
    else {
        return _parse_relative(result, (char *)uri, (char *)(uri + uri_len));
    }

    return 0;
}
