static __poll_t sock_poll_mask(struct file *file, __poll_t events)
{
	struct socket *sock = file->private_data;

	/*
	 * We need to be sure we are in sync with the socket flags modification.
	 *
	 * This memory barrier is paired in the wq_has_sleeper.
	 */
	smp_mb();

	/* this socket can poll_ll so tell the system call */
	return sock->ops->poll_mask(sock, events) |
		(sk_can_busy_loop(sock->sk) ? POLL_BUSY_LOOP : 0);
}
