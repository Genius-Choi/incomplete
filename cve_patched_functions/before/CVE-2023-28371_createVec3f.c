static QScriptValue createVec3f(QScriptContext* context, QScriptEngine *engine)
{
	Vec3f c;
	switch( context->argumentCount() )
	{
		case 0:
			// no color: black or white? Let's say: white, against a black sky.
			c.set( 1, 1, 1 );
			break;
		case 1:
			// either '#hhhhhh' or a color name - let QColor do the work
			if( context->argument(0).isString() )
			{
				QColor qcol = QColor( context->argument(0).toString() );
				if( qcol.isValid() )
				{
					c.set( static_cast<float>(qcol.redF()), static_cast<float>(qcol.greenF()), static_cast<float>(qcol.blueF()) );
					break;
				}
				else
					context->throwError( QString("Color: invalid color name") );
			}
			else
			{
				// Let's hope: a Color/Vec3f object
				return context->argument(0);
			}
			break;
		case 3:
			// r, g, b: between 0 and 1.
			if( context->argument(0).isNumber() &&
			    context->argument(1).isNumber() &&
			    context->argument(2).isNumber() )
			{
				c[0] = static_cast<float>(context->argument(0).toNumber());
				c[1] = static_cast<float>(context->argument(1).toNumber());
				c[2] = static_cast<float>(context->argument(2).toNumber());
				if( c[0] < 0 || 1 < c[0] ||
				    c[1] < 0 || 1 < c[1] ||
				    c[2] < 0 || 1 < c[2] )
				{
					context->throwError( QString("Color: RGB value out of range [0,1]") );
				}
			}
			break;
		default:
			context->throwError( QString("Color: invalid number of arguments") );
	}
	return vec3fToScriptValue(engine, c);
}
