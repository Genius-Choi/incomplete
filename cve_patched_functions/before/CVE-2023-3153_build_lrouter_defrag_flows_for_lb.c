build_lrouter_defrag_flows_for_lb(struct ovn_northd_lb *lb,
                                  struct hmap *lflows,
                                  struct ds *match)
{
    if (!lb->n_nb_lr) {
        return;
    }

    for (size_t i = 0; i < lb->n_vips; i++) {
        struct ovn_lb_vip *lb_vip = &lb->vips[i];
        bool ipv6 = lb_vip->address_family == AF_INET6;
        int prio = 100;

        ds_clear(match);
        ds_put_format(match, "ip && ip%c.dst == %s", ipv6 ? '6' : '4',
                      lb_vip->vip_str);

        ovn_lflow_add_with_dp_group(
            lflows, lb->nb_lr_map, S_ROUTER_IN_DEFRAG, prio,
            ds_cstr(match), "ct_dnat;", &lb->nlb->header_);
    }
}
