int create_client(SOCKET ls, SOCKET s, CLI *arg) {
    (void)ls; /* this parameter is only used with USE_FORK */
    s_log(LOG_DEBUG, "Creating a new thread");
    CRYPTO_THREAD_write_lock(stunnel_locks[LOCK_THREAD_LIST]);
    arg->thread_id=(HANDLE)_beginthreadex(NULL,
        (unsigned)arg->opt->stack_size, client_thread, arg,
        STACK_SIZE_PARAM_IS_A_RESERVATION, NULL);
    if(!arg->thread_id) {
        ioerror("_beginthreadex");
        CRYPTO_THREAD_unlock(stunnel_locks[LOCK_THREAD_LIST]);
        str_free(arg);
        if(s!=INVALID_SOCKET)
            closesocket(s);
        return -1;
    }
    thread_list_add(arg);
    CRYPTO_THREAD_unlock(stunnel_locks[LOCK_THREAD_LIST]);
    s_log(LOG_DEBUG, "New thread created");
    return 0;
}
