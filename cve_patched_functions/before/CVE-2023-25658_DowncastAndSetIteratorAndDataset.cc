void IteratorResource::State::DowncastAndSetIteratorAndDataset(
    std::unique_ptr<IteratorBase> it, const DatasetBase* dataset) {
  iterator_.reset(static_cast<DatasetBaseIterator*>(it.release()));
  if (dataset) {
    dataset->Ref();
    dataset_.reset(const_cast<DatasetBase*>(dataset));
  }
}
