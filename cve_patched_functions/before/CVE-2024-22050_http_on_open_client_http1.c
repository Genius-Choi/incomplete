static void http_on_open_client_http1(intptr_t uuid, void *set_,
                                      void *ignore_) {
  http_settings_s *set = set_;
  http_s *h = set->udata;
  fio_timeout_set(uuid, set->timeout);
  fio_protocol_s *pr = http1_new(uuid, set, NULL, 0);
  if (!pr) {
    fio_close(uuid);
    return;
  }
  { /* store the original on_close at the end of the struct, we wrap it. */
    void (**original)(intptr_t, fio_protocol_s *) =
        (void (**)(intptr_t, fio_protocol_s *))(set + 1);
    *original = pr->on_close;
    pr->on_close = http_on_close_client;
  }
  h->private_data.flag = (uintptr_t)pr;
  h->private_data.vtbl = http1_vtable();
  http_on_open_client_perform(set);
  (void)ignore_;
}
