copp_meter_add(struct ctl_context *ctx, const struct nbrec_copp *copp,
               const char *proto_name, const char *meter)
{
    if (!copp) {
        copp = nbrec_copp_insert(ctx->txn);
    }

    struct smap meters;
    smap_init(&meters);
    smap_clone(&meters, &copp->meters);
    smap_replace(&meters, proto_name, meter);
    nbrec_copp_set_meters(copp, &meters);
    smap_destroy(&meters);

    return copp;
}
