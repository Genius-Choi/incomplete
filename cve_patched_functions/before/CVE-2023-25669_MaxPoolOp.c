  MaxPoolOp(OpKernelConstruction* ctx, int num_spatial_dims)
      : PoolingOp(ctx, /*num_spatial_dims=*/num_spatial_dims,
                  /*reduction_type=*/ctx->input_type(0)) {
    std::string data_format_str;
    OP_REQUIRES_OK(ctx, ctx->GetAttr("data_format", &data_format_str));
    OP_REQUIRES(ctx, FormatFromString(data_format_str, &data_format_),
                errors::InvalidArgument("Invalid data format"));
    OP_REQUIRES(ctx, data_format_ != FORMAT_NHWC_VECT_W,
                errors::Unimplemented(
                    "XLA does not support the VECT_NHWC_VECT_W data format. "
                    "Returning unimplemented from MaxPool to keep "
                    "Tensorflow's intended optimized MaxPool here."));
  }
