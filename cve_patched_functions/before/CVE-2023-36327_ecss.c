static int ecss(void) {
	int code = RLC_ERR;
	bn_t d, r;
	ec_t q;
	uint8_t m[5] = { 0, 1, 2, 3, 4 };

	bn_null(d);
	bn_null(r);
	ec_null(q);

	RLC_TRY {
		bn_new(d);
		bn_new(r);
		ec_new(q);

		TEST_CASE("ecss signature is correct") {
			TEST_ASSERT(cp_ecss_gen(d, q) == RLC_OK, end);
			TEST_ASSERT(cp_ecss_sig(r, d, m, sizeof(m), d) == RLC_OK, end);
			TEST_ASSERT(cp_ecss_ver(r, d, m, sizeof(m), q) == 1, end);
		}
		TEST_END;
	}
	RLC_CATCH_ANY {
		RLC_ERROR(end);
	}
	code = RLC_OK;

  end:
	bn_free(d);
	bn_free(r);
	ec_free(q);
	return code;
}
