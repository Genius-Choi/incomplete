void AuthChecker::LookupJwtCache() {
  bool remove = false;  // whether or not need to remove an expired entry.
  bool cache_hit = false;
  JwtCache &jwt_cache = context_->service_context()->jwt_cache();
  {
    JwtCache::ScopedLookup lookup(&jwt_cache, auth_token_);
    if (lookup.Found()) {
      JwtValue *val = lookup.value();
      if (system_clock::now() <= val->exp) {
        // Cache hit and cache entry is not expired.
        user_info_ = val->user_info;
        cache_hit = true;
      } else {
        // Need to removes the expired cache entry.
        remove = true;
      }
    }
  }
  if (remove) {
    jwt_cache.Remove(auth_token_);
  }

  if (cache_hit) {
    CheckAudience(true);
  } else {
    ParseJwt();
  }
}
