must_hide_file(struct mg_connection *conn, const char *path)
{
	if (conn && conn->dom_ctx) {
		const char *pw_pattern = "**" PASSWORDS_FILE_NAME "$";
		const char *pattern = conn->dom_ctx->config[HIDE_FILES];
		return (match_prefix(pw_pattern, strlen(pw_pattern), path) > 0)
		       || ((pattern != NULL)
		           && (match_prefix(pattern, strlen(pattern), path) > 0));
	}
	return 0;
}
