static int shifting(void) {
	int code = RLC_ERR;
	bn_t a, b, c;

	bn_null(a);
	bn_null(b);
	bn_null(c);

	RLC_TRY {
		bn_new(a);
		bn_new(b);
		bn_new(c);

		TEST_CASE("shifting by 1 bit is consistent") {
			bn_rand(a, RLC_POS, RLC_BN_BITS - 1);
			bn_lsh(b, a, 1);
			bn_dbl(c, a);
			TEST_ASSERT(bn_cmp(b, c) == RLC_EQ, end);
			bn_rsh(b, a, 1);
			bn_hlv(c, a);
			TEST_ASSERT(bn_cmp(b, c) == RLC_EQ, end);
			bn_lsh(b, a, 1);
			bn_rsh(c, b, 1);
			TEST_ASSERT(bn_cmp(a, c) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("shifting by 2 bits is consistent") {
			bn_rand(a, RLC_POS, RLC_BN_BITS - 2);
			bn_lsh(b, a, 2);
			bn_rsh(c, b, 2);
			TEST_ASSERT(bn_cmp(a, c) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("shifting by half digit is consistent") {
			bn_rand(a, RLC_POS, RLC_BN_BITS - RLC_DIG / 2);
			bn_lsh(b, a, RLC_DIG / 2);
			bn_rsh(c, b, RLC_DIG / 2);
			TEST_ASSERT(bn_cmp(a, c) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("shifting by 1 digit is consistent") {
			bn_rand(a, RLC_POS, RLC_DIG);
			bn_lsh(b, a, RLC_DIG);
			bn_rsh(c, b, RLC_DIG);
			TEST_ASSERT(bn_cmp(a, c) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("shifting by 2 digits is consistent") {
			bn_rand(a, RLC_POS, RLC_BN_BITS - 2 * RLC_DIG);
			bn_lsh(b, a, 2 * RLC_DIG);
			bn_rsh(c, b, 2 * RLC_DIG);
			TEST_ASSERT(bn_cmp(a, c) == RLC_EQ, end);
		}
		TEST_END;

		TEST_CASE("shifting by 1 digit and half is consistent") {
			bn_rand(a, RLC_POS, RLC_BN_BITS - RLC_DIG - RLC_DIG / 2);
			bn_lsh(b, a, RLC_DIG + RLC_DIG / 2);
			bn_copy(c, a);
			for (int j = 0; j < (int)(RLC_DIG + RLC_DIG / 2); j++)
				bn_dbl(c, c);
			TEST_ASSERT(bn_cmp(b, c) == RLC_EQ, end);
			bn_rsh(b, a, (RLC_DIG + RLC_DIG / 2));
			bn_copy(c, a);
			for (int j = 0; j < (int)(RLC_DIG + RLC_DIG / 2); j++)
				bn_hlv(c, c);
			TEST_ASSERT(bn_cmp(b, c) == RLC_EQ, end);
		} TEST_END;
	}
	RLC_CATCH_ANY {
		RLC_ERROR(end);
	}
	code = RLC_OK;
  end:
	bn_free(a);
	bn_free(b);
	bn_free(c);
	return code;
}
