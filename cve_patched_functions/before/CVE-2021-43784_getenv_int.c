static int getenv_int(const char *name)
{
	char *val, *endptr;
	int ret;

	val = getenv(name);
	/* Treat empty value as unset variable. */
	if (val == NULL || *val == '\0')
		return -ENOENT;

	ret = strtol(val, &endptr, 10);
	if (val == endptr || *endptr != '\0')
		bail("unable to parse %s=%s", name, val);
	/*
	 * Sanity check: this must be a small non-negative number.
	 * Practically, we pass two fds (3 and 4) and a log level,
	 * for which the maximum is 6 (TRACE).
	 * */
	if (ret < 0 || ret > TRACE)
		bail("bad value for %s=%s (%d)", name, val, ret);

	return ret;
}
