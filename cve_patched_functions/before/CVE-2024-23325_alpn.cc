const std::string& ConnectionInfoImplBase::alpn() const {
  if (alpn_.empty()) {
    const unsigned char* proto;
    unsigned int proto_len;
    SSL_get0_alpn_selected(ssl(), &proto, &proto_len);
    if (proto != nullptr) {
      alpn_ = std::string(reinterpret_cast<const char*>(proto), proto_len);
    }
  }
  return alpn_;
}
