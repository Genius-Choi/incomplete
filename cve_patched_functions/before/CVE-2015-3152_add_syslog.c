void add_syslog(const char *line) {
  char buff[MAX_SYSLOG_MESSAGE_SIZE];
  my_snprintf(buff, sizeof(buff), "SYSTEM_USER:'%s', MYSQL_USER:'%s', "
              "CONNECTION_ID:%lu, DB_SERVER:'%s', DB:'%s', QUERY:'%s'",
              /* use the cached user/sudo_user value. */
              current_os_sudouser ? current_os_sudouser :
              current_os_user ? current_os_user : "--",
              current_user ? current_user : "--",
              mysql_thread_id(&mysql),
              current_host ? current_host : "--",
              current_db ? current_db : "--",
              line);

  (void) my_syslog(charset_info, INFORMATION_LEVEL, buff);
  return;
}
