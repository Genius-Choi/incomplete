static Jsi_RC SysSetEnvCmd(Jsi_Interp *interp, Jsi_Value *args, Jsi_Value *_this,
                        Jsi_Value **ret, Jsi_Func *funcPtr)
{
    Jsi_Value *v = Jsi_ValueArrayIndex(interp, args, 0);
    const char *fnam = Jsi_ValueString(interp, v, NULL);
    Jsi_Value *vv = Jsi_ValueArrayIndex(interp, args, 1);
    const char *cp = NULL, *fval = (vv?Jsi_ValueString(interp, vv, NULL):NULL);
    int rc = -1;
    if (fnam == 0) 
        return Jsi_LogError("arg1: expected string 'name'");
    if (interp->isSafe)
        return Jsi_LogError("no setenv in safe mode");

    if (fnam[0] != 0) {
#ifndef __WIN32
        if (fval)
            rc = setenv(fnam, fval, 1);
        else
            cp = getenv(fnam);
#else  /* TODO: win setenv */
        if (!fval)
            cp = getenv(fnam);
        else {
            char ebuf[JSI_BUFSIZ];
            snprintf(ebuf, sizeof(ebuf), "%s=%s", fnam, fval);
            rc = _putenv(ebuf);
        }
#endif
    }
    if (rc != 0) 
        return Jsi_LogError("setenv failure: %s = %s", fnam, fval);
    if (cp)
        Jsi_ValueMakeStringDup(interp, ret, cp);
    return JSI_OK;
}
