check_load(int r, struct sshkey **k, const char *path, const char *message)
{
	switch (r) {
	case 0:
		/* Check RSA keys size and discard if undersized */
		if (k != NULL && *k != NULL &&
		    (r = sshkey_check_rsa_length(*k,
		    options.required_rsa_size)) != 0) {
			error_r(r, "load %s \"%s\"", message, path);
			free(*k);
			*k = NULL;
		}
		break;
	case SSH_ERR_INTERNAL_ERROR:
	case SSH_ERR_ALLOC_FAIL:
		fatal_r(r, "load %s \"%s\"", message, path);
	case SSH_ERR_SYSTEM_ERROR:
		/* Ignore missing files */
		if (errno == ENOENT)
			break;
		/* FALLTHROUGH */
	default:
		error_r(r, "load %s \"%s\"", message, path);
		break;
	}
}
