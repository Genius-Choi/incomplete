SGXWalletServer::importBLSKeyShareImpl(const string &_keyShare, const string &_keyShareName, int t, int n, int _index) {
    Json::Value result;

    int errStatus = UNKNOWN_ERROR;
    char *errMsg = (char *) calloc(BUF_LEN, 1);

    result["status"] = 0;
    result["errorMessage"] = "";
    result["encryptedKeyShare"] = "";

    char *encryptedKeyShareHex = nullptr;

    try {

        encryptedKeyShareHex = encryptBLSKeyShare2Hex(&errStatus, errMsg, _keyShare.c_str());

        if (encryptedKeyShareHex == nullptr) {
            throw SGXException(UNKNOWN_ERROR, "");
        }

        if (errStatus != 0) {
            throw SGXException(errStatus, errMsg);
        }

        result["encryptedKeyShare"] = string(encryptedKeyShareHex);

        writeKeyShare(_keyShareName, encryptedKeyShareHex, _index, n, t);

    } catch (SGXException &_e) {
        result["status"] = _e.status;
        result["errorMessage"] = _e.errString;
    }

    if (encryptedKeyShareHex != nullptr) {
        free(encryptedKeyShareHex);
    }

    return result;
}
