int Monitor::get_mon_metadata(int mon, Formatter *f, ostream& err)
{
  assert(f);
  map<int, Metadata> last_metadata;
  if (int r = load_metadata(last_metadata)) {
    err << "Unable to load metadata: " << cpp_strerror(r);
    return r;
  }
  if (!last_metadata.count(mon)) {
    err << "mon." << mon << " not found";
    return -EINVAL;
  }
  const Metadata& m = last_metadata[mon];
  for (Metadata::const_iterator p = m.begin(); p != m.end(); ++p) {
    f->dump_string(p->first.c_str(), p->second);
  }
  return 0;
}
