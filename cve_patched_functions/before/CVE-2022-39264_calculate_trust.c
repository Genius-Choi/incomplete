calculate_trust(const std::string &user_id, const MegolmSessionIndex &index)
{
    auto status              = cache::client()->verificationStatus(user_id);
    auto megolmData          = cache::client()->getMegolmSessionData(index);
    crypto::Trust trustlevel = crypto::Trust::Unverified;

    if (megolmData && megolmData->trusted &&
        status.verified_device_keys.count(megolmData->sender_key))
        trustlevel = status.verified_device_keys.at(megolmData->sender_key);

    return trustlevel;
}
