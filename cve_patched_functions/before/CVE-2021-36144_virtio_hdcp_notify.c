virtio_hdcp_notify(void *vdev, struct virtio_vq_info *vq)
{
	struct virtio_hdcp *vhdcp = vdev;

	/* Any ring entries to process */
	if (!vq_has_descs(vq))
		return;

	vhdcp->fd = (vhdcp->fd < 0) ? connect_hdcp_daemon() : vhdcp->fd;
	if (vhdcp->fd < 0)
	{
		WPRINTF(("Invalid HDCP daemon file descriptor\n"));
		return;
	}

	/* Signal the thread for processing */
	pthread_mutex_lock(&vhdcp->rx_mtx);
	if (vhdcp->in_progress == 0)
		pthread_cond_signal(&vhdcp->rx_cond);
	pthread_mutex_unlock(&vhdcp->rx_mtx);
}
