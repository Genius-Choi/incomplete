GF_Err load_bt_run(GF_SceneLoader *load)
{
	GF_Err e;
	GF_BTParser *parser = (GF_BTParser *)load->loader_priv;
	if (!parser) return GF_BAD_PARAM;

	if (!parser->initialized) {
		e = gf_sm_load_bt_initialize(load, NULL, 1);
		if (e) return e;
	}

	e = gf_bt_loader_run_intern(parser, NULL, 0);

	if ((e<0) || parser->done) {
		parser->done = 0;
		parser->initialized = 0;
		if (parser->gz_in) {
			gf_gzclose(parser->gz_in);
			parser->gz_in = NULL;
		}

		if (parser->line_buffer) {
			gf_free(parser->line_buffer);
			parser->line_buffer = NULL;
		}
		parser->file_size = 0;
		parser->line_pos = parser->line_size = 0;
		load->fileName = NULL;
	}
	return e;
}
