static int callback_oidc_end_session_list(const struct _u_request * request, struct _u_response * response, void * user_data) {
  struct _oidc_config * config = (struct _oidc_config *)user_data;
  time_t now;
  struct tm ts;
  char expires[129];

  time(&now);
  now += (time_t)json_integer_value(json_object_get(config->j_params, "session-cookie-expiration"));
  gmtime_r(&now, &ts);
  strftime(expires, 128, "%a, %d %b %Y %T %Z", &ts);
  if (o_strlen(u_map_get(request->map_url, "sid")) == OIDC_SID_LENGTH) {
    if (run_backchannel_logout(config, json_string_value(json_object_get((json_t *)response->shared_data, "username")), u_map_get(request->map_url, "sid")) == G_OK &&
        disable_tokens_from_session(config, json_string_value(json_object_get((json_t *)response->shared_data, "username")), u_map_get(request->map_url, "sid")) == G_OK) {
      if (ulfius_add_same_site_cookie_to_response(response, json_string_value(json_object_get(config->j_params, "session-cookie-name")), "", expires, 0, config->glewlwyd_config->glewlwyd_config->cookie_domain, "/", (int)config->glewlwyd_config->glewlwyd_config->cookie_secure, 0, (int)config->glewlwyd_config->glewlwyd_config->cookie_same_site) != U_OK) {
        y_log_message(Y_LOG_LEVEL_DEBUG, "callback_oidc_end_session_list - Error ulfius_add_same_site_cookie_to_response");
        response->status = 500;
      }
    } else {
      y_log_message(Y_LOG_LEVEL_ERROR, "callback_oidc_end_session_list - Error run_backchannel_logout or disable_tokens_from_session");
      response->status = 500;
    }
  } else {
    response->status = 400;
  }
  return U_CALLBACK_CONTINUE;
}
