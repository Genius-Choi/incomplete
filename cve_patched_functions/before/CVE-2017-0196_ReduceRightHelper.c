    Var JavascriptArray::ReduceRightHelper(JavascriptArray* pArr, Js::TypedArrayBase* typedArrayBase, RecyclableObject* obj, T length, Arguments& args, ScriptContext* scriptContext)
    {
        if (args.Info.Count < 2 || !JavascriptConversion::IsCallable(args[1]))
        {
            if (typedArrayBase != nullptr)
            {
                JavascriptError::ThrowTypeError(scriptContext, JSERR_FunctionArgument_NeedFunction, _u("[TypedArray].prototype.reduceRight"));
            }
            else
            {
                JavascriptError::ThrowTypeError(scriptContext, JSERR_FunctionArgument_NeedFunction, _u("Array.prototype.reduceRight"));
            }
        }

        // If we came from Array.prototype.reduceRight and source object is not a JavascriptArray, source could be a TypedArray
        if (typedArrayBase == nullptr && pArr == nullptr && TypedArrayBase::Is(obj))
        {
            typedArrayBase = TypedArrayBase::FromVar(obj);
        }

        RecyclableObject* callBackFn = RecyclableObject::FromVar(args[1]);
        Var accumulator = nullptr;
        Var element = nullptr;
        T k = 0;
        T index = 0;

        if (args.Info.Count > 2)
        {
            accumulator = args[2];
        }
        else
        {
            if (length == 0)
            {
                JavascriptError::ThrowTypeError(scriptContext, VBSERR_ActionNotSupported);
            }

            bool bPresent = false;
            if (pArr)
            {
                for (; k < length && bPresent == false; k++)
                {
                    index = length - k - 1;
                    if (!pArr->DirectGetItemAtFull((uint32)index, &element))
                    {
                        continue;
                    }
                    bPresent = true;
                    accumulator = element;
                }
            }
            else if (typedArrayBase)
            {
                Assert(length <= UINT_MAX);
                for (; k < length && bPresent == false; k++)
                {
                    index = length - k - 1;
                    if (!typedArrayBase->HasItem((uint32)index))
                    {
                        continue;
                    }
                    element = typedArrayBase->DirectGetItem((uint32)index);
                    bPresent = true;
                    accumulator = element;
                }
            }
            else
            {
                for (; k < length && bPresent == false; k++)
                {
                    index = length - k - 1;
                    if (JavascriptOperators::HasItem(obj, index))
                    {
                        accumulator = JavascriptOperators::GetItem(obj, index, scriptContext);
                        bPresent = true;
                    }
                }
            }
            if (bPresent == false)
            {
                JavascriptError::ThrowTypeError(scriptContext, VBSERR_ActionNotSupported);
            }

        }

        // The correct flag value is CallFlags_Value but we pass CallFlags_None in compat modes
        CallFlags flags = CallFlags_Value;
        Var undefinedValue = scriptContext->GetLibrary()->GetUndefined();

        if (pArr)
        {
            for (; k < length; k++)
            {
                index = length - k - 1;
                if (!pArr->DirectGetItemAtFull((uint32)index, &element))
                {
                    continue;
                }

                accumulator = CALL_FUNCTION(callBackFn, CallInfo(flags, 5), undefinedValue,
                    accumulator,
                    element,
                    JavascriptNumber::ToVar(index, scriptContext),
                    pArr);
            }
        }
        else if (typedArrayBase)
        {
            Assert(length <= UINT_MAX);
            for (; k < length; k++)
            {
                index = length - k - 1;
                if (!typedArrayBase->HasItem((uint32) index))
                {
                    continue;
                }

                element = typedArrayBase->DirectGetItem((uint32)index);

                accumulator = CALL_FUNCTION(callBackFn, CallInfo(flags, 5), undefinedValue,
                    accumulator,
                    element,
                    JavascriptNumber::ToVar(index, scriptContext),
                    typedArrayBase);
            }
        }
        else
        {
            for (; k < length; k++)
            {
                index = length - k - 1;
                if (JavascriptOperators::HasItem(obj, index))
                {
                    element = JavascriptOperators::GetItem(obj, index, scriptContext);
                    accumulator = CALL_FUNCTION(callBackFn, CallInfo(flags, 5), undefinedValue,
                        accumulator,
                        element,
                        JavascriptNumber::ToVar(index, scriptContext),
                        obj);
                }
            }
        }

        return accumulator;
    }
