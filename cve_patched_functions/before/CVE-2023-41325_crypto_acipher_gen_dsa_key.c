TEE_Result crypto_acipher_gen_dsa_key(struct dsa_keypair *key, size_t key_size)
{
	dsa_key ltc_tmp_key = { };
	int ltc_res = 0;

	if (key_size != 8 * mp_unsigned_bin_size(key->p))
		return TEE_ERROR_BAD_PARAMETERS;

	ltc_res = mp_init_multi(&ltc_tmp_key.g, &ltc_tmp_key.p, &ltc_tmp_key.q,
				&ltc_tmp_key.x, &ltc_tmp_key.y, NULL);
	if (ltc_res)
		return TEE_ERROR_OUT_OF_MEMORY;

	/* Copy the key parameters */
	mp_copy(key->g, ltc_tmp_key.g);
	mp_copy(key->p, ltc_tmp_key.p);
	mp_copy(key->q, ltc_tmp_key.q);

	/* Generate the DSA key */
	ltc_res = dsa_generate_key(NULL, find_prng("prng_crypto"),
				   &ltc_tmp_key);
	if (ltc_res)
		return TEE_ERROR_BAD_PARAMETERS;

	/* Copy the key */
	mp_copy(ltc_tmp_key.y, key->y);
	mp_copy(ltc_tmp_key.x, key->x);

	/* Free the temporary key */
	dsa_free(&ltc_tmp_key);

	return TEE_SUCCESS;
}
