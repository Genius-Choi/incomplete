static int skipN(HTTP_HANDLE_DATA* http_instance, size_t n)
{
    // read and abandon response content with specified length
    // returns -1 in case of error.

    int result;

    if (http_instance == NULL)
    {
        LogError("Invalid HTTP instance");
        result = -1;
    }
    else
    {
        /*Codes_SRS_HTTPAPI_COMPACT_21_081: [ The HTTPAPI_ExecuteRequest shall try to read the message with the response up to 20 seconds. ]*/
        int countRetry = MAX_RECEIVE_RETRY;
        result = (int)n;
        while (n > 0)
        {
            xio_dowork(http_instance->xio_handle);

            /* if any error was detected while receiving then simply break and report it */
            if (http_instance->is_io_error != 0)
            {
                LogError("xio reported error on dowork");
                result = -1;
                n = 0;
            }
            else
            {
                if (http_instance->received_bytes_count <= n)
                {
                    n -= http_instance->received_bytes_count;
                    http_instance->received_bytes_count = 0;
                }
                else
                {
                    http_instance->received_bytes_count -= n;
                    (void)memmove(http_instance->received_bytes, http_instance->received_bytes + n, http_instance->received_bytes_count);
                    n = 0;
                }

                if (n > 0)
                {
                    if ((countRetry--) > 0)
                    {
                        /*Codes_SRS_HTTPAPI_COMPACT_21_083: [ The HTTPAPI_ExecuteRequest shall wait, at least, 100 milliseconds between retries. ]*/
                        ThreadAPI_Sleep(RETRY_INTERVAL_IN_MS);
                    }
                    else
                    {
                        /*Codes_SRS_HTTPAPI_COMPACT_21_082: [ If the HTTPAPI_ExecuteRequest retries 20 seconds to receive the message without success, it shall fail and return HTTPAPI_READ_DATA_FAILED. ]*/
                        LogError("Receive timeout. The HTTP request is incomplete");
                        n = 0;
                        result = -1;
                    }
                }
            }
        }
    }

    return result;
}
