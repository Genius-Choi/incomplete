void onion_response_set_length(onion_response * res, size_t len) {
  if (len != res->sent_bytes && res->flags & OR_HEADER_SENT) {
    ONION_WARNING
        ("Trying to set length after headers sent. Undefined onion behaviour.");
    return;
  }
  char tmp[16];
  sprintf(tmp, "%lu", (unsigned long)len);
  onion_response_set_header(res, "Content-Length", tmp);
  res->length = len;
  res->flags |= OR_LENGTH_SET;
}
