add_auth_pass_entry(const struct auth_pass *ent, int netrc, int override)
{
    if ((ent->host || netrc)	/* netrc accept default (host == NULL) */
	&&(ent->is_proxy || ent->realm || netrc)
	&& ent->uname && ent->pwd) {
	struct auth_pass *newent = New(struct auth_pass);
	memcpy(newent, ent, sizeof(struct auth_pass));
	if (override) {
	    newent->next = passwords;
	    passwords = newent;
	} 
	else {
	    if (passwords == NULL)
		passwords = newent;
	    else if (passwords->next == NULL)
		passwords->next = newent;
	    else {
		struct auth_pass *ep = passwords;
		for (; ep->next; ep = ep->next) ;
		ep->next = newent;
	    }
	}
    }
    /* ignore invalid entries */
}
