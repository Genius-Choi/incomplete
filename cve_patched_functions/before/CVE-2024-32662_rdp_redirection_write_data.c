static BOOL rdp_redirection_write_data(wStream* s, size_t length, const void* data)
{
	WINPR_ASSERT(data || (length == 0));

	if (!Stream_CheckAndLogRequiredCapacity(TAG, s, 4))
		return FALSE;

	Stream_Write_UINT32(s, length);

	if (!Stream_CheckAndLogRequiredCapacity(TAG, s, length))
		return FALSE;

	Stream_Write(s, data, length);
	return TRUE;
}
