tee_svc_obj_ed25519_parse_params(const TEE_Attribute *params, size_t num_params,
				 bool *ph_flag, const uint8_t **ctx,
				 size_t *ctx_len)
{
	size_t n = 0;

	*ctx = NULL;

	for (n = 0; n < num_params; n++) {
		switch (params[n].attributeID) {
		case TEE_ATTR_EDDSA_PREHASH:
			if (params[n].content.value.b)
				return TEE_ERROR_BAD_PARAMETERS;
			if (!params[n].content.value.a)
				*ph_flag = false;
			else if (params[n].content.value.a == 1)
				*ph_flag = true;
			else
				return TEE_ERROR_BAD_PARAMETERS;
			break;

		case TEE_ATTR_EDDSA_CTX:
			/* several provided contexts are treated as error */
			if (*ctx)
				return TEE_ERROR_BAD_PARAMETERS;

			*ctx_len = params[n].content.ref.length;
			if (*ctx_len > TEE_ED25519_CTX_MAX_LENGTH)
				return TEE_ERROR_BAD_PARAMETERS;

			if (!*ctx_len)
				break;

			*ctx = params[n].content.ref.buffer;
			if (!*ctx)
				return TEE_ERROR_BAD_PARAMETERS;
			break;

		default:
			return TEE_ERROR_BAD_PARAMETERS;
		}
	}

	return TEE_SUCCESS;
}
