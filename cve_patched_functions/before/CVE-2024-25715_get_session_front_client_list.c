static json_t * get_session_front_client_list(struct _oidc_config * config, const char * username, const char * sid, const char * client_id, const char * post_redirect_to) {
  json_t * j_query, * j_result = NULL, * j_client, * j_client_alpha, * j_return, * j_element = NULL;
  int res;
  size_t index = 0;

  if (!o_strnullempty(sid) && !o_strnullempty(client_id)) {
    j_client_alpha = config->glewlwyd_config->glewlwyd_plugin_callback_get_client(config->glewlwyd_config, client_id);
    if (check_result_value(j_client_alpha, G_OK) && json_object_get(json_object_get(j_client_alpha, "client"), "enabled") == json_true()) {
      j_return = json_pack("{sis{sssssssO*s[]}}",
                           "result", G_OK,
                           "session",
                             "iss",json_string_value(json_object_get(config->j_params, "iss")),
                             "sid", sid,
                             "client_id", client_id,
                             "client_name", json_object_get(json_object_get(j_client_alpha, "client"), "name"),
                             "client");
      if (post_redirect_to != NULL && json_array_has_string(json_object_get(json_object_get(j_client_alpha, "client"), "post_logout_redirect_uris"), post_redirect_to)) {
        json_object_set_new(json_object_get(j_return, "session"), "post_redirect_to", json_string(post_redirect_to));
      }
      if (json_object_get(config->j_params, "front-channel-logout-allowed") == json_true()) {
        j_query = json_pack("{sss[s]s{sssssssi}}",
                            "table", GLEWLWYD_PLUGIN_OIDC_TABLE_ID_TOKEN,
                            "columns",
                              "DISTINCT(gpoi_client_id) AS client_id",
                            "where",
                              "gpoi_plugin_name", config->name,
                              "gpoi_username", username,
                              "gpoi_sid", sid,
                              "gpoi_enabled", 1);
        res = h_select(config->glewlwyd_config->glewlwyd_config->conn, j_query, &j_result, NULL);
        json_decref(j_query);
        if (res == H_OK) {
          if (json_array_size(j_result)) {
            json_array_foreach(j_result, index, j_element) {
              j_client = config->glewlwyd_config->glewlwyd_plugin_callback_get_client(config->glewlwyd_config, json_string_value(json_object_get(j_element, "client_id")));
              if (check_result_value(j_client, G_OK) && json_object_get(json_object_get(j_client, "client"), "enabled") == json_true()) {
                if (!json_string_null_or_empty(json_object_get(json_object_get(j_client, "client"), "frontchannel_logout_uri"))) {
                  json_array_append_new(json_object_get(json_object_get(j_return, "session"), "client"),
                                        json_pack("{sOsOso}",
                                                  "client_id", json_object_get(j_element, "client_id"),
                                                  "frontchannel_logout_uri", json_object_get(json_object_get(j_client, "client"), "frontchannel_logout_uri"), "frontchannel_logout_session_required", is_true(json_string_value(json_object_get(json_object_get(j_client, "client"), "frontchannel_logout_session_required")))?json_true():json_false()));
                }
              }
              json_decref(j_client);
            }
          } else {
            json_decref(j_return);
            j_return = json_pack("{si}", "result", G_ERROR_PARAM);
          }
          json_decref(j_result);
        } else {
          y_log_message(Y_LOG_LEVEL_ERROR, "get_session_front_client_list - Error executing j_query");
          json_decref(j_return);
          j_return = json_pack("{si}", "result", G_ERROR_DB);
        }
      } else {
        json_decref(j_return);
        j_return = json_pack("{si}", "result", G_ERROR_PARAM);
      }
    } else {
      y_log_message(Y_LOG_LEVEL_ERROR, "get_session_front_client_list - Error get_client");
      j_return = json_pack("{si}", "result", G_ERROR_PARAM);
    }
    json_decref(j_client_alpha);
  } else {
    y_log_message(Y_LOG_LEVEL_ERROR, "get_session_front_client_list - Invalid input parameters");
    j_return = json_pack("{si}", "result", G_ERROR_PARAM);
  }
  return j_return;
}
