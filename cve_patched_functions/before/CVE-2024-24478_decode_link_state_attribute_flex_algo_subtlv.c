decode_link_state_attribute_flex_algo_subtlv(proto_tree *tree, tvbuff_t *tvb, gint offset, packet_info *pinfo, guint8 _U_ protocol_id)
{
    guint16 type;
    guint16 length;
    guint16 tmp16;

    proto_item* tlv_item;
    proto_tree* tlv_tree;

    type = tvb_get_ntohs(tvb, offset);
    length = tvb_get_ntohs(tvb, offset + 2);

    switch (type) {
    case BGP_LS_SR_TLV_FLEX_ALGO_EXC_ANY_AFFINITY:
    case BGP_LS_SR_TLV_FLEX_ALGO_INC_ANY_AFFINITY:
    case BGP_LS_SR_TLV_FLEX_ALGO_INC_ALL_AFFINITY:
        tlv_item = proto_tree_add_item(tree,
                                       (type == BGP_LS_SR_TLV_FLEX_ALGO_EXC_ANY_AFFINITY) ?
                                       hf_bgp_ls_sr_tlv_flex_algo_exc_any_affinity :
                                       ((type == BGP_LS_SR_TLV_FLEX_ALGO_INC_ANY_AFFINITY) ?
                                        hf_bgp_ls_sr_tlv_flex_algo_inc_any_affinity :
                                        hf_bgp_ls_sr_tlv_flex_algo_inc_all_affinity),
                                       tvb, offset, length + 4, ENC_NA);
        tlv_tree = proto_item_add_subtree(tlv_item, ett_bgp_link_state);
        proto_tree_add_item(tlv_tree, hf_bgp_ls_type, tvb, offset, 2, ENC_BIG_ENDIAN);
        proto_tree_add_item(tlv_tree, hf_bgp_ls_length, tvb, offset + 2, 2, ENC_BIG_ENDIAN);
        if (length % 4 != 0) {
            expert_add_info_format(pinfo, tlv_tree, &ei_bgp_ls_error, "Unexpected Extended Administrative Group TLV's length (%u mod 4 != 0)",
                                   length);
            break;
        }
        tmp16 = length;
        while (tmp16) {
            proto_tree_add_item(tlv_tree, hf_bgp_ls_extended_administrative_group_value, tvb, offset + 4 + (length - tmp16), 4, ENC_NA);
            tmp16 -= 4;
        }
        break;

    default:
        expert_add_info_format(pinfo, tree, &ei_bgp_ls_warn,
                               "Unknown BGP-LS Flex-Algo sub-TLV Code (%u)!", type);
        break;
    }

    return length + 4;
}
