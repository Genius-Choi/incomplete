static void verifyCookieState(
    Optional<CookieState>& cookieState,
    ProtocolVersion version,
    CipherSuite cipher) {
  if (!cookieState) {
    return;
  }
  if (cookieState->version != version) {
    throw FizzException(
        "version mismatch with cookie", AlertDescription::protocol_version);
  }

  if (cookieState->cipher != cipher) {
    throw FizzException(
        "cipher mismatch with cookie", AlertDescription::handshake_failure);
  }
}
