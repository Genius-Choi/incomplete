parse_notification(struct rpki_uri *uri, struct update_notification **file)
{
	struct rdr_notification_ctx ctx;
	struct update_notification *tmp;
	char *dup;
	int error;

	dup = strdup(uri_get_global(uri));
	if (dup == NULL)
		return pr_enomem();

	error = update_notification_create(&tmp);
	if (error)
		return error;

	tmp->uri = dup;

	ctx.notification = tmp;
	error = relax_ng_parse(uri_get_local(uri), xml_read_notification,
	    &ctx);
	if (error) {
		update_notification_destroy(tmp);
		return error;
	}

	*file = tmp;
	return 0;
}
