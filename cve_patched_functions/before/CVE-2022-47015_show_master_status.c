int spider_db_mbase::show_master_status(
  SPIDER_TRX *trx,
  SPIDER_SHARE *share,
  int all_link_idx,
  int *need_mon,
  TABLE *table,
  spider_string *str,
  int mode,
  SPIDER_DB_RESULT **res1,
  SPIDER_DB_RESULT **res2
) {
  int error_num;
  const char *binlog_file_name, *binlog_pos;
  uint binlog_file_name_length, binlog_pos_length;
  DBUG_ENTER("spider_db_mbase::show_master_status");
  if ((error_num = exec_simple_sql_with_result(trx, share,
    SPIDER_SQL_SHOW_MASTER_STATUS_STR, SPIDER_SQL_SHOW_MASTER_STATUS_LEN,
    all_link_idx, need_mon, res1))
  ) {
    DBUG_PRINT("info", ("spider error_num=%d 1", error_num));
    DBUG_RETURN(error_num);
  }

  if (!(error_num = ((spider_db_mbase_result *)*res1)->fetch_show_master_status(
    &binlog_file_name, &binlog_pos))
  ) {
    binlog_file_name_length = strlen(binlog_file_name);
    binlog_pos_length = strlen(binlog_pos);
    spider_store_binlog_pos_binlog_file(table,
      binlog_file_name, binlog_file_name_length,
      binlog_pos, binlog_pos_length, conn->access_charset);
    if (mode > 0)
    {
      error_num = select_binlog_gtid_pos(
        trx,
        share,
        all_link_idx,
        need_mon,
        table,
        str,
        binlog_file_name,
        binlog_file_name_length,
        binlog_pos,
        binlog_pos_length,
        res2
      );
    } else {
      spider_store_binlog_pos_gtid(table, NULL, 0, conn->access_charset);
    }
  }
/*
  res->free_result();
  delete res;
*/
  if (error_num)
  {
    DBUG_PRINT("info", ("spider error_num=%d 2", error_num));
    DBUG_RETURN(error_num);
  }
  DBUG_RETURN(0);
}
