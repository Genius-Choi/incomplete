parse_publish_elem(xmlTextReaderPtr reader, bool parse_hash, bool hash_required,
    struct visited_uris *visited_uris)
{
	struct publish *tmp;
	int error;

	tmp = NULL;
	error = parse_publish(reader, parse_hash, hash_required, &tmp);
	if (error)
		return error;

	error = write_from_uri(tmp->doc_data.uri, tmp->content,
	    tmp->content_len, visited_uris);
	publish_destroy(tmp);
	if (error)
		return error;

	return 0;
}
