char *encryptBLSKeyShare2Hex(int *errStatus, char *err_string, const char *_key) {
    auto keyArray = make_shared<vector<char>>(BUF_LEN, 0);
    auto encryptedKey = make_shared<vector<uint8_t>>(BUF_LEN, 0);
    auto errMsg = make_shared<vector<char>>(BUF_LEN, 0);
    strncpy(keyArray->data(), _key, BUF_LEN);
    *errStatus = -1;

    unsigned int encryptedLen = 0;

    //status = trustedEncryptKey(eid, errStatus, errMsg, keyArray, encryptedKey, &encryptedLen);
    status = trustedEncryptKeyAES(eid, errStatus, errMsg->data(), keyArray->data(), encryptedKey->data(), &encryptedLen);

    spdlog::debug("errStatus is {}", *errStatus);
    spdlog::debug(" errMsg is ", errMsg->data());


    if (status != SGX_SUCCESS) {

        *errStatus = -1;
        return nullptr;
    }

    if (*errStatus != 0) {
        throw SGXException(-666, errMsg->data());
    }


    char *result = (char *) calloc(2 * BUF_LEN, 1);

    carray2Hex(encryptedKey->data(), encryptedLen, result);

    return result;
}
