int decomp_append_bytes(js_string *compressed, js_string *uncompressed,
                        unsigned int compressed_offset, int length) {

    js_string *temp;
    if((temp = js_create(length + 2,1)) == 0) {
        return JS_ERROR;
        }

    if(compressed->unit_count < compressed_offset + length) {
        js_destroy(temp);
        return JS_ERROR;
        }

    if(js_substr(compressed,temp,compressed_offset,length) != JS_SUCCESS) {
        js_destroy(temp);
        return JS_ERROR;
        }

    if(js_append(temp,uncompressed) == JS_ERROR) {
        js_destroy(temp);
        return JS_ERROR;
        }

    js_destroy(temp);
    return JS_SUCCESS;
    }
