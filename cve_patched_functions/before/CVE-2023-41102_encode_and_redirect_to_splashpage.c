static int encode_and_redirect_to_splashpage(struct MHD_Connection *connection, t_client *client, const char *originurl, const char *querystr)
{
	char *splashpageurl = NULL;
	s_config *config;
	int ret;

	config = config_get_config();
	splashpageurl = safe_calloc(QUERYMAXLEN);

	if (config->fas_port) {
		// Generate secure query string or authaction url
		// Note: config->fas_path contains a leading / as it is the path from the FAS web root.
		if (config->fas_secure_enabled == 0) {
			safe_snprintf(splashpageurl, QUERYMAXLEN, "%s?authaction=http://%s/%s/%s",
				config->fas_url, config->gw_address, config->authdir, querystr);
		} else if (config->fas_secure_enabled >= 1) {
				safe_snprintf(splashpageurl, QUERYMAXLEN, "%s%s",
					config->fas_url, querystr);
		} else {
			safe_snprintf(splashpageurl, QUERYMAXLEN, "%s?%s",
				config->fas_url, querystr);
		}
	}

	debug(LOG_DEBUG, "splashpageurl: %s", splashpageurl);

	ret = send_redirect_temp(connection, client, splashpageurl);
	free(splashpageurl);
	return ret;
}
