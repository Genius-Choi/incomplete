sslmodule_init_errorcodes(PyObject *module)
{
    struct py_ssl_error_code *errcode;
    struct py_ssl_library_code *libcode;

    /* Mappings for error codes */
    err_codes_to_names = PyDict_New();
    if (err_codes_to_names == NULL)
        return -1;
    err_names_to_codes = PyDict_New();
    if (err_names_to_codes == NULL)
        return -1;
    lib_codes_to_names = PyDict_New();
    if (lib_codes_to_names == NULL)
        return -1;

    errcode = error_codes;
    while (errcode->mnemonic != NULL) {
        PyObject *mnemo, *key;
        mnemo = PyUnicode_FromString(errcode->mnemonic);
        key = Py_BuildValue("ii", errcode->library, errcode->reason);
        if (mnemo == NULL || key == NULL)
            return -1;
        if (PyDict_SetItem(err_codes_to_names, key, mnemo))
            return -1;
        if (PyDict_SetItem(err_names_to_codes, mnemo, key))
            return -1;
        Py_DECREF(key);
        Py_DECREF(mnemo);
        errcode++;
    }

    libcode = library_codes;
    while (libcode->library != NULL) {
        PyObject *mnemo, *key;
        key = PyLong_FromLong(libcode->code);
        mnemo = PyUnicode_FromString(libcode->library);
        if (key == NULL || mnemo == NULL)
            return -1;
        if (PyDict_SetItem(lib_codes_to_names, key, mnemo))
            return -1;
        Py_DECREF(key);
        Py_DECREF(mnemo);
        libcode++;
    }

    if (PyModule_AddObject(module, "err_codes_to_names", err_codes_to_names))
        return -1;
    if (PyModule_AddObject(module, "err_names_to_codes", err_names_to_codes))
        return -1;
    if (PyModule_AddObject(module, "lib_codes_to_names", lib_codes_to_names))
        return -1;

    return 0;
}
