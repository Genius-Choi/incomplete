static void ProcessFileChooserPrefs(void) {
    unichar_t **b;
    int i;

    GFileChooserSetShowHidden(gfc_showhidden);
    GFileChooserSetDirectoryPlacement(gfc_dirplace);
    if ( gfc_bookmarks==NULL ) {
	b = malloc(8*sizeof(unichar_t *));
	i = 0;
#ifdef __Mac
	b[i++] = uc_copy("~/Library/Fonts/");
#endif
	b[i++] = uc_copy("~/fonts");
#ifdef __Mac
	b[i++] = uc_copy("/Library/Fonts/");
	b[i++] = uc_copy("/System/Library/Fonts/");
#endif
#if __CygWin
	b[i++] = uc_copy("/cygdrive/c/Windows/Fonts/");
#endif
	b[i++] = uc_copy("/usr/X11R6/lib/X11/fonts/");
	b[i++] = NULL;
	GFileChooserSetBookmarks(b);
    } else {
	char *pt, *start;
	start = gfc_bookmarks;
	for ( i=0; ; ++i ) {
	    pt = strchr(start,';');
	    if ( pt==NULL )
	break;
	    start = pt+1;
	}
	start = gfc_bookmarks;
	b = malloc((i+2)*sizeof(unichar_t *));
	for ( i=0; ; ++i ) {
	    pt = strchr(start,';');
	    if ( pt!=NULL )
		*pt = '\0';
	    b[i] = utf82u_copy(start);
	    if ( pt==NULL )
	break;
	    *pt = ';';
	    start = pt+1;
	}
	b[i+1] = NULL;
	GFileChooserSetBookmarks(b);
    }
    GFileChooserSetPrefsChangedCallback(NULL,FileChooserPrefsChanged);
}
