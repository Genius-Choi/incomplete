  int64_t CountBatchMatMulDimProduct(const OpInfo& op_info,
                                     bool* found_unknown_shapes) const {
    BatchMatMulDimensions batch_mat_mul;

    batch_mat_mul.matmul_dims.n = 0;
    batch_mat_mul.matmul_dims.m = 0;
    batch_mat_mul.matmul_dims.k = 0;

    OpLevelCostEstimatorTest::CountBatchMatMulOperations(
        op_info, &batch_mat_mul, found_unknown_shapes);
    int dimension_product = 1;
    for (auto dim : batch_mat_mul.batch_dims) dimension_product *= dim;

    dimension_product *= batch_mat_mul.matmul_dims.n;
    dimension_product *= batch_mat_mul.matmul_dims.m;
    dimension_product *= batch_mat_mul.matmul_dims.k;

    return dimension_product;
  }
