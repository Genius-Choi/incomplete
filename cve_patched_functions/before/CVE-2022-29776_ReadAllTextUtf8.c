    bool CFileBinary::ReadAllTextUtf8(const std::wstring&  strFileName, std::wstring& sData)
    {
        bool bRes = false;
        BYTE* pData = NULL;
        DWORD nDataSize;
        if (CFileBinary::ReadAllBytes(strFileName, &pData, nDataSize))
        {
            //remove BOM if exist
            BYTE* pDataStart = pData;
            DWORD nBOMSize = 3;
            if (nDataSize > nBOMSize && 0xef == pDataStart[0] && 0xbb == pDataStart[1] && 0xbf == pDataStart[2])
            {
                pDataStart += nBOMSize;
                nDataSize -= nBOMSize;
            }
            sData = CUtf8Converter::GetUnicodeStringFromUTF8(pDataStart, nDataSize);
            RELEASEARRAYOBJECTS(pData);
            bRes = true;
        }
        return bRes;
    }
