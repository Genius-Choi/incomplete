rx_iov_trim(struct iovec *iov, int *niov, int tlen)
{
	struct iovec *riov;

	/* XXX short-cut: assume first segment is >= tlen */
	if (iov[0].iov_len < tlen) {
		WPRINTF(("vtnet: rx_iov_trim: iov_len=%lu, tlen=%d\n", iov[0].iov_len, tlen));
		return NULL;
	}

	iov[0].iov_len -= tlen;
	if (iov[0].iov_len == 0) {
		if (*niov <= 1) {
			WPRINTF(("vtnet: rx_iov_trim: *niov=%d\n", *niov));
			return NULL;
		}
		*niov -= 1;
		riov = &iov[1];
	} else {
		iov[0].iov_base = (void *)((uintptr_t)iov[0].iov_base + tlen);
		riov = &iov[0];
	}

	return riov;
}
