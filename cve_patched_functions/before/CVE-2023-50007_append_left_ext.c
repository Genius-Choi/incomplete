static int append_left_ext(int wavelet_length, int levels, int level, uint64_t sn)
{
    if (levels == level)
        return 0;

    return (pow2(levels - level) - 1) * (wavelet_length - 2) +
            mod_pow2(sn, pow2(levels)) / pow2(level);
}
