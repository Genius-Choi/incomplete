void IMAPSession::renameFolder(String * folder, String * otherName, ErrorCode * pError)
{
    int r;
    
    selectIfNeeded(MCSTR("INBOX"), pError);
    if (* pError != ErrorNone)
        return;
    
    r = mailimap_rename(mImap, MCUTF8(folder), MCUTF8(otherName));
    if (r == MAILIMAP_ERROR_STREAM) {
        mShouldDisconnect = true;
        * pError = ErrorConnection;
        return;
    }
    else if (r == MAILIMAP_ERROR_PARSE) {
        mShouldDisconnect = true;
        * pError = ErrorParse;
        return;
    }
    else if (hasError(r)) {
        * pError = ErrorRename;
        return;
    }
    * pError = ErrorNone;
}
