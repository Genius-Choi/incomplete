    static bool CALLBACK proc(void*cookie, HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
    {
      size_t *io = (size_t*) cookie;
      COPYDATASTRUCT*pCDS = (COPYDATASTRUCT*) lParam;
      if (Msg == WM_COPYDATA && pCDS->cbData > sizeof(TCHAR) && pCDS->cbData <= io[2] * sizeof(TCHAR))
      {
        _tcscpy((TCHAR*) io[1], (TCHAR*) ((COPYDATASTRUCT*)lParam)->lpData);
        return (io[0] = (pCDS->dwData == MakensisAPI::PROMPT_FILEPATH));
      }
      return false;
    }
