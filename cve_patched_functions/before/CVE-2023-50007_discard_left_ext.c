static int discard_left_ext(int wavelet_length, int levels, int level, uint64_t sn)
{
    if (levels == level || sn == 0)
        return 0;
    return (pow2(levels - level) - 1) * (wavelet_length - 2) + mod_pow2(sn, pow2(levels)) / pow2(level);
}
