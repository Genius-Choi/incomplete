gpio_irq_init(struct virtio_gpio *gpio)
{
	struct gpio_irq_chip *chip;
	struct gpio_irq_desc *desc;
	struct gpio_line *line;
	int i, rc;

	chip = &gpio->irq_chip;
	rc = pthread_mutex_init(&chip->intr_mtx, NULL);
	if (rc) {
		WPRINTF(("IRQ pthread_mutex_init failed with error %d!\n", rc));
		return -1;
	}
	for (i = 0; i < gpio->nvline; i++) {
		desc = &chip->descs[i];
		line = gpio->vlines[i];
		desc->pin = i;
		desc->fd = -1;
		desc->mevt = NULL;
		desc->data = gpio;
		desc->gpio = line;
		line->irq = desc;
	}
	return 0;
}
