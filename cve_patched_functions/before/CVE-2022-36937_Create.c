req::ptr<SSLSocket> SSLSocket::Create(
  int fd, int domain, CryptoMethod method, std::string address, int port,
  double timeout, const req::ptr<StreamContext>& ctx,
  bool nonblocking
) {
  auto sock = req::make<SSLSocket>(
    fd, domain, ctx, address.c_str(), port, nonblocking);

  sock->m_data->m_method = method;
  sock->m_data->m_connect_timeout = timeout;
  sock->m_data->m_enable_on_connect = true;

  return sock;
}
