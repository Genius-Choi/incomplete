sync_lookup_ip4(const guint32 addr)
{
    gboolean completed = FALSE;
    sync_dns_data_t *sdd;

    if (!async_dns_initialized) {
        /*
         * c-ares not initialized.  Bail out.
         */
        return;
    }

    /*
     * Start the request.
     */
    sdd = g_new(sync_dns_data_t, 1);
    sdd->family = AF_INET;
    sdd->addr.ip4 = addr;
    sdd->completed = &completed;
    ares_gethostbyaddr(ghba_chan, &addr, sizeof(guint32), AF_INET,
                       c_ares_ghba_sync_cb, sdd);

    /*
     * Now wait for it to finish.
     */
    wait_for_sync_resolv(&completed);
}
