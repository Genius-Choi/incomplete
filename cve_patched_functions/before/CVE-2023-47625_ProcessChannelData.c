static bool ProcessChannelData(const uint8_t *data, const uint32_t size, CrsfPacket_t *const new_packet)
{
	uint32_t raw_channels[CRSF_CHANNEL_COUNT];
	uint32_t i;

	new_packet->message_type = CRSF_MESSAGE_TYPE_RC_CHANNELS;

	// Decode channel data
	raw_channels[0] = (data[0] | data[1] << 8) & 0x07FF;
	raw_channels[1] = (data[1]  >> 3 | data[2] << 5) & 0x07FF;
	raw_channels[2] = (data[2] >> 6 | data[3] << 2 | data[4] << 10) & 0x07FF;
	raw_channels[3] = (data[4] >> 1 | data[5] << 7) & 0x07FF;
	raw_channels[4] = (data[5] >> 4 | data[6] << 4) & 0x07FF;
	raw_channels[5] = (data[6] >> 7 | data[7] << 1 | data[8] << 9) & 0x07FF;
	raw_channels[6] = (data[8] >> 2 | data[9] << 6) & 0x07FF;
	raw_channels[7] = (data[9] >> 5 | data[10] << 3) & 0x07FF;
	raw_channels[8] = (data[11] | data[12] << 8) & 0x07FF;
	raw_channels[9] = (data[12] >> 3 | data[13] << 5) & 0x07FF;
	raw_channels[10] = (data[13] >> 6 | data[14] << 2 | data[15] << 10) & 0x07FF;
	raw_channels[11] = (data[15] >> 1 | data[16] << 7) & 0x07FF;
	raw_channels[12] = (data[16] >> 4 | data[17] << 4) & 0x07FF;
	raw_channels[13] = (data[17] >> 7 | data[18] << 1 | data[19] << 9) & 0x07FF;
	raw_channels[14] = (data[19] >> 2 | data[20] << 6) & 0x07FF;
	raw_channels[15] = (data[20] >> 5 | data[21] << 3) & 0x07FF;

	for (i = 0; i < CRSF_CHANNEL_COUNT; i++) {
		raw_channels[i] = ConstrainF(raw_channels[i], CRSF_CHANNEL_VALUE_MIN, CRSF_CHANNEL_VALUE_MAX);
		new_packet->channel_data.channels[i] = MapF((float)raw_channels[i], CRSF_CHANNEL_VALUE_MIN, CRSF_CHANNEL_VALUE_MAX,
						       1000.0f, 2000.0f);
	}

	return true;
}
