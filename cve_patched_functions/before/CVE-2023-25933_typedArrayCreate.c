CallResult<Handle<JSTypedArrayBase>> typedArrayCreate(
    Runtime &runtime,
    Handle<Callable> constructor,
    uint64_t length) {
  auto callRes = Callable::executeConstruct1(
      constructor,
      runtime,
      runtime.makeHandle(HermesValue::encodeNumberValue(length)));
  if (callRes == ExecutionStatus::EXCEPTION) {
    return ExecutionStatus::EXCEPTION;
  }
  PseudoHandle<> retval = std::move(*callRes);
  if (!vmisa<JSTypedArrayBase>(retval.get())) {
    return runtime.raiseTypeError(
        "The constructor needs to construct a TypedArray");
  }
  auto newTypedArray =
      Handle<JSTypedArrayBase>::vmcast(runtime.makeHandle(std::move(retval)));
  // If `argumentList` is a single number, then
  // If the value of newTypedArray's [[ArrayLength]] internal slot <
  // argumentList[0], throw a TypeError exception.
  if (LLVM_UNLIKELY(newTypedArray->getLength() < length)) {
    return runtime.raiseTypeError(
        "TypedArray constructor created an array that was too small");
  }
  return newTypedArray;
}
