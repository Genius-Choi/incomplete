httpAddrIsLocalhost(
    const http_addr_t *addr)		// I - Address to check
{
  if (!addr)
    return (true);

#ifdef AF_INET6
  if (addr->addr.sa_family == AF_INET6 && IN6_IS_ADDR_LOOPBACK(&(addr->ipv6.sin6_addr)))
    return (true);
#endif // AF_INET6

#ifdef AF_LOCAL
  if (addr->addr.sa_family == AF_LOCAL)
    return (true);
#endif // AF_LOCAL

  if (addr->addr.sa_family == AF_INET && (ntohl(addr->ipv4.sin_addr.s_addr) & 0xff000000) == 0x7f000000)
    return (true);

  return (false);
}
