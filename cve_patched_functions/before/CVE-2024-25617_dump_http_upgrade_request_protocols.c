dump_http_upgrade_request_protocols(StoreEntry *entry, const char *rawName, HttpUpgradeProtocolAccess *protoGuards)
{
    if (!protoGuards)
        return;

    const SBuf name(rawName);
    protoGuards->forEach([entry,&name](const SBuf &proto, const acl_access *acls) {
        SBufList line;
        line.push_back(name);
        line.push_back(proto);
        const auto acld = acls->treeDump("", &Acl::AllowOrDeny);
        line.insert(line.end(), acld.begin(), acld.end());
        dump_SBufList(entry, line);
    });
}
