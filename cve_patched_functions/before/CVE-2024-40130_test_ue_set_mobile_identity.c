static void test_ue_set_mobile_identity(test_ue_t *test_ue,
    ogs_nas_5gs_mobile_identity_suci_t *mobile_identity_suci,
    const char *scheme_output_string)
{
    ogs_nas_5gs_mobile_identity_t *mobile_identity = NULL;
    uint16_t scheme_output_size;
    uint8_t *scheme_output = NULL;

    ogs_assert(test_ue);
    ogs_assert(mobile_identity_suci);
    ogs_assert(scheme_output_string);

    scheme_output_size = strlen(scheme_output_string)/2;
    scheme_output = ogs_calloc(1, scheme_output_size);
    ogs_assert(scheme_output);

    scheme_output_size = ogs_ascii_to_hex(
            scheme_output_string, strlen(scheme_output_string),
            scheme_output, scheme_output_size);
    ogs_assert(scheme_output_size);

    mobile_identity = &test_ue->mobile_identity;

    mobile_identity->length =
        OGS_NAS_5GS_MOBILE_IDENTITY_SUCI_MIN_SIZE + scheme_output_size;
    mobile_identity->buffer = ogs_calloc(1, mobile_identity->length);
    ogs_assert(mobile_identity->buffer);
    memcpy(mobile_identity->buffer,
            mobile_identity_suci, OGS_NAS_5GS_MOBILE_IDENTITY_SUCI_MIN_SIZE);
    memcpy((uint8_t *)mobile_identity->buffer +
            OGS_NAS_5GS_MOBILE_IDENTITY_SUCI_MIN_SIZE,
            scheme_output, scheme_output_size);

    ogs_free(scheme_output);

    if (test_ue->suci)
        ogs_free(test_ue->suci);
    test_ue->suci = ogs_nas_5gs_suci_from_mobile_identity(mobile_identity);
    if (test_ue->supi)
        ogs_free(test_ue->supi);
    test_ue->supi = ogs_supi_from_suci(test_ue->suci);
    ogs_assert(test_ue->supi);
    if (test_ue->imsi)
        ogs_free(test_ue->imsi);
    test_ue->imsi = ogs_id_get_value(test_ue->supi);
    ogs_assert(test_ue->imsi);

    ogs_bcd_to_buffer(test_ue->imsi, test_ue->imsi_buf, &test_ue->imsi_len);
}
