static char *_consume_scheme(uri_parser_result_t *result, char *uri,
                             char *uri_end, bool *has_authority)
{
    assert(uri);

    /* assume no authority section first */
    *has_authority = false;

    /* cannot have empty scheme */
    if (uri[0] == ':') {
        return NULL;
    }

    char *p = _strchrb(uri, uri_end, ':');

    result->scheme = uri;
    result->scheme_len = p - uri;

    /* check if authority part exists '://' */
    if ((p[1] != '\0') && (p[2] != '\0') && (p[1] == '/') && (p[2] == '/')) {
        *has_authority = true;
        /* skip '://' */
        return p + 3;
    }

    /* skip ':' */
    return p + 1;
}
