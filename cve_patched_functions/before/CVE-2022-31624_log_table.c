static int log_table(const struct connection_info *cn,
                     const struct mysql_event_table *event, const char *type)
{
  size_t csize;
  char message[1024];
  time_t ctime;

  (void) time(&ctime);
  csize= log_header(message, sizeof(message)-1, &ctime,
                    servhost, servhost_len,
                    event->user, SAFE_STRLEN_UI(event->user),
                    event->host, SAFE_STRLEN_UI(event->host),
                    event->ip, SAFE_STRLEN_UI(event->ip),
                    event->thread_id, cn->query_id, type);
  csize+= my_snprintf(message+csize, sizeof(message) - 1 - csize,
            ",%.*s,%.*s,",event->database_length, event->database,
                          event->table_length, event->table);
  message[csize]= '\n';
  return write_log(message, csize + 1, 1);
}
