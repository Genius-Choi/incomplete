GF_List *gf_sm_load_bt_from_string(GF_SceneGraph *in_scene, char *node_str, Bool force_wrl)
{
	GF_SceneLoader ctx;
	GF_BTParser parser;
	memset(&ctx, 0, sizeof(GF_SceneLoader));
	ctx.scene_graph = in_scene;
	memset(&parser, 0, sizeof(GF_BTParser));
	parser.line_buffer = node_str;
	parser.line_size = (u32) strlen(node_str);
	parser.load = &ctx;
	parser.top_nodes = gf_list_new();
	parser.undef_nodes = gf_list_new();
	parser.def_nodes = gf_list_new();
	parser.peeked_nodes = gf_list_new();
	parser.is_wrl = force_wrl;
	gf_bt_loader_run_intern(&parser, NULL, 1);
	gf_list_del(parser.undef_nodes);
	gf_list_del(parser.def_nodes);
	gf_list_del(parser.peeked_nodes);
	while (gf_list_count(parser.def_symbols)) {
		BTDefSymbol *d = (BTDefSymbol *)gf_list_get(parser.def_symbols, 0);
		gf_list_rem(parser.def_symbols, 0);
		gf_free(d->name);
		gf_free(d->value);
		gf_free(d);
	}
	gf_list_del(parser.def_symbols);
	gf_list_del(parser.scripts);

	return parser.top_nodes;
}
