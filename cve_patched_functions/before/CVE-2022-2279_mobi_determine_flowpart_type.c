MOBIFiletype mobi_determine_flowpart_type(const MOBIRawml *rawml, const size_t part_number) {
    if (part_number == 0 || mobi_is_rawml_kf8(rawml) == false) {
        return T_HTML;
    }
    if (part_number > 9999) {
        debug_print("Corrupt part number: %zu\n", part_number);
        return T_UNKNOWN;
    }
    char target[30];
    snprintf(target, 30, "\"kindle:flow:%04zu?mime=", part_number);
    unsigned char *data_start = rawml->flow->data;
    unsigned char *data_end = data_start + rawml->flow->size - 1;
    MOBIResult result;
    MOBI_RET ret = mobi_find_attrvalue(&result, data_start, data_end, T_HTML, target);
    if (ret == MOBI_SUCCESS && result.start) {
        if (strstr(result.value, "text/css")) {
            return T_CSS;
        }
        if (strstr(result.value, "image/svg+xml")) {
            return T_SVG;
        }
    }
    return T_UNKNOWN;
}
