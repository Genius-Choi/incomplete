static int CurrentDeviceOrDie() {
  int current = -1;
  hipError_t result = wrap::hipGetDevice(&current);
  if (result != hipSuccess) {
    LOG(FATAL) << "failed to query current device: " << ToString(result);
  }
  return current;
}
