add_service_name(port_type proto, const guint port, const char *service_name)
{
    serv_port_t *serv_port_table;

    serv_port_table = (serv_port_t *)wmem_map_lookup(serv_port_hashtable, GUINT_TO_POINTER(port));
    if (serv_port_table == NULL) {
        serv_port_table = wmem_new0(addr_resolv_scope, serv_port_t);
        wmem_map_insert(serv_port_hashtable, GUINT_TO_POINTER(port), serv_port_table);
    }

    switch(proto) {
        case PT_TCP:
            wmem_free(addr_resolv_scope, serv_port_table->tcp_name);
            serv_port_table->tcp_name = wmem_strdup(addr_resolv_scope, service_name);
            break;
        case PT_UDP:
            wmem_free(addr_resolv_scope, serv_port_table->udp_name);
            serv_port_table->udp_name = wmem_strdup(addr_resolv_scope, service_name);
            break;
        case PT_SCTP:
            wmem_free(addr_resolv_scope, serv_port_table->sctp_name);
            serv_port_table->sctp_name = wmem_strdup(addr_resolv_scope, service_name);
            break;
        case PT_DCCP:
            wmem_free(addr_resolv_scope, serv_port_table->dccp_name);
            serv_port_table->dccp_name = wmem_strdup(addr_resolv_scope, service_name);
            break;
        default:
            return;
            /* Should not happen */
    }

    new_resolved_objects = TRUE;
}
