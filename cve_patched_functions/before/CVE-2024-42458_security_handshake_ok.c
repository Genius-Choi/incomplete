static int security_handshake_ok(struct nvnc_client* client, const char* username)
{
	if (username) {
		nvnc_log(NVNC_LOG_INFO, "User \"%s\" authenticated", username);

		strncpy(client->username, username, sizeof(client->username));
		client->username[sizeof(client->username) - 1] = '\0';
	}

	uint32_t result = htonl(RFB_SECURITY_HANDSHAKE_OK);
	return stream_write(client->net_stream, &result, sizeof(result), NULL,
			NULL);
}
