static std::string websocket_closed(lua_State *L, void* userp) {
    websocket_closed_data * data = (websocket_closed_data*)userp;
    if (data == NULL) lua_pushnil(L);
    else pushstring(L, data->url);
    if (data->code != 0) {
        pushstring(L, data->reason);
        lua_pushinteger(L, data->code);
    }
    delete data;
    return "websocket_closed";
}
