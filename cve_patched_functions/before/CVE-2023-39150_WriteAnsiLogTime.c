void CEAnsi::WriteAnsiLogTime()
{
	if (!ghAnsiLogFile || !gbAnsiLogCodes)
		return;
	static DWORD last_write_tick_ = 0;

	const DWORD min_diff = 500;
	const DWORD cur_tick = GetTickCount();
	const DWORD cur_diff = cur_tick - last_write_tick_;

	if (!last_write_tick_ || (cur_diff >= min_diff))
	{
		last_write_tick_ = cur_tick;
		SYSTEMTIME st = {};
		GetLocalTime(&st);
		char time_str[40];
		// We should NOT use WriteAnsiLogFormat here!
		msprintf(time_str, std::size(time_str), "\x1B]9;11;\"%02u:%02u:%02u.%03u\"\x7",
			st.wHour, st.wMinute, st.wSecond, st.wMilliseconds);
		WriteAnsiLogUtf8(time_str, static_cast<DWORD>(strlen(time_str)));
	}
}
