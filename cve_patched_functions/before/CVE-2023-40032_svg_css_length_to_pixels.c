svg_css_length_to_pixels( RsvgLength length, double dpi )
{
	double value = length.length;

	/* The following implies that our default font size is 12, which
	 * matches the default in librsvg.
	 */
	double font_size = 12.0;

	switch( length.unit ) {
		case RSVG_UNIT_PX:
			/* Already a pixel value.
			 */
			break;
		case RSVG_UNIT_EM:
			value *= font_size;
			break;
		case RSVG_UNIT_EX:
			value *= font_size / 2.0;
			break;
		case RSVG_UNIT_IN:
			value *= dpi;
			break;
		case RSVG_UNIT_CM:
			/* 2.54 cm in an inch.
			 */
			value = dpi * value / 2.54;
			break;
		case RSVG_UNIT_MM:
			/* 25.4 mm in an inch.
			 */
			value = dpi * value / 25.4;
			break;
		case RSVG_UNIT_PT:
			/* 72 points in an inch.
			 */
			value = dpi * value / 72;
			break;
		case RSVG_UNIT_PC:
			/* 6 picas in an inch.
			 */
			value = dpi * value / 6;
			break;
		default:
			/* Probably RSVG_UNIT_PERCENT. We can't know what the 
			 * pixel value is without more information.
			 */
			value = 0;
	}

	return value;
}
