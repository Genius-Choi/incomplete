__delete_from_uri(char const *location, struct visited_uris *visited_uris)
{
	struct rpki_uri *uri;
	int error;

	/* rfc8181#section-2.2 must be an rsync URI */
	error = uri_create_rsync_str_rrdp(&uri, location, strlen(location));
	if (error)
		return error;

	error = delete_from_uri(uri, visited_uris);

	/* Error 0 is ok */
	uri_refput(uri);
	return error;
}
