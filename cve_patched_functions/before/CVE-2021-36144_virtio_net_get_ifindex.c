virtio_net_get_ifindex(char *devname)
{
	struct ifreq ifr;
	int fd;
	int ifindex = -1;

	fd = socket(AF_UNIX, SOCK_DGRAM, 0);
	if (fd < 0) {
		WPRINTF(("%s: Unable to open control socket", __func__));
		return ifindex;
	}

	memset(&ifr, 0, sizeof(ifr));
	strncpy(ifr.ifr_name, devname, IFNAMSIZ);
	ifr.ifr_name[IFNAMSIZ - 1] = '\0';

	if (ioctl(fd, SIOCGIFINDEX, &ifr) < 0) {
		WPRINTF(("%s: Unable to get interface index on this platform\n", __func__));
	} else {
		ifindex = ifr.ifr_ifindex;
	}

	close(fd);
	return ifindex;
}
