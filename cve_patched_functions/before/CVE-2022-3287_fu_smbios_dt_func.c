fu_smbios_dt_func(void)
{
	const gchar *str;
	gboolean ret;
	g_autofree gchar *path = NULL;
	g_autoptr(FuSmbios) smbios = NULL;
	g_autoptr(GError) error = NULL;

	path = g_test_build_filename(G_TEST_DIST, "tests", "devicetree", "base", NULL);
	smbios = fu_smbios_new();
	ret = fu_smbios_setup_from_path(smbios, path, &error);
	g_assert_no_error(error);
	g_assert_true(ret);
	if (g_getenv("FWUPD_VERBOSE") != NULL) {
		g_autofree gchar *dump = fu_firmware_to_string(FU_FIRMWARE(smbios));
		g_debug("%s", dump);
	}

	/* get vendor */
	str = fu_smbios_get_string(smbios, FU_SMBIOS_STRUCTURE_TYPE_SYSTEM, 0x04, &error);
	g_assert_no_error(error);
	g_assert_cmpstr(str, ==, "Hughski Limited");
}
