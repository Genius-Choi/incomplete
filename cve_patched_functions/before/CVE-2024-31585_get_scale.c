static float get_scale(AVFilterContext *ctx, int scale, float a)
{
    ShowSpectrumContext *s = ctx->priv;
    const float dmin = s->dmin;
    const float dmax = s->dmax;

    a = av_clipf(a, dmin, dmax);
    if (scale != LOG)
        a = (a - dmin) / (dmax - dmin);

    switch (scale) {
    case LINEAR:
        break;
    case SQRT:
        a = sqrtf(a);
        break;
    case CBRT:
        a = cbrtf(a);
        break;
    case FOURTHRT:
        a = sqrtf(sqrtf(a));
        break;
    case FIFTHRT:
        a = powf(a, 0.2f);
        break;
    case LOG:
        a = (s->drange - s->limit + log10f(a) * 20.f) / s->drange;
        break;
    default:
        av_assert0(0);
    }

    return a;
}
