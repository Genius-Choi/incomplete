void writet1(fd_entry *fd)
{
    fd_cur = fd;                /* fd_cur is global inside writet1.c */
    assert(fd_cur->fm != NULL);
    assert(is_type1(fd->fm));
    assert(is_included(fd->fm));

    t1_save_offset = 0;
    if (!is_subsetted(fd_cur->fm)) {    /* include entire font */
        if (!(fd->ff_found = t1_open_fontfile("<<")))
            return;
        t1_include();
        t1_close_font_file(">>");
        return;
    }
    /* partial downloading */
    if (!(fd->ff_found = t1_open_fontfile("<")))
        return;
    t1_subset_ascii_part();
    t1_start_eexec();
    cc_init();
    cs_init();
    t1_read_subrs();
    t1_subset_charstrings();
    t1_subset_end();
    t1_close_font_file(">");
}
