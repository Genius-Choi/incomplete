Adaptation::Ecap::MessageRep::MessageRep(Http::Message *rawHeader):
    theMessage(rawHeader), theFirstLineRep(nullptr),
    theHeaderRep(nullptr), theBodyRep(nullptr)
{
    Must(theMessage.header); // we do not want to represent a missing message

    if (HttpRequest *req = dynamic_cast<HttpRequest*>(theMessage.header))
        theFirstLineRep = new RequestLineRep(*req);
    else if (HttpReply *rep = dynamic_cast<HttpReply*>(theMessage.header))
        theFirstLineRep = new StatusLineRep(*rep);
    else
        Must(false); // unknown message header type

    theHeaderRep = new HeaderRep(*theMessage.header);

    if (theMessage.body_pipe != nullptr)
        theBodyRep = new BodyRep(theMessage.body_pipe);
}
