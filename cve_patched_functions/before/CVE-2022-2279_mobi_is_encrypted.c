bool mobi_is_encrypted(const MOBIData *m) {
    if (m == NULL) {
        debug_print("%s", "Mobi structure not initialized\n");
        return false;
    }
    if ((mobi_is_mobipocket(m) || mobi_is_textread(m)) && m->rh &&
        (m->rh->encryption_type == MOBI_ENCRYPTION_V1 ||
         m->rh->encryption_type == MOBI_ENCRYPTION_V2)) {
        return true;
    }
    return false;
}
