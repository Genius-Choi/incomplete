void SslSocket::onSuccess(SSL* ssl) {
  ctx_->logHandshake(ssl);
  if (callbacks_->connection().streamInfo().upstreamInfo()) {
    callbacks_->connection()
        .streamInfo()
        .upstreamInfo()
        ->upstreamTiming()
        .onUpstreamHandshakeComplete(callbacks_->connection().dispatcher().timeSource());
  } else {
    callbacks_->connection().streamInfo().downstreamTiming().onDownstreamHandshakeComplete(
        callbacks_->connection().dispatcher().timeSource());
  }
  callbacks_->raiseEvent(Network::ConnectionEvent::Connected);
}
