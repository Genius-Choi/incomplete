sasl_user_add(struct hook_user_nick *const restrict data)
{
	// If the user has been killed, don't do anything.
	struct user *const u = data->u;
	if (! u)
		return;

	// Not concerned unless it's an SASL login.
	struct sasl_session *const p = sasl_session_find(u->uid);
	if (! p)
		return;

	(void) sasl_handle_login(p, u, NULL);
	(void) sasl_session_destroy(p);
}
