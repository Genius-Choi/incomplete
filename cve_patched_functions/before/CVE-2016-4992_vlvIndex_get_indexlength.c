vlvIndex_get_indexlength(struct vlvIndex* p, DB *db, back_txn *txn)
{
    if (NULL == p)
        return 0;

    if(!p->vlv_indexlength_cached)
    {
        DBC *dbc = NULL;
        DB_TXN *db_txn = NULL;
        int err= 0;
        if (NULL != txn)
        {
            db_txn = txn->back_txn_txn;
        }
        err = db->cursor(db, db_txn, &dbc, 0);
        if(err==0)
        {
            DBT key= {0};
            DBT data= {0};
            key.flags= DB_DBT_MALLOC;
            data.flags= DB_DBT_MALLOC;
            err= dbc->c_get(dbc,&key,&data,DB_LAST);
            if(err==0)
            {
                slapi_ch_free(&(key.data));
                slapi_ch_free(&(data.data));
                err= dbc->c_get(dbc,&key,&data,DB_GET_RECNO);
                if(err==0)
                {
                    PR_Lock(p->vlv_indexlength_lock);
                    p->vlv_indexlength_cached= 1;
                    p->vlv_indexlength= *((db_recno_t*)data.data);
                    PR_Unlock(p->vlv_indexlength_lock);
                    slapi_ch_free(&(data.data));
                }
            }
            dbc->c_close(dbc);
        }
        else
        {
            /* couldn't get cursor??? */
        }
    }
    return p->vlv_indexlength;
}
