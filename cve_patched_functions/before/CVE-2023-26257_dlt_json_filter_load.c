DltReturnValue dlt_json_filter_load(DltFilter *filter, const char *filename, int verbose)
{
    if ((filter == NULL) || (filename == NULL))
        return DLT_RETURN_WRONG_PARAMETER;

    if(verbose)
        pr_verbose("dlt_json_filter_load()\n");

    json_decoder_t *j_decoder = json_decoder_create();

    const char *s_app_id;
    const char *s_context_id;
    int32_t log_level = 0;
    int32_t payload_max = INT32_MAX;
    int32_t payload_min = 0;

    json_decoder_error_t ret = json_decoder_parse_file(j_decoder, filename);

    if (ret != JSON_DECODER_OK) {
        pr_error("Faild to parse given filter %s: json_decoder_error_t is %i\n", filename, ret);
        return DLT_RETURN_ERROR;
    }

    json_decoder_push_object(j_decoder, NULL, true);

    int iterator = 0;
    bool end_of_json = false;

    while (!end_of_json) {
        if (iterator >= DLT_FILTER_MAX) {
            pr_error("Maximum number (%d) of allowed filters reached, ignoring rest of filters!\n",
                     DLT_FILTER_MAX);
            break;
        }

        if (json_decoder_next(j_decoder) == JSON_DECODER_NOT_FOUND)
            end_of_json = true;

        json_decoder_previous(j_decoder);

        printf("%s:\n", json_decoder_name(j_decoder));
        json_decoder_push_object(j_decoder, NULL, true);

        if (json_decoder_get_string(j_decoder, "AppId", &s_app_id, true) != JSON_DECODER_OK)
            s_app_id = "";

        if (json_decoder_get_string(j_decoder, "ContextId", &s_context_id, true) != JSON_DECODER_OK)
            s_context_id = "";

        if (json_decoder_get_int(j_decoder, "LogLevel", &log_level, true) != JSON_DECODER_OK)
            log_level = 0;

        if (json_decoder_get_int(j_decoder, "PayloadMin", &payload_min, true) != JSON_DECODER_OK)
            payload_min = 0;

        if (json_decoder_get_int(j_decoder, "PayloadMax", &payload_max, true) != JSON_DECODER_OK)
            payload_max = INT32_MAX;

        char app_id[DLT_ID_SIZE];
        char context_id[DLT_ID_SIZE];
        strncpy(app_id, s_app_id, DLT_ID_SIZE);
        strncpy(context_id, s_context_id, DLT_ID_SIZE);

        dlt_filter_add(filter, app_id, context_id, log_level, payload_min, payload_max, verbose);

        printf("\tAppId: %.*s\n", DLT_ID_SIZE, app_id);
        printf("\tConextId: %.*s\n", DLT_ID_SIZE, context_id);
        printf("\tLogLevel: %i\n", log_level);
        printf("\tPayloadMin: %i\n", payload_min);
        printf("\tPayloadMax: %i\n", payload_max);

        json_decoder_pop(j_decoder);

        iterator++;
    }

    json_decoder_destroy(j_decoder);

    return DLT_RETURN_OK;
}
