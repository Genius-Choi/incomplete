IW_IMPL(int) iw_get_value(struct iw_context *ctx, int code)
{
	int ret=0;

	switch(code) {
	case IW_VAL_API_VERSION:
		ret = ctx->caller_api_version;
		break;
	case IW_VAL_CVT_TO_GRAYSCALE:
		ret = ctx->to_grayscale;
		break;
	case IW_VAL_DISABLE_GAMMA:
		ret = ctx->no_gamma;
		break;
	case IW_VAL_NO_CSLABEL:
		ret = ctx->req.suppress_output_cslabel;
		break;
	case IW_VAL_INT_CLAMP:
		ret = ctx->intclamp;
		break;
	case IW_VAL_EDGE_POLICY_X:
		ret = ctx->resize_settings[IW_DIMENSION_H].edge_policy;
		break;
	case IW_VAL_EDGE_POLICY_Y:
		ret = ctx->resize_settings[IW_DIMENSION_V].edge_policy;
		break;
	case IW_VAL_PREF_UNITS:
		ret = ctx->pref_units;
		break;
	case IW_VAL_GRAYSCALE_FORMULA:
		ret = ctx->grayscale_formula;
		break;
	case IW_VAL_INPUT_NATIVE_GRAYSCALE:
		ret = ctx->img1.native_grayscale;
		break;
	case IW_VAL_INPUT_WIDTH:
		if(ctx->img1.width<1) ret=1;
		else ret = ctx->img1.width;
		break;
	case IW_VAL_INPUT_HEIGHT:
		if(ctx->img1.height<1) ret=1;
		else ret = ctx->img1.height;
		break;
	case IW_VAL_INPUT_IMAGE_TYPE:
		ret = ctx->img1.imgtype;
		break;
	case IW_VAL_INPUT_DEPTH:
		ret = ctx->img1.bit_depth;
		break;
	case IW_VAL_COMPRESSION:
		ret = ctx->req.compression;
		break;
	case IW_VAL_PAGE_TO_READ:
		ret = ctx->req.page_to_read;
		break;
	case IW_VAL_INCLUDE_SCREEN:
		ret = ctx->req.include_screen;
		break;
	case IW_VAL_OUTPUT_PALETTE_GRAYSCALE:
		ret = ctx->optctx.palette_is_grayscale;
		break;
	case IW_VAL_OUTPUT_INTERLACED:
		ret = ctx->req.interlaced;
		break;
	case IW_VAL_USE_BKGD_LABEL:
		ret = ctx->req.use_bkgd_label_from_file;
		break;
	case IW_VAL_BMP_NO_FILEHEADER:
		ret = ctx->req.bmp_no_fileheader;
		break;
	case IW_VAL_MAX_WIDTH:
		ret = ctx->max_width;
		break;
	case IW_VAL_MAX_HEIGHT:
		ret = ctx->max_height;
		break;
	case IW_VAL_PRECISION:
		ret = 32;
		break;
	case IW_VAL_NO_BKGD_LABEL:
		ret = ctx->req.suppress_output_bkgd_label;
		break;
	case IW_VAL_INTENT:
		ret = ctx->req.output_rendering_intent;
		break;
	case IW_VAL_OUTPUT_SAMPLE_TYPE:
		ret = ctx->req.output_sample_type;
		break;
	case IW_VAL_OUTPUT_FORMAT:
		ret = ctx->req.output_format;
		break;
	case IW_VAL_NEGATE_TARGET:
		ret = ctx->req.negate_target;
		break;
	}

	return ret;
}
