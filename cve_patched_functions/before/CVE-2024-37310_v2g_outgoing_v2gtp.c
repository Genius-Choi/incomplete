int v2g_outgoing_v2gtp(struct v2g_connection* conn) {
    /* fixup/create header */
    if (write_v2gtpHeader(conn->buffer, conn->buffer_pos - V2GTP_HEADER_LENGTH, V2GTP_EXI_TYPE) != 0) {
        dlog(DLOG_LEVEL_ERROR, "write_v2gtpHeader() failed");
        return -1;
    }

    if (connection_write(conn, conn->buffer, conn->buffer_pos) == -1) {
        dlog(DLOG_LEVEL_ERROR, "connection_write(header) failed: %s", strerror(errno));
        return -1;
    }

    return 0;
}
