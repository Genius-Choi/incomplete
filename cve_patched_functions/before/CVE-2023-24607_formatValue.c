QString QODBCDriver::formatValue(const QSqlField &field,
                                 bool trimStrings) const
{
    QString r;
    if (field.isNull()) {
        r = "NULL"_L1;
    } else if (field.metaType().id() == QMetaType::QDateTime) {
        // Use an escape sequence for the datetime fields
        if (field.value().toDateTime().isValid()){
            QDate dt = field.value().toDateTime().date();
            QTime tm = field.value().toDateTime().time();
            // Dateformat has to be "yyyy-MM-dd hh:mm:ss", with leading zeroes if month or day < 10
            r = "{ ts '"_L1 +
                QString::number(dt.year()) + u'-' +
                QString::number(dt.month()).rightJustified(2, u'0', true) +
                u'-' +
                QString::number(dt.day()).rightJustified(2, u'0', true) +
                u' ' +
                tm.toString() +
                "' }"_L1;
        } else
            r = "NULL"_L1;
    } else if (field.metaType().id() == QMetaType::QByteArray) {
        QByteArray ba = field.value().toByteArray();
        QString res;
        static const char hexchars[] = "0123456789abcdef";
        for (int i = 0; i < ba.size(); ++i) {
            uchar s = (uchar) ba[i];
            res += QLatin1Char(hexchars[s >> 4]);
            res += QLatin1Char(hexchars[s & 0x0f]);
        }
        r = "0x"_L1 + res;
    } else {
        r = QSqlDriver::formatValue(field, trimStrings);
    }
    return r;
}
