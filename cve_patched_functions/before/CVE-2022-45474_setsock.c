  void setsock(int *fdp, curl_socket_t s, CURL *e, int act, int oldact, drachtio::RequestHandler::GlobalInfo *g) {
    std::shared_ptr<RequestHandler> p = RequestHandler::getInstance() ;
    std::map<curl_socket_t, boost::asio::ip::tcp::socket *>& socket_map = p->getSocketMap() ;

    std::map<curl_socket_t, boost::asio::ip::tcp::socket *>::iterator it =
      socket_map.find(s);

    if(it == socket_map.end()) {
      return;
    }

    boost::asio::ip::tcp::socket * tcp_socket = it->second;

    *fdp = act;

    if(act == CURL_POLL_IN) {
      if(oldact != CURL_POLL_IN && oldact != CURL_POLL_INOUT) {
        tcp_socket->async_read_some(boost::asio::null_buffers(),
                                    boost::bind(&event_cb, g, s,
                                                CURL_POLL_IN, boost::placeholders::_1, fdp));
      }
    }
    else if(act == CURL_POLL_OUT) {
      if(oldact != CURL_POLL_OUT && oldact != CURL_POLL_INOUT) {
        tcp_socket->async_write_some(boost::asio::null_buffers(),
                                     boost::bind(&event_cb, g, s,
                                                 CURL_POLL_OUT, boost::placeholders::_1, fdp));
      }
    }
    else if(act == CURL_POLL_INOUT) {
      if(oldact != CURL_POLL_IN && oldact != CURL_POLL_INOUT) {
        tcp_socket->async_read_some(boost::asio::null_buffers(),
                                    boost::bind(&event_cb, g, s,
                                                CURL_POLL_IN, boost::placeholders::_1, fdp));
      }
      if(oldact != CURL_POLL_OUT && oldact != CURL_POLL_INOUT) {
        tcp_socket->async_write_some(boost::asio::null_buffers(),
                                     boost::bind(&event_cb, g, s,
                                                 CURL_POLL_OUT, boost::placeholders::_1, fdp));
      }
    }
  }
