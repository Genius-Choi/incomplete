void uwsgi_fix_range_for_size(enum uwsgi_range* parsed, int64_t* from, int64_t* to, int64_t size) {
        if (*parsed != UWSGI_RANGE_PARSED) {
                return;
        }
        if (*from < 0) {
                *from = size + *from;
        }
        if (*to > size-1) {
                *to = size-1;
        }
        if (*from == 0 && *to == size-1) {
                /* we have a right to reset to 200 OK answer */
                *parsed = UWSGI_RANGE_NOT_PARSED;
        }
        else if (*to >= *from) {
                *parsed = UWSGI_RANGE_VALID;
        }
        else { /* case *from > size-1 is also handled here */
                *parsed = UWSGI_RANGE_INVALID;
                *from = 0;
                *to = 0;
        }
}
