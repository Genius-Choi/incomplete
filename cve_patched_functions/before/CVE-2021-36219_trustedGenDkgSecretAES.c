trustedGenDkgSecretAES(int *errStatus, char *errString, uint8_t *encrypted_dkg_secret, uint32_t *enc_len, size_t _t) {

    LOG_DEBUG (__FUNCTION__);

    char dkg_secret[DKG_BUFER_LENGTH];// = (char*)calloc(DKG_BUFER_LENGTH, 1);
    memset(dkg_secret, 0, DKG_BUFER_LENGTH);

    if (gen_dkg_poly(dkg_secret, _t) != 0) {
        *errStatus = -1;
        return;
    }

    snprintf(errString, BUF_LEN, "poly is %s ", dkg_secret);

    int status = AES_encrypt(dkg_secret, encrypted_dkg_secret);

    if (status != SGX_SUCCESS) {
        snprintf(errString, BUF_LEN, "SGX AES encrypt DKG poly failed");
        *errStatus = status;
        return;
    }

    *enc_len = strlen(dkg_secret) + SGX_AESGCM_MAC_SIZE + SGX_AESGCM_IV_SIZE;


    char decr_dkg_secret[DKG_BUFER_LENGTH];
    memset(decr_dkg_secret, 0, DKG_BUFER_LENGTH);

    status = AES_decrypt(encrypted_dkg_secret, *enc_len, decr_dkg_secret);
    if (status != SGX_SUCCESS) {
        snprintf(errString, BUF_LEN, "aes decrypt  dkg poly failed");
        *errStatus = status;
        return;
    }

    if (strcmp(dkg_secret, decr_dkg_secret) != 0) {
        snprintf(errString, BUF_LEN, "poly is %s ", dkg_secret);
        snprintf(errString + strlen(dkg_secret) + 8, BUF_LEN - strlen(dkg_secret) - 8,
                 "encrypted poly is not equal to decrypted poly");
        *errStatus = -333;
    }


}
