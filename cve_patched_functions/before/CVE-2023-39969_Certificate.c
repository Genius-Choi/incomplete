Certificate::Certificate(X509 *cert) {
  auto subject = impl::OpenSSL_ptr(X509_NAME_oneline(X509_get_subject_name(cert), nullptr, 0),
                                   impl::OpenSSL_free);
  auto issuer = impl::OpenSSL_ptr(X509_NAME_oneline(X509_get_issuer_name(cert), nullptr, 0),
                                  impl::OpenSSL_free);
  auto serial_bn = impl::BN_ptr(ASN1_INTEGER_to_BN(X509_get_serialNumber(cert), nullptr), BN_free);
  auto serial_number = impl::OpenSSL_ptr(BN_bn2hex(serial_bn.get()), impl::OpenSSL_free);

  subject_ = std::string(subject.get());
  issuer_ = std::string(issuer.get());
  serial_number_ = std::string(serial_number.get());
}
