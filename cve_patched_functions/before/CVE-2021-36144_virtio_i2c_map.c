virtio_i2c_map(struct virtio_i2c *vi2c)
{
	int i, client_addr;
	struct native_i2c_adapter *native_adapter;

	/*
	 * Flatten the map for client address and native adapter to the array:
	 *
	 * adapter_map[MAX_I2C_VDEV]:
	 *
	 * Native Adapter | adapter2 | none  | adapter1 | adapter3 | none | none| (val)
	 *                |----------|-------|----------|----------|------|-----|
	 * Slave Address  | addr 1   | none  | addr 2   | addr 3   | none | none| (idx)
	 *                |<-----------------------MAX_I2C_VDEV---------------->|
	 */
	for (i = 0; i < vi2c->native_adapter_num; i++) {
		native_adapter = vi2c->native_adapter[i];
		for (client_addr = 0; client_addr < MAX_I2C_VDEV; client_addr++) {
			if (native_adapter->i2cdev_enable[client_addr]) {
				if (vi2c->adapter_map[client_addr]) {
					WPRINTF("client addr %x repeat, not support!\n", client_addr);
					return -1;
				}
				/* As 0 is the initiate value, + 1 for index */
				vi2c->adapter_map[client_addr] = i + 1;
				DPRINTF("client:%d -> native adapter: %d\n",
							client_addr,
							native_adapter->bus);
			}
		}
	}
	return 0;
}
