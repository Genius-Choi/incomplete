tee_svc_obj_generate_key_x25519(struct tee_obj *o,
				const struct tee_cryp_obj_type_props
							*type_props,
				uint32_t key_size,
				const TEE_Attribute *params,
				uint32_t param_count)
{
	TEE_Result res = TEE_ERROR_GENERIC;
	struct x25519_keypair *tee_x25519_key = NULL;

	/* Copy the present attributes into the obj before starting */
	res = tee_svc_cryp_obj_populate_type(o, type_props, params,
					     param_count);
	if (res != TEE_SUCCESS)
		return res;

	tee_x25519_key = (struct x25519_keypair *)o->attr;

	res = crypto_acipher_gen_x25519_key(tee_x25519_key, key_size);
	if (res != TEE_SUCCESS)
		return res;

	/* Set bits for the generated public and private key */
	set_attribute(o, type_props, TEE_ATTR_X25519_PRIVATE_VALUE);
	set_attribute(o, type_props, TEE_ATTR_X25519_PUBLIC_VALUE);
	return TEE_SUCCESS;
}
