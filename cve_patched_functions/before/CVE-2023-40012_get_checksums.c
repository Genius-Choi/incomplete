std::vector<Checksum> get_checksums(peparse::parsed_pe *pe) {
  std::vector<Checksum> checksums;
  const auto &certs = read_certs(pe);
  if (certs.empty()) {
    return checksums;
  }

  for (const auto &cert : certs) {
    auto signed_data = cert.as_signed_data();
    if (!signed_data) {
      continue;
    }

    checksums.push_back(signed_data->get_checksum());
  }

  return checksums;
}
