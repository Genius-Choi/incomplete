static void on_underlying_io_error(void* context)
{
    if (context != NULL)
    {
        TLS_IO_INSTANCE* tls_io_instance = (TLS_IO_INSTANCE*)context;

        switch (tls_io_instance->tlsio_state)
        {
        default:
            LogError("Unknown TLS IO WolfSSL state: %d", (int)tls_io_instance->tlsio_state);
            break;

        case TLSIO_STATE_NOT_OPEN:
        case TLSIO_STATE_ERROR:
            break;

        case TLSIO_STATE_OPENING_UNDERLYING_IO:
        case TLSIO_STATE_IN_HANDSHAKE:
            tls_io_instance->tlsio_state = TLSIO_STATE_ERROR;
            indicate_open_complete(tls_io_instance, IO_OPEN_ERROR);
            break;

        case TLSIO_STATE_OPEN:
            tls_io_instance->tlsio_state = TLSIO_STATE_ERROR;
            indicate_error(tls_io_instance);
            break;
        }
    }
    else
    {
        LogInfo("Supplied context is NULL on io_error");
    }
}
