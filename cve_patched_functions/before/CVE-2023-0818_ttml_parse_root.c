GF_Err ttml_parse_root(GF_XMLNode *root, const char **lang, u32 *tick_rate, u32 *ttml_fps_num, u32 *ttml_fps_den, u32 *ttml_sfps)
{
	/*** root (including language) ***/
	GF_XMLAttribute *att;
	u32 i;
	u32 sub_fps_num = 0;
	u32 sub_fps_den = 0;
	i=0;
	*lang = NULL;
	*tick_rate = 0;
	*ttml_fps_num = 0;
	*ttml_fps_den = 0;
	*ttml_sfps = 0;

	while ( (att = (GF_XMLAttribute *)gf_list_enum(root->attributes, &i))) {
		const char *att_name;
		GF_LOG(GF_LOG_DEBUG, GF_LOG_PARSER, ("[TTML] Found root attribute name %s, value %s\n", att->name, att->value));

		att_name = strchr(att->name, ':');
		if (att_name) att_name++;
		else att_name = att->name;

		if (!strcmp(att->name, "xmlns")) {
			if (strcmp(att->value, TTML_NAMESPACE)) {
				GF_LOG(GF_LOG_ERROR, GF_LOG_PARSER, ("[TTML] XML Namespace %s not recognized, expecting %s\n", att->name, att->value, TTML_NAMESPACE));
				return GF_NON_COMPLIANT_BITSTREAM;
			}
		}
		else if (!strcmp(att->name, "xml:lang") && att->value && strlen(att->value)) {
			*lang = att->value;
		}
		else if (!strcmp(att_name, "tickRate") && att->value) {
			*tick_rate = atoi(att->value);
		}
		else if (!strcmp(att_name, "frameRate") && att->value) {
			*ttml_fps_num = atoi(att->value);
			*ttml_fps_den = 1;
		}
		else if (!strcmp(att_name, "frameRateMultiplier") && att->value) {
			char *sep = strchr(att->value, ' ');
			if (!sep) sep = strchr(att->value, '\t');
			if (sep) {
				u8 c = sep[0];
				sep[0] = 0;
				sub_fps_num = atoi(sep);
				sep[0] = c;
				while ((sep[0]==' ') || (sep[0]=='\t'))
					sep++;
				sub_fps_den = atoi(sep);
			}
		}
		else if (!strcmp(att_name, "subFrameRate") && att->value) {
			*ttml_sfps = atoi(att->value);
		}
	}

	if (sub_fps_num && sub_fps_den && *ttml_fps_num) {
		*ttml_fps_num *= sub_fps_num;
		*ttml_fps_den = sub_fps_den;
	}
	return GF_OK;
}
