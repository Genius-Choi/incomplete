PJ_DEF(pj_status_t) pjmedia_rtp_session_init2( 
				    pjmedia_rtp_session *ses,
				    pjmedia_rtp_session_setting settings)
{
    pj_status_t status;
    int		 pt = 0;
    pj_uint32_t	 sender_ssrc = 0;

    if (settings.flags & 1)
	pt = settings.default_pt;
    if (settings.flags & 2)
	sender_ssrc = settings.sender_ssrc;

    status = pjmedia_rtp_session_init(ses, pt, sender_ssrc);
    if (status != PJ_SUCCESS)
	return status;

    if (settings.flags & 4) {
	ses->out_extseq = settings.seq;
	ses->out_hdr.seq = pj_htons((pj_uint16_t)ses->out_extseq);
    }
    if (settings.flags & 8)
	ses->out_hdr.ts = pj_htonl(settings.ts);
    if (settings.flags & 16) {
        ses->has_peer_ssrc = PJ_TRUE;
	ses->peer_ssrc = settings.peer_ssrc;
    }

    PJ_LOG(5, (THIS_FILE,
	       "pjmedia_rtp_session_init2: ses=%p, seq=%d, ts=%d, peer_ssrc=%d",
	       ses, pj_ntohs(ses->out_hdr.seq), pj_ntohl(ses->out_hdr.ts),
	       ses->has_peer_ssrc? ses->peer_ssrc : 0));

    return PJ_SUCCESS;
}
