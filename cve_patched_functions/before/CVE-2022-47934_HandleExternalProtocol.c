bool BraveContentBrowserClient::HandleExternalProtocol(
    const GURL& url,
    content::WebContents::Getter web_contents_getter,
    int frame_tree_node_id,
    content::NavigationUIData* navigation_data,
    bool is_primary_main_frame,
    bool is_in_fenced_frame_tree,
    network::mojom::WebSandboxFlags sandbox_flags,
    ui::PageTransition page_transition,
    bool has_user_gesture,
    const absl::optional<url::Origin>& initiating_origin,
    content::RenderFrameHost* initiator_document,
    mojo::PendingRemote<network::mojom::URLLoaderFactory>* out_factory) {
#if BUILDFLAG(ENABLE_BRAVE_WEBTORRENT)
  if (webtorrent::IsMagnetProtocol(url)) {
    auto weak_initiator_document =
        initiator_document ? initiator_document->GetWeakDocumentPtr()
                           : content::WeakDocumentPtr();

    webtorrent::HandleMagnetProtocol(url, web_contents_getter, page_transition,
                                     has_user_gesture, is_in_fenced_frame_tree,
                                     initiating_origin,
                                     std::move(weak_initiator_document));
    return true;
  }
#endif

  if (brave_rewards::IsRewardsProtocol(url)) {
    brave_rewards::HandleRewardsProtocol(url, web_contents_getter,
                                         page_transition, has_user_gesture);
    return true;
  }

#if BUILDFLAG(BINANCE_ENABLED)
  if (binance::IsBinanceProtocol(url)) {
    binance::HandleBinanceProtocol(url, web_contents_getter, page_transition,
                                   has_user_gesture, initiating_origin);
    return true;
  }
#endif

#if BUILDFLAG(GEMINI_ENABLED)
  if (gemini::IsGeminiProtocol(url)) {
    gemini::HandleGeminiProtocol(url, web_contents_getter, page_transition,
                                 has_user_gesture, initiating_origin);
    return true;
  }
#endif

#if BUILDFLAG(ENABLE_FTX)
  if (ftx::IsFTXProtocol(url)) {
    ftx::HandleFTXProtocol(url, web_contents_getter, page_transition,
                           has_user_gesture, initiating_origin);
    return true;
  }
#endif

  return ChromeContentBrowserClient::HandleExternalProtocol(
      url, web_contents_getter, frame_tree_node_id, navigation_data,
      is_primary_main_frame, is_in_fenced_frame_tree, sandbox_flags,
      page_transition, has_user_gesture, initiating_origin, initiator_document,
      out_factory);
}
