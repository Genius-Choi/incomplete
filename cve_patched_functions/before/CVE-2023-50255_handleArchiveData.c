bool LibzipPlugin::handleArchiveData(zip_t *archive, zip_int64_t index)
{
    if (nullptr == archive) {
        return false;
    }

    zip_stat_t statBuffer;
    if (zip_stat_index(archive, zip_uint64_t(index), ZIP_FL_ENC_RAW, &statBuffer)) {
        return false;
    }

    QByteArray strCode;
    // 对文件名进行编码探测并转码
    QString name = m_common->trans2uft8(statBuffer.name, strCode);
    m_mapFileCode[index] = strCode;
    if(name.contains(QLatin1Char('\\')))
        name = name.replace(QLatin1Char('\\'), QDir::separator());
    //对于名称以"/"开头的去除开始的"/"
    if(name.startsWith(QDir::separator())) {
        name.remove(0,1);
    }
    FileEntry entry;
    entry.iIndex = int(index);
    entry.strFullPath = name;
    statBuffer2FileEntry(statBuffer, entry);

    handleEntry(entry);

    // 存储总数据
    DataManager::get_instance().archiveData().mapFileEntry[name] = entry;

    return true;
}
