crc32_hashn(char *str, size_t n)
{
	uint32_t crc = 0xffffffff;
	while (n >= 8) {
		crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		n -= 8;
	}
	if (n)
		do {
			crc = crc32_table[((int)crc ^ (*str++)) & 0xff] ^ (crc >> 8);
		} while (--n);
	return crc ^ 0xffffffff;
}
