process_input_readline(char *l)
{
	if (NULL == l)
	{
		gRet = ERRORCODE_QUIT;
		rl_callback_handler_remove();
		return;
	}

	process_input_line(l);
	if (istty) {
#if HAVE_RL_SET_PROMPT
		if (gRet == ERRORCODE_QUIT)
			rl_set_prompt("");
		else
#endif
		rl_callback_handler_install(
		    get_current_prompt(), &process_input_readline);
	}
}
