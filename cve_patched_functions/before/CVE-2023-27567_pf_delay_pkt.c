pf_delay_pkt(struct mbuf *m, u_int ifidx)
{
	struct pf_pktdelay	*pdy;

	if ((pdy = pool_get(&pf_pktdelay_pl, PR_NOWAIT)) == NULL) {
		m_freem(m);
		return (ENOBUFS);
	}
	pdy->ifidx = ifidx;
	pdy->m = m;
	timeout_set(&pdy->to, pf_pktenqueue_delayed, pdy);
	timeout_add_msec(&pdy->to, m->m_pkthdr.pf.delay);
	m->m_pkthdr.pf.delay = 0;
	return (0);
}
