inline bool zero_return(int error, int rc, int errno_copy) {
  if (error == SSL_ERROR_ZERO_RETURN || (rc == 0 && errno_copy == 0)) {
    return true;
  }
#ifdef _WIN32
  // on windows underlying TCP socket may error with this code
  // if the sending/receiving client crashes or is killed
  if (error == SSL_ERROR_SYSCALL && errno_copy == WSAECONNRESET) {
    return true;
  }
#endif
  return false;
}
