BOOL rfx_compose_message(RFX_CONTEXT* context, wStream* s, const RFX_RECT* rects, size_t numRects,
                         const BYTE* data, UINT32 width, UINT32 height, UINT32 scanline)
{
	WINPR_ASSERT(context);
	RFX_MESSAGE* message =
	    rfx_encode_message(context, rects, numRects, data, width, height, scanline);
	if (!message)
		return FALSE;

	const BOOL ret = rfx_write_message(context, s, message);
	rfx_message_free(context, message);
	return ret;
}
