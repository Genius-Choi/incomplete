static req::ptr<LdapResult> get_valid_ldap_result_resource(const Resource& result) {
  auto res = dyn_cast_or_null<LdapResult>(result);
  if (res == nullptr || res->isInvalid()) {
    raise_warning("Not a valid ldap result resource");
    return nullptr;
  }
  return res;
}
