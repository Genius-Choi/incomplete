MOBI_RET mobi_add_font_resource(MOBIPart *part) {
    unsigned char *data = NULL;
    size_t size = 0;
    MOBI_RET ret = mobi_decode_font_resource(&data, &size, part);
    if (ret != MOBI_SUCCESS) {
        return ret;
    }
    part->data = data;
    part->size = size;
    part->type = mobi_determine_font_type(data, size);
    /* FIXME: mark unknown font types as ttf (shouldn't happen).
       This will allow proper font resource deallocation. */
    if (part->type == T_UNKNOWN) { part->type = T_TTF; }
    return MOBI_SUCCESS;
}
