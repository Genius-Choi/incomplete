static int _r_verify_signature(jws_t * jws, jwk_t * jwk, jwa_alg alg, int x5u_flags) {
  int ret;

  switch (alg) {
    case R_JWA_ALG_HS256:
    case R_JWA_ALG_HS384:
    case R_JWA_ALG_HS512:
      if (r_jwk_key_type(jwk, NULL, x5u_flags) & R_KEY_TYPE_HMAC) {
        ret = r_jws_verify_sig_hmac(jws, jwk);
      } else {
        ret = RHN_ERROR_INVALID;
      }
      break;
    case R_JWA_ALG_RS256:
    case R_JWA_ALG_RS384:
    case R_JWA_ALG_RS512:
    case R_JWA_ALG_PS256:
    case R_JWA_ALG_PS384:
    case R_JWA_ALG_PS512:
      if (r_jwk_key_type(jwk, NULL, x5u_flags) & R_KEY_TYPE_RSA) {
        ret = r_jws_verify_sig_rsa(jws, jwk, x5u_flags);
      } else {
        ret = RHN_ERROR_INVALID;
      }
      break;
    case R_JWA_ALG_ES256:
    case R_JWA_ALG_ES384:
    case R_JWA_ALG_ES512:
      if (r_jwk_key_type(jwk, NULL, x5u_flags) & R_KEY_TYPE_EC) {
        ret = r_jws_verify_sig_ecdsa(jws, jwk, x5u_flags);
      } else {
        ret = RHN_ERROR_INVALID;
      }
      break;
    case R_JWA_ALG_EDDSA:
      if (r_jwk_key_type(jwk, NULL, x5u_flags) & R_KEY_TYPE_EDDSA) {
        ret = r_jws_verify_sig_eddsa(jws, jwk, x5u_flags);
      } else {
        ret = RHN_ERROR_INVALID;
      }
      break;
#if 0
    case R_JWA_ALG_ES256K:
      if (r_jwk_key_type(jwk, NULL, x5u_flags) & R_KEY_TYPE_EC) {
        ret = r_jws_verify_sig_es256k(jws, jwk, x5u_flags);
      } else {
        ret = RHN_ERROR_INVALID;
      }
      break;
#endif
    default:
      ret = RHN_ERROR_INVALID;
      break;
  }
  return ret;
}
