GF_Err gf_isom_set_emsg(GF_ISOFile *movie, u8 *data, u32 size)
{
	if (!movie || !data) return GF_BAD_PARAM;
#ifndef GPAC_DISABLE_ISOM_FRAGMENTS
	if (!movie->moof) return GF_BAD_PARAM;

	GF_BitStream *bs = gf_bs_new(data, size, GF_BITSTREAM_READ);
	while (gf_bs_available(bs)) {
		GF_Box *emsg;
		GF_Err e = gf_isom_box_parse(&emsg, bs);
		if (e) break;

		if (!movie->moof->emsgs) movie->moof->emsgs = gf_list_new();
		gf_list_add(movie->moof->emsgs, emsg);
	}
	gf_bs_del(bs);
#endif
	return GF_OK;
}
