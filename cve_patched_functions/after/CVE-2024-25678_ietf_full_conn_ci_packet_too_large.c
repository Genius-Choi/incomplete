ietf_full_conn_ci_packet_too_large (struct lsquic_conn *lconn,
                                   struct lsquic_packet_out *packet_out)
{
    struct ietf_full_conn *conn = (struct ietf_full_conn *) lconn;

#ifndef NDEBUG
    assert(packet_out->po_lflags & POL_HEADER_PROT);
#endif

    if (packet_out->po_flags & PO_MTU_PROBE)
    {
        LSQ_DEBUG("%zu-byte MTU probe in packet %"PRIu64" is too large",
            lsquic_packet_out_sent_sz(&conn->ifc_conn, packet_out),
            packet_out->po_packno);
        lsquic_send_ctl_mtu_not_sent(&conn->ifc_send_ctl, packet_out);
        mtu_probe_too_large(conn, packet_out);
    }
    else
        ABORT_WARN("non-MTU probe %zu-byte packet %"PRIu64" is too large",
            lsquic_packet_out_sent_sz(&conn->ifc_conn, packet_out),
            packet_out->po_packno);

    lsquic_packet_out_destroy(packet_out, conn->ifc_enpub,
                                            packet_out->po_path->np_peer_ctx);
}
