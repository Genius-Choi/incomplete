mmsClient_createFileOpenRequest(uint32_t invokeId, ByteBuffer* request, const char* fileName, uint32_t initialPosition)
{
    uint32_t invokeIdSize = BerEncoder_UInt32determineEncodedSize(invokeId);

    uint32_t fileNameStringSize = strlen(fileName);
    uint32_t fileNameSize = 1 + BerEncoder_determineLengthSize(fileNameStringSize) + fileNameStringSize;

    uint32_t fileNameSeqSize = fileNameSize;

    uint32_t fileOpenRequestSize = 1 + BerEncoder_determineLengthSize(fileNameSeqSize) + fileNameSeqSize + 2 + BerEncoder_UInt32determineEncodedSize(initialPosition);

    uint32_t confirmedRequestPduSize = 2  + invokeIdSize + 2 + BerEncoder_determineLengthSize(fileOpenRequestSize) + fileOpenRequestSize;

    int bufPos = 0;
    uint8_t* buffer = request->buffer;

    bufPos = BerEncoder_encodeTL(0xa0, confirmedRequestPduSize, buffer, bufPos);
    bufPos = BerEncoder_encodeTL(0x02, invokeIdSize, buffer, bufPos);
    bufPos = BerEncoder_encodeUInt32(invokeId, buffer, bufPos);

    /* Encode FileOpen tag (context | structured ) [72 = 48h] */
    buffer[bufPos++] = 0xbf;
    buffer[bufPos++] = 0x48;
    bufPos = BerEncoder_encodeLength(fileOpenRequestSize, buffer, bufPos);

    bufPos = BerEncoder_encodeTL(0xa0, fileNameSeqSize, buffer, bufPos);
    bufPos = BerEncoder_encodeOctetString(0x19, (uint8_t*) fileName, fileNameStringSize, buffer, bufPos);

    bufPos = BerEncoder_encodeUInt32WithTL(0x81, initialPosition, buffer, bufPos);

    request->size = bufPos;
}
