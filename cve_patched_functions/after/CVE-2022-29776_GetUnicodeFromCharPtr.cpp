    std::wstring CUtf8Converter::GetUnicodeFromCharPtr(const char* pData, LONG lCount, INT bIsUtf8)
    {
        if (bIsUtf8)
            return GetUnicodeStringFromUTF8((BYTE*)pData, lCount);

        wchar_t* pUnicode = new wchar_t[lCount + 1];
        for (LONG i = 0; i < lCount; ++i)
            pUnicode[i] = (wchar_t)(BYTE)pData[i];

        pUnicode[lCount] = 0;

        std::wstring s(pUnicode, lCount);
        RELEASEARRAYOBJECTS(pUnicode);

        return s;
    }
