static void arith4(void) {
	ep4_t p, q, r, t[RLC_EPX_TABLE_MAX];
	bn_t k, n, l;
	fp4_t s;

	ep4_null(p);
	ep4_null(q);
	ep4_null(r);
	bn_null(k);
	bn_null(n);
	fp4_null(s);
	for (int i = 0; i < RLC_EPX_TABLE_MAX; i++) {
		ep4_null(t[i]);
	}

	ep4_new(p);
	ep4_new(q);
	ep4_new(r);
	bn_new(k);
	bn_new(n);
	bn_new(l);
	fp4_new(s);

	ep4_curve_get_ord(n);

	BENCH_RUN("ep4_add") {
		ep4_rand(p);
		ep4_rand(q);
		ep4_add(p, p, q);
		ep4_rand(q);
		ep4_rand(p);
		ep4_add(q, q, p);
		BENCH_ADD(ep4_add(r, p, q));
	}
	BENCH_END;

#if EP_ADD == BASIC || !defined(STRIP)
	BENCH_RUN("ep4_add_basic") {
		ep4_rand(p);
		ep4_rand(q);
		BENCH_ADD(ep4_add_basic(r, p, q));
	}
	BENCH_END;

	BENCH_RUN("ep4_add_slp_basic") {
		ep4_rand(p);
		ep4_rand(q);
		BENCH_ADD(ep4_add_slp_basic(r, s, p, q));
	}
	BENCH_END;
#endif

#if EP_ADD == PROJC || !defined(STRIP)
	BENCH_RUN("ep4_add_projc") {
		ep4_rand(p);
		ep4_rand(q);
		ep4_add_projc(p, p, q);
		ep4_rand(q);
		ep4_rand(p);
		ep4_add_projc(q, q, p);
		BENCH_ADD(ep4_add_projc(r, p, q));
	}
	BENCH_END;

	BENCH_RUN("ep4_add_projc (z2 = 1)") {
		ep4_rand(p);
		ep4_rand(q);
		ep4_add_projc(p, p, q);
		ep4_rand(q);
		ep4_norm(q, q);
		BENCH_ADD(ep4_add_projc(r, p, q));
	}
	BENCH_END;

	BENCH_RUN("ep4_add_projc (z1,z2 = 1)") {
		ep4_rand(p);
		ep4_norm(p, p);
		ep4_rand(q);
		ep4_norm(q, q);
		BENCH_ADD(ep4_add_projc(r, p, q));
	}
	BENCH_END;
#endif

	BENCH_RUN("ep4_sub") {
		ep4_rand(p);
		ep4_rand(q);
		ep4_add(p, p, q);
		ep4_rand(q);
		ep4_rand(p);
		ep4_add(q, q, p);
		BENCH_ADD(ep4_sub(r, p, q));
	}
	BENCH_END;

	BENCH_RUN("ep4_dbl") {
		ep4_rand(p);
		ep4_rand(q);
		ep4_add(p, p, q);
		BENCH_ADD(ep4_dbl(r, p));
	}
	BENCH_END;

#if EP_ADD == BASIC || !defined(STRIP)
	BENCH_RUN("ep4_dbl_basic") {
		ep4_rand(p);
		BENCH_ADD(ep4_dbl_basic(r, p));
	}
	BENCH_END;

	BENCH_RUN("ep4_dbl_slp_basic") {
		ep4_rand(p);
		BENCH_ADD(ep4_dbl_slp_basic(r, s, p));
	}
	BENCH_END;
#endif

#if EP_ADD == PROJC || !defined(STRIP)
	BENCH_RUN("ep4_dbl_projc") {
		ep4_rand(p);
		ep4_rand(q);
		ep4_add_projc(p, p, q);
		BENCH_ADD(ep4_dbl_projc(r, p));
	}
	BENCH_END;

	BENCH_RUN("ep4_dbl_projc (z1 = 1)") {
		ep4_rand(p);
		ep4_norm(p, p);
		BENCH_ADD(ep4_dbl_projc(r, p));
	}
	BENCH_END;
#endif

	BENCH_RUN("ep4_neg") {
		ep4_rand(p);
		ep4_rand(q);
		ep4_add(p, p, q);
		BENCH_ADD(ep4_neg(r, p));
	}
	BENCH_END;

	BENCH_RUN("ep4_mul") {
		bn_rand_mod(k, n);
		BENCH_ADD(ep4_mul(q, p, k));
	} BENCH_END;

#if EP_MUL == BASIC || !defined(STRIP)
	BENCH_RUN("ep4_mul_basic") {
		bn_rand_mod(k, n);
		BENCH_ADD(ep4_mul_basic(q, p, k));
	} BENCH_END;
#endif

#if EP_MUL == SLIDE || !defined(STRIP)
	BENCH_RUN("ep4_mul_slide") {
		bn_rand_mod(k, n);
		ep4_rand(p);
		BENCH_ADD(ep4_mul_slide(q, p, k));
	} BENCH_END;
#endif

#if EP_MUL == MONTY || !defined(STRIP)
	BENCH_RUN("ep4_mul_monty") {
		bn_rand_mod(k, n);
		ep4_rand(p);
		BENCH_ADD(ep4_mul_monty(q, p, k));
	} BENCH_END;
#endif

#if EP_MUL == LWNAF || !defined(STRIP)
	BENCH_RUN("ep4_mul_lwnaf") {
		bn_rand_mod(k, n);
		ep4_rand(p);
		BENCH_ADD(ep4_mul_lwnaf(q, p, k));
	} BENCH_END;
#endif

	BENCH_RUN("ep4_mul_gen") {
		bn_rand_mod(k, n);
		BENCH_ADD(ep4_mul_gen(q, k));
	} BENCH_END;

	BENCH_RUN("ep4_mul_dig") {
		bn_rand(k, RLC_POS, RLC_DIG);
		bn_rand_mod(k, n);
		BENCH_ADD(ep4_mul_dig(p, q, k->dp[0]));
	}
	BENCH_END;

	for (int i = 0; i < RLC_EPX_TABLE_MAX; i++) {
		ep4_new(t[i]);
	}

	BENCH_RUN("ep4_mul_pre") {
		ep4_rand(p);
		BENCH_ADD(ep4_mul_pre(t, p));
	} BENCH_END;

	BENCH_RUN("ep4_mul_fix") {
		bn_rand_mod(k, n);
		ep4_rand(p);
		ep4_mul_pre(t, p);
		BENCH_ADD(ep4_mul_fix(q, t, k));
	} BENCH_END;

	for (int i = 0; i < RLC_EPX_TABLE_MAX; i++) {
		ep4_free(t[i]);
	}

#if EP_FIX == BASIC || !defined(STRIP)
	for (int i = 0; i < RLC_EPX_TABLE_BASIC; i++) {
		ep4_new(t[i]);
	}
	BENCH_RUN("ep4_mul_pre_basic") {
		ep4_rand(p);
		BENCH_ADD(ep4_mul_pre_basic(t, p));
	} BENCH_END;

	BENCH_RUN("ep4_mul_fix_basic") {
		bn_rand_mod(k, n);
		ep4_rand(p);
		ep4_mul_pre_basic(t, p);
		BENCH_ADD(ep4_mul_fix_basic(q, t, k));
	} BENCH_END;
	for (int i = 0; i < RLC_EPX_TABLE_BASIC; i++) {
		ep4_free(t[i]);
	}
#endif

#if EP_FIX == COMBS || !defined(STRIP)
	for (int i = 0; i < RLC_EPX_TABLE_COMBS; i++) {
		ep4_new(t[i]);
	}
	BENCH_RUN("ep4_mul_pre_combs") {
		ep4_rand(p);
		BENCH_ADD(ep4_mul_pre_combs(t, p));
	} BENCH_END;

	BENCH_RUN("ep4_mul_fix_combs") {
		bn_rand_mod(k, n);
		ep4_rand(p);
		ep4_mul_pre_combs(t, p);
		BENCH_ADD(ep4_mul_fix_combs(q, t, k));
	} BENCH_END;
	for (int i = 0; i < RLC_EPX_TABLE_COMBS; i++) {
		ep4_free(t[i]);
	}
#endif

#if EP_FIX == COMBD || !defined(STRIP)
	for (int i = 0; i < RLC_EPX_TABLE_COMBD; i++) {
		ep4_new(t[i]);
	}
	BENCH_RUN("ep4_mul_pre_combd") {
		BENCH_ADD(ep4_mul_pre_combd(t, p));
	} BENCH_END;

	BENCH_RUN("ep4_mul_fix_combd") {
		bn_rand_mod(k, n);
		ep4_mul_pre_combd(t, p);
		BENCH_ADD(ep4_mul_fix_combd(q, t, k));
	} BENCH_END;
	for (int i = 0; i < RLC_EPX_TABLE_COMBD; i++) {
		ep4_free(t[i]);
	}
#endif

#if EP_FIX == LWNAF || !defined(STRIP)
	for (int i = 0; i < RLC_EPX_TABLE_LWNAF; i++) {
		ep4_new(t[i]);
	}
	BENCH_RUN("ep4_mul_pre_lwnaf") {
		ep4_rand(p);
		BENCH_ADD(ep4_mul_pre_lwnaf(t, p));
	} BENCH_END;

	BENCH_RUN("ep4_mul_fix_lwnaf") {
		bn_rand_mod(k, n);
		ep4_rand(p);
		ep4_mul_pre_lwnaf(t, p);
		BENCH_ADD(ep4_mul_fix_lwnaf(q, t, k));
	} BENCH_END;
	for (int i = 0; i < RLC_EPX_TABLE_LWNAF; i++) {
		ep4_free(t[i]);
	}
#endif

	BENCH_RUN("ep4_mul_sim") {
		bn_rand_mod(k, n);
		bn_rand_mod(l, n);
		ep4_rand(p);
		ep4_rand(q);
		BENCH_ADD(ep4_mul_sim(r, p, k, q, l));
	} BENCH_END;

#if EP_SIM == BASIC || !defined(STRIP)
	BENCH_RUN("ep4_mul_sim_basic") {
		bn_rand_mod(k, n);
		bn_rand_mod(l, n);
		ep4_rand(p);
		ep4_rand(q);
		BENCH_ADD(ep4_mul_sim_basic(r, p, k, q, l));
	} BENCH_END;
#endif

#if EP_SIM == TRICK || !defined(STRIP)
	BENCH_RUN("ep4_mul_sim_trick") {
		bn_rand_mod(k, n);
		bn_rand_mod(l, n);
		ep4_rand(p);
		ep4_rand(q);
		BENCH_ADD(ep4_mul_sim_trick(r, p, k, q, l));
	} BENCH_END;
#endif

#if EP_SIM == INTER || !defined(STRIP)
	BENCH_RUN("ep4_mul_sim_inter") {
		bn_rand_mod(k, n);
		bn_rand_mod(l, n);
		ep4_rand(p);
		ep4_rand(q);
		BENCH_ADD(ep4_mul_sim_inter(r, p, k, q, l));
	} BENCH_END;
#endif

#if EP_SIM == JOINT || !defined(STRIP)
	BENCH_RUN("ep4_mul_sim_joint") {
		bn_rand_mod(k, n);
		bn_rand_mod(l, n);
		ep4_rand(p);
		ep4_rand(q);
		BENCH_ADD(ep4_mul_sim_joint(r, p, k, q, l));
	} BENCH_END;
#endif

	BENCH_RUN("ep4_mul_sim_gen") {
		bn_rand_mod(k, n);
		bn_rand_mod(l, n);
		ep4_rand(q);
		BENCH_ADD(ep4_mul_sim_gen(r, k, q, l));
	} BENCH_END;

	BENCH_RUN("ep4_frb") {
		ep4_rand(q);
		BENCH_ADD(ep4_frb(r, q, 1));
	} BENCH_END;

	BENCH_RUN("ep4_map") {
		uint8_t msg[5];
		rand_bytes(msg, 5);
		BENCH_ADD(ep4_map(p, msg, 5));
	} BENCH_END;

	ep4_free(p);
	ep4_free(q);
	ep4_free(r);
	bn_free(k);
	bn_free(n);
	bn_free(l);
	fp4_free(s);
}
