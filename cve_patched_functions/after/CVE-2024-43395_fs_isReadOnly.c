static int fs_isReadOnly(lua_State *L) {
    lastCFunction = __func__;
    std::string str = checkstring(L, 1);
    if (fixpath_ro(get_comp(L), str)) {
        lua_pushboolean(L, true);
        return 1;
    }
    const path_t path = fixpath_mkdir(get_comp(L), str, false);
    std::error_code e;
    if (path.empty()) err(L, 1, "Invalid path"); // This should never happen
    if (!fs::exists(path, e)) lua_pushboolean(L, false);
#ifdef WIN32
    else if (e.clear(), fs::is_directory(path, e)) {
        e.clear();
        const path_t file = path / "a";
        const bool didexist = fs::exists(file, e);
        std::fstream fp(file, didexist ? std::ios::in : std::ios::out);
        lua_pushboolean(L, !fp.is_open());
        if (fp.is_open()) fp.close();
        e.clear();
        if (!didexist && fs::exists(file, e)) fs::remove(file, e);
    }
#endif
    else lua_pushboolean(L, access(path.native().c_str(), W_OK) != 0);
    return 1;
}
