static void t1_modify_fm(void)
{
    /*
     * font matrix is given as six numbers a0..a5, which stands for the matrix
     *
     *           a0 a1 0
     *     M =   a2 a3 0
     *           a4 a5 1
     *
     * ExtendFont is given as
     *
     *           e 0 0
     *     E =   0 1 0
     *           0 0 1
     *
     * SlantFont is given as
     *
     *           1 0 0
     *     S =   s 1 0
     *           0 0 1
     *
     * The slant transform must be done _before_ the extend transform
     * for compatibility!
     */
    float a[6];
    int i, c;
    char *p, *q, *r;
    if ((p = strchr(t1_line_array, '[')) == 0)
        if ((p = strchr(t1_line_array, '{')) == 0) {
            remove_eol(p, t1_line_array);
            pdftex_fail("FontMatrix: an array expected: `%s'", t1_line_array);
        }
    c = *p++;                   /* save the character '[' resp. '{' */
    strncpy(t1_buf_array, t1_line_array, (size_t) (p - t1_line_array));
    r = t1_buf_array + (p - t1_line_array);
    for (i = 0; i < 6; i++) {
        a[i] = t1_scan_num(p, &q);
        p = q;
    }
    if (fm_slant(fd_cur->fm) != 0)
        do_slant(a, fm_slant(fd_cur->fm) * 1E-3);
    if (fm_extend(fd_cur->fm) != 0)
        do_extend(a, fm_extend(fd_cur->fm) * 1E-3);
    for (i = 0; i < 6; i++) {
        sprintf(r, "%g ", a[i]);
        r = strend(r);
    }
    if (c == '[') {
        while (*p != ']' && *p != 0)
            p++;
    } else {
        while (*p != '}' && *p != 0)
            p++;
    }
    if (*p == 0) {
        remove_eol(p, t1_line_array);
        pdftex_fail
            ("FontMatrix: cannot find the corresponding character to '%c': `%s'",
             c, t1_line_array);
    }
    strcpy(r, p);
    strcpy(t1_line_array, t1_buf_array);
    t1_line_ptr = eol(t1_line_array);
}
