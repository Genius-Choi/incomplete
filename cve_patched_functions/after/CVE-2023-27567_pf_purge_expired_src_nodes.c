pf_purge_expired_src_nodes(void)
{
	struct pf_src_node		*cur, *next;

	PF_ASSERT_LOCKED();

	for (cur = RB_MIN(pf_src_tree, &tree_src_tracking); cur; cur = next) {
		next = RB_NEXT(pf_src_tree, &tree_src_tracking, cur);

		if (cur->states == 0 && cur->expire <= getuptime()) {
			next = RB_NEXT(pf_src_tree, &tree_src_tracking, cur);
			pf_remove_src_node(cur);
		}
	}
}
