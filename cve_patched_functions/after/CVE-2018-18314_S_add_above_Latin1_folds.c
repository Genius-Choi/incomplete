S_add_above_Latin1_folds(pTHX_ RExC_state_t *pRExC_state, const U8 cp, SV** invlist)
{
    /* This hard-codes the Latin1/above-Latin1 folding rules, so that an
     * innocent-looking character class, like /[ks]/i won't have to go out to
     * disk to find the possible matches.
     *
     * This should be called only for a Latin1-range code points, cp, which is
     * known to be involved in a simple fold with other code points above
     * Latin1.  It would give false results if /aa has been specified.
     * Multi-char folds are outside the scope of this, and must be handled
     * specially.
     *
     * XXX It would be better to generate these via regen, in case a new
     * version of the Unicode standard adds new mappings, though that is not
     * really likely, and may be caught by the default: case of the switch
     * below. */

    PERL_ARGS_ASSERT_ADD_ABOVE_LATIN1_FOLDS;

    assert(HAS_NONLATIN1_SIMPLE_FOLD_CLOSURE(cp));

    switch (cp) {
        case 'k':
        case 'K':
          *invlist =
             add_cp_to_invlist(*invlist, KELVIN_SIGN);
            break;
        case 's':
        case 'S':
          *invlist = add_cp_to_invlist(*invlist, LATIN_SMALL_LETTER_LONG_S);
            break;
        case MICRO_SIGN:
          *invlist = add_cp_to_invlist(*invlist, GREEK_CAPITAL_LETTER_MU);
          *invlist = add_cp_to_invlist(*invlist, GREEK_SMALL_LETTER_MU);
            break;
        case LATIN_CAPITAL_LETTER_A_WITH_RING_ABOVE:
        case LATIN_SMALL_LETTER_A_WITH_RING_ABOVE:
          *invlist = add_cp_to_invlist(*invlist, ANGSTROM_SIGN);
            break;
        case LATIN_SMALL_LETTER_Y_WITH_DIAERESIS:
          *invlist = add_cp_to_invlist(*invlist,
                                        LATIN_CAPITAL_LETTER_Y_WITH_DIAERESIS);
            break;

#ifdef LATIN_CAPITAL_LETTER_SHARP_S /* not defined in early Unicode releases */

        case LATIN_SMALL_LETTER_SHARP_S:
          *invlist = add_cp_to_invlist(*invlist, LATIN_CAPITAL_LETTER_SHARP_S);
            break;

#endif

#if    UNICODE_MAJOR_VERSION < 3                                        \
   || (UNICODE_MAJOR_VERSION == 3 && UNICODE_DOT_VERSION == 0)

        /* In 3.0 and earlier, U+0130 folded simply to 'i'; and in 3.0.1 so did
         * U+0131.  */
        case 'i':
        case 'I':
          *invlist =
             add_cp_to_invlist(*invlist, LATIN_CAPITAL_LETTER_I_WITH_DOT_ABOVE);
#   if UNICODE_DOT_DOT_VERSION == 1
          *invlist = add_cp_to_invlist(*invlist, LATIN_SMALL_LETTER_DOTLESS_I);
#   endif
            break;
#endif

        default:
            /* Use deprecated warning to increase the chances of this being
             * output */
            if (PASS2) {
                ckWARN2reg_d(RExC_parse, "Perl folding rules are not up-to-date for 0x%02X; please use the perlbug utility to report;", cp);
            }
            break;
    }
}
