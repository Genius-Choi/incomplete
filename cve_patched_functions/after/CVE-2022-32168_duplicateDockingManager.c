void NppParameters::duplicateDockingManager(TiXmlNode* dockMngNode, TiXmlElement* dockMngElmt2Clone)
{
	if (!dockMngNode || !dockMngElmt2Clone) return;

	TiXmlElement *dockMngElmt = dockMngNode->ToElement();
	
	int i;
	if (dockMngElmt->Attribute(TEXT("leftWidth"), &i))
		dockMngElmt2Clone->SetAttribute(TEXT("leftWidth"), i);

	if (dockMngElmt->Attribute(TEXT("rightWidth"), &i))
		dockMngElmt2Clone->SetAttribute(TEXT("rightWidth"), i);

	if (dockMngElmt->Attribute(TEXT("topHeight"), &i))
		dockMngElmt2Clone->SetAttribute(TEXT("topHeight"), i);

	if (dockMngElmt->Attribute(TEXT("bottomHeight"), &i))
		dockMngElmt2Clone->SetAttribute(TEXT("bottomHeight"), i);


	for (TiXmlNode *childNode = dockMngNode->FirstChildElement(TEXT("FloatingWindow"));
		childNode;
		childNode = childNode->NextSibling(TEXT("FloatingWindow")))
	{
		TiXmlElement *floatElement = childNode->ToElement();
		int cont;
		if (floatElement->Attribute(TEXT("cont"), &cont))
		{
			TiXmlElement FWNode(TEXT("FloatingWindow"));
			FWNode.SetAttribute(TEXT("cont"), cont);

			int x = 0;
			int y = 0;
			int w = 100;
			int h = 100;

			floatElement->Attribute(TEXT("x"), &x);
			FWNode.SetAttribute(TEXT("x"), x);

			floatElement->Attribute(TEXT("y"), &y);
			FWNode.SetAttribute(TEXT("y"), y);
			
			floatElement->Attribute(TEXT("width"), &w);
			FWNode.SetAttribute(TEXT("width"), w);
			
			floatElement->Attribute(TEXT("height"), &h);
			FWNode.SetAttribute(TEXT("height"), h);

			dockMngElmt2Clone->InsertEndChild(FWNode);
		}
	}

	for (TiXmlNode *childNode = dockMngNode->FirstChildElement(TEXT("PluginDlg"));
		childNode;
		childNode = childNode->NextSibling(TEXT("PluginDlg")))
	{
		TiXmlElement *dlgElement = childNode->ToElement();
		const TCHAR *name = dlgElement->Attribute(TEXT("pluginName"));
		TiXmlElement PDNode(TEXT("PluginDlg"));

		int id;
		const TCHAR *idStr = dlgElement->Attribute(TEXT("id"), &id);
		if (name && idStr)
		{
			int curr = 0; // on left
			int prev = 0; // on left

			dlgElement->Attribute(TEXT("curr"), &curr);
			dlgElement->Attribute(TEXT("prev"), &prev);

			bool isVisible = false;
			const TCHAR *val = dlgElement->Attribute(TEXT("isVisible"));
			if (val)
			{
				isVisible = (lstrcmp(val, TEXT("yes")) == 0);
			}

			PDNode.SetAttribute(TEXT("pluginName"), name);
			PDNode.SetAttribute(TEXT("id"), idStr);
			PDNode.SetAttribute(TEXT("curr"), curr);
			PDNode.SetAttribute(TEXT("prev"), prev);
			PDNode.SetAttribute(TEXT("isVisible"), isVisible ? TEXT("yes") : TEXT("no"));

			dockMngElmt2Clone->InsertEndChild(PDNode);
		}
	}

	for (TiXmlNode *childNode = dockMngNode->FirstChildElement(TEXT("ActiveTabs"));
		childNode;
		childNode = childNode->NextSibling(TEXT("ActiveTabs")))
	{
		TiXmlElement *dlgElement = childNode->ToElement();
		TiXmlElement CTNode(TEXT("ActiveTabs"));
		int cont;
		if (dlgElement->Attribute(TEXT("cont"), &cont))
		{
			int activeTab = 0;
			dlgElement->Attribute(TEXT("activeTab"), &activeTab);

			CTNode.SetAttribute(TEXT("cont"), cont);
			CTNode.SetAttribute(TEXT("activeTab"), activeTab);

			dockMngElmt2Clone->InsertEndChild(CTNode);
		}
	}
}
