void validate_SEK() {

    shared_ptr <string> test_key_ptr = LevelDB::getLevelDb()->readString("TEST_KEY");
    vector <uint8_t> encr_test_key(BUF_LEN, 0);
    vector<char> decr_key(BUF_LEN, 0);
    uint64_t len = 0;
    vector<char> errMsg(BUF_LEN, 0);

    int err_status = 0;

    if (!hex2carray(test_key_ptr->c_str(), &len, encr_test_key.data(),
                    BUF_LEN)) {
        spdlog::error("Corrupt test key is LevelDB");
        exit(-1);
    }

    sgx_status_t status = trustedDecryptKeyAES(eid, &err_status, errMsg.data(), encr_test_key.data(), len, decr_key.data());

    HANDLE_TRUSTED_FUNCTION_ERROR(status, err_status, errMsg.data());

    string test_key = TEST_VALUE;

    if (test_key.compare(decr_key.data()) != 0) {
        spdlog::error("Invalid storage key. You need to recover using backup key");
        spdlog::error("Set the correct backup key into sgx_datasgxwallet_backup_key.txt");
        spdlog::error("Then run sgxwallet using backup flag");
        exit(-1);
    }
}
