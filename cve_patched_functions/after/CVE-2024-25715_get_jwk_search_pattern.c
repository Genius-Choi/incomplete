static json_t * get_jwk_search_pattern(jwt_t * jwt, jwks_t * jwks) {
  json_t * j_search = json_object();
  jwa_alg alg = r_jwt_get_sign_alg(jwt);
  jwk_t * jwk;
  int s_alg = 1;
  size_t i;

  if (alg == R_JWA_ALG_HS256 || alg == R_JWA_ALG_HS384 || alg == R_JWA_ALG_HS512) {
    json_object_set_new(j_search, "kty", json_string("oct"));
  } else if (alg == R_JWA_ALG_RS256 || alg == R_JWA_ALG_RS384 || alg == R_JWA_ALG_RS512 ||
             alg == R_JWA_ALG_PS256 || alg == R_JWA_ALG_PS384 || alg == R_JWA_ALG_PS512) {
    json_object_set_new(j_search, "kty", json_string("RSA"));
  } else if (alg == R_JWA_ALG_ES256 || alg == R_JWA_ALG_ES384 || alg == R_JWA_ALG_ES512 || alg == R_JWA_ALG_ES256K) {
    json_object_set_new(j_search, "kty", json_string("EC"));
  } else if (alg == R_JWA_ALG_EDDSA) {
    json_object_set_new(j_search, "kty", json_string("OKP"));
  }
  json_object_set_new(j_search, "use", json_string("sig"));
  for (i=0; i<r_jwks_size(jwks); i++) {
    jwk = r_jwks_get_at(jwks, i);
    if (r_jwk_get_property_str(jwk, "alg") == NULL) {
      s_alg = 0;
      break;
    }
    r_jwk_free(jwk);
  }
  if (s_alg) {
    json_object_set_new(j_search, "alg", json_string(r_jwa_alg_to_str(alg)));
  }
  return j_search;
}
