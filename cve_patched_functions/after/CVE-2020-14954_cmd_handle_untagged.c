static int cmd_handle_untagged(struct ImapAccountData *adata)
{
  char *s = imap_next_word(adata->buf);
  char *pn = imap_next_word(s);

  if ((adata->state >= IMAP_SELECTED) && isdigit((unsigned char) *s))
  {
    /* pn vs. s: need initial seqno */
    pn = s;
    s = imap_next_word(s);

    /* EXISTS, EXPUNGE, FETCH are always related to the SELECTED mailbox */
    if (mutt_str_startswith(s, "EXISTS", CASE_IGNORE))
      cmd_parse_exists(adata, pn);
    else if (mutt_str_startswith(s, "EXPUNGE", CASE_IGNORE))
      cmd_parse_expunge(adata, pn);
    else if (mutt_str_startswith(s, "FETCH", CASE_IGNORE))
      cmd_parse_fetch(adata, pn);
  }
  else if ((adata->state >= IMAP_SELECTED) && mutt_str_startswith(s, "VANISHED", CASE_IGNORE))
    cmd_parse_vanished(adata, pn);
  else if (mutt_str_startswith(s, "CAPABILITY", CASE_IGNORE))
    cmd_parse_capability(adata, s);
  else if (mutt_str_startswith(s, "OK [CAPABILITY", CASE_IGNORE))
    cmd_parse_capability(adata, pn);
  else if (mutt_str_startswith(pn, "OK [CAPABILITY", CASE_IGNORE))
    cmd_parse_capability(adata, imap_next_word(pn));
  else if (mutt_str_startswith(s, "LIST", CASE_IGNORE))
    cmd_parse_list(adata, s);
  else if (mutt_str_startswith(s, "LSUB", CASE_IGNORE))
    cmd_parse_lsub(adata, s);
  else if (mutt_str_startswith(s, "MYRIGHTS", CASE_IGNORE))
    cmd_parse_myrights(adata, s);
  else if (mutt_str_startswith(s, "SEARCH", CASE_IGNORE))
    cmd_parse_search(adata, s);
  else if (mutt_str_startswith(s, "STATUS", CASE_IGNORE))
    cmd_parse_status(adata, s);
  else if (mutt_str_startswith(s, "ENABLED", CASE_IGNORE))
    cmd_parse_enabled(adata, s);
  else if (mutt_str_startswith(s, "BYE", CASE_IGNORE))
  {
    mutt_debug(LL_DEBUG2, "Handling BYE\n");

    /* check if we're logging out */
    if (adata->status == IMAP_BYE)
      return 0;

    /* server shut down our connection */
    s += 3;
    SKIPWS(s);
    mutt_error("%s", s);
    cmd_handle_fatal(adata);

    return -1;
  }
  else if (C_ImapServernoise && mutt_str_startswith(s, "NO", CASE_IGNORE))
  {
    mutt_debug(LL_DEBUG2, "Handling untagged NO\n");

    /* Display the warning message from the server */
    mutt_error("%s", s + 2);
  }

  return 0;
}
