static bool get_versym_entry_sdb_from_verdef(ELFOBJ *bin, Sdb *sdb, const char *key, Elf_(Versym) versym) {
	ut64 verdef_addr;
	ut64 verdef_num;

	if (!Elf_(rz_bin_elf_get_dt_info)(bin, DT_VERDEF, &verdef_addr) || !Elf_(rz_bin_elf_get_dt_info)(bin, DT_VERDEFNUM, &verdef_num)) {
		return false;
	}

	ut64 verdef_offset = Elf_(rz_bin_elf_v2p(bin, verdef_addr));

	if (verdef_offset == UT64_MAX) {
		return false;
	}

	ut64 verdef_entry_offset = verdef_offset;

	for (size_t i = 0; i < verdef_num; i++) {
		Elf_(Verdef) verdef_entry;
		if (!get_verdef_entry(bin, verdef_entry_offset, &verdef_entry)) {
			return false;
		}

		if (!verdef_entry.vd_cnt || verdef_entry.vd_ndx != (versym & VERSYM_VERSION)) {
			verdef_entry_offset += verdef_entry.vd_next;
			continue;
		}

		ut64 verdaux_entry_offset = verdef_entry_offset + verdef_entry.vd_aux;

		Elf_(Verdaux) verdaux_entry;
		if (!get_verdaux_entry(bin, verdaux_entry_offset, &verdaux_entry)) {
			return false;
		}

		const char *tmp = Elf_(rz_bin_elf_strtab_get)(bin->dynstr, verdaux_entry.vda_name);
		if (!tmp) {
			return false;
		}

		char *value = rz_str_newf("%u (%s)", versym & VERSYM_VERSION, tmp);
		if (!value) {
			return false;
		}

		if (!sdb_set_owned(sdb, key, value, 0)) {
			return false;
		}

		return true;
	}

	return false;
}
