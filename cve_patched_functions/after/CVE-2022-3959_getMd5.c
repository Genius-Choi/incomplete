std::string getMd5(const char *data, const size_t dataLen)
{
#if defined(OpenSSL_FOUND) && OPENSSL_VERSION_MAJOR < 3
    MD5_CTX c;
    unsigned char md5[16] = {0};
    MD5_Init(&c);
    MD5_Update(&c, data, dataLen);
    MD5_Final(md5, &c);
    return utils::binaryStringToHex(md5, 16);
#elif defined(OpenSSL_FOUND)
    unsigned char md5[16] = {0};
    const EVP_MD *md = EVP_get_digestbyname("md5");
    assert(md != nullptr);

    EVP_MD_CTX *mdctx = EVP_MD_CTX_new();
    EVP_DigestInit_ex2(mdctx, md, NULL);
    EVP_DigestUpdate(mdctx, data, dataLen);
    EVP_DigestFinal_ex(mdctx, md5, NULL);
    EVP_MD_CTX_free(mdctx);
    return utils::binaryStringToHex(md5, 16);
#else
    return Md5Encode::encode(data, dataLen);
#endif
}
