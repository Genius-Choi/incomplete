void ed_rhs(fp_t rhs, const ed_t p) {
	fp_t t0, t1;

	fp_null(t0);
	fp_null(t1);

	RLC_TRY {
		fp_new(t0);
		fp_new(t1);

		// 1 = a * X^2 + Y^2 - d * X^2 * Y^2
		fp_sqr(t0, p->x);
		fp_mul(t0, t0, core_get()->ed_a);
		fp_sqr(t1, p->y);
		fp_add(t1, t1, t0);
		fp_mul(t0, p->x, p->y);
		fp_sqr(t0, t0);
		fp_mul(t0, t0, core_get()->ed_d);
		fp_sub(rhs, t1, t0);
	} RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	} RLC_FINALLY {
		fp_free(t0);
		fp_free(t1);
	}
}
