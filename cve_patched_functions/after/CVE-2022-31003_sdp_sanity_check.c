int sdp_sanity_check(sdp_parser_t *p)
{
  sdp_session_t *sdp = p->pr_session;
  sdp_media_t *m;

  if (!p || !p->pr_ok)
    return -1;
  else if (sdp->sdp_version[0] != 0)
    return parsing_error(p, "Incorrect version");
  else if (!sdp->sdp_origin)
    return parsing_error(p, "No o= present");
  else if (p->pr_strict && !sdp->sdp_subject)
    return parsing_error(p, "No s= present");
  else if (p->pr_strict && !sdp->sdp_time)
    return parsing_error(p, "No t= present");

  /* If there is no session level c= check that one exists for all media */
  /* c= line may be missing if this is a RTSP description */
  if (!p->pr_c_missing && !sdp->sdp_connection) {
    for (m = sdp->sdp_media ; m ; m = m->m_next) {
      if (!m->m_connections && !m->m_rejected) {
	parsing_error(p, "No c= on either session level or all mediums");
	return -2;
      }
    }
  }

  return 0;
}
