static Jsi_RC InterpConstructor(Jsi_Interp *interp, Jsi_Value *args, Jsi_Value *_this,
    Jsi_Value **ret, Jsi_Func *funcPtr)
{
    Jsi_Obj *fobj;
    Jsi_Value *toacc;
    InterpObj *cmdPtr = (InterpObj *)Jsi_Calloc(1,sizeof(*cmdPtr));
    int rc = JSI_OK;
    SIGINIT(cmdPtr,INTERPOBJ);
    cmdPtr->parent = interp;

    Jsi_Value *arg = Jsi_ValueArrayIndex(interp, args, 0);

    if (!(cmdPtr->subinterp = jsi_InterpNew(interp, arg, NULL))) {
        Jsi_Free(cmdPtr);
        return JSI_ERROR;
    }
    Jsi_Interp *sinterp = cmdPtr->subinterp;
    sinterp->opts.no_exit = interp->opts.no_exit;
    toacc = NULL;
    if (Jsi_FunctionIsConstructor(funcPtr)) {
        toacc = _this;
    } else {
        Jsi_Obj *o = Jsi_ObjNew(interp);
        Jsi_PrototypeObjSet(interp, "Interp", o);
        Jsi_ValueMakeObject(interp, ret, o);
        toacc = *ret;
    }

    fobj = Jsi_ValueGetObj(interp, toacc);
    if ((cmdPtr->objId = Jsi_UserObjNew(interp, &interpobject, fobj, cmdPtr))<0)
        goto bail;
    sinterp->objId = cmdPtr->objId;
    cmdPtr->fobj = fobj;
#ifndef JSI_OMIT_THREADS
    if (sinterp->subthread) {
#ifdef __WIN32
        if (!_beginthread( NewInterpThread, 0, cmdPtr )) {
            Jsi_LogError("thread create failed");
            goto bail;
        }
#else
        pthread_t nthread;
        if (pthread_create(&nthread, NULL, NewInterpThread, cmdPtr) != 0) {
            Jsi_LogError("thread create failed");
            goto bail;
        }
#endif //__WIN32
#else
    if (0) {
#endif //JSI_OMIT_THREADS
    } else {
        //sinterp->framePtr->tryDepth++;
        if (sinterp->scriptStr != 0) {
            if (sinterp->scriptFile && !interp->curFile)
                sinterp->curFile = Jsi_ValueString(sinterp, sinterp->scriptFile, NULL);
            rc = Jsi_EvalString(sinterp, sinterp->scriptStr, JSI_EVAL_ISMAIN);
        } else if (sinterp->scriptFile && !sinterp->debugOpts.debugCallback) {
            int len;
            if (Jsi_ValueString(interp, sinterp->scriptFile, &len) && len==0)
                Jsi_Interactive(sinterp, JSI_OUTPUT_QUOTE|JSI_OUTPUT_NEWLINES);
            else
                rc = Jsi_EvalFile(sinterp, sinterp->scriptFile, JSI_EVAL_ISMAIN);
        }
        //sinterp->framePtr->tryDepth--;
        if (rc == JSI_EXIT)
            return JSI_OK;
        if (rc != JSI_OK) {
            /*Jsi_Strcpy(interp->errMsgBuf, sinterp->errMsgBuf);
            interp->errLine = sinterp->errLine;
            interp->errFile = sinterp->errFile;
            sinterp->errMsgBuf[0] = 0;*/
            goto bail;
        }
    }
    return JSI_OK;

bail:
    interpObjErase(cmdPtr);
    Jsi_ValueMakeUndef(interp, ret);
    return JSI_ERROR;
}
