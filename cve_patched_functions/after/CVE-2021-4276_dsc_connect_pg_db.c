DSCIOManager::dsc_connect_pg_db() {
    pg_db_conn_ = new pqxx::connection( conn_string_ );
    if ( pg_db_conn_ == NULL ) {
        cerr << "Error connecting to database." << endl;
        exit(1);
    }
    pg_db_conn_->activate();
    
    /* Check Database version */
    int db_version = 0;
    try {
        pg_db_trans_ = new pqxx::work( *pg_db_conn_ );
        if ( pg_db_trans_ == NULL ) {
            cerr << "Error starting transaction." << endl;
            exit(1);
        }
        const pqxx::result R = pg_db_trans_->exec("select version from version;");
        pqxx::result::const_iterator row;
        for (row = R.begin(); row != R.end(); ++row) {
            row["version"].to(db_version);
        }
        if ( db_version != DB_SCHEMA_VERSION ) {
            cout << "Database version is not supported. Expected: " << DB_SCHEMA_VERSION << " Found: " << db_version << endl;
            exit( EXIT_FAILURE);
        }
        if ( pg_db_trans_ != NULL ) {
            pg_db_trans_->commit();
            delete pg_db_trans_;
            pg_db_trans_ = NULL;
        }
    }
    catch ( pqxx::unique_violation & e )
    {
        cerr << "Unique_violation error: " << e.what() << endl;
        exit( EXIT_FAILURE);
    }
    catch( runtime_error & e )
    {
        cerr << "Runtime error: " << e.what() << endl;
        exit( EXIT_FAILURE );
    }
    catch( std::exception & e )
    {
        cerr << "Exception: " << e.what() << " select version from version;" << endl;
        exit( EXIT_FAILURE );
    }
    catch( ... )
    {
        cerr << "Unknown exception caught" << endl;
        exit( EXIT_FAILURE );
    }
    
    return 0;

}
