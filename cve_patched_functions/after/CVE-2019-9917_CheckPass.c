bool CUser::CheckPass(const CString& sPass) const {
    if(AuthOnlyViaModule() || CZNC::Get().GetAuthOnlyViaModule()) {
        return false;
    }

    switch (m_eHashType) {
        case HASH_MD5:
            return m_sPass.Equals(CUtils::SaltedMD5Hash(sPass, m_sPassSalt));
        case HASH_SHA256:
            return m_sPass.Equals(CUtils::SaltedSHA256Hash(sPass, m_sPassSalt));
        case HASH_NONE:
        default:
            return (sPass == m_sPass);
    }
}
