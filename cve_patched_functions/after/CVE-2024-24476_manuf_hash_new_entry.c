manuf_hash_new_entry(const guint8 *addr, const char* name, const char* longname)
{
    guint manuf_key;
    hashmanuf_t *manuf_value;
    char *endp;

    /* manuf needs only the 3 most significant octets of the ethernet address */
    manuf_key = (addr[0] << 16) + (addr[1] << 8) + addr[2];
    manuf_value = wmem_new(addr_resolv_scope, hashmanuf_t);

    memcpy(manuf_value->addr, addr, 3);
    if (name != NULL) {
        (void) g_strlcpy(manuf_value->resolved_name, name, MAXNAMELEN);
        manuf_value->status = HASHETHER_STATUS_RESOLVED_NAME;
        if (longname != NULL) {
            (void) g_strlcpy(manuf_value->resolved_longname, longname, MAXNAMELEN);
        }
        else {
            (void) g_strlcpy(manuf_value->resolved_longname, name, MAXNAMELEN);
        }
    }
    else {
        manuf_value->status = HASHETHER_STATUS_UNRESOLVED;
        manuf_value->resolved_name[0] = '\0';
        manuf_value->resolved_longname[0] = '\0';
    }
    /* Values returned by bytes_to_hexstr_punct() are *not* null-terminated */
    endp = bytes_to_hexstr_punct(manuf_value->hexaddr, addr, sizeof(manuf_value->addr), ':');
    *endp = '\0';

    wmem_map_insert(manuf_hashtable, GUINT_TO_POINTER(manuf_key), manuf_value);
    return manuf_value;
}
