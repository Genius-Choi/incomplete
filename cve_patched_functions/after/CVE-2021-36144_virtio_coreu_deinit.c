virtio_coreu_deinit(struct vmctx *ctx, struct pci_vdev *dev, char *opts)
{
	struct virtio_coreu *vcoreu = (struct virtio_coreu *)dev->arg;

	if (!vcoreu)
		return;

	pthread_mutex_destroy(&vcoreu->mtx);
	pthread_mutex_destroy(&vcoreu->rx_mtx);
	pthread_cond_destroy(&vcoreu->rx_cond);
	pthread_join(vcoreu->rx_tid, NULL);

	virtio_coreu_reset(vcoreu);
	free(vcoreu);
}
