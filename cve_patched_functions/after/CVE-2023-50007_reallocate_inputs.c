static int reallocate_inputs(double **out, int *out_length,
                             int in_length, int levels, int ch, uint64_t sn)
{
    const int temp_length = nb_coefs(in_length, levels, sn);

    for (int level = 0; level < levels; level++) {
        const int temp_length = nb_coefs(in_length, level + 1, sn);

        if (temp_length > out_length[level]) {
            av_freep(&out[level]);
            out_length[level] = 0;

            out[level] = av_calloc(temp_length + 1, sizeof(**out));
            if (!out[level])
                return AVERROR(ENOMEM);
            out_length[level] = temp_length + 1;
        }

        memset(out[level] + temp_length, 0,
               (out_length[level] - temp_length) * sizeof(**out));
        out_length[level] = temp_length;
    }

    if (temp_length > out_length[levels]) {
        av_freep(&out[levels]);
        out_length[levels] = 0;

        out[levels] = av_calloc(temp_length + 1, sizeof(**out));
        if (!out[levels])
            return AVERROR(ENOMEM);
        out_length[levels] = temp_length + 1;
    }

    memset(out[levels] + temp_length, 0,
           (out_length[levels] - temp_length) * sizeof(**out));
    out_length[levels] = temp_length;

    return 0;
}
