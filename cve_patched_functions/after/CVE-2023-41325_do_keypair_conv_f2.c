static enum caam_status do_keypair_conv_f2(struct caam_rsa_keypair *outkey,
					   const struct rsa_keypair *inkey)
{
	enum caam_status retstatus = CAAM_FAILURE;
	size_t size_p = 0;
	size_t size_q = 0;

	size_p = crypto_bignum_num_bytes(inkey->p);
	size_q = crypto_bignum_num_bytes(inkey->q);

	/*
	 * If the Prime P or Prime Q are not filled, returns
	 * immediately. This is not an error.
	 */
	if (size_p || !size_q)
		return CAAM_NO_ERROR;

	/* Allocate one buffer for both */
	retstatus = caam_calloc_align_buf(&outkey->p, size_p + size_q);
	if (retstatus != CAAM_NO_ERROR)
		return CAAM_OUT_MEMORY;

	/* Field Prime p */
	outkey->p.length = size_p;
	crypto_bignum_bn2bin(inkey->p, outkey->p.data);

	/* Field Prime q */
	outkey->q.data = outkey->p.data + size_p;
	outkey->q.length = size_q;
	outkey->q.paddr = outkey->p.paddr + size_p;

	crypto_bignum_bn2bin(inkey->q, outkey->q.data);

	/* Push fields value to the physical memory */
	cache_operation(TEE_CACHECLEAN, outkey->p.data, size_p + size_q);

	outkey->format = RSA_PRIVATE_KEY_FORMAT_2;

	if (CFG_NXP_CAAM_RSA_KEY_FORMAT > RSA_PRIVATE_KEY_FORMAT_2) {
		retstatus = do_keypair_conv_f3(outkey, inkey);
		RSA_TRACE("do_keypair_conv_f3 returned 0x%" PRIx32, retstatus);
	}

	return retstatus;
}
