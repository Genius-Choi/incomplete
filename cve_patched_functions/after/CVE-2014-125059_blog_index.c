void blog_index(void) {
	char *script_name = getenv("SCRIPT_NAME");
	struct dirent **dirlist;
	int dircount;

	if(script_name == NULL) {
		fprintf(stderr, "Died because of missing self-awareness\n");
		exit(EXIT_FAILURE);
	}

	send_header("Content-type", "text/html");
	terminate_headers();

	template_header();

	dircount = scandir(BLOG_DIR, &dirlist, no_dotfiles, alphasort);	

	if(dircount < 0) {
		fprintf(stderr, "An error occurred while scanning %s: %s\n", 
				BLOG_DIR, strerror(errno));
		exit(EXIT_FAILURE);
	}
	while(dircount--) {
		struct blogpost post = make_blogpost_from_dirent(dirlist[dircount]);

		/* finally if the file exists call the
		 * template function. Otherwise
		 * we do nothing. (this case is also
		 * FUCKING unlikely */
		if(file_exists(post.path) > 0) {
			template_post_index_entry(post);
		}
		
		free_blogpost(post);
		free(dirlist[dircount]);
	}
	free(dirlist);

	template_footer();
}
