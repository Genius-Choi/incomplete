int edit_stdin(char* name, char* date, char* data, int append)
{
	char buff[1024];
	int l;
	int s;
	int r;
	char* d;
	char* b;

	/* get the initial buffer size */
	l = strlen(data);
	if (l < 512) {
		s = 512;
	}else{
		s = l*2;
	}

	d = malloc(s);
	if (!d)
		return 1;

	/* for append mode copy the old data to the start of the buffer */
	if (append && strcmp(data,"new entry")) {
		strcpy(d,data);
	}else{
		l = 0;
	}

	/* read it in */
	while ((r = read(STDIN_FILENO,buff,1024)) > 0) {
		/* extend the buffer as necessary */
		if (l+r+1 > s) {
			s = l+r+512;
			b = realloc(d,s);
			if (!b)
				return 1;
			d = b;
		}
		memcpy(d+l,buff,r);
		l += r;
	}

	/* make sure there's room for the nul byte */
	if (l+1 > s) {
		s = l+1;
		b = realloc(d,s);
		if (!b)
			return 1;
		d = b;
	}

	d[l] = 0;

	/* done */
	return db_update(name,d);
}
