void ed_mul_sim_inter(ed_t r, const ed_t p, const bn_t k, const ed_t q,
		const bn_t m) {

	if (bn_is_zero(k) || ed_is_infty(p)) {
		ed_mul(r, q, m);
		return;
	}
	if (bn_is_zero(m) || ed_is_infty(q)) {
		ed_mul(r, p, k);
		return;
	}

	ed_mul_sim_plain(r, p, k, q, m, NULL);
}
