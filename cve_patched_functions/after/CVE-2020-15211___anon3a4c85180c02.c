        reg.prepare = [](TfLiteContext* context, TfLiteNode* node) {
          // Set output size to input size
          const TfLiteTensor* input1;
          const TfLiteTensor* input2;
          if (node->inputs->size == 2) {
            input1 = GetInput(context, node, 0);
            input2 = GetInput(context, node, 1);
          } else {
            input1 = GetInput(context, node, 0);
            input2 = input1;
          }
          TfLiteTensor* output;
          TF_LITE_ENSURE_OK(context, GetOutputSafe(context, node, 0, &output));

          TF_LITE_ENSURE_STATUS(context->ResizeTensor(
              context, output, TfLiteIntArrayCopy(input1->dims)));
          return kTfLiteOk;
        };
