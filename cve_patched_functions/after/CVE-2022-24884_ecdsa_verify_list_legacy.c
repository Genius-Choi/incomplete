size_t ecdsa_verify_list_legacy(const ecdsa_verify_context_t *ctxs, size_t n_ctxs, const ecc_25519_work_t *pubkeys, size_t n_pubkeys) {
  size_t ret = 0, i, j;

  bool used[n_pubkeys];
  memset(used, 0, sizeof(used));

  for (i = 0; i < n_ctxs; i++) {
    for (j = 0; j < n_pubkeys; j++) {
      if (used[j])
        continue;

      if (ecdsa_verify_legacy(&ctxs[i], &pubkeys[j])) {
        ret++;
        used[j] = true;
        break;
      }
    }
  }

  return ret;
}
