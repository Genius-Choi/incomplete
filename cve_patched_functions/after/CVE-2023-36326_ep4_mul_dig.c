void ep4_mul_dig(ep4_t r, const ep4_t p, const dig_t k) {
	int i, l;
	ep4_t t;

	ep4_null(t);

	if (k == 0 || ep4_is_infty(p)) {
		ep4_set_infty(r);
		return;
	}

	RLC_TRY {
		ep4_new(t);

		l = util_bits_dig(k);

		ep4_copy(t, p);

		for (i = l - 2; i >= 0; i--) {
			ep4_dbl(t, t);
			if (k & ((dig_t)1 << i)) {
				ep4_add(t, t, p);
			}
		}

		ep4_norm(r, t);
	}
	RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	}
	RLC_FINALLY {
		ep4_free(t);
	}
}
