std::optional<bool> GetInstructionStaticValueAsBool(
    HloInstruction* instruction) {
  HloEvaluator evaluator;
  StatusOr<Literal> static_value = evaluator.Evaluate(
      instruction, /*recursively_evaluate_nonconstant_operands=*/true);
  if (static_value.ok()) {
    return static_value->GetFirstElement<bool>();
  }
  return std::nullopt;
}
