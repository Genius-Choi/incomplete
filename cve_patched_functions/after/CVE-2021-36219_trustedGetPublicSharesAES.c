void trustedGetPublicSharesAES(int *errStatus, char *errString, uint8_t *encrypted_dkg_secret, uint32_t enc_len,
                           char *public_shares,
                           unsigned _t, unsigned _n) {

    LOG_DEBUG (__FUNCTION__);

    char *decrypted_dkg_secret = (char *) calloc(DKG_MAX_SEALED_LEN, 1);
    memset(decrypted_dkg_secret, 0, DKG_MAX_SEALED_LEN);


    int status = AES_decrypt(encrypted_dkg_secret, enc_len, decrypted_dkg_secret);


    if (status != SGX_SUCCESS) {
        snprintf(errString, BUF_LEN, "aes decrypt data - encrypted_dkg_secret failed with status %d", status);
        *errStatus = status;
        return;
    }

    if (calc_public_shares(decrypted_dkg_secret, public_shares, _t) != 0) {
        *errStatus = -1;
        snprintf(errString, BUF_LEN, "t does not match polynomial in db");
        return;
    }


}
