learned_cookies_flush(struct ofproto *ofproto, struct ovs_list *dead_cookies)
    OVS_REQUIRES(ofproto_mutex)
{
    struct learned_cookie *c;

    LIST_FOR_EACH_POP (c, u.list_node, dead_cookies) {
        struct rule_criteria criteria;
        struct rule_collection rules;
        struct match match;

        match_init_catchall(&match);
        rule_criteria_init(&criteria, c->table_id, &match, 0, OVS_VERSION_MAX,
                           c->cookie, OVS_BE64_MAX, OFPP_ANY, OFPG_ANY);
        rule_criteria_require_rw(&criteria, false);
        collect_rules_loose(ofproto, &criteria, &rules);
        rule_criteria_destroy(&criteria);
        delete_flows__(&rules, OFPRR_DELETE, NULL);

        free(c);
    }
}
