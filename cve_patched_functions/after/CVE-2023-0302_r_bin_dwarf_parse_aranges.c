R_API RList *r_bin_dwarf_parse_aranges(RBin *bin, int mode) {
	ut8 *buf;
	int ret;
	size_t len;
	RBinSection *section = getsection (bin, "debug_aranges");
	RBinFile *binfile = bin ? bin->cur: NULL;

	if (binfile && section) {
		len = section->size;
		if (len < 1 || len > ST32_MAX) {
			return NULL;
		}
		buf = calloc (1, len);
		ret = r_buf_read_at (binfile->buf, section->paddr, buf, len);
		if (!ret) {
			free (buf);
			return NULL;
		}
		/* set the endianity global [HOTFIX] */
		big_end = r_bin_is_big_endian (bin);
		parse_aranges_raw (buf, len, mode, bin->cb_printf);

		free (buf);
	}
	return NULL;
}
