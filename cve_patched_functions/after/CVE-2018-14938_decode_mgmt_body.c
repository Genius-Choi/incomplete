WifiPacket::decode_mgmt_body(u_int16_t fc, struct mgmt_header_t *pmh, const u_char *p, size_t len)
{
    if(debug) std::cerr << "decode_mgmt_body FC_SUBTYPE(fc)="<<(int)FC_SUBTYPE(fc)<<" ";
    switch (FC_SUBTYPE(fc)) {
    case ST_ASSOC_REQUEST:
        return handle_assoc_request(pmh, p, len);
    case ST_ASSOC_RESPONSE:
        return handle_assoc_response(pmh, p, len);
    case ST_REASSOC_REQUEST:
        return handle_reassoc_request(pmh, p, len);
    case ST_REASSOC_RESPONSE:
        return handle_reassoc_response(pmh, p, len);
    case ST_PROBE_REQUEST:
        return handle_probe_request(pmh, p, len);
    case ST_PROBE_RESPONSE:
        return handle_probe_response(pmh, p, len);
    case ST_BEACON:
        return handle_beacon(pmh, p, len);
    case ST_ATIM:
        return handle_atim(pmh, p, len);
    case ST_DISASSOC:
        return handle_disassoc(pmh, p, len);
    case ST_AUTH:
        if (len < 3) {
            return 0;
        }
        if ((p[0] == 0 ) && (p[1] == 0) && (p[2] == 0)) {
            //printf("Authentication (Shared-Key)-3 ");
            cbs->Handle80211MgmtAuthSharedKey(*this, pmh, p, len);
            return 0;
        }
        return handle_auth(pmh, p, len);
    case ST_DEAUTH:
        return handle_deauth(pmh, p, len);
        break;
    default:
        return 0;
    }
}
