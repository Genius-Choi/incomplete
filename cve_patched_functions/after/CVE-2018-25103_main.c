int main (void)
{
    server srv;
    connection con;

    memset(&srv, 0, sizeof(server));
    srv.errorlog_fd = -1; /* use 2 for STDERR_FILENO from unistd.h */
    srv.errorlog_mode = ERRORLOG_FD;
    srv.errorlog_buf = buffer_init();
    srv.split_vals = array_init();

    memset(&con, 0, sizeof(connection));
    con.proto                = buffer_init();
    con.parse_request        = buffer_init();
    con.request.request      = buffer_init();
    con.request.request_line = buffer_init();
    con.request.orig_uri     = buffer_init();
    con.request.uri          = buffer_init();
    con.request.headers      = array_init();
    con.conf.allow_http11   = 1;
    con.conf.http_parseopts = HTTP_PARSEOPT_HEADER_STRICT
                            | HTTP_PARSEOPT_HOST_STRICT
                            | HTTP_PARSEOPT_HOST_NORMALIZE;

    test_request_http_request_parse(&srv, &con);

    buffer_free(con.proto);
    buffer_free(con.parse_request);
    buffer_free(con.request.request);
    buffer_free(con.request.request_line);
    buffer_free(con.request.orig_uri);
    buffer_free(con.request.uri);
    array_free(con.request.headers);

    array_free(srv.split_vals);
    buffer_free(srv.errorlog_buf);

    return 0;
}
