valid_ruser(const char *s)
{
	size_t i;

	if (*s == '-')
		return 0;
	for (i = 0; s[i] != 0; i++) {
		if (strchr("'`\";&<>|(){}", s[i]) != NULL)
			return 0;
		/* Disallow '-' after whitespace */
		if (isspace((u_char)s[i]) && s[i + 1] == '-')
			return 0;
		/* Disallow \ in last position */
		if (s[i] == '\\' && s[i + 1] == '\0')
			return 0;
	}
	return 1;
}
