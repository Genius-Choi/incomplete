set_definition(const char *name, const char *value)
{
	def_t *def;
	size_t name_len = strlen(name);

	if ((def = find_definition(name, name_len, false))) {
		FREE(def->value);
		def->fn = NULL;		/* Allow a standard definition to be overridden */
	}
	else {
		def = MALLOC(sizeof(*def));
		def->name_len = name_len;
		def->name = MALLOC(name_len + 1);
		strcpy(def->name, name);

		if (!LIST_EXISTS(defs))
			defs = alloc_list(free_definition, NULL);
		list_add(defs, def);
	}
	def->value_len = strlen(value);
	def->value = MALLOC(def->value_len + 1);
	strcpy(def->value, value);

#ifdef PARSER_DEBUG
	log_message(LOG_INFO, "Definition %s now '%s'", def->name, def->value);
#endif

	return def;
}
