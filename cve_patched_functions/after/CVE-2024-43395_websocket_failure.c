static std::string websocket_failure(lua_State *L, void* userp) {
    websocket_failure_data * data = (websocket_failure_data*)userp;
    if (data->url.empty()) lua_pushnumber(L, data->port);
    else lua_pushstring(L, data->url.c_str());
    lua_pushstring(L, data->reason.c_str());
    delete data;
    return "websocket_failure";
}
