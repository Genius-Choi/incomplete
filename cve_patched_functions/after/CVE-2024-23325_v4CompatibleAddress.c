InstanceConstSharedPtr Ipv6Instance::Ipv6Helper::v4CompatibleAddress() const {
  if (!v6only_ && IN6_IS_ADDR_V4MAPPED(&address_.sin6_addr)) {
    struct sockaddr_in sin;
    ipv6ToIpv4CompatibleAddress(&address_, &sin);
    auto addr = Address::InstanceFactory::createInstancePtr<Address::Ipv4Instance>(&sin);
    return addr.ok() ? addr.value() : nullptr;
  }
  return nullptr;
}
