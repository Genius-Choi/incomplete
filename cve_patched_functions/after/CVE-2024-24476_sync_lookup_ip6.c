sync_lookup_ip6(const ws_in6_addr *addrp)
{
    gboolean completed = FALSE;
    sync_dns_data_t *sdd;

    if (!async_dns_initialized) {
        /*
         * c-ares not initialized.  Bail out.
         */
        return;
    }

    /*
     * Start the request.
     */
    sdd = g_new(sync_dns_data_t, 1);
    sdd->family = AF_INET6;
    memcpy(&sdd->addr.ip6, addrp, sizeof(sdd->addr.ip6));
    sdd->completed = &completed;
    ares_gethostbyaddr(ghba_chan, addrp, sizeof(ws_in6_addr), AF_INET6,
                       c_ares_ghba_sync_cb, sdd);

    /*
     * Now wait for it to finish.
     */
    wait_for_sync_resolv(&completed);
}
