client_list_find_by_token(const char token[])
{
	t_client *ptr;
	s_config *config;
	config = config_get_config();
	char *rhid;
	char *rhidraw = NULL;

	ptr = firstclient;

	while (ptr) {
		//Check if token (tok) or hash_id (hid) mode
		if (strlen(token) > 8) {
			// hid mode
			rhidraw = safe_calloc(SMALL_BUF);
			safe_snprintf(rhidraw, SMALL_BUF, "%s%s", ptr->hid, config->fas_key);

			rhid = safe_calloc(SMALL_BUF);
			hash_str(rhid, SMALL_BUF, rhidraw);

			free(rhidraw);

			if (token && !strcmp(rhid, token)) {
				// rhid is valid
				free (rhid);
				return ptr;
			}

			free(rhid);

		} else {
			// tok mode
			if (token && !strcmp(ptr->token, token)) {
				// Token is valid
				return ptr;
			}
		}

		ptr = ptr->next;
	}

	return NULL;
}
