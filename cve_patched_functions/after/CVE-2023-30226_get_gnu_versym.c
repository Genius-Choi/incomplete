static Sdb *get_gnu_versym(ELFOBJ *bin) {
	ut64 versym_addr;

	if (!Elf_(rz_bin_elf_get_dt_info)(bin, DT_VERSYM, &versym_addr)) {
		return false;
	}

	ut64 versym_offset = Elf_(rz_bin_elf_v2p(bin, versym_addr));

	if (versym_offset == UT64_MAX) {
		return NULL;
	}

	ut64 number_of_symbols = Elf_(rz_bin_elf_get_number_of_dynamic_symbols)(bin);
	if (!number_of_symbols) {
		return NULL;
	}

	Sdb *sdb = sdb_new0();
	if (!sdb) {
		return NULL;
	}

	if (!sdb_num_set(sdb, "num_entries", number_of_symbols, 0) ||
		!sdb_num_set(sdb, "addr", versym_addr, 0) ||
		!sdb_num_set(sdb, "offset", versym_offset, 0)) {
		sdb_free(sdb);
		return NULL;
	}

	ut64 versym_entry_offset = versym_offset;

	for (size_t i = 0; i < number_of_symbols; i++) {
		char key[32];
		if (rz_strf(key, "entry%zu", i) == NULL) {
			sdb_free(sdb);
			return NULL;
		}

		Elf_(Versym) versym_entry;
		if (!Elf_(rz_bin_elf_read_versym)(bin, &versym_entry_offset, &versym_entry)) {
			sdb_free(sdb);
			return NULL;
		}

		switch (versym_entry) {
		case VER_NDX_LOCAL:
			if (!sdb_set(sdb, key, "0 (*local*)", 0)) {
				sdb_free(sdb);
				return NULL;
			}
			break;
		case VER_NDX_GLOBAL:
			if (!sdb_set(sdb, key, "1 (*global*)", 0)) {
				sdb_free(sdb);
				return NULL;
			}
			break;
		default:
			if (get_versym_entry_sdb_from_verneed(bin, sdb, key, versym_entry)) {
				break;
			}

			if (!get_versym_entry_sdb_from_verdef(bin, sdb, key, versym_entry)) {
				sdb_free(sdb);
				return NULL;
			}
		}
	}

	return sdb;
}
