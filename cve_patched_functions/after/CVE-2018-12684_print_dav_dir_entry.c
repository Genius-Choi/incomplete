print_dav_dir_entry(struct de *de, void *data)
{
	char href[PATH_MAX];
	int truncated;

	struct mg_connection *conn = (struct mg_connection *)data;
	if (!de || !conn) {
		return -1;
	}
	mg_snprintf(conn,
	            &truncated,
	            href,
	            sizeof(href),
	            "%s%s",
	            conn->request_info.local_uri,
	            de->file_name);

	if (!truncated) {
		size_t href_encoded_size;
		char *href_encoded;

		href_encoded_size = PATH_MAX * 3; /* worst case */
		href_encoded = (char *)mg_malloc(href_encoded_size);
		if (href_encoded == NULL) {
			return -1;
		}
		mg_url_encode(href, href_encoded, href_encoded_size);
		print_props(conn, href_encoded, &de->file);
		mg_free(href_encoded);
	}

	return 0;
}
