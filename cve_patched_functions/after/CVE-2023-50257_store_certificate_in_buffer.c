bool store_certificate_in_buffer(X509* certificate, BUF_MEM** ptr)
{
    bool returnedValue = false;

    BIO *out = BIO_new(BIO_s_mem());

    if(out != nullptr)
    {
        if(PEM_write_bio_X509(out, certificate) > 0 )
        {
            BIO_get_mem_ptr(out, ptr);

            if(*ptr != nullptr)
            {
                BIO_set_close(out, BIO_NOCLOSE);
                returnedValue = true;
            }
            else
                logError(AUTHENTICATION, "OpenSSL library cannot retrieve mem ptr");
        }
        else
            logError(AUTHENTICATION, "OpenSSL library cannot write cert");

        BIO_free(out);
    }
    else
        logError(AUTHENTICATION, "OpenSSL library cannot allocate mem");

    return returnedValue;
}
