int ep4_on_curve(const ep4_t p) {
	ep4_t t;
	int r = 0;

	ep4_null(t);

	RLC_TRY {
		ep4_new(t);

		ep4_norm(t, p);

		ep4_rhs(t->x, t);
		fp4_sqr(t->y, t->y);

		r = (fp4_cmp(t->x, t->y) == RLC_EQ) || ep4_is_infty(p);
	} RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	} RLC_FINALLY {
		ep4_free(t);
	}
	return r;
}
