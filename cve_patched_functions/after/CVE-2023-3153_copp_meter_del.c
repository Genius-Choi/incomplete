copp_meter_del(const struct nbrec_copp *copp, const char *proto_name)
{
    if (!copp) {
        return;
    }

    if (proto_name) {
        if (smap_get(&copp->meters, proto_name)) {
            struct smap meters;
            smap_init(&meters);
            smap_clone(&meters, &copp->meters);
            smap_remove(&meters, proto_name);
            nbrec_copp_set_meters(copp, &meters);
            smap_destroy(&meters);
        }
        if (smap_is_empty(&copp->meters)) {
            nbrec_copp_delete(copp);
        }
    } else {
        nbrec_copp_delete(copp);
    }
}
