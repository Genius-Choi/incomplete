_netplan_enumerate_interfaces(const NetplanNetDefinition* def, GHashTable* ifaces, GHashTable* tbl, const char* carrier, const char* set_name, const char* rootdir)
{
    g_assert(ifaces);
    g_assert(tbl);

    GHashTableIter iter;
    gpointer key;
    g_hash_table_iter_init (&iter, ifaces);
    while (g_hash_table_iter_next (&iter, &key, NULL)) {
        const char* ifname = key;
        if (g_hash_table_contains(tbl, ifname)|| (set_name && g_hash_table_contains(tbl, set_name))) continue;
        g_autofree gchar* mac = _netplan_sysfs_get_mac_by_ifname(ifname, rootdir);
        g_autofree gchar* driver = _netplan_sysfs_get_driver_by_ifname(ifname, rootdir);
        if (netplan_netdef_match_interface(def, ifname, mac, driver))
            g_hash_table_replace(tbl, set_name ? g_strdup(set_name) : g_strdup(ifname), g_strdup(carrier));
    }
}
