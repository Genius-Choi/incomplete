static void _exit_enclave(uint64_t arg1, uint64_t arg2)
{
    oe_sgx_td_t* td = oe_sgx_get_td();

    if (oe_is_enclave_debug_allowed())
    {
        oe_ecall_context_t* host_ecall_context = td->host_ecall_context;

        // Make sure the context is valid.
        if (host_ecall_context &&
            oe_is_outside_enclave(
                host_ecall_context, sizeof(*host_ecall_context)))
        {
            uint64_t* frame = (uint64_t*)__builtin_frame_address(0);

            /* NOTE: host memory writes that is only for debugging purposes,
             * no need for using write with barrier */
            host_ecall_context->debug_eexit_rbp = frame[0];
            // The caller's RSP is always given by this equation
            //   RBP + 8 (caller frame pointer) + 8 (caller return address)
            host_ecall_context->debug_eexit_rsp = frame[0] + 8;
            host_ecall_context->debug_eexit_rip = frame[1];
        }
    }
    oe_asm_exit(arg1, arg2, td, 0 /* direct_return */);
}
