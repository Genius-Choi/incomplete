static ut8 *decode_text(RCore *core, ut64 offset, size_t len, bool zeroend) {
	const char *current_charset = r_config_get (core->config, "cfg.charset");
	ut8 *out = calloc (len, 10);
	if (out) {
		r_io_read_at (core->io, core->offset, out, len);
		if (zeroend) {
			len = (size_t)r_str_nlen ((const char*)out, len);
		}
		if (!R_STR_ISEMPTY (current_charset)) {
			size_t out_len = len * 10;
			ut8 *data = out;
			out = calloc (len, 10);
			if (out) {
				r_io_read_at (core->io, core->offset, data, len);
				r_charset_encode_str (core->print->charset, out, out_len, data, len);
				free (data);
			}
		}
	}
	return out;
}
