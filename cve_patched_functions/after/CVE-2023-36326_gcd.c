static int gcd(void) {
	int code = RLC_ERR;
	bn_t a, b, c, d, e, f, g, h;

	bn_null(a);
	bn_null(b);
	bn_null(c);
	bn_null(d);
	bn_null(e);
	bn_null(f);
	bn_null(g);
	bn_null(h);

	RLC_TRY {
		bn_new(a);
		bn_new(b);
		bn_new(c);
		bn_new(d);
		bn_new(e);
		bn_new(f);
		bn_new(g);
		bn_new(h);

		TEST_CASE("greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd(c, a, b);
			bn_mod(d, a, c);
			bn_mod(e, b, c);
			TEST_ASSERT(bn_is_zero(d) && bn_is_zero(e), end);
			bn_div(a, a, c);
			bn_div(b, b, c);
			bn_gcd(c, a, b);
			TEST_ASSERT(bn_cmp_dig(c, 1) == RLC_EQ, end);
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_zero(b);
			bn_gcd(c, a, b);
			TEST_ASSERT(bn_cmp_abs(c, a) == RLC_EQ, end);
			bn_rand(a, RLC_NEG, RLC_BN_BITS);
			bn_zero(b);
			bn_gcd(c, a, b);
			TEST_ASSERT(bn_cmp_abs(c, a) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("extended greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd_ext(c, d, e, a, b);
			bn_mul(d, d, a);
			bn_mul(e, e, b);
			bn_add(d, d, e);
			bn_gcd(f, a, b);
			TEST_ASSERT(bn_cmp(c, d) == RLC_EQ && bn_cmp(c, f) == RLC_EQ, end);
		} TEST_END;

#if BN_GCD == BASIC || !defined(STRIP)
		TEST_CASE("basic greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd(c, a, b);
			bn_gcd_basic(d, a, b);
			TEST_ASSERT(bn_cmp(c, d) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("basic extended greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd_basic(f, a, b);
			bn_gcd_ext_basic(c, d, e, a, b);
			bn_mul(d, d, a);
			bn_mul(e, e, b);
			bn_add(d, d, e);
			TEST_ASSERT(bn_cmp(c, d) == RLC_EQ && bn_cmp(c, f) == RLC_EQ, end);
			bn_gcd_ext(c, d, e, a, b);
			bn_gcd_ext_basic(f, g, h, a, b);
			TEST_ASSERT(bn_cmp(c, f) == RLC_EQ && bn_cmp(d, g) == RLC_EQ
				&& bn_cmp(e, h) == RLC_EQ, end);
		} TEST_END;
#endif

#if BN_GCD == BINAR || !defined(STRIP)
		TEST_CASE("binary greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd(c, a, b);
			bn_gcd_binar(d, a, b);
			TEST_ASSERT(bn_cmp(c, d) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("binary extended greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd_binar(f, a, b);
			bn_gcd_ext_binar(c, d, e, a, b);
			bn_mul(d, d, a);
			bn_mul(e, e, b);
			bn_add(d, d, e);
			TEST_ASSERT(bn_cmp(c, d) == RLC_EQ && bn_cmp(c, f) == RLC_EQ, end);
			bn_gcd_ext(c, d, e, a, b);
			bn_gcd_ext_binar(f, g, h, a, b);
			TEST_ASSERT(bn_cmp(c, f) == RLC_EQ && bn_cmp(d, g) == RLC_EQ
				&& bn_cmp(e, h) == RLC_EQ, end);
		} TEST_END;
#endif

#if BN_GCD == LEHME || !defined(STRIP)
		TEST_CASE("lehmer greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd(c, a, b);
			bn_gcd_lehme(d, a, b);
			TEST_ASSERT(bn_cmp(c, d) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("lehmer extended greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd_lehme(f, a, b);
			bn_gcd_ext_lehme(c, d, e, a, b);
			bn_mul(d, d, a);
			bn_mul(e, e, b);
			bn_add(d, d, e);
			TEST_ASSERT(bn_cmp(c, d) == RLC_EQ && bn_cmp(c, f) == RLC_EQ, end);
			bn_gcd_ext(c, d, e, a, b);
			bn_gcd_ext_lehme(f, g, h, a, b);
			TEST_ASSERT(bn_cmp(c, f) == RLC_EQ && bn_cmp(d, g) == RLC_EQ
				&& bn_cmp(e, h) == RLC_EQ, end);
		} TEST_END;
#endif

		TEST_CASE("midway extended greatest common divisor is correct") {
			bn_rand(a, RLC_POS, RLC_BN_BITS);
			bn_rand(b, RLC_POS, RLC_BN_BITS);
			bn_gcd_ext_mid(c, d, e, f, a, b);
			bn_abs(d, d);
			bn_abs(f, f);
			bn_mul(c, c, f);
			bn_mul(e, e, d);
			bn_add(c, c, e);
			TEST_ASSERT(bn_cmp(b, c) == RLC_EQ || bn_cmp(a, c) == RLC_EQ, end);
		} TEST_END;
	}
	RLC_CATCH_ANY {
		RLC_ERROR(end);
	}
	code = RLC_OK;
  end:
	bn_free(a);
	bn_free(b);
	bn_free(c);
	bn_free(d);
	bn_free(e);
	bn_free(f);
	bn_free(g);
	bn_free(h);
	return code;
}
