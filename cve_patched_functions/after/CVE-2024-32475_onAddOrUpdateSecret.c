void ServerSslSocketFactory::onAddOrUpdateSecret() {
  ENVOY_LOG(debug, "Secret is updated.");
  auto ctx = manager_.createSslServerContext(stats_scope_, *config_, server_names_, nullptr);
  {
    absl::WriterMutexLock l(&ssl_ctx_mu_);
    std::swap(ctx, ssl_ctx_);
  }
  manager_.removeContext(ctx);

  stats_.ssl_context_update_by_sds_.inc();
}
