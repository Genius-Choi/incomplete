demangle_integral_value(work, mangled, s)
struct work_stuff *work;
const char **mangled;
string *s;
{
	int success;

	if (**mangled == 'E') {
		int need_operator = 0;

		success = 1;
		string_appendn(s, "(", 1);
		(*mangled)++;
		while (success && **mangled != 'W' && **mangled != '\0') {
			if (need_operator) {
				size_t i;
				size_t len;

				success = 0;

				len = strlen(*mangled);

				for (i = 0;
					i < sizeof(optable) / sizeof(optable[0]);
					++i) {
					size_t l = strlen(optable[i].in);

					if (l <= len && memcmp(optable[i].in, *mangled, l) == 0) {
						string_appendn(s, " ", 1);
						string_append(s, optable[i].out);
						string_appendn(s, " ", 1);
						success = 1;
						(*mangled) += l;
						break;
					}
				}

				if (!success)
					break;
			} else
				need_operator = 1;

			success = demangle_template_value_parm(work, mangled, s,
				tk_integral);
		}

		if (**mangled != 'W')
			success = 0;
		else {
			string_appendn(s, ")", 1);
			(*mangled)++;
		}
	} else if (**mangled == 'Q' || **mangled == 'K')
		success = demangle_qualified(work, mangled, s, 0, 1);
	else {
		success = 0;

		if (**mangled == 'm') {
			string_appendn(s, "-", 1);
			(*mangled)++;
		}
		while (isdigit((unsigned char)**mangled)) {
			string_appendn(s, *mangled, 1);
			(*mangled)++;
			success = 1;
		}
	}

	return success;
}
