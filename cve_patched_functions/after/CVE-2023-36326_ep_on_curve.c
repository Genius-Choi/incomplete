int ep_on_curve(const ep_t p) {
	ep_t t;
	int r = 0;

	ep_null(t);

	RLC_TRY {
		ep_new(t);

		ep_norm(t, p);
		ep_rhs(t->x, t);
		fp_sqr(t->y, t->y);
		r = (fp_cmp(t->x, t->y) == RLC_EQ) || ep_is_infty(p);
	} RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	} RLC_FINALLY {
		ep_free(t);
	}
	return r;
}
