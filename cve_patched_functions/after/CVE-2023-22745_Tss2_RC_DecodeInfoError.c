Tss2_RC_DecodeInfoError(TSS2_RC_INFO *info)
{
    static __thread char buf[TSS2_ERR_LAYER_ERROR_STR_MAX + 1];
    const char *m = NULL;

    if (!info) {
        return NULL;
    }
    clearbuf(buf);

    if (info->format) {
        m = tss2_fmt1_err_strs_get(info->error ^ TPM2_RC_FMT1);
    } else {
        m = tss2_fmt0_err_strs_get(info->error ^ TPM2_RC_VER1);
    }

    if (m) {
        catbuf(buf, "%s", m);
    } else {
        catbuf(buf, "0x%X", info->error);
    }

    return buf;
}
