int pico_ipv4_is_valid_src(struct pico_stack *S, uint32_t address, struct pico_device *dev)
{
    if (pico_ipv4_is_broadcast(S, address)) {
        dbg("Source is a broadcast address, discard packet\n");
        return 0;
    } else if ( pico_ipv4_is_multicast(address)) {
        dbg("Source is a multicast address, discard packet\n");
        return 0;
    } else if (pico_ipv4_is_invalid_loopback(address, dev)) {
        dbg("Source is a loopback address, discard packet\n");
        return 0;
    } else {
#ifdef PICO_SUPPORT_AODV
        union pico_address src;
        src.ip4.addr = address;
        pico_aodv_refresh(dev->stack, &src);
#endif
        return 1;
    }
}
