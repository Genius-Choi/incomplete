void ed_blind(ed_t r, const ed_t p) {
	fp_t rand;

	fp_null(rand);

	RLC_TRY {
		fp_new(rand);
		fp_rand(rand);
#if ED_ADD == BASIC
		(void)rand;
		ed_copy(r, p);
#elif ED_ADD == PROJC || ED_ADD == EXTND
		fp_mul(r->x, p->x, rand);
		fp_mul(r->y, p->y, rand);
		fp_mul(r->z, p->z, rand);
		r->coord = PROJC;
#endif
#if ED_ADD == EXTND
		fp_mul(r->t, p->t, rand);
#endif
	} RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	} RLC_FINALLY {
		fp_free(rand);
	}
}
