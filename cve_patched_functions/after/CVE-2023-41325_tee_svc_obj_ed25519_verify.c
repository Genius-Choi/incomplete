tee_svc_obj_ed25519_verify(struct ed25519_public_key *key,
			   const uint8_t *msg, size_t msg_len,
			   const uint8_t *sig, size_t sig_len,
			   const TEE_Attribute *params, size_t num_params)
{
	TEE_Result err = TEE_ERROR_GENERIC;
	size_t ctx_len = 0;
	const uint8_t *ctx = NULL;
	bool ph_flag = false;

	err = tee_svc_obj_ed25519_parse_params(params, num_params, &ph_flag,
					       &ctx, &ctx_len);
	if (err)
		return err;

	if (ph_flag || ctx) {
		return crypto_acipher_ed25519ctx_verify(key, msg, msg_len, sig,
							sig_len, ph_flag,
							ctx, ctx_len);
	}

	return crypto_acipher_ed25519_verify(key, msg, msg_len, sig, sig_len);
}
