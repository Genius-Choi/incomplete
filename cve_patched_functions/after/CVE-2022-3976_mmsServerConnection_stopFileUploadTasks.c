mmsServerConnection_stopFileUploadTasks(MmsServerConnection self)
{
    MmsServer server = self->server;

    int i;

    for (i = 0; i < CONFIG_MMS_SERVER_MAX_GET_FILE_TASKS; i++) {

#if (CONFIG_MMS_THREADLESS_STACK != 1)
        Semaphore_wait(server->fileUploadTasks[i].taskLock);
#endif

        if (server->fileUploadTasks[i].state != 0) {

            if (server->fileUploadTasks[i].connection == self) {

                /* stop file upload task */
                server->fileUploadTasks[i].state = MMS_FILE_UPLOAD_STATE_INTERRUPTED;
            }

        }

#if (CONFIG_MMS_THREADLESS_STACK != 1)
        Semaphore_post(server->fileUploadTasks[i].taskLock);
#endif
    }
}
