maybe_set_noprogress_alarm (struct ietf_full_conn *conn, lsquic_time_t now)
{
    lsquic_time_t exp;

    if (conn->ifc_mflags & MF_NOPROG_TIMEOUT)
    {
        if (conn->ifc_pub.last_tick)
        {
            exp = conn->ifc_pub.last_prog + conn->ifc_enpub->enp_noprog_timeout;
            if (!lsquic_alarmset_is_set(&conn->ifc_alset, AL_IDLE)
                                    || exp < conn->ifc_alset.as_expiry[AL_IDLE])
                lsquic_alarmset_set(&conn->ifc_alset, AL_IDLE, exp);
            conn->ifc_pub.last_tick = now;
        }
        else
        {
            conn->ifc_pub.last_tick = now;
            conn->ifc_pub.last_prog = now;
        }
    }
}
