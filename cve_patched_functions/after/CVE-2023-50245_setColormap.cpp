void YFramebufferModel::setColormap(ColormapModule::Map map)
{
    if (!m_isImageLoaded) {
        return;
    }

    // Several calls can occur within a short time e.g., when changing exposure
    // Ensure to cancel any previous running conversion and wait for the
    // process to end
    // Also, bad idea to change the colormap if a process is using it
    if (m_imageEditingWatcher->isRunning()) {
        m_imageEditingWatcher->cancel();
        m_imageEditingWatcher->waitForFinished();
    }

    if (m_cmap) {
        delete m_cmap;
        m_cmap = nullptr;
    }

    m_cmap = ColormapModule::create(map);

    updateImage();
}
