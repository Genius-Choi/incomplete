int64_t GetProofOfStakeReward(int64_t nHeight, int64_t nCoinAge, int64_t nFees) {
    int64_t nRewardCoinYear = 9 * CENT;
    int64_t nSubsidy;

    if(fTestNet) {
        nRewardCoinYear   = 300 * CENT;
    } else {
        if(nHeight >= nForkOne)
          nRewardCoinYear = 300 * CENT;
        if(nHeight >= (nForkOne + 130000))
          nRewardCoinYear = 200 * CENT;
        if(nHeight >= (nForkOne + 260000))
          nRewardCoinYear = 100 * CENT;
    }

    if(!fTestNet && (nHeight < nStakeRewardFork))
      nSubsidy = (nCoinAge * nRewardCoinYear) / (365 * COIN);
    else
      nSubsidy = (nCoinAge / 365) * (nRewardCoinYear / COIN);

    if(fTestNet || (!fTestNet && (nHeight >= nForkOne)))
      if(nSubsidy > 5 * COIN) nSubsidy = 5 * COIN;

    return(nSubsidy + nFees);
}
