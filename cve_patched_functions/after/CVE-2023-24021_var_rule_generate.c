static int var_rule_generate(modsec_rec *msr, msre_var *var, msre_rule *rule,
    apr_table_t *vartab, apr_pool_t *mptmp)
{
    msre_actionset *actionset = NULL;

    if (rule == NULL) return 0;

    actionset = rule->actionset;
    if (rule->chain_starter != NULL) actionset = rule->chain_starter->actionset;

    if ((strcasecmp(var->param, "id") == 0)&&(actionset->id != NULL)) {
        return var_simple_generate(var, vartab, mptmp, actionset->id);
    } else
    if ((strcasecmp(var->param, "rev") == 0)&&(actionset->rev != NULL)) {
        return var_simple_generate(var, vartab, mptmp, actionset->rev);
    } else
    if ((strcasecmp(var->param, "severity") == 0)&&(actionset->severity != -1)) {
        char *value = apr_psprintf(mptmp, "%d", actionset->severity);
        return var_simple_generate(var, vartab, mptmp, value);
    } else
    if ((strcasecmp(var->param, "msg") == 0)&&(actionset->msg != NULL)) {
        return var_simple_generate(var, vartab, mptmp, actionset->msg);
    } else
    if ((strcasecmp(var->param, "logdata") == 0)&&(actionset->logdata != NULL)) {
        return var_simple_generate(var, vartab, mptmp, actionset->logdata);
    } else
    if ((strcasecmp(var->param, "ver") == 0)&&(actionset->version != NULL)) {
        return var_simple_generate(var, vartab, mptmp, actionset->version);
    } else
    if ((strcasecmp(var->param, "maturity") == 0)&&(actionset->maturity != -1)) {
        char *value = apr_psprintf(mptmp, "%d", actionset->maturity);
        return var_simple_generate(var, vartab, mptmp, value);
    } else
    if ((strcasecmp(var->param, "accuracy") == 0)&&(actionset->accuracy != -1)) {
        char *value = apr_psprintf(mptmp, "%d", actionset->accuracy);
        return var_simple_generate(var, vartab, mptmp, value);
    }


    return 0;
}
