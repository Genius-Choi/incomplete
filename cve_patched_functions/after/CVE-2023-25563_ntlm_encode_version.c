static int ntlm_encode_version(struct ntlm_ctx *ctx,
                               struct ntlm_buffer *buffer,
                               size_t data_offs)
{
    if (data_offs + sizeof(struct wire_version) > buffer->length) {
        return ERR_ENCODE;
    }

    memcpy(&buffer->data[data_offs], &ntlmssp_version,
           sizeof(struct wire_version));
    return 0;
}
