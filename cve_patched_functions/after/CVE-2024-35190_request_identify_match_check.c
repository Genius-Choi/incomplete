static int request_identify_match_check(void *obj, void *arg, int flags)
{
	struct ip_identify_match *identify = obj;
	struct pjsip_rx_data *rdata = arg;
	int len;
	char buf[PJSIP_MAX_URL_SIZE];

	if (ast_strlen_zero(identify->match_request_uri)) {
		return 0;
	}

	/* Print request URI to req_buf */
	len = pjsip_uri_print(PJSIP_URI_IN_REQ_URI, rdata->msg_info.msg->line.req.uri, buf, sizeof(buf) - 1);
	if (len < 0) {
		/* Buffer not large enough or no pj uri vptr! */
		ast_assert(0);
	} else {
		/* Terminate the pj_str */
		buf[len] = '\0';
		/* Does request URI match what we are looking for? */
		if (identify->is_request_uri_regex) {
			if (!regexec(&identify->regex_request_uri_buf, buf, 0, NULL, 0)) {
				return CMP_MATCH;
			}
		} else if (!strcmp(identify->match_request_uri, buf)) {
			return CMP_MATCH;
		}
		ast_debug(3, "Identify '%s': request URI not match '%s' (value='%s').\n",
			ast_sorcery_object_get_id(identify), identify->match_request_uri, buf);
	}

	return 0;
}
