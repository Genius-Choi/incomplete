  auto validate_type = [this](const Tensor& val) {
    if (val.dtype() == dtype_) {
      return OkStatus();
    } else {
      return errors::InvalidArgument("Type mismatch: actual ",
                                     DataTypeString(val.dtype()),
                                     " vs. expect ", DataTypeString(dtype_));
    }
  };
