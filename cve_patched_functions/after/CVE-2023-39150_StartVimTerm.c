HANDLE CEAnsi::StartVimTerm(bool bFromDllStart)
{
	// Only certain versions of Vim able to use xterm-256 in ConEmu
	if (gnExeFlags & (caf_Cygwin1|caf_Msys1|caf_Msys2))
		return GetStdHandle(STD_OUTPUT_HANDLE);

	// For native vim - don't handle "--help" and "--version" switches
	// Has no sense for cygwin/msys, but they are skipped above
	CmdArg lsArg;
	LPCWSTR pszCmdLine = GetCommandLineW();
	LPCWSTR pszCompare[] = {L"--help", L"-h", L"--version", nullptr};
	while ((pszCmdLine = NextArg(pszCmdLine, lsArg)))
	{
		for (INT_PTR i = 0; pszCompare[i]; i++)
		{
			if (wcscmp(lsArg, pszCompare[i]) == 0)
				return GetStdHandle(STD_OUTPUT_HANDLE);
		}
	}

	return XTermAltBuffer(true);
}
