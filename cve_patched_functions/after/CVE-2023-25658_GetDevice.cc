/* static */ tsl::Status GpuDriver::GetDevice(int device_ordinal,
                                              hipDevice_t* device) {
  hipError_t res = wrap::hipDeviceGet(device, device_ordinal);
  if (res == hipSuccess) {
    return tsl::OkStatus();
  }

  return tsl::Status{
      tsl::error::INTERNAL,
      absl::StrCat("failed call to hipDeviceGet: ", ToString(res))};
}
