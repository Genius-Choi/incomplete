bool tr_variantGetReal(tr_variant const* v, double* setme)
{
    bool success = false;

    if (tr_variantIsReal(v))
    {
        *setme = v->val.d;
        success = true;
    }

    if (!success && tr_variantIsInt(v))
    {
        *setme = v->val.i;
        success = true;
    }

    if (!success && tr_variantIsString(v))
    {
        char* endptr;
        struct locale_context locale_ctx;
        double d;

        /* the json spec requires a '.' decimal point regardless of locale */
        use_numeric_locale(&locale_ctx, "C");
        d = strtod(getStr(v), &endptr);
        restore_locale(&locale_ctx);

        if (getStr(v) != endptr && *endptr == '\0')
        {
            *setme = d;
            success = true;
        }
    }

    return success;
}
