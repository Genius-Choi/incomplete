void ep2_mul_fix_basic(ep2_t r, const ep2_t *t, const bn_t k) {
	bn_t n, _k;

	if (bn_is_zero(k)) {
		ep2_set_infty(r);
		return;
	}

	bn_null(n);
	bn_null(_k);

	RLC_TRY {
		bn_new(n);
		bn_new(_k);

		ep2_curve_get_ord(n);
		bn_mod(_k, k, n);

		ep2_set_infty(r);
		for (int i = 0; i < bn_bits(_k); i++) {
			if (bn_get_bit(_k, i)) {
				ep2_add(r, r, t[i]);
			}
		}
		ep2_norm(r, r);
		if (bn_sign(_k) == RLC_NEG) {
			ep2_neg(r, r);
		}
	} RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	} RLC_FINALLY {
		bn_free(n);
		bn_free(_k);
	}
}
