someip_print(netdissect_options *ndo, const u_char *bp, u_int len)
{
    uint32_t message_id;
    uint16_t service_id;
    uint16_t method_or_event_id;
    uint8_t event_flag;
    uint32_t message_len;
    uint32_t request_id;
    uint16_t client_id;
    uint16_t session_id;
    uint8_t protocol_version;
    uint8_t interface_version;
    uint8_t message_type;
    uint8_t return_code;

    ndo->ndo_protocol = "someip";

    if (len < 16) {
        nd_print_trunc(ndo);
        return;
    }

    message_id = GET_BE_U_4(bp);
    service_id = message_id >> 16;
    event_flag = (message_id & 0x00008000) >> 15;
    method_or_event_id = message_id & 0x00007FFF;
    bp += 4;

    message_len = GET_BE_U_4(bp);
    bp += 4;

    request_id = GET_BE_U_4(bp);
    client_id = request_id >> 16;
    session_id = request_id & 0x0000FFFF;
    bp += 4;

    protocol_version = GET_U_1(bp);
    bp += 1;

    interface_version = GET_U_1(bp);
    bp += 1;

    message_type = GET_U_1(bp);
    bp += 1;

    return_code = GET_U_1(bp);
    bp += 1;

    ND_PRINT("SOMEIP, service %u, %s %u, len %u, client %u, session %u, "
	     "pver %u, iver %u, msgtype %s, retcode %s\n",
	     service_id, event_flag ? "event" : "method", method_or_event_id,
	     message_len, client_id, session_id, protocol_version,
	     interface_version,
	     tok2str(message_type_values, "Unknown", message_type),
	     tok2str(return_code_values, "Unknown", return_code));
    return;
}
