static int fixed1(void) {
	int code = RLC_ERR;
	g1_t p, q, r;
	g1_t t[RLC_G1_TABLE];
	bn_t n, k;

	bn_null(n);
	bn_null(k);
	g1_null(p);
	g1_null(q);
	g1_null(r);

	for (int i = 0; i < RLC_G1_TABLE; i++) {
		g1_null(t[i]);
	}

	RLC_TRY {
		g1_new(p);
		g1_new(q);
		g1_new(r);
		bn_new(n);
		bn_new(k);

		g1_get_gen(p);
		pc_get_ord(n);

		for (int i = 0; i < RLC_G1_TABLE; i++) {
			g1_new(t[i]);
		}
		TEST_CASE("fixed point multiplication is correct") {
			g1_rand(p);
			g1_mul_pre(t, p);
			bn_zero(k);
			g1_mul_fix(r, (const g1_t *)t, k);
			TEST_ASSERT(g1_is_infty(r), end);
			bn_set_dig(k, 1);
			g1_mul_fix(r, (const g1_t *)t, k);
			TEST_ASSERT(g1_cmp(p, r) == RLC_EQ, end);
			bn_rand_mod(k, n);
			g1_mul(q, p, k);
			g1_mul_fix(q, (const g1_t *)t, k);
			g1_mul(r, p, k);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_neg(k, k);
			g1_mul_fix(r, (const g1_t *)t, k);
			g1_neg(r, r);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
		} TEST_END;
		for (int i = 0; i < RLC_G1_TABLE; i++) {
			g1_free(t[i]);
		}
	}
	RLC_CATCH_ANY {
		util_print("FATAL ERROR!\n");
		RLC_ERROR(end);
	}
	code = RLC_OK;
  end:
	g1_free(p);
	g1_free(q);
	g1_free(r);
	bn_free(n);
	bn_free(k);
	return code;
}
