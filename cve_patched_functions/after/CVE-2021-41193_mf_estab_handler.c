static void mf_estab_handler(struct iflow *iflow,
			     const char *crypto,
			     const char *codec,
			     void *arg)
{
	struct ecall *ecall = arg;

	assert(ECALL_MAGIC == ecall->magic);

	if (iflow != ecall->flow) {
		info("ecall(%p): ignoring %s on wrong flow\n", ecall, __FUNCTION__);
		return;
	}

	info("ecall(%p): flow established (crypto=%s)\n",
	     ecall, crypto);

	if (ecall->call_estab_time < 0 && ecall->ts_answered) {
		ecall->call_estab_time = tmr_jiffies() - ecall->ts_answered;
	}

	if (!ecall->audio.estab)
		ecall->audio.estab = true;

	ecall->established = true;
	tmr_cancel(&ecall->connection_tmr);
	if (ecall->icall.media_estabh) {

		/* Start a timer to check that we do start Audio Later */
		tmr_start(&ecall->media_start_tmr, TIMEOUT_MEDIA_START,
			  media_start_timeout_handler, ecall);

		ICALL_CALL_CB(ecall->icall, media_estabh, &ecall->icall, ecall->userid_peer,
			      ecall->clientid_peer, ecall->update, ecall->icall.arg);
	}
	else {
		int err = ecall_media_start(ecall);
		if (err) {
			ecall_end(ecall);
		}
	}	
}
