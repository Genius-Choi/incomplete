void mg_if_connect_cb(struct mg_connection *nc, int err) {
  LOG(LL_DEBUG,
      ("%p %s://%s:%hu -> %d", nc, (nc->flags & MG_F_UDP ? "udp" : "tcp"),
       inet_ntoa(nc->sa.sin.sin_addr), ntohs(nc->sa.sin.sin_port), err));
  nc->flags &= ~MG_F_CONNECTING;
  if (err != 0) {
    nc->flags |= MG_F_CLOSE_IMMEDIATELY;
  }
#if MG_ENABLE_SSL
  if (err == 0 && (nc->flags & MG_F_SSL)) {
    mg_ssl_handshake(nc);
  } else
#endif
  {
    mg_call(nc, NULL, nc->user_data, MG_EV_CONNECT, &err);
  }
}
