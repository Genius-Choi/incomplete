static int _ldap_rebind_proc(LDAP* /*ldap*/, const char* url, ber_tag_t /*req*/,
                             ber_int_t /*msgid*/, void* params) {
  auto ld = getLdapLinkFromToken(params);

  /* link exists and callback set? */
  if (!ld || ld->rebindproc.isNull()) {
    raise_warning("Link not found or no callback set");
    return LDAP_OTHER;
  }

  /* callback */
  Variant ret = vm_call_user_func
    (ld->rebindproc, make_vec_array(Variant(ld), String(url, CopyString)));
  return ret.toInt64();
}
