json_store_exit_value(struct json_item *item, struct eventlog *evlog)
{
    debug_decl(json_store_exit_value, SUDO_DEBUG_UTIL);

    if (item->u.number < 0 || item->u.number > INT_MAX) {
	sudo_debug_printf(SUDO_DEBUG_ERROR|SUDO_DEBUG_LINENO,
	    "exit value %lld: out of range", item->u.number);
	evlog->exit_value = -1;
	debug_return_bool(false);
    }

    evlog->exit_value = item->u.number;
    debug_return_bool(true);
}
