static int parse_ull(sdp_parser_t *p, char **r,
		     uint64_t *result, uint64_t max)
{
  unsigned long long ull;

  char *s = *r;

  s += strspn(s, SPACE TAB);

  ull = strtoull(s, r, 10);

  if (s != *r && !(max && max <= ull)) {
    *result = (uint64_t)ull;
    *r += strspn(*r, SPACE TAB);
    return 0;
  }

  return -1;
}
