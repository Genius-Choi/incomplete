cert_from_signed_object(struct rpki_uri *uri, uint8_t **result, int *size)
{
	struct signed_object sobj;
	ANY_t *cert;
	unsigned char *tmp;
	int error;

	error = signed_object_decode(&sobj, uri);
	if (error)
		return error;

	cert = sobj.sdata.decoded->certificates->list.array[0];

	tmp = malloc(cert->size);
	if (tmp == NULL) {
		signed_object_cleanup(&sobj);
		return pr_enomem();
	}

	memcpy(tmp, cert->buf, cert->size);

	*result = tmp;
	(*size) = cert->size;

	signed_object_cleanup(&sobj);
	return 0;
}
