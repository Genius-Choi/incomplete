static int cjwt_update_header( cjwt_t *p_cjwt, char *p_dechead )
    // The data is probably not json vs. memory allocation error.
{
    if( !p_cjwt || !p_dechead ) {
        return EINVAL;
    }

    //create cJSON object
    cJSON *j_header = cJSON_Parse( ( char* )p_dechead );

    if( !j_header ) {
        // The data is probably not json vs. memory allocation error.
        return EINVAL;
    }

    cjwt_info( "Json  = %s\n", cJSON_Print( j_header ) );
    cjwt_info( "--------------------------------------------- \n\n" );
    //extract data
    cJSON* j_typ = cJSON_GetObjectItem( j_header, "typ" );

    if( !j_typ || strcmp( j_typ->valuestring, "JWT" ) ) {
        cjwt_info( "may not be a JWT token\n" );
    }

    cJSON* j_alg = cJSON_GetObjectItem( j_header, "alg" );

    if( j_alg ) {
        int alg;

        alg = cjwt_alg_str_to_enum( j_alg->valuestring );
        if( -1 == alg ) {
            cJSON_Delete( j_header );
            return ENOTSUP;
        }
        p_cjwt->header.alg = alg;
    }

    //destroy cJSON object
    cJSON_Delete( j_header );
    return 0;
}
