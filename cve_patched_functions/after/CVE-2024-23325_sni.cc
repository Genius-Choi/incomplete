const std::string& ConnectionInfoImplBase::sni() const {
  if (sni_.empty()) {
    const char* proto = SSL_get_servername(ssl(), TLSEXT_NAMETYPE_host_name);
    if (proto != nullptr) {
      sni_ = std::string(proto);
    }
  }
  return sni_;
}
