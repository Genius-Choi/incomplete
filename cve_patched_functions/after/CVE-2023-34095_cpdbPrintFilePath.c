char *cpdbPrintFilePath(cpdb_printer_obj_t *p,
                        const char *file_path,
                        const char *final_file_path)
{
    char *result, *absolute_file_path, *absolute_final_file_path;
    GError *error = NULL;
    
    absolute_file_path = cpdbGetAbsolutePath(file_path);
    absolute_final_file_path = cpdbGetAbsolutePath(final_file_path);
    logdebug("Printing file %s on %s %s to %s\n",
                absolute_file_path, p->id, p->backend_name, absolute_final_file_path);
    cpdbDebugPrintSettings(p->settings);
    print_backend_call_print_file_sync(p->backend_proxy,
                                       p->id,
                                       absolute_file_path,
                                       p->settings->count,
                                       cpdbSerializeToGVariant(p->settings),
                                       absolute_final_file_path,
                                       &result,
                                       NULL,
                                       &error);
    
    if (error)
    {
        logerror("Error printing file %s to %s : %s\n", 
                 absolute_file_path, absolute_final_file_path, error->message);
        return NULL;
    }
    
    if (result == NULL)
    {
        logerror("Error printing file %s to %s\n", 
                 absolute_file_path, absolute_final_file_path);
        return NULL;
    }
    
    loginfo("File %s printed to %s successfully\n",
                absolute_file_path, absolute_final_file_path);
    free(absolute_file_path);
    free(absolute_final_file_path);
    return result;
}
