bool mobi_is_replica(const MOBIData *m) {
    if (m == NULL) {
        debug_print("%s", "Mobi structure not initialized\n");
        return false;
    }
    if (m->rec && m->rh && m->rh->compression_type == MOBI_COMPRESSION_NONE) {
        MOBIPdbRecord *rec = m->rec->next;
        if (rec && rec->size >= sizeof(REPLICA_MAGIC)) {
            return memcmp(rec->data, REPLICA_MAGIC, sizeof(REPLICA_MAGIC) - 1) == 0;
        }
    }
    return false;
}
