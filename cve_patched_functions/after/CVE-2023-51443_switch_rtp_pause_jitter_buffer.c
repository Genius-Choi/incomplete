SWITCH_DECLARE(switch_status_t) switch_rtp_pause_jitter_buffer(switch_rtp_t *rtp_session, switch_bool_t pause)
{
	int new_val;

	if (rtp_session->pause_jb && !pause) {
		if (rtp_session->jb) {
			switch_jb_reset(rtp_session->jb);
		}

		if (rtp_session->vb) {
			switch_jb_reset(rtp_session->vb);
		}
	}

	new_val = pause ? 1 : -1;

	if (rtp_session->pause_jb + new_val > -1) {
		rtp_session->pause_jb += new_val;
	}

	switch_log_printf(SWITCH_CHANNEL_SESSION_LOG(rtp_session->session), SWITCH_LOG_DEBUG1,
					  "Jitterbuffer %s is %s\n", rtp_type(rtp_session), rtp_session->pause_jb ? "paused" : "enabled");
	
	return SWITCH_STATUS_SUCCESS;
}
