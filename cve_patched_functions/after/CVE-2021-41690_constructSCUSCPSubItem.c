constructSCUSCPSubItem(char *name, unsigned char type, unsigned char scuRole,
                       unsigned char scpRole, PRV_SCUSCPROLE * scuscpItem,
                       unsigned long *length)
{
    if (strlen(name) < 1 || strlen(name) > 64)
    {
        char buf[1024];
        OFStandard::snprintf(buf, 1024, "Illegal service parameter: %s", name);
        return makeDcmnetCondition(DULC_ILLEGALSERVICEPARAMETER, OF_error, buf);
    }

    scuscpItem->type = type;
    scuscpItem->rsv1 = 0;
    scuscpItem->SCURole = scuRole;
    scuscpItem->SCPRole = scpRole;
    scuscpItem->length = (unsigned short) (strlen(name) + 2 + 2);
    OFStandard::strlcpy(scuscpItem->SOPClassUID, name, sizeof(scuscpItem->SOPClassUID));

    *length = scuscpItem->length + 4;
    return EC_Normal;
}
