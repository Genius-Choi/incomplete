mmsServer_handleFileCloseRequest(
    MmsServerConnection connection,
    uint8_t* buffer, int bufPos, int maxBufPos,
    uint32_t invokeId,
    ByteBuffer* response)
{
    int32_t frsmId = BerDecoder_decodeInt32(buffer, maxBufPos - bufPos, bufPos);

    MmsFileReadStateMachine* frsm = getFrsm(connection, frsmId);

    if (frsm) {
        FileSystem_closeFile(frsm->fileHandle);
        frsm->fileHandle = NULL;
        frsm->frsmId = 0;

        mmsMsg_createFileCloseResponse(invokeId, response);
    }
    else {
        if (DEBUG_MMS_SERVER)
            printf("MMS_SERVER: Unused file ID %i\n", frsmId);

        mmsMsg_createServiceErrorPdu(invokeId, response, MMS_ERROR_FILE_OTHER);
    }
}
