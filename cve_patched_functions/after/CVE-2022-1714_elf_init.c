static bool elf_init(ELFOBJ *bin) {
	/* bin is not an ELF */
	if (!init_ehdr (bin)) {
		return false;
	}
	if (!init_phdr (bin) && !is_bin_etrel (bin)) {
		R_LOG_DEBUG ("Cannot initialize program headers");
	}
	if (bin->ehdr.e_type != ET_CORE) {
		if (!init_shdr (bin)) {
			R_LOG_DEBUG ("Cannot initialize section headers");
		}
		if (!init_strtab (bin)) {
			R_LOG_DEBUG ("Cannot initialize strings table");
		}
		if (!init_dynstr (bin) && !is_bin_etrel (bin)) {
			R_LOG_DEBUG ("Cannot initialize dynamic strings");
		}
		bin->baddr = Elf_(r_bin_elf_get_baddr) (bin);
		if (!init_dynamic_section (bin) && !Elf_(r_bin_elf_is_static) (bin) && !is_bin_etrel (bin)) {
			R_LOG_DEBUG ("Cannot initialize dynamic section");
		}
	}
	bin->imports_by_ord_size = 0;
	bin->imports_by_ord = NULL;
	bin->symbols_by_ord_size = 0;
	bin->symbols_by_ord = NULL;
	bin->g_sections = Elf_(r_bin_elf_get_sections) (bin);
	bin->boffset = Elf_(r_bin_elf_get_boffset) (bin);
	bin->g_relocs = Elf_(r_bin_elf_get_relocs) (bin);
	bin->rel_cache = rel_cache_new (bin->g_relocs, bin->g_reloc_num);
	sdb_ns_set (bin->kv, "versioninfo", store_versioninfo (bin));
	return true;
}
