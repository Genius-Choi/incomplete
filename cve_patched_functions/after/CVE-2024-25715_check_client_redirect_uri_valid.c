static int check_client_redirect_uri_valid(struct _oidc_config * config,
                                           const char * client_id,
                                           const char * redirect_uri,
                                           const char * ip_source) {
  json_t * j_client = config->glewlwyd_config->glewlwyd_plugin_callback_get_client(config->glewlwyd_config, client_id);
  int uri_found = 0, ret;

  if (check_result_value(j_client, G_OK) && json_object_get(json_object_get(j_client, "client"), "enabled") == json_true()) {
    if (!o_strnullempty(redirect_uri)) {
      if (json_array_has_string(json_object_get(json_object_get(j_client, "client"), "redirect_uri"), redirect_uri)) {
        uri_found = 1;
      } else {
        uri_found = 0;
      }
    }
    if (!uri_found) {
      y_log_message(Y_LOG_LEVEL_DEBUG, "check_client_redirect_uri_valid - oidc - Error, redirect_uri '%s' is invalid for the client '%s', origin: %s", redirect_uri, client_id, ip_source);
      ret = G_ERROR_UNAUTHORIZED;
    } else {
      ret = G_OK;
    }
  } else {
    ret = G_ERROR_UNAUTHORIZED;
  }
  json_decref(j_client);
  return ret;
}
