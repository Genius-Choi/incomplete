ietf_full_conn_ci_retx_timeout (struct lsquic_conn *lconn)
{
    struct ietf_full_conn *conn = (struct ietf_full_conn *) lconn;
    unsigned short pack_size;
    struct conn_path *cpath;
    int resize;

    resize = 0;
    for (cpath = conn->ifc_paths; cpath < conn->ifc_paths + N_PATHS; ++cpath)
        if (cpath->cop_flags & COP_INITIALIZED)
        {
            pack_size = calc_base_packet_size(conn,
                                                NP_IS_IPv6(&cpath->cop_path));
            if (cpath->cop_path.np_pack_size > pack_size)
            {
                LSQ_DEBUG("RTO occurred: change packet size of path %hhu "
                    "to %hu bytes", cpath->cop_path.np_path_id, pack_size);
                cpath->cop_path.np_pack_size = pack_size;
                resize |= 1;
            }
        }

    if (resize)
        lsquic_send_ctl_resize(&conn->ifc_send_ctl);
    else
        LSQ_DEBUG("RTO occurred, but no MTUs to reset");

    if (lsquic_send_ctl_ecn_turned_on(&conn->ifc_send_ctl))
    {
        LSQ_INFO("RTO occurred, disable ECN");
        lsquic_send_ctl_disable_ecn(&conn->ifc_send_ctl);
        if (lsquic_rechist_first(&conn->ifc_rechist[PNS_APP]))
        {
            LSQ_DEBUG("Send wrong ECN counts to peer so that it turns off "
                                                                "ECN as well");
            memset(conn->ifc_ecn_counts_in[PNS_APP], 0,
                                    sizeof(conn->ifc_ecn_counts_in[PNS_APP]));
            conn->ifc_mflags |= MF_SEND_WRONG_COUNTS;
            force_queueing_ack_app(conn);
            conn->ifc_send_flags |= SF_SEND_PING;
        }
    }
}
