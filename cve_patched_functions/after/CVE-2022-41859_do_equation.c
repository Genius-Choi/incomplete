static void do_equation(EC_GROUP *group, BIGNUM *y2, BIGNUM *x, BN_CTX *bnctx)
{
	BIGNUM *p, *a, *b, *tmp1, *pm1;

	tmp1 = BN_new();
	pm1 = BN_new();
	p = BN_new();
	a = BN_new();
	b = BN_new();
	EC_GROUP_get_curve(group, p, a, b, bnctx);

	BN_sub(pm1, p, BN_value_one());

	/*
	 * y2 = x^3 + ax + b
	 */
	BN_mod_sqr(tmp1, x, p, bnctx);
	BN_mod_mul(y2, tmp1, x, p, bnctx);
	BN_mod_mul(tmp1, a, x, p, bnctx);
	BN_mod_add_quick(y2, y2, tmp1, p);
	BN_mod_add_quick(y2, y2, b, p);

	BN_free(tmp1);
	BN_free(pm1);
	BN_free(p);
	BN_free(a);
	BN_free(b);

	return;
}
