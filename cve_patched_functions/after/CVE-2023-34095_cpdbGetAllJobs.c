int cpdbGetAllJobs(cpdb_frontend_obj_t *f,
                   cpdb_job_t **j,
                   gboolean active_only)
{
    
	/**inititalizing the arrays required for each of the backends **/
	
    /** num_jobs[] stores the number of jobs for each of the backends**/
    int *num_jobs = g_new(int, f->num_backends);
    
    /**backend_names[] stores the name for each of the backends**/
    char **backend_names = g_new0(char *, f->num_backends);
    
    /**retval[] stores the gvariant returned by the respective backend **/
    GVariant **retval = g_new(GVariant *, f->num_backends);
    
    GError *error = NULL;
    gpointer key, value;
    GHashTableIter iter;
    int i = 0, total_jobs = 0;
 
    /** Iterating over all the backends and getting each's active jobs**/
    g_hash_table_iter_init(&iter, f->backend);
    while (g_hash_table_iter_next(&iter, &key, &value))
    {
        PrintBackend *proxy = (PrintBackend *)value;
        
        backend_names[i] = (char *)key;
        print_backend_call_get_all_jobs_sync(proxy,
                                             active_only,
                                             &(num_jobs[i]),
                                             &(retval[i]),
                                             NULL,
                                             &error);
        
        if(error)
        {
            logerror("Error gettings jobs for backend %s : %s\n",
                        backend_names[i], error->message);
        	num_jobs[i] = 0;
        	
        }
        else
        {
        	logdebug("Obtained %d jobs for backend %s\n",
                        num_jobs[i], backend_names[i]);
        }
        
        total_jobs += num_jobs[i];
        i++; /** off to the next backend **/
    }
    
    int n = 0;
    cpdb_job_t *jobs = g_new(cpdb_job_t, total_jobs);
    for (i = 0; i < f->num_backends; i++)
    {
    	if(num_jobs[i])
        {
    		cpdbUnpackJobArray(retval[i],
                               num_jobs[i],
                               jobs + n,
                               backend_names[i]);
        }
        n += num_jobs[i];
    }
    *j = jobs;

    free(num_jobs);
    return total_jobs;
}
