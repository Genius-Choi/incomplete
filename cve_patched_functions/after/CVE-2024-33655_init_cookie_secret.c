init_cookie_secret(uint8_t* cookie_secret, size_t cookie_secret_len)
{
	struct ub_randstate *rand = ub_initstate(NULL);

	if (!rand)
		fatal_exit("could not init random generator");
	while (cookie_secret_len) {
		*cookie_secret++ = (uint8_t)ub_random(rand);
		cookie_secret_len--;
	}
	ub_randfree(rand);
}
