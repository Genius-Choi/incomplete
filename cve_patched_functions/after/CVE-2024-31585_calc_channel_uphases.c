static int calc_channel_uphases(AVFilterContext *ctx, void *arg, int jobnr, int nb_jobs)
{
    ShowSpectrumContext *s = ctx->priv;
    const int h = s->orientation == VERTICAL ? s->h : s->w;
    const int ch = jobnr;
    float *phases = s->phases[ch];
    float min, max, scale;
    int y;

    for (y = 0; y < h; y++)
        phases[y] = PHASE(y, ch);
    unwrap(phases, h, M_PI, &min, &max);
    scale = 1.f / (max - min + FLT_MIN);
    for (y = 0; y < h; y++)
        phases[y] = fabsf((phases[y] - min) * scale);

    return 0;
}
