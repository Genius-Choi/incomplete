void pico_tcp_cleanup_queues(struct pico_socket *sck)
{
    struct pico_socket_tcp *tcp = (struct pico_socket_tcp *)sck;
    pico_timer_cancel(tcp->sock.stack, tcp->retrans_tmr);
    pico_timer_cancel(tcp->sock.stack, tcp->keepalive_tmr);
    pico_timer_cancel(tcp->sock.stack, tcp->fin_tmr);

    tcp->retrans_tmr = 0;
    tcp->keepalive_tmr = 0;
    tcp->fin_tmr = 0;

    tcp_discard_all_segments(&tcp->tcpq_in);
    tcp_discard_all_segments(&tcp->tcpq_out);
    tcp_discard_all_segments(&tcp->tcpq_hold);
}
