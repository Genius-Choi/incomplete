void tport_unref(tport_t *tp)
{
  if (tp == NULL || tp->tp_refs <= 0)
    return;

  tp->tp_refs--;
  if (tp->tp_refs <= 1) {
    SU_DEBUG_5(("%s(%p): " TPN_FORMAT " refcount from is now %ld\n", 
    __func__, (void *)tp, TPN_ARGS(tp->tp_name), tp->tp_refs));
  }
  else SU_DEBUG_9(("%s(%p): refcount is now %ld\n", __func__, (void *)tp, tp->tp_refs));

  if (tp->tp_refs > 0)
    return;

  if (!tport_is_secondary(tp))
    return;

  if (tp->tp_params->tpp_idle == 0) {
    SU_DEBUG_4(("%s(%p): " TPN_FORMAT " refcount is 0 and its idle, so we can close it\n", 
      __func__, (void *)tp, TPN_ARGS(tp->tp_name)));
    tport_close(tp);
  }

  tport_set_secondary_timer(tp);
}
