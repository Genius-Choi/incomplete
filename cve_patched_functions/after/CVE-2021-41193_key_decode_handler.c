static bool key_decode_handler(const char *keystr,
			       struct json_object *jobj,
			       void *arg)
{
	struct econn_key_info *key;
	struct list *keyl = arg;
	int32_t i;
	const char *dstr;
	uint8_t *d;
	size_t sz;
	int err;

	key = mem_zalloc(sizeof(*key), key_destructor);
	if (!key) {
		warning("econn: key_decode_handler: could not alloc part\n");
		return false;
	}

	err = jzon_int(&i, jobj, "idx");
	if (err)
		return false;

	key->idx = i;

	dstr = jzon_str(jobj, "data");
	if (!dstr)
		return false;

	sz = str_len(dstr);

	d = mem_zalloc(sz, NULL);
	if (!d)
		return false;

	err = base64_decode(dstr, str_len(dstr), d, &sz);
	if (err) {
		warning("econn: failed to base64 decode key\n");
		mem_deref(d);
		return err;
	}

	key->data = d;
	key->dlen = sz;

	list_append(keyl, &key->le, key);

	return false;
}
