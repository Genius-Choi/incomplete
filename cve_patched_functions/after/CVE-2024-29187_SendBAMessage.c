static HRESULT SendBAMessage(
    __in BURN_USER_EXPERIENCE* pUserExperience,
    __in BOOTSTRAPPER_APPLICATION_MESSAGE message,
    __in const LPVOID pvArgs,
    __inout LPVOID pvResults
    )
{
    HRESULT hr = S_OK;

    if (!pUserExperience->hUXModule)
    {
        ExitFunction();
    }

    hr = pUserExperience->pfnBAProc(message, pvArgs, pvResults, pUserExperience->pvBAProcContext);
    if (hr == E_NOTIMPL)
    {
        hr = S_OK;
    }

LExit:
    return hr;
}
