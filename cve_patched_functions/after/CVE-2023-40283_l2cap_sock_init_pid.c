static void l2cap_sock_init_pid(struct sock *sk)
{
	struct l2cap_chan *chan = l2cap_pi(sk)->chan;

	/* Only L2CAP_MODE_EXT_FLOWCTL ever need to access the PID in order to
	 * group the channels being requested.
	 */
	if (chan->mode != L2CAP_MODE_EXT_FLOWCTL)
		return;

	spin_lock(&sk->sk_peer_lock);
	sk->sk_peer_pid = get_pid(task_tgid(current));
	spin_unlock(&sk->sk_peer_lock);
}
