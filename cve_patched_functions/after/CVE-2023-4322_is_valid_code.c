static bool is_valid_code(RCore *core, ut64 addr, int n) {
	int i;
	for (i = 0; i < n; i++) {
		RAnalOp *op = r_core_anal_op (core, addr, R_ARCH_OP_MASK_BASIC);
		if (op) {
			switch (op->type & R_ANAL_OP_TYPE_MASK) {
			case R_ANAL_OP_TYPE_NULL:
			case R_ANAL_OP_TYPE_TRAP:
			case R_ANAL_OP_TYPE_ILL:
			case R_ANAL_OP_TYPE_UNK:
				r_anal_op_free (op);
				return false;
			}
			if (op->size < 1) {
				r_anal_op_free (op);
				return false;
			}
			addr += op->size;
			r_anal_op_free (op);
		} else {
			return false;
		}
	}
	return true;
}
