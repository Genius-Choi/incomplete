static int pico_ipv4_frame_sock_push_ex(struct pico_stack *S, struct pico_protocol *self, struct pico_frame *f, uint8_t ip_proto_n)
{
    struct pico_ip4 *dst;
    struct pico_remote_endpoint *remote_endpoint = (struct pico_remote_endpoint *) f->info;
    IGNORE_PARAMETER(self);

    if (!f->sock) {
        pico_frame_discard(f);
        return -1;
    }

    if (remote_endpoint) {
        dst = &remote_endpoint->remote_addr.ip4;
    } else {
        dst = &f->sock->remote_addr.ip4;
    }

    return pico_ipv4_frame_push(S, f, dst, ip_proto_n);
}
