void trustedDecryptKey(int *errStatus, char *errString, uint8_t *encryptedPrivateKey,
                 uint32_t enc_len, char *key) {

    LOG_DEBUG (__FUNCTION__);

    uint32_t decLen;

    *errStatus = -9;

    sgx_status_t status = sgx_unseal_data(
            (const sgx_sealed_data_t *) encryptedPrivateKey, NULL, 0, (uint8_t *) key, &decLen);

    if (status != SGX_SUCCESS) {
        *errStatus = status;
        snprintf(errString, BUF_LEN, "sgx_unseal_data failed with status %d", status);
        return;
    }

    //snprintf(errString, BUF_LEN, "decr key is %s", key);

    if (decLen > MAX_KEY_LENGTH) {
        snprintf(errString, BUF_LEN, "wrong decLen");//"decLen != MAX_KEY_LENGTH");
        return;
    }

    *errStatus = -10;


    uint64_t keyLen = strnlen(key, MAX_KEY_LENGTH);


    if (keyLen == MAX_KEY_LENGTH) {
        snprintf(errString, BUF_LEN, "Key is not null terminated");
        return;
    }

    *errStatus = 0;
    return;

}
