void WifiPacket::handle_llc(const mac_hdr_t &mac,const u_char *ptr, size_t len,u_int16_t fc)
{
    if (len < 7) {
	// truncated header!
	cbs->HandleLLC(*this,NULL, ptr, len);
	return;
    }

    // http://www.wildpackets.com/resources/compendium/wireless_lan/wlan_packets

    llc_hdr_t hdr;
    hdr.dsap   = EXTRACT_LE_8BITS(ptr); // Destination Service Access point
    hdr.ssap   = EXTRACT_LE_8BITS(ptr + 1); // Source Service Access Point
    hdr.control= EXTRACT_LE_8BITS(ptr + 2); // ignored by most protocols
    hdr.oui    = EXTRACT_24BITS(ptr + 3);
    hdr.type   = EXTRACT_16BITS(ptr + 6);


    /* "When both the DSAP and SSAP are set to 0xAA, the type is
     * interpreted as a protocol not defined by IEEE and the LSAP is
     * referred to as SubNetwork Access Protocol (SNAP).  In SNAP, the
     * 5 bytes that follow the DSAP, SSAP, and control byte are called
     * the Protocol Discriminator."
     */

    if(hdr.dsap==0xAA && hdr.ssap==0xAA){
        cbs->HandleLLC(*this,&hdr,ptr+8,len-8);
        return;
    }

    if (hdr.oui == OUI_ENCAP_ETHER || hdr.oui == OUI_CISCO_90) {
        cbs->HandleLLC(*this,&hdr, ptr+8, len-8);
        return;
    }
        
    cbs->HandleLLCUnknown(*this,ptr, len);
}
