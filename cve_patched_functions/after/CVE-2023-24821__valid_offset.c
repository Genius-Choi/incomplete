static bool _valid_offset(gnrc_pktsnip_t *pkt, size_t offset)
{
    return (
        IS_USED(MODULE_GNRC_SIXLOWPAN_FRAG) &&
        ((sixlowpan_frag_1_is(pkt->data) && (offset == 0)) ||
         (sixlowpan_frag_n_is(pkt->data) &&
          (offset == sixlowpan_frag_offset(pkt->data))))
    ) || (
        IS_USED(MODULE_GNRC_SIXLOWPAN_FRAG_SFR) &&
        /* offset == 0 is an abort condition that should not be handed to the
         * reassembly buffer */
        sixlowpan_sfr_rfrag_is(pkt->data) &&
        (sixlowpan_sfr_rfrag_get_offset(pkt->data) != 0)
    );
}
