struct gssntlm_name_attribute *gssntlm_find_attr(
                                        struct gssntlm_name_attribute *attrs,
                                        const char *attr_name,
                                        size_t attr_name_len)
{
    for (size_t i = 0; attrs && (attrs[i].attr_name != NULL); i++) {
        /* We store attr_name as a zero-terminated string, so
         * it is always zero-terminated */
        if (attr_name_len == strlen(attrs[i].attr_name) &&
            strncasecmp(attrs[i].attr_name, attr_name, attr_name_len) == 0) {
            return &attrs[i];
        }
    }
    return NULL;
}
