display_showcmd(void)
{
    int	    len = (int)STRLEN(showcmd_buf);

    showcmd_is_clear = (len == 0);
    cursor_off();

    if (*p_sloc == 's')
    {
	if (showcmd_is_clear)
	    curwin->w_redr_status = TRUE;
	else
	    win_redr_status(curwin, FALSE);
    }
    else if (*p_sloc == 't')
    {
	if (showcmd_is_clear)
	    redraw_tabline = TRUE;
	else
	    draw_tabline();
    }
    else // 'showcmdloc' is "last" or empty
    {
	if (!showcmd_is_clear)
	    screen_puts(showcmd_buf, (int)Rows - 1, sc_col, 0);

	// clear the rest of an old message by outputting up to SHOWCMD_COLS
	// spaces
	screen_puts((char_u *)"          " + len,
						(int)Rows - 1, sc_col + len, 0);
    }

    setcursor();	    // put cursor back where it belongs
}
