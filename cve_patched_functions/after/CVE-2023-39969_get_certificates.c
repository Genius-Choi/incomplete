std::vector<Certificate> SignedData::get_certificates() const {
  auto *certs_stack_ptr = p7_->d.sign->cert;
  if (certs_stack_ptr == nullptr) {
    return {};
  }

  std::vector<Certificate> certs;
  for (auto i = 0; i < sk_X509_num(certs_stack_ptr); ++i) {
    /* Like above: ideally we'd use emplace_back, but C++ gets in the way.
     */
    certs.push_back(Certificate(sk_X509_value(certs_stack_ptr, i)));
  }

  return certs;
}
