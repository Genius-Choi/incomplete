static inline std::string tohex(std::uint8_t *buf, std::size_t len) {
  constexpr static char lookup_table[] = "0123456789ABCDEF";

  if (!buf || !len) {
    return {};
  }

  std::string hexstr;
  hexstr.reserve(len * 2);  // each byte creates two hex digits

  for (auto i = 0; i < len; i++) {
    hexstr += lookup_table[buf[i] >> 4];
    hexstr += lookup_table[buf[i] & 0xF];
  }

  return hexstr;
}
