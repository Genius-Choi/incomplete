static RSA* cjwt_create_rsa( unsigned char *key, int key_len, int public )
{
    RSA *rsa = NULL;
    BIO *keybio ;

    if( key == NULL ) {
        cjwt_error( "invalid rsa key\n" );
        goto rsa_end;
    }

    keybio = BIO_new_mem_buf( key, key_len );

    if( keybio == NULL ) {
        cjwt_error( "BIO creation for key failed\n" );
        goto rsa_end;
    }

    if( public ) {
        rsa = PEM_read_bio_RSA_PUBKEY( keybio, &rsa, NULL, NULL );
    } else {
        rsa = PEM_read_bio_RSAPrivateKey( keybio, &rsa, NULL, NULL );
    }

    if( rsa == NULL ) {
        cjwt_rsa_error();
    }
    BIO_free (keybio);

rsa_end:
    return rsa;
}
