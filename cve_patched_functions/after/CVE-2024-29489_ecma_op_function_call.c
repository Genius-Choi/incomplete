ecma_op_function_call (ecma_object_t *func_obj_p, /**< Function object */
                       ecma_value_t this_arg_value, /**< 'this' argument's value */
                       const ecma_value_t *arguments_list_p, /**< arguments list */
                       uint32_t arguments_list_len) /**< length of arguments list */
{
  JERRY_ASSERT (func_obj_p != NULL && !ecma_is_lexical_environment (func_obj_p));

  ECMA_CHECK_STACK_USAGE ();

  ecma_object_t *old_new_target_p = JERRY_CONTEXT (current_new_target_p);

  if (JERRY_UNLIKELY (!(JERRY_CONTEXT (status_flags) & ECMA_STATUS_DIRECT_EVAL)))
  {
    JERRY_CONTEXT (current_new_target_p) = NULL;
  }

  ecma_value_t result;

  switch (ecma_get_object_type (func_obj_p))
  {
    case ECMA_OBJECT_TYPE_FUNCTION:
    {
      result = ecma_op_function_call_simple (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
      break;
    }
    case ECMA_OBJECT_TYPE_BUILT_IN_FUNCTION:
    {
      result = ecma_op_function_call_native_built_in (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
      break;
    }
#if JERRY_BUILTIN_PROXY
    case ECMA_OBJECT_TYPE_PROXY:
    {
      result = ecma_proxy_object_call (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
      break;
    }
#endif /* JERRY_BUILTIN_PROXY */
    case ECMA_OBJECT_TYPE_CONSTRUCTOR_FUNCTION:
    {
      result = ecma_raise_type_error (ECMA_ERR_CLASS_CONSTRUCTOR_NEW);
      break;
    }
    case ECMA_OBJECT_TYPE_NATIVE_FUNCTION:
    {
      result = ecma_op_function_call_native (func_obj_p, this_arg_value, arguments_list_p, arguments_list_len);
      break;
    }
    case ECMA_OBJECT_TYPE_BOUND_FUNCTION:
    {
      result = ecma_op_function_call_bound (func_obj_p, arguments_list_p, arguments_list_len);
      break;
    }
    default:
    {
      result = ecma_raise_type_error (ECMA_ERR_EXPECTED_A_FUNCTION);
      break;
    }
  }

  JERRY_CONTEXT (current_new_target_p) = old_new_target_p;

  return result;
} /* ecma_op_function_call */
