static void stunaddr_resolve_callback(const struct ast_dns_query *query)
{
	const int lowest_ttl = ast_dns_result_get_lowest_ttl(ast_dns_query_get_result(query));
	const char *stunaddr_name = ast_dns_query_get_name(query);
	const char *stunaddr_resolved_str;

	if (!store_stunaddr_resolved(query)) {
		ast_log(LOG_WARNING, "Failed to resolve stunaddr '%s'. Cancelling recurring resolution.\n", stunaddr_name);
		return;
	}

	if (DEBUG_ATLEAST(2)) {
		ast_rwlock_rdlock(&stunaddr_lock);
		stunaddr_resolved_str = ast_inet_ntoa(stunaddr.sin_addr);
		ast_rwlock_unlock(&stunaddr_lock);

		ast_debug_stun(2, "Resolved stunaddr '%s' to '%s'. Lowest TTL = %d.\n",
			stunaddr_name,
			stunaddr_resolved_str,
			lowest_ttl);
	}

	if (!lowest_ttl) {
		ast_log(LOG_WARNING, "Resolution for stunaddr '%s' returned TTL = 0. Recurring resolution was cancelled.\n", ast_dns_query_get_name(query));
	}
}
