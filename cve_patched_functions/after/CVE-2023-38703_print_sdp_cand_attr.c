static int print_sdp_cand_attr(char *buffer, int max_len,
                               const pj_ice_sess_cand *cand)
{
    char ipaddr[PJ_INET6_ADDRSTRLEN+2];
    int len, len2;

    len = pj_ansi_snprintf( buffer, max_len,
                            "%.*s %u UDP %u %s %u typ ",
                            (int)cand->foundation.slen,
                            cand->foundation.ptr,
                            (unsigned)cand->comp_id,
                            cand->prio,
                            pj_sockaddr_print(&cand->addr, ipaddr, 
                                              sizeof(ipaddr), 0),
                            (unsigned)pj_sockaddr_get_port(&cand->addr));
    if (len < 1 || len >= max_len)
        return -1;

    switch (cand->type) {
    case PJ_ICE_CAND_TYPE_HOST:
        len2 = pj_ansi_snprintf(buffer+len, max_len-len, "host");
        break;
    case PJ_ICE_CAND_TYPE_SRFLX:
    case PJ_ICE_CAND_TYPE_RELAYED:
    case PJ_ICE_CAND_TYPE_PRFLX:
        len2 = pj_ansi_snprintf(buffer+len, max_len-len,
                                "%s raddr %s rport %d",
                                pj_ice_get_cand_type_name(cand->type),
                                pj_sockaddr_print(&cand->rel_addr, ipaddr,
                                                  sizeof(ipaddr), 0),
                                (int)pj_sockaddr_get_port(&cand->rel_addr));
        break;
    default:
        pj_assert(!"Invalid candidate type");
        len2 = -1;
        break;
    }
    if (len2 < 1 || len2 >= max_len-len)
        return -1;

    return len+len2;
}
