const KernelDef* GetKernelDef(const EagerOperation& op, const NodeDef* node_def,
                              const Device* op_device) {
  if (node_def == nullptr || op_device == nullptr) return nullptr;
  const KernelDef* kernel_def = nullptr;
  Status s = FindKernelDef(DeviceType(op_device->device_type()), *node_def,
                           &kernel_def,
                           /*kernel_class_name=*/nullptr);
  if (!s.ok()) return nullptr;
  return kernel_def;
}
