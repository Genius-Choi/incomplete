static void incoming_response(struct ast_sip_session *session, pjsip_rx_data * rdata)
{
	pj_pool_t *pool = session->inv_session->dlg->pool;
	RAII_VAR(struct ast_datastore *, datastore,
			 ast_sip_session_get_datastore(session, response_header_datastore.type), ao2_cleanup);
	pjsip_status_line status = rdata->msg_info.msg->line.status;

	/* Skip responses different of 200 OK, when 2xx is received. */
	if (session->inv_session->state != PJSIP_INV_STATE_CONNECTING || status.code!=200) {
		return;
	}

	if (!datastore) {
		if (!(datastore =
			  ast_sip_session_alloc_datastore(&response_header_datastore, response_header_datastore.type))
			||
			!(datastore->data = pj_pool_alloc(pool, sizeof(struct hdr_list))) ||
			ast_sip_session_add_datastore(session, datastore)) {
			ast_log(AST_LOG_ERROR, "Unable to create datastore for header functions.\n");
			return;
		}
		AST_LIST_HEAD_INIT_NOLOCK((struct hdr_list *) datastore->data);
	}
	insert_headers(pool, (struct hdr_list *) datastore->data, rdata->msg_info.msg);

	return;
}
