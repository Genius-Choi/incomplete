    bool parseSipUri(const string& uri, string& scheme, string& userpart, string& hostpart, string& port, 
    vector< pair<string,string> >& params) {

        try {
            std::regex re("^<?(sip|sips):(?:([^;]+)@)?([^;|^>|^:]+)(?::(\\d+))?(?:;([^>]+))?>?$");
            std::regex re2("^<?(sip|sips):(?:([^;]+)@)?(\\[[0-9a-fA-F:]+\\])(?::(\\d+))?(?:;([^>]+))?>?$");
            std::smatch mr;
            if (std::regex_search(uri, mr, re) || std::regex_search(uri, mr, re2)) {
                scheme = mr[1] ;
                userpart = mr[2] ;
                hostpart = mr[3] ;
                port = mr[4] ; 

                string paramString = mr[5] ;
                if (paramString.length() > 0) {
                  vector<string> strs;
                  boost::split(strs, paramString, boost::is_any_of(";"));
                  for (vector<string>::iterator it = strs.begin(); it != strs.end(); ++it) {
                    vector<string> kv ;
                    boost::split(kv, *it, boost::is_any_of("="));
                    std::pair<string, string> kvpair(kv[0], kv.size() == 2 ? kv[1] : "");
                    params.push_back(kvpair);
                  }
                }
                return true ;
            }
        } catch (std::regex_error& e) {
            DR_LOG(log_error) << "parseSipUri - regex error: " << e.what();
        }
        return false;
    }
