void fp_prime_conv(fp_t c, const bn_t a) {
	bn_t t;

	bn_null(t);

	RLC_TRY {
		bn_new(t);

		/* Reduce a modulo the prime to ensure bounds. */
		bn_mod(t, a, &(core_get()->prime));

		if (bn_is_zero(t)) {
			fp_zero(c);
		} else {
			/* Copy used digits, fill the rest with zero. */
			dv_copy(c, t->dp, t->used);
			dv_zero(c + t->used, RLC_FP_DIGS - t->used);
#if FP_RDC == MONTY
			fp_mul(c, c, core_get()->conv.dp);
#endif
		}
	}
	RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	}
	RLC_FINALLY {
		bn_free(t);
	}
}
