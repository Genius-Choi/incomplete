static void tunnel_on_write_complete(h2o_tunnel_t *tunnel, const char *err)
{
    struct st_h2o_http3_server_stream_t *stream = tunnel->data;

    assert(stream->tunnel->up.is_inflight);
    stream->tunnel->up.is_inflight = 0;

    if (err != NULL) {
        retain_sendvecs(stream);
        stream->tunnel->tunnel->destroy(stream->tunnel->tunnel);
        stream->tunnel->tunnel = NULL;
        shutdown_by_generator(stream);
        return;
    }

    tunnel_write(stream);
}
