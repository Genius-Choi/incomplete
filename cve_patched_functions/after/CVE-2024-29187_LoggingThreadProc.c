static DWORD WINAPI LoggingThreadProc(
    __in LPVOID lpThreadParameter
    )
{
    HRESULT hr = S_OK;
    BURN_ENGINE_STATE* pEngineState = reinterpret_cast<BURN_ENGINE_STATE*>(lpThreadParameter);
    BURN_PIPE_RESULT result = { };

    hr = PipePumpMessages(pEngineState->companionConnection.hLoggingPipe, NULL, NULL, &result);
    ExitOnFailure(hr, "Failed to pump logging messages for elevated process.");

    hr = (HRESULT)result.dwResult;

LExit:

    return (DWORD)hr;
}
