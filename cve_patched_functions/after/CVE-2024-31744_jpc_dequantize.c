static void jpc_dequantize(jas_matrix_t *x, jpc_fix_t absstepsize)
{
	// a reconstruction parameter defined in E 1.1.2 of the ISO/IEC 15444-1
	jpc_fix_t recparam = JPC_FIX_HALF;

	// Note:
	// Should anything special be done to handle the error case of
	// absstepsize < 0 (which can arise due to numerical overflow).
	// Using an assert is not appropriate, since this results in program
	// termination when this type of error occurs.
	// Simply allowing a decoded image with very high distortion would appear
	// to be consistent with the policy adopted elsewhere in the codec.
	// assert(absstepsize >= 0);

	if (absstepsize == jpc_inttofix(1)) {
		return;
	}

	const jas_matind_t height = jas_matrix_numrows(x);
	const size_t width = jas_matrix_numcols(x);

	for (jas_matind_t i = 0; i < height; ++i) {
		jpc_fix_t *p = jas_matrix_getref(x, i, 0);
		for (size_t j = 0; j < width; ++j) {
			jas_seqent_t t = p[j];
			if (t) {
				// mid-point reconstruction
				t = (t > 0) ? jpc_fix_add(t, recparam) : jpc_fix_sub(t, recparam);
				t = jpc_fix_mul(t, absstepsize);
				p[j] = t;
			}
		}
	}

}
