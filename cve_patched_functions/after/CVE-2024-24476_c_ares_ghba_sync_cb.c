c_ares_ghba_sync_cb(void *arg, int status, int timeouts _U_, struct hostent *he) {
    sync_dns_data_t *sdd = (sync_dns_data_t *)arg;
    char **p;

    if (status == ARES_SUCCESS) {
        for (p = he->h_addr_list; *p != NULL; p++) {
            switch(sdd->family) {
                case AF_INET:
                    add_ipv4_name(sdd->addr.ip4, he->h_name, FALSE);
                    break;
                case AF_INET6:
                    add_ipv6_name(&sdd->addr.ip6, he->h_name, FALSE);
                    break;
                default:
                    /* Throw an exception? */
                    break;
            }
        }

    }

    /*
     * Let our caller know that this is complete.
     */
    *sdd->completed = TRUE;

    /*
     * Free the structure for this call.
     */
    g_free(sdd);
}
