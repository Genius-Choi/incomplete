CQuery* CIRCNetwork::AddQuery(const CString& sName) {
    if (sName.empty()) {
        return nullptr;
    }

    CQuery* pQuery = FindQuery(sName);
    if (!pQuery) {
        pQuery = new CQuery(sName, this);
        m_vQueries.push_back(pQuery);

        if (m_pUser->MaxQueryBuffers() > 0) {
            while (m_vQueries.size() > m_pUser->MaxQueryBuffers()) {
                delete *m_vQueries.begin();
                m_vQueries.erase(m_vQueries.begin());
            }
        }
    }

    return pQuery;
}
