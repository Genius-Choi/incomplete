static BOOL rdp_target_cert_write_element(wStream* s, UINT32 Type, UINT32 Encoding,
                                          const BYTE* data, size_t length)
{
	WINPR_ASSERT(data || (length == 0));

	if (!Stream_CheckAndLogRequiredCapacity(TAG, s, 12))
		return FALSE;

	Stream_Write_UINT32(s, Type);
	Stream_Write_UINT32(s, Encoding);
	Stream_Write_UINT32(s, length);

	if (!Stream_CheckAndLogRequiredCapacity(TAG, s, length))
		return FALSE;

	Stream_Write(s, data, length);
	return TRUE;
}
