TEST_F(ClientIPExtractionTest, ClientIPAddressOverrideLastTest) {
  const char kServerConfigWithClientIPExperimentLast[] =
      R"(
  {
    "client_ip_extraction_config": {
      "client_ip_header": "X-Forwarded-For",
      "client_ip_position": -1
    }
  }
  )";

  EXPECT_EQ("3.3.3.3",
            ExtractClientIP(kServerConfigWithClientIPExperimentLast, "4.4.4.4",
                            {{"X-Forwarded-For", "1.1.1.1, 2.2.2.2, 3.3.3.3"},
                             {"apiKey", "test-api-key"}}));
}
