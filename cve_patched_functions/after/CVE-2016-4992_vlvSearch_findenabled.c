vlvSearch_findenabled(backend *be,struct vlvSearch* plist, const Slapi_DN *base, int scope, const char *filter, const sort_spec* sort_control)
{
    struct vlvSearch *t= plist;
	struct vlvIndex *pi= NULL;
    for(; (t!=NULL) && (pi == NULL); t= t->vlv_next)
    {
		pi= vlvSearch_equal(t,base,scope,filter,sort_control);
        if(pi!=NULL)
        {
            if(!vlvIndex_enabled(pi))
            {
                /*
                 * A VLV Spec which matched the search criteria was found.
                 * But it hasn't been enabled yet.  Check to see if the
                 * index is there.  But, only check once every 60 seconds.
                 */
            	time_t curtime = current_time();
                if(curtime>pi->vlv_lastchecked+60)
                {
                    vlvIndex_checkforindex(pi, be);
                    pi->vlv_lastchecked= current_time();
                }
            }
            if(!vlvIndex_enabled(pi))
            {
                pi= NULL;
            }
        }
    }
    return pi;
}
