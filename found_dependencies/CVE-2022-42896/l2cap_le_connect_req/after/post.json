[
    {
        "line": 5,
        "fullcodeline": "struct l2cap_le_conn_req *req = (struct l2cap_le_conn_req *) data;"
    },
    {
        "line": 15,
        "fullcodeline": "scid = __le16_to_cpu(req->scid);"
    },
    {
        "line": 16,
        "fullcodeline": "mtu  = __le16_to_cpu(req->mtu);"
    },
    {
        "line": 17,
        "fullcodeline": "mps  = __le16_to_cpu(req->mps);"
    },
    {
        "line": 18,
        "fullcodeline": "psm  = req->psm;"
    },
    {
        "line": 19,
        "fullcodeline": "dcid = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "credits = 0;"
    },
    {
        "line": 25,
        "fullcodeline": "BT_DBG(\"psm 0x%2.2x scid 0x%4.4x mtu %u mps %u\", __le16_to_cpu(psm),"
    },
    {
        "line": 42,
        "fullcodeline": "pchan = l2cap_global_chan_by_psm(BT_LISTEN, psm, &conn->hcon->src,"
    },
    {
        "line": 50,
        "fullcodeline": "mutex_lock(&conn->chan_lock);"
    },
    {
        "line": 51,
        "fullcodeline": "l2cap_chan_lock(pchan);"
    },
    {
        "line": 74,
        "fullcodeline": "chan = pchan->ops->new_connection(pchan);"
    },
    {
        "line": 80,
        "fullcodeline": "bacpy(&chan->src, &conn->hcon->src);"
    },
    {
        "line": 81,
        "fullcodeline": "bacpy(&chan->dst, &conn->hcon->dst);"
    },
    {
        "line": 82,
        "fullcodeline": "chan->src_type = bdaddr_src_type(conn->hcon);"
    },
    {
        "line": 83,
        "fullcodeline": "chan->dst_type = bdaddr_dst_type(conn->hcon);"
    },
    {
        "line": 84,
        "fullcodeline": "chan->psm  = psm;"
    },
    {
        "line": 85,
        "fullcodeline": "chan->dcid = scid;"
    },
    {
        "line": 86,
        "fullcodeline": "chan->omtu = mtu;"
    },
    {
        "line": 87,
        "fullcodeline": "chan->remote_mps = mps;"
    },
    {
        "line": 89,
        "fullcodeline": "__l2cap_chan_add(conn, chan);"
    },
    {
        "line": 91,
        "fullcodeline": "l2cap_le_flowctl_init(chan, __le16_to_cpu(req->credits));"
    },
    {
        "line": 93,
        "fullcodeline": "dcid = chan->scid;"
    },
    {
        "line": 94,
        "fullcodeline": "credits = chan->rx_credits;"
    },
    {
        "line": 96,
        "fullcodeline": "__set_chan_timer(chan, chan->ops->get_sndtimeo(chan));"
    },
    {
        "line": 98,
        "fullcodeline": "chan->ident = cmd->ident;"
    },
    {
        "line": 115,
        "fullcodeline": "l2cap_chan_unlock(pchan);"
    },
    {
        "line": 116,
        "fullcodeline": "mutex_unlock(&conn->chan_lock);"
    },
    {
        "line": 117,
        "fullcodeline": "l2cap_chan_put(pchan);"
    },
    {
        "line": 131,
        "fullcodeline": "rsp.dcid    = cpu_to_le16(dcid);"
    },
    {
        "line": 132,
        "fullcodeline": "rsp.credits = cpu_to_le16(credits);"
    },
    {
        "line": 133,
        "fullcodeline": "rsp.result  = cpu_to_le16(result);"
    },
    {
        "line": 135,
        "fullcodeline": "l2cap_send_cmd(conn, cmd->ident, L2CAP_LE_CONN_RSP, sizeof(rsp), &rsp);"
    },
    {
        "line": 12,
        "fullcodeline": "if (cmd_len != sizeof(*req))"
    },
    {
        "line": 22,
        "fullcodeline": "if (mtu < 23 || mps < 23)"
    },
    {
        "line": 35,
        "fullcodeline": "if (!psm || __le16_to_cpu(psm) > L2CAP_PSM_LE_DYN_END) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (!pchan) {"
    },
    {
        "line": 53,
        "fullcodeline": "if (!smp_sufficient_security(conn->hcon, pchan->sec_level,"
    },
    {
        "line": 61,
        "fullcodeline": "if (scid < L2CAP_CID_DYN_START || scid > L2CAP_CID_LE_DYN_END) {"
    },
    {
        "line": 68,
        "fullcodeline": "if (__l2cap_get_chan_by_dcid(conn, scid)) {"
    },
    {
        "line": 75,
        "fullcodeline": "if (!chan) {"
    },
    {
        "line": 100,
        "fullcodeline": "if (test_bit(FLAG_DEFER_SETUP, &chan->flags)) {"
    },
    {
        "line": 119,
        "fullcodeline": "if (result == L2CAP_CR_PEND)"
    },
    {
        "line": 36,
        "fullcodeline": "result = L2CAP_CR_LE_BAD_PSM;"
    },
    {
        "line": 37,
        "fullcodeline": "chan = NULL;"
    },
    {
        "line": 45,
        "fullcodeline": "result = L2CAP_CR_LE_BAD_PSM;"
    },
    {
        "line": 46,
        "fullcodeline": "chan = NULL;"
    },
    {
        "line": 55,
        "fullcodeline": "result = L2CAP_CR_LE_AUTHENTICATION;"
    },
    {
        "line": 56,
        "fullcodeline": "chan = NULL;"
    },
    {
        "line": 62,
        "fullcodeline": "result = L2CAP_CR_LE_INVALID_SCID;"
    },
    {
        "line": 63,
        "fullcodeline": "chan = NULL;"
    },
    {
        "line": 69,
        "fullcodeline": "result = L2CAP_CR_LE_SCID_IN_USE;"
    },
    {
        "line": 70,
        "fullcodeline": "chan = NULL;"
    },
    {
        "line": 76,
        "fullcodeline": "result = L2CAP_CR_LE_NO_MEM;"
    },
    {
        "line": 101,
        "fullcodeline": "l2cap_state_change(chan, BT_CONNECT2);"
    },
    {
        "line": 107,
        "fullcodeline": "result = L2CAP_CR_PEND;"
    },
    {
        "line": 108,
        "fullcodeline": "chan->ops->defer(chan);"
    },
    {
        "line": 124,
        "fullcodeline": "rsp.mtu = cpu_to_le16(chan->imtu);"
    },
    {
        "line": 125,
        "fullcodeline": "rsp.mps = cpu_to_le16(chan->mps);"
    },
    {
        "line": 13,
        "fullcodeline": "return -EPROTO;"
    },
    {
        "line": 23,
        "fullcodeline": "return -EPROTO;"
    },
    {
        "line": 110,
        "fullcodeline": "l2cap_chan_ready(chan);"
    },
    {
        "line": 111,
        "fullcodeline": "result = L2CAP_CR_LE_SUCCESS;"
    },
    {
        "line": 127,
        "fullcodeline": "rsp.mtu = 0;"
    },
    {
        "line": 128,
        "fullcodeline": "rsp.mps = 0;"
    }
]