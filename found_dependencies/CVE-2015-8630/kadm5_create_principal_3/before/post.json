[
    {
        "line": 9,
        "fullcodeline": "krb5_boolean                have_polent = FALSE;"
    },
    {
        "line": 13,
        "fullcodeline": "kadm5_server_handle_t handle = server_handle;"
    },
    {
        "line": 16,
        "fullcodeline": "int                         new_n_ks_tuple = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "krb5_key_salt_tuple         *new_ks_tuple = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "CHECK_HANDLE(server_handle);"
    },
    {
        "line": 21,
        "fullcodeline": "krb5_clear_error_message(handle->context);"
    },
    {
        "line": 23,
        "fullcodeline": "check_1_6_dummy(entry, mask, n_ks_tuple, ks_tuple, &password);"
    },
    {
        "line": 46,
        "fullcodeline": "ret = kdb_get_entry(handle, entry->principal, &kdb, &adb);"
    },
    {
        "line": 58,
        "fullcodeline": "kdb = krb5_db_alloc(handle->context, NULL, sizeof(*kdb));"
    },
    {
        "line": 61,
        "fullcodeline": "memset(kdb, 0, sizeof(*kdb));"
    },
    {
        "line": 62,
        "fullcodeline": "memset(&adb, 0, sizeof(osa_princ_ent_rec));"
    },
    {
        "line": 87,
        "fullcodeline": "kdb->magic = KRB5_KDB_MAGIC_NUMBER;"
    },
    {
        "line": 88,
        "fullcodeline": "kdb->len = KRB5_KDB_V1_BASE_LENGTH; /* gag me with a chainsaw */"
    },
    {
        "line": 110,
        "fullcodeline": "kdb->pw_expiration = 0;"
    },
    {
        "line": 120,
        "fullcodeline": "kdb->last_success = 0;"
    },
    {
        "line": 121,
        "fullcodeline": "kdb->last_failed = 0;"
    },
    {
        "line": 122,
        "fullcodeline": "kdb->fail_auth_count = 0;"
    },
    {
        "line": 151,
        "fullcodeline": "ret = apply_keysalt_policy(handle, entry->policy, n_ks_tuple, ks_tuple,"
    },
    {
        "line": 158,
        "fullcodeline": "ret = kdb_get_active_mkey(handle, &act_kvno, &act_mkey);"
    },
    {
        "line": 179,
        "fullcodeline": "ret = krb5_dbe_update_mkvno(handle->context, kdb, act_kvno);"
    },
    {
        "line": 183,
        "fullcodeline": "ret = k5_kadm5_hook_create(handle->context, handle->hook_handles,"
    },
    {
        "line": 195,
        "fullcodeline": "adb.admin_history_kvno = INITIAL_HIST_KVNO;"
    },
    {
        "line": 206,
        "fullcodeline": "kdb->mask = mask | KADM5_KEY_DATA | KADM5_PRINCIPAL ;"
    },
    {
        "line": 209,
        "fullcodeline": "ret = kdb_put_entry(handle, kdb, &adb);"
    },
    {
        "line": 211,
        "fullcodeline": "(void) k5_kadm5_hook_create(handle->context, handle->hook_handles,"
    },
    {
        "line": 216,
        "fullcodeline": "free(new_ks_tuple);"
    },
    {
        "line": 217,
        "fullcodeline": "krb5_db_free_principal(handle->context, kdb);"
    },
    {
        "line": 28,
        "fullcodeline": "if(!(mask & KADM5_PRINCIPAL) || (mask & KADM5_MOD_NAME) ||"
    },
    {
        "line": 34,
        "fullcodeline": "if ((mask & KADM5_KEY_DATA) && entry->n_key_data != 0)"
    },
    {
        "line": 36,
        "fullcodeline": "if((mask & KADM5_POLICY) && (mask & KADM5_POLICY_CLR))"
    },
    {
        "line": 38,
        "fullcodeline": "if((mask & ~ALL_PRINC_MASK))"
    },
    {
        "line": 40,
        "fullcodeline": "if (entry == NULL)"
    },
    {
        "line": 59,
        "fullcodeline": "if (kdb == NULL)"
    },
    {
        "line": 68,
        "fullcodeline": "if ((mask & KADM5_POLICY)) {"
    },
    {
        "line": 84,
        "fullcodeline": "if ((ret = krb5_timeofday(handle->context, &now)))"
    },
    {
        "line": 90,
        "fullcodeline": "if ((mask & KADM5_ATTRIBUTES))"
    },
    {
        "line": 95,
        "fullcodeline": "if ((mask & KADM5_MAX_LIFE))"
    },
    {
        "line": 100,
        "fullcodeline": "if (mask & KADM5_MAX_RLIFE)"
    },
    {
        "line": 105,
        "fullcodeline": "if ((mask & KADM5_PRINC_EXPIRE_TIME))"
    },
    {
        "line": 117,
        "fullcodeline": "if ((mask & KADM5_PW_EXPIRATION))"
    },
    {
        "line": 128,
        "fullcodeline": "if ((ret = kadm5_copy_principal(handle->context,"
    },
    {
        "line": 132,
        "fullcodeline": "if ((ret = krb5_dbe_update_last_pwd_change(handle->context, kdb, now)))"
    },
    {
        "line": 135,
        "fullcodeline": "if (mask & KADM5_TL_DATA) {"
    },
    {
        "line": 162,
        "fullcodeline": "if (mask & KADM5_KEY_DATA) {"
    },
    {
        "line": 196,
        "fullcodeline": "if (mask & KADM5_POLICY) {"
    },
    {
        "line": 32,
        "fullcodeline": "(mask & KADM5_FAIL_AUTH_COUNT))"
    },
    {
        "line": 52,
        "fullcodeline": "kdb_free_entry(handle, kdb, &adb);"
    },
    {
        "line": 69,
        "fullcodeline": "ret = get_policy(handle, entry->policy, &polent, &have_polent);"
    },
    {
        "line": 74,
        "fullcodeline": "ret = passwd_check(handle, password, have_polent ? &polent : NULL,"
    },
    {
        "line": 91,
        "fullcodeline": "kdb->attributes = entry->attributes;"
    },
    {
        "line": 96,
        "fullcodeline": "kdb->max_life = entry->max_life;"
    },
    {
        "line": 101,
        "fullcodeline": "kdb->max_renewable_life = entry->max_renewable_life;"
    },
    {
        "line": 106,
        "fullcodeline": "kdb->expiration = entry->princ_expire_time;"
    },
    {
        "line": 118,
        "fullcodeline": "kdb->pw_expiration = entry->pw_expiration;"
    },
    {
        "line": 164,
        "fullcodeline": "assert(entry->n_key_data == 0);"
    },
    {
        "line": 197,
        "fullcodeline": "adb.aux_attributes = KADM5_POLICY;"
    },
    {
        "line": 202,
        "fullcodeline": "adb.policy = entry->policy;"
    },
    {
        "line": 219,
        "fullcodeline": "(void) kadm5_free_policy_ent(handle->lhandle, &polent);"
    },
    {
        "line": 31,
        "fullcodeline": "(mask & KADM5_LAST_SUCCESS) || (mask & KADM5_LAST_FAILED) ||"
    },
    {
        "line": 138,
        "fullcodeline": "tl_data_tail = tl_data_tail->tl_data_next)"
    },
    {
        "line": 113,
        "fullcodeline": "kdb->pw_expiration = now + polent.pw_max_life;"
    },
    {
        "line": 137,
        "fullcodeline": "for (tl_data_tail = entry->tl_data; tl_data_tail;"
    },
    {
        "line": 140,
        "fullcodeline": "ret = krb5_dbe_update_tl_data(handle->context, kdb, tl_data_tail);"
    },
    {
        "line": 30,
        "fullcodeline": "(mask & KADM5_MKVNO) || (mask & KADM5_AUX_ATTRIBUTES) ||"
    },
    {
        "line": 115,
        "fullcodeline": "kdb->pw_expiration = 0;"
    },
    {
        "line": 166,
        "fullcodeline": "ret = krb5_dbe_cpw(handle->context, act_mkey, new_ks_tuple,"
    },
    {
        "line": 172,
        "fullcodeline": "ret = krb5_dbe_crk(handle->context, &master_keyblock,"
    },
    {
        "line": 29,
        "fullcodeline": "(mask & KADM5_MOD_TIME) || (mask & KADM5_LAST_PWD_CHANGE) ||"
    },
    {
        "line": 168,
        "fullcodeline": "(mask & KADM5_KVNO)?entry->kvno:1,"
    }
]