[
    {
        "line": 15,
        "fullcodeline": "success = 0;"
    },
    {
        "line": 16,
        "fullcodeline": "handle = (kadm5_server_handle_t)global_server_handle;"
    },
    {
        "line": 21,
        "fullcodeline": "ctx = rqstp->rq_svccred;"
    },
    {
        "line": 23,
        "fullcodeline": "maj_stat = gss_inquire_context(&min_stat, ctx, NULL, &name,"
    },
    {
        "line": 32,
        "fullcodeline": "kctx = handle->context;"
    },
    {
        "line": 33,
        "fullcodeline": "ret = gss_to_krb5_name_1(rqstp, kctx, name, &princ, &gss_str);"
    },
    {
        "line": 37,
        "fullcodeline": "slen = gss_str.length;"
    },
    {
        "line": 38,
        "fullcodeline": "trunc_name(&slen, &sdots);"
    },
    {
        "line": 47,
        "fullcodeline": "c1 = krb5_princ_component(kctx, princ, 0);"
    },
    {
        "line": 48,
        "fullcodeline": "c2 = krb5_princ_component(kctx, princ, 1);"
    },
    {
        "line": 49,
        "fullcodeline": "realm = krb5_princ_realm(kctx, princ);"
    },
    {
        "line": 64,
        "fullcodeline": "gss_release_buffer(&min_stat, &gss_str);"
    },
    {
        "line": 65,
        "fullcodeline": "krb5_free_principal(kctx, princ);"
    },
    {
        "line": 67,
        "fullcodeline": "gss_release_name(&min_stat, &name);"
    },
    {
        "line": 18,
        "fullcodeline": "if (rqstp->rq_cred.oa_flavor != RPCSEC_GSS)"
    },
    {
        "line": 25,
        "fullcodeline": "if (maj_stat != GSS_S_COMPLETE) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (ret == 0)"
    },
    {
        "line": 44,
        "fullcodeline": "if (krb5_princ_size(kctx, princ) != 2)"
    },
    {
        "line": 50,
        "fullcodeline": "if (strncmp(handle->params.realm, realm->data, realm->length) == 0"
    },
    {
        "line": 60,
        "fullcodeline": "if (!success) {"
    },
    {
        "line": 26,
        "fullcodeline": "krb5_klog_syslog(LOG_ERR, _(\"check_rpcsec_auth: failed \""
    },
    {
        "line": 28,
        "fullcodeline": "log_badauth(maj_stat, min_stat, rqstp->rq_xprt, NULL);"
    },
    {
        "line": 51,
        "fullcodeline": "&& strncmp(\"kadmin\", c1->data, c1->length) == 0) {"
    },
    {
        "line": 61,
        "fullcodeline": "krb5_klog_syslog(LOG_ERR, _(\"bad service principal %.*s%s\"),"
    },
    {
        "line": 53,
        "fullcodeline": "if (strncmp(\"history\", c2->data, c2->length) == 0)"
    },
    {
        "line": 62,
        "fullcodeline": "(int) slen, (char *) gss_str.value, sdots);"
    },
    {
        "line": 56,
        "fullcodeline": "success = 1;"
    }
]