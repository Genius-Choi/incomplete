[
    {
        "line": 7,
        "fullcodeline": "env = malloc(sizeof(*env));"
    },
    {
        "line": 10,
        "fullcodeline": "RB_INIT(&env->root);"
    },
    {
        "line": 11,
        "fullcodeline": "env->count = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "addnode(env, \"DOAS_USER\", mypw->pw_name);"
    },
    {
        "line": 8,
        "fullcodeline": "if (!env)"
    },
    {
        "line": 15,
        "fullcodeline": "if (rule->options & KEEPENV) {"
    },
    {
        "line": 9,
        "fullcodeline": "err(1, NULL);"
    },
    {
        "line": 18,
        "fullcodeline": "for (i = 0; environ[i] != NULL; i++) {"
    },
    {
        "line": 44,
        "fullcodeline": "static const char *copyset[] = {"
    },
    {
        "line": 49,
        "fullcodeline": "addnode(env, \"HOME\", targpw->pw_dir);"
    },
    {
        "line": 50,
        "fullcodeline": "addnode(env, \"LOGNAME\", targpw->pw_name);"
    },
    {
        "line": 51,
        "fullcodeline": "addnode(env, \"PATH\", getenv(\"PATH\"));"
    },
    {
        "line": 52,
        "fullcodeline": "addnode(env, \"SHELL\", targpw->pw_shell);"
    },
    {
        "line": 53,
        "fullcodeline": "addnode(env, \"USER\", targpw->pw_name);"
    },
    {
        "line": 55,
        "fullcodeline": "fillenv(env, copyset);"
    },
    {
        "line": 22,
        "fullcodeline": "char keybuf[1024];"
    },
    {
        "line": 24,
        "fullcodeline": "e = environ[i];"
    },
    {
        "line": 29,
        "fullcodeline": "len = eq - e;"
    },
    {
        "line": 32,
        "fullcodeline": "memcpy(keybuf, e, len);"
    },
    {
        "line": 33,
        "fullcodeline": "keybuf[len] = '\\0';"
    },
    {
        "line": 35,
        "fullcodeline": "node = createnode(keybuf, eq + 1);"
    },
    {
        "line": 27,
        "fullcodeline": "if ((eq = strchr(e, '=')) == NULL || eq == e)"
    },
    {
        "line": 30,
        "fullcodeline": "if (len > sizeof(keybuf) - 1)"
    },
    {
        "line": 36,
        "fullcodeline": "if (RB_INSERT(envtree, &env->root, node)) {"
    },
    {
        "line": 38,
        "fullcodeline": "freenode(node);"
    },
    {
        "line": 40,
        "fullcodeline": "env->count++;"
    }
]