[
    {
        "line": 9,
        "fullcodeline": "RB_INIT(&env->root);"
    },
    {
        "line": 10,
        "fullcodeline": "env->count = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "if (!env)"
    },
    {
        "line": 12,
        "fullcodeline": "if (rule->options & KEEPENV) {"
    },
    {
        "line": 8,
        "fullcodeline": "err(1, NULL);"
    },
    {
        "line": 15,
        "fullcodeline": "for (i = 0; environ[i] != NULL; i++) {"
    },
    {
        "line": 19,
        "fullcodeline": "char keybuf[1024];"
    },
    {
        "line": 21,
        "fullcodeline": "e = environ[i];"
    },
    {
        "line": 26,
        "fullcodeline": "len = eq - e;"
    },
    {
        "line": 29,
        "fullcodeline": "memcpy(keybuf, e, len);"
    },
    {
        "line": 30,
        "fullcodeline": "keybuf[len] = '\\0';"
    },
    {
        "line": 32,
        "fullcodeline": "node = createnode(keybuf, eq + 1);"
    },
    {
        "line": 24,
        "fullcodeline": "if ((eq = strchr(e, '=')) == NULL || eq == e)"
    },
    {
        "line": 27,
        "fullcodeline": "if (len > sizeof(keybuf) - 1)"
    },
    {
        "line": 33,
        "fullcodeline": "if (RB_INSERT(envtree, &env->root, node)) {"
    },
    {
        "line": 35,
        "fullcodeline": "freenode(node);"
    },
    {
        "line": 37,
        "fullcodeline": "env->count++;"
    }
]