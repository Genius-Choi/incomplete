[
    {
        "line": 9,
        "fullcodeline": "krb5_data plain = empty_data();"
    },
    {
        "line": 23,
        "fullcodeline": "acceptor_flag = ctx->initiate ? FLAG_SENDER_IS_ACCEPTOR : 0;"
    },
    {
        "line": 24,
        "fullcodeline": "key_usage = (toktype == KG_TOK_WRAP_MSG"
    },
    {
        "line": 34,
        "fullcodeline": "ptr -= 2;"
    },
    {
        "line": 35,
        "fullcodeline": "bodysize += 2;"
    },
    {
        "line": 69,
        "fullcodeline": "assert(key != NULL);"
    },
    {
        "line": 37,
        "fullcodeline": "if (bodysize < 16) {"
    },
    {
        "line": 42,
        "fullcodeline": "if ((ptr[2] & FLAG_SENDER_IS_ACCEPTOR) != acceptor_flag) {"
    },
    {
        "line": 62,
        "fullcodeline": "if (ctx->have_acceptor_subkey && (ptr[2] & FLAG_ACCEPTOR_SUBKEY)) {"
    },
    {
        "line": 71,
        "fullcodeline": "if (toktype == KG_TOK_WRAP_MSG) {"
    },
    {
        "line": 21,
        "fullcodeline": "*qop_state = GSS_C_QOP_DEFAULT;"
    },
    {
        "line": 25,
        "fullcodeline": "? (!ctx->initiate"
    },
    {
        "line": 28,
        "fullcodeline": ": (!ctx->initiate"
    },
    {
        "line": 39,
        "fullcodeline": "*minor_status = 0;"
    },
    {
        "line": 43,
        "fullcodeline": "*minor_status = (OM_uint32)G_BAD_DIRECTION;"
    },
    {
        "line": 63,
        "fullcodeline": "key = ctx->acceptor_subkey;"
    },
    {
        "line": 64,
        "fullcodeline": "cksumtype = ctx->acceptor_subkey_cksumtype;"
    },
    {
        "line": 76,
        "fullcodeline": "ec = load_16_be(ptr+4);"
    },
    {
        "line": 77,
        "fullcodeline": "rrc = load_16_be(ptr+6);"
    },
    {
        "line": 78,
        "fullcodeline": "seqnum = load_64_be(ptr+8);"
    },
    {
        "line": 174,
        "fullcodeline": "err = g_seqstate_check(ctx->seqstate, seqnum);"
    },
    {
        "line": 175,
        "fullcodeline": "*minor_status = 0;"
    },
    {
        "line": 66,
        "fullcodeline": "key = ctx->subkey;"
    },
    {
        "line": 67,
        "fullcodeline": "cksumtype = ctx->cksumtype;"
    },
    {
        "line": 72,
        "fullcodeline": "if (load_16_be(ptr) != KG2_TOK_WRAP_MSG)"
    },
    {
        "line": 74,
        "fullcodeline": "if (ptr[3] != 0xff)"
    },
    {
        "line": 79,
        "fullcodeline": "if (!gss_krb5int_rotate_left(ptr+16, bodysize-16, rrc)) {"
    },
    {
        "line": 84,
        "fullcodeline": "if (ptr[2] & FLAG_WRAP_CONFIDENTIAL) {"
    },
    {
        "line": 81,
        "fullcodeline": "*minor_status = ENOMEM;"
    },
    {
        "line": 96,
        "fullcodeline": "cipher.ciphertext.length = bodysize - 16;"
    },
    {
        "line": 97,
        "fullcodeline": "cipher.ciphertext.data = (char *)ptr + 16;"
    },
    {
        "line": 98,
        "fullcodeline": "plain.length = bodysize - 16;"
    },
    {
        "line": 99,
        "fullcodeline": "plain.data = gssalloc_malloc(plain.length);"
    },
    {
        "line": 102,
        "fullcodeline": "err = krb5_k_decrypt(context, key, key_usage, 0,"
    },
    {
        "line": 115,
        "fullcodeline": "althdr = (unsigned char *)plain.data + plain.length - 16;"
    },
    {
        "line": 124,
        "fullcodeline": "message_buffer->value = plain.data;"
    },
    {
        "line": 125,
        "fullcodeline": "message_buffer->length = plain.length - ec - 16;"
    },
    {
        "line": 177,
        "fullcodeline": "} else if (toktype == KG_TOK_MIC_MSG) {"
    },
    {
        "line": 100,
        "fullcodeline": "if (plain.data == NULL)"
    },
    {
        "line": 111,
        "fullcodeline": "if (plain.length < 16 + ec) {"
    },
    {
        "line": 116,
        "fullcodeline": "if (load_16_be(althdr) != KG2_TOK_WRAP_MSG"
    },
    {
        "line": 126,
        "fullcodeline": "if(message_buffer->length == 0) {"
    },
    {
        "line": 133,
        "fullcodeline": "err = krb5_c_checksum_length(context, cksumtype, &cksumsize);"
    },
    {
        "line": 148,
        "fullcodeline": "store_16_be(0, ptr+4);"
    },
    {
        "line": 149,
        "fullcodeline": "store_16_be(0, ptr+6);"
    },
    {
        "line": 150,
        "fullcodeline": "plain = make_data(ptr, bodysize - ec);"
    },
    {
        "line": 153,
        "fullcodeline": "sum.length = ec;"
    },
    {
        "line": 158,
        "fullcodeline": "sum.contents = ptr+bodysize-ec;"
    },
    {
        "line": 159,
        "fullcodeline": "sum.checksum_type = cksumtype;"
    },
    {
        "line": 160,
        "fullcodeline": "err = krb5_k_verify_checksum(context, key, key_usage,"
    },
    {
        "line": 168,
        "fullcodeline": "message_buffer->length = plain.length - 16;"
    },
    {
        "line": 169,
        "fullcodeline": "message_buffer->value = gssalloc_malloc(message_buffer->length);"
    },
    {
        "line": 172,
        "fullcodeline": "memcpy(message_buffer->value, plain.data, message_buffer->length);"
    },
    {
        "line": 186,
        "fullcodeline": "seqnum = load_64_be(ptr+8);"
    },
    {
        "line": 187,
        "fullcodeline": "plain.length = message_buffer->length + 16;"
    },
    {
        "line": 188,
        "fullcodeline": "plain.data = malloc(plain.length);"
    },
    {
        "line": 193,
        "fullcodeline": "memcpy(plain.data + message_buffer->length, ptr, 16);"
    },
    {
        "line": 194,
        "fullcodeline": "sum.length = bodysize - 16;"
    },
    {
        "line": 195,
        "fullcodeline": "sum.contents = ptr + 16;"
    },
    {
        "line": 196,
        "fullcodeline": "sum.checksum_type = cksumtype;"
    },
    {
        "line": 197,
        "fullcodeline": "err = krb5_k_verify_checksum(context, key, key_usage,"
    },
    {
        "line": 199,
        "fullcodeline": "free(plain.data);"
    },
    {
        "line": 200,
        "fullcodeline": "plain.data = NULL;"
    },
    {
        "line": 211,
        "fullcodeline": "err = g_seqstate_check(ctx->seqstate, seqnum);"
    },
    {
        "line": 212,
        "fullcodeline": "*minor_status = 0;"
    },
    {
        "line": 90,
        "fullcodeline": "*conf_state = 1;"
    },
    {
        "line": 105,
        "fullcodeline": "gssalloc_free(plain.data);"
    },
    {
        "line": 112,
        "fullcodeline": "free(plain.data);"
    },
    {
        "line": 120,
        "fullcodeline": "|| memcmp(althdr+8, ptr+8, 8)) {"
    },
    {
        "line": 121,
        "fullcodeline": "free(plain.data);"
    },
    {
        "line": 127,
        "fullcodeline": "gssalloc_free(message_buffer->value);"
    },
    {
        "line": 128,
        "fullcodeline": "message_buffer->value = NULL;"
    },
    {
        "line": 140,
        "fullcodeline": "if (ec + 16 < ec)"
    },
    {
        "line": 143,
        "fullcodeline": "if (ec + 16 > bodysize)"
    },
    {
        "line": 151,
        "fullcodeline": "if (!gss_krb5int_rotate_left(ptr, bodysize-ec, 16))"
    },
    {
        "line": 154,
        "fullcodeline": "if (sum.length != cksumsize) {"
    },
    {
        "line": 164,
        "fullcodeline": "if (!valid) {"
    },
    {
        "line": 170,
        "fullcodeline": "if (message_buffer->value == NULL)"
    },
    {
        "line": 179,
        "fullcodeline": "if (load_16_be(ptr) != KG2_TOK_MIC_MSG)"
    },
    {
        "line": 182,
        "fullcodeline": "if (ptr[3] != 0xff)"
    },
    {
        "line": 184,
        "fullcodeline": "if (load_32_be(ptr+4) != 0xffffffffL)"
    },
    {
        "line": 189,
        "fullcodeline": "if (plain.data == NULL)"
    },
    {
        "line": 207,
        "fullcodeline": "if (!valid) {"
    },
    {
        "line": 119,
        "fullcodeline": "|| load_16_be(althdr+4) != ec"
    },
    {
        "line": 139,
        "fullcodeline": "*conf_state = 0;"
    },
    {
        "line": 155,
        "fullcodeline": "*minor_status = 0;"
    },
    {
        "line": 165,
        "fullcodeline": "*minor_status = 0;"
    },
    {
        "line": 192,
        "fullcodeline": "memcpy(plain.data, message_buffer->value, message_buffer->length);"
    },
    {
        "line": 203,
        "fullcodeline": "*minor_status = err;"
    },
    {
        "line": 204,
        "fullcodeline": "save_error_info(*minor_status, context);"
    },
    {
        "line": 208,
        "fullcodeline": "*minor_status = 0;"
    },
    {
        "line": 214,
        "fullcodeline": "} else if (toktype == KG_TOK_DEL_CTX) {"
    },
    {
        "line": 118,
        "fullcodeline": "|| althdr[3] != ptr[3]"
    },
    {
        "line": 217,
        "fullcodeline": "message_buffer = (gss_buffer_t)&empty_message;"
    },
    {
        "line": 117,
        "fullcodeline": "|| althdr[2] != ptr[2]"
    },
    {
        "line": 215,
        "fullcodeline": "if (load_16_be(ptr) != KG2_TOK_DEL_CTX)"
    }
]