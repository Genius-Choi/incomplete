[
    {
        "line": 3,
        "fullcodeline": "BYTE cmac[8];"
    },
    {
        "line": 4,
        "fullcodeline": "BYTE wmac[8];"
    },
    {
        "line": 44,
        "fullcodeline": "stream_read(s, wmac, sizeof(wmac));"
    },
    {
        "line": 45,
        "fullcodeline": "length -= sizeof(wmac);"
    },
    {
        "line": 6,
        "fullcodeline": "if (rdp->settings->EncryptionMethods == ENCRYPTION_METHOD_FIPS)"
    },
    {
        "line": 41,
        "fullcodeline": "if (stream_get_left(s) < 8)"
    },
    {
        "line": 46,
        "fullcodeline": "if (!security_decrypt(s->p, length, rdp))"
    },
    {
        "line": 49,
        "fullcodeline": "if (securityFlags & SEC_SECURE_CHECKSUM)"
    },
    {
        "line": 54,
        "fullcodeline": "if (memcmp(wmac, cmac, sizeof(wmac)) != 0)"
    },
    {
        "line": 15,
        "fullcodeline": "stream_read_UINT16(s, len); /* 0x10 */"
    },
    {
        "line": 16,
        "fullcodeline": "stream_read_BYTE(s, version); /* 0x1 */"
    },
    {
        "line": 17,
        "fullcodeline": "stream_read_BYTE(s, pad);"
    },
    {
        "line": 19,
        "fullcodeline": "sig = s->p;"
    },
    {
        "line": 20,
        "fullcodeline": "stream_seek(s, 8);\t/* signature */"
    },
    {
        "line": 22,
        "fullcodeline": "length -= 12;"
    },
    {
        "line": 37,
        "fullcodeline": "s->size -= pad;"
    },
    {
        "line": 50,
        "fullcodeline": "security_salted_mac_signature(rdp, s->p, length, FALSE, cmac);"
    },
    {
        "line": 56,
        "fullcodeline": "printf(\"WARNING: invalid packet signature\\n\");"
    },
    {
        "line": 12,
        "fullcodeline": "if (stream_get_left(s) < 12)"
    },
    {
        "line": 24,
        "fullcodeline": "if (!security_fips_decrypt(s->p, length, rdp))"
    },
    {
        "line": 30,
        "fullcodeline": "if (!security_fips_check_signature(s->p, length - pad, sig, rdp))"
    },
    {
        "line": 52,
        "fullcodeline": "security_mac_signature(rdp, s->p, length, cmac);"
    },
    {
        "line": 26,
        "fullcodeline": "printf(\"FATAL: cannot decrypt\\n\");"
    },
    {
        "line": 32,
        "fullcodeline": "printf(\"FATAL: invalid packet signature\\n\");"
    }
]