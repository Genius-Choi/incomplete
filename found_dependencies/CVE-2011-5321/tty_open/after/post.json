[
    {
        "line": 3,
        "fullcodeline": "struct tty_struct *tty = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "dev_t device = inode->i_rdev;"
    },
    {
        "line": 8,
        "fullcodeline": "unsigned saved_flags = filp->f_flags;"
    },
    {
        "line": 10,
        "fullcodeline": "nonseekable_open(inode, filp);"
    },
    {
        "line": 13,
        "fullcodeline": "noctty = filp->f_flags & O_NOCTTY;"
    },
    {
        "line": 14,
        "fullcodeline": "index  = -1;"
    },
    {
        "line": 15,
        "fullcodeline": "retval = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "mutex_lock(&tty_mutex);"
    },
    {
        "line": 18,
        "fullcodeline": "tty_lock();"
    },
    {
        "line": 60,
        "fullcodeline": "driver = get_tty_driver(device, &index);"
    },
    {
        "line": 86,
        "fullcodeline": "mutex_unlock(&tty_mutex);"
    },
    {
        "line": 87,
        "fullcodeline": "tty_driver_kref_put(driver);"
    },
    {
        "line": 93,
        "fullcodeline": "retval = tty_add_file(tty, filp);"
    },
    {
        "line": 100,
        "fullcodeline": "check_tty_count(tty, \"tty_open\");"
    },
    {
        "line": 111,
        "fullcodeline": "filp->f_flags = saved_flags;"
    },
    {
        "line": 140,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 143,
        "fullcodeline": "mutex_lock(&tty_mutex);"
    },
    {
        "line": 144,
        "fullcodeline": "tty_lock();"
    },
    {
        "line": 151,
        "fullcodeline": "spin_unlock_irq(&current->sighand->siglock);"
    },
    {
        "line": 152,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 153,
        "fullcodeline": "mutex_unlock(&tty_mutex);"
    },
    {
        "line": 20,
        "fullcodeline": "if (device == MKDEV(TTYAUX_MAJOR, 0)) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (device == MKDEV(TTYAUX_MAJOR, 1)) {"
    },
    {
        "line": 61,
        "fullcodeline": "if (!driver) {"
    },
    {
        "line": 67,
        "fullcodeline": "if (!tty) {"
    },
    {
        "line": 88,
        "fullcodeline": "if (IS_ERR(tty)) {"
    },
    {
        "line": 101,
        "fullcodeline": "if (tty->driver->type == TTY_DRIVER_TYPE_PTY &&"
    },
    {
        "line": 113,
        "fullcodeline": "if (!retval && test_bit(TTY_EXCLUSIVE, &tty->flags) &&"
    },
    {
        "line": 146,
        "fullcodeline": "if (!noctty &&"
    },
    {
        "line": 21,
        "fullcodeline": "tty = get_current_tty();"
    },
    {
        "line": 27,
        "fullcodeline": "driver = tty_driver_kref_get(tty->driver);"
    },
    {
        "line": 28,
        "fullcodeline": "index = tty->index;"
    },
    {
        "line": 29,
        "fullcodeline": "filp->f_flags |= O_NONBLOCK; /* Don't let /dev/tty block */"
    },
    {
        "line": 32,
        "fullcodeline": "tty_kref_put(tty);"
    },
    {
        "line": 45,
        "fullcodeline": "struct tty_driver *console_driver = console_device(&index);"
    },
    {
        "line": 55,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 56,
        "fullcodeline": "mutex_unlock(&tty_mutex);"
    },
    {
        "line": 62,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 63,
        "fullcodeline": "mutex_unlock(&tty_mutex);"
    },
    {
        "line": 69,
        "fullcodeline": "tty = tty_driver_lookup_tty(driver, inode, index);"
    },
    {
        "line": 80,
        "fullcodeline": "retval = tty_reopen(tty);"
    },
    {
        "line": 89,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 95,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 96,
        "fullcodeline": "tty_release(inode, filp);"
    },
    {
        "line": 102,
        "fullcodeline": "tty->driver->subtype == PTY_TYPE_MASTER)"
    },
    {
        "line": 103,
        "fullcodeline": "noctty = 1;"
    },
    {
        "line": 108,
        "fullcodeline": "retval = tty->ops->open(tty, filp);"
    },
    {
        "line": 114,
        "fullcodeline": "!capable(CAP_SYS_ADMIN))"
    },
    {
        "line": 115,
        "fullcodeline": "retval = -EBUSY;"
    },
    {
        "line": 122,
        "fullcodeline": "tty_unlock(); /* need to call tty_release without BTM */"
    },
    {
        "line": 123,
        "fullcodeline": "tty_release(inode, filp);"
    },
    {
        "line": 130,
        "fullcodeline": "schedule();"
    },
    {
        "line": 134,
        "fullcodeline": "tty_lock();"
    },
    {
        "line": 137,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 149,
        "fullcodeline": "tty->session == NULL)"
    },
    {
        "line": 150,
        "fullcodeline": "__proc_set_tty(current, tty);"
    },
    {
        "line": 22,
        "fullcodeline": "if (!tty) {"
    },
    {
        "line": 57,
        "fullcodeline": "return -ENODEV;"
    },
    {
        "line": 64,
        "fullcodeline": "return -ENODEV;"
    },
    {
        "line": 71,
        "fullcodeline": "if (IS_ERR(tty)) {"
    },
    {
        "line": 84,
        "fullcodeline": "tty = tty_init_dev(driver, index, 0);"
    },
    {
        "line": 90,
        "fullcodeline": "return PTR_ERR(tty);"
    },
    {
        "line": 110,
        "fullcodeline": "retval = -ENODEV;"
    },
    {
        "line": 124,
        "fullcodeline": "if (retval != -ERESTARTSYS)"
    },
    {
        "line": 127,
        "fullcodeline": "if (signal_pending(current))"
    },
    {
        "line": 135,
        "fullcodeline": "if (filp->f_op == &hung_up_tty_fops)"
    },
    {
        "line": 23,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 24,
        "fullcodeline": "mutex_unlock(&tty_mutex);"
    },
    {
        "line": 47,
        "fullcodeline": "driver = tty_driver_kref_get(console_driver);"
    },
    {
        "line": 72,
        "fullcodeline": "tty_unlock();"
    },
    {
        "line": 73,
        "fullcodeline": "mutex_unlock(&tty_mutex);"
    },
    {
        "line": 74,
        "fullcodeline": "tty_driver_kref_put(driver);"
    },
    {
        "line": 82,
        "fullcodeline": "tty = ERR_PTR(retval);"
    },
    {
        "line": 136,
        "fullcodeline": "filp->f_op = &tty_fops;"
    },
    {
        "line": 25,
        "fullcodeline": "return -ENXIO;"
    },
    {
        "line": 75,
        "fullcodeline": "return PTR_ERR(tty);"
    },
    {
        "line": 50,
        "fullcodeline": "filp->f_flags |= O_NONBLOCK;"
    },
    {
        "line": 51,
        "fullcodeline": "noctty = 1;"
    }
]