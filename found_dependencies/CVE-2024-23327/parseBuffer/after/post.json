[
    {
        "line": 2,
        "fullcodeline": "Network::ConnectionSocket& socket = cb_->socket();"
    },
    {
        "line": 6,
        "fullcodeline": "if (!proxy_protocol_header_.has_value()) {"
    },
    {
        "line": 15,
        "fullcodeline": "if (proxy_protocol_header_.value().wholeHeaderLength() > max_proxy_protocol_len_) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (proxy_protocol_header_.has_value()) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (proxy_protocol_header_.has_value() &&"
    },
    {
        "line": 64,
        "fullcodeline": "if (proxy_protocol_header_.has_value() && !proxy_protocol_header_.value().local_command_) {"
    },
    {
        "line": 94,
        "fullcodeline": "if (!buffer.drain(proxy_protocol_header_.value().wholeHeaderLength())) {"
    },
    {
        "line": 7,
        "fullcodeline": "const ReadOrParseState read_header_state = readProxyHeader(buffer);"
    },
    {
        "line": 16,
        "fullcodeline": "max_proxy_protocol_len_ = proxy_protocol_header_.value().wholeHeaderLength();"
    },
    {
        "line": 22,
        "fullcodeline": "const ReadOrParseState read_ext_state = readExtensions(buffer);"
    },
    {
        "line": 29,
        "fullcodeline": "!cb_->filterState().hasData<Network::ProxyProtocolFilterState>("
    },
    {
        "line": 70,
        "fullcodeline": "const auto remote_version = proxy_protocol_header_.value().remote_address_->ip()->version();"
    },
    {
        "line": 71,
        "fullcodeline": "const auto local_version = proxy_protocol_header_.value().local_address_->ip()->version();"
    },
    {
        "line": 90,
        "fullcodeline": "socket.connectionInfoProvider().setRemoteAddress("
    },
    {
        "line": 8,
        "fullcodeline": "if (read_header_state != ReadOrParseState::Done) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (read_ext_state != ReadOrParseState::Done) {"
    },
    {
        "line": 72,
        "fullcodeline": "if (remote_version != proxy_protocol_header_.value().protocol_version_ ||"
    },
    {
        "line": 78,
        "fullcodeline": "if (!proxy_protocol_header_.value().remote_address_->ip()->isUnicastAddress() ||"
    },
    {
        "line": 32,
        "fullcodeline": "if (proxy_protocol_header_.value().local_command_) {"
    },
    {
        "line": 33,
        "fullcodeline": "ENVOY_LOG(trace, \"Parsed proxy protocol header, cmd: LOCAL, length: {}, buffer: {}\","
    },
    {
        "line": 37,
        "fullcodeline": "cb_->filterState().setData("
    },
    {
        "line": 73,
        "fullcodeline": "local_version != proxy_protocol_header_.value().protocol_version_) {"
    },
    {
        "line": 74,
        "fullcodeline": "ENVOY_LOG(debug, \"failed to read proxy protocol\");"
    },
    {
        "line": 79,
        "fullcodeline": "!proxy_protocol_header_.value().local_address_->ip()->isUnicastAddress()) {"
    },
    {
        "line": 80,
        "fullcodeline": "ENVOY_LOG(debug, \"failed to read proxy protocol\");"
    },
    {
        "line": 87,
        "fullcodeline": "socket.connectionInfoProvider().restoreLocalAddress("
    },
    {
        "line": 91,
        "fullcodeline": "proxy_protocol_header_.value().remote_address_);"
    },
    {
        "line": 31,
        "fullcodeline": "auto buf = reinterpret_cast<const uint8_t*>(buffer.rawSlice().mem_);"
    },
    {
        "line": 34,
        "fullcodeline": "proxy_protocol_header_.value().wholeHeaderLength(),"
    },
    {
        "line": 35,
        "fullcodeline": "Envoy::Hex::encode(buf, proxy_protocol_header_.value().wholeHeaderLength()));"
    },
    {
        "line": 39,
        "fullcodeline": "std::make_unique<Network::ProxyProtocolFilterState>(Network::ProxyProtocolData{"
    },
    {
        "line": 45,
        "fullcodeline": "ENVOY_LOG("
    },
    {
        "line": 54,
        "fullcodeline": "cb_->filterState().setData("
    },
    {
        "line": 86,
        "fullcodeline": "*socket.connectionInfoProvider().localAddress()) {"
    },
    {
        "line": 49,
        "fullcodeline": "proxy_protocol_header_.value().wholeHeaderLength(),"
    },
    {
        "line": 50,
        "fullcodeline": "Envoy::Hex::encode(buf, proxy_protocol_header_.value().wholeHeaderLength()),"
    },
    {
        "line": 52,
        "fullcodeline": "Envoy::Hex::encode(buf + proxy_protocol_header_.value().headerLengthWithoutExtension(),"
    },
    {
        "line": 56,
        "fullcodeline": "std::make_unique<Network::ProxyProtocolFilterState>(Network::ProxyProtocolData{"
    },
    {
        "line": 85,
        "fullcodeline": "if (*proxy_protocol_header_.value().local_address_ !="
    },
    {
        "line": 88,
        "fullcodeline": "proxy_protocol_header_.value().local_address_);"
    },
    {
        "line": 51,
        "fullcodeline": "proxy_protocol_header_.value().extensions_length_,"
    },
    {
        "line": 40,
        "fullcodeline": "socket.connectionInfoProvider().remoteAddress(),"
    },
    {
        "line": 41,
        "fullcodeline": "socket.connectionInfoProvider().localAddress(), parsed_tlvs_}),"
    },
    {
        "line": 53,
        "fullcodeline": "proxy_protocol_header_.value().extensions_length_));"
    },
    {
        "line": 57,
        "fullcodeline": "proxy_protocol_header_.value().remote_address_,"
    },
    {
        "line": 58,
        "fullcodeline": "proxy_protocol_header_.value().local_address_, parsed_tlvs_}),"
    }
]