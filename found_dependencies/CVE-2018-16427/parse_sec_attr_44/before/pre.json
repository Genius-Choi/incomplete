[
    {
        "line": 4,
        "fullcodeline": "const int df_idx[8] = {\t /* byte 1 = OpenSC type of AC Bit0,  byte 2 = OpenSC type of AC Bit1 ...*/"
    },
    {
        "line": 8,
        "fullcodeline": "const int ef_idx[8] = {"
    },
    {
        "line": 12,
        "fullcodeline": "const int efi_idx[8] = { /* internal EF used for RSA keys */"
    },
    {
        "line": 19,
        "fullcodeline": "int\t\tiKeyRef = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "int\t\tiOffset = 0;"
    },
    {
        "line": 27,
        "fullcodeline": "while (len > 1) {\t\t\t\t/* minimum length = 2 */"
    },
    {
        "line": 7,
        "fullcodeline": "SC_AC_OP_LOCK, SC_AC_OP_DELETE, -1};"
    },
    {
        "line": 11,
        "fullcodeline": "-1, SC_AC_OP_ERASE, -1};"
    },
    {
        "line": 15,
        "fullcodeline": "-1, SC_AC_OP_ERASE, -1};"
    },
    {
        "line": 28,
        "fullcodeline": "int\tiACLen   = buf[iOffset] & 0x0F;"
    },
    {
        "line": 31,
        "fullcodeline": "iMethod = SC_AC_NONE;\t\t/* default no authentication required */"
    },
    {
        "line": 137,
        "fullcodeline": "iOffset += iACLen +1;\t\t/* AC + PTL-byte */"
    },
    {
        "line": 138,
        "fullcodeline": "len     -= iACLen +1;"
    },
    {
        "line": 30,
        "fullcodeline": "iPinCount = -1;\t\t\t/* default no pin required */"
    },
    {
        "line": 33,
        "fullcodeline": "if (buf[iOffset] & 0X80) { /* AC in adaptive coding */"
    },
    {
        "line": 35,
        "fullcodeline": "int\tiParmLen = 1;\t\t\t/* command-byte is always present */"
    },
    {
        "line": 36,
        "fullcodeline": "int\tiKeyLen  = 0;\t\t\t/* Encryption key is optional */"
    },
    {
        "line": 81,
        "fullcodeline": "sc_file_add_acl_entry(file, iOperation, iMethod, iKeyRef);"
    },
    {
        "line": 38,
        "fullcodeline": "if (buf[iOffset]   & 0x20) iKeyLen++;"
    },
    {
        "line": 39,
        "fullcodeline": "if (buf[iOffset+1] & 0x40) iParmLen++;"
    },
    {
        "line": 40,
        "fullcodeline": "if (buf[iOffset+1] & 0x20) iParmLen++;"
    },
    {
        "line": 41,
        "fullcodeline": "if (buf[iOffset+1] & 0x10) iParmLen++;"
    },
    {
        "line": 42,
        "fullcodeline": "if (buf[iOffset+1] & 0x08) iParmLen++;"
    },
    {
        "line": 64,
        "fullcodeline": "if (iACLen > (1+iParmLen+iKeyLen)) {  /* check via total length if pin is present */"
    },
    {
        "line": 100,
        "fullcodeline": "iPinCount = iACLen - 1;"
    },
    {
        "line": 129,
        "fullcodeline": "bValue = buf[iOffset + 1];"
    },
    {
        "line": 46,
        "fullcodeline": "int iSC = buf[iOffset+iACLen];"
    },
    {
        "line": 60,
        "fullcodeline": "iKeyRef = iSC & 0x1F;\t\t\t/* get key number */"
    },
    {
        "line": 65,
        "fullcodeline": "iKeyRef = buf[iOffset+1+1+iParmLen];  /* PTL + AM-header + parameter-bytes */"
    },
    {
        "line": 66,
        "fullcodeline": "iMethod = SC_AC_CHV;"
    },
    {
        "line": 72,
        "fullcodeline": "iOperation = SC_AC_OP_CRYPTO;"
    },
    {
        "line": 75,
        "fullcodeline": "iOperation = SC_AC_OP_UPDATE;"
    },
    {
        "line": 78,
        "fullcodeline": "iOperation = SC_AC_OP_SELECT;"
    },
    {
        "line": 102,
        "fullcodeline": "if (buf[iOffset] & 0x20) {"
    },
    {
        "line": 130,
        "fullcodeline": "for (i = 0; i < 8; i++) {"
    },
    {
        "line": 89,
        "fullcodeline": "p_idx = df_idx;"
    },
    {
        "line": 92,
        "fullcodeline": "p_idx = efi_idx;"
    },
    {
        "line": 95,
        "fullcodeline": "p_idx = ef_idx;"
    },
    {
        "line": 103,
        "fullcodeline": "int iSC = buf[iOffset + iACLen];"
    },
    {
        "line": 117,
        "fullcodeline": "iKeyRef = iSC & 0x1F;\t\t\t/* get key number */"
    },
    {
        "line": 119,
        "fullcodeline": "iPinCount--;\t\t\t\t/* one byte used for keyReference  */"
    },
    {
        "line": 124,
        "fullcodeline": "iKeyRef = buf[iOffset + 2];\t/* pin ref */"
    },
    {
        "line": 125,
        "fullcodeline": "iMethod = SC_AC_CHV;"
    },
    {
        "line": 133,
        "fullcodeline": "bValue >>= 1;"
    },
    {
        "line": 48,
        "fullcodeline": "switch( (iSC>>5) & 0x03 ){"
    },
    {
        "line": 50,
        "fullcodeline": "iMethod = SC_AC_TERM;\t\t/* key authentication */"
    },
    {
        "line": 53,
        "fullcodeline": "iMethod = SC_AC_AUT;\t\t/* key authentication  */"
    },
    {
        "line": 57,
        "fullcodeline": "iMethod = SC_AC_PRO;\t\t/* secure messaging */"
    },
    {
        "line": 105,
        "fullcodeline": "switch( (iSC>>5) & 0x03 ) {"
    },
    {
        "line": 107,
        "fullcodeline": "iMethod = SC_AC_TERM;\t\t/* key authentication */"
    },
    {
        "line": 110,
        "fullcodeline": "iMethod = SC_AC_AUT;\t\t/* key authentication  */"
    },
    {
        "line": 114,
        "fullcodeline": "iMethod = SC_AC_PRO;\t\t/* secure messaging */"
    },
    {
        "line": 131,
        "fullcodeline": "if((bValue & 1) && (p_idx[i] >= 0))"
    },
    {
        "line": 132,
        "fullcodeline": "sc_file_add_acl_entry(file, p_idx[i], iMethod, iKeyRef);"
    }
]