[
    {
        "line": 5,
        "fullcodeline": "unsigned char iv[16] = { 0 };"
    },
    {
        "line": 6,
        "fullcodeline": "unsigned char plaintext[4096] = { 0 };"
    },
    {
        "line": 7,
        "fullcodeline": "epass2003_exdata *exdata = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "exdata = (epass2003_exdata *)card->drv_data;"
    },
    {
        "line": 49,
        "fullcodeline": "memcpy(out, plaintext, in_len - 2);"
    },
    {
        "line": 50,
        "fullcodeline": "*out_len = in_len - 2;"
    },
    {
        "line": 9,
        "fullcodeline": "if (!card->drv_data)"
    },
    {
        "line": 15,
        "fullcodeline": "if (in[0] == 0x99)"
    },
    {
        "line": 19,
        "fullcodeline": "if (0x01 == in[2] && 0x82 != in[1]) {"
    },
    {
        "line": 37,
        "fullcodeline": "if (KEY_TYPE_AES == exdata->smtype)"
    },
    {
        "line": 43,
        "fullcodeline": "while (0x80 != plaintext[in_len - 2] && (in_len - 2 > 0))"
    },
    {
        "line": 44,
        "fullcodeline": "in_len--;"
    },
    {
        "line": 46,
        "fullcodeline": "if (2 == in_len)"
    },
    {
        "line": 20,
        "fullcodeline": "in_len = in[1];"
    },
    {
        "line": 21,
        "fullcodeline": "i = 3;"
    },
    {
        "line": 38,
        "fullcodeline": "aes128_decrypt_cbc(exdata->sk_enc, 16, iv, &in[i], in_len - 1, plaintext);"
    },
    {
        "line": 40,
        "fullcodeline": "des3_decrypt_cbc(exdata->sk_enc, 16, iv, &in[i], in_len - 1, plaintext);"
    },
    {
        "line": 47,
        "fullcodeline": "return -1;"
    },
    {
        "line": 23,
        "fullcodeline": "else if (0x01 == in[3] && 0x81 == in[1]) {"
    },
    {
        "line": 24,
        "fullcodeline": "in_len = in[2];"
    },
    {
        "line": 25,
        "fullcodeline": "i = 4;"
    },
    {
        "line": 27,
        "fullcodeline": "else if (0x01 == in[4] && 0x82 == in[1]) {"
    },
    {
        "line": 28,
        "fullcodeline": "in_len = in[2] * 0x100;"
    },
    {
        "line": 29,
        "fullcodeline": "in_len += in[3];"
    },
    {
        "line": 30,
        "fullcodeline": "i = 5;"
    },
    {
        "line": 33,
        "fullcodeline": "return -1;"
    }
]