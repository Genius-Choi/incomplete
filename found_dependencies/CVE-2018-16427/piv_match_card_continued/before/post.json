[
    {
        "line": 4,
        "fullcodeline": "int type  = -1;"
    },
    {
        "line": 5,
        "fullcodeline": "piv_private_data_t *priv = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "int saved_type = card->type;"
    },
    {
        "line": 10,
        "fullcodeline": "card->ops->logout = NULL;"
    },
    {
        "line": 81,
        "fullcodeline": "priv = calloc(1, sizeof(piv_private_data_t));"
    },
    {
        "line": 89,
        "fullcodeline": "card->drv_data = priv; /* will free if no match, or pass on to piv_init */"
    },
    {
        "line": 90,
        "fullcodeline": "priv->aid_file = sc_file_new();"
    },
    {
        "line": 91,
        "fullcodeline": "priv->selected_obj = -1;"
    },
    {
        "line": 92,
        "fullcodeline": "priv->pin_preference = 0x80; /* 800-73-3 part 1, table 3 */"
    },
    {
        "line": 93,
        "fullcodeline": "priv->logged_in = SC_PIN_STATE_UNKNOWN;"
    },
    {
        "line": 94,
        "fullcodeline": "priv->tries_left = 10; /* will assume OK at start */"
    },
    {
        "line": 95,
        "fullcodeline": "priv->pstate = PIV_STATE_MATCH;"
    },
    {
        "line": 102,
        "fullcodeline": "sc_lock(card);"
    },
    {
        "line": 113,
        "fullcodeline": "i = piv_find_discovery(card);"
    },
    {
        "line": 148,
        "fullcodeline": "priv->pstate=PIV_STATE_INIT;"
    },
    {
        "line": 26,
        "fullcodeline": "if (type == -1) {"
    },
    {
        "line": 83,
        "fullcodeline": "if (!priv)"
    },
    {
        "line": 86,
        "fullcodeline": "if (card->type == -1)"
    },
    {
        "line": 98,
        "fullcodeline": "for (i=0; i < PIV_OBJ_LAST_ENUM -1; i++)"
    },
    {
        "line": 115,
        "fullcodeline": "if (i < 0) {"
    },
    {
        "line": 122,
        "fullcodeline": "if (i >= 0) {"
    },
    {
        "line": 139,
        "fullcodeline": "if (i < 0) {"
    },
    {
        "line": 15,
        "fullcodeline": "case -1:"
    },
    {
        "line": 21,
        "fullcodeline": "type = card->type;"
    },
    {
        "line": 84,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_OUT_OF_MEMORY);"
    },
    {
        "line": 87,
        "fullcodeline": "card->type = type;"
    },
    {
        "line": 99,
        "fullcodeline": "if(piv_objects[i].flags & PIV_OBJECT_NOT_PRESENT)"
    },
    {
        "line": 119,
        "fullcodeline": "i = piv_find_aid(card, &aidfile);"
    },
    {
        "line": 130,
        "fullcodeline": "int i7e = piv_find_discovery(card);"
    },
    {
        "line": 141,
        "fullcodeline": "sc_unlock(card);"
    },
    {
        "line": 142,
        "fullcodeline": "piv_finish(card);"
    },
    {
        "line": 143,
        "fullcodeline": "card->type = saved_type;"
    },
    {
        "line": 35,
        "fullcodeline": "if (card->reader->atr_info.hist_bytes != NULL) {"
    },
    {
        "line": 75,
        "fullcodeline": "if (type == -1)"
    },
    {
        "line": 100,
        "fullcodeline": "priv->obj_cache[i].flags |= PIV_OBJ_CACHE_NOT_PRESENT;"
    },
    {
        "line": 132,
        "fullcodeline": "if (i7e != 0 && i7e !=  SC_ERROR_FILE_NOT_FOUND) {"
    },
    {
        "line": 76,
        "fullcodeline": "type = SC_CARD_TYPE_PIV_II_GENERIC;"
    },
    {
        "line": 133,
        "fullcodeline": "priv->card_issues |= CI_DISCOVERY_USELESS;"
    },
    {
        "line": 134,
        "fullcodeline": "priv->obj_cache[PIV_OBJ_DISCOVERY].flags |= PIV_OBJ_CACHE_NOT_PRESENT;"
    },
    {
        "line": 36,
        "fullcodeline": "if (card->reader->atr_info.hist_bytes_len == 8 &&"
    },
    {
        "line": 37,
        "fullcodeline": "!(memcmp(card->reader->atr_info.hist_bytes, \"Yubikey4\", 8))) {"
    },
    {
        "line": 38,
        "fullcodeline": "type = SC_CARD_TYPE_PIV_II_YUBIKEY4;"
    },
    {
        "line": 40,
        "fullcodeline": "else if (card->reader->atr_info.hist_bytes_len >= 7 &&"
    },
    {
        "line": 41,
        "fullcodeline": "!(memcmp(card->reader->atr_info.hist_bytes, \"Yubikey\", 7))) {"
    },
    {
        "line": 42,
        "fullcodeline": "type = SC_CARD_TYPE_PIV_II_NEO;"
    },
    {
        "line": 51,
        "fullcodeline": "else if (card->reader->atr_info.hist_bytes_len >= 4 &&"
    },
    {
        "line": 52,
        "fullcodeline": "!(memcmp(card->reader->atr_info.hist_bytes, \"sfte\", 4))) {"
    },
    {
        "line": 53,
        "fullcodeline": "type = SC_CARD_TYPE_PIV_II_GI_DE;"
    },
    {
        "line": 56,
        "fullcodeline": "else if (card->reader->atr_info.hist_bytes[0] == 0x80u) { /* compact TLV */"
    },
    {
        "line": 58,
        "fullcodeline": "const u8 *data = sc_compacttlv_find_tag(card->reader->atr_info.hist_bytes + 1,"
    },
    {
        "line": 62,
        "fullcodeline": "if (data != NULL) {"
    },
    {
        "line": 59,
        "fullcodeline": "card->reader->atr_info.hist_bytes_len - 1,"
    },
    {
        "line": 65,
        "fullcodeline": "for (k = 0; piv_aids[k].len_long != 0; k++) {"
    },
    {
        "line": 66,
        "fullcodeline": "if (datalen == piv_aids[k].len_long"
    },
    {
        "line": 67,
        "fullcodeline": "&& !memcmp(data, piv_aids[k].value, datalen)) {"
    },
    {
        "line": 68,
        "fullcodeline": "type = SC_CARD_TYPE_PIV_II_HIST;"
    }
]