[
    {
        "line": 4,
        "fullcodeline": "const u8 *p = buf;"
    },
    {
        "line": 6,
        "fullcodeline": "while (len != 0) {"
    },
    {
        "line": 7,
        "fullcodeline": "unsigned int amode, tlen = 3;"
    },
    {
        "line": 12,
        "fullcodeline": "amode = p[2];"
    },
    {
        "line": 39,
        "fullcodeline": "p   += tlen;"
    },
    {
        "line": 40,
        "fullcodeline": "len -= tlen;"
    },
    {
        "line": 8,
        "fullcodeline": "if (len < 5 || p[0] != 0x80 || p[1] != 0x01) {"
    },
    {
        "line": 13,
        "fullcodeline": "if (p[3] == 0x90 && p[4] == 0x00) {"
    },
    {
        "line": 9,
        "fullcodeline": "sc_debug(card->ctx, SC_LOG_DEBUG_NORMAL, \"invalid access mode encoding\");"
    },
    {
        "line": 14,
        "fullcodeline": "int r = set_sec_attr(file, amode, 0, SC_AC_NONE);"
    },
    {
        "line": 17,
        "fullcodeline": "tlen += 2;"
    },
    {
        "line": 15,
        "fullcodeline": "if (r != SC_SUCCESS)"
    },
    {
        "line": 18,
        "fullcodeline": "} else if (p[3] == 0x97 && p[4] == 0x00) {"
    },
    {
        "line": 19,
        "fullcodeline": "int r = set_sec_attr(file, amode, 0, SC_AC_NEVER);"
    },
    {
        "line": 22,
        "fullcodeline": "tlen += 2;"
    },
    {
        "line": 20,
        "fullcodeline": "if (r != SC_SUCCESS)"
    },
    {
        "line": 23,
        "fullcodeline": "} else if (p[3] == 0xA0 && len >= 4U + p[4]) {"
    },
    {
        "line": 25,
        "fullcodeline": "int r = set_sec_attr(file, amode, p[5], SC_AC_CHV);"
    },
    {
        "line": 28,
        "fullcodeline": "tlen += 2 + p[4]; /* FIXME */"
    },
    {
        "line": 26,
        "fullcodeline": "if (r != SC_SUCCESS)"
    },
    {
        "line": 29,
        "fullcodeline": "} else if (p[3] == 0xAF && len >= 4U + p[4]) {"
    },
    {
        "line": 31,
        "fullcodeline": "int r = set_sec_attr(file, amode, p[5], SC_AC_CHV);"
    },
    {
        "line": 34,
        "fullcodeline": "tlen += 2 + p[4];\t/* FIXME */"
    },
    {
        "line": 32,
        "fullcodeline": "if (r != SC_SUCCESS)"
    }
]