[
    {
        "line": 5,
        "fullcodeline": "u8 files[SC_MAX_EXT_APDU_BUFFER_SIZE];"
    },
    {
        "line": 7,
        "fullcodeline": "r = sc_lock(card);"
    },
    {
        "line": 10,
        "fullcodeline": "sc_unlock(card);"
    },
    {
        "line": 15,
        "fullcodeline": "print_file(card, file, &path, depth);"
    },
    {
        "line": 16,
        "fullcodeline": "file_type = file->type;"
    },
    {
        "line": 8,
        "fullcodeline": "if (r == SC_SUCCESS)"
    },
    {
        "line": 18,
        "fullcodeline": "if (file_type == SC_FILE_TYPE_DF) {"
    },
    {
        "line": 9,
        "fullcodeline": "r = sc_select_file(card, &path, &file);"
    },
    {
        "line": 12,
        "fullcodeline": "fprintf(stderr, \"SELECT FILE failed: %s\\n\", sc_strerror(r));"
    },
    {
        "line": 21,
        "fullcodeline": "r = sc_lock(card);"
    },
    {
        "line": 22,
        "fullcodeline": "if (r == SC_SUCCESS)"
    },
    {
        "line": 25,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (r == 0) {"
    },
    {
        "line": 23,
        "fullcodeline": "r = sc_list_files(card, files, sizeof(files));"
    },
    {
        "line": 26,
        "fullcodeline": "fprintf(stderr, \"sc_list_files() failed: %s\\n\", sc_strerror(r));"
    },
    {
        "line": 32,
        "fullcodeline": "for (i = 0; i < r/2; i++) {"
    },
    {
        "line": 35,
        "fullcodeline": "memset(&tmppath, 0, sizeof(tmppath));"
    },
    {
        "line": 36,
        "fullcodeline": "memcpy(&tmppath, &path, sizeof(path));"
    },
    {
        "line": 38,
        "fullcodeline": "tmppath.len += 2;"
    },
    {
        "line": 39,
        "fullcodeline": "enum_dir(tmppath, depth + 1);"
    },
    {
        "line": 37,
        "fullcodeline": "memcpy(tmppath.value + tmppath.len, files + 2*i, 2);"
    }
]