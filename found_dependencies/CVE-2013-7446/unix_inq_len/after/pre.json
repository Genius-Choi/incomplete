[
    {
        "line": 4,
        "fullcodeline": "long amount = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "spin_lock(&sk->sk_receive_queue.lock);"
    },
    {
        "line": 6,
        "fullcodeline": "if (sk->sk_state == TCP_LISTEN)"
    },
    {
        "line": 10,
        "fullcodeline": "if (sk->sk_type == SOCK_STREAM ||"
    },
    {
        "line": 11,
        "fullcodeline": "sk->sk_type == SOCK_SEQPACKET) {"
    },
    {
        "line": 12,
        "fullcodeline": "skb_queue_walk(&sk->sk_receive_queue, skb)"
    },
    {
        "line": 13,
        "fullcodeline": "amount += unix_skb_len(skb);"
    },
    {
        "line": 7,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 15,
        "fullcodeline": "skb = skb_peek(&sk->sk_receive_queue);"
    },
    {
        "line": 17,
        "fullcodeline": "amount = skb->len;"
    }
]