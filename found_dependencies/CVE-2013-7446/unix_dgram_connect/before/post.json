[
    {
        "line": 4,
        "fullcodeline": "struct sock *sk = sock->sk;"
    },
    {
        "line": 5,
        "fullcodeline": "struct net *net = sock_net(sk);"
    },
    {
        "line": 6,
        "fullcodeline": "struct sockaddr_un *sunaddr = (struct sockaddr_un *)addr;"
    },
    {
        "line": 69,
        "fullcodeline": "unix_state_double_unlock(sk, other);"
    },
    {
        "line": 70,
        "fullcodeline": "sock_put(other);"
    },
    {
        "line": 11,
        "fullcodeline": "if (addr->sa_family != AF_UNSPEC) {"
    },
    {
        "line": 54,
        "fullcodeline": "if (unix_peer(sk)) {"
    },
    {
        "line": 12,
        "fullcodeline": "err = unix_mkname(sunaddr, alen, &hash);"
    },
    {
        "line": 15,
        "fullcodeline": "alen = err;"
    },
    {
        "line": 22,
        "fullcodeline": "other = unix_find_other(net, sunaddr, alen, sock->type, hash, &err);"
    },
    {
        "line": 26,
        "fullcodeline": "unix_state_double_lock(sk, other);"
    },
    {
        "line": 35,
        "fullcodeline": "err = -EPERM;"
    },
    {
        "line": 39,
        "fullcodeline": "err = security_unix_may_send(sk->sk_socket, other->sk_socket);"
    },
    {
        "line": 55,
        "fullcodeline": "struct sock *old_peer = unix_peer(sk);"
    },
    {
        "line": 56,
        "fullcodeline": "unix_peer(sk) = other;"
    },
    {
        "line": 57,
        "fullcodeline": "unix_state_double_unlock(sk, other);"
    },
    {
        "line": 61,
        "fullcodeline": "sock_put(old_peer);"
    },
    {
        "line": 13,
        "fullcodeline": "if (err < 0)"
    },
    {
        "line": 17,
        "fullcodeline": "if (test_bit(SOCK_PASSCRED, &sock->flags) &&"
    },
    {
        "line": 23,
        "fullcodeline": "if (!other)"
    },
    {
        "line": 29,
        "fullcodeline": "if (sock_flag(other, SOCK_DEAD)) {"
    },
    {
        "line": 36,
        "fullcodeline": "if (!unix_may_send(sk, other))"
    },
    {
        "line": 47,
        "fullcodeline": "other = NULL;"
    },
    {
        "line": 48,
        "fullcodeline": "unix_state_double_lock(sk, other);"
    },
    {
        "line": 59,
        "fullcodeline": "if (other != old_peer)"
    },
    {
        "line": 63,
        "fullcodeline": "unix_peer(sk) = other;"
    },
    {
        "line": 64,
        "fullcodeline": "unix_state_double_unlock(sk, other);"
    },
    {
        "line": 18,
        "fullcodeline": "!unix_sk(sk)->addr && (err = unix_autobind(sock)) != 0)"
    },
    {
        "line": 30,
        "fullcodeline": "unix_state_double_unlock(sk, other);"
    },
    {
        "line": 31,
        "fullcodeline": "sock_put(other);"
    },
    {
        "line": 60,
        "fullcodeline": "unix_dgram_disconnected(sk, old_peer);"
    }
]