[
    {
        "line": 3,
        "fullcodeline": "WIN32_FIND_DATAW findFileData = { 0 };"
    },
    {
        "line": 4,
        "fullcodeline": "BOOL ret = TRUE;"
    },
    {
        "line": 5,
        "fullcodeline": "HANDLE dir = INVALID_HANDLE_VALUE;"
    },
    {
        "line": 6,
        "fullcodeline": "WCHAR* fullpath = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "WCHAR* path_slash = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "size_t base_path_length = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "base_path_length = _wcslen(path);"
    },
    {
        "line": 14,
        "fullcodeline": "path_slash = (WCHAR*)calloc(base_path_length + 3, sizeof(WCHAR));"
    },
    {
        "line": 22,
        "fullcodeline": "CopyMemory(path_slash, path, base_path_length * sizeof(WCHAR));"
    },
    {
        "line": 23,
        "fullcodeline": "path_slash[base_path_length] = L'/';"
    },
    {
        "line": 24,
        "fullcodeline": "path_slash[base_path_length + 1] = L'*';"
    },
    {
        "line": 25,
        "fullcodeline": "DEBUG_WSTR(\"Search in %s\", path_slash);"
    },
    {
        "line": 26,
        "fullcodeline": "dir = FindFirstFileW(path_slash, &findFileData);"
    },
    {
        "line": 62,
        "fullcodeline": "FindClose(dir);"
    },
    {
        "line": 72,
        "fullcodeline": "free(path_slash);"
    },
    {
        "line": 10,
        "fullcodeline": "if (!path)"
    },
    {
        "line": 16,
        "fullcodeline": "if (!path_slash)"
    },
    {
        "line": 28,
        "fullcodeline": "if (dir == INVALID_HANDLE_VALUE)"
    },
    {
        "line": 60,
        "fullcodeline": "} while (ret && FindNextFileW(dir, &findFileData) != 0);"
    },
    {
        "line": 18,
        "fullcodeline": "WLog_ERR(TAG, \"malloc failed!\");"
    },
    {
        "line": 30,
        "fullcodeline": "free(path_slash);"
    },
    {
        "line": 36,
        "fullcodeline": "const size_t len = _wcsnlen(findFileData.cFileName, ARRAYSIZE(findFileData.cFileName));"
    },
    {
        "line": 44,
        "fullcodeline": "fullpath = drive_file_combine_fullpath(path_slash, findFileData.cFileName, len);"
    },
    {
        "line": 45,
        "fullcodeline": "DEBUG_WSTR(\"Delete %s\", fullpath);"
    },
    {
        "line": 56,
        "fullcodeline": "free(fullpath);"
    },
    {
        "line": 38,
        "fullcodeline": "if ((len == 1 && findFileData.cFileName[0] == L'.') ||"
    },
    {
        "line": 47,
        "fullcodeline": "if (findFileData.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)"
    },
    {
        "line": 58,
        "fullcodeline": "if (!ret)"
    },
    {
        "line": 66,
        "fullcodeline": "if (!RemoveDirectoryW(path))"
    },
    {
        "line": 39,
        "fullcodeline": "(len == 2 && findFileData.cFileName[0] == L'.' && findFileData.cFileName[1] == L'.'))"
    },
    {
        "line": 49,
        "fullcodeline": "ret = drive_file_remove_dir(fullpath);"
    },
    {
        "line": 68,
        "fullcodeline": "ret = FALSE;"
    },
    {
        "line": 53,
        "fullcodeline": "ret = DeleteFileW(fullpath);"
    }
]