[
    {
        "line": 4,
        "fullcodeline": "BOOL ok = FALSE;"
    },
    {
        "line": 5,
        "fullcodeline": "WCHAR* fullpath = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "const size_t base_path_length = _wcsnlen(base_path, MAX_PATH);"
    },
    {
        "line": 12,
        "fullcodeline": "length = base_path_length + PathWCharLength + 1;"
    },
    {
        "line": 13,
        "fullcodeline": "fullpath = (WCHAR*)calloc(length, sizeof(WCHAR));"
    },
    {
        "line": 18,
        "fullcodeline": "CopyMemory(fullpath, base_path, base_path_length * sizeof(WCHAR));"
    },
    {
        "line": 26,
        "fullcodeline": "const WCHAR dotdot[] = { '.', '.', '\\0' };"
    },
    {
        "line": 38,
        "fullcodeline": "ok = TRUE;"
    },
    {
        "line": 8,
        "fullcodeline": "if (!base_path || (!path && (PathWCharLength > 0)))"
    },
    {
        "line": 15,
        "fullcodeline": "if (!fullpath)"
    },
    {
        "line": 22,
        "fullcodeline": "if (!drive_file_fix_path(fullpath, length))"
    },
    {
        "line": 27,
        "fullcodeline": "if (_wcsstr(&fullpath[base_path_length], dotdot))"
    },
    {
        "line": 40,
        "fullcodeline": "if (!ok)"
    },
    {
        "line": 20,
        "fullcodeline": "CopyMemory(&fullpath[base_path_length], path, PathWCharLength * sizeof(WCHAR));"
    },
    {
        "line": 29,
        "fullcodeline": "char abuffer[MAX_PATH] = { 0 };"
    },
    {
        "line": 30,
        "fullcodeline": "ConvertFromUnicode(CP_UTF8, 0, &fullpath[base_path_length], -1, (char**)&abuffer,"
    },
    {
        "line": 33,
        "fullcodeline": "WLog_WARN(TAG, \"[rdpdr] received invalid file path '%s' from server, aborting!\","
    },
    {
        "line": 43,
        "fullcodeline": "fullpath = NULL;"
    },
    {
        "line": 31,
        "fullcodeline": "ARRAYSIZE(abuffer) - 1, NULL, NULL);"
    }
]