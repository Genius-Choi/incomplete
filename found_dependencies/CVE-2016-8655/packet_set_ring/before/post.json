[
    {
        "line": 4,
        "fullcodeline": "struct pgv *pg_vec = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "struct packet_sock *po = pkt_sk(sk);"
    },
    {
        "line": 6,
        "fullcodeline": "int was_running, order = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "int err = -EINVAL;"
    },
    {
        "line": 12,
        "fullcodeline": "struct tpacket_req *req = &req_u->req;"
    },
    {
        "line": 20,
        "fullcodeline": "rb = tx_ring ? &po->tx_ring : &po->rx_ring;"
    },
    {
        "line": 21,
        "fullcodeline": "rb_queue = tx_ring ? &sk->sk_write_queue : &sk->sk_receive_queue;"
    },
    {
        "line": 23,
        "fullcodeline": "err = -EBUSY;"
    },
    {
        "line": 95,
        "fullcodeline": "lock_sock(sk);"
    },
    {
        "line": 98,
        "fullcodeline": "spin_lock(&po->bind_lock);"
    },
    {
        "line": 99,
        "fullcodeline": "was_running = po->running;"
    },
    {
        "line": 100,
        "fullcodeline": "num = po->num;"
    },
    {
        "line": 105,
        "fullcodeline": "spin_unlock(&po->bind_lock);"
    },
    {
        "line": 107,
        "fullcodeline": "synchronize_net();"
    },
    {
        "line": 109,
        "fullcodeline": "err = -EBUSY;"
    },
    {
        "line": 110,
        "fullcodeline": "mutex_lock(&po->pg_vec_lock);"
    },
    {
        "line": 131,
        "fullcodeline": "mutex_unlock(&po->pg_vec_lock);"
    },
    {
        "line": 133,
        "fullcodeline": "spin_lock(&po->bind_lock);"
    },
    {
        "line": 138,
        "fullcodeline": "spin_unlock(&po->bind_lock);"
    },
    {
        "line": 144,
        "fullcodeline": "release_sock(sk);"
    },
    {
        "line": 15,
        "fullcodeline": "if (!closing && tx_ring && (po->tp_version > TPACKET_V2)) {"
    },
    {
        "line": 24,
        "fullcodeline": "if (!closing) {"
    },
    {
        "line": 111,
        "fullcodeline": "if (closing || atomic_read(&po->mapped) == 0) {"
    },
    {
        "line": 139,
        "fullcodeline": "if (closing && (po->tp_version > TPACKET_V2)) {"
    },
    {
        "line": 16,
        "fullcodeline": "net_warn_ratelimited(\"Tx-ring is not supported.\\n\");"
    },
    {
        "line": 33,
        "fullcodeline": "err = -EBUSY;"
    },
    {
        "line": 49,
        "fullcodeline": "err = -EINVAL;"
    },
    {
        "line": 64,
        "fullcodeline": "rb->frames_per_block = req->tp_block_size / req->tp_frame_size;"
    },
    {
        "line": 71,
        "fullcodeline": "err = -ENOMEM;"
    },
    {
        "line": 72,
        "fullcodeline": "order = get_order(req->tp_block_size);"
    },
    {
        "line": 73,
        "fullcodeline": "pg_vec = alloc_pg_vec(req, order);"
    },
    {
        "line": 102,
        "fullcodeline": "po->num = 0;"
    },
    {
        "line": 103,
        "fullcodeline": "__unregister_prot_hook(sk, false);"
    },
    {
        "line": 112,
        "fullcodeline": "err = 0;"
    },
    {
        "line": 113,
        "fullcodeline": "spin_lock_bh(&rb_queue->lock);"
    },
    {
        "line": 114,
        "fullcodeline": "swap(rb->pg_vec, pg_vec);"
    },
    {
        "line": 115,
        "fullcodeline": "rb->frame_max = (req->tp_frame_nr - 1);"
    },
    {
        "line": 116,
        "fullcodeline": "rb->head = 0;"
    },
    {
        "line": 117,
        "fullcodeline": "rb->frame_size = req->tp_frame_size;"
    },
    {
        "line": 118,
        "fullcodeline": "spin_unlock_bh(&rb_queue->lock);"
    },
    {
        "line": 120,
        "fullcodeline": "swap(rb->pg_vec_order, order);"
    },
    {
        "line": 121,
        "fullcodeline": "swap(rb->pg_vec_len, req->tp_block_nr);"
    },
    {
        "line": 123,
        "fullcodeline": "rb->pg_vec_pages = req->tp_block_size/PAGE_SIZE;"
    },
    {
        "line": 124,
        "fullcodeline": "po->prot_hook.func = (po->rx_ring.pg_vec) ?"
    },
    {
        "line": 126,
        "fullcodeline": "skb_queue_purge(rb_queue);"
    },
    {
        "line": 135,
        "fullcodeline": "po->num = num;"
    },
    {
        "line": 136,
        "fullcodeline": "register_prot_hook(sk);"
    },
    {
        "line": 147,
        "fullcodeline": "free_pg_vec(pg_vec, order, req->tp_block_nr);"
    },
    {
        "line": 25,
        "fullcodeline": "if (atomic_read(&po->mapped))"
    },
    {
        "line": 27,
        "fullcodeline": "if (packet_read_pending(rb))"
    },
    {
        "line": 34,
        "fullcodeline": "if (unlikely(rb->pg_vec))"
    },
    {
        "line": 50,
        "fullcodeline": "if (unlikely((int)req->tp_block_size <= 0))"
    },
    {
        "line": 52,
        "fullcodeline": "if (unlikely(!PAGE_ALIGNED(req->tp_block_size)))"
    },
    {
        "line": 54,
        "fullcodeline": "if (po->tp_version >= TPACKET_V3 &&"
    },
    {
        "line": 58,
        "fullcodeline": "if (unlikely(req->tp_frame_size < po->tp_hdrlen +"
    },
    {
        "line": 61,
        "fullcodeline": "if (unlikely(req->tp_frame_size & (TPACKET_ALIGNMENT - 1)))"
    },
    {
        "line": 65,
        "fullcodeline": "if (unlikely(rb->frames_per_block == 0))"
    },
    {
        "line": 67,
        "fullcodeline": "if (unlikely((rb->frames_per_block * req->tp_block_nr) !="
    },
    {
        "line": 74,
        "fullcodeline": "if (unlikely(!pg_vec))"
    },
    {
        "line": 90,
        "fullcodeline": "err = -EINVAL;"
    },
    {
        "line": 127,
        "fullcodeline": "if (atomic_read(&po->mapped))"
    },
    {
        "line": 141,
        "fullcodeline": "if (!tx_ring)"
    },
    {
        "line": 39,
        "fullcodeline": "po->tp_hdrlen = TPACKET_HDRLEN;"
    },
    {
        "line": 42,
        "fullcodeline": "po->tp_hdrlen = TPACKET2_HDRLEN;"
    },
    {
        "line": 45,
        "fullcodeline": "po->tp_hdrlen = TPACKET3_HDRLEN;"
    },
    {
        "line": 55,
        "fullcodeline": "(int)(req->tp_block_size -"
    },
    {
        "line": 91,
        "fullcodeline": "if (unlikely(req->tp_frame_nr))"
    },
    {
        "line": 128,
        "fullcodeline": "pr_err(\"packet_mmap: vma is busy: %d\\n\","
    },
    {
        "line": 142,
        "fullcodeline": "prb_shutdown_retire_blk_timer(po, rb_queue);"
    },
    {
        "line": 81,
        "fullcodeline": "if (!tx_ring)"
    },
    {
        "line": 129,
        "fullcodeline": "atomic_read(&po->mapped));"
    },
    {
        "line": 82,
        "fullcodeline": "init_prb_bdqc(po, rb, pg_vec, req_u);"
    }
]