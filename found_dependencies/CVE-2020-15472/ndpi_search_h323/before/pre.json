[
    {
        "line": 3,
        "fullcodeline": "struct ndpi_packet_struct *packet = &flow->packet;"
    },
    {
        "line": 4,
        "fullcodeline": "u_int16_t dport = 0, sport = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "NDPI_LOG_DBG(ndpi_struct, \"search H323\\n\");"
    },
    {
        "line": 12,
        "fullcodeline": "if((packet->tcp != NULL) && (packet->tcp->dest != ntohs(102))) {"
    },
    {
        "line": 13,
        "fullcodeline": "NDPI_LOG_DBG2(ndpi_struct, \"calculated dport over tcp\\n\");"
    },
    {
        "line": 16,
        "fullcodeline": "if(packet->payload_packet_len >= 4"
    },
    {
        "line": 18,
        "fullcodeline": "&& (packet->payload[1] == 0x00)) {"
    },
    {
        "line": 19,
        "fullcodeline": "struct tpkt *t = (struct tpkt*)packet->payload;"
    },
    {
        "line": 20,
        "fullcodeline": "u_int16_t len = ntohs(t->len);"
    },
    {
        "line": 17,
        "fullcodeline": "&& (packet->payload[0] == 0x03)"
    },
    {
        "line": 22,
        "fullcodeline": "if(packet->payload_packet_len == len) {"
    },
    {
        "line": 52,
        "fullcodeline": "NDPI_LOG_DBG2(ndpi_struct, \"calculated dport over udp\\n\");"
    },
    {
        "line": 38,
        "fullcodeline": "flow->l4.tcp.h323_valid_packets++;"
    },
    {
        "line": 51,
        "fullcodeline": "sport = ntohs(packet->udp->source), dport = ntohs(packet->udp->dest);"
    },
    {
        "line": 54,
        "fullcodeline": "if(packet->payload_packet_len >= 6 && packet->payload[0] == 0x80 && packet->payload[1] == 0x08 &&"
    },
    {
        "line": 28,
        "fullcodeline": "if(packet->payload[4] == (packet->payload_packet_len - sizeof(struct tpkt) - 1)) {"
    },
    {
        "line": 56,
        "fullcodeline": "packet->payload[4] == 0x00 && packet->payload[5] == 0x00)"
    },
    {
        "line": 58,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct, \"found H323 broadcast\\n\");"
    },
    {
        "line": 63,
        "fullcodeline": "if(sport == 1719 || dport == 1719)"
    },
    {
        "line": 41,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct, \"found H323 broadcast\\n\");"
    },
    {
        "line": 30,
        "fullcodeline": "if((packet->payload[5] == 0xE0 /* CC Connect Request */)"
    },
    {
        "line": 55,
        "fullcodeline": "(packet->payload[2] == 0xe7 || packet->payload[2] == 0x26) &&"
    },
    {
        "line": 65,
        "fullcodeline": "if(packet->payload[0] == 0x16 && packet->payload[1] == 0x80 && packet->payload[4] == 0x06 && packet->payload[5] == 0x00)"
    },
    {
        "line": 67,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct, \"found H323 broadcast\\n\");"
    },
    {
        "line": 31,
        "fullcodeline": "|| (packet->payload[5] == 0xD0 /* CC Connect Confirm */)) {"
    },
    {
        "line": 32,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct, \"found RDP\\n\");"
    },
    {
        "line": 33,
        "fullcodeline": "ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_RDP, NDPI_PROTOCOL_UNKNOWN);"
    },
    {
        "line": 71,
        "fullcodeline": "else if(packet->payload_packet_len >= 20 && packet->payload_packet_len <= 117)"
    },
    {
        "line": 73,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct, \"found H323 broadcast\\n\");"
    }
]