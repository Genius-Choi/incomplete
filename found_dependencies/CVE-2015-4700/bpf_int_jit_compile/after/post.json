[
    {
        "line": 3,
        "fullcodeline": "struct bpf_binary_header *header = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "int proglen, oldproglen = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "struct jit_context ctx = {};"
    },
    {
        "line": 6,
        "fullcodeline": "u8 *image = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "addrs = kmalloc(prog->len * sizeof(*addrs), GFP_KERNEL);"
    },
    {
        "line": 28,
        "fullcodeline": "ctx.cleanup_addr = proglen;"
    },
    {
        "line": 70,
        "fullcodeline": "kfree(addrs);"
    },
    {
        "line": 11,
        "fullcodeline": "if (!bpf_jit_enable)"
    },
    {
        "line": 14,
        "fullcodeline": "if (!prog || !prog->len)"
    },
    {
        "line": 18,
        "fullcodeline": "if (!addrs)"
    },
    {
        "line": 24,
        "fullcodeline": "for (proglen = 0, i = 0; i < prog->len; i++) {"
    },
    {
        "line": 35,
        "fullcodeline": "for (pass = 0; pass < 10 || image; pass++) {"
    },
    {
        "line": 60,
        "fullcodeline": "if (bpf_jit_enable > 1)"
    },
    {
        "line": 25,
        "fullcodeline": "proglen += 64;"
    },
    {
        "line": 26,
        "fullcodeline": "addrs[i] = proglen;"
    },
    {
        "line": 36,
        "fullcodeline": "proglen = do_jit(prog, addrs, image, oldproglen, &ctx);"
    },
    {
        "line": 57,
        "fullcodeline": "oldproglen = proglen;"
    },
    {
        "line": 61,
        "fullcodeline": "bpf_jit_dump(prog->len, proglen, 0, image);"
    },
    {
        "line": 64,
        "fullcodeline": "bpf_flush_icache(header, image + proglen);"
    },
    {
        "line": 65,
        "fullcodeline": "set_memory_ro((unsigned long)header, header->pages);"
    },
    {
        "line": 66,
        "fullcodeline": "prog->bpf_func = (void *)image;"
    },
    {
        "line": 67,
        "fullcodeline": "prog->jited = true;"
    },
    {
        "line": 37,
        "fullcodeline": "if (proglen <= 0) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (proglen == oldproglen) {"
    },
    {
        "line": 38,
        "fullcodeline": "image = NULL;"
    },
    {
        "line": 52,
        "fullcodeline": "header = bpf_jit_binary_alloc(proglen, &image,"
    },
    {
        "line": 44,
        "fullcodeline": "if (proglen != oldproglen) {"
    },
    {
        "line": 54,
        "fullcodeline": "if (!header)"
    },
    {
        "line": 40,
        "fullcodeline": "bpf_jit_binary_free(header);"
    },
    {
        "line": 45,
        "fullcodeline": "pr_err(\"bpf_jit: proglen=%d != oldproglen=%d\\n\","
    }
]