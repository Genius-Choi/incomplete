[
    {
        "line": 4,
        "fullcodeline": "unsigned char key2[8];"
    },
    {
        "line": 9,
        "fullcodeline": "str_to_key(key, key2);"
    },
    {
        "line": 11,
        "fullcodeline": "tfm_des = crypto_alloc_skcipher(\"ecb(des)\", 0, CRYPTO_ALG_ASYNC);"
    },
    {
        "line": 18,
        "fullcodeline": "req = skcipher_request_alloc(tfm_des, GFP_KERNEL);"
    },
    {
        "line": 25,
        "fullcodeline": "crypto_skcipher_setkey(tfm_des, key2, 8);"
    },
    {
        "line": 27,
        "fullcodeline": "sg_init_one(&sgin, in, 8);"
    },
    {
        "line": 28,
        "fullcodeline": "sg_init_one(&sgout, out, 8);"
    },
    {
        "line": 30,
        "fullcodeline": "skcipher_request_set_callback(req, 0, NULL, NULL);"
    },
    {
        "line": 31,
        "fullcodeline": "skcipher_request_set_crypt(req, &sgin, &sgout, 8, NULL);"
    },
    {
        "line": 33,
        "fullcodeline": "rc = crypto_skcipher_encrypt(req);"
    },
    {
        "line": 37,
        "fullcodeline": "skcipher_request_free(req);"
    },
    {
        "line": 40,
        "fullcodeline": "crypto_free_skcipher(tfm_des);"
    },
    {
        "line": 12,
        "fullcodeline": "if (IS_ERR(tfm_des)) {"
    },
    {
        "line": 19,
        "fullcodeline": "if (!req) {"
    },
    {
        "line": 13,
        "fullcodeline": "rc = PTR_ERR(tfm_des);"
    },
    {
        "line": 14,
        "fullcodeline": "cifs_dbg(VFS, \"could not allocate des crypto API\\n\");"
    },
    {
        "line": 20,
        "fullcodeline": "rc = -ENOMEM;"
    },
    {
        "line": 21,
        "fullcodeline": "cifs_dbg(VFS, \"could not allocate des crypto API\\n\");"
    },
    {
        "line": 35,
        "fullcodeline": "cifs_dbg(VFS, \"could not encrypt crypt key rc: %d\\n\", rc);"
    }
]