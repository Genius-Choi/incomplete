[
    {
        "line": 2,
        "fullcodeline": "@agent.redirect_ok = true"
    },
    {
        "line": 4,
        "fullcodeline": "headers = {"
    },
    {
        "line": 10,
        "fullcodeline": "page = html_page ''"
    },
    {
        "line": 11,
        "fullcodeline": "page = @agent.response_redirect({ 'Location' => 'http://example:81/http_headers' }, :get,"
    },
    {
        "line": 14,
        "fullcodeline": "refute_includes(headers.keys, \"AUTHORIZATION\")"
    },
    {
        "line": 15,
        "fullcodeline": "assert_includes(headers.keys, \"cookie\")"
    },
    {
        "line": 17,
        "fullcodeline": "assert_match(\"range|bytes=0-9999\", page.body)"
    },
    {
        "line": 18,
        "fullcodeline": "refute_match(\"authorization|Basic xxx\", page.body)"
    },
    {
        "line": 19,
        "fullcodeline": "assert_match(\"cookie|name=value\", page.body)"
    },
    {
        "line": 5,
        "fullcodeline": "'Range' => 'bytes=0-9999',"
    },
    {
        "line": 6,
        "fullcodeline": "'AUTHORIZATION' => 'Basic xxx',"
    },
    {
        "line": 7,
        "fullcodeline": "'cookie' => 'name=value',"
    }
]