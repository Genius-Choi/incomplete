[
    {
        "line": 6,
        "fullcodeline": "unsigned char buffer[sizeof(DNSHeader)];"
    },
    {
        "line": 8,
        "fullcodeline": "memset(&from, 0, sizeof(from));"
    },
    {
        "line": 9,
        "fullcodeline": "socklen_t x = sizeof(from);"
    },
    {
        "line": 11,
        "fullcodeline": "int length = ServerInstance->SE->RecvFrom(this, (char*)buffer, sizeof(DNSHeader), 0, &from.sa, &x);"
    },
    {
        "line": 40,
        "fullcodeline": "DNS::FillHeader(&header,buffer,length - 12);"
    },
    {
        "line": 46,
        "fullcodeline": "unsigned long this_id = header.id[1] + (header.id[0] << 8);"
    },
    {
        "line": 66,
        "fullcodeline": "DNSInfo data = req->ResultIsReady(header, length);"
    },
    {
        "line": 14,
        "fullcodeline": "if (length < 12)"
    },
    {
        "line": 30,
        "fullcodeline": "if (from != myserver)"
    },
    {
        "line": 49,
        "fullcodeline": "if (!requests[this_id])"
    },
    {
        "line": 70,
        "fullcodeline": "if (data.first == NULL)"
    },
    {
        "line": 16,
        "fullcodeline": "ServerInstance->Logs->Log(\"RESOLVER\",DEBUG,\"GetResult didn't get a full packet (len=%d)\", length);"
    },
    {
        "line": 32,
        "fullcodeline": "std::string server1 = from.str();"
    },
    {
        "line": 33,
        "fullcodeline": "std::string server2 = myserver.str();"
    },
    {
        "line": 78,
        "fullcodeline": "std::string ro = req->orig;"
    },
    {
        "line": 18,
        "fullcodeline": "return DNSResult(-1,\"\",0,\"\");"
    },
    {
        "line": 35,
        "fullcodeline": "server1.c_str(), server2.c_str());"
    },
    {
        "line": 36,
        "fullcodeline": "return DNSResult(-1,\"\",0,\"\");"
    },
    {
        "line": 53,
        "fullcodeline": "return DNSResult(-1,\"\",0,\"\");"
    },
    {
        "line": 58,
        "fullcodeline": "req = requests[this_id];"
    },
    {
        "line": 80,
        "fullcodeline": "return DNSResult(this_id | ERROR_MASK, data.second, 0, ro);"
    },
    {
        "line": 84,
        "fullcodeline": "unsigned long ttl = req->ttl;"
    },
    {
        "line": 85,
        "fullcodeline": "char formatted[128];"
    },
    {
        "line": 137,
        "fullcodeline": "std::string ro = req->orig;"
    },
    {
        "line": 138,
        "fullcodeline": "DNSResult result = DNSResult(this_id,resultstr,ttl,ro,req->type);"
    },
    {
        "line": 91,
        "fullcodeline": "snprintf(formatted,16,\"%u.%u.%u.%u\",data.first[0],data.first[1],data.first[2],data.first[3]);"
    },
    {
        "line": 92,
        "fullcodeline": "resultstr = formatted;"
    },
    {
        "line": 104,
        "fullcodeline": "resultstr = formatted;"
    },
    {
        "line": 122,
        "fullcodeline": "resultstr = std::string((const char*)data.first);"
    },
    {
        "line": 97,
        "fullcodeline": "if (!inet_ntop(AF_INET6, data.first, formatted, sizeof(formatted)))"
    },
    {
        "line": 99,
        "fullcodeline": "std::string ro = req->orig;"
    },
    {
        "line": 112,
        "fullcodeline": "resultstr.insert(0, \"0\");"
    },
    {
        "line": 123,
        "fullcodeline": "if (resultstr.find_first_not_of(\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.-\") != std::string::npos)"
    },
    {
        "line": 125,
        "fullcodeline": "std::string ro = req->orig;"
    },
    {
        "line": 101,
        "fullcodeline": "return DNSResult(this_id | ERROR_MASK, \"inet_ntop() failed\", 0, ro);"
    },
    {
        "line": 127,
        "fullcodeline": "return DNSResult(this_id | ERROR_MASK, \"Invalid char(s) in reply\", 0, ro);"
    }
]