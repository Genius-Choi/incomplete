[
    {
        "line": 2,
        "fullcodeline": "RateLimiter.new(nil, \"activate-edit-email-hr-#{request.remote_ip}\", 5, 1.hour).performed!"
    },
    {
        "line": 14,
        "fullcodeline": "if @user.blank? || @user.active? || current_user.present? || @user.from_staged?"
    },
    {
        "line": 18,
        "fullcodeline": "User.transaction do"
    },
    {
        "line": 6,
        "fullcodeline": "@user = User.find_by_username_or_email(params[:username])"
    },
    {
        "line": 5,
        "fullcodeline": "RateLimiter.new(nil, \"activate-edit-email-hr-username-#{params[:username]}\", 5, 1.hour).performed!"
    },
    {
        "line": 8,
        "fullcodeline": "raise Discourse::InvalidAccess.new unless @user.confirm_password?(params[:password])"
    },
    {
        "line": 15,
        "fullcodeline": "raise Discourse::InvalidAccess.new"
    },
    {
        "line": 7,
        "fullcodeline": "raise Discourse::InvalidAccess.new unless @user.present?"
    },
    {
        "line": 10,
        "fullcodeline": "RateLimiter.new(nil, \"activate-edit-email-hr-user-key-#{user_key}\", 5, 1.hour).performed!"
    },
    {
        "line": 11,
        "fullcodeline": "@user = User.where(id: user_key.to_i).first"
    }
]