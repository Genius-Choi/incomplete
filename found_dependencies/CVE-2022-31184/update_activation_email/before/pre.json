[
    {
        "line": 2,
        "fullcodeline": "RateLimiter.new(nil, \"activate-edit-email-hr-#{request.remote_ip}\", 5, 1.hour).performed!"
    },
    {
        "line": 16,
        "fullcodeline": "User.transaction do"
    },
    {
        "line": 4,
        "fullcodeline": "if params[:username].present?"
    },
    {
        "line": 5,
        "fullcodeline": "@user = User.find_by_username_or_email(params[:username])"
    },
    {
        "line": 12,
        "fullcodeline": "if @user.blank? || @user.active? || current_user.present? || @user.from_staged?"
    },
    {
        "line": 6,
        "fullcodeline": "raise Discourse::InvalidAccess.new unless @user.present?"
    },
    {
        "line": 8,
        "fullcodeline": "elsif user_key = session[SessionController::ACTIVATE_USER_KEY]"
    },
    {
        "line": 7,
        "fullcodeline": "raise Discourse::InvalidAccess.new unless @user.confirm_password?(params[:password])"
    },
    {
        "line": 9,
        "fullcodeline": "@user = User.where(id: user_key.to_i).first"
    },
    {
        "line": 13,
        "fullcodeline": "raise Discourse::InvalidAccess.new"
    }
]