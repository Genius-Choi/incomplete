[
    {
        "line": 6,
        "fullcodeline": "size_t msg_size = sizeof(struct vbg_ioctl_hgcm_call) + 4 * sizeof(struct vmmdev_hgcm_function_parameter64);"
    },
    {
        "line": 7,
        "fullcodeline": "struct vbg_ioctl_hgcm_call _cleanup_free_ *msg = calloc(1, msg_size);"
    },
    {
        "line": 9,
        "fullcodeline": "init_header(&msg->hdr, msg_size - sizeof(msg->hdr), msg_size - sizeof(msg->hdr));"
    },
    {
        "line": 10,
        "fullcodeline": "msg->client_id = client_id;"
    },
    {
        "line": 11,
        "fullcodeline": "msg->function = GUEST_PROP_FN_GET_PROP;"
    },
    {
        "line": 12,
        "fullcodeline": "msg->timeout_ms = -1;  // inf"
    },
    {
        "line": 13,
        "fullcodeline": "msg->interruptible = 1;"
    },
    {
        "line": 14,
        "fullcodeline": "msg->parm_count = 4;"
    },
    {
        "line": 18,
        "fullcodeline": "struct vmmdev_hgcm_function_parameter64 *params = (void *) (msg + 1);"
    },
    {
        "line": 20,
        "fullcodeline": "params[0].type = VMMDEV_HGCM_PARM_TYPE_LINADDR_IN;"
    },
    {
        "line": 21,
        "fullcodeline": "params[0].u.pointer.size = strlen(name) + 1;"
    },
    {
        "line": 22,
        "fullcodeline": "params[0].u.pointer.u.linear_addr = (uintptr_t) name;"
    },
    {
        "line": 24,
        "fullcodeline": "params[1].type = VMMDEV_HGCM_PARM_TYPE_LINADDR;"
    },
    {
        "line": 25,
        "fullcodeline": "params[1].u.pointer.size = 1;"
    },
    {
        "line": 26,
        "fullcodeline": "params[1].u.pointer.u.linear_addr = (uintptr_t) &ch;"
    },
    {
        "line": 28,
        "fullcodeline": "params[2].type = VMMDEV_HGCM_PARM_TYPE_64BIT;"
    },
    {
        "line": 30,
        "fullcodeline": "params[3].type = VMMDEV_HGCM_PARM_TYPE_32BIT;"
    },
    {
        "line": 33,
        "fullcodeline": "if (ioctl(fd, VBG_IOCTL_HGCM_CALL_64(msg_size), msg)) {"
    },
    {
        "line": 42,
        "fullcodeline": "void _cleanup_free_ *buf = malloc(buf_size);"
    },
    {
        "line": 43,
        "fullcodeline": "params[1].u.pointer.size = buf_size;"
    },
    {
        "line": 44,
        "fullcodeline": "params[1].u.pointer.u.linear_addr = (uintptr_t) buf;"
    },
    {
        "line": 53,
        "fullcodeline": "*value = buf;"
    },
    {
        "line": 54,
        "fullcodeline": "buf = NULL;"
    },
    {
        "line": 55,
        "fullcodeline": "*size = buf_size;"
    },
    {
        "line": 58,
        "fullcodeline": "*value = NULL;"
    },
    {
        "line": 59,
        "fullcodeline": "*size = 0;"
    },
    {
        "line": 47,
        "fullcodeline": "if (ioctl(fd, VBG_IOCTL_HGCM_CALL_64(msg_size), msg)) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (msg->hdr.rc != VINF_SUCCESS) {"
    }
]