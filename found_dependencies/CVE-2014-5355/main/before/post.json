[
    {
        "line": 6,
        "fullcodeline": "int sock = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "krb5_auth_context auth_context = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "freopen(\"/tmp/uu-server.log\", \"w\", stderr);"
    },
    {
        "line": 20,
        "fullcodeline": "retval = krb5_init_context(&context);"
    },
    {
        "line": 73,
        "fullcodeline": "retval = krb5_read_message(context, (krb5_pointer) &sock, &pname_data);"
    },
    {
        "line": 79,
        "fullcodeline": "retval = krb5_read_message(context, (krb5_pointer) &sock, &tkt_data);"
    },
    {
        "line": 85,
        "fullcodeline": "retval = krb5_cc_default(context, &cc);"
    },
    {
        "line": 91,
        "fullcodeline": "memset (&creds, 0, sizeof(creds));"
    },
    {
        "line": 92,
        "fullcodeline": "retval = krb5_cc_get_principal(context, cc, &creds.client);"
    },
    {
        "line": 99,
        "fullcodeline": "printf (\"uu-server: client principal is \\\"%s\\\".\\n\", pname_data.data);"
    },
    {
        "line": 101,
        "fullcodeline": "retval = krb5_parse_name(context, pname_data.data, &creds.server);"
    },
    {
        "line": 107,
        "fullcodeline": "creds.second_ticket = tkt_data;"
    },
    {
        "line": 108,
        "fullcodeline": "printf (\"uu-server: client ticket is %d bytes.\\n\","
    },
    {
        "line": 111,
        "fullcodeline": "retval = krb5_get_credentials(context, KRB5_GC_USER_USER, cc,"
    },
    {
        "line": 136,
        "fullcodeline": "retval = krb5_auth_con_init(context, &auth_context);"
    },
    {
        "line": 142,
        "fullcodeline": "retval = krb5_auth_con_setflags(context, auth_context,"
    },
    {
        "line": 149,
        "fullcodeline": "retval ="
    },
    {
        "line": 159,
        "fullcodeline": "retval = krb5_mk_req_extended(context, &auth_context,"
    },
    {
        "line": 166,
        "fullcodeline": "retval = krb5_write_message(context, (krb5_pointer) &sock, &msg);"
    },
    {
        "line": 176,
        "fullcodeline": "free(msg.data);"
    },
    {
        "line": 178,
        "fullcodeline": "msgtext.length = 32;"
    },
    {
        "line": 179,
        "fullcodeline": "msgtext.data = \"Hello, other end of connection.\";"
    },
    {
        "line": 181,
        "fullcodeline": "retval = krb5_mk_safe(context, auth_context, &msgtext, &msg, NULL);"
    },
    {
        "line": 187,
        "fullcodeline": "retval = krb5_write_message(context, (krb5_pointer) &sock, &msg);"
    },
    {
        "line": 195,
        "fullcodeline": "krb5_free_data_contents(context, &msg);"
    },
    {
        "line": 196,
        "fullcodeline": "krb5_free_data_contents(context, &pname_data);"
    },
    {
        "line": 198,
        "fullcodeline": "krb5_free_cred_contents(context, &creds);"
    },
    {
        "line": 199,
        "fullcodeline": "krb5_free_creds(context, new_creds);"
    },
    {
        "line": 200,
        "fullcodeline": "krb5_cc_close(context, cc);"
    },
    {
        "line": 201,
        "fullcodeline": "krb5_auth_con_free(context, auth_context);"
    },
    {
        "line": 202,
        "fullcodeline": "krb5_free_context(context);"
    },
    {
        "line": 120,
        "fullcodeline": "if (getpeername(0, (struct sockaddr *)&f_inaddr, &l) == -1)"
    },
    {
        "line": 127,
        "fullcodeline": "if (getsockname(0, (struct sockaddr *)&l_inaddr, &l) == -1)"
    },
    {
        "line": 150,
        "fullcodeline": "krb5_auth_con_genaddrs(context, auth_context, sock,"
    },
    {
        "line": 22,
        "fullcodeline": "com_err(argv[0], retval, \"while initializing krb5\");"
    },
    {
        "line": 23,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 75,
        "fullcodeline": "com_err (\"uu-server\", retval, \"reading pname\");"
    },
    {
        "line": 81,
        "fullcodeline": "com_err (\"uu-server\", retval, \"reading ticket data\");"
    },
    {
        "line": 87,
        "fullcodeline": "com_err(\"uu-server\", retval, \"getting credentials cache\");"
    },
    {
        "line": 94,
        "fullcodeline": "com_err(\"uu-client\", retval, \"getting principal name\");"
    },
    {
        "line": 103,
        "fullcodeline": "com_err(\"uu-server\", retval, \"parsing client name\");"
    },
    {
        "line": 114,
        "fullcodeline": "com_err(\"uu-server\", retval, \"getting user-user ticket\");"
    },
    {
        "line": 122,
        "fullcodeline": "com_err(\"uu-server\", errno, \"getting client address\");"
    },
    {
        "line": 129,
        "fullcodeline": "com_err(\"uu-server\", errno, \"getting local address\");"
    },
    {
        "line": 138,
        "fullcodeline": "com_err(\"uu-server\", retval, \"making auth_context\");"
    },
    {
        "line": 145,
        "fullcodeline": "com_err(\"uu-server\", retval, \"initializing the auth_context flags\");"
    },
    {
        "line": 151,
        "fullcodeline": "KRB5_AUTH_CONTEXT_GENERATE_LOCAL_FULL_ADDR |"
    },
    {
        "line": 154,
        "fullcodeline": "com_err(\"uu-server\", retval, \"generating addrs for auth_context\");"
    },
    {
        "line": 163,
        "fullcodeline": "com_err(\"uu-server\", retval, \"making AP_REQ\");"
    },
    {
        "line": 183,
        "fullcodeline": "com_err(\"uu-server\", retval, \"encoding message to client\");"
    },
    {
        "line": 190,
        "fullcodeline": "com_err(\"uu-server\", retval, \"writing message to client\");"
    }
]