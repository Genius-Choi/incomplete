[
    {
        "line": 6,
        "fullcodeline": "int sock = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "krb5_auth_context auth_context = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "freopen(\"/tmp/uu-server.log\", \"w\", stderr);"
    },
    {
        "line": 20,
        "fullcodeline": "retval = krb5_init_context(&context);"
    },
    {
        "line": 74,
        "fullcodeline": "retval = krb5_read_message(context, (krb5_pointer) &sock, &pname_data);"
    },
    {
        "line": 81,
        "fullcodeline": "retval = krb5_read_message(context, (krb5_pointer) &sock, &tkt_data);"
    },
    {
        "line": 87,
        "fullcodeline": "retval = krb5_cc_default(context, &cc);"
    },
    {
        "line": 93,
        "fullcodeline": "memset (&creds, 0, sizeof(creds));"
    },
    {
        "line": 94,
        "fullcodeline": "retval = krb5_cc_get_principal(context, cc, &creds.client);"
    },
    {
        "line": 101,
        "fullcodeline": "printf (\"uu-server: client principal is \\\"%s\\\".\\n\", pname_data.data);"
    },
    {
        "line": 103,
        "fullcodeline": "retval = krb5_parse_name(context, pname_data.data, &creds.server);"
    },
    {
        "line": 109,
        "fullcodeline": "creds.second_ticket = tkt_data;"
    },
    {
        "line": 113,
        "fullcodeline": "retval = krb5_get_credentials(context, KRB5_GC_USER_USER, cc,"
    },
    {
        "line": 121,
        "fullcodeline": "l = sizeof(f_inaddr);"
    },
    {
        "line": 128,
        "fullcodeline": "l = sizeof(l_inaddr);"
    },
    {
        "line": 138,
        "fullcodeline": "retval = krb5_auth_con_init(context, &auth_context);"
    },
    {
        "line": 144,
        "fullcodeline": "retval = krb5_auth_con_setflags(context, auth_context,"
    },
    {
        "line": 151,
        "fullcodeline": "retval ="
    },
    {
        "line": 161,
        "fullcodeline": "retval = krb5_mk_req_extended(context, &auth_context,"
    },
    {
        "line": 168,
        "fullcodeline": "retval = krb5_write_message(context, (krb5_pointer) &sock, &msg);"
    },
    {
        "line": 178,
        "fullcodeline": "free(msg.data);"
    },
    {
        "line": 180,
        "fullcodeline": "msgtext.length = 32;"
    },
    {
        "line": 181,
        "fullcodeline": "msgtext.data = \"Hello, other end of connection.\";"
    },
    {
        "line": 183,
        "fullcodeline": "retval = krb5_mk_safe(context, auth_context, &msgtext, &msg, NULL);"
    },
    {
        "line": 189,
        "fullcodeline": "retval = krb5_write_message(context, (krb5_pointer) &sock, &msg);"
    },
    {
        "line": 197,
        "fullcodeline": "krb5_free_data_contents(context, &msg);"
    },
    {
        "line": 198,
        "fullcodeline": "krb5_free_data_contents(context, &pname_data);"
    },
    {
        "line": 200,
        "fullcodeline": "krb5_free_cred_contents(context, &creds);"
    },
    {
        "line": 201,
        "fullcodeline": "krb5_free_creds(context, new_creds);"
    },
    {
        "line": 202,
        "fullcodeline": "krb5_cc_close(context, cc);"
    },
    {
        "line": 203,
        "fullcodeline": "krb5_auth_con_free(context, auth_context);"
    },
    {
        "line": 75,
        "fullcodeline": "if (retval || pname_data.length == 0 ||"
    },
    {
        "line": 152,
        "fullcodeline": "krb5_auth_con_genaddrs(context, auth_context, sock,"
    },
    {
        "line": 22,
        "fullcodeline": "com_err(argv[0], retval, \"while initializing krb5\");"
    },
    {
        "line": 76,
        "fullcodeline": "pname_data.data[pname_data.length - 1] != '\\0') {"
    },
    {
        "line": 77,
        "fullcodeline": "com_err (\"uu-server\", retval, \"reading pname\");"
    },
    {
        "line": 122,
        "fullcodeline": "if (getpeername(0, (struct sockaddr *)&f_inaddr, &l) == -1)"
    },
    {
        "line": 129,
        "fullcodeline": "if (getsockname(0, (struct sockaddr *)&l_inaddr, &l) == -1)"
    },
    {
        "line": 153,
        "fullcodeline": "KRB5_AUTH_CONTEXT_GENERATE_LOCAL_FULL_ADDR |"
    }
]