[
    {
        "line": 14,
        "fullcodeline": "krb5_flags            ap_option = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "krb5_rcache           rcache = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "int                   need_error_free = 0;"
    },
    {
        "line": 23,
        "fullcodeline": "int                   local_rcache = 0, local_authcon = 0;"
    },
    {
        "line": 31,
        "fullcodeline": "problem = 0;"
    },
    {
        "line": 32,
        "fullcodeline": "response = 0;"
    },
    {
        "line": 92,
        "fullcodeline": "krb5_auth_con_getrcache(context, *auth_context, &rcache);"
    },
    {
        "line": 158,
        "fullcodeline": "retval = krb5_write_message(context, fd, &outbuf);"
    },
    {
        "line": 34,
        "fullcodeline": "if (!(flags & KRB5_RECVAUTH_SKIP_VERSION)) {"
    },
    {
        "line": 47,
        "fullcodeline": "if (flags & KRB5_RECVAUTH_BADAUTHVERS) {"
    },
    {
        "line": 55,
        "fullcodeline": "if ((retval = krb5_read_message(context, fd, &inbuf)))"
    },
    {
        "line": 57,
        "fullcodeline": "if (appl_version != NULL && !problem) {"
    },
    {
        "line": 84,
        "fullcodeline": "if ((retval = krb5_read_message(context, fd, &inbuf)))"
    },
    {
        "line": 87,
        "fullcodeline": "if (*auth_context == NULL) {"
    },
    {
        "line": 109,
        "fullcodeline": "if (!problem) {"
    },
    {
        "line": 169,
        "fullcodeline": "if ((ap_option & AP_OPTS_MUTUAL_REQUIRED)) {"
    },
    {
        "line": 40,
        "fullcodeline": "d = make_data((char *)sendauth_version, strlen(sendauth_version) + 1);"
    },
    {
        "line": 45,
        "fullcodeline": "free(inbuf.data);"
    },
    {
        "line": 48,
        "fullcodeline": "problem = KRB5_SENDAUTH_BADAUTHVERS;"
    },
    {
        "line": 49,
        "fullcodeline": "response = 1;"
    },
    {
        "line": 58,
        "fullcodeline": "d = make_data(appl_version, strlen(appl_version) + 1);"
    },
    {
        "line": 64,
        "fullcodeline": "if (version && !problem)"
    },
    {
        "line": 73,
        "fullcodeline": "if ((krb5_net_write(context, *((int *)fd), (char *)&response, 1)) < 0) {"
    },
    {
        "line": 88,
        "fullcodeline": "problem = krb5_auth_con_init(context, &new_auth_context);"
    },
    {
        "line": 89,
        "fullcodeline": "*auth_context = new_auth_context;"
    },
    {
        "line": 93,
        "fullcodeline": "if ((!problem) && rcache == NULL) {"
    },
    {
        "line": 107,
        "fullcodeline": "local_rcache = 1;"
    },
    {
        "line": 110,
        "fullcodeline": "problem = krb5_rd_req(context, auth_context, &inbuf, server,"
    },
    {
        "line": 124,
        "fullcodeline": "memset(&error, 0, sizeof(error));"
    },
    {
        "line": 125,
        "fullcodeline": "krb5_us_timeofday(context, &error.stime, &error.susec);"
    },
    {
        "line": 135,
        "fullcodeline": "error.error = problem - ERROR_TABLE_BASE_krb5;"
    },
    {
        "line": 138,
        "fullcodeline": "message = error_message(problem);"
    },
    {
        "line": 140,
        "fullcodeline": "error.text.data = strdup(message);"
    },
    {
        "line": 162,
        "fullcodeline": "retval = problem;"
    },
    {
        "line": 173,
        "fullcodeline": "retval = krb5_write_message(context, fd, &outbuf);"
    },
    {
        "line": 38,
        "fullcodeline": "if ((retval = krb5_read_message(context, fd, &inbuf)))"
    },
    {
        "line": 67,
        "fullcodeline": "free(inbuf.data);"
    },
    {
        "line": 105,
        "fullcodeline": "if (!problem)"
    },
    {
        "line": 136,
        "fullcodeline": "if (error.error > 127)"
    },
    {
        "line": 141,
        "fullcodeline": "if (!error.text.data) {"
    },
    {
        "line": 145,
        "fullcodeline": "if ((retval = krb5_mk_error(context, &error, &outbuf))) {"
    },
    {
        "line": 154,
        "fullcodeline": "outbuf.length = 0;"
    },
    {
        "line": 155,
        "fullcodeline": "outbuf.data = 0;"
    },
    {
        "line": 170,
        "fullcodeline": "if ((retval = krb5_mk_rep(context, *auth_context, &outbuf))) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (!data_eq(inbuf, d)) {"
    },
    {
        "line": 42,
        "fullcodeline": "problem = KRB5_SENDAUTH_BADAUTHVERS;"
    },
    {
        "line": 43,
        "fullcodeline": "response = 1;"
    },
    {
        "line": 59,
        "fullcodeline": "if (!data_eq(inbuf, d)) {"
    },
    {
        "line": 60,
        "fullcodeline": "problem = KRB5_SENDAUTH_BADAPPLVERS;"
    },
    {
        "line": 61,
        "fullcodeline": "response = 2;"
    },
    {
        "line": 97,
        "fullcodeline": "if (server != NULL && server->length > 0) {"
    },
    {
        "line": 98,
        "fullcodeline": "problem = krb5_get_server_rcache(context, &server->data[0],"
    },
    {
        "line": 106,
        "fullcodeline": "problem = krb5_auth_con_setrcache(context, *auth_context, rcache);"
    },
    {
        "line": 127,
        "fullcodeline": "error.server = server;"
    },
    {
        "line": 137,
        "fullcodeline": "error.error = KRB_ERR_GENERIC;"
    },
    {
        "line": 139,
        "fullcodeline": "error.text.length  = strlen(message) + 1;"
    },
    {
        "line": 142,
        "fullcodeline": "retval = ENOMEM;"
    },
    {
        "line": 151,
        "fullcodeline": "krb5_free_principal(context, error.server);"
    },
    {
        "line": 101,
        "fullcodeline": "null_server.length = 7;"
    },
    {
        "line": 102,
        "fullcodeline": "null_server.data = \"default\";"
    },
    {
        "line": 103,
        "fullcodeline": "problem = krb5_get_server_rcache(context, &null_server, &rcache);"
    },
    {
        "line": 131,
        "fullcodeline": "(void) krb5_parse_name(context, \"????\", &error.server);"
    },
    {
        "line": 181,
        "fullcodeline": "} else if (local_rcache && rcache != NULL) {"
    },
    {
        "line": 182,
        "fullcodeline": "krb5_rc_close(context, rcache);"
    }
]