[
    {
        "line": 14,
        "fullcodeline": "krb5_flags            ap_option = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "krb5_rcache           rcache = 0;"
    },
    {
        "line": 21,
        "fullcodeline": "int                   need_error_free = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "int                   local_rcache = 0, local_authcon = 0;"
    },
    {
        "line": 30,
        "fullcodeline": "problem = 0;"
    },
    {
        "line": 31,
        "fullcodeline": "response = 0;"
    },
    {
        "line": 89,
        "fullcodeline": "krb5_auth_con_getrcache(context, *auth_context, &rcache);"
    },
    {
        "line": 155,
        "fullcodeline": "retval = krb5_write_message(context, fd, &outbuf);"
    },
    {
        "line": 33,
        "fullcodeline": "if (!(flags & KRB5_RECVAUTH_SKIP_VERSION)) {"
    },
    {
        "line": 45,
        "fullcodeline": "if (flags & KRB5_RECVAUTH_BADAUTHVERS) {"
    },
    {
        "line": 53,
        "fullcodeline": "if ((retval = krb5_read_message(context, fd, &inbuf)))"
    },
    {
        "line": 81,
        "fullcodeline": "if ((retval = krb5_read_message(context, fd, &inbuf)))"
    },
    {
        "line": 84,
        "fullcodeline": "if (*auth_context == NULL) {"
    },
    {
        "line": 106,
        "fullcodeline": "if (!problem) {"
    },
    {
        "line": 166,
        "fullcodeline": "if ((ap_option & AP_OPTS_MUTUAL_REQUIRED)) {"
    },
    {
        "line": 43,
        "fullcodeline": "free(inbuf.data);"
    },
    {
        "line": 46,
        "fullcodeline": "problem = KRB5_SENDAUTH_BADAUTHVERS;"
    },
    {
        "line": 47,
        "fullcodeline": "response = 1;"
    },
    {
        "line": 55,
        "fullcodeline": "if (appl_version && strcmp(inbuf.data, appl_version)) {"
    },
    {
        "line": 61,
        "fullcodeline": "if (version && !problem)"
    },
    {
        "line": 70,
        "fullcodeline": "if ((krb5_net_write(context, *((int *)fd), (char *)&response, 1)) < 0) {"
    },
    {
        "line": 85,
        "fullcodeline": "problem = krb5_auth_con_init(context, &new_auth_context);"
    },
    {
        "line": 86,
        "fullcodeline": "*auth_context = new_auth_context;"
    },
    {
        "line": 90,
        "fullcodeline": "if ((!problem) && rcache == NULL) {"
    },
    {
        "line": 104,
        "fullcodeline": "local_rcache = 1;"
    },
    {
        "line": 107,
        "fullcodeline": "problem = krb5_rd_req(context, auth_context, &inbuf, server,"
    },
    {
        "line": 121,
        "fullcodeline": "memset(&error, 0, sizeof(error));"
    },
    {
        "line": 122,
        "fullcodeline": "krb5_us_timeofday(context, &error.stime, &error.susec);"
    },
    {
        "line": 132,
        "fullcodeline": "error.error = problem - ERROR_TABLE_BASE_krb5;"
    },
    {
        "line": 135,
        "fullcodeline": "message = error_message(problem);"
    },
    {
        "line": 137,
        "fullcodeline": "error.text.data = strdup(message);"
    },
    {
        "line": 159,
        "fullcodeline": "retval = problem;"
    },
    {
        "line": 170,
        "fullcodeline": "retval = krb5_write_message(context, fd, &outbuf);"
    },
    {
        "line": 37,
        "fullcodeline": "if ((retval = krb5_read_message(context, fd, &inbuf)))"
    },
    {
        "line": 39,
        "fullcodeline": "if (strcmp(inbuf.data, sendauth_version)) {"
    },
    {
        "line": 56,
        "fullcodeline": "if (!problem) {"
    },
    {
        "line": 64,
        "fullcodeline": "free(inbuf.data);"
    },
    {
        "line": 102,
        "fullcodeline": "if (!problem)"
    },
    {
        "line": 133,
        "fullcodeline": "if (error.error > 127)"
    },
    {
        "line": 138,
        "fullcodeline": "if (!error.text.data) {"
    },
    {
        "line": 142,
        "fullcodeline": "if ((retval = krb5_mk_error(context, &error, &outbuf))) {"
    },
    {
        "line": 151,
        "fullcodeline": "outbuf.length = 0;"
    },
    {
        "line": 152,
        "fullcodeline": "outbuf.data = 0;"
    },
    {
        "line": 167,
        "fullcodeline": "if ((retval = krb5_mk_rep(context, *auth_context, &outbuf))) {"
    },
    {
        "line": 40,
        "fullcodeline": "problem = KRB5_SENDAUTH_BADAUTHVERS;"
    },
    {
        "line": 41,
        "fullcodeline": "response = 1;"
    },
    {
        "line": 57,
        "fullcodeline": "problem = KRB5_SENDAUTH_BADAPPLVERS;"
    },
    {
        "line": 58,
        "fullcodeline": "response = 2;"
    },
    {
        "line": 94,
        "fullcodeline": "if (server != NULL && server->length > 0) {"
    },
    {
        "line": 95,
        "fullcodeline": "problem = krb5_get_server_rcache(context, &server->data[0],"
    },
    {
        "line": 103,
        "fullcodeline": "problem = krb5_auth_con_setrcache(context, *auth_context, rcache);"
    },
    {
        "line": 124,
        "fullcodeline": "error.server = server;"
    },
    {
        "line": 134,
        "fullcodeline": "error.error = KRB_ERR_GENERIC;"
    },
    {
        "line": 136,
        "fullcodeline": "error.text.length  = strlen(message) + 1;"
    },
    {
        "line": 139,
        "fullcodeline": "retval = ENOMEM;"
    },
    {
        "line": 148,
        "fullcodeline": "krb5_free_principal(context, error.server);"
    },
    {
        "line": 98,
        "fullcodeline": "null_server.length = 7;"
    },
    {
        "line": 99,
        "fullcodeline": "null_server.data = \"default\";"
    },
    {
        "line": 100,
        "fullcodeline": "problem = krb5_get_server_rcache(context, &null_server, &rcache);"
    },
    {
        "line": 128,
        "fullcodeline": "(void) krb5_parse_name(context, \"????\", &error.server);"
    },
    {
        "line": 178,
        "fullcodeline": "} else if (local_rcache && rcache != NULL) {"
    },
    {
        "line": 179,
        "fullcodeline": "krb5_rc_close(context, rcache);"
    }
]