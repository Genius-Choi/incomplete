[
    {
        "line": 3,
        "fullcodeline": "char md5[MD5_PASSWD_LEN + 1];"
    },
    {
        "line": 5,
        "fullcodeline": "PgUser *user = client->auth_user;"
    },
    {
        "line": 8,
        "fullcodeline": "if (!user) {"
    },
    {
        "line": 9,
        "fullcodeline": "slog_error(client, \"Password packet before auth packet?\");"
    },
    {
        "line": 14,
        "fullcodeline": "if (!*passwd || !*user->passwd)"
    },
    {
        "line": 21,
        "fullcodeline": "correct = crypt(user->passwd, (char *)client->tmp_login_salt);"
    },
    {
        "line": 28,
        "fullcodeline": "pg_md5_encrypt(user->passwd + 3, (char *)client->tmp_login_salt, 4, md5);"
    },
    {
        "line": 19,
        "fullcodeline": "return strcmp(user->passwd, passwd) == 0;"
    },
    {
        "line": 22,
        "fullcodeline": "return correct && strcmp(correct, passwd) == 0;"
    },
    {
        "line": 29,
        "fullcodeline": "return strcmp(md5, passwd) == 0;"
    },
    {
        "line": 24,
        "fullcodeline": "if (strlen(passwd) != MD5_PASSWD_LEN)"
    },
    {
        "line": 26,
        "fullcodeline": "if (!isMD5(user->passwd))"
    },
    {
        "line": 27,
        "fullcodeline": "pg_md5_encrypt(user->passwd, user->name, strlen(user->name), user->passwd);"
    }
]