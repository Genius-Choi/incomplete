[
    {
        "line": 3,
        "fullcodeline": "int x, y = 0, l = (int)strlen(str);"
    },
    {
        "line": 5,
        "fullcodeline": "size_t estimate = (4 * l) + 3;"
    },
    {
        "line": 8,
        "fullcodeline": "cmd = zend_string_safe_alloc(4, l, 2, 0); /* worst case */"
    },
    {
        "line": 13,
        "fullcodeline": "ZSTR_VAL(cmd)[y++] = '\\'';"
    },
    {
        "line": 58,
        "fullcodeline": "ZSTR_VAL(cmd)[y++] = '\\'';"
    },
    {
        "line": 60,
        "fullcodeline": "ZSTR_VAL(cmd)[y] = '\\0';"
    },
    {
        "line": 67,
        "fullcodeline": "ZSTR_LEN(cmd) = y;"
    },
    {
        "line": 16,
        "fullcodeline": "for (x = 0; x < l; x++) {"
    },
    {
        "line": 62,
        "fullcodeline": "if ((estimate - y) > 4096) {"
    },
    {
        "line": 17,
        "fullcodeline": "int mb_len = php_mblen(str + x, (l - x));"
    },
    {
        "line": 65,
        "fullcodeline": "cmd = zend_string_truncate(cmd, y, 0);"
    },
    {
        "line": 20,
        "fullcodeline": "if (mb_len < 0) {"
    },
    {
        "line": 39,
        "fullcodeline": "ZSTR_VAL(cmd)[y++] = '\\\\';"
    },
    {
        "line": 44,
        "fullcodeline": "ZSTR_VAL(cmd)[y++] = str[x];"
    },
    {
        "line": 22,
        "fullcodeline": "} else if (mb_len > 1) {"
    },
    {
        "line": 38,
        "fullcodeline": "ZSTR_VAL(cmd)[y++] = '\\'';"
    },
    {
        "line": 40,
        "fullcodeline": "ZSTR_VAL(cmd)[y++] = '\\'';"
    },
    {
        "line": 23,
        "fullcodeline": "memcpy(ZSTR_VAL(cmd) + y, str + x, mb_len);"
    },
    {
        "line": 24,
        "fullcodeline": "y += mb_len;"
    },
    {
        "line": 25,
        "fullcodeline": "x += mb_len - 1;"
    }
]