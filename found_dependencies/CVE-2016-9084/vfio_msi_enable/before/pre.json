[
    {
        "line": 3,
        "fullcodeline": "struct pci_dev *pdev = vdev->pdev;"
    },
    {
        "line": 4,
        "fullcodeline": "unsigned int flag = msix ? PCI_IRQ_MSIX : PCI_IRQ_MSI;"
    },
    {
        "line": 10,
        "fullcodeline": "vdev->ctx = kzalloc(nvec * sizeof(struct vfio_pci_irq_ctx), GFP_KERNEL);"
    },
    {
        "line": 15,
        "fullcodeline": "ret = pci_alloc_irq_vectors(pdev, 1, nvec, flag);"
    },
    {
        "line": 7,
        "fullcodeline": "if (!is_irq_none(vdev))"
    },
    {
        "line": 11,
        "fullcodeline": "if (!vdev->ctx)"
    },
    {
        "line": 16,
        "fullcodeline": "if (ret < nvec) {"
    },
    {
        "line": 24,
        "fullcodeline": "vdev->irq_type = msix ? VFIO_PCI_MSIX_IRQ_INDEX :"
    },
    {
        "line": 8,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 12,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 17,
        "fullcodeline": "if (ret > 0)"
    },
    {
        "line": 32,
        "fullcodeline": "vdev->msi_qmax = fls(nvec * 2 - 1) - 1;"
    }
]