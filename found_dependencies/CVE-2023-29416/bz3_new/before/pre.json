[
    {
        "line": 6,
        "fullcodeline": "struct bz3_state * bz3_state = malloc(sizeof(struct bz3_state));"
    },
    {
        "line": 12,
        "fullcodeline": "bz3_state->cm_state = malloc(sizeof(state));"
    },
    {
        "line": 14,
        "fullcodeline": "bz3_state->swap_buffer = malloc(bz3_bound(block_size));"
    },
    {
        "line": 15,
        "fullcodeline": "bz3_state->sais_array = malloc((block_size + 128) * sizeof(s32));"
    },
    {
        "line": 16,
        "fullcodeline": "memset(bz3_state->sais_array, 0, sizeof(s32) * (block_size + 128));"
    },
    {
        "line": 18,
        "fullcodeline": "bz3_state->lzp_lut = calloc(1 << LZP_DICTIONARY, sizeof(s32));"
    },
    {
        "line": 29,
        "fullcodeline": "bz3_state->block_size = block_size;"
    },
    {
        "line": 31,
        "fullcodeline": "bz3_state->last_error = BZ3_OK;"
    },
    {
        "line": 2,
        "fullcodeline": "if (block_size < KiB(65) || block_size > MiB(511)) {"
    },
    {
        "line": 8,
        "fullcodeline": "if (!bz3_state) {"
    },
    {
        "line": 20,
        "fullcodeline": "if (!bz3_state->cm_state || !bz3_state->swap_buffer || !bz3_state->sais_array || !bz3_state->lzp_lut) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (bz3_state->cm_state) free(bz3_state->cm_state);"
    },
    {
        "line": 22,
        "fullcodeline": "if (bz3_state->swap_buffer) free(bz3_state->swap_buffer);"
    },
    {
        "line": 23,
        "fullcodeline": "if (bz3_state->sais_array) free(bz3_state->sais_array);"
    },
    {
        "line": 24,
        "fullcodeline": "if (bz3_state->lzp_lut) free(bz3_state->lzp_lut);"
    }
]