[
    {
        "line": 6,
        "fullcodeline": "signed char seen_r = 0;"
    },
    {
        "line": 15,
        "fullcodeline": "pfd.fd = clientfd;"
    },
    {
        "line": 19,
        "fullcodeline": "pfd.events = POLLIN | POLLPRI | POLLERR | POLLHUP;"
    },
    {
        "line": 96,
        "fullcodeline": "die(421, LOG_WARNING, MSG_LINE_TOO_LONG);   /* don't remove this */"
    },
    {
        "line": 10,
        "fullcodeline": "if (scanned > (size_t) 0U) {       /* support pipelining */"
    },
    {
        "line": 21,
        "fullcodeline": "while (scanned < cmdsize) {"
    },
    {
        "line": 11,
        "fullcodeline": "readnbd -= scanned;"
    },
    {
        "line": 12,
        "fullcodeline": "memmove(cmd, cmd + scanned, readnbd);   /* safe */"
    },
    {
        "line": 13,
        "fullcodeline": "scanned = (size_t) 0U;"
    },
    {
        "line": 77,
        "fullcodeline": "seen_r = 0;"
    },
    {
        "line": 94,
        "fullcodeline": "scanned++;"
    },
    {
        "line": 22,
        "fullcodeline": "if (scanned >= readnbd) {      /* nothing left in the buffer */"
    },
    {
        "line": 62,
        "fullcodeline": "if (cmd[scanned] == '\\n') {"
    },
    {
        "line": 81,
        "fullcodeline": "if (ISCTRLCODE(cmd[scanned])) {"
    },
    {
        "line": 23,
        "fullcodeline": "pfd.revents = 0;"
    },
    {
        "line": 54,
        "fullcodeline": "readnbd += readnb;"
    },
    {
        "line": 91,
        "fullcodeline": "cmd[scanned] = '_';"
    },
    {
        "line": 24,
        "fullcodeline": "while ((pollret = poll(&pfd, 1U, idletime * 1000UL)) < 0 &&"
    },
    {
        "line": 26,
        "fullcodeline": "if (pollret == 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (pollret <= 0 ||"
    },
    {
        "line": 33,
        "fullcodeline": "if ((pfd.revents & (POLLIN | POLLPRI)) == 0) {"
    },
    {
        "line": 36,
        "fullcodeline": "if (readnbd >= cmdsize) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (readnb <= (ssize_t) 0) {"
    },
    {
        "line": 55,
        "fullcodeline": "if (readnbd > cmdsize) {"
    },
    {
        "line": 82,
        "fullcodeline": "if (cmd[scanned] == '\\r') {"
    },
    {
        "line": 25,
        "fullcodeline": "errno == EINTR);"
    },
    {
        "line": 30,
        "fullcodeline": "(pfd.revents & (POLLERR | POLLHUP | POLLNVAL)) != 0) {"
    },
    {
        "line": 47,
        "fullcodeline": "while ((readnb = read(clientfd, cmd + readnbd,"
    },
    {
        "line": 72,
        "fullcodeline": "if (++scanned >= readnbd) {   /* non-pipelined command */"
    },
    {
        "line": 83,
        "fullcodeline": "seen_r = 1;"
    },
    {
        "line": 27,
        "fullcodeline": "return -1;"
    },
    {
        "line": 31,
        "fullcodeline": "return -2;"
    },
    {
        "line": 49,
        "fullcodeline": "errno == EINTR);"
    },
    {
        "line": 52,
        "fullcodeline": "return -2;"
    },
    {
        "line": 56,
        "fullcodeline": "return -2;"
    },
    {
        "line": 73,
        "fullcodeline": "scanned = readnbd = (size_t) 0U;"
    },
    {
        "line": 66,
        "fullcodeline": "cmd[scanned - 1U] = 0;"
    },
    {
        "line": 48,
        "fullcodeline": "cmdsize - readnbd)) < (ssize_t) 0 &&"
    }
]