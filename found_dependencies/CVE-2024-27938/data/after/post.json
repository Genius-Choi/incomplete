[
    {
        "line": 7,
        "fullcodeline": "@data = String.new.force_encoding(\"BINARY\")"
    },
    {
        "line": 8,
        "fullcodeline": "@headers = {}"
    },
    {
        "line": 9,
        "fullcodeline": "@receiving_headers = true"
    },
    {
        "line": 11,
        "fullcodeline": "received_header = ReceivedHeader.generate(@credential&.server, @helo_name, @ip_address, :smtp)"
    },
    {
        "line": 14,
        "fullcodeline": "@data << \"Received: #{received_header}\\r\\n\""
    },
    {
        "line": 15,
        "fullcodeline": "@headers[\"received\"] = [received_header]"
    },
    {
        "line": 17,
        "fullcodeline": "handler = proc do |idata|"
    },
    {
        "line": 52,
        "fullcodeline": "@proc = handler"
    },
    {
        "line": 2,
        "fullcodeline": "unless in_state(:rcpt_to_received)"
    },
    {
        "line": 3,
        "fullcodeline": "increment_error_count(\"data-out-of-order\")"
    }
]