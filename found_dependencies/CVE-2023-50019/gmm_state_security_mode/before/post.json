[
    {
        "line": 5,
        "fullcodeline": "amf_ue_t *amf_ue = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "ogs_nas_5gs_message_t *nas_message = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "ogs_assert(s);"
    },
    {
        "line": 10,
        "fullcodeline": "ogs_assert(e);"
    },
    {
        "line": 12,
        "fullcodeline": "amf_sm_debug(e);"
    },
    {
        "line": 14,
        "fullcodeline": "amf_ue = e->amf_ue;"
    },
    {
        "line": 15,
        "fullcodeline": "ogs_assert(amf_ue);"
    },
    {
        "line": 19,
        "fullcodeline": "CLEAR_AMF_UE_TIMER(amf_ue->t3560);"
    },
    {
        "line": 20,
        "fullcodeline": "r = nas_5gs_send_security_mode_command(amf_ue);"
    },
    {
        "line": 21,
        "fullcodeline": "ogs_expect(r == OGS_OK);"
    },
    {
        "line": 22,
        "fullcodeline": "ogs_assert(r != OGS_ERROR);"
    },
    {
        "line": 28,
        "fullcodeline": "ogs_assert(nas_message);"
    },
    {
        "line": 184,
        "fullcodeline": "ogs_error(\"Unknown event[%s]\", amf_event_get_name(e));"
    },
    {
        "line": 34,
        "fullcodeline": "ogs_debug(\"[%s] Security mode complete\", amf_ue->supi);"
    },
    {
        "line": 63,
        "fullcodeline": "CLEAR_AMF_UE_TIMER(amf_ue->t3560);"
    },
    {
        "line": 65,
        "fullcodeline": "gmm_cause = gmm_handle_security_mode_complete("
    },
    {
        "line": 78,
        "fullcodeline": "ogs_kdf_kgnb_and_kn3iwf("
    },
    {
        "line": 81,
        "fullcodeline": "ogs_kdf_nh_gnb(amf_ue->kamf, amf_ue->kgnb, amf_ue->nh);"
    },
    {
        "line": 82,
        "fullcodeline": "amf_ue->nhcc = 1;"
    },
    {
        "line": 84,
        "fullcodeline": "r = amf_ue_sbi_discover_and_send("
    },
    {
        "line": 87,
        "fullcodeline": "ogs_expect(r == OGS_OK);"
    },
    {
        "line": 88,
        "fullcodeline": "ogs_assert(r != OGS_ERROR);"
    },
    {
        "line": 101,
        "fullcodeline": "ogs_warn(\"[%s] Security mode reject : Cause[%d]\","
    },
    {
        "line": 104,
        "fullcodeline": "CLEAR_AMF_UE_TIMER(amf_ue->t3560);"
    },
    {
        "line": 105,
        "fullcodeline": "OGS_FSM_TRAN(s, &gmm_state_exception);"
    },
    {
        "line": 108,
        "fullcodeline": "ogs_warn(\"Registration request\");"
    },
    {
        "line": 109,
        "fullcodeline": "gmm_cause = gmm_handle_registration_request("
    },
    {
        "line": 122,
        "fullcodeline": "r = amf_ue_sbi_discover_and_send("
    },
    {
        "line": 125,
        "fullcodeline": "ogs_expect(r == OGS_OK);"
    },
    {
        "line": 126,
        "fullcodeline": "ogs_assert(r != OGS_ERROR);"
    },
    {
        "line": 128,
        "fullcodeline": "OGS_FSM_TRAN(s, &gmm_state_authentication);"
    },
    {
        "line": 132,
        "fullcodeline": "ogs_info(\"[%s] Service request\", amf_ue->supi);"
    },
    {
        "line": 133,
        "fullcodeline": "r = nas_5gs_send_service_reject(amf_ue,"
    },
    {
        "line": 135,
        "fullcodeline": "ogs_expect(r == OGS_OK);"
    },
    {
        "line": 136,
        "fullcodeline": "ogs_assert(r != OGS_ERROR);"
    },
    {
        "line": 137,
        "fullcodeline": "OGS_FSM_TRAN(s, &gmm_state_exception);"
    },
    {
        "line": 141,
        "fullcodeline": "ogs_warn(\"[%s] 5GMM STATUS : Cause[%d]\","
    },
    {
        "line": 143,
        "fullcodeline": "OGS_FSM_TRAN(s, &gmm_state_exception);"
    },
    {
        "line": 147,
        "fullcodeline": "ogs_warn(\"[%s] Deregistration request\", amf_ue->supi);"
    },
    {
        "line": 149,
        "fullcodeline": "gmm_handle_deregistration_request("
    },
    {
        "line": 151,
        "fullcodeline": "OGS_FSM_TRAN(s, &gmm_state_de_registered);"
    },
    {
        "line": 155,
        "fullcodeline": "ogs_error(\"Unknown message[%d]\", nas_message->gmm.h.message_type);"
    },
    {
        "line": 178,
        "fullcodeline": "ogs_error(\"Unknown timer[%s:%d]\","
    },
    {
        "line": 52,
        "fullcodeline": "if (h.integrity_protected == 0) {"
    },
    {
        "line": 58,
        "fullcodeline": "if (!SECURITY_CONTEXT_IS_VALID(amf_ue)) {"
    },
    {
        "line": 67,
        "fullcodeline": "if (gmm_cause != OGS_5GMM_CAUSE_REQUEST_ACCEPTED) {"
    },
    {
        "line": 90,
        "fullcodeline": "if (amf_ue->nas.message_type == OGS_NAS_5GS_REGISTRATION_REQUEST) {"
    },
    {
        "line": 112,
        "fullcodeline": "if (gmm_cause != OGS_5GMM_CAUSE_REQUEST_ACCEPTED) {"
    },
    {
        "line": 53,
        "fullcodeline": "ogs_error(\"[%s] Security-mode : No Integrity Protected\","
    },
    {
        "line": 59,
        "fullcodeline": "ogs_error(\"[%s] No Security Context\", amf_ue->supi);"
    },
    {
        "line": 68,
        "fullcodeline": "ogs_error(\"[%s] gmm_handle_security_mode_complete() \""
    },
    {
        "line": 71,
        "fullcodeline": "r = nas_5gs_send_gmm_reject(amf_ue, gmm_cause);"
    },
    {
        "line": 72,
        "fullcodeline": "ogs_expect(r == OGS_OK);"
    },
    {
        "line": 73,
        "fullcodeline": "ogs_assert(r != OGS_ERROR);"
    },
    {
        "line": 74,
        "fullcodeline": "OGS_FSM_TRAN(s, gmm_state_exception);"
    },
    {
        "line": 91,
        "fullcodeline": "OGS_FSM_TRAN(s, &gmm_state_initial_context_setup);"
    },
    {
        "line": 113,
        "fullcodeline": "ogs_error(\"[%s] gmm_handle_registration_request() failed [%d]\","
    },
    {
        "line": 115,
        "fullcodeline": "r = nas_5gs_send_registration_reject(amf_ue, gmm_cause);"
    },
    {
        "line": 116,
        "fullcodeline": "ogs_expect(r == OGS_OK);"
    },
    {
        "line": 117,
        "fullcodeline": "ogs_assert(r != OGS_ERROR);"
    },
    {
        "line": 118,
        "fullcodeline": "OGS_FSM_TRAN(s, gmm_state_exception);"
    },
    {
        "line": 164,
        "fullcodeline": "ogs_warn(\"[%s] Retransmission failed. Stop\", amf_ue->supi);"
    },
    {
        "line": 165,
        "fullcodeline": "r = nas_5gs_send_gmm_reject(amf_ue,"
    },
    {
        "line": 167,
        "fullcodeline": "ogs_expect(r == OGS_OK);"
    },
    {
        "line": 168,
        "fullcodeline": "ogs_assert(r != OGS_ERROR);"
    },
    {
        "line": 169,
        "fullcodeline": "OGS_FSM_TRAN(&amf_ue->sm, &gmm_state_exception);"
    },
    {
        "line": 163,
        "fullcodeline": "amf_timer_cfg(AMF_TIMER_T3560)->max_count) {"
    },
    {
        "line": 171,
        "fullcodeline": "amf_ue->t3560.retry_count++;"
    },
    {
        "line": 172,
        "fullcodeline": "r = nas_5gs_send_security_mode_command(amf_ue);"
    },
    {
        "line": 173,
        "fullcodeline": "ogs_expect(r == OGS_OK);"
    },
    {
        "line": 174,
        "fullcodeline": "ogs_assert(r != OGS_ERROR);"
    },
    {
        "line": 92,
        "fullcodeline": "} else if (amf_ue->nas.message_type =="
    },
    {
        "line": 94,
        "fullcodeline": "OGS_FSM_TRAN(s, &gmm_state_registered);"
    },
    {
        "line": 96,
        "fullcodeline": "ogs_fatal(\"Invalid OGS_NAS_5GS[%d]\", amf_ue->nas.message_type);"
    },
    {
        "line": 97,
        "fullcodeline": "ogs_assert_if_reached();"
    }
]