[
    {
        "line": 5,
        "fullcodeline": "uint32_t sp = 0x1234;"
    },
    {
        "line": 6,
        "fullcodeline": "uint32_t r2 = 0, r3 = 1;"
    },
    {
        "line": 9,
        "fullcodeline": "int i, addr=ADDRESS;"
    },
    {
        "line": 11,
        "fullcodeline": "printf(\"Emulate a THUMB ITE block as a whole or per instruction.\\n\");"
    },
    {
        "line": 12,
        "fullcodeline": "err = uc_open(UC_ARCH_ARM, UC_MODE_THUMB, &uc);"
    },
    {
        "line": 19,
        "fullcodeline": "uc_mem_map(uc, ADDRESS, 2 * 1024 * 1024, UC_PROT_ALL);"
    },
    {
        "line": 21,
        "fullcodeline": "uc_mem_write(uc, ADDRESS, ARM_THUM_COND_CODE, sizeof(ARM_THUM_COND_CODE) - 1);"
    },
    {
        "line": 23,
        "fullcodeline": "uc_reg_write(uc, UC_ARM_REG_SP, &sp);"
    },
    {
        "line": 25,
        "fullcodeline": "uc_reg_write(uc, UC_ARM_REG_R2, &r2);"
    },
    {
        "line": 26,
        "fullcodeline": "uc_reg_write(uc, UC_ARM_REG_R3, &r3);"
    },
    {
        "line": 29,
        "fullcodeline": "printf(\"Running the entire binary.\\n\");"
    },
    {
        "line": 30,
        "fullcodeline": "err = uc_emu_start(uc, ADDRESS | 1, ADDRESS + sizeof(ARM_THUM_COND_CODE) - 1, 0, 0);"
    },
    {
        "line": 34,
        "fullcodeline": "uc_reg_read(uc, UC_ARM_REG_R2, &r2);"
    },
    {
        "line": 35,
        "fullcodeline": "uc_reg_read(uc, UC_ARM_REG_R3, &r3);"
    },
    {
        "line": 37,
        "fullcodeline": "printf(\">>> R2: %d\\n\", r2);"
    },
    {
        "line": 38,
        "fullcodeline": "printf(\">>> R3: %d\\n\\n\", r3);"
    },
    {
        "line": 41,
        "fullcodeline": "printf(\"Running the binary one instruction at a time.\\n\");"
    },
    {
        "line": 50,
        "fullcodeline": "uc_reg_read(uc, UC_ARM_REG_R2, &step_r2);"
    },
    {
        "line": 51,
        "fullcodeline": "uc_reg_read(uc, UC_ARM_REG_R3, &step_r3);"
    },
    {
        "line": 53,
        "fullcodeline": "printf(\">>> R2: %d\\n\", step_r2);"
    },
    {
        "line": 54,
        "fullcodeline": "printf(\">>> R3: %d\\n\\n\", step_r3);"
    },
    {
        "line": 60,
        "fullcodeline": "uc_close(uc);"
    },
    {
        "line": 42,
        "fullcodeline": "for (i = 0; i < sizeof(ARM_THUM_COND_CODE) / 2; i++) {"
    },
    {
        "line": 56,
        "fullcodeline": "if (step_r2 != r2 || step_r3 != r3) {"
    },
    {
        "line": 14,
        "fullcodeline": "printf(\"Failed on uc_open() with error returned: %u (%s)\\n\","
    },
    {
        "line": 32,
        "fullcodeline": "printf(\"Failed on uc_emu_start() with error returned: %u\\n\", err);"
    },
    {
        "line": 43,
        "fullcodeline": "err = uc_emu_start(uc, addr | 1, ADDRESS + sizeof(ARM_THUM_COND_CODE) - 1, 0, 1);"
    },
    {
        "line": 47,
        "fullcodeline": "uc_reg_read(uc, UC_ARM_REG_PC, &addr);"
    },
    {
        "line": 57,
        "fullcodeline": "printf(\"Failed with ARM ITE blocks stepping!\\n\");"
    },
    {
        "line": 15,
        "fullcodeline": "err, uc_strerror(err));"
    },
    {
        "line": 45,
        "fullcodeline": "printf(\"Failed on uc_emu_start() with error returned: %u\\n\", err);"
    }
]