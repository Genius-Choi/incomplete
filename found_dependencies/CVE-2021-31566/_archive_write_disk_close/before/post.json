[
    {
        "line": 3,
        "fullcodeline": "struct archive_write_disk *a = (struct archive_write_disk *)_a;"
    },
    {
        "line": 7,
        "fullcodeline": "archive_check_magic(&a->archive, ARCHIVE_WRITE_DISK_MAGIC,"
    },
    {
        "line": 10,
        "fullcodeline": "ret = _archive_write_disk_finish_entry(&a->archive);"
    },
    {
        "line": 13,
        "fullcodeline": "p = sort_dir_list(a->fixup_list);"
    },
    {
        "line": 56,
        "fullcodeline": "a->fixup_list = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "ARCHIVE_STATE_HEADER | ARCHIVE_STATE_DATA,"
    },
    {
        "line": 15,
        "fullcodeline": "while (p != NULL) {"
    },
    {
        "line": 16,
        "fullcodeline": "fd = -1;"
    },
    {
        "line": 17,
        "fullcodeline": "a->pst = NULL; /* Mark stat cache as out-of-date. */"
    },
    {
        "line": 47,
        "fullcodeline": "next = p->next;"
    },
    {
        "line": 48,
        "fullcodeline": "archive_acl_clear(&p->acl);"
    },
    {
        "line": 49,
        "fullcodeline": "free(p->mac_metadata);"
    },
    {
        "line": 50,
        "fullcodeline": "free(p->name);"
    },
    {
        "line": 53,
        "fullcodeline": "free(p);"
    },
    {
        "line": 54,
        "fullcodeline": "p = next;"
    },
    {
        "line": 18,
        "fullcodeline": "if (p->fixup &"
    },
    {
        "line": 23,
        "fullcodeline": "if (p->fixup & TODO_TIMES) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (p->fixup & TODO_MODE_BASE) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (p->fixup & TODO_ACLS)"
    },
    {
        "line": 41,
        "fullcodeline": "if (p->fixup & TODO_FFLAGS)"
    },
    {
        "line": 44,
        "fullcodeline": "if (p->fixup & TODO_MAC_METADATA)"
    },
    {
        "line": 51,
        "fullcodeline": "if (fd >= 0)"
    },
    {
        "line": 19,
        "fullcodeline": "(TODO_TIMES | TODO_MODE_BASE | TODO_ACLS | TODO_FFLAGS)) {"
    },
    {
        "line": 20,
        "fullcodeline": "fd = open(p->name,"
    },
    {
        "line": 24,
        "fullcodeline": "set_times(a, fd, p->mode, p->name,"
    },
    {
        "line": 36,
        "fullcodeline": "chmod(p->name, p->mode);"
    },
    {
        "line": 39,
        "fullcodeline": "archive_write_disk_set_acls(&a->archive, fd,"
    },
    {
        "line": 42,
        "fullcodeline": "set_fflags_platform(a, fd, p->name,"
    },
    {
        "line": 45,
        "fullcodeline": "set_mac_metadata(a, p->name, p->mac_metadata,"
    },
    {
        "line": 52,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 21,
        "fullcodeline": "O_WRONLY | O_BINARY | O_NOFOLLOW | O_CLOEXEC);"
    }
]