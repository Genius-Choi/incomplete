[
    {
        "line": 8,
        "fullcodeline": "u8 *raw_key = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "res = fscrypt_initialize(inode->i_sb->s_cop->flags);"
    },
    {
        "line": 21,
        "fullcodeline": "res = inode->i_sb->s_cop->get_context(inode, &ctx, sizeof(ctx));"
    },
    {
        "line": 42,
        "fullcodeline": "crypt_info = kmem_cache_alloc(fscrypt_info_cachep, GFP_NOFS);"
    },
    {
        "line": 46,
        "fullcodeline": "crypt_info->ci_flags = ctx.flags;"
    },
    {
        "line": 47,
        "fullcodeline": "crypt_info->ci_data_mode = ctx.contents_encryption_mode;"
    },
    {
        "line": 48,
        "fullcodeline": "crypt_info->ci_filename_mode = ctx.filenames_encryption_mode;"
    },
    {
        "line": 49,
        "fullcodeline": "crypt_info->ci_ctfm = NULL;"
    },
    {
        "line": 50,
        "fullcodeline": "memcpy(crypt_info->ci_master_key, ctx.master_key_descriptor,"
    },
    {
        "line": 53,
        "fullcodeline": "res = determine_cipher_type(crypt_info, inode, &cipher_str, &keysize);"
    },
    {
        "line": 61,
        "fullcodeline": "res = -ENOMEM;"
    },
    {
        "line": 62,
        "fullcodeline": "raw_key = kmalloc(FS_MAX_KEY_SIZE, GFP_NOFS);"
    },
    {
        "line": 66,
        "fullcodeline": "res = validate_user_key(crypt_info, &ctx, raw_key, FS_KEY_DESC_PREFIX);"
    },
    {
        "line": 78,
        "fullcodeline": "ctfm = crypto_alloc_skcipher(cipher_str, 0, 0);"
    },
    {
        "line": 86,
        "fullcodeline": "crypt_info->ci_ctfm = ctfm;"
    },
    {
        "line": 87,
        "fullcodeline": "crypto_skcipher_clear_flags(ctfm, ~0);"
    },
    {
        "line": 88,
        "fullcodeline": "crypto_skcipher_set_flags(ctfm, CRYPTO_TFM_REQ_WEAK_KEY);"
    },
    {
        "line": 89,
        "fullcodeline": "res = crypto_skcipher_setkey(ctfm, raw_key, keysize);"
    },
    {
        "line": 98,
        "fullcodeline": "put_crypt_info(crypt_info);"
    },
    {
        "line": 99,
        "fullcodeline": "kzfree(raw_key);"
    },
    {
        "line": 22,
        "fullcodeline": "if (res < 0) {"
    },
    {
        "line": 36,
        "fullcodeline": "if (ctx.format != FS_ENCRYPTION_CONTEXT_FORMAT_V1)"
    },
    {
        "line": 39,
        "fullcodeline": "if (ctx.flags & ~FS_POLICY_FLAGS_VALID)"
    },
    {
        "line": 43,
        "fullcodeline": "if (!crypt_info)"
    },
    {
        "line": 63,
        "fullcodeline": "if (!raw_key)"
    },
    {
        "line": 67,
        "fullcodeline": "if (res && inode->i_sb->s_cop->key_prefix) {"
    },
    {
        "line": 79,
        "fullcodeline": "if (!ctfm || IS_ERR(ctfm)) {"
    },
    {
        "line": 93,
        "fullcodeline": "if (cmpxchg(&inode->i_crypt_info, NULL, crypt_info) == NULL)"
    },
    {
        "line": 96,
        "fullcodeline": "if (res == -ENOKEY)"
    },
    {
        "line": 27,
        "fullcodeline": "memset(&ctx, 0, sizeof(ctx));"
    },
    {
        "line": 28,
        "fullcodeline": "ctx.format = FS_ENCRYPTION_CONTEXT_FORMAT_V1;"
    },
    {
        "line": 29,
        "fullcodeline": "ctx.contents_encryption_mode = FS_ENCRYPTION_MODE_AES_256_XTS;"
    },
    {
        "line": 30,
        "fullcodeline": "ctx.filenames_encryption_mode = FS_ENCRYPTION_MODE_AES_256_CTS;"
    },
    {
        "line": 31,
        "fullcodeline": "memset(ctx.master_key_descriptor, 0x42, FS_KEY_DESCRIPTOR_SIZE);"
    },
    {
        "line": 68,
        "fullcodeline": "int res2 = validate_user_key(crypt_info, &ctx, raw_key,"
    },
    {
        "line": 80,
        "fullcodeline": "res = ctfm ? PTR_ERR(ctfm) : -ENOMEM;"
    },
    {
        "line": 94,
        "fullcodeline": "crypt_info = NULL;"
    },
    {
        "line": 97,
        "fullcodeline": "res = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "return -EOPNOTSUPP;"
    },
    {
        "line": 23,
        "fullcodeline": "if (!fscrypt_dummy_context_enabled(inode) ||"
    },
    {
        "line": 37,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 40,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 44,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 24,
        "fullcodeline": "inode->i_sb->s_cop->is_encrypted(inode))"
    },
    {
        "line": 32,
        "fullcodeline": "} else if (res != sizeof(ctx)) {"
    },
    {
        "line": 71,
        "fullcodeline": "if (res2 == -ENOKEY)"
    },
    {
        "line": 33,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 72,
        "fullcodeline": "res = -ENOKEY;"
    }
]