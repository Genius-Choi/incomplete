[
    {
        "line": 8,
        "fullcodeline": "u8 *raw_key = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "res = fscrypt_initialize(inode->i_sb->s_cop->flags);"
    },
    {
        "line": 18,
        "fullcodeline": "crypt_info = ACCESS_ONCE(inode->i_crypt_info);"
    },
    {
        "line": 27,
        "fullcodeline": "res = inode->i_sb->s_cop->get_context(inode, &ctx, sizeof(ctx));"
    },
    {
        "line": 48,
        "fullcodeline": "crypt_info = kmem_cache_alloc(fscrypt_info_cachep, GFP_NOFS);"
    },
    {
        "line": 52,
        "fullcodeline": "crypt_info->ci_flags = ctx.flags;"
    },
    {
        "line": 53,
        "fullcodeline": "crypt_info->ci_data_mode = ctx.contents_encryption_mode;"
    },
    {
        "line": 54,
        "fullcodeline": "crypt_info->ci_filename_mode = ctx.filenames_encryption_mode;"
    },
    {
        "line": 55,
        "fullcodeline": "crypt_info->ci_ctfm = NULL;"
    },
    {
        "line": 56,
        "fullcodeline": "crypt_info->ci_keyring_key = NULL;"
    },
    {
        "line": 57,
        "fullcodeline": "memcpy(crypt_info->ci_master_key, ctx.master_key_descriptor,"
    },
    {
        "line": 60,
        "fullcodeline": "res = determine_cipher_type(crypt_info, inode, &cipher_str, &keysize);"
    },
    {
        "line": 68,
        "fullcodeline": "res = -ENOMEM;"
    },
    {
        "line": 69,
        "fullcodeline": "raw_key = kmalloc(FS_MAX_KEY_SIZE, GFP_NOFS);"
    },
    {
        "line": 73,
        "fullcodeline": "res = validate_user_key(crypt_info, &ctx, raw_key, FS_KEY_DESC_PREFIX);"
    },
    {
        "line": 85,
        "fullcodeline": "ctfm = crypto_alloc_skcipher(cipher_str, 0, 0);"
    },
    {
        "line": 93,
        "fullcodeline": "crypt_info->ci_ctfm = ctfm;"
    },
    {
        "line": 94,
        "fullcodeline": "crypto_skcipher_clear_flags(ctfm, ~0);"
    },
    {
        "line": 95,
        "fullcodeline": "crypto_skcipher_set_flags(ctfm, CRYPTO_TFM_REQ_WEAK_KEY);"
    },
    {
        "line": 96,
        "fullcodeline": "res = crypto_skcipher_setkey(ctfm, raw_key, keysize);"
    },
    {
        "line": 101,
        "fullcodeline": "raw_key = NULL;"
    },
    {
        "line": 28,
        "fullcodeline": "if (res < 0) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (ctx.format != FS_ENCRYPTION_CONTEXT_FORMAT_V1)"
    },
    {
        "line": 45,
        "fullcodeline": "if (ctx.flags & ~FS_POLICY_FLAGS_VALID)"
    },
    {
        "line": 49,
        "fullcodeline": "if (!crypt_info)"
    },
    {
        "line": 70,
        "fullcodeline": "if (!raw_key)"
    },
    {
        "line": 74,
        "fullcodeline": "if (res && inode->i_sb->s_cop->key_prefix) {"
    },
    {
        "line": 102,
        "fullcodeline": "if (cmpxchg(&inode->i_crypt_info, NULL, crypt_info) != NULL) {"
    },
    {
        "line": 109,
        "fullcodeline": "if (res == -ENOKEY)"
    },
    {
        "line": 23,
        "fullcodeline": "fscrypt_put_encryption_info(inode, crypt_info);"
    },
    {
        "line": 33,
        "fullcodeline": "memset(&ctx, 0, sizeof(ctx));"
    },
    {
        "line": 34,
        "fullcodeline": "ctx.format = FS_ENCRYPTION_CONTEXT_FORMAT_V1;"
    },
    {
        "line": 35,
        "fullcodeline": "ctx.contents_encryption_mode = FS_ENCRYPTION_MODE_AES_256_XTS;"
    },
    {
        "line": 36,
        "fullcodeline": "ctx.filenames_encryption_mode = FS_ENCRYPTION_MODE_AES_256_CTS;"
    },
    {
        "line": 37,
        "fullcodeline": "memset(ctx.master_key_descriptor, 0x42, FS_KEY_DESCRIPTOR_SIZE);"
    },
    {
        "line": 75,
        "fullcodeline": "int res2 = validate_user_key(crypt_info, &ctx, raw_key,"
    },
    {
        "line": 86,
        "fullcodeline": "if (!ctfm || IS_ERR(ctfm)) {"
    },
    {
        "line": 87,
        "fullcodeline": "res = ctfm ? PTR_ERR(ctfm) : -ENOMEM;"
    },
    {
        "line": 110,
        "fullcodeline": "res = 0;"
    },
    {
        "line": 16,
        "fullcodeline": "return -EOPNOTSUPP;"
    },
    {
        "line": 43,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 46,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 50,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 20,
        "fullcodeline": "if (!crypt_info->ci_keyring_key ||"
    },
    {
        "line": 21,
        "fullcodeline": "key_validate(crypt_info->ci_keyring_key) == 0)"
    },
    {
        "line": 29,
        "fullcodeline": "if (!fscrypt_dummy_context_enabled(inode) ||"
    },
    {
        "line": 30,
        "fullcodeline": "inode->i_sb->s_cop->is_encrypted(inode))"
    },
    {
        "line": 39,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 78,
        "fullcodeline": "if (res2 == -ENOKEY)"
    },
    {
        "line": 79,
        "fullcodeline": "res = -ENOKEY;"
    }
]