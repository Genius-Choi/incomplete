[
    {
        "line": 2,
        "fullcodeline": "gui_request = ( # these are URLs for web pages"
    },
    {
        "line": 3,
        "fullcodeline": "request.path == '/' or"
    },
    {
        "line": 8,
        "fullcodeline": "if request.path.start_with?('/remote/') or request.path == '/run_pcs'"
    },
    {
        "line": 6,
        "fullcodeline": "request.path.match('/managec/.+/main')"
    },
    {
        "line": 5,
        "fullcodeline": "request.path == '/permissions' or"
    },
    {
        "line": 9,
        "fullcodeline": "unless PCSAuth.loginByToken(session, cookies)"
    },
    {
        "line": 13,
        "fullcodeline": "if !gui_request and"
    },
    {
        "line": 4,
        "fullcodeline": "request.path == '/manage' or"
    },
    {
        "line": 14,
        "fullcodeline": "request.env['HTTP_X_REQUESTED_WITH'] != 'XMLHttpRequest'"
    },
    {
        "line": 20,
        "fullcodeline": "elsif not PCSAuth.isLoggedIn(session)"
    },
    {
        "line": 22,
        "fullcodeline": "session[:pre_login_path] = request.path"
    },
    {
        "line": 23,
        "fullcodeline": "redirect '/login'"
    }
]