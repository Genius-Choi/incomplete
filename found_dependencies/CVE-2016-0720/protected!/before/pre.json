[
    {
        "line": 2,
        "fullcodeline": "if not PCSAuth.loginByToken(session, cookies) and not PCSAuth.isLoggedIn(session)"
    },
    {
        "line": 4,
        "fullcodeline": "match_expr = \"/managec/(.*)/(.*)\""
    },
    {
        "line": 5,
        "fullcodeline": "mymatch = request.path.match(match_expr)"
    },
    {
        "line": 6,
        "fullcodeline": "on_managec_main = false"
    },
    {
        "line": 7,
        "fullcodeline": "if mymatch and mymatch.length >= 3 and mymatch[2] == \"main\""
    },
    {
        "line": 11,
        "fullcodeline": "if request.path.start_with?('/remote') or"
    },
    {
        "line": 8,
        "fullcodeline": "on_managec_main = true"
    },
    {
        "line": 15,
        "fullcodeline": "request.path.start_with?('/permissions_')"
    },
    {
        "line": 17,
        "fullcodeline": "$logger.info \"ERROR: Request without authentication\""
    },
    {
        "line": 14,
        "fullcodeline": "'/clusters_overview' == request.path or"
    },
    {
        "line": 21,
        "fullcodeline": "redirect '/login'"
    },
    {
        "line": 13,
        "fullcodeline": "'/run_pcs' == request.path or"
    },
    {
        "line": 12,
        "fullcodeline": "(request.path.match(match_expr) and not on_managec_main) or"
    }
]