[
    {
        "line": 4,
        "fullcodeline": "BIO\t\t*rawcert = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "RSA\t\t*peerrsa = NULL, *localrsa = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "EC_KEY\t\t*peerec = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "EVP_PKEY\t*peerkey = NULL, *localkey = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "int\t\t ret = -1;"
    },
    {
        "line": 9,
        "fullcodeline": "FILE\t\t*fp = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "char\t\t idstr[IKED_ID_SIZE];"
    },
    {
        "line": 11,
        "fullcodeline": "char\t\t file[PATH_MAX];"
    },
    {
        "line": 27,
        "fullcodeline": "bzero(&idp, sizeof(idp));"
    },
    {
        "line": 31,
        "fullcodeline": "idp.id_type = id->id_type;"
    },
    {
        "line": 32,
        "fullcodeline": "idp.id_offset = id->id_offset;"
    },
    {
        "line": 61,
        "fullcodeline": "lc_idtype(idstr);"
    },
    {
        "line": 74,
        "fullcodeline": "localkey = PEM_read_PUBKEY(fp, NULL, NULL, NULL);"
    },
    {
        "line": 97,
        "fullcodeline": "log_debug(\"%s: valid public key in file %s\", __func__, file);"
    },
    {
        "line": 102,
        "fullcodeline": "ret = 0;"
    },
    {
        "line": 28,
        "fullcodeline": "if ((idp.id_buf = ibuf_new(id->id_data, id->id_length)) == NULL)"
    },
    {
        "line": 36,
        "fullcodeline": "if (len == 0 && data) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (len > 0) {"
    },
    {
        "line": 68,
        "fullcodeline": "if ((fp = fopen(file, \"r\")) == NULL) {"
    },
    {
        "line": 75,
        "fullcodeline": "if (localkey == NULL) {"
    },
    {
        "line": 89,
        "fullcodeline": "if (localkey == NULL)"
    },
    {
        "line": 92,
        "fullcodeline": "if (peerkey && EVP_PKEY_cmp(peerkey, localkey) != 1) {"
    },
    {
        "line": 104,
        "fullcodeline": "if (ret != 0)"
    },
    {
        "line": 108,
        "fullcodeline": "if (localkey != NULL)"
    },
    {
        "line": 110,
        "fullcodeline": "if (peerrsa != NULL)"
    },
    {
        "line": 112,
        "fullcodeline": "if (peerec != NULL)"
    },
    {
        "line": 114,
        "fullcodeline": "if (localrsa != NULL)"
    },
    {
        "line": 116,
        "fullcodeline": "if (rawcert != NULL) {"
    },
    {
        "line": 22,
        "fullcodeline": "log_debug(\"%s: unsupported public key type %s\","
    },
    {
        "line": 33,
        "fullcodeline": "if (ikev2_print_id(&idp, idstr, sizeof(idstr)) == -1)"
    },
    {
        "line": 38,
        "fullcodeline": "peerkey = (EVP_PKEY *)data;"
    },
    {
        "line": 62,
        "fullcodeline": "if (strlcpy(file, IKED_PUBKEY_DIR, sizeof(file)) >= sizeof(file) ||"
    },
    {
        "line": 63,
        "fullcodeline": "strlcat(file, idstr, sizeof(file)) >= sizeof(file)) {"
    },
    {
        "line": 77,
        "fullcodeline": "rewind(fp);"
    },
    {
        "line": 78,
        "fullcodeline": "localrsa = PEM_read_RSAPublicKey(fp, NULL, NULL, NULL);"
    },
    {
        "line": 99,
        "fullcodeline": "if (out && ca_pubkey_serialize(localkey, out))"
    },
    {
        "line": 23,
        "fullcodeline": "__func__, print_map(id->id_type, ikev2_id_map));"
    },
    {
        "line": 24,
        "fullcodeline": "return (-1);"
    },
    {
        "line": 41,
        "fullcodeline": "if ((rawcert = BIO_new_mem_buf(data, len)) == NULL)"
    },
    {
        "line": 44,
        "fullcodeline": "if ((peerkey = EVP_PKEY_new()) == NULL)"
    },
    {
        "line": 46,
        "fullcodeline": "if ((peerrsa = d2i_RSAPublicKey_bio(rawcert, NULL))) {"
    },
    {
        "line": 70,
        "fullcodeline": "logit(len == 0 ? LOG_DEBUG : LOG_INFO,"
    },
    {
        "line": 80,
        "fullcodeline": "if (localrsa == NULL)"
    },
    {
        "line": 82,
        "fullcodeline": "if ((localkey = EVP_PKEY_new()) == NULL)"
    },
    {
        "line": 118,
        "fullcodeline": "if (peerkey != NULL)"
    },
    {
        "line": 84,
        "fullcodeline": "if (!EVP_PKEY_set1_RSA(localkey, localrsa))"
    },
    {
        "line": 47,
        "fullcodeline": "if (!EVP_PKEY_set1_RSA(peerkey, peerrsa)) {"
    },
    {
        "line": 50,
        "fullcodeline": "} else if (BIO_reset(rawcert) == 1 &&"
    },
    {
        "line": 51,
        "fullcodeline": "(peerec = d2i_EC_PUBKEY_bio(rawcert, NULL))) {"
    },
    {
        "line": 56,
        "fullcodeline": "log_debug(\"%s: unknown key type received\", __func__);"
    },
    {
        "line": 52,
        "fullcodeline": "if (!EVP_PKEY_set1_EC_KEY(peerkey, peerec)) {"
    }
]