[
    {
        "line": 4,
        "fullcodeline": "setlocale(LC_ALL, \"\");"
    },
    {
        "line": 10,
        "fullcodeline": "abrt_init(argv);"
    },
    {
        "line": 13,
        "fullcodeline": "const char *program_usage_string = _("
    },
    {
        "line": 30,
        "fullcodeline": "const char *build_ids = \"build_ids\";"
    },
    {
        "line": 31,
        "fullcodeline": "const char *exact = NULL;"
    },
    {
        "line": 32,
        "fullcodeline": "const char *repo = NULL;"
    },
    {
        "line": 33,
        "fullcodeline": "const char *size_mb = NULL;"
    },
    {
        "line": 35,
        "fullcodeline": "struct options program_options[] = {"
    },
    {
        "line": 44,
        "fullcodeline": "const unsigned opts = parse_opts(argc, argv, program_options, program_usage_string);"
    },
    {
        "line": 53,
        "fullcodeline": "char *build_ids_self_fd = NULL;"
    },
    {
        "line": 65,
        "fullcodeline": "const char *args[11];"
    },
    {
        "line": 92,
        "fullcodeline": "gid_t g = getegid();"
    },
    {
        "line": 96,
        "fullcodeline": "uid_t u = geteuid();"
    },
    {
        "line": 158,
        "fullcodeline": "execvp(EXECUTABLE, (char **)args);"
    },
    {
        "line": 159,
        "fullcodeline": "error_msg_and_die(\"Can't execute %s\", EXECUTABLE);"
    },
    {
        "line": 54,
        "fullcodeline": "if (strcmp(\"-\", build_ids) != 0)"
    },
    {
        "line": 67,
        "fullcodeline": "const char *verbs[] = { \"\", \"-v\", \"-vv\", \"-vvv\" };"
    },
    {
        "line": 68,
        "fullcodeline": "unsigned i = 0;"
    },
    {
        "line": 69,
        "fullcodeline": "args[i++] = EXECUTABLE;"
    },
    {
        "line": 70,
        "fullcodeline": "args[i++] = \"--ids\";"
    },
    {
        "line": 71,
        "fullcodeline": "args[i++] = (build_ids_self_fd != NULL) ? build_ids_self_fd : \"-\";"
    },
    {
        "line": 72,
        "fullcodeline": "args[i++] = verbs[g_verbose <= 3 ? g_verbose : 3];"
    },
    {
        "line": 85,
        "fullcodeline": "args[i++] = \"--\";"
    },
    {
        "line": 86,
        "fullcodeline": "args[i] = NULL;"
    },
    {
        "line": 94,
        "fullcodeline": "if (g != getgid())"
    },
    {
        "line": 97,
        "fullcodeline": "if (u != getuid())"
    },
    {
        "line": 36,
        "fullcodeline": "OPT__VERBOSE(&g_verbose),"
    },
    {
        "line": 37,
        "fullcodeline": "OPT_BOOL  ('y', \"yes\",         NULL,                   _(\"Noninteractive, assume 'Yes' to all questions\")),"
    },
    {
        "line": 38,
        "fullcodeline": "OPT_STRING('i', \"ids\",   &build_ids, \"BUILD_IDS_FILE\", _(\"- means STDIN, default: build_ids\")),"
    },
    {
        "line": 39,
        "fullcodeline": "OPT_STRING('e', \"exact\",     &exact, \"EXACT\",          _(\"Download only specified files\")),"
    },
    {
        "line": 40,
        "fullcodeline": "OPT_STRING('r', \"repo\",       &repo, \"REPO\",           _(\"Pattern to use when searching for repos, default: *debug*\")),"
    },
    {
        "line": 41,
        "fullcodeline": "OPT_STRING('s', \"size_mb\", &size_mb, \"SIZE_MB\",        _(\"Ignored option\")),"
    },
    {
        "line": 56,
        "fullcodeline": "const int build_ids_fd = open(build_ids, O_RDONLY);"
    },
    {
        "line": 61,
        "fullcodeline": "build_ids_self_fd = xasprintf(\"/proc/self/fd/%d\", build_ids_fd);"
    },
    {
        "line": 73,
        "fullcodeline": "if ((opts & OPT_y))"
    },
    {
        "line": 75,
        "fullcodeline": "if ((opts & OPT_e))"
    },
    {
        "line": 80,
        "fullcodeline": "if ((opts & OPT_r))"
    },
    {
        "line": 95,
        "fullcodeline": "IGNORE_RESULT(setregid(g, g));"
    },
    {
        "line": 99,
        "fullcodeline": "IGNORE_RESULT(setreuid(u, u));"
    },
    {
        "line": 109,
        "fullcodeline": "static const char *whitelist[] = {"
    },
    {
        "line": 113,
        "fullcodeline": "const size_t wlsize = sizeof(whitelist)/sizeof(char*);"
    },
    {
        "line": 114,
        "fullcodeline": "char *setlist[sizeof(whitelist)/sizeof(char*)] = { 0 };"
    },
    {
        "line": 115,
        "fullcodeline": "char *p = NULL;"
    },
    {
        "line": 121,
        "fullcodeline": "clearenv();"
    },
    {
        "line": 152,
        "fullcodeline": "char path_env[] = \"PATH=/usr/sbin:/sbin:/usr/bin:/bin:\"BIN_DIR\":\"SBIN_DIR;"
    },
    {
        "line": 155,
        "fullcodeline": "putenv(path_env);"
    },
    {
        "line": 57,
        "fullcodeline": "if (build_ids_fd < 0)"
    },
    {
        "line": 74,
        "fullcodeline": "args[i++] = \"-y\";"
    },
    {
        "line": 77,
        "fullcodeline": "args[i++] = \"--exact\";"
    },
    {
        "line": 78,
        "fullcodeline": "args[i++] = exact;"
    },
    {
        "line": 82,
        "fullcodeline": "args[i++] = \"--repo\";"
    },
    {
        "line": 83,
        "fullcodeline": "args[i++] = repo;"
    },
    {
        "line": 116,
        "fullcodeline": "for (size_t i = 0; i < wlsize; i++)"
    },
    {
        "line": 124,
        "fullcodeline": "for (size_t i = 0; i < wlsize; i++)"
    },
    {
        "line": 58,
        "fullcodeline": "perror_msg_and_die(\"Failed to open file '%s'\", build_ids);"
    },
    {
        "line": 117,
        "fullcodeline": "if ((p = getenv(whitelist[i])) != NULL)"
    },
    {
        "line": 125,
        "fullcodeline": "if (setlist[i] != NULL)"
    },
    {
        "line": 118,
        "fullcodeline": "setlist[i] = xstrdup(p);"
    },
    {
        "line": 127,
        "fullcodeline": "xsetenv(whitelist[i], setlist[i]);"
    },
    {
        "line": 128,
        "fullcodeline": "free(setlist[i]);"
    }
]