[
    {
        "line": 10,
        "fullcodeline": "err = crypto_check_attr_type(tb, CRYPTO_ALG_TYPE_SHASH);"
    },
    {
        "line": 14,
        "fullcodeline": "salg = shash_attr_alg(tb[1], 0, 0);"
    },
    {
        "line": 18,
        "fullcodeline": "err = -EINVAL;"
    },
    {
        "line": 19,
        "fullcodeline": "ds = salg->digestsize;"
    },
    {
        "line": 20,
        "fullcodeline": "ss = salg->statesize;"
    },
    {
        "line": 21,
        "fullcodeline": "alg = &salg->base;"
    },
    {
        "line": 26,
        "fullcodeline": "inst = shash_alloc_instance(\"hmac\", alg);"
    },
    {
        "line": 27,
        "fullcodeline": "err = PTR_ERR(inst);"
    },
    {
        "line": 31,
        "fullcodeline": "err = crypto_init_shash_spawn(shash_instance_ctx(inst), salg,"
    },
    {
        "line": 36,
        "fullcodeline": "inst->alg.base.cra_priority = alg->cra_priority;"
    },
    {
        "line": 37,
        "fullcodeline": "inst->alg.base.cra_blocksize = alg->cra_blocksize;"
    },
    {
        "line": 38,
        "fullcodeline": "inst->alg.base.cra_alignmask = alg->cra_alignmask;"
    },
    {
        "line": 40,
        "fullcodeline": "ss = ALIGN(ss, alg->cra_alignmask + 1);"
    },
    {
        "line": 41,
        "fullcodeline": "inst->alg.digestsize = ds;"
    },
    {
        "line": 42,
        "fullcodeline": "inst->alg.statesize = ss;"
    },
    {
        "line": 44,
        "fullcodeline": "inst->alg.base.cra_ctxsize = sizeof(struct hmac_ctx) +"
    },
    {
        "line": 47,
        "fullcodeline": "inst->alg.base.cra_init = hmac_init_tfm;"
    },
    {
        "line": 48,
        "fullcodeline": "inst->alg.base.cra_exit = hmac_exit_tfm;"
    },
    {
        "line": 50,
        "fullcodeline": "inst->alg.init = hmac_init;"
    },
    {
        "line": 51,
        "fullcodeline": "inst->alg.update = hmac_update;"
    },
    {
        "line": 52,
        "fullcodeline": "inst->alg.final = hmac_final;"
    },
    {
        "line": 53,
        "fullcodeline": "inst->alg.finup = hmac_finup;"
    },
    {
        "line": 54,
        "fullcodeline": "inst->alg.export = hmac_export;"
    },
    {
        "line": 55,
        "fullcodeline": "inst->alg.import = hmac_import;"
    },
    {
        "line": 56,
        "fullcodeline": "inst->alg.setkey = hmac_setkey;"
    },
    {
        "line": 58,
        "fullcodeline": "err = shash_register_instance(tmpl, inst);"
    },
    {
        "line": 65,
        "fullcodeline": "crypto_mod_put(alg);"
    },
    {
        "line": 15,
        "fullcodeline": "if (IS_ERR(salg))"
    },
    {
        "line": 22,
        "fullcodeline": "if (ds > alg->cra_blocksize ||"
    },
    {
        "line": 28,
        "fullcodeline": "if (IS_ERR(inst))"
    },
    {
        "line": 23,
        "fullcodeline": "ss < alg->cra_blocksize)"
    },
    {
        "line": 32,
        "fullcodeline": "shash_crypto_instance(inst));"
    },
    {
        "line": 45,
        "fullcodeline": "ALIGN(ss * 2, crypto_tfm_ctx_alignment());"
    },
    {
        "line": 61,
        "fullcodeline": "shash_free_instance(shash_crypto_instance(inst));"
    },
    {
        "line": 16,
        "fullcodeline": "return PTR_ERR(salg);"
    }
]