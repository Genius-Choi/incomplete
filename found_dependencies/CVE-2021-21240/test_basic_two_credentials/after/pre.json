[
    {
        "line": 3,
        "fullcodeline": "http = httplib2.Http()"
    },
    {
        "line": 4,
        "fullcodeline": "password1 = tests.gen_password()"
    },
    {
        "line": 5,
        "fullcodeline": "password2 = tests.gen_password()"
    },
    {
        "line": 6,
        "fullcodeline": "allowed = [(\"joe\", password1)]  # exploit shared mutable list"
    },
    {
        "line": 7,
        "fullcodeline": "handler = tests.http_reflect_with_auth(allow_scheme=\"basic\", allow_credentials=allowed)"
    },
    {
        "line": 8,
        "fullcodeline": "with tests.server_request(handler, request_count=7) as uri:"
    },
    {
        "line": 9,
        "fullcodeline": "http.add_credentials(\"fred\", password2)"
    },
    {
        "line": 11,
        "fullcodeline": "assert response.status == 401"
    },
    {
        "line": 12,
        "fullcodeline": "http.add_credentials(\"joe\", password1)"
    },
    {
        "line": 15,
        "fullcodeline": "allowed[0] = (\"fred\", password2)"
    },
    {
        "line": 17,
        "fullcodeline": "assert response.status == 200"
    },
    {
        "line": 10,
        "fullcodeline": "response, content = http.request(uri, \"GET\")"
    },
    {
        "line": 13,
        "fullcodeline": "response, content = http.request(uri, \"GET\")"
    },
    {
        "line": 14,
        "fullcodeline": "assert response.status == 200"
    },
    {
        "line": 16,
        "fullcodeline": "response, content = http.request(uri, \"GET\")"
    }
]