[
    {
        "line": 4,
        "fullcodeline": "BIO *out = NULL, *btmp = NULL, *etmp = NULL, *bio = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "ASN1_OCTET_STRING *data_body = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "const EVP_CIPHER *evp_cipher = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "EVP_CIPHER_CTX *evp_ctx = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "X509_ALGOR *enc_alg = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "STACK_OF(X509_ALGOR) *md_sk = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "STACK_OF(PKCS7_RECIP_INFO) *rsk = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "PKCS7_RECIP_INFO *ri = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "unsigned char *ek = NULL, *tkey = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "int eklen = 0, tkeylen = 0;"
    },
    {
        "line": 28,
        "fullcodeline": "p7->state = PKCS7_S_HEADER;"
    },
    {
        "line": 219,
        "fullcodeline": "BIO_push(out, bio);"
    },
    {
        "line": 17,
        "fullcodeline": "if (p7 == NULL) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (p7->d.ptr == NULL) {"
    },
    {
        "line": 27,
        "fullcodeline": "i = OBJ_obj2nid(p7->type);"
    },
    {
        "line": 83,
        "fullcodeline": "if (md_sk != NULL) {"
    },
    {
        "line": 108,
        "fullcodeline": "if (evp_cipher != NULL) {"
    },
    {
        "line": 207,
        "fullcodeline": "if (in_bio != NULL) {"
    },
    {
        "line": 18,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE, PKCS7_R_INVALID_NULL_POINTER);"
    },
    {
        "line": 38,
        "fullcodeline": "data_body = PKCS7_get_octet_string(p7->d.sign->contents);"
    },
    {
        "line": 44,
        "fullcodeline": "md_sk = p7->d.sign->md_algs;"
    },
    {
        "line": 47,
        "fullcodeline": "rsk = p7->d.signed_and_enveloped->recipientinfo;"
    },
    {
        "line": 48,
        "fullcodeline": "md_sk = p7->d.signed_and_enveloped->md_algs;"
    },
    {
        "line": 50,
        "fullcodeline": "data_body = p7->d.signed_and_enveloped->enc_data->enc_data;"
    },
    {
        "line": 51,
        "fullcodeline": "enc_alg = p7->d.signed_and_enveloped->enc_data->algorithm;"
    },
    {
        "line": 52,
        "fullcodeline": "evp_cipher = EVP_get_cipherbyobj(enc_alg->algorithm);"
    },
    {
        "line": 60,
        "fullcodeline": "rsk = p7->d.enveloped->recipientinfo;"
    },
    {
        "line": 61,
        "fullcodeline": "enc_alg = p7->d.enveloped->enc_data->algorithm;"
    },
    {
        "line": 63,
        "fullcodeline": "data_body = p7->d.enveloped->enc_data->enc_data;"
    },
    {
        "line": 64,
        "fullcodeline": "evp_cipher = EVP_get_cipherbyobj(enc_alg->algorithm);"
    },
    {
        "line": 72,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE, PKCS7_R_UNSUPPORTED_CONTENT_TYPE);"
    },
    {
        "line": 77,
        "fullcodeline": "if (data_body == NULL && in_bio == NULL) {"
    },
    {
        "line": 158,
        "fullcodeline": "evp_ctx = NULL;"
    },
    {
        "line": 159,
        "fullcodeline": "BIO_get_cipher_ctx(etmp, &evp_ctx);"
    },
    {
        "line": 165,
        "fullcodeline": "tkeylen = EVP_CIPHER_CTX_key_length(evp_ctx);"
    },
    {
        "line": 166,
        "fullcodeline": "tkey = OPENSSL_malloc(tkeylen);"
    },
    {
        "line": 196,
        "fullcodeline": "OPENSSL_clear_free(ek, eklen);"
    },
    {
        "line": 197,
        "fullcodeline": "ek = NULL;"
    },
    {
        "line": 198,
        "fullcodeline": "OPENSSL_clear_free(tkey, tkeylen);"
    },
    {
        "line": 199,
        "fullcodeline": "tkey = NULL;"
    },
    {
        "line": 205,
        "fullcodeline": "etmp = NULL;"
    },
    {
        "line": 208,
        "fullcodeline": "bio = in_bio;"
    },
    {
        "line": 53,
        "fullcodeline": "if (evp_cipher == NULL) {"
    },
    {
        "line": 65,
        "fullcodeline": "if (evp_cipher == NULL) {"
    },
    {
        "line": 84,
        "fullcodeline": "for (i = 0; i < sk_X509_ALGOR_num(md_sk); i++) {"
    },
    {
        "line": 109,
        "fullcodeline": "if ((etmp = BIO_new(BIO_f_cipher())) == NULL) {"
    },
    {
        "line": 139,
        "fullcodeline": "if (pcert == NULL) {"
    },
    {
        "line": 167,
        "fullcodeline": "if (!tkey)"
    },
    {
        "line": 171,
        "fullcodeline": "if (ek == NULL) {"
    },
    {
        "line": 177,
        "fullcodeline": "if (eklen != EVP_CIPHER_CTX_key_length(evp_ctx)) {"
    },
    {
        "line": 201,
        "fullcodeline": "if (out == NULL)"
    },
    {
        "line": 39,
        "fullcodeline": "if (!PKCS7_is_detached(p7) && data_body == NULL) {"
    },
    {
        "line": 40,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE,"
    },
    {
        "line": 85,
        "fullcodeline": "xa = sk_X509_ALGOR_value(md_sk, i);"
    },
    {
        "line": 91,
        "fullcodeline": "j = OBJ_obj2nid(xa->algorithm);"
    },
    {
        "line": 92,
        "fullcodeline": "evp_md = EVP_get_digestbynid(j);"
    },
    {
        "line": 99,
        "fullcodeline": "BIO_set_md(btmp, evp_md);"
    },
    {
        "line": 104,
        "fullcodeline": "btmp = NULL;"
    },
    {
        "line": 160,
        "fullcodeline": "if (EVP_CipherInit_ex(evp_ctx, evp_cipher, NULL, NULL, NULL, 0) <= 0)"
    },
    {
        "line": 162,
        "fullcodeline": "if (EVP_CIPHER_asn1_to_param(evp_ctx, enc_alg->parameter) < 0)"
    },
    {
        "line": 169,
        "fullcodeline": "if (EVP_CIPHER_CTX_rand_key(evp_ctx, tkey) <= 0)"
    },
    {
        "line": 172,
        "fullcodeline": "ek = tkey;"
    },
    {
        "line": 173,
        "fullcodeline": "eklen = tkeylen;"
    },
    {
        "line": 174,
        "fullcodeline": "tkey = NULL;"
    },
    {
        "line": 193,
        "fullcodeline": "if (EVP_CipherInit_ex(evp_ctx, NULL, NULL, ek, NULL, 0) <= 0)"
    },
    {
        "line": 202,
        "fullcodeline": "out = etmp;"
    },
    {
        "line": 210,
        "fullcodeline": "if (data_body->length > 0)"
    },
    {
        "line": 216,
        "fullcodeline": "if (bio == NULL)"
    },
    {
        "line": 86,
        "fullcodeline": "if ((btmp = BIO_new(BIO_f_md())) == NULL) {"
    },
    {
        "line": 93,
        "fullcodeline": "if (evp_md == NULL) {"
    },
    {
        "line": 100,
        "fullcodeline": "if (out == NULL)"
    },
    {
        "line": 125,
        "fullcodeline": "for (i = 0; i < sk_PKCS7_RECIP_INFO_num(rsk); i++) {"
    },
    {
        "line": 131,
        "fullcodeline": "if (ri == NULL) {"
    },
    {
        "line": 144,
        "fullcodeline": "for (i = 0; i < sk_PKCS7_RECIP_INFO_num(rsk); i++) {"
    },
    {
        "line": 204,
        "fullcodeline": "BIO_push(out, etmp);"
    },
    {
        "line": 211,
        "fullcodeline": "bio = BIO_new_mem_buf(data_body->data, data_body->length);"
    },
    {
        "line": 94,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE,"
    },
    {
        "line": 101,
        "fullcodeline": "out = btmp;"
    },
    {
        "line": 126,
        "fullcodeline": "ri = sk_PKCS7_RECIP_INFO_value(rsk, i);"
    },
    {
        "line": 129,
        "fullcodeline": "ri = NULL;"
    },
    {
        "line": 132,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE,"
    },
    {
        "line": 145,
        "fullcodeline": "ri = sk_PKCS7_RECIP_INFO_value(rsk, i);"
    },
    {
        "line": 183,
        "fullcodeline": "if (!EVP_CIPHER_CTX_set_key_length(evp_ctx, eklen)) {"
    },
    {
        "line": 186,
        "fullcodeline": "ek = tkey;"
    },
    {
        "line": 187,
        "fullcodeline": "eklen = tkeylen;"
    },
    {
        "line": 188,
        "fullcodeline": "tkey = NULL;"
    },
    {
        "line": 213,
        "fullcodeline": "bio = BIO_new(BIO_s_mem());"
    },
    {
        "line": 214,
        "fullcodeline": "BIO_set_mem_eof_return(bio, 0);"
    },
    {
        "line": 103,
        "fullcodeline": "BIO_push(out, btmp);"
    },
    {
        "line": 153,
        "fullcodeline": "if (pkcs7_decrypt_rinfo(&ek, &eklen, ri, pkey) < 0)"
    },
    {
        "line": 127,
        "fullcodeline": "if (!pkcs7_cmp_ri(ri, pcert))"
    },
    {
        "line": 147,
        "fullcodeline": "if (pkcs7_decrypt_rinfo(&ek, &eklen, ri, pkey) < 0)"
    }
]