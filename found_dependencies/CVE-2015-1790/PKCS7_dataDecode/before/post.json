[
    {
        "line": 4,
        "fullcodeline": "BIO *out = NULL, *btmp = NULL, *etmp = NULL, *bio = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "ASN1_OCTET_STRING *data_body = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "const EVP_CIPHER *evp_cipher = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "EVP_CIPHER_CTX *evp_ctx = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "X509_ALGOR *enc_alg = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "STACK_OF(X509_ALGOR) *md_sk = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "STACK_OF(PKCS7_RECIP_INFO) *rsk = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "PKCS7_RECIP_INFO *ri = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "unsigned char *ek = NULL, *tkey = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "int eklen = 0, tkeylen = 0;"
    },
    {
        "line": 27,
        "fullcodeline": "i = OBJ_obj2nid(p7->type);"
    },
    {
        "line": 28,
        "fullcodeline": "p7->state = PKCS7_S_HEADER;"
    },
    {
        "line": 205,
        "fullcodeline": "BIO_push(out, bio);"
    },
    {
        "line": 206,
        "fullcodeline": "bio = NULL;"
    },
    {
        "line": 210,
        "fullcodeline": "OPENSSL_clear_free(ek, eklen);"
    },
    {
        "line": 211,
        "fullcodeline": "OPENSSL_clear_free(tkey, tkeylen);"
    },
    {
        "line": 212,
        "fullcodeline": "BIO_free_all(out);"
    },
    {
        "line": 213,
        "fullcodeline": "BIO_free_all(btmp);"
    },
    {
        "line": 214,
        "fullcodeline": "BIO_free_all(etmp);"
    },
    {
        "line": 215,
        "fullcodeline": "BIO_free_all(bio);"
    },
    {
        "line": 17,
        "fullcodeline": "if (p7 == NULL) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (p7->d.ptr == NULL) {"
    },
    {
        "line": 69,
        "fullcodeline": "if (md_sk != NULL) {"
    },
    {
        "line": 94,
        "fullcodeline": "if (evp_cipher != NULL) {"
    },
    {
        "line": 193,
        "fullcodeline": "if (PKCS7_is_detached(p7) || (in_bio != NULL)) {"
    },
    {
        "line": 18,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE, PKCS7_R_INVALID_NULL_POINTER);"
    },
    {
        "line": 23,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE, PKCS7_R_NO_CONTENT);"
    },
    {
        "line": 32,
        "fullcodeline": "data_body = PKCS7_get_octet_string(p7->d.sign->contents);"
    },
    {
        "line": 45,
        "fullcodeline": "evp_cipher = EVP_get_cipherbyobj(enc_alg->algorithm);"
    },
    {
        "line": 56,
        "fullcodeline": "evp_cipher = EVP_get_cipherbyobj(enc_alg->algorithm);"
    },
    {
        "line": 64,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE, PKCS7_R_UNSUPPORTED_CONTENT_TYPE);"
    },
    {
        "line": 144,
        "fullcodeline": "evp_ctx = NULL;"
    },
    {
        "line": 145,
        "fullcodeline": "BIO_get_cipher_ctx(etmp, &evp_ctx);"
    },
    {
        "line": 151,
        "fullcodeline": "tkeylen = EVP_CIPHER_CTX_key_length(evp_ctx);"
    },
    {
        "line": 152,
        "fullcodeline": "tkey = OPENSSL_malloc(tkeylen);"
    },
    {
        "line": 178,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 182,
        "fullcodeline": "OPENSSL_clear_free(ek, eklen);"
    },
    {
        "line": 183,
        "fullcodeline": "ek = NULL;"
    },
    {
        "line": 184,
        "fullcodeline": "OPENSSL_clear_free(tkey, tkeylen);"
    },
    {
        "line": 185,
        "fullcodeline": "tkey = NULL;"
    },
    {
        "line": 191,
        "fullcodeline": "etmp = NULL;"
    },
    {
        "line": 194,
        "fullcodeline": "bio = in_bio;"
    },
    {
        "line": 33,
        "fullcodeline": "if (!PKCS7_is_detached(p7) && data_body == NULL) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (evp_cipher == NULL) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (evp_cipher == NULL) {"
    },
    {
        "line": 70,
        "fullcodeline": "for (i = 0; i < sk_X509_ALGOR_num(md_sk); i++) {"
    },
    {
        "line": 95,
        "fullcodeline": "if ((etmp = BIO_new(BIO_f_cipher())) == NULL) {"
    },
    {
        "line": 125,
        "fullcodeline": "if (pcert == NULL) {"
    },
    {
        "line": 146,
        "fullcodeline": "if (EVP_CipherInit_ex(evp_ctx, evp_cipher, NULL, NULL, NULL, 0) <= 0)"
    },
    {
        "line": 148,
        "fullcodeline": "if (EVP_CIPHER_asn1_to_param(evp_ctx, enc_alg->parameter) < 0)"
    },
    {
        "line": 153,
        "fullcodeline": "if (!tkey)"
    },
    {
        "line": 155,
        "fullcodeline": "if (EVP_CIPHER_CTX_rand_key(evp_ctx, tkey) <= 0)"
    },
    {
        "line": 157,
        "fullcodeline": "if (ek == NULL) {"
    },
    {
        "line": 163,
        "fullcodeline": "if (eklen != EVP_CIPHER_CTX_key_length(evp_ctx)) {"
    },
    {
        "line": 179,
        "fullcodeline": "if (EVP_CipherInit_ex(evp_ctx, NULL, NULL, ek, NULL, 0) <= 0)"
    },
    {
        "line": 187,
        "fullcodeline": "if (out == NULL)"
    },
    {
        "line": 34,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE,"
    },
    {
        "line": 47,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE,"
    },
    {
        "line": 58,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE,"
    },
    {
        "line": 71,
        "fullcodeline": "xa = sk_X509_ALGOR_value(md_sk, i);"
    },
    {
        "line": 77,
        "fullcodeline": "j = OBJ_obj2nid(xa->algorithm);"
    },
    {
        "line": 78,
        "fullcodeline": "evp_md = EVP_get_digestbynid(j);"
    },
    {
        "line": 85,
        "fullcodeline": "BIO_set_md(btmp, evp_md);"
    },
    {
        "line": 90,
        "fullcodeline": "btmp = NULL;"
    },
    {
        "line": 96,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE, ERR_R_BIO_LIB);"
    },
    {
        "line": 158,
        "fullcodeline": "ek = tkey;"
    },
    {
        "line": 159,
        "fullcodeline": "eklen = tkeylen;"
    },
    {
        "line": 160,
        "fullcodeline": "tkey = NULL;"
    },
    {
        "line": 188,
        "fullcodeline": "out = etmp;"
    },
    {
        "line": 196,
        "fullcodeline": "if (data_body->length > 0)"
    },
    {
        "line": 202,
        "fullcodeline": "if (bio == NULL)"
    },
    {
        "line": 72,
        "fullcodeline": "if ((btmp = BIO_new(BIO_f_md())) == NULL) {"
    },
    {
        "line": 79,
        "fullcodeline": "if (evp_md == NULL) {"
    },
    {
        "line": 86,
        "fullcodeline": "if (out == NULL)"
    },
    {
        "line": 111,
        "fullcodeline": "for (i = 0; i < sk_PKCS7_RECIP_INFO_num(rsk); i++) {"
    },
    {
        "line": 117,
        "fullcodeline": "if (ri == NULL) {"
    },
    {
        "line": 130,
        "fullcodeline": "for (i = 0; i < sk_PKCS7_RECIP_INFO_num(rsk); i++) {"
    },
    {
        "line": 141,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 169,
        "fullcodeline": "if (!EVP_CIPHER_CTX_set_key_length(evp_ctx, eklen)) {"
    },
    {
        "line": 190,
        "fullcodeline": "BIO_push(out, etmp);"
    },
    {
        "line": 197,
        "fullcodeline": "bio = BIO_new_mem_buf(data_body->data, data_body->length);"
    },
    {
        "line": 73,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE, ERR_R_BIO_LIB);"
    },
    {
        "line": 80,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE,"
    },
    {
        "line": 87,
        "fullcodeline": "out = btmp;"
    },
    {
        "line": 112,
        "fullcodeline": "ri = sk_PKCS7_RECIP_INFO_value(rsk, i);"
    },
    {
        "line": 115,
        "fullcodeline": "ri = NULL;"
    },
    {
        "line": 118,
        "fullcodeline": "PKCS7err(PKCS7_F_PKCS7_DATADECODE,"
    },
    {
        "line": 131,
        "fullcodeline": "ri = sk_PKCS7_RECIP_INFO_value(rsk, i);"
    },
    {
        "line": 135,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 139,
        "fullcodeline": "if (pkcs7_decrypt_rinfo(&ek, &eklen, ri, pkey) < 0)"
    },
    {
        "line": 171,
        "fullcodeline": "OPENSSL_clear_free(ek, eklen);"
    },
    {
        "line": 172,
        "fullcodeline": "ek = tkey;"
    },
    {
        "line": 173,
        "fullcodeline": "eklen = tkeylen;"
    },
    {
        "line": 174,
        "fullcodeline": "tkey = NULL;"
    },
    {
        "line": 199,
        "fullcodeline": "bio = BIO_new(BIO_s_mem());"
    },
    {
        "line": 200,
        "fullcodeline": "BIO_set_mem_eof_return(bio, 0);"
    },
    {
        "line": 89,
        "fullcodeline": "BIO_push(out, btmp);"
    },
    {
        "line": 113,
        "fullcodeline": "if (!pkcs7_cmp_ri(ri, pcert))"
    },
    {
        "line": 133,
        "fullcodeline": "if (pkcs7_decrypt_rinfo(&ek, &eklen, ri, pkey) < 0)"
    }
]