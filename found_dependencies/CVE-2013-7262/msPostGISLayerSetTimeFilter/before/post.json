[
    {
        "line": 3,
        "fullcodeline": "char **atimes, **aranges = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "int numtimes=0,i=0,numranges=0;"
    },
    {
        "line": 5,
        "fullcodeline": "size_t buffer_size = 512;"
    },
    {
        "line": 6,
        "fullcodeline": "char buffer[512], bufferTmp[512];"
    },
    {
        "line": 8,
        "fullcodeline": "buffer[0] = '\\0';"
    },
    {
        "line": 9,
        "fullcodeline": "bufferTmp[0] = '\\0';"
    },
    {
        "line": 54,
        "fullcodeline": "lp->filteritem = msStrdup(timefield);"
    },
    {
        "line": 11,
        "fullcodeline": "if (!lp || !timestring || !timefield)"
    },
    {
        "line": 15,
        "fullcodeline": "if (strstr(timestring, \",\") == NULL &&"
    },
    {
        "line": 50,
        "fullcodeline": "if(!*buffer) {"
    },
    {
        "line": 16,
        "fullcodeline": "strstr(timestring, \"/\") == NULL) { /* discrete time */"
    },
    {
        "line": 17,
        "fullcodeline": "createPostgresTimeCompareSimple(timefield, timestring, buffer, buffer_size);"
    },
    {
        "line": 53,
        "fullcodeline": "if(lp->filteritem) free(lp->filteritem);"
    },
    {
        "line": 21,
        "fullcodeline": "atimes = msStringSplit (timestring, ',', &numtimes);"
    },
    {
        "line": 25,
        "fullcodeline": "strlcat(buffer, \"(\", buffer_size);"
    },
    {
        "line": 47,
        "fullcodeline": "strlcat(buffer, \")\", buffer_size);"
    },
    {
        "line": 48,
        "fullcodeline": "msFreeCharArray(atimes, numtimes);"
    },
    {
        "line": 58,
        "fullcodeline": "if (lp->filter.type == MS_EXPRESSION) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (atimes == NULL || numtimes < 1)"
    },
    {
        "line": 26,
        "fullcodeline": "for(i=0; i<numtimes; i++) {"
    },
    {
        "line": 59,
        "fullcodeline": "snprintf(bufferTmp, buffer_size, \"(%s) and %s\", lp->filter.string, buffer);"
    },
    {
        "line": 60,
        "fullcodeline": "loadExpressionString(&lp->filter, bufferTmp);"
    },
    {
        "line": 30,
        "fullcodeline": "strlcat(buffer, \"(\", buffer_size);"
    },
    {
        "line": 31,
        "fullcodeline": "aranges = msStringSplit(atimes[i],  '/', &numranges);"
    },
    {
        "line": 44,
        "fullcodeline": "msFreeCharArray(aranges, numranges);"
    },
    {
        "line": 45,
        "fullcodeline": "strlcat(buffer, \")\", buffer_size);"
    },
    {
        "line": 62,
        "fullcodeline": "freeExpression(&lp->filter);"
    },
    {
        "line": 63,
        "fullcodeline": "loadExpressionString(&lp->filter, buffer);"
    },
    {
        "line": 27,
        "fullcodeline": "if(i!=0) {"
    },
    {
        "line": 32,
        "fullcodeline": "if(!aranges) return MS_FALSE;"
    },
    {
        "line": 33,
        "fullcodeline": "if(numranges == 1) {"
    },
    {
        "line": 28,
        "fullcodeline": "strlcat(buffer, \" OR \", buffer_size);"
    },
    {
        "line": 35,
        "fullcodeline": "createPostgresTimeCompareSimple(timefield, atimes[i], bufferTmp, buffer_size);"
    },
    {
        "line": 36,
        "fullcodeline": "strlcat(buffer, bufferTmp, buffer_size);"
    },
    {
        "line": 37,
        "fullcodeline": "} else if(numranges == 2) {"
    },
    {
        "line": 39,
        "fullcodeline": "createPostgresTimeCompareRange(timefield, aranges[0], aranges[1], bufferTmp, buffer_size);"
    },
    {
        "line": 40,
        "fullcodeline": "strlcat(buffer, bufferTmp, buffer_size);"
    }
]