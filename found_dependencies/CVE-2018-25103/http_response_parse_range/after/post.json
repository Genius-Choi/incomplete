[
    {
        "line": 2,
        "fullcodeline": "int multipart = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "char *boundary = \"fkj49sn38dcn3\";"
    },
    {
        "line": 8,
        "fullcodeline": "buffer *content_type = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "start = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "end = sce->st.st_size - 1;"
    },
    {
        "line": 13,
        "fullcodeline": "con->response.content_length = 0;"
    },
    {
        "line": 15,
        "fullcodeline": "if (NULL != (ds = (data_string *)array_get_element(con->response.headers, \"Content-Type\"))) {"
    },
    {
        "line": 20,
        "fullcodeline": "!error && *s && NULL != (minus = strchr(s, '-')); ) {"
    },
    {
        "line": 16,
        "fullcodeline": "content_type = ds->value;"
    },
    {
        "line": 19,
        "fullcodeline": "for (s = range, error = 0;"
    },
    {
        "line": 164,
        "fullcodeline": "buffer *b = buffer_init();"
    },
    {
        "line": 166,
        "fullcodeline": "buffer_copy_string_len(b, \"\\r\\n--\", 4);"
    },
    {
        "line": 167,
        "fullcodeline": "buffer_append_string(b, boundary);"
    },
    {
        "line": 168,
        "fullcodeline": "buffer_append_string_len(b, \"--\\r\\n\", 4);"
    },
    {
        "line": 170,
        "fullcodeline": "con->response.content_length += buffer_string_length(b);"
    },
    {
        "line": 171,
        "fullcodeline": "chunkqueue_append_buffer(con->write_queue, b);"
    },
    {
        "line": 172,
        "fullcodeline": "buffer_free(b);"
    },
    {
        "line": 176,
        "fullcodeline": "buffer_copy_string_len(srv->tmp_buf, CONST_STR_LEN(\"multipart/byteranges; boundary=\"));"
    },
    {
        "line": 177,
        "fullcodeline": "buffer_append_string(srv->tmp_buf, boundary);"
    },
    {
        "line": 180,
        "fullcodeline": "response_header_overwrite(srv, con, CONST_STR_LEN(\"Content-Type\"), CONST_BUF_LEN(srv->tmp_buf));"
    },
    {
        "line": 24,
        "fullcodeline": "if (s != minus) {"
    },
    {
        "line": 39,
        "fullcodeline": "if (s == minus) {"
    },
    {
        "line": 114,
        "fullcodeline": "if (!error) {"
    },
    {
        "line": 127,
        "fullcodeline": "if (!error) {"
    },
    {
        "line": 160,
        "fullcodeline": "if (error) return -1;"
    },
    {
        "line": 184,
        "fullcodeline": "buffer_copy_string_len(srv->tmp_buf, CONST_STR_LEN(\"bytes \"));"
    },
    {
        "line": 185,
        "fullcodeline": "buffer_append_int(srv->tmp_buf, start);"
    },
    {
        "line": 186,
        "fullcodeline": "buffer_append_string_len(srv->tmp_buf, CONST_STR_LEN(\"-\"));"
    },
    {
        "line": 187,
        "fullcodeline": "buffer_append_int(srv->tmp_buf, end);"
    },
    {
        "line": 188,
        "fullcodeline": "buffer_append_string_len(srv->tmp_buf, CONST_STR_LEN(\"/\"));"
    },
    {
        "line": 189,
        "fullcodeline": "buffer_append_int(srv->tmp_buf, sce->st.st_size);"
    },
    {
        "line": 191,
        "fullcodeline": "response_header_insert(srv, con, CONST_STR_LEN(\"Content-Range\"), CONST_BUF_LEN(srv->tmp_buf));"
    },
    {
        "line": 25,
        "fullcodeline": "la = strtoll(s, &err, 10);"
    },
    {
        "line": 42,
        "fullcodeline": "le = strtoll(s, &err, 10);"
    },
    {
        "line": 154,
        "fullcodeline": "chunkqueue_append_file(con->write_queue, path, start, end - start + 1);"
    },
    {
        "line": 155,
        "fullcodeline": "con->response.content_length += end - start + 1;"
    },
    {
        "line": 26,
        "fullcodeline": "if (err != minus) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (le == 0) {"
    },
    {
        "line": 115,
        "fullcodeline": "if (start < 0) start = 0;"
    },
    {
        "line": 118,
        "fullcodeline": "if (end > sce->st.st_size - 1) end = sce->st.st_size - 1;"
    },
    {
        "line": 120,
        "fullcodeline": "if (start > sce->st.st_size - 1) {"
    },
    {
        "line": 31,
        "fullcodeline": "s += 6;"
    },
    {
        "line": 47,
        "fullcodeline": "con->http_status = 416;"
    },
    {
        "line": 48,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 65,
        "fullcodeline": "} else if (*(minus+1) == '\\0' || *(minus+1) == ',') {"
    },
    {
        "line": 121,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 123,
        "fullcodeline": "con->http_status = 416;"
    },
    {
        "line": 130,
        "fullcodeline": "buffer *b = buffer_init();"
    },
    {
        "line": 132,
        "fullcodeline": "buffer_copy_string_len(b, CONST_STR_LEN(\"\\r\\n--\"));"
    },
    {
        "line": 133,
        "fullcodeline": "buffer_append_string(b, boundary);"
    },
    {
        "line": 136,
        "fullcodeline": "buffer_append_string_len(b, CONST_STR_LEN(\"\\r\\nContent-Range: bytes \"));"
    },
    {
        "line": 137,
        "fullcodeline": "buffer_append_int(b, start);"
    },
    {
        "line": 138,
        "fullcodeline": "buffer_append_string_len(b, CONST_STR_LEN(\"-\"));"
    },
    {
        "line": 139,
        "fullcodeline": "buffer_append_int(b, end);"
    },
    {
        "line": 140,
        "fullcodeline": "buffer_append_string_len(b, CONST_STR_LEN(\"/\"));"
    },
    {
        "line": 141,
        "fullcodeline": "buffer_append_int(b, sce->st.st_size);"
    },
    {
        "line": 143,
        "fullcodeline": "buffer_append_string_len(b, CONST_STR_LEN(\"\\r\\nContent-Type: \"));"
    },
    {
        "line": 144,
        "fullcodeline": "buffer_append_string_buffer(b, content_type);"
    },
    {
        "line": 147,
        "fullcodeline": "buffer_append_string_len(b, CONST_STR_LEN(\"\\r\\n\\r\\n\"));"
    },
    {
        "line": 149,
        "fullcodeline": "con->response.content_length += buffer_string_length(b);"
    },
    {
        "line": 150,
        "fullcodeline": "chunkqueue_append_buffer(con->write_queue, b);"
    },
    {
        "line": 151,
        "fullcodeline": "buffer_free(b);"
    },
    {
        "line": 29,
        "fullcodeline": "while (*s == ' ' || *s == '\\t') ++s;"
    },
    {
        "line": 30,
        "fullcodeline": "if (0 != strncmp(s, \"bytes=\", 6)) return -1;"
    },
    {
        "line": 32,
        "fullcodeline": "if (s != minus) {"
    },
    {
        "line": 33,
        "fullcodeline": "la = strtoll(s, &err, 10);"
    },
    {
        "line": 49,
        "fullcodeline": "} else if (*err == '\\0') {"
    },
    {
        "line": 70,
        "fullcodeline": "if (*(err + 1) == '\\0') {"
    },
    {
        "line": 88,
        "fullcodeline": "le = strtoll(minus+1, &err, 10);"
    },
    {
        "line": 34,
        "fullcodeline": "if (err != minus) return -1;"
    },
    {
        "line": 51,
        "fullcodeline": "s = err;"
    },
    {
        "line": 53,
        "fullcodeline": "end = sce->st.st_size - 1;"
    },
    {
        "line": 54,
        "fullcodeline": "start = sce->st.st_size + le;"
    },
    {
        "line": 71,
        "fullcodeline": "s = err + 1;"
    },
    {
        "line": 73,
        "fullcodeline": "end = sce->st.st_size - 1;"
    },
    {
        "line": 74,
        "fullcodeline": "start = la;"
    },
    {
        "line": 91,
        "fullcodeline": "if (la > le) {"
    },
    {
        "line": 95,
        "fullcodeline": "if (*err == '\\0') {"
    },
    {
        "line": 92,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 97,
        "fullcodeline": "s = err;"
    },
    {
        "line": 99,
        "fullcodeline": "end = le;"
    },
    {
        "line": 100,
        "fullcodeline": "start = la;"
    },
    {
        "line": 55,
        "fullcodeline": "} else if (*err == ',') {"
    },
    {
        "line": 76,
        "fullcodeline": "} else if (*(err + 1) == ',') {"
    },
    {
        "line": 56,
        "fullcodeline": "multipart = 1;"
    },
    {
        "line": 57,
        "fullcodeline": "s = err + 1;"
    },
    {
        "line": 59,
        "fullcodeline": "end = sce->st.st_size - 1;"
    },
    {
        "line": 60,
        "fullcodeline": "start = sce->st.st_size + le;"
    },
    {
        "line": 77,
        "fullcodeline": "multipart = 1;"
    },
    {
        "line": 78,
        "fullcodeline": "s = err + 2;"
    },
    {
        "line": 80,
        "fullcodeline": "end = sce->st.st_size - 1;"
    },
    {
        "line": 81,
        "fullcodeline": "start = la;"
    },
    {
        "line": 101,
        "fullcodeline": "} else if (*err == ',') {"
    },
    {
        "line": 62,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 83,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 102,
        "fullcodeline": "multipart = 1;"
    },
    {
        "line": 103,
        "fullcodeline": "s = err + 1;"
    },
    {
        "line": 105,
        "fullcodeline": "end = le;"
    },
    {
        "line": 106,
        "fullcodeline": "start = la;"
    },
    {
        "line": 110,
        "fullcodeline": "error = 1;"
    }
]