[
    {
        "line": 2,
        "fullcodeline": "valid_http_methods :get, :post, :put"
    },
    {
        "line": 4,
        "fullcodeline": "prj = nil"
    },
    {
        "line": 5,
        "fullcodeline": "unless params[:project] == \"_dispatchprios\""
    },
    {
        "line": 6,
        "fullcodeline": "prj = DbProject.get_by_name params[:project]"
    },
    {
        "line": 14,
        "fullcodeline": "allowed = false"
    },
    {
        "line": 16,
        "fullcodeline": "allowed = true if permissions.project_change? prj"
    },
    {
        "line": 15,
        "fullcodeline": "allowed = true if permissions.global_project_change"
    },
    {
        "line": 25,
        "fullcodeline": "unless [\"wipe\", \"restartbuild\", \"killbuild\", \"abortbuild\", \"rebuild\"].include? params[:cmd]"
    },
    {
        "line": 31,
        "fullcodeline": "unless prj.class == DbProject"
    },
    {
        "line": 37,
        "fullcodeline": "if not allowed and not params[:package].nil?"
    },
    {
        "line": 27,
        "fullcodeline": ":message => \"unsupported POST command #{params[:cmd]} to #{request.request_uri}\""
    },
    {
        "line": 33,
        "fullcodeline": ":message => \"The project #{params[:project]} is a remote project and therefore readonly.\""
    },
    {
        "line": 66,
        "fullcodeline": ":message => \"No permission to execute command on project #{params[:project]}\""
    },
    {
        "line": 82,
        "fullcodeline": ":message => \"Illegal request: #{request.method.to_s.upcase} #{request.path}\""
    },
    {
        "line": 40,
        "fullcodeline": "package_names = params[:package]"
    },
    {
        "line": 42,
        "fullcodeline": "package_names = [params[:package]]"
    },
    {
        "line": 39,
        "fullcodeline": "if params[:package].kind_of? Array"
    },
    {
        "line": 77,
        "fullcodeline": ":message => \"No permission to execute command on project #{params[:project]}\""
    }
]