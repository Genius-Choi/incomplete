[
    {
        "line": 11,
        "fullcodeline": "verification_key = flask.request.args.get(\"v\", \"\")"
    },
    {
        "line": 12,
        "fullcodeline": "length = int(flask.request.headers.get(\"Content-Length\", 0))"
    },
    {
        "line": 13,
        "fullcodeline": "hmac_input = \"{} {}\".format(path, length).encode(\"utf-8\")"
    },
    {
        "line": 14,
        "fullcodeline": "key = app.config[\"SECRET_KEY\"]"
    },
    {
        "line": 15,
        "fullcodeline": "mac = hmac.new(key, hmac_input, hashlib.sha256)"
    },
    {
        "line": 16,
        "fullcodeline": "digest = mac.hexdigest()"
    },
    {
        "line": 25,
        "fullcodeline": "content_type = flask.request.headers.get("
    },
    {
        "line": 30,
        "fullcodeline": "data_file.parent.mkdir(parents=True, exist_ok=True, mode=0o770)"
    },
    {
        "line": 58,
        "fullcodeline": "return flask.Response("
    },
    {
        "line": 18,
        "fullcodeline": "if not hmac.compare_digest(digest, verification_key):"
    },
    {
        "line": 3,
        "fullcodeline": "data_file, metadata_file = get_paths(app.config[\"DATA_ROOT\"], path)"
    },
    {
        "line": 19,
        "fullcodeline": "return flask.Response("
    },
    {
        "line": 33,
        "fullcodeline": "with write_file(data_file) as fout:"
    },
    {
        "line": 5,
        "fullcodeline": "return flask.Response("
    },
    {
        "line": 44,
        "fullcodeline": "return flask.Response("
    },
    {
        "line": 36,
        "fullcodeline": "with metadata_file.open(\"x\") as f:"
    },
    {
        "line": 51,
        "fullcodeline": "return flask.Response("
    },
    {
        "line": 38,
        "fullcodeline": "{"
    },
    {
        "line": 39,
        "fullcodeline": "\"headers\": {\"Content-Type\": content_type},"
    }
]