[
    {
        "line": 7,
        "fullcodeline": "auto shard = [&grad_in, &argmax, &grad_out, include_batch_in_index]("
    },
    {
        "line": 41,
        "fullcodeline": "const int64 batch_size = GetTensorDim(grad_out->shape(), FORMAT_NHWC, 'N');"
    },
    {
        "line": 42,
        "fullcodeline": "const int64 shard_cost = grad_out->NumElements() / batch_size;"
    },
    {
        "line": 43,
        "fullcodeline": "Shard(worker_threads.num_threads, worker_threads.workers, batch_size,"
    },
    {
        "line": 5,
        "fullcodeline": "*(context->device()->tensorflow_cpu_worker_threads());"
    }
]