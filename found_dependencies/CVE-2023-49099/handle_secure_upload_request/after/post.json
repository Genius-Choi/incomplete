[
    {
        "line": 10,
        "fullcodeline": "cache_seconds ="
    },
    {
        "line": 12,
        "fullcodeline": "expires_in cache_seconds.seconds"
    },
    {
        "line": 1,
        "fullcodeline": "def handle_secure_upload_request(upload, path_with_ext = nil)"
    },
    {
        "line": 11,
        "fullcodeline": "SiteSetting.s3_presigned_get_url_expires_after_seconds - SECURE_REDIRECT_GRACE_SECONDS"
    },
    {
        "line": 23,
        "fullcodeline": "redirect_to Discourse.store.signed_url_for_path("
    },
    {
        "line": 2,
        "fullcodeline": "if upload.access_control_post_id.present?"
    },
    {
        "line": 4,
        "fullcodeline": "raise Discourse::InvalidAccess if !guardian.can_see?(upload.access_control_post)"
    },
    {
        "line": 18,
        "fullcodeline": "redirect_to Discourse.store.url_for(upload, force_download: force_download?),"
    },
    {
        "line": 26,
        "fullcodeline": "force_download: force_download?,"
    }
]