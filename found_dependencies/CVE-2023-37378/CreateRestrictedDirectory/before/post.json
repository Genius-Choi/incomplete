[
    {
        "line": 3,
        "fullcodeline": "const SECURITY_INFORMATION si = OWNER_SECURITY_INFORMATION|GROUP_SECURITY_INFORMATION|DACL_SECURITY_INFORMATION|PROTECTED_DACL_SECURITY_INFORMATION;"
    },
    {
        "line": 4,
        "fullcodeline": "PSID admingrpsid = GetAdminGrpSid();"
    },
    {
        "line": 5,
        "fullcodeline": "SECURITY_DESCRIPTOR sd = { 1, 0, SE_DACL_PRESENT, admingrpsid, admingrpsid, NULL, GetAdminGrpAcl() };"
    },
    {
        "line": 6,
        "fullcodeline": "SECURITY_ATTRIBUTES sa = { sizeof(SECURITY_ATTRIBUTES), &sd, FALSE };"
    },
    {
        "line": 7,
        "fullcodeline": "DWORD ec = CreateDirectory(path, &sa) ? ERROR_SUCCESS : GetLastError();"
    },
    {
        "line": 8,
        "fullcodeline": "if (ERROR_ALREADY_EXISTS == ec)"
    },
    {
        "line": 9,
        "fullcodeline": "ec = SetFileSecurity(path, si, &sd) ? ERROR_SUCCESS : GetLastError();"
    }
]