[
    {
        "line": 18,
        "fullcodeline": "auth_context = get_auth_context()"
    },
    {
        "line": 19,
        "fullcodeline": "assert auth_context"
    },
    {
        "line": 21,
        "fullcodeline": "permissions = rbac().check_permissions("
    },
    {
        "line": 25,
        "fullcodeline": "for resource in resources:"
    },
    {
        "line": 26,
        "fullcodeline": "if resource not in permissions:"
    },
    {
        "line": 34,
        "fullcodeline": "if not permissions[resource]:"
    },
    {
        "line": 29,
        "fullcodeline": "raise RuntimeError("
    },
    {
        "line": 35,
        "fullcodeline": "raise IllegalOperationError("
    },
    {
        "line": 30,
        "fullcodeline": "f\"Failed to verify permissions to {action.upper()} resource \""
    },
    {
        "line": 36,
        "fullcodeline": "message=f\"Insufficient permissions to {action.upper()} \""
    },
    {
        "line": 31,
        "fullcodeline": "f\"'{resource}'.\""
    },
    {
        "line": 37,
        "fullcodeline": "f\"resource '{resource}'.\","
    }
]