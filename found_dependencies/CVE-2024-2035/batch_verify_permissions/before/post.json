[
    {
        "line": 15,
        "fullcodeline": "auth_context = get_auth_context()"
    },
    {
        "line": 16,
        "fullcodeline": "assert auth_context"
    },
    {
        "line": 18,
        "fullcodeline": "permissions = rbac().check_permissions("
    },
    {
        "line": 22,
        "fullcodeline": "for resource in resources:"
    },
    {
        "line": 23,
        "fullcodeline": "if resource not in permissions:"
    },
    {
        "line": 31,
        "fullcodeline": "if not permissions[resource]:"
    },
    {
        "line": 26,
        "fullcodeline": "raise RuntimeError("
    },
    {
        "line": 32,
        "fullcodeline": "raise IllegalOperationError("
    },
    {
        "line": 27,
        "fullcodeline": "f\"Failed to verify permissions to {action.upper()} resource \""
    },
    {
        "line": 33,
        "fullcodeline": "message=f\"Insufficient permissions to {action.upper()} \""
    },
    {
        "line": 28,
        "fullcodeline": "f\"'{resource}'.\""
    },
    {
        "line": 34,
        "fullcodeline": "f\"resource '{resource}'.\","
    }
]