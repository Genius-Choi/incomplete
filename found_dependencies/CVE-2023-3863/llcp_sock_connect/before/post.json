[
    {
        "line": 4,
        "fullcodeline": "struct sock *sk = sock->sk;"
    },
    {
        "line": 5,
        "fullcodeline": "struct nfc_llcp_sock *llcp_sock = nfc_llcp_sock(sk);"
    },
    {
        "line": 6,
        "fullcodeline": "struct sockaddr_nfc_llcp *addr = (struct sockaddr_nfc_llcp *)_addr;"
    },
    {
        "line": 9,
        "fullcodeline": "int ret = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "pr_debug(\"sock %p sk %p flags 0x%x\\n\", sock, sk, flags);"
    },
    {
        "line": 19,
        "fullcodeline": "pr_debug(\"addr dev_idx=%u target_idx=%u protocol=%u\\n\", addr->dev_idx,"
    },
    {
        "line": 22,
        "fullcodeline": "lock_sock(sk);"
    },
    {
        "line": 33,
        "fullcodeline": "dev = nfc_get_device(addr->dev_idx);"
    },
    {
        "line": 39,
        "fullcodeline": "local = nfc_llcp_find_local(dev);"
    },
    {
        "line": 45,
        "fullcodeline": "device_lock(&dev->dev);"
    },
    {
        "line": 51,
        "fullcodeline": "device_unlock(&dev->dev);"
    },
    {
        "line": 59,
        "fullcodeline": "llcp_sock->dev = dev;"
    },
    {
        "line": 60,
        "fullcodeline": "llcp_sock->local = nfc_llcp_local_get(local);"
    },
    {
        "line": 61,
        "fullcodeline": "llcp_sock->ssap = nfc_llcp_get_local_ssap(local);"
    },
    {
        "line": 67,
        "fullcodeline": "llcp_sock->reserved_ssap = llcp_sock->ssap;"
    },
    {
        "line": 73,
        "fullcodeline": "llcp_sock->nfc_protocol = addr->nfc_protocol;"
    },
    {
        "line": 77,
        "fullcodeline": "llcp_sock->service_name = kmemdup(addr->service_name,"
    },
    {
        "line": 85,
        "fullcodeline": "nfc_llcp_sock_link(&local->connecting_sockets, sk);"
    },
    {
        "line": 87,
        "fullcodeline": "ret = nfc_llcp_send_connect(llcp_sock);"
    },
    {
        "line": 91,
        "fullcodeline": "sk->sk_state = LLCP_CONNECTING;"
    },
    {
        "line": 93,
        "fullcodeline": "ret = sock_wait_state(sk, LLCP_CONNECTED,"
    },
    {
        "line": 98,
        "fullcodeline": "release_sock(sk);"
    },
    {
        "line": 103,
        "fullcodeline": "nfc_llcp_sock_unlink(&local->connecting_sockets, sk);"
    },
    {
        "line": 104,
        "fullcodeline": "kfree(llcp_sock->service_name);"
    },
    {
        "line": 105,
        "fullcodeline": "llcp_sock->service_name = NULL;"
    },
    {
        "line": 108,
        "fullcodeline": "nfc_llcp_put_ssap(local, llcp_sock->ssap);"
    },
    {
        "line": 111,
        "fullcodeline": "nfc_llcp_local_put(llcp_sock->local);"
    },
    {
        "line": 112,
        "fullcodeline": "llcp_sock->local = NULL;"
    },
    {
        "line": 113,
        "fullcodeline": "llcp_sock->dev = NULL;"
    },
    {
        "line": 116,
        "fullcodeline": "nfc_put_device(dev);"
    },
    {
        "line": 119,
        "fullcodeline": "release_sock(sk);"
    },
    {
        "line": 13,
        "fullcodeline": "if (!addr || len < sizeof(*addr) || addr->sa_family != AF_NFC)"
    },
    {
        "line": 16,
        "fullcodeline": "if (addr->service_name_len == 0 && addr->dsap == 0)"
    },
    {
        "line": 24,
        "fullcodeline": "if (sk->sk_state == LLCP_CONNECTED) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (sk->sk_state == LLCP_CONNECTING) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (dev == NULL) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (local == NULL) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (dev->dep_link_up == false) {"
    },
    {
        "line": 53,
        "fullcodeline": "if (local->rf_mode == NFC_RF_INITIATOR &&"
    },
    {
        "line": 62,
        "fullcodeline": "if (llcp_sock->ssap == LLCP_SAP_MAX) {"
    },
    {
        "line": 69,
        "fullcodeline": "if (addr->service_name_len == 0)"
    },
    {
        "line": 80,
        "fullcodeline": "if (!llcp_sock->service_name) {"
    },
    {
        "line": 95,
        "fullcodeline": "if (ret && ret != -EINPROGRESS)"
    },
    {
        "line": 25,
        "fullcodeline": "ret = -EISCONN;"
    },
    {
        "line": 29,
        "fullcodeline": "ret = -EINPROGRESS;"
    },
    {
        "line": 35,
        "fullcodeline": "ret = -ENODEV;"
    },
    {
        "line": 41,
        "fullcodeline": "ret = -ENODEV;"
    },
    {
        "line": 47,
        "fullcodeline": "ret = -ENOLINK;"
    },
    {
        "line": 48,
        "fullcodeline": "device_unlock(&dev->dev);"
    },
    {
        "line": 54,
        "fullcodeline": "addr->target_idx != local->target_idx) {"
    },
    {
        "line": 55,
        "fullcodeline": "ret = -ENOLINK;"
    },
    {
        "line": 63,
        "fullcodeline": "ret = -ENOMEM;"
    },
    {
        "line": 70,
        "fullcodeline": "llcp_sock->dsap = addr->dsap;"
    },
    {
        "line": 81,
        "fullcodeline": "ret = -ENOMEM;"
    },
    {
        "line": 94,
        "fullcodeline": "sock_sndtimeo(sk, flags & O_NONBLOCK));"
    },
    {
        "line": 14,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 17,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 72,
        "fullcodeline": "llcp_sock->dsap = LLCP_SAP_SDP;"
    }
]