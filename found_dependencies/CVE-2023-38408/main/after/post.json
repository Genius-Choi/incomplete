[
    {
        "line": 3,
        "fullcodeline": "int c_flag = 0, d_flag = 0, D_flag = 0, k_flag = 0, s_flag = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "char *shell, *format, *pidstr, *agentsocket = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "char pidstrbuf[1 + 3 * sizeof pid];"
    },
    {
        "line": 13,
        "fullcodeline": "int timeout = -1; /* INFTIM */"
    },
    {
        "line": 14,
        "fullcodeline": "struct pollfd *pfd = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "size_t npfd = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "sanitise_stdfd();"
    },
    {
        "line": 22,
        "fullcodeline": "(void)setegid(getgid());"
    },
    {
        "line": 23,
        "fullcodeline": "(void)setgid(getgid());"
    },
    {
        "line": 88,
        "fullcodeline": "ac -= optind;"
    },
    {
        "line": 89,
        "fullcodeline": "av += optind;"
    },
    {
        "line": 139,
        "fullcodeline": "maxfds = rlim.rlim_cur - SSH_AGENT_MIN_FDS;"
    },
    {
        "line": 141,
        "fullcodeline": "parent_pid = getpid();"
    },
    {
        "line": 162,
        "fullcodeline": "prev_mask = umask(0177);"
    },
    {
        "line": 163,
        "fullcodeline": "sock = unix_listener(socket_name, SSH_LISTEN_BACKLOG, 0);"
    },
    {
        "line": 169,
        "fullcodeline": "umask(prev_mask);"
    },
    {
        "line": 186,
        "fullcodeline": "pid = fork();"
    },
    {
        "line": 213,
        "fullcodeline": "log_init(__progname, SYSLOG_LEVEL_INFO, SYSLOG_FACILITY_AUTH, 0);"
    },
    {
        "line": 220,
        "fullcodeline": "(void)chdir(\"/\");"
    },
    {
        "line": 225,
        "fullcodeline": "rlim.rlim_cur = rlim.rlim_max = 0;"
    },
    {
        "line": 233,
        "fullcodeline": "cleanup_pid = getpid();"
    },
    {
        "line": 238,
        "fullcodeline": "new_socket(AUTH_SOCKET, sock);"
    },
    {
        "line": 241,
        "fullcodeline": "idtab_init();"
    },
    {
        "line": 242,
        "fullcodeline": "ssh_signal(SIGPIPE, SIG_IGN);"
    },
    {
        "line": 243,
        "fullcodeline": "ssh_signal(SIGINT, (d_flag | D_flag) ? cleanup_handler : SIG_IGN);"
    },
    {
        "line": 244,
        "fullcodeline": "ssh_signal(SIGHUP, cleanup_handler);"
    },
    {
        "line": 245,
        "fullcodeline": "ssh_signal(SIGTERM, cleanup_handler);"
    },
    {
        "line": 25,
        "fullcodeline": "if (getrlimit(RLIMIT_NOFILE, &rlim) == -1)"
    },
    {
        "line": 32,
        "fullcodeline": "while ((ch = getopt(ac, av, \"cDdksE:a:O:P:t:\")) != -1) {"
    },
    {
        "line": 91,
        "fullcodeline": "if (ac > 0 && (c_flag || k_flag || s_flag || d_flag || D_flag))"
    },
    {
        "line": 94,
        "fullcodeline": "if (allowed_providers == NULL)"
    },
    {
        "line": 97,
        "fullcodeline": "if (ac == 0 && !c_flag && !s_flag) {"
    },
    {
        "line": 136,
        "fullcodeline": "if (rlim.rlim_cur < SSH_AGENT_MIN_FDS)"
    },
    {
        "line": 143,
        "fullcodeline": "if (agentsocket == NULL) {"
    },
    {
        "line": 164,
        "fullcodeline": "if (sock < 0) {"
    },
    {
        "line": 175,
        "fullcodeline": "if (D_flag || d_flag) {"
    },
    {
        "line": 187,
        "fullcodeline": "if (pid == -1) {"
    },
    {
        "line": 191,
        "fullcodeline": "if (pid != 0) {\t\t/* Parent - execute the given command. */"
    },
    {
        "line": 215,
        "fullcodeline": "if (setsid() == -1) {"
    },
    {
        "line": 221,
        "fullcodeline": "if (stdfd_devnull(1, 1, 1) == -1)"
    },
    {
        "line": 226,
        "fullcodeline": "if (setrlimit(RLIMIT_CORE, &rlim) == -1) {"
    },
    {
        "line": 239,
        "fullcodeline": "if (ac > 0)"
    },
    {
        "line": 247,
        "fullcodeline": "if (pledge(\"stdio rpath cpath unix id proc exec\", NULL) == -1)"
    },
    {
        "line": 26,
        "fullcodeline": "fatal(\"%s: getrlimit: %s\", __progname, strerror(errno));"
    },
    {
        "line": 92,
        "fullcodeline": "usage();"
    },
    {
        "line": 95,
        "fullcodeline": "allowed_providers = xstrdup(DEFAULT_ALLOWED_PROVIDERS);"
    },
    {
        "line": 98,
        "fullcodeline": "shell = getenv(\"SHELL\");"
    },
    {
        "line": 104,
        "fullcodeline": "const char *errstr = NULL;"
    },
    {
        "line": 106,
        "fullcodeline": "pidstr = getenv(SSH_AGENTPID_ENV_NAME);"
    },
    {
        "line": 112,
        "fullcodeline": "pid = (int)strtonum(pidstr, 2, INT_MAX, &errstr);"
    },
    {
        "line": 123,
        "fullcodeline": "format = c_flag ? \"unsetenv %s;\\n\" : \"unset %s;\\n\";"
    },
    {
        "line": 124,
        "fullcodeline": "printf(format, SSH_AUTHSOCKET_ENV_NAME);"
    },
    {
        "line": 125,
        "fullcodeline": "printf(format, SSH_AGENTPID_ENV_NAME);"
    },
    {
        "line": 126,
        "fullcodeline": "printf(\"echo Agent pid %ld killed;\\n\", (long)pid);"
    },
    {
        "line": 127,
        "fullcodeline": "exit(0);"
    },
    {
        "line": 137,
        "fullcodeline": "fatal(\"%s: file descriptor rlimit %lld too low (minimum %u)\","
    },
    {
        "line": 145,
        "fullcodeline": "mktemp_proto(socket_dir, sizeof(socket_dir));"
    },
    {
        "line": 150,
        "fullcodeline": "snprintf(socket_name, sizeof socket_name, \"%s/agent.%ld\", socket_dir,"
    },
    {
        "line": 166,
        "fullcodeline": "*socket_name = '\\0'; /* Don't unlink any existing file */"
    },
    {
        "line": 167,
        "fullcodeline": "cleanup_exit(1);"
    },
    {
        "line": 176,
        "fullcodeline": "log_init(__progname,"
    },
    {
        "line": 179,
        "fullcodeline": "format = c_flag ? \"setenv %s %s;\\n\" : \"%s=%s; export %s;\\n\";"
    },
    {
        "line": 180,
        "fullcodeline": "printf(format, SSH_AUTHSOCKET_ENV_NAME, socket_name,"
    },
    {
        "line": 182,
        "fullcodeline": "printf(\"echo Agent pid %ld;\\n\", (long)parent_pid);"
    },
    {
        "line": 183,
        "fullcodeline": "fflush(stdout);"
    },
    {
        "line": 188,
        "fullcodeline": "perror(\"fork\");"
    },
    {
        "line": 189,
        "fullcodeline": "cleanup_exit(1);"
    },
    {
        "line": 192,
        "fullcodeline": "close(sock);"
    },
    {
        "line": 193,
        "fullcodeline": "snprintf(pidstrbuf, sizeof pidstrbuf, \"%ld\", (long)pid);"
    },
    {
        "line": 208,
        "fullcodeline": "execvp(av[0], av);"
    },
    {
        "line": 209,
        "fullcodeline": "perror(av[0]);"
    },
    {
        "line": 210,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 216,
        "fullcodeline": "error(\"setsid: %s\", strerror(errno));"
    },
    {
        "line": 217,
        "fullcodeline": "cleanup_exit(1);"
    },
    {
        "line": 222,
        "fullcodeline": "error_f(\"stdfd_devnull failed\");"
    },
    {
        "line": 227,
        "fullcodeline": "error(\"setrlimit RLIMIT_CORE: %s\", strerror(errno));"
    },
    {
        "line": 228,
        "fullcodeline": "cleanup_exit(1);"
    },
    {
        "line": 240,
        "fullcodeline": "parent_alive_interval = 10;"
    },
    {
        "line": 248,
        "fullcodeline": "fatal(\"%s: pledge: %s\", __progname, strerror(errno));"
    },
    {
        "line": 251,
        "fullcodeline": "prepare_poll(&pfd, &npfd, &timeout, maxfds);"
    },
    {
        "line": 252,
        "fullcodeline": "result = poll(pfd, npfd, timeout);"
    },
    {
        "line": 253,
        "fullcodeline": "saved_errno = errno;"
    },
    {
        "line": 256,
        "fullcodeline": "(void) reaper();\t/* remove expired keys */"
    },
    {
        "line": 99,
        "fullcodeline": "if (shell != NULL && (len = strlen(shell)) > 2 &&"
    },
    {
        "line": 107,
        "fullcodeline": "if (pidstr == NULL) {"
    },
    {
        "line": 119,
        "fullcodeline": "if (kill(pid, SIGTERM) == -1) {"
    },
    {
        "line": 138,
        "fullcodeline": "__progname, (long long)rlim.rlim_cur, SSH_AGENT_MIN_FDS);"
    },
    {
        "line": 146,
        "fullcodeline": "if (mkdtemp(socket_dir) == NULL) {"
    },
    {
        "line": 151,
        "fullcodeline": "(long)parent_pid);"
    },
    {
        "line": 154,
        "fullcodeline": "socket_dir[0] = '\\0';"
    },
    {
        "line": 155,
        "fullcodeline": "strlcpy(socket_name, agentsocket, sizeof socket_name);"
    },
    {
        "line": 177,
        "fullcodeline": "d_flag ? SYSLOG_LEVEL_DEBUG3 : SYSLOG_LEVEL_INFO,"
    },
    {
        "line": 194,
        "fullcodeline": "if (ac == 0) {"
    },
    {
        "line": 203,
        "fullcodeline": "if (setenv(SSH_AUTHSOCKET_ENV_NAME, socket_name, 1) == -1 ||"
    },
    {
        "line": 254,
        "fullcodeline": "if (parent_alive_interval != 0)"
    },
    {
        "line": 257,
        "fullcodeline": "if (result == -1) {"
    },
    {
        "line": 35,
        "fullcodeline": "fingerprint_hash = ssh_digest_alg_by_name(optarg);"
    },
    {
        "line": 42,
        "fullcodeline": "c_flag++;"
    },
    {
        "line": 45,
        "fullcodeline": "k_flag++;"
    },
    {
        "line": 58,
        "fullcodeline": "allowed_providers = xstrdup(optarg);"
    },
    {
        "line": 63,
        "fullcodeline": "s_flag++;"
    },
    {
        "line": 68,
        "fullcodeline": "d_flag++;"
    },
    {
        "line": 73,
        "fullcodeline": "D_flag++;"
    },
    {
        "line": 76,
        "fullcodeline": "agentsocket = optarg;"
    },
    {
        "line": 85,
        "fullcodeline": "usage();"
    },
    {
        "line": 100,
        "fullcodeline": "strncmp(shell + len - 3, \"csh\", 3) == 0)"
    },
    {
        "line": 101,
        "fullcodeline": "c_flag = 1;"
    },
    {
        "line": 108,
        "fullcodeline": "fprintf(stderr, \"%s not set, cannot kill agent\\n\","
    },
    {
        "line": 110,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 114,
        "fullcodeline": "fprintf(stderr,"
    },
    {
        "line": 117,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 120,
        "fullcodeline": "perror(\"kill\");"
    },
    {
        "line": 121,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 147,
        "fullcodeline": "perror(\"mkdtemp: private socket dir\");"
    },
    {
        "line": 148,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 195,
        "fullcodeline": "format = c_flag ? \"setenv %s %s;\\n\" : \"%s=%s; export %s;\\n\";"
    },
    {
        "line": 196,
        "fullcodeline": "printf(format, SSH_AUTHSOCKET_ENV_NAME, socket_name,"
    },
    {
        "line": 198,
        "fullcodeline": "printf(format, SSH_AGENTPID_ENV_NAME, pidstrbuf,"
    },
    {
        "line": 200,
        "fullcodeline": "printf(\"echo Agent pid %ld;\\n\", (long)pid);"
    },
    {
        "line": 201,
        "fullcodeline": "exit(0);"
    },
    {
        "line": 204,
        "fullcodeline": "setenv(SSH_AGENTPID_ENV_NAME, pidstrbuf, 1) == -1) {"
    },
    {
        "line": 205,
        "fullcodeline": "perror(\"setenv\");"
    },
    {
        "line": 206,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 255,
        "fullcodeline": "check_parent_exists();"
    },
    {
        "line": 260,
        "fullcodeline": "fatal(\"poll: %s\", strerror(saved_errno));"
    },
    {
        "line": 36,
        "fullcodeline": "if (fingerprint_hash == -1)"
    },
    {
        "line": 48,
        "fullcodeline": "if (strcmp(optarg, \"no-restrict-websafe\") == 0)"
    },
    {
        "line": 56,
        "fullcodeline": "if (allowed_providers != NULL)"
    },
    {
        "line": 66,
        "fullcodeline": "if (d_flag || D_flag)"
    },
    {
        "line": 71,
        "fullcodeline": "if (d_flag || D_flag)"
    },
    {
        "line": 79,
        "fullcodeline": "if ((lifetime = convtime(optarg)) == -1) {"
    },
    {
        "line": 258,
        "fullcodeline": "if (saved_errno == EINTR)"
    },
    {
        "line": 37,
        "fullcodeline": "fatal(\"Invalid hash algorithm \\\"%s\\\"\", optarg);"
    },
    {
        "line": 41,
        "fullcodeline": "usage();"
    },
    {
        "line": 49,
        "fullcodeline": "restrict_websafe = 0;"
    },
    {
        "line": 57,
        "fullcodeline": "fatal(\"-P option already specified\");"
    },
    {
        "line": 62,
        "fullcodeline": "usage();"
    },
    {
        "line": 67,
        "fullcodeline": "usage();"
    },
    {
        "line": 72,
        "fullcodeline": "usage();"
    },
    {
        "line": 80,
        "fullcodeline": "fprintf(stderr, \"Invalid lifetime\\n\");"
    },
    {
        "line": 81,
        "fullcodeline": "usage();"
    },
    {
        "line": 261,
        "fullcodeline": "} else if (result > 0)"
    },
    {
        "line": 262,
        "fullcodeline": "after_poll(pfd, npfd, maxfds);"
    },
    {
        "line": 50,
        "fullcodeline": "else if (strcmp(optarg, \"allow-remote-pkcs11\") == 0)"
    },
    {
        "line": 51,
        "fullcodeline": "remote_add_provider = 1;"
    },
    {
        "line": 53,
        "fullcodeline": "fatal(\"Unknown -O option\");"
    }
]