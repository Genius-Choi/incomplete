[
    {
        "line": 341,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 6,
        "fullcodeline": "for (op = ops; op != NULL; op = op->next)"
    },
    {
        "line": 8,
        "fullcodeline": "cleanup_free char *source = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "cleanup_free char *dest = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "int source_mode = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "if (op->source &&"
    },
    {
        "line": 26,
        "fullcodeline": "if (op->dest &&"
    },
    {
        "line": 14,
        "fullcodeline": "op->type != SETUP_MAKE_SYMLINK)"
    },
    {
        "line": 16,
        "fullcodeline": "source = get_oldroot_path (op->source);"
    },
    {
        "line": 17,
        "fullcodeline": "source_mode = get_file_mode (source);"
    },
    {
        "line": 27,
        "fullcodeline": "(op->flags & NO_CREATE_DEST) == 0)"
    },
    {
        "line": 29,
        "fullcodeline": "unsigned parent_mode = 0755;"
    },
    {
        "line": 43,
        "fullcodeline": "dest = get_newroot_path (op->dest);"
    },
    {
        "line": 61,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 93,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 120,
        "fullcodeline": "static const char * const cover_proc_dirs[] = { \"sys\", \"sysrq-trigger\", \"irq\", \"bus\" };"
    },
    {
        "line": 144,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 148,
        "fullcodeline": "static const char *const devnodes[] = { \"null\", \"zero\", \"full\", \"random\", \"urandom\", \"tty\" };"
    },
    {
        "line": 160,
        "fullcodeline": "static const char *const stdionodes[] = { \"stdin\", \"stdout\", \"stderr\" };"
    },
    {
        "line": 217,
        "fullcodeline": "assert (dest != NULL);"
    },
    {
        "line": 218,
        "fullcodeline": "assert (op->perms >= 0);"
    },
    {
        "line": 219,
        "fullcodeline": "assert (op->perms <= 07777);"
    },
    {
        "line": 224,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 233,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 239,
        "fullcodeline": "assert (dest != NULL);"
    },
    {
        "line": 240,
        "fullcodeline": "assert (op->perms >= 0);"
    },
    {
        "line": 241,
        "fullcodeline": "assert (op->perms <= 07777);"
    },
    {
        "line": 249,
        "fullcodeline": "assert (op->dest != NULL);"
    },
    {
        "line": 252,
        "fullcodeline": "assert (dest == NULL);"
    },
    {
        "line": 253,
        "fullcodeline": "dest = get_newroot_path (op->dest);"
    },
    {
        "line": 254,
        "fullcodeline": "assert (dest != NULL);"
    },
    {
        "line": 255,
        "fullcodeline": "assert (op->perms >= 0);"
    },
    {
        "line": 256,
        "fullcodeline": "assert (op->perms <= 07777);"
    },
    {
        "line": 325,
        "fullcodeline": "assert (op->source != NULL);  /* guaranteed by the constructor */"
    },
    {
        "line": 331,
        "fullcodeline": "assert (op->dest != NULL);  /* guaranteed by the constructor */"
    },
    {
        "line": 332,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 338,
        "fullcodeline": "die (\"Unexpected type %d\", op->type);"
    },
    {
        "line": 18,
        "fullcodeline": "if (source_mode < 0)"
    },
    {
        "line": 34,
        "fullcodeline": "if (op->perms >= 0 &&"
    },
    {
        "line": 39,
        "fullcodeline": "if (op->perms >= 0 &&"
    },
    {
        "line": 44,
        "fullcodeline": "if (mkdir_with_parents (dest, parent_mode, FALSE) != 0)"
    },
    {
        "line": 53,
        "fullcodeline": "if (source_mode == S_IFDIR)"
    },
    {
        "line": 63,
        "fullcodeline": "(op->type == SETUP_RO_BIND_MOUNT ? BIND_READONLY : 0) |"
    },
    {
        "line": 67,
        "fullcodeline": "if (op->fd >= 0)"
    },
    {
        "line": 98,
        "fullcodeline": "if (ensure_dir (dest, 0755) != 0)"
    },
    {
        "line": 101,
        "fullcodeline": "if (unshare_pid || opt_pidns_fd != -1)"
    },
    {
        "line": 121,
        "fullcodeline": "for (i = 0; i < N_ELEMENTS (cover_proc_dirs); i++)"
    },
    {
        "line": 141,
        "fullcodeline": "if (ensure_dir (dest, 0755) != 0)"
    },
    {
        "line": 149,
        "fullcodeline": "for (i = 0; i < N_ELEMENTS (devnodes); i++)"
    },
    {
        "line": 161,
        "fullcodeline": "for (i = 0; i < N_ELEMENTS (stdionodes); i++)"
    },
    {
        "line": 170,
        "fullcodeline": "{ cleanup_free char *dev_fd = strconcat (dest, \"/fd\");"
    },
    {
        "line": 174,
        "fullcodeline": "{ cleanup_free char *dev_core = strconcat (dest, \"/core\");"
    },
    {
        "line": 180,
        "fullcodeline": "cleanup_free char *pts = strconcat (dest, \"/pts\");"
    },
    {
        "line": 181,
        "fullcodeline": "cleanup_free char *ptmx = strconcat (dest, \"/ptmx\");"
    },
    {
        "line": 182,
        "fullcodeline": "cleanup_free char *shm = strconcat (dest, \"/shm\");"
    },
    {
        "line": 189,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 201,
        "fullcodeline": "if (host_tty_dev != NULL && *host_tty_dev != 0)"
    },
    {
        "line": 221,
        "fullcodeline": "if (ensure_dir (dest, 0755) != 0)"
    },
    {
        "line": 230,
        "fullcodeline": "if (ensure_dir (dest, 0755) != 0)"
    },
    {
        "line": 243,
        "fullcodeline": "if (ensure_dir (dest, op->perms) != 0)"
    },
    {
        "line": 258,
        "fullcodeline": "if (chmod (dest, op->perms) != 0)"
    },
    {
        "line": 265,
        "fullcodeline": "cleanup_fd int dest_fd = -1;"
    },
    {
        "line": 267,
        "fullcodeline": "assert (dest != NULL);"
    },
    {
        "line": 268,
        "fullcodeline": "assert (op->perms >= 0);"
    },
    {
        "line": 269,
        "fullcodeline": "assert (op->perms <= 07777);"
    },
    {
        "line": 271,
        "fullcodeline": "dest_fd = creat (dest, op->perms);"
    },
    {
        "line": 278,
        "fullcodeline": "close (op->fd);"
    },
    {
        "line": 279,
        "fullcodeline": "op->fd = -1;"
    },
    {
        "line": 286,
        "fullcodeline": "cleanup_fd int dest_fd = -1;"
    },
    {
        "line": 287,
        "fullcodeline": "char tempfile[] = \"/bindfileXXXXXX\";"
    },
    {
        "line": 290,
        "fullcodeline": "assert (op->perms >= 0);"
    },
    {
        "line": 291,
        "fullcodeline": "assert (op->perms <= 07777);"
    },
    {
        "line": 293,
        "fullcodeline": "dest_fd = mkstemp (tempfile);"
    },
    {
        "line": 304,
        "fullcodeline": "close (op->fd);"
    },
    {
        "line": 305,
        "fullcodeline": "op->fd = -1;"
    },
    {
        "line": 307,
        "fullcodeline": "assert (dest != NULL);"
    },
    {
        "line": 312,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 320,
        "fullcodeline": "unlink (tempfile);"
    },
    {
        "line": 326,
        "fullcodeline": "if (symlink (op->source, dest) != 0)"
    },
    {
        "line": 22,
        "fullcodeline": "die_with_error(\"Can't get type of source %s\", op->source);"
    },
    {
        "line": 35,
        "fullcodeline": "(op->perms & 0070) == 0)"
    },
    {
        "line": 36,
        "fullcodeline": "parent_mode &= ~0050;"
    },
    {
        "line": 40,
        "fullcodeline": "(op->perms & 0007) == 0)"
    },
    {
        "line": 41,
        "fullcodeline": "parent_mode &= ~0005;"
    },
    {
        "line": 45,
        "fullcodeline": "die_with_error (\"Can't mkdir parents for %s\", op->dest);"
    },
    {
        "line": 64,
        "fullcodeline": "(op->type == SETUP_DEV_BIND_MOUNT ? BIND_DEVICES : 0),"
    },
    {
        "line": 86,
        "fullcodeline": "close(op->fd);"
    },
    {
        "line": 87,
        "fullcodeline": "op->fd = -1;"
    },
    {
        "line": 99,
        "fullcodeline": "die_with_error (\"Can't mkdir %s\", op->dest);"
    },
    {
        "line": 104,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 123,
        "fullcodeline": "cleanup_free char *subdir = strconcat3 (dest, \"/\", cover_proc_dirs[i]);"
    },
    {
        "line": 133,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 142,
        "fullcodeline": "die_with_error (\"Can't mkdir %s\", op->dest);"
    },
    {
        "line": 151,
        "fullcodeline": "cleanup_free char *node_dest = strconcat3 (dest, \"/\", devnodes[i]);"
    },
    {
        "line": 152,
        "fullcodeline": "cleanup_free char *node_src = strconcat (\"/oldroot/dev/\", devnodes[i]);"
    },
    {
        "line": 155,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 163,
        "fullcodeline": "cleanup_free char *target = xasprintf (\"/proc/self/fd/%d\", i);"
    },
    {
        "line": 164,
        "fullcodeline": "cleanup_free char *node_dest = strconcat3 (dest, \"/\", stdionodes[i]);"
    },
    {
        "line": 171,
        "fullcodeline": "if (symlink (\"/proc/self/fd\", dev_fd) < 0)"
    },
    {
        "line": 175,
        "fullcodeline": "if (symlink (\"/proc/kcore\", dev_core) < 0)"
    },
    {
        "line": 184,
        "fullcodeline": "if (mkdir (shm, 0755) == -1)"
    },
    {
        "line": 187,
        "fullcodeline": "if (mkdir (pts, 0755) == -1)"
    },
    {
        "line": 192,
        "fullcodeline": "if (symlink (\"pts/ptmx\", ptmx) != 0)"
    },
    {
        "line": 203,
        "fullcodeline": "cleanup_free char *src_tty_dev = strconcat (\"/oldroot\", host_tty_dev);"
    },
    {
        "line": 204,
        "fullcodeline": "cleanup_free char *dest_console = strconcat (dest, \"/console\");"
    },
    {
        "line": 209,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 222,
        "fullcodeline": "die_with_error (\"Can't mkdir %s\", op->dest);"
    },
    {
        "line": 231,
        "fullcodeline": "die_with_error (\"Can't mkdir %s\", op->dest);"
    },
    {
        "line": 244,
        "fullcodeline": "die_with_error (\"Can't mkdir %s\", op->dest);"
    },
    {
        "line": 259,
        "fullcodeline": "die_with_error (\"Can't chmod %#o %s\", op->perms, op->dest);"
    },
    {
        "line": 272,
        "fullcodeline": "if (dest_fd == -1)"
    },
    {
        "line": 275,
        "fullcodeline": "if (copy_file_data (op->fd, dest_fd) != 0)"
    },
    {
        "line": 289,
        "fullcodeline": "assert (dest != NULL);"
    },
    {
        "line": 294,
        "fullcodeline": "if (dest_fd == -1)"
    },
    {
        "line": 297,
        "fullcodeline": "if (fchmod (dest_fd, op->perms) != 0)"
    },
    {
        "line": 301,
        "fullcodeline": "if (copy_file_data (op->fd, dest_fd) != 0)"
    },
    {
        "line": 309,
        "fullcodeline": "if (ensure_file (dest, 0444) != 0)"
    },
    {
        "line": 314,
        "fullcodeline": "(op->type == SETUP_MAKE_RO_BIND_FILE ? BIND_READONLY : 0),"
    },
    {
        "line": 327,
        "fullcodeline": "die_with_error (\"Can't make symlink at %s\", op->dest);"
    },
    {
        "line": 20,
        "fullcodeline": "if (op->flags & ALLOW_NOTEXIST && errno == ENOENT)"
    },
    {
        "line": 55,
        "fullcodeline": "if (ensure_dir (dest, 0755) != 0)"
    },
    {
        "line": 77,
        "fullcodeline": "if (fstat(op->fd, &fd_st) != 0)"
    },
    {
        "line": 79,
        "fullcodeline": "if (lstat(dest, &mount_st) != 0)"
    },
    {
        "line": 82,
        "fullcodeline": "if (fd_st.st_ino != mount_st.st_ino ||"
    },
    {
        "line": 111,
        "fullcodeline": "privileged_op (privileged_op_socket,"
    },
    {
        "line": 124,
        "fullcodeline": "if (access (subdir, W_OK) < 0)"
    },
    {
        "line": 153,
        "fullcodeline": "if (create_file (node_dest, 0444, NULL) != 0)"
    },
    {
        "line": 165,
        "fullcodeline": "if (symlink (target, node_dest) < 0)"
    },
    {
        "line": 172,
        "fullcodeline": "die_with_error (\"Can't create symlink %s\", dev_fd);"
    },
    {
        "line": 176,
        "fullcodeline": "die_with_error (\"Can't create symlink %s\", dev_core);"
    },
    {
        "line": 185,
        "fullcodeline": "die_with_error (\"Can't create %s/shm\", op->dest);"
    },
    {
        "line": 188,
        "fullcodeline": "die_with_error (\"Can't create %s/devpts\", op->dest);"
    },
    {
        "line": 193,
        "fullcodeline": "die_with_error (\"Can't make symlink at %s/ptmx\", op->dest);"
    },
    {
        "line": 206,
        "fullcodeline": "if (create_file (dest_console, 0444, NULL) != 0)"
    },
    {
        "line": 273,
        "fullcodeline": "die_with_error (\"Can't create file %s\", op->dest);"
    },
    {
        "line": 276,
        "fullcodeline": "die_with_error (\"Can't write data to file %s\", op->dest);"
    },
    {
        "line": 295,
        "fullcodeline": "die_with_error (\"Can't create tmpfile for %s\", op->dest);"
    },
    {
        "line": 298,
        "fullcodeline": "die_with_error (\"Can't set mode %#o on file to be used for %s\","
    },
    {
        "line": 302,
        "fullcodeline": "die_with_error (\"Can't write data to file %s\", op->dest);"
    },
    {
        "line": 310,
        "fullcodeline": "die_with_error (\"Can't create file at %s\", op->dest);"
    },
    {
        "line": 56,
        "fullcodeline": "die_with_error (\"Can't mkdir %s\", op->dest);"
    },
    {
        "line": 58,
        "fullcodeline": "else if (ensure_file (dest, 0444) != 0)"
    },
    {
        "line": 78,
        "fullcodeline": "die_with_error(\"Can't stat fd %d\", op->fd);"
    },
    {
        "line": 80,
        "fullcodeline": "die_with_error(\"Can't stat mount at %s\", dest);"
    },
    {
        "line": 83,
        "fullcodeline": "fd_st.st_dev != mount_st.st_dev)"
    },
    {
        "line": 84,
        "fullcodeline": "die_with_error(\"Race condition binding dirfd\");"
    },
    {
        "line": 130,
        "fullcodeline": "die_with_error (\"Can't access %s\", subdir);"
    },
    {
        "line": 154,
        "fullcodeline": "die_with_error (\"Can't create file %s/%s\", op->dest, devnodes[i]);"
    },
    {
        "line": 166,
        "fullcodeline": "die_with_error (\"Can't create symlink %s/%s\", op->dest, stdionodes[i]);"
    },
    {
        "line": 207,
        "fullcodeline": "die_with_error (\"creating %s/console\", op->dest);"
    },
    {
        "line": 59,
        "fullcodeline": "die_with_error (\"Can't create file at %s\", op->dest);"
    },
    {
        "line": 127,
        "fullcodeline": "if (errno == EACCES || errno == ENOENT || errno == EROFS)"
    }
]