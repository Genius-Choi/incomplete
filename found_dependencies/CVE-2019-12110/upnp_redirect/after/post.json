[
    {
        "line": 7,
        "fullcodeline": "char iaddr_old[32];"
    },
    {
        "line": 8,
        "fullcodeline": "char rhost_old[32];"
    },
    {
        "line": 13,
        "fullcodeline": "proto = proto_atoi(protocol);"
    },
    {
        "line": 60,
        "fullcodeline": "rhost_old[0] = '\\0';"
    },
    {
        "line": 61,
        "fullcodeline": "r = get_redirect_rule(ext_if_name, eport, proto,"
    },
    {
        "line": 14,
        "fullcodeline": "if(inet_aton(iaddr, &address) <= 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "if(!check_upnp_rule_against_permissions(upnppermlist, num_upnpperm,"
    },
    {
        "line": 26,
        "fullcodeline": "if (desc == NULL)"
    },
    {
        "line": 65,
        "fullcodeline": "if(r == 0) {"
    },
    {
        "line": 15,
        "fullcodeline": "syslog(LOG_ERR, \"inet_aton(%s) FAILED\", iaddr);"
    },
    {
        "line": 21,
        "fullcodeline": "syslog(LOG_INFO, \"redirection permission check failed for \""
    },
    {
        "line": 27,
        "fullcodeline": "desc = \"\";\t/* assume empty description */"
    },
    {
        "line": 16,
        "fullcodeline": "return -1;"
    },
    {
        "line": 23,
        "fullcodeline": "return -3;"
    },
    {
        "line": 66,
        "fullcodeline": "if(strcmp(iaddr, iaddr_old)==0 &&"
    },
    {
        "line": 97,
        "fullcodeline": "timestamp = (leaseduration > 0) ? upnp_time() + leaseduration : 0;"
    },
    {
        "line": 98,
        "fullcodeline": "syslog(LOG_INFO, \"redirecting port %hu to %s:%hu protocol %s for: %s\","
    },
    {
        "line": 67,
        "fullcodeline": "((rhost == NULL && rhost_old[0]=='\\0') ||"
    },
    {
        "line": 70,
        "fullcodeline": "syslog(LOG_INFO, \"updating existing port mapping %hu %s (rhost '%s') => %s:%hu\","
    },
    {
        "line": 72,
        "fullcodeline": "timestamp = (leaseduration > 0) ? upnp_time() + leaseduration : 0;"
    },
    {
        "line": 100,
        "fullcodeline": "return upnp_redirect_internal(rhost, eport, iaddr, iport, proto,"
    },
    {
        "line": 69,
        "fullcodeline": "(rhost && (strcmp(rhost, rhost_old) == 0)))) {"
    },
    {
        "line": 73,
        "fullcodeline": "if(iport != iport_old) {"
    },
    {
        "line": 86,
        "fullcodeline": "syslog(LOG_INFO, \"port %hu %s (rhost '%s') already redirected to %s:%hu\","
    },
    {
        "line": 68,
        "fullcodeline": "(rhost && (strcmp(rhost, \"*\") == 0) && rhost_old[0]=='\\0') ||"
    },
    {
        "line": 74,
        "fullcodeline": "r = update_portmapping(ext_if_name, eport, proto, iport, desc, timestamp);"
    },
    {
        "line": 88,
        "fullcodeline": "return -2;"
    },
    {
        "line": 76,
        "fullcodeline": "r = update_portmapping_desc_timestamp(ext_if_name, eport, proto, desc, timestamp);"
    }
]