[
    {
        "line": 6,
        "fullcodeline": "(void) p;"
    },
    {
        "line": 7,
        "fullcodeline": "(void) cs;"
    },
    {
        "line": 9,
        "fullcodeline": "PLUGIN_TRACE(\"[FD %i] Mandril validating URL\", cs->socket);"
    },
    {
        "line": 17,
        "fullcodeline": "PLUGIN_TRACE(\"[FD %d] Mandril validating hotlinking\", cs->socket);"
    },
    {
        "line": 18,
        "fullcodeline": "referer = mk_api->header_get(&sr->headers_toc, \"Referer\", strlen(\"Referer\"));"
    },
    {
        "line": 11,
        "fullcodeline": "if (mk_security_check_url(sr->uri_processed) < 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "if (mk_security_check_hotlink(sr->uri_processed, sr->host, referer) < 0) {"
    },
    {
        "line": 12,
        "fullcodeline": "PLUGIN_TRACE(\"[FD %i] Close connection, blocked URL\", cs->socket);"
    },
    {
        "line": 13,
        "fullcodeline": "mk_api->header_set_http_status(sr, MK_CLIENT_FORBIDDEN);"
    },
    {
        "line": 20,
        "fullcodeline": "PLUGIN_TRACE(\"[FD %i] Close connection, deny hotlinking.\", cs->socket);"
    },
    {
        "line": 21,
        "fullcodeline": "mk_api->header_set_http_status(sr, MK_CLIENT_FORBIDDEN);"
    }
]