[
    {
        "line": 3,
        "fullcodeline": "login_url = url_path_join(jp_base_url, \"login\")"
    },
    {
        "line": 4,
        "fullcodeline": "first = await http_server_client.fetch(login_url)"
    },
    {
        "line": 6,
        "fullcodeline": "cookies = parse_cookie(cookie_header)"
    },
    {
        "line": 10,
        "fullcodeline": "resp = await http_server_client.fetch("
    },
    {
        "line": 27,
        "fullcodeline": "assert resp.code == 302, \"Should have returned a redirect!\""
    },
    {
        "line": 11,
        "fullcodeline": "url_concat(login_url, {\"next\": next}),"
    },
    {
        "line": 13,
        "fullcodeline": "body=urlencode("
    },
    {
        "line": 19,
        "fullcodeline": "headers={\"Cookie\": cookie_header},"
    },
    {
        "line": 23,
        "fullcodeline": "if e.code != 302:"
    },
    {
        "line": 14,
        "fullcodeline": "{"
    },
    {
        "line": 24,
        "fullcodeline": "raise"
    },
    {
        "line": 16,
        "fullcodeline": "\"_xsrf\": cookies.get(\"_xsrf\", \"\"),"
    }
]