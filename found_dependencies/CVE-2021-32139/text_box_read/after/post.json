[
    {
        "line": 5,
        "fullcodeline": "GF_TextSampleEntryBox *ptr = (GF_TextSampleEntryBox*)s;"
    },
    {
        "line": 7,
        "fullcodeline": "ISOM_DECREASE_SIZE(ptr, 8);"
    },
    {
        "line": 8,
        "fullcodeline": "e = gf_isom_base_sample_entry_read((GF_SampleEntryBox *)ptr, bs);"
    },
    {
        "line": 15,
        "fullcodeline": "ISOM_DECREASE_SIZE(ptr, 43);"
    },
    {
        "line": 18,
        "fullcodeline": "ptr->displayFlags = gf_bs_read_u32(bs);\t\t\t/*Display flags*/"
    },
    {
        "line": 19,
        "fullcodeline": "ptr->textJustification = gf_bs_read_u32(bs);\t/*Text justification*/"
    },
    {
        "line": 20,
        "fullcodeline": "gf_bs_read_data(bs, ptr->background_color, 6);\t/*Background color*/"
    },
    {
        "line": 21,
        "fullcodeline": "gpp_read_box(bs, &ptr->default_box);\t\t\t/*Default text box*/"
    },
    {
        "line": 22,
        "fullcodeline": "gf_bs_read_data(bs, ptr->reserved1, 8);\t\t\t/*Reserved*/"
    },
    {
        "line": 23,
        "fullcodeline": "ptr->fontNumber = gf_bs_read_u16(bs);\t\t\t/*Font number*/"
    },
    {
        "line": 24,
        "fullcodeline": "ptr->fontFace   = gf_bs_read_u16(bs);\t\t\t/*Font face*/"
    },
    {
        "line": 25,
        "fullcodeline": "ptr->reserved2  = gf_bs_read_u8(bs);\t\t\t/*Reserved*/"
    },
    {
        "line": 26,
        "fullcodeline": "ptr->reserved3  = gf_bs_read_u16(bs);\t\t\t/*Reserved*/"
    },
    {
        "line": 27,
        "fullcodeline": "gf_bs_read_data(bs, ptr->foreground_color, 6);\t/*Foreground color*/"
    },
    {
        "line": 33,
        "fullcodeline": "ISOM_DECREASE_SIZE(ptr, 1);"
    },
    {
        "line": 34,
        "fullcodeline": "pSize = gf_bs_read_u8(bs); /*a Pascal string begins with its size: get textName size*/"
    },
    {
        "line": 77,
        "fullcodeline": "ISOM_DECREASE_SIZE(ptr, pSize);"
    },
    {
        "line": 11,
        "fullcodeline": "if (!ptr->size) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (!ptr->size)"
    },
    {
        "line": 36,
        "fullcodeline": "if (ptr->size < pSize) {"
    },
    {
        "line": 78,
        "fullcodeline": "return gf_isom_box_array_read(s, bs);"
    },
    {
        "line": 12,
        "fullcodeline": "ptr->textJustification = 1;"
    },
    {
        "line": 37,
        "fullcodeline": "u32 b_size = pSize;"
    },
    {
        "line": 38,
        "fullcodeline": "size_t i = 0;"
    },
    {
        "line": 39,
        "fullcodeline": "GF_LOG(GF_LOG_DEBUG, GF_LOG_CONTAINER, (\"[iso file] text box doesn't use a Pascal string: trying to decode anyway.\\n\"));"
    },
    {
        "line": 40,
        "fullcodeline": "ptr->textName = (char*)gf_malloc((size_t)ptr->size + 1 + 1);"
    },
    {
        "line": 62,
        "fullcodeline": "ptr->textName[i] = '\\0';\t\t\t\t/*Font name*/"
    },
    {
        "line": 63,
        "fullcodeline": "GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, (\"[iso file] text box doesn't use a Pascal string: \\\"%s\\\" detected.\\n\", ptr->textName));"
    },
    {
        "line": 67,
        "fullcodeline": "ptr->textName = (char*) gf_malloc(pSize+1 * sizeof(char));"
    },
    {
        "line": 75,
        "fullcodeline": "ptr->textName[pSize] = '\\0';\t\t\t\t/*Font name*/"
    },
    {
        "line": 41,
        "fullcodeline": "if (!ptr->textName) return GF_OUT_OF_MEM;"
    },
    {
        "line": 68,
        "fullcodeline": "if (!ptr->textName) return GF_OUT_OF_MEM;"
    },
    {
        "line": 70,
        "fullcodeline": "if (gf_bs_read_data(bs, ptr->textName, pSize) != pSize) {"
    },
    {
        "line": 44,
        "fullcodeline": "char c = (char)b_size;"
    },
    {
        "line": 55,
        "fullcodeline": "i++;"
    },
    {
        "line": 58,
        "fullcodeline": "ptr->size--;"
    },
    {
        "line": 59,
        "fullcodeline": "b_size = gf_bs_read_u8(bs);"
    },
    {
        "line": 71,
        "fullcodeline": "gf_free(ptr->textName);"
    },
    {
        "line": 72,
        "fullcodeline": "ptr->textName = NULL;"
    },
    {
        "line": 45,
        "fullcodeline": "if (c == '\\0') {"
    },
    {
        "line": 56,
        "fullcodeline": "if (!ptr->size)"
    },
    {
        "line": 47,
        "fullcodeline": "} else if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {"
    },
    {
        "line": 48,
        "fullcodeline": "ptr->textName[i] = c;"
    },
    {
        "line": 50,
        "fullcodeline": "gf_free(ptr->textName);"
    },
    {
        "line": 51,
        "fullcodeline": "ptr->textName = NULL;"
    },
    {
        "line": 52,
        "fullcodeline": "GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, (\"[iso file] text box doesn't use a Pascal string and contains non-chars. Abort.\\n\"));"
    }
]