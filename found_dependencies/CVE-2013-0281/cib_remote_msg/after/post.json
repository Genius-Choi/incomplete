[
    {
        "line": 3,
        "fullcodeline": "xmlNode *command = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "cib_client_t *client = data;"
    },
    {
        "line": 5,
        "fullcodeline": "int disconnected = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "int timeout = client->remote_auth ? -1 : 1000;"
    },
    {
        "line": 8,
        "fullcodeline": "crm_trace(\"%s callback\", client->encrypted ? \"secure\" : \"clear-text\");"
    },
    {
        "line": 38,
        "fullcodeline": "crm_recv_remote_msg(client->session, &client->recv_buf, client->encrypted, timeout, &disconnected);"
    },
    {
        "line": 74,
        "fullcodeline": "command = crm_parse_remote_buffer(&client->recv_buf);"
    },
    {
        "line": 41,
        "fullcodeline": "if (client->remote_auth == FALSE) {"
    },
    {
        "line": 46,
        "fullcodeline": "command = crm_parse_remote_buffer(&client->recv_buf);"
    },
    {
        "line": 52,
        "fullcodeline": "crm_debug(\"remote connection authenticated successfully\");"
    },
    {
        "line": 53,
        "fullcodeline": "client->remote_auth = TRUE;"
    },
    {
        "line": 54,
        "fullcodeline": "g_source_remove(client->remote_auth_timeout);"
    },
    {
        "line": 55,
        "fullcodeline": "client->remote_auth_timeout = 0;"
    },
    {
        "line": 56,
        "fullcodeline": "client->name = crm_element_value_copy(command, \"name\");"
    },
    {
        "line": 66,
        "fullcodeline": "reg = create_xml_node(NULL, \"cib_result\");"
    },
    {
        "line": 67,
        "fullcodeline": "crm_xml_add(reg, F_CIB_OPERATION, CRM_OP_REGISTER);"
    },
    {
        "line": 68,
        "fullcodeline": "crm_xml_add(reg, F_CIB_CLIENTID, client->id);"
    },
    {
        "line": 69,
        "fullcodeline": "crm_send_remote_msg(client->session, reg, client->encrypted);"
    },
    {
        "line": 70,
        "fullcodeline": "free_xml(reg);"
    },
    {
        "line": 71,
        "fullcodeline": "free_xml(command);"
    },
    {
        "line": 76,
        "fullcodeline": "crm_trace(\"command received\");"
    },
    {
        "line": 77,
        "fullcodeline": "cib_handle_remote_msg(client, command);"
    },
    {
        "line": 78,
        "fullcodeline": "free_xml(command);"
    },
    {
        "line": 79,
        "fullcodeline": "command = crm_parse_remote_buffer(&client->recv_buf);"
    },
    {
        "line": 83,
        "fullcodeline": "crm_trace(\"disconnected while receiving remote cib msg.\");"
    },
    {
        "line": 47,
        "fullcodeline": "if (cib_remote_auth(command) == FALSE) {"
    },
    {
        "line": 84,
        "fullcodeline": "return -1;"
    },
    {
        "line": 48,
        "fullcodeline": "free_xml(command);"
    },
    {
        "line": 49,
        "fullcodeline": "return -1;"
    }
]