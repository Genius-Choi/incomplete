[
    {
        "line": 4,
        "fullcodeline": "cib_remote_opaque_t *private = cib->variant_opaque;"
    },
    {
        "line": 5,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "int disconnected = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "xmlNode *answer = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "xmlNode *login = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "static struct mainloop_fd_callbacks cib_fd_callbacks = { 0, };"
    },
    {
        "line": 13,
        "fullcodeline": "cib_fd_callbacks.dispatch = event_channel ? cib_remote_callback_dispatch : cib_remote_command_dispatch;"
    },
    {
        "line": 14,
        "fullcodeline": "cib_fd_callbacks.destroy = cib_remote_connection_destroy;"
    },
    {
        "line": 16,
        "fullcodeline": "connection->socket = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "connection->session = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "sock = crm_remote_tcp_connect(private->server, private->port);"
    },
    {
        "line": 24,
        "fullcodeline": "connection->socket = sock;"
    },
    {
        "line": 54,
        "fullcodeline": "login = create_xml_node(NULL, \"cib_command\");"
    },
    {
        "line": 55,
        "fullcodeline": "crm_xml_add(login, \"op\", \"authenticate\");"
    },
    {
        "line": 56,
        "fullcodeline": "crm_xml_add(login, \"user\", private->user);"
    },
    {
        "line": 57,
        "fullcodeline": "crm_xml_add(login, \"password\", private->passwd);"
    },
    {
        "line": 58,
        "fullcodeline": "crm_xml_add(login, \"hidden\", \"password\");"
    },
    {
        "line": 60,
        "fullcodeline": "crm_send_remote_msg(connection->session, login, connection->encrypted);"
    },
    {
        "line": 63,
        "fullcodeline": "crm_recv_remote_msg(connection->session, &connection->recv_buf, connection->encrypted, -1, &disconnected);"
    },
    {
        "line": 69,
        "fullcodeline": "answer = crm_parse_remote_buffer(&connection->recv_buf);"
    },
    {
        "line": 71,
        "fullcodeline": "crm_log_xml_trace(answer, \"Reply\");"
    },
    {
        "line": 20,
        "fullcodeline": "if (sock <= 0) {"
    },
    {
        "line": 72,
        "fullcodeline": "if (answer == NULL) {"
    },
    {
        "line": 94,
        "fullcodeline": "if (rc != 0) {"
    },
    {
        "line": 100,
        "fullcodeline": "connection->source = mainloop_add_fd(\"cib-remote\", G_PRIORITY_HIGH, connection->socket, cib, &cib_fd_callbacks);"
    },
    {
        "line": 21,
        "fullcodeline": "crm_perror(LOG_ERR, \"remote tcp connection to %s:%d failed\", private->server, private->port);"
    },
    {
        "line": 66,
        "fullcodeline": "rc = -ENOTCONN;"
    },
    {
        "line": 73,
        "fullcodeline": "rc = -EPROTO;"
    },
    {
        "line": 47,
        "fullcodeline": "return -EPROTONOSUPPORT;"
    },
    {
        "line": 50,
        "fullcodeline": "connection->session = GUINT_TO_POINTER(sock);"
    },
    {
        "line": 77,
        "fullcodeline": "const char *msg_type = crm_element_value(answer, F_CIB_OPERATION);"
    },
    {
        "line": 78,
        "fullcodeline": "const char *tmp_ticket = crm_element_value(answer, F_CIB_CLIENTID);"
    },
    {
        "line": 80,
        "fullcodeline": "if (safe_str_neq(msg_type, CRM_OP_REGISTER)) {"
    },
    {
        "line": 82,
        "fullcodeline": "rc = -EPROTO;"
    },
    {
        "line": 84,
        "fullcodeline": "} else if (tmp_ticket == NULL) {"
    },
    {
        "line": 85,
        "fullcodeline": "rc = -EPROTO;"
    },
    {
        "line": 88,
        "fullcodeline": "connection->token = strdup(tmp_ticket);"
    }
]