[
    {
        "line": 4,
        "fullcodeline": "int rc = pcmk_ok;"
    },
    {
        "line": 5,
        "fullcodeline": "int disconnected = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "int remaining_time = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "xmlNode *op_msg = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "xmlNode *op_reply = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "cib_remote_opaque_t *private = cib->variant_opaque;"
    },
    {
        "line": 27,
        "fullcodeline": "cib->call_id++;"
    },
    {
        "line": 36,
        "fullcodeline": "op_msg ="
    },
    {
        "line": 43,
        "fullcodeline": "crm_trace(\"Sending %s message to CIB service\", op);"
    },
    {
        "line": 61,
        "fullcodeline": "start_time = time(NULL);"
    },
    {
        "line": 62,
        "fullcodeline": "remaining_time = cib->call_timeout ? cib->call_timeout : 60;"
    },
    {
        "line": 14,
        "fullcodeline": "if (cib->state == cib_disconnected) {"
    },
    {
        "line": 18,
        "fullcodeline": "if (output_data != NULL) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (op == NULL) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (cib->call_id < 1) {"
    },
    {
        "line": 37,
        "fullcodeline": "cib_create_op(cib->call_id, private->callback.token, op, host, section, data, call_options,"
    },
    {
        "line": 39,
        "fullcodeline": "if (op_msg == NULL) {"
    },
    {
        "line": 51,
        "fullcodeline": "if ((call_options & cib_discard_reply)) {"
    },
    {
        "line": 120,
        "fullcodeline": "if (rc == -pcmk_err_diff_resync) {"
    },
    {
        "line": 134,
        "fullcodeline": "if (output_data == NULL) {"
    },
    {
        "line": 19,
        "fullcodeline": "*output_data = NULL;"
    },
    {
        "line": 33,
        "fullcodeline": "cib->call_id = 1;"
    },
    {
        "line": 44,
        "fullcodeline": "if (!(call_options & cib_sync_call)) {"
    },
    {
        "line": 45,
        "fullcodeline": "crm_send_remote_msg(private->callback.session, op_msg, private->command.encrypted);"
    },
    {
        "line": 64,
        "fullcodeline": "while (remaining_time > 0 && !disconnected) {"
    },
    {
        "line": 65,
        "fullcodeline": "int reply_id = -1;"
    },
    {
        "line": 66,
        "fullcodeline": "int msg_id = cib->call_id;"
    },
    {
        "line": 68,
        "fullcodeline": "crm_recv_remote_msg(private->command.session, &private->command.recv_buf, private->command.encrypted, remaining_time * 1000, &disconnected);"
    },
    {
        "line": 69,
        "fullcodeline": "op_reply = crm_parse_remote_buffer(&private->command.recv_buf);"
    },
    {
        "line": 75,
        "fullcodeline": "crm_element_value_int(op_reply, F_CIB_CALLID, &reply_id);"
    },
    {
        "line": 93,
        "fullcodeline": "op_reply = NULL;"
    },
    {
        "line": 96,
        "fullcodeline": "remaining_time = time(NULL) - start_time;"
    },
    {
        "line": 116,
        "fullcodeline": "if (crm_element_value_int(op_reply, F_CIB_RC, &rc) != 0) {"
    },
    {
        "line": 117,
        "fullcodeline": "rc = -EPROTO;"
    },
    {
        "line": 122,
        "fullcodeline": "rc = pcmk_ok;"
    },
    {
        "line": 125,
        "fullcodeline": "if (rc == pcmk_ok || rc == -EPERM) {"
    },
    {
        "line": 126,
        "fullcodeline": "crm_log_xml_debug(op_reply, \"passed\");"
    },
    {
        "line": 15,
        "fullcodeline": "return -ENOTCONN;"
    },
    {
        "line": 24,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 40,
        "fullcodeline": "return -EPROTO;"
    },
    {
        "line": 47,
        "fullcodeline": "crm_send_remote_msg(private->command.session, op_msg, private->command.encrypted);"
    },
    {
        "line": 71,
        "fullcodeline": "if (!op_reply) {"
    },
    {
        "line": 77,
        "fullcodeline": "if (reply_id == msg_id) {"
    },
    {
        "line": 107,
        "fullcodeline": "return -ENOTCONN;"
    },
    {
        "line": 131,
        "fullcodeline": "crm_log_xml_warn(op_reply, \"failed\");"
    },
    {
        "line": 108,
        "fullcodeline": "} else if (op_reply == NULL) {"
    },
    {
        "line": 130,
        "fullcodeline": "crm_err(\"Call failed: %s\", pcmk_strerror(rc));"
    },
    {
        "line": 55,
        "fullcodeline": "} else if (!(call_options & cib_sync_call)) {"
    },
    {
        "line": 137,
        "fullcodeline": "} else if (!(call_options & cib_discard_reply)) {"
    },
    {
        "line": 138,
        "fullcodeline": "xmlNode *tmp = get_message_xml(op_reply, F_CIB_CALLDATA);"
    },
    {
        "line": 80,
        "fullcodeline": "} else if (reply_id < msg_id) {"
    },
    {
        "line": 110,
        "fullcodeline": "return -ENOMSG;"
    },
    {
        "line": 140,
        "fullcodeline": "if (tmp == NULL) {"
    },
    {
        "line": 82,
        "fullcodeline": "crm_log_xml_trace(op_reply, \"Old reply\");"
    },
    {
        "line": 141,
        "fullcodeline": "crm_trace(\"No output in reply to \\\"%s\\\" command %d\", op, cib->call_id - 1);"
    },
    {
        "line": 84,
        "fullcodeline": "} else if ((reply_id - 10000) > msg_id) {"
    },
    {
        "line": 143,
        "fullcodeline": "*output_data = copy_xml(tmp);"
    },
    {
        "line": 87,
        "fullcodeline": "crm_log_xml_trace(op_reply, \"Old reply\");"
    }
]