[
    {
        "line": 4,
        "fullcodeline": "int *ssock = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "static struct mainloop_fd_callbacks remote_listen_fd_callbacks ="
    },
    {
        "line": 36,
        "fullcodeline": "crm_warn(\"PAM is _not_ enabled!\");"
    },
    {
        "line": 41,
        "fullcodeline": "*ssock = socket(AF_INET, SOCK_STREAM, 0);"
    },
    {
        "line": 49,
        "fullcodeline": "optval = 1;"
    },
    {
        "line": 50,
        "fullcodeline": "rc = setsockopt(*ssock, SOL_SOCKET, SO_REUSEADDR, &optval, sizeof(optval));"
    },
    {
        "line": 56,
        "fullcodeline": "memset(&saddr, '\\0', sizeof(saddr));"
    },
    {
        "line": 57,
        "fullcodeline": "saddr.sin_family = AF_INET;"
    },
    {
        "line": 58,
        "fullcodeline": "saddr.sin_addr.s_addr = INADDR_ANY;"
    },
    {
        "line": 59,
        "fullcodeline": "saddr.sin_port = htons(port);"
    },
    {
        "line": 73,
        "fullcodeline": "mainloop_add_fd(\"cib-remote\", G_PRIORITY_DEFAULT, *ssock, ssock, &remote_listen_fd_callbacks);"
    },
    {
        "line": 8,
        "fullcodeline": "{"
    },
    {
        "line": 13,
        "fullcodeline": "if (port <= 0) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (*ssock == -1) {"
    },
    {
        "line": 51,
        "fullcodeline": "if(rc < 0) {"
    },
    {
        "line": 60,
        "fullcodeline": "if (bind(*ssock, (struct sockaddr *)&saddr, sizeof(saddr)) == -1) {"
    },
    {
        "line": 66,
        "fullcodeline": "if (listen(*ssock, 10) == -1) {"
    },
    {
        "line": 20,
        "fullcodeline": "crm_warn(\"TLS support is not available\");"
    },
    {
        "line": 44,
        "fullcodeline": "free(ssock);"
    },
    {
        "line": 52,
        "fullcodeline": "crm_perror(LOG_INFO, \"Couldn't allow the reuse of local addresses by our remote listener\");"
    },
    {
        "line": 62,
        "fullcodeline": "close(*ssock);"
    },
    {
        "line": 63,
        "fullcodeline": "free(ssock);"
    },
    {
        "line": 68,
        "fullcodeline": "close(*ssock);"
    },
    {
        "line": 69,
        "fullcodeline": "free(ssock);"
    },
    {
        "line": 9,
        "fullcodeline": ".dispatch = cib_remote_listen,"
    },
    {
        "line": 10,
        "fullcodeline": ".destroy = remote_connection_destroy,"
    },
    {
        "line": 33,
        "fullcodeline": "crm_warn(\"Starting a plain_text listener on port %d.\", port);"
    },
    {
        "line": 45,
        "fullcodeline": "return -1;"
    },
    {
        "line": 64,
        "fullcodeline": "return -2;"
    },
    {
        "line": 70,
        "fullcodeline": "return -3;"
    }
]