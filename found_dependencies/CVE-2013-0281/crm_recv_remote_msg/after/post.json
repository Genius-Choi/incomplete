[
    {
        "line": 4,
        "fullcodeline": "size_t request_len = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "time_t start = time(NULL);"
    },
    {
        "line": 6,
        "fullcodeline": "char *raw_request = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "int remaining_timeout = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "*disconnected = 0;"
    },
    {
        "line": 16,
        "fullcodeline": "remaining_timeout = total_timeout;"
    },
    {
        "line": 9,
        "fullcodeline": "if (total_timeout == 0) {"
    },
    {
        "line": 17,
        "fullcodeline": "while ((remaining_timeout > 0) && !(*disconnected)) {"
    },
    {
        "line": 10,
        "fullcodeline": "total_timeout = 10000;"
    },
    {
        "line": 20,
        "fullcodeline": "crm_trace(\"waiting to receive remote msg, starting timeout %d, remaining_timeout %d\", total_timeout, remaining_timeout);"
    },
    {
        "line": 21,
        "fullcodeline": "ret = crm_recv_remote_ready(session, encrypted, remaining_timeout);"
    },
    {
        "line": 22,
        "fullcodeline": "raw_request = NULL;"
    },
    {
        "line": 39,
        "fullcodeline": "remaining_timeout = remaining_timeout - ((time(NULL) - start) * 1000);"
    },
    {
        "line": 24,
        "fullcodeline": "if (ret == 0) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (!raw_request) {"
    },
    {
        "line": 59,
        "fullcodeline": "if (strstr(*recv_buf, REMOTE_MSG_TERMINATOR)) {"
    },
    {
        "line": 11,
        "fullcodeline": "} else if (total_timeout < 0) {"
    },
    {
        "line": 25,
        "fullcodeline": "crm_err(\"poll timed out (%d ms) while waiting to receive msg\", remaining_timeout);"
    },
    {
        "line": 42,
        "fullcodeline": "crm_debug(\"Empty msg received after poll\");"
    },
    {
        "line": 47,
        "fullcodeline": "int old_len = strlen(*recv_buf);"
    },
    {
        "line": 49,
        "fullcodeline": "crm_trace(\"Expanding recv buffer from %d to %d\", old_len, old_len+request_len);"
    },
    {
        "line": 51,
        "fullcodeline": "*recv_buf = realloc(*recv_buf, old_len + request_len + 1);"
    },
    {
        "line": 52,
        "fullcodeline": "memcpy(*recv_buf + old_len, raw_request, request_len);"
    },
    {
        "line": 53,
        "fullcodeline": "*(*recv_buf+old_len+request_len) = '\\0';"
    },
    {
        "line": 54,
        "fullcodeline": "free(raw_request);"
    },
    {
        "line": 12,
        "fullcodeline": "total_timeout = 60000;"
    },
    {
        "line": 56,
        "fullcodeline": "*recv_buf = raw_request;"
    },
    {
        "line": 28,
        "fullcodeline": "} else if (ret < 0) {"
    },
    {
        "line": 34,
        "fullcodeline": "crm_debug(\"poll EINTR encountered during poll, retrying\");"
    },
    {
        "line": 29,
        "fullcodeline": "if (errno != EINTR) {"
    },
    {
        "line": 36,
        "fullcodeline": "raw_request = crm_recv_remote_raw(session, encrypted, 0, &request_len, disconnected);"
    },
    {
        "line": 30,
        "fullcodeline": "crm_debug(\"poll returned error while waiting for msg, rc: %d, errno: %d\", ret, errno);"
    },
    {
        "line": 31,
        "fullcodeline": "*disconnected = 1;"
    }
]