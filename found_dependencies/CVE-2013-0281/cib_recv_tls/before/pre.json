[
    {
        "line": 3,
        "fullcodeline": "char *buf = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "int len = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "int chunk_size = 1024;"
    },
    {
        "line": 13,
        "fullcodeline": "buf = calloc(1, chunk_size);"
    },
    {
        "line": 9,
        "fullcodeline": "if (session == NULL) {"
    },
    {
        "line": 16,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "rc = gnutls_record_recv(*session, buf + len, chunk_size);"
    },
    {
        "line": 18,
        "fullcodeline": "crm_trace(\"Got %d more bytes. errno=%d\", rc, errno);"
    },
    {
        "line": 20,
        "fullcodeline": "if (rc == GNUTLS_E_INTERRUPTED || rc == GNUTLS_E_AGAIN) {"
    },
    {
        "line": 23,
        "fullcodeline": "} else if (rc == GNUTLS_E_UNEXPECTED_PACKET_LENGTH) {"
    },
    {
        "line": 27,
        "fullcodeline": "} else if (rc < 0) {"
    },
    {
        "line": 28,
        "fullcodeline": "crm_err(\"Error receiving message: %s (%d)\", gnutls_strerror(rc), rc);"
    },
    {
        "line": 31,
        "fullcodeline": "} else if (rc == chunk_size) {"
    },
    {
        "line": 32,
        "fullcodeline": "len += rc;"
    },
    {
        "line": 33,
        "fullcodeline": "chunk_size *= 2;"
    },
    {
        "line": 34,
        "fullcodeline": "buf = realloc(buf, len + chunk_size);"
    },
    {
        "line": 36,
        "fullcodeline": "CRM_ASSERT(buf != NULL);"
    },
    {
        "line": 38,
        "fullcodeline": "} else if (buf[len + rc - 1] != 0) {"
    },
    {
        "line": 39,
        "fullcodeline": "crm_trace(\"Last char is %d '%c'\", buf[len + rc - 1], buf[len + rc - 1]);"
    },
    {
        "line": 41,
        "fullcodeline": "len += rc;"
    },
    {
        "line": 42,
        "fullcodeline": "buf = realloc(buf, len + chunk_size);"
    },
    {
        "line": 43,
        "fullcodeline": "CRM_ASSERT(buf != NULL);"
    }
]