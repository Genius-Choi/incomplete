[
    {
        "line": 3,
        "fullcodeline": "int lpc = 0;"
    },
    {
        "line": 4,
        "fullcodeline": "int csock = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "time_t now = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "time_t start = time(NULL);"
    },
    {
        "line": 14,
        "fullcodeline": "cib_client_t *new_client = NULL;"
    },
    {
        "line": 16,
        "fullcodeline": "xmlNode *login = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "const char *user = NULL;"
    },
    {
        "line": 18,
        "fullcodeline": "const char *pass = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "const char *tmp = NULL;"
    },
    {
        "line": 25,
        "fullcodeline": "static struct mainloop_fd_callbacks remote_client_fd_callbacks ="
    },
    {
        "line": 33,
        "fullcodeline": "csock = accept(ssock, (struct sockaddr *)&addr, &laddr);"
    },
    {
        "line": 34,
        "fullcodeline": "crm_debug(\"New %s connection from %s\","
    },
    {
        "line": 76,
        "fullcodeline": "crm_log_xml_info(login, \"Login: \");"
    },
    {
        "line": 81,
        "fullcodeline": "tmp = crm_element_name(login);"
    },
    {
        "line": 87,
        "fullcodeline": "tmp = crm_element_value(login, \"op\");"
    },
    {
        "line": 93,
        "fullcodeline": "user = crm_element_value(login, \"user\");"
    },
    {
        "line": 94,
        "fullcodeline": "pass = crm_element_value(login, \"password\");"
    },
    {
        "line": 109,
        "fullcodeline": "num_clients++;"
    },
    {
        "line": 110,
        "fullcodeline": "new_client = calloc(1, sizeof(cib_client_t));"
    },
    {
        "line": 111,
        "fullcodeline": "new_client->name = crm_element_value_copy(login, \"name\");"
    },
    {
        "line": 113,
        "fullcodeline": "CRM_CHECK(new_client->id == NULL, free(new_client->id));"
    },
    {
        "line": 114,
        "fullcodeline": "new_client->id = crm_generate_uuid();"
    },
    {
        "line": 120,
        "fullcodeline": "new_client->callback_id = NULL;"
    },
    {
        "line": 130,
        "fullcodeline": "free_xml(login);"
    },
    {
        "line": 131,
        "fullcodeline": "login = create_xml_node(NULL, \"cib_result\");"
    },
    {
        "line": 132,
        "fullcodeline": "crm_xml_add(login, F_CIB_OPERATION, CRM_OP_REGISTER);"
    },
    {
        "line": 133,
        "fullcodeline": "crm_xml_add(login, F_CIB_CLIENTID, new_client->id);"
    },
    {
        "line": 134,
        "fullcodeline": "crm_send_remote_msg(new_client->session, login, new_client->encrypted);"
    },
    {
        "line": 135,
        "fullcodeline": "free_xml(login);"
    },
    {
        "line": 137,
        "fullcodeline": "new_client->remote = mainloop_add_fd("
    },
    {
        "line": 140,
        "fullcodeline": "g_hash_table_insert(client_list, new_client->id, new_client);"
    },
    {
        "line": 152,
        "fullcodeline": "close(csock);"
    },
    {
        "line": 153,
        "fullcodeline": "free_xml(login);"
    },
    {
        "line": 26,
        "fullcodeline": "{"
    },
    {
        "line": 35,
        "fullcodeline": "ssock == remote_tls_fd ? \"secure\" : \"clear-text\", inet_ntoa(addr.sin_addr));"
    },
    {
        "line": 37,
        "fullcodeline": "if (csock == -1) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (ssock == remote_tls_fd) {"
    },
    {
        "line": 74,
        "fullcodeline": "} while (login == NULL && (start - now) < 4);"
    },
    {
        "line": 77,
        "fullcodeline": "if (login == NULL) {"
    },
    {
        "line": 82,
        "fullcodeline": "if (safe_str_neq(tmp, \"cib_command\")) {"
    },
    {
        "line": 88,
        "fullcodeline": "if (safe_str_neq(tmp, \"authenticate\")) {"
    },
    {
        "line": 99,
        "fullcodeline": "if (check_group_membership(user, CRM_DAEMON_GROUP) == FALSE) {"
    },
    {
        "line": 121,
        "fullcodeline": "if (ssock == remote_tls_fd) {"
    },
    {
        "line": 145,
        "fullcodeline": "if (ssock == remote_tls_fd) {"
    },
    {
        "line": 9,
        "fullcodeline": "int ssock = *(int *)data;"
    },
    {
        "line": 38,
        "fullcodeline": "crm_err(\"accept socket failed\");"
    },
    {
        "line": 55,
        "fullcodeline": "crm_trace(\"Iter: %d\", lpc++);"
    },
    {
        "line": 69,
        "fullcodeline": "sleep(1);"
    },
    {
        "line": 71,
        "fullcodeline": "now = time(NULL);"
    },
    {
        "line": 83,
        "fullcodeline": "crm_err(\"Wrong tag: %s\", tmp);"
    },
    {
        "line": 89,
        "fullcodeline": "crm_err(\"Wrong operation: %s\", tmp);"
    },
    {
        "line": 100,
        "fullcodeline": "crm_err(\"User is not a member of the required group\");"
    },
    {
        "line": 27,
        "fullcodeline": ".dispatch = cib_remote_msg,"
    },
    {
        "line": 28,
        "fullcodeline": ".destroy = cib_remote_connection_destroy,"
    },
    {
        "line": 56,
        "fullcodeline": "if (ssock == remote_tls_fd) {"
    },
    {
        "line": 63,
        "fullcodeline": "if (login != NULL) {"
    },
    {
        "line": 127,
        "fullcodeline": "new_client->session = GINT_TO_POINTER(csock);"
    },
    {
        "line": 103,
        "fullcodeline": "} else if (authenticate_user(user, pass) == FALSE) {"
    },
    {
        "line": 61,
        "fullcodeline": "login = crm_recv_remote_msg(GINT_TO_POINTER(csock), FALSE);"
    },
    {
        "line": 104,
        "fullcodeline": "crm_err(\"PAM auth failed\");"
    }
]