[
    {
        "line": 3,
        "fullcodeline": "int csock = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "int ssock = *(int *)data;"
    },
    {
        "line": 12,
        "fullcodeline": "cib_client_t *new_client = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "static struct mainloop_fd_callbacks remote_client_fd_callbacks ="
    },
    {
        "line": 21,
        "fullcodeline": "laddr = sizeof(addr);"
    },
    {
        "line": 22,
        "fullcodeline": "csock = accept(ssock, (struct sockaddr *)&addr, &laddr);"
    },
    {
        "line": 23,
        "fullcodeline": "crm_debug(\"New %s connection from %s\","
    },
    {
        "line": 55,
        "fullcodeline": "num_clients++;"
    },
    {
        "line": 56,
        "fullcodeline": "new_client = calloc(1, sizeof(cib_client_t));"
    },
    {
        "line": 57,
        "fullcodeline": "new_client->id = crm_generate_uuid();"
    },
    {
        "line": 58,
        "fullcodeline": "new_client->callback_id = NULL;"
    },
    {
        "line": 60,
        "fullcodeline": "new_client->remote_auth_timeout = g_timeout_add(REMOTE_AUTH_TIMEOUT, remote_auth_timeout_cb, new_client);"
    },
    {
        "line": 71,
        "fullcodeline": "new_client->remote = mainloop_add_fd("
    },
    {
        "line": 74,
        "fullcodeline": "g_hash_table_insert(client_list, new_client->id, new_client);"
    },
    {
        "line": 15,
        "fullcodeline": "{"
    },
    {
        "line": 24,
        "fullcodeline": "ssock == remote_tls_fd ? \"secure\" : \"clear-text\", inet_ntoa(addr.sin_addr));"
    },
    {
        "line": 26,
        "fullcodeline": "if (csock == -1) {"
    },
    {
        "line": 43,
        "fullcodeline": "if (ssock == remote_tls_fd) {"
    },
    {
        "line": 27,
        "fullcodeline": "crm_err(\"accept socket failed\");"
    },
    {
        "line": 31,
        "fullcodeline": "if ((flag = fcntl(csock, F_GETFL)) >= 0) {"
    },
    {
        "line": 16,
        "fullcodeline": ".dispatch = cib_remote_msg,"
    },
    {
        "line": 17,
        "fullcodeline": ".destroy = cib_remote_connection_destroy,"
    },
    {
        "line": 68,
        "fullcodeline": "new_client->session = GINT_TO_POINTER(csock);"
    },
    {
        "line": 32,
        "fullcodeline": "if (fcntl(csock, F_SETFL, flag | O_NONBLOCK) < 0) {"
    }
]