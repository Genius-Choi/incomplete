[
    {
        "line": 3,
        "fullcodeline": "char *buf = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "ssize_t rc = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "ssize_t len = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "ssize_t chunk_size = 512;"
    },
    {
        "line": 9,
        "fullcodeline": "buf = calloc(1, chunk_size);"
    },
    {
        "line": 47,
        "fullcodeline": "free(buf);"
    },
    {
        "line": 12,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "rc = read(sock, buf + len, chunk_size);"
    },
    {
        "line": 14,
        "fullcodeline": "crm_trace(\"Got %d more bytes. errno=%d\", (int)rc, errno);"
    },
    {
        "line": 16,
        "fullcodeline": "if (errno == EINTR || errno == EAGAIN) {"
    },
    {
        "line": 17,
        "fullcodeline": "crm_trace(\"Retry: %d\", (int)rc);"
    },
    {
        "line": 18,
        "fullcodeline": "if (rc > 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "len += rc;"
    },
    {
        "line": 20,
        "fullcodeline": "buf = realloc(buf, len + chunk_size);"
    },
    {
        "line": 21,
        "fullcodeline": "CRM_ASSERT(buf != NULL);"
    },
    {
        "line": 24,
        "fullcodeline": "} else if (rc < 0) {"
    },
    {
        "line": 25,
        "fullcodeline": "crm_perror(LOG_ERR, \"Error receiving message: %d\", (int)rc);"
    },
    {
        "line": 28,
        "fullcodeline": "} else if (rc == chunk_size) {"
    },
    {
        "line": 29,
        "fullcodeline": "len += rc;"
    },
    {
        "line": 30,
        "fullcodeline": "chunk_size *= 2;"
    },
    {
        "line": 31,
        "fullcodeline": "buf = realloc(buf, len + chunk_size);"
    },
    {
        "line": 32,
        "fullcodeline": "crm_trace(\"Retry with %d more bytes\", (int)chunk_size);"
    },
    {
        "line": 33,
        "fullcodeline": "CRM_ASSERT(buf != NULL);"
    },
    {
        "line": 35,
        "fullcodeline": "} else if (buf[len + rc - 1] != 0) {"
    },
    {
        "line": 36,
        "fullcodeline": "crm_trace(\"Last char is %d '%c'\", buf[len + rc - 1], buf[len + rc - 1]);"
    },
    {
        "line": 37,
        "fullcodeline": "crm_trace(\"Retry with %d more bytes\", (int)chunk_size);"
    },
    {
        "line": 38,
        "fullcodeline": "len += rc;"
    },
    {
        "line": 39,
        "fullcodeline": "buf = realloc(buf, len + chunk_size);"
    },
    {
        "line": 40,
        "fullcodeline": "CRM_ASSERT(buf != NULL);"
    }
]