[
    {
        "line": 3,
        "fullcodeline": "int rc = pcmk_ok;"
    },
    {
        "line": 4,
        "fullcodeline": "static gboolean need_pass = TRUE;"
    },
    {
        "line": 8,
        "fullcodeline": "if (getenv(\"CIB_passwd\") != NULL) {"
    },
    {
        "line": 12,
        "fullcodeline": "if(watch_fencing && st == NULL) {"
    },
    {
        "line": 16,
        "fullcodeline": "if(watch_fencing && st->state == stonith_disconnected) {"
    },
    {
        "line": 25,
        "fullcodeline": "if (cib->state != cib_connected_query && cib->state != cib_connected_command) {"
    },
    {
        "line": 9,
        "fullcodeline": "need_pass = FALSE;"
    },
    {
        "line": 13,
        "fullcodeline": "st = stonith_api_new();"
    },
    {
        "line": 17,
        "fullcodeline": "crm_trace(\"Connecting to stonith\");"
    },
    {
        "line": 18,
        "fullcodeline": "rc = st->cmds->connect(st, crm_system_name, NULL);"
    },
    {
        "line": 26,
        "fullcodeline": "crm_trace(\"Connecting to the CIB\");"
    },
    {
        "line": 32,
        "fullcodeline": "rc = cib->cmds->signon(cib, crm_system_name, cib_query);"
    },
    {
        "line": 38,
        "fullcodeline": "current_cib = get_cib_copy(cib);"
    },
    {
        "line": 39,
        "fullcodeline": "mon_refresh_display(NULL);"
    },
    {
        "line": 19,
        "fullcodeline": "if(rc == pcmk_ok) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (as_console && need_pass && cib->variant == cib_remote) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (rc != pcmk_ok) {"
    },
    {
        "line": 20,
        "fullcodeline": "crm_trace(\"Setting up stonith callbacks\");"
    },
    {
        "line": 21,
        "fullcodeline": "st->cmds->register_notification(st, T_STONITH_NOTIFY_FENCE, mon_st_callback);"
    },
    {
        "line": 28,
        "fullcodeline": "need_pass = FALSE;"
    },
    {
        "line": 29,
        "fullcodeline": "print_as(\"Password:\");"
    },
    {
        "line": 42,
        "fullcodeline": "if (rc == pcmk_ok) {"
    },
    {
        "line": 54,
        "fullcodeline": "if (rc == pcmk_ok) {"
    },
    {
        "line": 59,
        "fullcodeline": "if (rc != pcmk_ok) {"
    },
    {
        "line": 43,
        "fullcodeline": "rc = cib->cmds->set_connection_dnotify(cib, mon_cib_connection_destroy);"
    },
    {
        "line": 55,
        "fullcodeline": "cib->cmds->del_notify_callback(cib, T_CIB_DIFF_NOTIFY, crm_diff_update);"
    },
    {
        "line": 56,
        "fullcodeline": "rc = cib->cmds->add_notify_callback(cib, T_CIB_DIFF_NOTIFY, crm_diff_update);"
    },
    {
        "line": 60,
        "fullcodeline": "print_as(\"Notification setup failed, could not monitor CIB actions\");"
    },
    {
        "line": 64,
        "fullcodeline": "clean_up(-rc);"
    },
    {
        "line": 44,
        "fullcodeline": "if (rc == -EPROTONOSUPPORT) {"
    },
    {
        "line": 45,
        "fullcodeline": "print_as(\"Notification setup failed, won't be able to reconnect after failure\");"
    },
    {
        "line": 49,
        "fullcodeline": "rc = pcmk_ok;"
    },
    {
        "line": 62,
        "fullcodeline": "sleep(2);"
    },
    {
        "line": 47,
        "fullcodeline": "sleep(2);"
    }
]