[
    {
        "line": 3,
        "fullcodeline": "cib_t *cib = user_data;"
    },
    {
        "line": 4,
        "fullcodeline": "cib_remote_opaque_t *private = cib->variant_opaque;"
    },
    {
        "line": 6,
        "fullcodeline": "xmlNode *msg = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "const char *type = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "crm_info(\"Message on callback channel\");"
    },
    {
        "line": 10,
        "fullcodeline": "msg = crm_recv_remote_msg(private->callback.session, private->callback.encrypted);"
    },
    {
        "line": 12,
        "fullcodeline": "type = crm_element_value(msg, F_TYPE);"
    },
    {
        "line": 13,
        "fullcodeline": "crm_trace(\"Activating %s callbacks...\", type);"
    },
    {
        "line": 15,
        "fullcodeline": "if (safe_str_eq(type, T_CIB)) {"
    },
    {
        "line": 25,
        "fullcodeline": "if (msg != NULL) {"
    },
    {
        "line": 29,
        "fullcodeline": "return -1;"
    },
    {
        "line": 16,
        "fullcodeline": "cib_native_callback(cib, msg, 0, 0);"
    },
    {
        "line": 26,
        "fullcodeline": "free_xml(msg);"
    },
    {
        "line": 18,
        "fullcodeline": "} else if (safe_str_eq(type, T_CIB_NOTIFY)) {"
    },
    {
        "line": 19,
        "fullcodeline": "g_list_foreach(cib->notify_list, cib_native_notify, msg);"
    },
    {
        "line": 22,
        "fullcodeline": "crm_err(\"Unknown message type: %s\", type);"
    }
]