[
    {
        "line": 6,
        "fullcodeline": "const char *server = host;"
    },
    {
        "line": 11,
        "fullcodeline": "memset(&hints, 0, sizeof(struct addrinfo));"
    },
    {
        "line": 12,
        "fullcodeline": "hints.ai_family = AF_UNSPEC;    /* Allow IPv4 or IPv6 */"
    },
    {
        "line": 13,
        "fullcodeline": "hints.ai_socktype = SOCK_STREAM;"
    },
    {
        "line": 14,
        "fullcodeline": "hints.ai_flags = AI_CANONNAME;"
    },
    {
        "line": 16,
        "fullcodeline": "crm_debug(\"Looking up %s\", server);"
    },
    {
        "line": 17,
        "fullcodeline": "ret_ga = getaddrinfo(server, NULL, &hints, &res);"
    },
    {
        "line": 28,
        "fullcodeline": "for (rp = res; rp != NULL; rp = rp->ai_next) {"
    },
    {
        "line": 19,
        "fullcodeline": "crm_err(\"getaddrinfo: %s\", gai_strerror(ret_ga));"
    },
    {
        "line": 23,
        "fullcodeline": "if (!res || !res->ai_addr) {"
    },
    {
        "line": 29,
        "fullcodeline": "struct sockaddr *addr = rp->ai_addr;"
    },
    {
        "line": 41,
        "fullcodeline": "sock = socket(rp->ai_family, SOCK_STREAM, IPPROTO_TCP);"
    },
    {
        "line": 68,
        "fullcodeline": "sock = -1;"
    },
    {
        "line": 20,
        "fullcodeline": "return -1;"
    },
    {
        "line": 25,
        "fullcodeline": "return -1;"
    },
    {
        "line": 31,
        "fullcodeline": "if (!addr) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (sock == -1) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (addr->sa_family == AF_INET6) {"
    },
    {
        "line": 36,
        "fullcodeline": "server = res->ai_canonname;"
    },
    {
        "line": 55,
        "fullcodeline": "if (connect(sock, rp->ai_addr, rp->ai_addrlen) == 0) {"
    },
    {
        "line": 48,
        "fullcodeline": "addr_in->sin6_port = htons(port);"
    },
    {
        "line": 50,
        "fullcodeline": "struct sockaddr_in *addr_in = (struct sockaddr_in *) addr;"
    },
    {
        "line": 52,
        "fullcodeline": "crm_info(\"Attempting to connect to remote server at %s:%d\", inet_ntoa(addr_in->sin_addr), port);"
    },
    {
        "line": 51,
        "fullcodeline": "addr_in->sin_port = htons(port);"
    },
    {
        "line": 56,
        "fullcodeline": "if ((flag = fcntl(sock, F_GETFL)) >= 0) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (fcntl(sock, F_SETFL, flag | O_NONBLOCK) < 0) {"
    },
    {
        "line": 60,
        "fullcodeline": "sock = -1;"
    }
]