[
    {
        "line": 3,
        "fullcodeline": "TcpStream *stream = NULL, *ostream = NULL;"
    },
    {
        "line": 25,
        "fullcodeline": "seq = TCP_GET_SEQ(p);"
    },
    {
        "line": 26,
        "fullcodeline": "ack = TCP_GET_ACK(p);"
    },
    {
        "line": 28,
        "fullcodeline": "pkt_win = TCP_GET_WINDOW(p) << ostream->wscale;"
    },
    {
        "line": 62,
        "fullcodeline": "SCLogDebug(\"seq %u (%u), ack %u (%u)\", seq, stream->next_seq, ack, ostream->last_ack);"
    },
    {
        "line": 8,
        "fullcodeline": "if (p->flags & PKT_PSEUDO_STREAM_END)"
    },
    {
        "line": 11,
        "fullcodeline": "if (ssn->state < TCP_ESTABLISHED || ssn->state == TCP_CLOSED)"
    },
    {
        "line": 14,
        "fullcodeline": "if ((p->tcph->th_flags & (TH_SYN|TH_FIN|TH_RST)) != 0)"
    },
    {
        "line": 17,
        "fullcodeline": "if (PKT_IS_TOSERVER(p)) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (pkt_win < ostream->window) {"
    },
    {
        "line": 18,
        "fullcodeline": "stream = &ssn->client;"
    },
    {
        "line": 19,
        "fullcodeline": "ostream = &ssn->server;"
    },
    {
        "line": 31,
        "fullcodeline": "uint32_t diff = ostream->window - pkt_win;"
    },
    {
        "line": 21,
        "fullcodeline": "stream = &ssn->server;"
    },
    {
        "line": 22,
        "fullcodeline": "ostream = &ssn->client;"
    },
    {
        "line": 32,
        "fullcodeline": "if (diff > p->payload_len &&"
    },
    {
        "line": 34,
        "fullcodeline": "SEQ_GT(seq, stream->next_seq))"
    },
    {
        "line": 49,
        "fullcodeline": "uint32_t adiff = ack - ostream->last_ack;"
    },
    {
        "line": 33,
        "fullcodeline": "SEQ_GT(ack, ostream->next_seq) &&"
    },
    {
        "line": 50,
        "fullcodeline": "if (((pkt_win > 1024) && (diff > (adiff + 32))) ||"
    },
    {
        "line": 51,
        "fullcodeline": "((pkt_win <= 1024) && (diff > adiff)))"
    },
    {
        "line": 53,
        "fullcodeline": "SCLogDebug(\"pkt ACK %u is %u bytes beyond last_ack %u, shrinks window by %u \""
    },
    {
        "line": 55,
        "fullcodeline": "SCLogDebug(\"%u - %u = %u (state %u)\", diff, adiff, diff - adiff, ssn->state);"
    },
    {
        "line": 56,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_PKT_BAD_WINDOW_UPDATE);"
    }
]