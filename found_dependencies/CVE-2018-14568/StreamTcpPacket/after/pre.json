[
    {
        "line": 4,
        "fullcodeline": "SCEnter();"
    },
    {
        "line": 6,
        "fullcodeline": "DEBUG_ASSERT_FLOW_LOCKED(p->flow);"
    },
    {
        "line": 19,
        "fullcodeline": "TcpSession *ssn = (TcpSession *)p->flow->protoctx;"
    },
    {
        "line": 201,
        "fullcodeline": "SCReturnInt(0);"
    },
    {
        "line": 224,
        "fullcodeline": "SCReturnInt(-1);"
    },
    {
        "line": 11,
        "fullcodeline": "if (unlikely(p->flow->thread_id == 0)) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (ssn != NULL) {"
    },
    {
        "line": 40,
        "fullcodeline": "if ((p->tcph->th_flags & (TH_SYN|TH_ACK)) == (TH_SYN|TH_ACK)) {"
    },
    {
        "line": 45,
        "fullcodeline": "if (p->tcph->th_flags & (TH_RST)) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (!(p->tcph->th_flags & TH_ACK) && TCP_GET_ACK(p) != 0) {"
    },
    {
        "line": 58,
        "fullcodeline": "if (StreamTcpCheckFlowDrops(p) == 1) {"
    },
    {
        "line": 69,
        "fullcodeline": "if (ssn == NULL || ssn->state == TCP_NONE) {"
    },
    {
        "line": 132,
        "fullcodeline": "if (ssn != NULL) {"
    },
    {
        "line": 205,
        "fullcodeline": "while (stt->pseudo_queue.len > 0) {"
    },
    {
        "line": 213,
        "fullcodeline": "if (p->flags & PKT_STREAM_MODIFIED) {"
    },
    {
        "line": 217,
        "fullcodeline": "if (StreamTcpInlineDropInvalid()) {"
    },
    {
        "line": 12,
        "fullcodeline": "p->flow->thread_id = (FlowThreadId)tv->id;"
    },
    {
        "line": 23,
        "fullcodeline": "ssn->tcp_packet_flags |= p->tcph->th_flags;"
    },
    {
        "line": 41,
        "fullcodeline": "StatsIncr(tv, stt->counter_tcp_synack);"
    },
    {
        "line": 46,
        "fullcodeline": "StatsIncr(tv, stt->counter_tcp_rst);"
    },
    {
        "line": 51,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_PKT_BROKEN_ACK);"
    },
    {
        "line": 59,
        "fullcodeline": "SCLogDebug(\"This flow/stream triggered a drop rule\");"
    },
    {
        "line": 60,
        "fullcodeline": "FlowSetNoPacketInspectionFlag(p->flow);"
    },
    {
        "line": 61,
        "fullcodeline": "DecodeSetNoPacketInspectionFlag(p);"
    },
    {
        "line": 62,
        "fullcodeline": "StreamTcpDisableAppLayer(p->flow);"
    },
    {
        "line": 63,
        "fullcodeline": "PACKET_DROP(p);"
    },
    {
        "line": 65,
        "fullcodeline": "StreamTcpSessionPktFree(p);"
    },
    {
        "line": 66,
        "fullcodeline": "SCReturnInt(0);"
    },
    {
        "line": 206,
        "fullcodeline": "Packet *np = PacketDequeue(&stt->pseudo_queue);"
    },
    {
        "line": 214,
        "fullcodeline": "ReCalculateChecksum(p);"
    },
    {
        "line": 221,
        "fullcodeline": "DecodeSetNoPayloadInspectionFlag(p);"
    },
    {
        "line": 222,
        "fullcodeline": "PACKET_DROP(p);"
    },
    {
        "line": 24,
        "fullcodeline": "if (PKT_IS_TOSERVER(p))"
    },
    {
        "line": 30,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_ASYNC &&"
    },
    {
        "line": 70,
        "fullcodeline": "if (StreamTcpPacketStateNone(tv, p, stt, ssn, &stt->pseudo_queue) == -1) {"
    },
    {
        "line": 106,
        "fullcodeline": "StreamTcpClearKeepAliveFlag(ssn, p);"
    },
    {
        "line": 120,
        "fullcodeline": "StreamTcpPacketCheckPostRst(ssn, p);"
    },
    {
        "line": 133,
        "fullcodeline": "while (stt->pseudo_queue.len > 0) {"
    },
    {
        "line": 155,
        "fullcodeline": "if (p->flags & PKT_STREAM_MODIFIED) {"
    },
    {
        "line": 162,
        "fullcodeline": "if ((ssn->client.flags & STREAMTCP_STREAM_FLAG_DEPTH_REACHED) &&"
    },
    {
        "line": 171,
        "fullcodeline": "if ((ssn->client.flags & STREAMTCP_STREAM_FLAG_DEPTH_REACHED) ||"
    },
    {
        "line": 178,
        "fullcodeline": "if ((PKT_IS_TOSERVER(p) && (ssn->client.flags & STREAMTCP_STREAM_FLAG_NOREASSEMBLY)) ||"
    },
    {
        "line": 184,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_BYPASS) {"
    },
    {
        "line": 207,
        "fullcodeline": "if (np != NULL) {"
    },
    {
        "line": 25,
        "fullcodeline": "ssn->client.tcp_flags |= p->tcph->th_flags;"
    },
    {
        "line": 32,
        "fullcodeline": "ssn->server.tcp_flags != 0)"
    },
    {
        "line": 34,
        "fullcodeline": "SCLogDebug(\"ssn %p: removing ASYNC flag as we have packets on both sides\", ssn);"
    },
    {
        "line": 35,
        "fullcodeline": "ssn->flags &= ~STREAMTCP_FLAG_ASYNC;"
    },
    {
        "line": 42,
        "fullcodeline": "} else if (p->tcph->th_flags & (TH_SYN)) {"
    },
    {
        "line": 80,
        "fullcodeline": "if (p->flags & PKT_PSEUDO_STREAM_END) {"
    },
    {
        "line": 96,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_MIDSTREAM_SYNACK)"
    },
    {
        "line": 99,
        "fullcodeline": "if (StreamTcpPacketIsKeepAlive(ssn, p) == 1) {"
    },
    {
        "line": 102,
        "fullcodeline": "if (StreamTcpPacketIsKeepAliveACK(ssn, p) == 1) {"
    },
    {
        "line": 110,
        "fullcodeline": "if (StreamTcpPacketIsFinShutdownAck(ssn, p) == 0)"
    },
    {
        "line": 116,
        "fullcodeline": "if (StreamTcpStateDispatch(tv, p, stt, ssn, &stt->pseudo_queue, ssn->state) < 0)"
    },
    {
        "line": 122,
        "fullcodeline": "if (ssn->state >= TCP_ESTABLISHED) {"
    },
    {
        "line": 134,
        "fullcodeline": "SCLogDebug(\"processing pseudo packet / stream end\");"
    },
    {
        "line": 135,
        "fullcodeline": "Packet *np = PacketDequeue(&stt->pseudo_queue);"
    },
    {
        "line": 151,
        "fullcodeline": "SCLogDebug(\"processing pseudo packet / stream end done\");"
    },
    {
        "line": 156,
        "fullcodeline": "ReCalculateChecksum(p);"
    },
    {
        "line": 163,
        "fullcodeline": "(ssn->server.flags & STREAMTCP_STREAM_FLAG_DEPTH_REACHED))"
    },
    {
        "line": 172,
        "fullcodeline": "(ssn->server.flags & STREAMTCP_STREAM_FLAG_DEPTH_REACHED))"
    },
    {
        "line": 174,
        "fullcodeline": "p->flags |= PKT_STREAM_NOPCAPLOG;"
    },
    {
        "line": 179,
        "fullcodeline": "(PKT_IS_TOCLIENT(p) && (ssn->server.flags & STREAMTCP_STREAM_FLAG_NOREASSEMBLY)))"
    },
    {
        "line": 181,
        "fullcodeline": "p->flags |= PKT_STREAM_NOPCAPLOG;"
    },
    {
        "line": 208,
        "fullcodeline": "PacketEnqueue(pq, np);"
    },
    {
        "line": 31,
        "fullcodeline": "ssn->client.tcp_flags != 0 &&"
    },
    {
        "line": 43,
        "fullcodeline": "StatsIncr(tv, stt->counter_tcp_syn);"
    },
    {
        "line": 97,
        "fullcodeline": "StreamTcpPacketSwitchDir(ssn, p);"
    },
    {
        "line": 103,
        "fullcodeline": "StreamTcpClearKeepAliveFlag(ssn, p);"
    },
    {
        "line": 123,
        "fullcodeline": "p->flags |= PKT_STREAM_EST;"
    },
    {
        "line": 136,
        "fullcodeline": "if (np != NULL) {"
    },
    {
        "line": 166,
        "fullcodeline": "if (StreamTcpBypassEnabled()) {"
    },
    {
        "line": 186,
        "fullcodeline": "if (StreamTcpBypassEnabled()) {"
    },
    {
        "line": 26,
        "fullcodeline": "else if (PKT_IS_TOCLIENT(p))"
    },
    {
        "line": 81,
        "fullcodeline": "if (PKT_IS_TOCLIENT(p)) {"
    },
    {
        "line": 111,
        "fullcodeline": "if (StreamTcpPacketIsWindowUpdate(ssn, p) == 0)"
    },
    {
        "line": 149,
        "fullcodeline": "PacketEnqueue(pq, np);"
    },
    {
        "line": 167,
        "fullcodeline": "PacketBypassCallback(p);"
    },
    {
        "line": 187,
        "fullcodeline": "PacketBypassCallback(p);"
    },
    {
        "line": 191,
        "fullcodeline": "} else if (g_detect_disabled &&"
    },
    {
        "line": 27,
        "fullcodeline": "ssn->server.tcp_flags |= p->tcph->th_flags;"
    },
    {
        "line": 82,
        "fullcodeline": "ssn->client.last_ack = TCP_GET_ACK(p);"
    },
    {
        "line": 83,
        "fullcodeline": "StreamTcpReassembleHandleSegment(tv, stt->ra_ctx, ssn,"
    },
    {
        "line": 138,
        "fullcodeline": "if (PKT_IS_TOSERVER(np)) {"
    },
    {
        "line": 196,
        "fullcodeline": "SCLogDebug(\"bypass as stream is dead and we have no rules\");"
    },
    {
        "line": 197,
        "fullcodeline": "PacketBypassCallback(p);"
    },
    {
        "line": 86,
        "fullcodeline": "ssn->server.last_ack = TCP_GET_ACK(p);"
    },
    {
        "line": 87,
        "fullcodeline": "StreamTcpReassembleHandleSegment(tv, stt->ra_ctx, ssn,"
    },
    {
        "line": 112,
        "fullcodeline": "if (StreamTcpPacketIsBadWindowUpdate(ssn,p))"
    },
    {
        "line": 139,
        "fullcodeline": "SCLogDebug(\"pseudo packet is to server\");"
    },
    {
        "line": 140,
        "fullcodeline": "StreamTcpReassembleHandleSegment(tv, stt->ra_ctx, ssn,"
    },
    {
        "line": 193,
        "fullcodeline": "(ssn->server.flags & STREAMTCP_STREAM_FLAG_NOREASSEMBLY) &&"
    },
    {
        "line": 143,
        "fullcodeline": "SCLogDebug(\"pseudo packet is to client\");"
    },
    {
        "line": 144,
        "fullcodeline": "StreamTcpReassembleHandleSegment(tv, stt->ra_ctx, ssn,"
    },
    {
        "line": 192,
        "fullcodeline": "(ssn->client.flags & STREAMTCP_STREAM_FLAG_NOREASSEMBLY) &&"
    }
]