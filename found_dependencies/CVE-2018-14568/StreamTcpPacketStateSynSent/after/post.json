[
    {
        "line": 7,
        "fullcodeline": "SCLogDebug(\"ssn %p: pkt received: %s\", ssn, PKT_IS_TOCLIENT(p) ?"
    },
    {
        "line": 4,
        "fullcodeline": "if (ssn == NULL)"
    },
    {
        "line": 11,
        "fullcodeline": "if (p->tcph->th_flags & TH_RST) {"
    },
    {
        "line": 5,
        "fullcodeline": "return -1;"
    },
    {
        "line": 12,
        "fullcodeline": "if (!StreamTcpValidateRst(ssn, p))"
    },
    {
        "line": 15,
        "fullcodeline": "if (PKT_IS_TOSERVER(p)) {"
    },
    {
        "line": 36,
        "fullcodeline": "} else if (p->tcph->th_flags & TH_FIN) {"
    },
    {
        "line": 13,
        "fullcodeline": "return -1;"
    },
    {
        "line": 16,
        "fullcodeline": "if (SEQ_EQ(TCP_GET_SEQ(p), ssn->client.isn) &&"
    },
    {
        "line": 28,
        "fullcodeline": "ssn->client.flags |= STREAMTCP_STREAM_FLAG_RST_RECV;"
    },
    {
        "line": 29,
        "fullcodeline": "SCLogDebug(\"ssn->client.flags |= STREAMTCP_STREAM_FLAG_RST_RECV\");"
    },
    {
        "line": 30,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_CLOSED);"
    },
    {
        "line": 31,
        "fullcodeline": "SCLogDebug(\"ssn %p: Reset received and state changed to \""
    },
    {
        "line": 18,
        "fullcodeline": "SEQ_EQ(TCP_GET_ACK(p), (ssn->client.isn + 1)))"
    },
    {
        "line": 20,
        "fullcodeline": "SCLogDebug(\"ssn->server.flags |= STREAMTCP_STREAM_FLAG_RST_RECV\");"
    },
    {
        "line": 21,
        "fullcodeline": "ssn->server.flags |= STREAMTCP_STREAM_FLAG_RST_RECV;"
    },
    {
        "line": 23,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_CLOSED);"
    },
    {
        "line": 24,
        "fullcodeline": "SCLogDebug(\"ssn %p: Reset received and state changed to \""
    },
    {
        "line": 17,
        "fullcodeline": "SEQ_EQ(TCP_GET_WINDOW(p), 0) &&"
    },
    {
        "line": 40,
        "fullcodeline": "} else if ((p->tcph->th_flags & (TH_SYN|TH_ACK)) == (TH_SYN|TH_ACK)) {"
    },
    {
        "line": 151,
        "fullcodeline": "StreamTcp3whsSynAckUpdate(ssn, p, /* no queue override */NULL);"
    },
    {
        "line": 41,
        "fullcodeline": "if ((ssn->flags & STREAMTCP_FLAG_4WHS) && PKT_IS_TOSERVER(p)) {"
    },
    {
        "line": 135,
        "fullcodeline": "if (PKT_IS_TOSERVER(p)) {"
    },
    {
        "line": 143,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_ACK(p), ssn->client.isn + 1))) {"
    },
    {
        "line": 42,
        "fullcodeline": "SCLogDebug(\"ssn %p: SYN/ACK received on 4WHS session\", ssn);"
    },
    {
        "line": 68,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_SYN_RECV);"
    },
    {
        "line": 69,
        "fullcodeline": "SCLogDebug(\"ssn %p: =~ 4WHS ssn state is now TCP_SYN_RECV\", ssn);"
    },
    {
        "line": 72,
        "fullcodeline": "ssn->client.isn = TCP_GET_SEQ(p);"
    },
    {
        "line": 73,
        "fullcodeline": "STREAMTCP_SET_RA_BASE_SEQ(&ssn->client, ssn->client.isn);"
    },
    {
        "line": 74,
        "fullcodeline": "ssn->client.next_seq = ssn->client.isn + 1;"
    },
    {
        "line": 76,
        "fullcodeline": "ssn->server.window = TCP_GET_WINDOW(p);"
    },
    {
        "line": 99,
        "fullcodeline": "ssn->server.last_ack = TCP_GET_ACK(p);"
    },
    {
        "line": 100,
        "fullcodeline": "ssn->client.last_ack = ssn->client.isn + 1;"
    },
    {
        "line": 118,
        "fullcodeline": "ssn->client.next_win = ssn->client.last_ack + ssn->client.window;"
    },
    {
        "line": 119,
        "fullcodeline": "ssn->server.next_win = ssn->server.last_ack + ssn->server.window;"
    },
    {
        "line": 136,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_3WHS_SYNACK_IN_WRONG_DIRECTION);"
    },
    {
        "line": 137,
        "fullcodeline": "SCLogDebug(\"ssn %p: SYN/ACK received in the wrong direction\", ssn);"
    },
    {
        "line": 144,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_3WHS_SYNACK_WITH_WRONG_ACK);"
    },
    {
        "line": 153,
        "fullcodeline": "} else if (p->tcph->th_flags & TH_SYN) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_ACK(p), ssn->server.isn + 1))) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_SEQ(p), ssn->client.isn))) {"
    },
    {
        "line": 82,
        "fullcodeline": "if ((TCP_HAS_TS(p)) &&"
    },
    {
        "line": 104,
        "fullcodeline": "if ((ssn->flags & STREAMTCP_FLAG_SERVER_WSCALE) &&"
    },
    {
        "line": 112,
        "fullcodeline": "if ((ssn->flags & STREAMTCP_FLAG_CLIENT_SACKOK) &&"
    },
    {
        "line": 138,
        "fullcodeline": "return -1;"
    },
    {
        "line": 148,
        "fullcodeline": "return -1;"
    },
    {
        "line": 154,
        "fullcodeline": "SCLogDebug(\"ssn %p: SYN packet on state SYN_SENT... resent\", ssn);"
    },
    {
        "line": 47,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_4WHS_SYNACK_WITH_WRONG_ACK);"
    },
    {
        "line": 58,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_4WHS_SYNACK_WITH_WRONG_SYN);"
    },
    {
        "line": 83,
        "fullcodeline": "(ssn->server.flags & STREAMTCP_STREAM_FLAG_TIMESTAMP))"
    },
    {
        "line": 85,
        "fullcodeline": "ssn->client.last_ts = TCP_GET_TSVAL(p);"
    },
    {
        "line": 89,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_TIMESTAMP;"
    },
    {
        "line": 105,
        "fullcodeline": "(TCP_HAS_WSCALE(p)))"
    },
    {
        "line": 107,
        "fullcodeline": "ssn->server.wscale = TCP_GET_WSCALE(p);"
    },
    {
        "line": 113,
        "fullcodeline": "TCP_GET_SACKOK(p) == 1) {"
    },
    {
        "line": 114,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_SACKOK;"
    },
    {
        "line": 115,
        "fullcodeline": "SCLogDebug(\"ssn %p: SACK permitted for 4WHS session\", ssn);"
    },
    {
        "line": 155,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_4WHS) {"
    },
    {
        "line": 160,
        "fullcodeline": "if (PKT_IS_TOCLIENT(p)) {"
    },
    {
        "line": 52,
        "fullcodeline": "return -1;"
    },
    {
        "line": 63,
        "fullcodeline": "return -1;"
    },
    {
        "line": 91,
        "fullcodeline": "if (ssn->client.last_ts == 0)"
    },
    {
        "line": 94,
        "fullcodeline": "ssn->server.last_ts = 0;"
    },
    {
        "line": 95,
        "fullcodeline": "ssn->client.last_ts = 0;"
    },
    {
        "line": 96,
        "fullcodeline": "ssn->server.flags &= ~STREAMTCP_STREAM_FLAG_ZERO_TIMESTAMP;"
    },
    {
        "line": 109,
        "fullcodeline": "ssn->server.wscale = 0;"
    },
    {
        "line": 156,
        "fullcodeline": "SCLogDebug(\"ssn %p: SYN packet on state SYN_SENT... resent of \""
    },
    {
        "line": 168,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_4WHS;"
    },
    {
        "line": 169,
        "fullcodeline": "SCLogDebug(\"ssn %p: STREAMTCP_FLAG_4WHS flag set\", ssn);"
    },
    {
        "line": 175,
        "fullcodeline": "ssn->server.isn = TCP_GET_SEQ(p);"
    },
    {
        "line": 176,
        "fullcodeline": "STREAMTCP_SET_RA_BASE_SEQ(&ssn->server, ssn->server.isn);"
    },
    {
        "line": 177,
        "fullcodeline": "ssn->server.next_seq = ssn->server.isn + 1;"
    },
    {
        "line": 191,
        "fullcodeline": "ssn->server.window = TCP_GET_WINDOW(p);"
    },
    {
        "line": 220,
        "fullcodeline": "} else if (p->tcph->th_flags & TH_ACK) {"
    },
    {
        "line": 92,
        "fullcodeline": "ssn->client.flags |= STREAMTCP_STREAM_FLAG_ZERO_TIMESTAMP;"
    },
    {
        "line": 181,
        "fullcodeline": "if (TCP_HAS_TS(p)) {"
    },
    {
        "line": 192,
        "fullcodeline": "if (TCP_HAS_WSCALE(p)) {"
    },
    {
        "line": 200,
        "fullcodeline": "if (TCP_GET_SACKOK(p) == 1) {"
    },
    {
        "line": 240,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_ASYNC;"
    },
    {
        "line": 241,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_ESTABLISHED);"
    },
    {
        "line": 242,
        "fullcodeline": "SCLogDebug(\"ssn %p: =~ ssn state is now TCP_ESTABLISHED\", ssn);"
    },
    {
        "line": 244,
        "fullcodeline": "ssn->client.window = TCP_GET_WINDOW(p);"
    },
    {
        "line": 245,
        "fullcodeline": "ssn->client.last_ack = TCP_GET_SEQ(p);"
    },
    {
        "line": 246,
        "fullcodeline": "ssn->client.next_win = ssn->client.last_ack + ssn->client.window;"
    },
    {
        "line": 249,
        "fullcodeline": "ssn->server.isn = TCP_GET_ACK(p) - 1;"
    },
    {
        "line": 250,
        "fullcodeline": "STREAMTCP_SET_RA_BASE_SEQ(&ssn->server, ssn->server.isn);"
    },
    {
        "line": 251,
        "fullcodeline": "ssn->server.next_seq = ssn->server.isn + 1;"
    },
    {
        "line": 252,
        "fullcodeline": "ssn->server.last_ack = ssn->server.next_seq;"
    },
    {
        "line": 253,
        "fullcodeline": "ssn->server.next_win = ssn->server.last_ack;"
    },
    {
        "line": 284,
        "fullcodeline": "StreamTcpReassembleHandleSegment(tv, stt->ra_ctx, ssn,"
    },
    {
        "line": 182,
        "fullcodeline": "ssn->server.last_ts = TCP_GET_TSVAL(p);"
    },
    {
        "line": 183,
        "fullcodeline": "SCLogDebug(\"ssn %p: %02x\", ssn, ssn->server.last_ts);"
    },
    {
        "line": 188,
        "fullcodeline": "ssn->server.flags |= STREAMTCP_STREAM_FLAG_TIMESTAMP;"
    },
    {
        "line": 193,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_SERVER_WSCALE;"
    },
    {
        "line": 194,
        "fullcodeline": "ssn->server.wscale = TCP_GET_WSCALE(p);"
    },
    {
        "line": 201,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_CLIENT_SACKOK;"
    },
    {
        "line": 224,
        "fullcodeline": "if (stream_config.async_oneside == FALSE)"
    },
    {
        "line": 231,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_SEQ(p), ssn->client.next_seq))) {"
    },
    {
        "line": 263,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_SERVER_WSCALE) {"
    },
    {
        "line": 269,
        "fullcodeline": "if (TCP_HAS_TS(p) &&"
    },
    {
        "line": 280,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_CLIENT_SACKOK) {"
    },
    {
        "line": 288,
        "fullcodeline": "SCLogDebug(\"ssn %p: default case\", ssn);"
    },
    {
        "line": 185,
        "fullcodeline": "if (ssn->server.last_ts == 0)"
    },
    {
        "line": 196,
        "fullcodeline": "ssn->flags &= ~STREAMTCP_FLAG_SERVER_WSCALE;"
    },
    {
        "line": 197,
        "fullcodeline": "ssn->server.wscale = 0;"
    },
    {
        "line": 203,
        "fullcodeline": "ssn->flags &= ~STREAMTCP_FLAG_CLIENT_SACKOK;"
    },
    {
        "line": 232,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_3WHS_ASYNC_WRONG_SEQ);"
    },
    {
        "line": 264,
        "fullcodeline": "ssn->client.wscale = TCP_WSCALE_MAX;"
    },
    {
        "line": 270,
        "fullcodeline": "(ssn->client.flags & STREAMTCP_STREAM_FLAG_TIMESTAMP))"
    },
    {
        "line": 272,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_TIMESTAMP;"
    },
    {
        "line": 273,
        "fullcodeline": "ssn->client.flags &= ~STREAMTCP_STREAM_FLAG_TIMESTAMP;"
    },
    {
        "line": 281,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_SACKOK;"
    },
    {
        "line": 186,
        "fullcodeline": "ssn->server.flags |= STREAMTCP_STREAM_FLAG_ZERO_TIMESTAMP;"
    },
    {
        "line": 237,
        "fullcodeline": "return -1;"
    },
    {
        "line": 276,
        "fullcodeline": "ssn->client.last_ts = 0;"
    },
    {
        "line": 277,
        "fullcodeline": "ssn->client.flags &= ~STREAMTCP_STREAM_FLAG_ZERO_TIMESTAMP;"
    }
]