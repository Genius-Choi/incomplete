[
    {
        "line": 2,
        "fullcodeline": "config_disabled = ("
    },
    {
        "line": 6,
        "fullcodeline": "name = ''"
    },
    {
        "line": 3,
        "fullcodeline": "app.config['CONFIG_DISABLE'] or"
    },
    {
        "line": 7,
        "fullcodeline": "if 'name' in request.args:"
    },
    {
        "line": 12,
        "fullcodeline": "if request.method == 'GET':"
    },
    {
        "line": 4,
        "fullcodeline": "not valid_user_session(session))"
    },
    {
        "line": 8,
        "fullcodeline": "name = os.path.normpath(request.args.get('name'))"
    },
    {
        "line": 9,
        "fullcodeline": "if not re.match(r'^[A-Za-z0-9_.+-]+$', name):"
    },
    {
        "line": 13,
        "fullcodeline": "return json.dumps(g.user_config.__dict__)"
    },
    {
        "line": 14,
        "fullcodeline": "elif request.method == 'PUT' and not config_disabled:"
    },
    {
        "line": 10,
        "fullcodeline": "return make_response('Invalid config name', 400)"
    },
    {
        "line": 16,
        "fullcodeline": "config_pkl = os.path.join(app.config['CONFIG_PATH'], name)"
    },
    {
        "line": 17,
        "fullcodeline": "session['config'] = (pickle.load(open(config_pkl, 'rb'))"
    },
    {
        "line": 24,
        "fullcodeline": "config_data = request.form.to_dict()"
    },
    {
        "line": 20,
        "fullcodeline": "return json.dumps(session['config'])"
    },
    {
        "line": 22,
        "fullcodeline": "return json.dumps({})"
    },
    {
        "line": 37,
        "fullcodeline": "return redirect(config_data['url'])"
    },
    {
        "line": 39,
        "fullcodeline": "return redirect(url_for('.index'), code=403)"
    },
    {
        "line": 25,
        "fullcodeline": "if 'url' not in config_data or not config_data['url']:"
    },
    {
        "line": 26,
        "fullcodeline": "config_data['url'] = g.user_config.url"
    },
    {
        "line": 30,
        "fullcodeline": "pickle.dump("
    },
    {
        "line": 18,
        "fullcodeline": "if os.path.exists(config_pkl)"
    },
    {
        "line": 32,
        "fullcodeline": "open(os.path.join("
    }
]