[
    {
        "line": 3,
        "fullcodeline": "struct ksmbd_conn *conn = work->conn;"
    },
    {
        "line": 4,
        "fullcodeline": "struct smb2_negotiate_req *req = smb2_get_msg(work->request_buf);"
    },
    {
        "line": 5,
        "fullcodeline": "struct smb2_negotiate_rsp *rsp = smb2_get_msg(work->response_buf);"
    },
    {
        "line": 6,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "ksmbd_debug(SMB, \"Received negotiate request\\n\");"
    },
    {
        "line": 11,
        "fullcodeline": "conn->need_neg = false;"
    },
    {
        "line": 25,
        "fullcodeline": "smb2_buf_len = get_rfc1002_len(work->request_buf);"
    },
    {
        "line": 63,
        "fullcodeline": "conn->cli_cap = le32_to_cpu(req->Capabilities);"
    },
    {
        "line": 129,
        "fullcodeline": "memcpy(conn->ClientGUID, req->ClientGUID,"
    },
    {
        "line": 146,
        "fullcodeline": "rsp->SecurityBufferOffset = cpu_to_le16(128);"
    },
    {
        "line": 150,
        "fullcodeline": "inc_rfc1001_len(work->response_buf, sizeof(struct smb2_negotiate_rsp) -"
    },
    {
        "line": 153,
        "fullcodeline": "rsp->SecurityMode = SMB2_NEGOTIATE_SIGNING_ENABLED_LE;"
    },
    {
        "line": 167,
        "fullcodeline": "ksmbd_conn_set_need_negotiate(work);"
    },
    {
        "line": 12,
        "fullcodeline": "if (ksmbd_conn_good(work)) {"
    },
    {
        "line": 18,
        "fullcodeline": "if (req->DialectCount == 0) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (smb2_neg_size > smb2_buf_len) {"
    },
    {
        "line": 33,
        "fullcodeline": "if (conn->dialect == SMB311_PROT_ID) {"
    },
    {
        "line": 120,
        "fullcodeline": "rsp->Capabilities = cpu_to_le32(conn->vals->capabilities);"
    },
    {
        "line": 125,
        "fullcodeline": "rsp->MaxTransactSize = cpu_to_le32(conn->vals->max_trans_size);"
    },
    {
        "line": 126,
        "fullcodeline": "rsp->MaxReadSize = cpu_to_le32(conn->vals->max_read_size);"
    },
    {
        "line": 127,
        "fullcodeline": "rsp->MaxWriteSize = cpu_to_le32(conn->vals->max_write_size);"
    },
    {
        "line": 131,
        "fullcodeline": "conn->cli_sec_mode = le16_to_cpu(req->SecurityMode);"
    },
    {
        "line": 133,
        "fullcodeline": "rsp->StructureSize = cpu_to_le16(65);"
    },
    {
        "line": 134,
        "fullcodeline": "rsp->DialectRevision = cpu_to_le16(conn->dialect);"
    },
    {
        "line": 140,
        "fullcodeline": "rsp->SystemTime = cpu_to_le64(ksmbd_systime());"
    },
    {
        "line": 143,
        "fullcodeline": "le32_to_cpu(rsp->NegotiateContextOffset),"
    },
    {
        "line": 144,
        "fullcodeline": "le16_to_cpu(rsp->NegotiateContextCount));"
    },
    {
        "line": 147,
        "fullcodeline": "rsp->SecurityBufferLength = cpu_to_le16(AUTH_GSS_LENGTH);"
    },
    {
        "line": 166,
        "fullcodeline": "conn->srv_sec_mode = le16_to_cpu(rsp->SecurityMode);"
    },
    {
        "line": 170,
        "fullcodeline": "if (rc < 0)"
    },
    {
        "line": 13,
        "fullcodeline": "pr_err(\"conn->tcp_status is already in CifsGood State\\n\");"
    },
    {
        "line": 14,
        "fullcodeline": "work->send_no_response = 1;"
    },
    {
        "line": 21,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 29,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 34,
        "fullcodeline": "unsigned int nego_ctxt_off = le32_to_cpu(req->NegotiateContextOffset);"
    },
    {
        "line": 66,
        "fullcodeline": "conn->preauth_info ="
    },
    {
        "line": 75,
        "fullcodeline": "status = deassemble_neg_contexts(conn, req,"
    },
    {
        "line": 87,
        "fullcodeline": "rc = init_smb3_11_server(conn);"
    },
    {
        "line": 95,
        "fullcodeline": "ksmbd_gen_preauth_integrity_hash(conn,"
    },
    {
        "line": 98,
        "fullcodeline": "rsp->NegotiateContextOffset ="
    },
    {
        "line": 100,
        "fullcodeline": "assemble_neg_contexts(conn, rsp, work->response_buf);"
    },
    {
        "line": 103,
        "fullcodeline": "init_smb3_02_server(conn);"
    },
    {
        "line": 106,
        "fullcodeline": "init_smb3_0_server(conn);"
    },
    {
        "line": 109,
        "fullcodeline": "init_smb2_1_server(conn);"
    },
    {
        "line": 116,
        "fullcodeline": "rsp->hdr.Status = STATUS_NOT_SUPPORTED;"
    },
    {
        "line": 117,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 149,
        "fullcodeline": "le16_to_cpu(rsp->SecurityBufferOffset));"
    },
    {
        "line": 156,
        "fullcodeline": "if ((server_conf.signing == KSMBD_CONFIG_OPT_AUTO ||"
    },
    {
        "line": 158,
        "fullcodeline": "req->SecurityMode & SMB2_NEGOTIATE_SIGNING_REQUIRED_LE)"
    },
    {
        "line": 36,
        "fullcodeline": "if (smb2_buf_len < nego_ctxt_off) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (smb2_neg_size > nego_ctxt_off) {"
    },
    {
        "line": 67,
        "fullcodeline": "kzalloc(sizeof(struct preauth_integrity_info),"
    },
    {
        "line": 69,
        "fullcodeline": "if (!conn->preauth_info) {"
    },
    {
        "line": 77,
        "fullcodeline": "if (status != STATUS_SUCCESS) {"
    },
    {
        "line": 88,
        "fullcodeline": "if (rc < 0) {"
    },
    {
        "line": 99,
        "fullcodeline": "cpu_to_le32(OFFSET_OF_NEG_CONTEXT);"
    },
    {
        "line": 157,
        "fullcodeline": "server_conf.signing == KSMBD_CONFIG_OPT_DISABLED) &&"
    },
    {
        "line": 38,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 44,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 51,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 70,
        "fullcodeline": "rc = -ENOMEM;"
    },
    {
        "line": 76,
        "fullcodeline": "get_rfc1002_len(work->request_buf));"
    },
    {
        "line": 78,
        "fullcodeline": "pr_err(\"deassemble_neg_contexts error(0x%x)\\n\","
    },
    {
        "line": 81,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 151,
        "fullcodeline": "sizeof(struct smb2_hdr) - sizeof(rsp->Buffer) +"
    },
    {
        "line": 160,
        "fullcodeline": "else if (server_conf.signing == KSMBD_CONFIG_OPT_MANDATORY) {"
    },
    {
        "line": 48,
        "fullcodeline": "if (smb2_neg_size + le16_to_cpu(req->DialectCount) * sizeof(__le16) >"
    },
    {
        "line": 58,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 162,
        "fullcodeline": "rsp->SecurityMode |= SMB2_NEGOTIATE_SIGNING_REQUIRED_LE;"
    },
    {
        "line": 55,
        "fullcodeline": "if (smb2_neg_size + le16_to_cpu(req->DialectCount) * sizeof(__le16) >"
    }
]