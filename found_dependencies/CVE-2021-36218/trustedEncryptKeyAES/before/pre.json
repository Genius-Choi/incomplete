[
    {
        "line": 3,
        "fullcodeline": "LOG_INFO(__FUNCTION__);"
    },
    {
        "line": 5,
        "fullcodeline": "*errString = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "CHECK_STATE(key);"
    },
    {
        "line": 9,
        "fullcodeline": "CHECK_STATE(encryptedPrivateKey);"
    },
    {
        "line": 11,
        "fullcodeline": "*errStatus = UNKNOWN_ERROR;"
    },
    {
        "line": 13,
        "fullcodeline": "int status = AES_encrypt_DH((char *)key, encryptedPrivateKey, BUF_LEN);"
    },
    {
        "line": 15,
        "fullcodeline": "CHECK_STATUS2(\"AES encrypt failed with status %d\");"
    },
    {
        "line": 17,
        "fullcodeline": "*enc_len = strlen(key) + SGX_AESGCM_MAC_SIZE + SGX_AESGCM_IV_SIZE;"
    },
    {
        "line": 19,
        "fullcodeline": "SAFE_CHAR_BUF(decryptedKey, BUF_LEN);"
    },
    {
        "line": 21,
        "fullcodeline": "status = AES_decrypt_DH(encryptedPrivateKey, *enc_len, decryptedKey, BUF_LEN);"
    },
    {
        "line": 23,
        "fullcodeline": "CHECK_STATUS2(\"trustedDecryptKey failed with status %d\");"
    },
    {
        "line": 25,
        "fullcodeline": "uint64_t decryptedKeyLen = strnlen(decryptedKey, MAX_KEY_LENGTH);"
    },
    {
        "line": 33,
        "fullcodeline": "*errStatus = -8;"
    },
    {
        "line": 44,
        "fullcodeline": "LOG_INFO(__FUNCTION__ );"
    },
    {
        "line": 45,
        "fullcodeline": "LOG_INFO(\"SGX call completed\");"
    },
    {
        "line": 27,
        "fullcodeline": "if (decryptedKeyLen == MAX_KEY_LENGTH) {"
    },
    {
        "line": 35,
        "fullcodeline": "if (strncmp(key, decryptedKey, MAX_KEY_LENGTH) != 0) {"
    },
    {
        "line": 28,
        "fullcodeline": "snprintf(errString, BUF_LEN, \"Decrypted key is not null terminated\");"
    },
    {
        "line": 29,
        "fullcodeline": "LOG_ERROR(errString);"
    },
    {
        "line": 36,
        "fullcodeline": "snprintf(errString, BUF_LEN, \"Decrypted key does not match original key\");"
    },
    {
        "line": 37,
        "fullcodeline": "LOG_ERROR(errString);"
    }
]