[
    {
        "line": 5,
        "fullcodeline": "LOG_INFO(__FUNCTION__);"
    },
    {
        "line": 11,
        "fullcodeline": "CHECK_STATE(encrypted_skey);"
    },
    {
        "line": 12,
        "fullcodeline": "CHECK_STATE(result_str);"
    },
    {
        "line": 13,
        "fullcodeline": "CHECK_STATE(s_shareG2);"
    },
    {
        "line": 14,
        "fullcodeline": "CHECK_STATE(pub_keyB);"
    },
    {
        "line": 16,
        "fullcodeline": "LOG_DEBUG(__FUNCTION__);"
    },
    {
        "line": 18,
        "fullcodeline": "SAFE_CHAR_BUF(skey, ECDSA_SKEY_LEN);"
    },
    {
        "line": 20,
        "fullcodeline": "SAFE_CHAR_BUF(pub_key_x, BUF_LEN);SAFE_CHAR_BUF(pub_key_y, BUF_LEN);"
    },
    {
        "line": 22,
        "fullcodeline": "trustedGenerateEcdsaKeyAES(&status, errString, encrypted_skey, &enc_len, pub_key_x, pub_key_y);"
    },
    {
        "line": 24,
        "fullcodeline": "CHECK_STATUS(\"trustedGenerateEcdsaKeyAES failed\");"
    },
    {
        "line": 26,
        "fullcodeline": "status = AES_decrypt(encrypted_skey, enc_len, skey, ECDSA_SKEY_LEN);"
    },
    {
        "line": 28,
        "fullcodeline": "skey[ECDSA_SKEY_LEN - 1] = 0;"
    },
    {
        "line": 30,
        "fullcodeline": "CHECK_STATUS2(\"AES_decrypt failed (in trustedGetEncryptedSecretShareAES) with status %d\");"
    },
    {
        "line": 32,
        "fullcodeline": "*dec_len = enc_len;"
    },
    {
        "line": 34,
        "fullcodeline": "SAFE_CHAR_BUF(common_key, ECDSA_SKEY_LEN);"
    },
    {
        "line": 36,
        "fullcodeline": "status = gen_session_key(skey, pub_keyB, common_key);"
    },
    {
        "line": 38,
        "fullcodeline": "CHECK_STATUS(\"gen_session_key failed\")"
    },
    {
        "line": 40,
        "fullcodeline": "SAFE_CHAR_BUF(s_share, ECDSA_SKEY_LEN);"
    },
    {
        "line": 42,
        "fullcodeline": "status = calc_secret_share(getThreadLocalDecryptedDkgPoly(), s_share, _t, _n, ind);"
    },
    {
        "line": 43,
        "fullcodeline": "CHECK_STATUS(\"calc secret share failed\")"
    },
    {
        "line": 46,
        "fullcodeline": "status = calc_secret_shareG2(s_share, s_shareG2);"
    },
    {
        "line": 47,
        "fullcodeline": "CHECK_STATUS(\"invalid decr secret share\");"
    },
    {
        "line": 49,
        "fullcodeline": "SAFE_CHAR_BUF(cypher, ECDSA_SKEY_LEN);"
    },
    {
        "line": 50,
        "fullcodeline": "status=xor_encrypt(common_key, s_share, cypher);"
    },
    {
        "line": 52,
        "fullcodeline": "CHECK_STATUS(\"xor_encrypt failed\")"
    },
    {
        "line": 54,
        "fullcodeline": "strncpy(result_str, cypher, strlen(cypher));"
    },
    {
        "line": 55,
        "fullcodeline": "strncpy(result_str + strlen(cypher), pub_key_x, strlen(pub_key_x));"
    },
    {
        "line": 56,
        "fullcodeline": "strncpy(result_str + strlen(pub_key_x) + strlen(pub_key_y), pub_key_y, strlen(pub_key_y));"
    },
    {
        "line": 62,
        "fullcodeline": "LOG_INFO(__FUNCTION__ );"
    },
    {
        "line": 63,
        "fullcodeline": "LOG_INFO(\"SGX call completed\");"
    }
]