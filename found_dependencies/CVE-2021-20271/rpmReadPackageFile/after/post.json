[
    {
        "line": 3,
        "fullcodeline": "char *msg = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "Header h = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "Header sigh = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "hdrblob blob = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "hdrblob sigblob = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "rpmVSFlags vsflags = rpmtsVSFlags(ts) | RPMVSF_NEEDPAYLOAD;"
    },
    {
        "line": 9,
        "fullcodeline": "rpmKeyring keyring = rpmtsGetKeyring(ts, 1);"
    },
    {
        "line": 10,
        "fullcodeline": "struct rpmvs_s *vs = rpmvsCreate(0, vsflags, keyring);"
    },
    {
        "line": 11,
        "fullcodeline": "struct pkgdata_s pkgdata = {"
    },
    {
        "line": 22,
        "fullcodeline": "rpmRC rc = rpmpkgRead(vs, fd, &sigblob, &blob, &msg);"
    },
    {
        "line": 27,
        "fullcodeline": "rc = RPMRC_FAIL;"
    },
    {
        "line": 54,
        "fullcodeline": "hdrblobFree(sigblob);"
    },
    {
        "line": 55,
        "fullcodeline": "hdrblobFree(blob);"
    },
    {
        "line": 56,
        "fullcodeline": "headerFree(sigh);"
    },
    {
        "line": 57,
        "fullcodeline": "headerFree(h);"
    },
    {
        "line": 58,
        "fullcodeline": "rpmKeyringFree(keyring);"
    },
    {
        "line": 59,
        "fullcodeline": "rpmvsFree(vs);"
    },
    {
        "line": 60,
        "fullcodeline": "free(msg);"
    },
    {
        "line": 28,
        "fullcodeline": "if (!rpmvsVerify(vs, RPMSIG_VERIFIABLE_TYPE, handleHdrVS, &pkgdata)) {"
    },
    {
        "line": 48,
        "fullcodeline": "if (rc == RPMRC_OK && pkgdata.rc)"
    },
    {
        "line": 52,
        "fullcodeline": "if (rc && msg)"
    },
    {
        "line": 20,
        "fullcodeline": "*hdrp = NULL;"
    },
    {
        "line": 44,
        "fullcodeline": "rc = RPMRC_OK;"
    },
    {
        "line": 49,
        "fullcodeline": "rc = pkgdata.rc;"
    },
    {
        "line": 53,
        "fullcodeline": "rpmlog(RPMLOG_ERR, \"%s: %s\\n\", Fdescr(fd), msg);"
    },
    {
        "line": 12,
        "fullcodeline": ".msgfunc = loghdrmsg,"
    },
    {
        "line": 13,
        "fullcodeline": ".fn = fn ? fn : Fdescr(fd),"
    },
    {
        "line": 14,
        "fullcodeline": ".msg = NULL,"
    },
    {
        "line": 15,
        "fullcodeline": ".rc = RPMRC_OK,"
    },
    {
        "line": 39,
        "fullcodeline": "applyRetrofits(h);"
    },
    {
        "line": 42,
        "fullcodeline": "*hdrp = headerLink(h);"
    },
    {
        "line": 31,
        "fullcodeline": "if (hdrblobImport(sigblob, 0, &sigh, &msg))"
    },
    {
        "line": 33,
        "fullcodeline": "if (hdrblobImport(blob, 0, &h, &msg))"
    },
    {
        "line": 37,
        "fullcodeline": "if (headerMergeLegacySigs(h, sigh, &msg))"
    }
]