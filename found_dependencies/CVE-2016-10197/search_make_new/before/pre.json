[
    {
        "line": 2,
        "fullcodeline": "const size_t base_len = strlen(base_name);"
    },
    {
        "line": 3,
        "fullcodeline": "const char need_to_append_dot = base_name[base_len - 1] == '.' ? 0 : 1;"
    },
    {
        "line": 6,
        "fullcodeline": "for (dom = state->head; dom; dom = dom->next) {"
    },
    {
        "line": 7,
        "fullcodeline": "if (!n--) {"
    },
    {
        "line": 10,
        "fullcodeline": "const u8 *const postfix = ((u8 *) dom) + sizeof(struct search_domain);"
    },
    {
        "line": 11,
        "fullcodeline": "const int postfix_len = dom->len;"
    },
    {
        "line": 12,
        "fullcodeline": "char *const newname = (char *) mm_malloc(base_len + need_to_append_dot + postfix_len + 1);"
    },
    {
        "line": 14,
        "fullcodeline": "memcpy(newname, base_name, base_len);"
    },
    {
        "line": 16,
        "fullcodeline": "memcpy(newname + base_len + need_to_append_dot, postfix, postfix_len);"
    },
    {
        "line": 17,
        "fullcodeline": "newname[base_len + need_to_append_dot + postfix_len] = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "if (!newname) return NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "if (need_to_append_dot) newname[base_len] = '.';"
    }
]