[
    {
        "line": 7,
        "fullcodeline": "char serviceid[REND_SERVICE_ID_LEN_BASE32+1];"
    },
    {
        "line": 8,
        "fullcodeline": "(void) request;"
    },
    {
        "line": 9,
        "fullcodeline": "(void) request_len;"
    },
    {
        "line": 10,
        "fullcodeline": "tor_assert(circuit->rend_data);"
    },
    {
        "line": 12,
        "fullcodeline": "const char *rend_pk_digest ="
    },
    {
        "line": 20,
        "fullcodeline": "service = rend_service_get_by_pk_digest(rend_pk_digest);"
    },
    {
        "line": 28,
        "fullcodeline": "intro = find_intro_point(circuit);"
    },
    {
        "line": 36,
        "fullcodeline": "intro->circuit_established = 1;"
    },
    {
        "line": 39,
        "fullcodeline": "service->desc_is_dirty = time(NULL);"
    },
    {
        "line": 40,
        "fullcodeline": "circuit_change_purpose(TO_CIRCUIT(circuit), CIRCUIT_PURPOSE_S_INTRO);"
    },
    {
        "line": 42,
        "fullcodeline": "base32_encode(serviceid, REND_SERVICE_ID_LEN_BASE32 + 1,"
    },
    {
        "line": 44,
        "fullcodeline": "log_info(LD_REND,"
    },
    {
        "line": 50,
        "fullcodeline": "pathbias_mark_use_success(circuit);"
    },
    {
        "line": 54,
        "fullcodeline": "circuit_mark_for_close(TO_CIRCUIT(circuit), END_CIRC_REASON_TORPROTOCOL);"
    },
    {
        "line": 13,
        "fullcodeline": "(char *) rend_data_get_pk_digest(circuit->rend_data, NULL);"
    },
    {
        "line": 15,
        "fullcodeline": "if (circuit->base_.purpose != CIRCUIT_PURPOSE_S_ESTABLISH_INTRO) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (!service) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (intro == NULL) {"
    },
    {
        "line": 55,
        "fullcodeline": "return -1;"
    },
    {
        "line": 16,
        "fullcodeline": "log_warn(LD_PROTOCOL,"
    },
    {
        "line": 33,
        "fullcodeline": "safe_str_client(serviceid), (unsigned)circuit->base_.n_circ_id);"
    }
]