[
    {
        "line": 8,
        "fullcodeline": "skb = nci_skb_alloc(nspi->ndev, 0, GFP_KERNEL);"
    },
    {
        "line": 14,
        "fullcodeline": "hdr[0] = NCI_SPI_DIRECT_WRITE;"
    },
    {
        "line": 15,
        "fullcodeline": "hdr[1] = NCI_SPI_CRC_ENABLED;"
    },
    {
        "line": 19,
        "fullcodeline": "crc = crc_ccitt(CRC_INIT, skb->data, skb->len);"
    },
    {
        "line": 20,
        "fullcodeline": "skb_put_u8(skb, crc >> 8);"
    },
    {
        "line": 21,
        "fullcodeline": "skb_put_u8(skb, crc & 0xFF);"
    },
    {
        "line": 23,
        "fullcodeline": "ret = __nci_spi_send(nspi, skb, 0);"
    },
    {
        "line": 9,
        "fullcodeline": "if (!skb)"
    },
    {
        "line": 13,
        "fullcodeline": "hdr = skb_push(skb, NCI_SPI_HDR_LEN);"
    },
    {
        "line": 16,
        "fullcodeline": "hdr[2] = acknowledge << NCI_SPI_ACK_SHIFT;"
    },
    {
        "line": 10,
        "fullcodeline": "return -ENOMEM;"
    }
]