[
    {
        "line": 8,
        "fullcodeline": "skb = nci_skb_alloc(nspi->ndev, 0, GFP_KERNEL);"
    },
    {
        "line": 11,
        "fullcodeline": "hdr = skb_push(skb, NCI_SPI_HDR_LEN);"
    },
    {
        "line": 12,
        "fullcodeline": "hdr[0] = NCI_SPI_DIRECT_WRITE;"
    },
    {
        "line": 13,
        "fullcodeline": "hdr[1] = NCI_SPI_CRC_ENABLED;"
    },
    {
        "line": 14,
        "fullcodeline": "hdr[2] = acknowledge << NCI_SPI_ACK_SHIFT;"
    },
    {
        "line": 15,
        "fullcodeline": "hdr[3] = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "crc = crc_ccitt(CRC_INIT, skb->data, skb->len);"
    },
    {
        "line": 18,
        "fullcodeline": "skb_put_u8(skb, crc >> 8);"
    },
    {
        "line": 19,
        "fullcodeline": "skb_put_u8(skb, crc & 0xFF);"
    },
    {
        "line": 21,
        "fullcodeline": "ret = __nci_spi_send(nspi, skb, 0);"
    },
    {
        "line": 23,
        "fullcodeline": "kfree_skb(skb);"
    }
]