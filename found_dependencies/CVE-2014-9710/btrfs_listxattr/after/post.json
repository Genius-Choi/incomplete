[
    {
        "line": 4,
        "fullcodeline": "struct inode *inode = dentry->d_inode;"
    },
    {
        "line": 9,
        "fullcodeline": "int ret = 0, slot;"
    },
    {
        "line": 10,
        "fullcodeline": "size_t total_size = 0, size_left = size;"
    },
    {
        "line": 19,
        "fullcodeline": "key.objectid = btrfs_ino(inode);"
    },
    {
        "line": 20,
        "fullcodeline": "key.type = BTRFS_XATTR_ITEM_KEY;"
    },
    {
        "line": 21,
        "fullcodeline": "key.offset = 0;"
    },
    {
        "line": 23,
        "fullcodeline": "path = btrfs_alloc_path();"
    },
    {
        "line": 26,
        "fullcodeline": "path->reada = 2;"
    },
    {
        "line": 29,
        "fullcodeline": "ret = btrfs_search_slot(NULL, root, &key, path, 0, 0);"
    },
    {
        "line": 84,
        "fullcodeline": "ret = total_size;"
    },
    {
        "line": 87,
        "fullcodeline": "btrfs_free_path(path);"
    },
    {
        "line": 24,
        "fullcodeline": "if (!path)"
    },
    {
        "line": 30,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 5,
        "fullcodeline": "struct btrfs_root *root = BTRFS_I(inode)->root;"
    },
    {
        "line": 35,
        "fullcodeline": "slot = path->slots[0];"
    },
    {
        "line": 51,
        "fullcodeline": "btrfs_item_key_to_cpu(leaf, &found_key, slot);"
    },
    {
        "line": 63,
        "fullcodeline": "name_len = btrfs_dir_name_len(leaf, di);"
    },
    {
        "line": 64,
        "fullcodeline": "total_size += name_len + 1;"
    },
    {
        "line": 75,
        "fullcodeline": "name_ptr = (unsigned long)(di + 1);"
    },
    {
        "line": 76,
        "fullcodeline": "read_extent_buffer(leaf, buffer, name_ptr, name_len);"
    },
    {
        "line": 77,
        "fullcodeline": "buffer[name_len] = '\\0';"
    },
    {
        "line": 79,
        "fullcodeline": "size_left -= name_len + 1;"
    },
    {
        "line": 80,
        "fullcodeline": "buffer += name_len + 1;"
    },
    {
        "line": 25,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 38,
        "fullcodeline": "if (slot >= btrfs_header_nritems(leaf)) {"
    },
    {
        "line": 54,
        "fullcodeline": "if (found_key.objectid != key.objectid)"
    },
    {
        "line": 56,
        "fullcodeline": "if (found_key.type != BTRFS_XATTR_ITEM_KEY)"
    },
    {
        "line": 60,
        "fullcodeline": "if (verify_dir_item(root, leaf, di))"
    },
    {
        "line": 67,
        "fullcodeline": "if (!size)"
    },
    {
        "line": 70,
        "fullcodeline": "if (!buffer || (name_len + 1) > size_left) {"
    },
    {
        "line": 43,
        "fullcodeline": "ret = btrfs_next_leaf(root, path);"
    },
    {
        "line": 71,
        "fullcodeline": "ret = -ERANGE;"
    },
    {
        "line": 44,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 46,
        "fullcodeline": "else if (ret > 0)"
    }
]