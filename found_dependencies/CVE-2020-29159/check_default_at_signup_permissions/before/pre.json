[
    {
        "line": 2,
        "fullcodeline": "all_permissions = Permission.all.pluck(:id)"
    },
    {
        "line": 3,
        "fullcodeline": "admin_permissions = Permission.where('name LIKE ? OR name = ?', 'admin%', 'ticket.agent').pluck(:id) # admin.*/ticket.agent permissions"
    },
    {
        "line": 4,
        "fullcodeline": "normal_permissions = (all_permissions - admin_permissions) | (admin_permissions - all_permissions) # all other permissions besides admin.*/ticket.agent"
    },
    {
        "line": 5,
        "fullcodeline": "return true if default_at_signup != true # means if default_at_signup = false, no need further checks"
    },
    {
        "line": 6,
        "fullcodeline": "return true if self.permission_ids.all? { |i| normal_permissions.include? i } # allow user to choose only normal permissions"
    }
]