[
    {
        "line": 2,
        "fullcodeline": "user = flask.request.form[\"username\"]"
    },
    {
        "line": 3,
        "fullcodeline": "password = flask.request.form[\"password\"]"
    },
    {
        "line": 5,
        "fullcodeline": "api = flask.current_app.config[\"PYLOAD_API\"]"
    },
    {
        "line": 6,
        "fullcodeline": "user_info = api.check_auth(user, password)"
    },
    {
        "line": 8,
        "fullcodeline": "sanitized_user = user.replace(\"\\n\", \"\\\\n\").replace(\"\\r\", \"\\\\r\")"
    },
    {
        "line": 13,
        "fullcodeline": "s = set_session(user_info)"
    },
    {
        "line": 9,
        "fullcodeline": "if not user_info:"
    },
    {
        "line": 14,
        "fullcodeline": "log.info(f\"User '{sanitized_user}' successfully logged in\")"
    },
    {
        "line": 17,
        "fullcodeline": "return jsonify(s)"
    },
    {
        "line": 10,
        "fullcodeline": "log.error(f\"Login failed for user '{sanitized_user}'\")"
    },
    {
        "line": 11,
        "fullcodeline": "return jsonify(False)"
    }
]