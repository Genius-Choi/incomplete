[
    {
        "line": 3,
        "fullcodeline": "X509 * cert = CHECK_OBJECT(1, X509, \"openssl.x509\");"
    },
    {
        "line": 5,
        "fullcodeline": "const char* hostname = luaL_checklstring(L, 2, &sz);"
    },
    {
        "line": 6,
        "fullcodeline": "int flags = luaL_optint(L, 3, 0);"
    },
    {
        "line": 7,
        "fullcodeline": "char *peer = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "int ret = X509_check_host(cert, hostname, sz, flags, &peer);"
    },
    {
        "line": 10,
        "fullcodeline": "ret = openssl_push_check_result(L, ret, peer);"
    },
    {
        "line": 11,
        "fullcodeline": "OPENSSL_free(peer);"
    }
]