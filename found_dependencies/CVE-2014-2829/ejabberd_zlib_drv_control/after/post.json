[
    {
        "line": 6,
        "fullcodeline": "ejabberd_zlib_data *d = (ejabberd_zlib_data *)handle;"
    },
    {
        "line": 13,
        "fullcodeline": "size_limit = command >> 2; // applies only to inflation"
    },
    {
        "line": 14,
        "fullcodeline": "command = command & 3;"
    },
    {
        "line": 78,
        "fullcodeline": "b = driver_alloc_binary(1);"
    },
    {
        "line": 79,
        "fullcodeline": "b->orig_bytes[0] = 0;"
    },
    {
        "line": 80,
        "fullcodeline": "*rbuf = (char *)b;"
    },
    {
        "line": 18,
        "fullcodeline": "size = BUF_SIZE + 1;"
    },
    {
        "line": 19,
        "fullcodeline": "rlen = 1;"
    },
    {
        "line": 20,
        "fullcodeline": "b = driver_alloc_binary(size);"
    },
    {
        "line": 21,
        "fullcodeline": "b->orig_bytes[0] = 0;"
    },
    {
        "line": 23,
        "fullcodeline": "d->d_stream->next_in = (unsigned char *)buf;"
    },
    {
        "line": 24,
        "fullcodeline": "d->d_stream->avail_in = len;"
    },
    {
        "line": 25,
        "fullcodeline": "d->d_stream->avail_out = 0;"
    },
    {
        "line": 26,
        "fullcodeline": "err = Z_OK;"
    },
    {
        "line": 41,
        "fullcodeline": "b = driver_realloc_binary(b, rlen);"
    },
    {
        "line": 42,
        "fullcodeline": "*rbuf = (char *)b;"
    },
    {
        "line": 45,
        "fullcodeline": "size = BUF_SIZE + 1;"
    },
    {
        "line": 46,
        "fullcodeline": "rlen = 1;"
    },
    {
        "line": 47,
        "fullcodeline": "b = driver_alloc_binary(size);"
    },
    {
        "line": 48,
        "fullcodeline": "b->orig_bytes[0] = 0;"
    },
    {
        "line": 73,
        "fullcodeline": "b = driver_realloc_binary(b, rlen);"
    },
    {
        "line": 74,
        "fullcodeline": "*rbuf = (char *)b;"
    },
    {
        "line": 28,
        "fullcodeline": "while (err == Z_OK && d->d_stream->avail_out == 0)"
    },
    {
        "line": 50,
        "fullcodeline": "if (len > 0) {"
    },
    {
        "line": 30,
        "fullcodeline": "d->d_stream->next_out = (unsigned char *)b->orig_bytes + rlen;"
    },
    {
        "line": 31,
        "fullcodeline": "d->d_stream->avail_out = BUF_SIZE;"
    },
    {
        "line": 33,
        "fullcodeline": "err = deflate(d->d_stream, Z_SYNC_FLUSH);"
    },
    {
        "line": 34,
        "fullcodeline": "die_unless((err == Z_OK) || (err == Z_STREAM_END),"
    },
    {
        "line": 37,
        "fullcodeline": "rlen += (BUF_SIZE - d->d_stream->avail_out);"
    },
    {
        "line": 38,
        "fullcodeline": "size += (BUF_SIZE - d->d_stream->avail_out);"
    },
    {
        "line": 39,
        "fullcodeline": "b = driver_realloc_binary(b, size);"
    },
    {
        "line": 51,
        "fullcodeline": "d->i_stream->next_in = (unsigned char *)buf;"
    },
    {
        "line": 52,
        "fullcodeline": "d->i_stream->avail_in = len;"
    },
    {
        "line": 53,
        "fullcodeline": "d->i_stream->avail_out = 0;"
    },
    {
        "line": 54,
        "fullcodeline": "err = Z_OK;"
    },
    {
        "line": 56,
        "fullcodeline": "while (err == Z_OK && d->i_stream->avail_out == 0)"
    },
    {
        "line": 58,
        "fullcodeline": "d->i_stream->next_out = (unsigned char *)b->orig_bytes + rlen;"
    },
    {
        "line": 59,
        "fullcodeline": "d->i_stream->avail_out = BUF_SIZE;"
    },
    {
        "line": 61,
        "fullcodeline": "err = inflate(d->i_stream, Z_SYNC_FLUSH);"
    },
    {
        "line": 62,
        "fullcodeline": "die_unless((err == Z_OK) || (err == Z_STREAM_END),"
    },
    {
        "line": 65,
        "fullcodeline": "rlen += (BUF_SIZE - d->i_stream->avail_out);"
    },
    {
        "line": 66,
        "fullcodeline": "die_unless((rlen < size_limit) || (size_limit == 0),"
    },
    {
        "line": 69,
        "fullcodeline": "size += (BUF_SIZE - d->i_stream->avail_out);"
    },
    {
        "line": 70,
        "fullcodeline": "b = driver_realloc_binary(b, size);"
    }
]