[
    {
        "line": 6,
        "fullcodeline": "ejabberd_zlib_data *d = (ejabberd_zlib_data *)handle;"
    },
    {
        "line": 71,
        "fullcodeline": "b = driver_alloc_binary(1);"
    },
    {
        "line": 14,
        "fullcodeline": "size = BUF_SIZE + 1;"
    },
    {
        "line": 15,
        "fullcodeline": "rlen = 1;"
    },
    {
        "line": 16,
        "fullcodeline": "b = driver_alloc_binary(size);"
    },
    {
        "line": 17,
        "fullcodeline": "b->orig_bytes[0] = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "d->d_stream->next_in = (unsigned char *)buf;"
    },
    {
        "line": 20,
        "fullcodeline": "d->d_stream->avail_in = len;"
    },
    {
        "line": 21,
        "fullcodeline": "d->d_stream->avail_out = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "err = Z_OK;"
    },
    {
        "line": 37,
        "fullcodeline": "b = driver_realloc_binary(b, rlen);"
    },
    {
        "line": 38,
        "fullcodeline": "*rbuf = (char *)b;"
    },
    {
        "line": 41,
        "fullcodeline": "size = BUF_SIZE + 1;"
    },
    {
        "line": 42,
        "fullcodeline": "rlen = 1;"
    },
    {
        "line": 43,
        "fullcodeline": "b = driver_alloc_binary(size);"
    },
    {
        "line": 44,
        "fullcodeline": "b->orig_bytes[0] = 0;"
    },
    {
        "line": 66,
        "fullcodeline": "b = driver_realloc_binary(b, rlen);"
    },
    {
        "line": 24,
        "fullcodeline": "while (err == Z_OK && d->d_stream->avail_out == 0)"
    },
    {
        "line": 46,
        "fullcodeline": "if (len > 0) {"
    },
    {
        "line": 26,
        "fullcodeline": "d->d_stream->next_out = (unsigned char *)b->orig_bytes + rlen;"
    },
    {
        "line": 27,
        "fullcodeline": "d->d_stream->avail_out = BUF_SIZE;"
    },
    {
        "line": 29,
        "fullcodeline": "err = deflate(d->d_stream, Z_SYNC_FLUSH);"
    },
    {
        "line": 30,
        "fullcodeline": "die_unless((err == Z_OK) || (err == Z_STREAM_END),"
    },
    {
        "line": 33,
        "fullcodeline": "rlen += (BUF_SIZE - d->d_stream->avail_out);"
    },
    {
        "line": 34,
        "fullcodeline": "size += (BUF_SIZE - d->d_stream->avail_out);"
    },
    {
        "line": 35,
        "fullcodeline": "b = driver_realloc_binary(b, size);"
    },
    {
        "line": 47,
        "fullcodeline": "d->i_stream->next_in = (unsigned char *)buf;"
    },
    {
        "line": 48,
        "fullcodeline": "d->i_stream->avail_in = len;"
    },
    {
        "line": 49,
        "fullcodeline": "d->i_stream->avail_out = 0;"
    },
    {
        "line": 50,
        "fullcodeline": "err = Z_OK;"
    },
    {
        "line": 52,
        "fullcodeline": "while (err == Z_OK && d->i_stream->avail_out == 0)"
    },
    {
        "line": 54,
        "fullcodeline": "d->i_stream->next_out = (unsigned char *)b->orig_bytes + rlen;"
    },
    {
        "line": 55,
        "fullcodeline": "d->i_stream->avail_out = BUF_SIZE;"
    },
    {
        "line": 57,
        "fullcodeline": "err = inflate(d->i_stream, Z_SYNC_FLUSH);"
    },
    {
        "line": 61,
        "fullcodeline": "rlen += (BUF_SIZE - d->i_stream->avail_out);"
    },
    {
        "line": 62,
        "fullcodeline": "size += (BUF_SIZE - d->i_stream->avail_out);"
    },
    {
        "line": 63,
        "fullcodeline": "b = driver_realloc_binary(b, size);"
    },
    {
        "line": 58,
        "fullcodeline": "die_unless((err == Z_OK) || (err == Z_STREAM_END),"
    }
]