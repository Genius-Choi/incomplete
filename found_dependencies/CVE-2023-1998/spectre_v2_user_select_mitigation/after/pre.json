[
    {
        "line": 3,
        "fullcodeline": "enum spectre_v2_user_mitigation mode = SPECTRE_V2_USER_NONE;"
    },
    {
        "line": 4,
        "fullcodeline": "bool smt_possible = IS_ENABLED(CONFIG_SMP);"
    },
    {
        "line": 94,
        "fullcodeline": "spectre_v2_user_stibp = mode;"
    },
    {
        "line": 7,
        "fullcodeline": "if (!boot_cpu_has(X86_FEATURE_IBPB) && !boot_cpu_has(X86_FEATURE_STIBP))"
    },
    {
        "line": 10,
        "fullcodeline": "if (cpu_smt_control == CPU_SMT_FORCE_DISABLED ||"
    },
    {
        "line": 11,
        "fullcodeline": "cpu_smt_control == CPU_SMT_NOT_SUPPORTED)"
    },
    {
        "line": 12,
        "fullcodeline": "smt_possible = false;"
    },
    {
        "line": 19,
        "fullcodeline": "mode = SPECTRE_V2_USER_STRICT;"
    },
    {
        "line": 24,
        "fullcodeline": "mode = SPECTRE_V2_USER_PRCTL;"
    },
    {
        "line": 37,
        "fullcodeline": "setup_force_cpu_cap(X86_FEATURE_USE_IBPB);"
    },
    {
        "line": 72,
        "fullcodeline": "if (!boot_cpu_has(X86_FEATURE_STIBP) ||"
    },
    {
        "line": 74,
        "fullcodeline": "spectre_v2_in_eibrs_mode(spectre_v2_enabled))"
    },
    {
        "line": 82,
        "fullcodeline": "if (mode != SPECTRE_V2_USER_STRICT &&"
    },
    {
        "line": 83,
        "fullcodeline": "boot_cpu_has(X86_FEATURE_AMD_STIBP_ALWAYS_ON))"
    },
    {
        "line": 84,
        "fullcodeline": "mode = SPECTRE_V2_USER_STRICT_PREFERRED;"
    },
    {
        "line": 86,
        "fullcodeline": "if (retbleed_mitigation == RETBLEED_MITIGATION_UNRET ||"
    },
    {
        "line": 87,
        "fullcodeline": "retbleed_mitigation == RETBLEED_MITIGATION_IBPB) {"
    },
    {
        "line": 91,
        "fullcodeline": "mode = SPECTRE_V2_USER_STRICT_PREFERRED;"
    },
    {
        "line": 28,
        "fullcodeline": "if (IS_ENABLED(CONFIG_SECCOMP))"
    },
    {
        "line": 73,
        "fullcodeline": "!smt_possible ||"
    },
    {
        "line": 29,
        "fullcodeline": "mode = SPECTRE_V2_USER_SECCOMP;"
    },
    {
        "line": 44,
        "fullcodeline": "static_branch_enable(&switch_mm_always_ibpb);"
    },
    {
        "line": 88,
        "fullcodeline": "if (mode != SPECTRE_V2_USER_STRICT &&"
    },
    {
        "line": 89,
        "fullcodeline": "mode != SPECTRE_V2_USER_STRICT_PREFERRED)"
    },
    {
        "line": 31,
        "fullcodeline": "mode = SPECTRE_V2_USER_PRCTL;"
    }
]