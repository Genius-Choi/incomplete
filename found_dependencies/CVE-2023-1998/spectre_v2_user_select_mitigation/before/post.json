[
    {
        "line": 3,
        "fullcodeline": "enum spectre_v2_user_mitigation mode = SPECTRE_V2_USER_NONE;"
    },
    {
        "line": 4,
        "fullcodeline": "bool smt_possible = IS_ENABLED(CONFIG_SMP);"
    },
    {
        "line": 14,
        "fullcodeline": "cmd = spectre_v2_parse_user_cmdline();"
    },
    {
        "line": 87,
        "fullcodeline": "spectre_v2_user_stibp = mode;"
    },
    {
        "line": 90,
        "fullcodeline": "pr_info(\"%s\\n\", spectre_v2_user_strings[mode]);"
    },
    {
        "line": 7,
        "fullcodeline": "if (!boot_cpu_has(X86_FEATURE_IBPB) && !boot_cpu_has(X86_FEATURE_STIBP))"
    },
    {
        "line": 10,
        "fullcodeline": "if (cpu_smt_control == CPU_SMT_FORCE_DISABLED ||"
    },
    {
        "line": 36,
        "fullcodeline": "if (boot_cpu_has(X86_FEATURE_IBPB)) {"
    },
    {
        "line": 65,
        "fullcodeline": "if (!boot_cpu_has(X86_FEATURE_STIBP) ||"
    },
    {
        "line": 75,
        "fullcodeline": "if (mode != SPECTRE_V2_USER_STRICT &&"
    },
    {
        "line": 79,
        "fullcodeline": "if (retbleed_mitigation == RETBLEED_MITIGATION_UNRET ||"
    },
    {
        "line": 11,
        "fullcodeline": "cpu_smt_control == CPU_SMT_NOT_SUPPORTED)"
    },
    {
        "line": 12,
        "fullcodeline": "smt_possible = false;"
    },
    {
        "line": 19,
        "fullcodeline": "mode = SPECTRE_V2_USER_STRICT;"
    },
    {
        "line": 24,
        "fullcodeline": "mode = SPECTRE_V2_USER_PRCTL;"
    },
    {
        "line": 37,
        "fullcodeline": "setup_force_cpu_cap(X86_FEATURE_USE_IBPB);"
    },
    {
        "line": 39,
        "fullcodeline": "spectre_v2_user_ibpb = mode;"
    },
    {
        "line": 56,
        "fullcodeline": "pr_info(\"mitigation: Enabling %s Indirect Branch Prediction Barrier\\n\","
    },
    {
        "line": 67,
        "fullcodeline": "spectre_v2_in_ibrs_mode(spectre_v2_enabled))"
    },
    {
        "line": 76,
        "fullcodeline": "boot_cpu_has(X86_FEATURE_AMD_STIBP_ALWAYS_ON))"
    },
    {
        "line": 77,
        "fullcodeline": "mode = SPECTRE_V2_USER_STRICT_PREFERRED;"
    },
    {
        "line": 80,
        "fullcodeline": "retbleed_mitigation == RETBLEED_MITIGATION_IBPB) {"
    },
    {
        "line": 84,
        "fullcodeline": "mode = SPECTRE_V2_USER_STRICT_PREFERRED;"
    },
    {
        "line": 28,
        "fullcodeline": "if (IS_ENABLED(CONFIG_SECCOMP))"
    },
    {
        "line": 57,
        "fullcodeline": "static_key_enabled(&switch_mm_always_ibpb) ?"
    },
    {
        "line": 66,
        "fullcodeline": "!smt_possible ||"
    },
    {
        "line": 81,
        "fullcodeline": "if (mode != SPECTRE_V2_USER_STRICT &&"
    },
    {
        "line": 29,
        "fullcodeline": "mode = SPECTRE_V2_USER_SECCOMP;"
    },
    {
        "line": 44,
        "fullcodeline": "static_branch_enable(&switch_mm_always_ibpb);"
    },
    {
        "line": 45,
        "fullcodeline": "spectre_v2_user_ibpb = SPECTRE_V2_USER_STRICT;"
    },
    {
        "line": 50,
        "fullcodeline": "static_branch_enable(&switch_mm_cond_ibpb);"
    },
    {
        "line": 82,
        "fullcodeline": "mode != SPECTRE_V2_USER_STRICT_PREFERRED)"
    },
    {
        "line": 83,
        "fullcodeline": "pr_info(\"Selecting STIBP always-on mode to complement retbleed mitigation\\n\");"
    },
    {
        "line": 31,
        "fullcodeline": "mode = SPECTRE_V2_USER_PRCTL;"
    }
]