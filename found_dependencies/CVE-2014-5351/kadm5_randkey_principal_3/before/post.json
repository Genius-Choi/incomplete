[
    {
        "line": 13,
        "fullcodeline": "krb5_boolean                have_pol = FALSE;"
    },
    {
        "line": 14,
        "fullcodeline": "kadm5_server_handle_t       handle = server_handle;"
    },
    {
        "line": 17,
        "fullcodeline": "int                         new_n_ks_tuple = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "krb5_key_salt_tuple         *new_ks_tuple = NULL;"
    },
    {
        "line": 23,
        "fullcodeline": "CHECK_HANDLE(server_handle);"
    },
    {
        "line": 25,
        "fullcodeline": "krb5_clear_error_message(handle->context);"
    },
    {
        "line": 33,
        "fullcodeline": "ret = apply_keysalt_policy(handle, adb.policy, n_ks_tuple, ks_tuple,"
    },
    {
        "line": 46,
        "fullcodeline": "ret = kdb_get_active_mkey(handle, &act_kvno, &act_mkey);"
    },
    {
        "line": 50,
        "fullcodeline": "ret = krb5_dbe_crk(handle->context, act_mkey, new_ks_tuple, new_n_ks_tuple,"
    },
    {
        "line": 55,
        "fullcodeline": "ret = krb5_dbe_update_mkvno(handle->context, kdb, act_kvno);"
    },
    {
        "line": 59,
        "fullcodeline": "kdb->attributes &= ~KRB5_KDB_REQUIRES_PWCHANGE;"
    },
    {
        "line": 61,
        "fullcodeline": "ret = krb5_timeofday(handle->context, &now);"
    },
    {
        "line": 97,
        "fullcodeline": "ret = krb5_dbe_update_last_pwd_change(handle->context, kdb, now);"
    },
    {
        "line": 102,
        "fullcodeline": "kdb->fail_auth_count = 0;"
    },
    {
        "line": 113,
        "fullcodeline": "kdb->mask = KADM5_KEY_DATA | KADM5_FAIL_AUTH_COUNT;"
    },
    {
        "line": 116,
        "fullcodeline": "ret = k5_kadm5_hook_chpass(handle->context, handle->hook_handles,"
    },
    {
        "line": 124,
        "fullcodeline": "(void) k5_kadm5_hook_chpass(handle->context, handle->hook_handles,"
    },
    {
        "line": 127,
        "fullcodeline": "ret = KADM5_OK;"
    },
    {
        "line": 129,
        "fullcodeline": "free(new_ks_tuple);"
    },
    {
        "line": 130,
        "fullcodeline": "kdb_free_entry(handle, kdb, &adb);"
    },
    {
        "line": 27,
        "fullcodeline": "if (principal == NULL)"
    },
    {
        "line": 30,
        "fullcodeline": "if ((ret = kdb_get_entry(handle, principal, &kdb, &adb)))"
    },
    {
        "line": 38,
        "fullcodeline": "if (krb5_principal_compare(handle->context, principal, hist_princ)) {"
    },
    {
        "line": 65,
        "fullcodeline": "if ((adb.aux_attributes & KADM5_POLICY)) {"
    },
    {
        "line": 121,
        "fullcodeline": "if ((ret = kdb_put_entry(handle, kdb, &adb)))"
    },
    {
        "line": 21,
        "fullcodeline": "*keyblocks = NULL;"
    },
    {
        "line": 43,
        "fullcodeline": "new_n_ks_tuple = 1;"
    },
    {
        "line": 66,
        "fullcodeline": "ret = get_policy(handle, adb.policy, &pol, &have_pol);"
    },
    {
        "line": 71,
        "fullcodeline": "ret = krb5_dbe_lookup_last_pwd_change(handle->context, kdb, &last_pwd);"
    },
    {
        "line": 105,
        "fullcodeline": "ret = decrypt_key_data(handle->context,"
    },
    {
        "line": 132,
        "fullcodeline": "kadm5_free_policy_ent(handle->lhandle, &pol);"
    },
    {
        "line": 94,
        "fullcodeline": "kdb->pw_expiration = 0;"
    },
    {
        "line": 90,
        "fullcodeline": "kdb->pw_expiration = now + pol.pw_max_life;"
    },
    {
        "line": 92,
        "fullcodeline": "kdb->pw_expiration = 0;"
    }
]