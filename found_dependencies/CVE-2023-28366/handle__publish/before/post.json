[
    {
        "line": 4,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "int res = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "struct mosquitto_msg_store *msg, *stored = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "mosquitto_property *properties = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "uint32_t message_expiry_interval = 0;"
    },
    {
        "line": 16,
        "fullcodeline": "int topic_alias = -1;"
    },
    {
        "line": 17,
        "fullcodeline": "uint8_t reason_code = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "uint16_t mid = 0;"
    },
    {
        "line": 24,
        "fullcodeline": "msg = mosquitto__calloc(1, sizeof(struct mosquitto_msg_store));"
    },
    {
        "line": 29,
        "fullcodeline": "dup = (header & 0x08)>>3;"
    },
    {
        "line": 30,
        "fullcodeline": "msg->qos = (header & 0x06)>>1;"
    },
    {
        "line": 49,
        "fullcodeline": "msg->retain = (header & 0x01);"
    },
    {
        "line": 139,
        "fullcodeline": "mosquitto_property_free_all(&properties);"
    },
    {
        "line": 174,
        "fullcodeline": "msg->payloadlen = context->in_packet.remaining_length - context->in_packet.pos;"
    },
    {
        "line": 175,
        "fullcodeline": "G_PUB_BYTES_RECEIVED_INC(msg->payloadlen);"
    },
    {
        "line": 211,
        "fullcodeline": "rc = mosquitto_acl_check(context, msg->topic, msg->payloadlen, msg->payload, msg->qos, msg->retain, MOSQ_ACL_WRITE);"
    },
    {
        "line": 224,
        "fullcodeline": "log__printf(NULL, MOSQ_LOG_DEBUG, \"Received PUBLISH from %s (d%d, q%d, r%d, m%d, '%s', ... (%ld bytes))\", context->id, dup, msg->qos, msg->retain, msg->source_mid, msg->topic, (long)msg->payloadlen);"
    },
    {
        "line": 323,
        "fullcodeline": "db__message_write_queued_in(context);"
    },
    {
        "line": 326,
        "fullcodeline": "rc = 1;"
    },
    {
        "line": 20,
        "fullcodeline": "if(context->state != mosq_cs_active){"
    },
    {
        "line": 25,
        "fullcodeline": "if(msg == NULL){"
    },
    {
        "line": 31,
        "fullcodeline": "if(dup == 1 && msg->qos == 0){"
    },
    {
        "line": 37,
        "fullcodeline": "if(msg->qos == 3){"
    },
    {
        "line": 43,
        "fullcodeline": "if(msg->qos > context->max_qos){"
    },
    {
        "line": 51,
        "fullcodeline": "if(msg->retain && db.config->retain_available == false){"
    },
    {
        "line": 56,
        "fullcodeline": "if(packet__read_string(&context->in_packet, &msg->topic, &slen)){"
    },
    {
        "line": 60,
        "fullcodeline": "if(!slen && context->protocol != mosq_p_mqtt5){"
    },
    {
        "line": 66,
        "fullcodeline": "if(msg->qos > 0){"
    },
    {
        "line": 81,
        "fullcodeline": "if(context->protocol == mosq_p_mqtt5){"
    },
    {
        "line": 141,
        "fullcodeline": "if(topic_alias == 0 || (context->listener && topic_alias > context->listener->max_topic_alias)){"
    },
    {
        "line": 168,
        "fullcodeline": "if(mosquitto_pub_topic_check(msg->topic) != MOSQ_ERR_SUCCESS){"
    },
    {
        "line": 176,
        "fullcodeline": "if(context->listener && context->listener->mount_point){"
    },
    {
        "line": 212,
        "fullcodeline": "if(rc == MOSQ_ERR_ACL_DENIED){"
    },
    {
        "line": 226,
        "fullcodeline": "if(!strncmp(msg->topic, \"$CONTROL/\", 9)){"
    },
    {
        "line": 238,
        "fullcodeline": "rc = plugin__handle_message(context, msg);"
    },
    {
        "line": 253,
        "fullcodeline": "if(msg->qos > 0){"
    },
    {
        "line": 257,
        "fullcodeline": "if(stored && msg->source_mid != 0 &&"
    },
    {
        "line": 268,
        "fullcodeline": "if(!stored){"
    },
    {
        "line": 32,
        "fullcodeline": "log__printf(NULL, MOSQ_LOG_INFO,"
    },
    {
        "line": 34,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 38,
        "fullcodeline": "log__printf(NULL, MOSQ_LOG_INFO,"
    },
    {
        "line": 40,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 44,
        "fullcodeline": "log__printf(NULL, MOSQ_LOG_INFO,"
    },
    {
        "line": 46,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 52,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 57,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 62,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 77,
        "fullcodeline": "msg->source_mid = mid;"
    },
    {
        "line": 82,
        "fullcodeline": "rc = property__read_all(CMD_PUBLISH, &context->in_packet, &properties);"
    },
    {
        "line": 88,
        "fullcodeline": "p = properties;"
    },
    {
        "line": 89,
        "fullcodeline": "p_prev = NULL;"
    },
    {
        "line": 90,
        "fullcodeline": "msg->properties = NULL;"
    },
    {
        "line": 91,
        "fullcodeline": "msg_properties_last = NULL;"
    },
    {
        "line": 142,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 170,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 177,
        "fullcodeline": "len = strlen(context->listener->mount_point) + strlen(msg->topic) + 1;"
    },
    {
        "line": 178,
        "fullcodeline": "topic_mount = mosquitto__malloc(len+1);"
    },
    {
        "line": 183,
        "fullcodeline": "snprintf(topic_mount, len, \"%s%s\", context->listener->mount_point, msg->topic);"
    },
    {
        "line": 184,
        "fullcodeline": "topic_mount[len] = '\\0';"
    },
    {
        "line": 186,
        "fullcodeline": "mosquitto__free(msg->topic);"
    },
    {
        "line": 187,
        "fullcodeline": "msg->topic = topic_mount;"
    },
    {
        "line": 196,
        "fullcodeline": "msg->payload = mosquitto__malloc(msg->payloadlen+1);"
    },
    {
        "line": 202,
        "fullcodeline": "((uint8_t *)msg->payload)[msg->payloadlen] = 0;"
    },
    {
        "line": 213,
        "fullcodeline": "log__printf(NULL, MOSQ_LOG_DEBUG,"
    },
    {
        "line": 217,
        "fullcodeline": "reason_code = MQTT_RC_NOT_AUTHORIZED;"
    },
    {
        "line": 232,
        "fullcodeline": "reason_code = MQTT_RC_IMPLEMENTATION_SPECIFIC;"
    },
    {
        "line": 239,
        "fullcodeline": "if(rc == MOSQ_ERR_ACL_DENIED){"
    },
    {
        "line": 254,
        "fullcodeline": "db__message_store_find(context, msg->source_mid, &stored);"
    },
    {
        "line": 258,
        "fullcodeline": "(stored->qos != msg->qos"
    },
    {
        "line": 263,
        "fullcodeline": "log__printf(NULL, MOSQ_LOG_WARNING, \"Reused message ID %u from %s detected. Clearing from storage.\", msg->source_mid, context->id);"
    },
    {
        "line": 264,
        "fullcodeline": "db__message_remove_incoming(context, msg->source_mid);"
    },
    {
        "line": 265,
        "fullcodeline": "stored = NULL;"
    },
    {
        "line": 281,
        "fullcodeline": "stored = msg;"
    },
    {
        "line": 282,
        "fullcodeline": "msg = NULL;"
    },
    {
        "line": 291,
        "fullcodeline": "rc2 = sub__messages_queue(context->id, stored->topic, stored->qos, stored->retain, &stored);"
    },
    {
        "line": 295,
        "fullcodeline": "util__decrement_receive_quota(context);"
    },
    {
        "line": 296,
        "fullcodeline": "rc2 = sub__messages_queue(context->id, stored->topic, stored->qos, stored->retain, &stored);"
    },
    {
        "line": 339,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 67,
        "fullcodeline": "if(packet__read_uint16(&context->in_packet, &mid)){"
    },
    {
        "line": 71,
        "fullcodeline": "if(mid == 0){"
    },
    {
        "line": 179,
        "fullcodeline": "if(!topic_mount){"
    },
    {
        "line": 191,
        "fullcodeline": "if(db.config->message_size_limit && msg->payloadlen > db.config->message_size_limit){"
    },
    {
        "line": 197,
        "fullcodeline": "if(msg->payload == NULL){"
    },
    {
        "line": 204,
        "fullcodeline": "if(packet__read_bytes(&context->in_packet, msg->payload, msg->payloadlen)){"
    },
    {
        "line": 216,
        "fullcodeline": "(long)msg->payloadlen);"
    },
    {
        "line": 240,
        "fullcodeline": "log__printf(NULL, MOSQ_LOG_DEBUG,"
    },
    {
        "line": 245,
        "fullcodeline": "reason_code = MQTT_RC_NOT_AUTHORIZED;"
    },
    {
        "line": 261,
        "fullcodeline": "|| memcmp(stored->payload, msg->payload, msg->payloadlen) )){"
    },
    {
        "line": 269,
        "fullcodeline": "if(msg->qos == 0"
    },
    {
        "line": 284,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 285,
        "fullcodeline": "msg = NULL;"
    },
    {
        "line": 286,
        "fullcodeline": "dup = 1;"
    },
    {
        "line": 292,
        "fullcodeline": "if(rc2 > 0) rc = 1;"
    },
    {
        "line": 298,
        "fullcodeline": "if(rc2 == MOSQ_ERR_SUCCESS || context->protocol != mosq_p_mqtt5){"
    },
    {
        "line": 307,
        "fullcodeline": "if(dup == 0){"
    },
    {
        "line": 315,
        "fullcodeline": "if(!res){"
    },
    {
        "line": 68,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 72,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 84,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 144,
        "fullcodeline": "}else if(topic_alias > 0){"
    },
    {
        "line": 180,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 192,
        "fullcodeline": "log__printf(NULL, MOSQ_LOG_DEBUG, \"Dropped too large PUBLISH from %s (d%d, q%d, r%d, m%d, '%s', ... (%ld bytes))\", context->id, dup, msg->qos, msg->retain, msg->source_mid, msg->topic, (long)msg->payloadlen);"
    },
    {
        "line": 193,
        "fullcodeline": "reason_code = MQTT_RC_PACKET_TOO_LARGE;"
    },
    {
        "line": 198,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 205,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 219,
        "fullcodeline": "}else if(rc != MOSQ_ERR_SUCCESS){"
    },
    {
        "line": 243,
        "fullcodeline": "(long)msg->payloadlen);"
    },
    {
        "line": 260,
        "fullcodeline": "|| strcmp(stored->topic, msg->topic)"
    },
    {
        "line": 271,
        "fullcodeline": "|| db__ready_for_queue(context, msg->qos, &context->msgs_in)){"
    },
    {
        "line": 273,
        "fullcodeline": "dup = 0;"
    },
    {
        "line": 274,
        "fullcodeline": "rc = db__message_store(context, msg, message_expiry_interval, 0, mosq_mo_client);"
    },
    {
        "line": 308,
        "fullcodeline": "res = db__message_insert(context, stored->source_mid, mosq_md_in, stored->qos, stored->retain, stored, NULL, false);"
    },
    {
        "line": 330,
        "fullcodeline": "rc = MOSQ_ERR_SUCCESS;"
    },
    {
        "line": 333,
        "fullcodeline": "rc = send__puback(context, msg->source_mid, reason_code, NULL);"
    },
    {
        "line": 336,
        "fullcodeline": "rc = send__pubrec(context, msg->source_mid, reason_code, NULL);"
    },
    {
        "line": 220,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 247,
        "fullcodeline": "}else if(rc != MOSQ_ERR_SUCCESS){"
    },
    {
        "line": 259,
        "fullcodeline": "|| stored->payloadlen != msg->payloadlen"
    },
    {
        "line": 270,
        "fullcodeline": "|| db__ready_for_flight(context, mosq_md_in, msg->qos)"
    },
    {
        "line": 278,
        "fullcodeline": "reason_code = MQTT_RC_QUOTA_EXCEEDED;"
    },
    {
        "line": 299,
        "fullcodeline": "if(send__puback(context, mid, 0, NULL)) rc = 1;"
    },
    {
        "line": 310,
        "fullcodeline": "res = 0;"
    },
    {
        "line": 316,
        "fullcodeline": "if(send__pubrec(context, stored->source_mid, 0, NULL)) rc = 1;"
    },
    {
        "line": 113,
        "fullcodeline": "msg_properties_last->next = NULL;"
    },
    {
        "line": 118,
        "fullcodeline": "p_prev = p;"
    },
    {
        "line": 119,
        "fullcodeline": "p = p->next;"
    },
    {
        "line": 124,
        "fullcodeline": "p_prev = p;"
    },
    {
        "line": 125,
        "fullcodeline": "p = p->next;"
    },
    {
        "line": 129,
        "fullcodeline": "p_prev = p;"
    },
    {
        "line": 130,
        "fullcodeline": "p = p->next;"
    },
    {
        "line": 134,
        "fullcodeline": "p = p->next;"
    },
    {
        "line": 248,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 300,
        "fullcodeline": "}else if(rc2 == MOSQ_ERR_NO_SUBSCRIBERS){"
    },
    {
        "line": 317,
        "fullcodeline": "}else if(res == 1){"
    },
    {
        "line": 146,
        "fullcodeline": "rc = alias__add(context, msg->topic, (uint16_t)topic_alias);"
    },
    {
        "line": 318,
        "fullcodeline": "rc = 1;"
    },
    {
        "line": 100,
        "fullcodeline": "msg_properties_last->next = p;"
    },
    {
        "line": 101,
        "fullcodeline": "msg_properties_last = p;"
    },
    {
        "line": 107,
        "fullcodeline": "p_prev->next = p->next;"
    },
    {
        "line": 108,
        "fullcodeline": "p = p_prev->next;"
    },
    {
        "line": 152,
        "fullcodeline": "rc = alias__find(context, &msg->topic, (uint16_t)topic_alias);"
    },
    {
        "line": 301,
        "fullcodeline": "if(send__puback(context, mid, MQTT_RC_NO_MATCHING_SUBSCRIBERS, NULL)) rc = 1;"
    },
    {
        "line": 303,
        "fullcodeline": "rc = rc2;"
    },
    {
        "line": 103,
        "fullcodeline": "msg->properties = p;"
    },
    {
        "line": 104,
        "fullcodeline": "msg_properties_last = p;"
    },
    {
        "line": 110,
        "fullcodeline": "properties = p->next;"
    },
    {
        "line": 111,
        "fullcodeline": "p = properties;"
    },
    {
        "line": 148,
        "fullcodeline": "db__msg_store_free(msg);"
    },
    {
        "line": 154,
        "fullcodeline": "db__msg_store_free(msg);"
    }
]