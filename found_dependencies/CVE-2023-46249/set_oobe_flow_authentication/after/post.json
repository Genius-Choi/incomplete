[
    {
        "line": 2,
        "fullcodeline": "from guardian.shortcuts import get_anonymous_user"
    },
    {
        "line": 4,
        "fullcodeline": "Flow = apps.get_model(\"authentik_flows\", \"Flow\")"
    },
    {
        "line": 5,
        "fullcodeline": "User = apps.get_model(\"authentik_core\", \"User\")"
    },
    {
        "line": 9,
        "fullcodeline": "users = User.objects.using(db_alias).exclude(username=\"akadmin\")"
    },
    {
        "line": 16,
        "fullcodeline": "if users.exists():"
    },
    {
        "line": 11,
        "fullcodeline": "users = users.exclude(pk=get_anonymous_user().pk)"
    },
    {
        "line": 17,
        "fullcodeline": "Flow.objects.filter(slug=\"initial-setup\").update(authentication=\"require_superuser\")"
    },
    {
        "line": 14,
        "fullcodeline": "pass"
    }
]