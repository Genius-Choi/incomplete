[
    {
        "line": 6,
        "fullcodeline": "cmd << \"softhsm2-util --init-token --free --label \" << token_id << \" --pin \" << hsm_token_pin"
    },
    {
        "line": 8,
        "fullcodeline": "ASSERT_EQ(0, std::system (cmd.str().c_str()));"
    },
    {
        "line": 9,
        "fullcodeline": "tokens[token_id] = HsmToken();"
    },
    {
        "line": 10,
        "fullcodeline": "tokens[token_id].pin = hsm_token_pin;"
    },
    {
        "line": 11,
        "fullcodeline": "tokens[token_id].id = token_id;"
    },
    {
        "line": 20,
        "fullcodeline": "ASSERT_EQ(0,"
    },
    {
        "line": 23,
        "fullcodeline": "serial_stream << std::ifstream(\"softhsm_serial\").rdbuf();"
    },
    {
        "line": 24,
        "fullcodeline": "std::remove (\"softhsm_serial\");"
    },
    {
        "line": 21,
        "fullcodeline": "std::system (\"softhsm2-util --show-slots | grep -oP 'Serial number:\\\\s*\\\\K(\\\\d|\\\\w)+' > softhsm_serial\"));"
    },
    {
        "line": 27,
        "fullcodeline": "while (!serial_stream.eof())"
    },
    {
        "line": 30,
        "fullcodeline": "serial_stream >> serial;"
    },
    {
        "line": 31,
        "fullcodeline": "if (!serial.empty())"
    },
    {
        "line": 33,
        "fullcodeline": "if (tokens.end() == std::find_if(tokens.begin(), tokens.end(), [&serial](std::pair<const char* const,"
    }
]