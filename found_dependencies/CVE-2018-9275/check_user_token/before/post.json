[
    {
        "line": 7,
        "fullcodeline": "char buf[1024];"
    },
    {
        "line": 9,
        "fullcodeline": "int retval = AUTH_ERROR;"
    },
    {
        "line": 14,
        "fullcodeline": "fd = open(authfile, O_RDONLY, 0);"
    },
    {
        "line": 35,
        "fullcodeline": "opwfile = fdopen(fd, \"r\");"
    },
    {
        "line": 43,
        "fullcodeline": "retval = AUTH_NO_TOKENS;"
    },
    {
        "line": 79,
        "fullcodeline": "fclose (opwfile);"
    },
    {
        "line": 15,
        "fullcodeline": "if (fd < 0) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (fstat(fd, &st) < 0) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (!S_ISREG(st.st_mode)) {"
    },
    {
        "line": 36,
        "fullcodeline": "if (opwfile == NULL) {"
    },
    {
        "line": 44,
        "fullcodeline": "while (fgets (buf, 1024, opwfile))"
    },
    {
        "line": 24,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 31,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 39,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 46,
        "fullcodeline": "char *saveptr = NULL;"
    },
    {
        "line": 57,
        "fullcodeline": "s_user = strtok_r (buf, \":\", &saveptr);"
    },
    {
        "line": 47,
        "fullcodeline": "if (buf[strlen (buf) - 1] == '\\n')"
    },
    {
        "line": 49,
        "fullcodeline": "if (buf[0] == '#') {"
    },
    {
        "line": 58,
        "fullcodeline": "if (s_user && strcmp (username, s_user) == 0)"
    },
    {
        "line": 17,
        "fullcodeline": "D (debug_file, \"Cannot open file: %s (%s)\", authfile, strerror(errno));"
    },
    {
        "line": 23,
        "fullcodeline": "D (debug_file, \"Cannot stat file: %s (%s)\", authfile, strerror(errno));"
    },
    {
        "line": 30,
        "fullcodeline": "D (debug_file, \"%s is not a regular file\", authfile);"
    },
    {
        "line": 38,
        "fullcodeline": "D (debug_file, \"fdopen: %s\", strerror(errno));"
    },
    {
        "line": 48,
        "fullcodeline": "buf[strlen (buf) - 1] = '\\0';"
    },
    {
        "line": 56,
        "fullcodeline": "D (debug_file, \"Authorization line: %s\", buf);"
    },
    {
        "line": 62,
        "fullcodeline": "retval = AUTH_NOT_FOUND; /* We found at least one line for the user */"
    },
    {
        "line": 75,
        "fullcodeline": "while (s_token != NULL);"
    },
    {
        "line": 52,
        "fullcodeline": "D (debug_file, \"Skipping comment line: %s\", buf);"
    },
    {
        "line": 61,
        "fullcodeline": "D (debug_file, \"Matched user: %s\", s_user);"
    },
    {
        "line": 65,
        "fullcodeline": "s_token = strtok_r (NULL, \":\", &saveptr);"
    },
    {
        "line": 68,
        "fullcodeline": "if (s_token && otp_id && strcmp (otp_id, s_token) == 0)"
    },
    {
        "line": 67,
        "fullcodeline": "D (debug_file, \"Authorization token: %s\", s_token);"
    },
    {
        "line": 71,
        "fullcodeline": "D (debug_file, \"Match user/token as %s/%s\", username, otp_id);"
    }
]