[
    {
        "line": 4,
        "fullcodeline": "setlocale(LC_ALL, \"\");"
    },
    {
        "line": 10,
        "fullcodeline": "abrt_init(argv);"
    },
    {
        "line": 13,
        "fullcodeline": "const char *program_usage_string = _("
    },
    {
        "line": 30,
        "fullcodeline": "const char *build_ids = \"build_ids\";"
    },
    {
        "line": 31,
        "fullcodeline": "const char *exact = NULL;"
    },
    {
        "line": 32,
        "fullcodeline": "const char *repo = NULL;"
    },
    {
        "line": 33,
        "fullcodeline": "const char *size_mb = NULL;"
    },
    {
        "line": 35,
        "fullcodeline": "struct options program_options[] = {"
    },
    {
        "line": 44,
        "fullcodeline": "const unsigned opts = parse_opts(argc, argv, program_options, program_usage_string);"
    },
    {
        "line": 46,
        "fullcodeline": "const gid_t egid = getegid();"
    },
    {
        "line": 47,
        "fullcodeline": "const gid_t rgid = getgid();"
    },
    {
        "line": 48,
        "fullcodeline": "const uid_t euid = geteuid();"
    },
    {
        "line": 49,
        "fullcodeline": "const gid_t ruid = getuid();"
    },
    {
        "line": 58,
        "fullcodeline": "char *build_ids_self_fd = NULL;"
    },
    {
        "line": 83,
        "fullcodeline": "const char *args[11];"
    },
    {
        "line": 178,
        "fullcodeline": "execvp(EXECUTABLE, (char **)args);"
    },
    {
        "line": 179,
        "fullcodeline": "error_msg_and_die(\"Can't execute %s\", EXECUTABLE);"
    },
    {
        "line": 59,
        "fullcodeline": "if (strcmp(\"-\", build_ids) != 0)"
    },
    {
        "line": 85,
        "fullcodeline": "const char *verbs[] = { \"\", \"-v\", \"-vv\", \"-vvv\" };"
    },
    {
        "line": 86,
        "fullcodeline": "unsigned i = 0;"
    },
    {
        "line": 87,
        "fullcodeline": "args[i++] = EXECUTABLE;"
    },
    {
        "line": 88,
        "fullcodeline": "args[i++] = \"--ids\";"
    },
    {
        "line": 89,
        "fullcodeline": "args[i++] = (build_ids_self_fd != NULL) ? build_ids_self_fd : \"-\";"
    },
    {
        "line": 104,
        "fullcodeline": "args[i++] = \"--\";"
    },
    {
        "line": 105,
        "fullcodeline": "args[i] = NULL;"
    },
    {
        "line": 112,
        "fullcodeline": "if (egid != rgid)"
    },
    {
        "line": 114,
        "fullcodeline": "if (euid != ruid)"
    },
    {
        "line": 36,
        "fullcodeline": "OPT__VERBOSE(&g_verbose),"
    },
    {
        "line": 37,
        "fullcodeline": "OPT_BOOL  ('y', \"yes\",         NULL,                   _(\"Noninteractive, assume 'Yes' to all questions\")),"
    },
    {
        "line": 38,
        "fullcodeline": "OPT_STRING('i', \"ids\",   &build_ids, \"BUILD_IDS_FILE\", _(\"- means STDIN, default: build_ids\")),"
    },
    {
        "line": 39,
        "fullcodeline": "OPT_STRING('e', \"exact\",     &exact, \"EXACT\",          _(\"Download only specified files\")),"
    },
    {
        "line": 40,
        "fullcodeline": "OPT_STRING('r', \"repo\",       &repo, \"REPO\",           _(\"Pattern to use when searching for repos, default: *debug*\")),"
    },
    {
        "line": 41,
        "fullcodeline": "OPT_STRING('s', \"size_mb\", &size_mb, \"SIZE_MB\",        _(\"Ignored option\")),"
    },
    {
        "line": 67,
        "fullcodeline": "const int build_ids_fd = open(build_ids, O_RDONLY);"
    },
    {
        "line": 79,
        "fullcodeline": "build_ids_self_fd = xasprintf(\"/proc/self/fd/%d\", build_ids_fd);"
    },
    {
        "line": 90,
        "fullcodeline": "if (g_verbose > 0)"
    },
    {
        "line": 92,
        "fullcodeline": "if ((opts & OPT_y))"
    },
    {
        "line": 94,
        "fullcodeline": "if ((opts & OPT_e))"
    },
    {
        "line": 99,
        "fullcodeline": "if ((opts & OPT_r))"
    },
    {
        "line": 113,
        "fullcodeline": "IGNORE_RESULT(setregid(egid, egid));"
    },
    {
        "line": 116,
        "fullcodeline": "IGNORE_RESULT(setreuid(euid, euid));"
    },
    {
        "line": 126,
        "fullcodeline": "static const char *whitelist[] = {"
    },
    {
        "line": 130,
        "fullcodeline": "const size_t wlsize = sizeof(whitelist)/sizeof(char*);"
    },
    {
        "line": 131,
        "fullcodeline": "char *setlist[sizeof(whitelist)/sizeof(char*)] = { 0 };"
    },
    {
        "line": 132,
        "fullcodeline": "char *p = NULL;"
    },
    {
        "line": 138,
        "fullcodeline": "clearenv();"
    },
    {
        "line": 169,
        "fullcodeline": "char path_env[] = \"PATH=/usr/sbin:/sbin:/usr/bin:/bin:\"BIN_DIR\":\"SBIN_DIR;"
    },
    {
        "line": 172,
        "fullcodeline": "putenv(path_env);"
    },
    {
        "line": 175,
        "fullcodeline": "umask(0022);"
    },
    {
        "line": 61,
        "fullcodeline": "if (setregid(egid, rgid) < 0)"
    },
    {
        "line": 64,
        "fullcodeline": "if (setreuid(euid, ruid) < 0)"
    },
    {
        "line": 69,
        "fullcodeline": "if (setregid(rgid, egid) < 0)"
    },
    {
        "line": 72,
        "fullcodeline": "if (setreuid(ruid, euid) < 0 )"
    },
    {
        "line": 75,
        "fullcodeline": "if (build_ids_fd < 0)"
    },
    {
        "line": 91,
        "fullcodeline": "args[i++] = verbs[g_verbose <= 3 ? g_verbose : 3];"
    },
    {
        "line": 93,
        "fullcodeline": "args[i++] = \"-y\";"
    },
    {
        "line": 96,
        "fullcodeline": "args[i++] = \"--exact\";"
    },
    {
        "line": 97,
        "fullcodeline": "args[i++] = exact;"
    },
    {
        "line": 101,
        "fullcodeline": "args[i++] = \"--repo\";"
    },
    {
        "line": 102,
        "fullcodeline": "args[i++] = repo;"
    },
    {
        "line": 133,
        "fullcodeline": "for (size_t i = 0; i < wlsize; i++)"
    },
    {
        "line": 141,
        "fullcodeline": "for (size_t i = 0; i < wlsize; i++)"
    },
    {
        "line": 62,
        "fullcodeline": "perror_msg_and_die(\"setregid(egid, rgid)\");"
    },
    {
        "line": 65,
        "fullcodeline": "perror_msg_and_die(\"setreuid(euid, ruid)\");"
    },
    {
        "line": 70,
        "fullcodeline": "perror_msg_and_die(\"setregid(rgid, egid)\");"
    },
    {
        "line": 73,
        "fullcodeline": "perror_msg_and_die(\"setreuid(ruid, euid)\");"
    },
    {
        "line": 76,
        "fullcodeline": "perror_msg_and_die(\"Failed to open file '%s'\", build_ids);"
    },
    {
        "line": 134,
        "fullcodeline": "if ((p = getenv(whitelist[i])) != NULL)"
    },
    {
        "line": 142,
        "fullcodeline": "if (setlist[i] != NULL)"
    },
    {
        "line": 135,
        "fullcodeline": "setlist[i] = xstrdup(p);"
    },
    {
        "line": 144,
        "fullcodeline": "xsetenv(whitelist[i], setlist[i]);"
    },
    {
        "line": 145,
        "fullcodeline": "free(setlist[i]);"
    }
]