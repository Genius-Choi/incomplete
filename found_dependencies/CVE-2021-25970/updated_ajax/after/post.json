[
    {
        "line": 2,
        "fullcodeline": "@user = current_site.users.find(params[:user_id])"
    },
    {
        "line": 3,
        "fullcodeline": "update_session = current_user_is?(@user)"
    },
    {
        "line": 4,
        "fullcodeline": "@user.update(params.require(:password).permit!)"
    },
    {
        "line": 5,
        "fullcodeline": "render inline: @user.errors.full_messages.join(', ')"
    },
    {
        "line": 7,
        "fullcodeline": "update_auth_token_in_cookie @user.auth_token if update_session && @user.saved_change_to_password_digest?"
    }
]