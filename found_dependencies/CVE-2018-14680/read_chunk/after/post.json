[
    {
        "line": 6,
        "fullcodeline": "struct mspack_system *sys = self->system;"
    },
    {
        "line": 10,
        "fullcodeline": "if (chunk_num >= chm->num_chunks) return NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "if (!chm->chunk_cache) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (!(buf = (unsigned char *) sys->alloc(sys, chm->chunk_size))) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (sys->seek(fh, (off_t) (chm->dir_offset + (chunk_num * chm->chunk_size)),"
    },
    {
        "line": 39,
        "fullcodeline": "if (sys->read(fh, buf, (int)chm->chunk_size) != (int)chm->chunk_size) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (!((buf[0] == 0x50) && (buf[1] == 0x4D) && (buf[2] == 0x47) &&"
    },
    {
        "line": 55,
        "fullcodeline": "return chm->chunk_cache[chunk_num] = buf;"
    },
    {
        "line": 14,
        "fullcodeline": "size_t size = sizeof(unsigned char *) * chm->num_chunks;"
    },
    {
        "line": 19,
        "fullcodeline": "memset(chm->chunk_cache, 0, size);"
    },
    {
        "line": 27,
        "fullcodeline": "self->error = MSPACK_ERR_NOMEMORY;"
    },
    {
        "line": 35,
        "fullcodeline": "self->error = MSPACK_ERR_SEEK;"
    },
    {
        "line": 36,
        "fullcodeline": "sys->free(buf);"
    },
    {
        "line": 40,
        "fullcodeline": "self->error = MSPACK_ERR_READ;"
    },
    {
        "line": 41,
        "fullcodeline": "sys->free(buf);"
    },
    {
        "line": 49,
        "fullcodeline": "self->error = MSPACK_ERR_SEEK;"
    },
    {
        "line": 50,
        "fullcodeline": "sys->free(buf);"
    },
    {
        "line": 15,
        "fullcodeline": "if (!(chm->chunk_cache = (unsigned char **) sys->alloc(sys, size))) {"
    },
    {
        "line": 47,
        "fullcodeline": "((buf[3] == 0x4C) || (buf[3] == 0x49))))"
    },
    {
        "line": 16,
        "fullcodeline": "self->error = MSPACK_ERR_NOMEMORY;"
    }
]