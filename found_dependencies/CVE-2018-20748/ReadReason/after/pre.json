[
    {
        "line": 7,
        "fullcodeline": "reasonLen = rfbClientSwap32IfLE(reasonLen);"
    },
    {
        "line": 12,
        "fullcodeline": "reason = malloc(reasonLen+1);"
    },
    {
        "line": 14,
        "fullcodeline": "reason[reasonLen]=0;"
    },
    {
        "line": 15,
        "fullcodeline": "rfbClientLog(\"VNC connection failed: %s\\n\",reason);"
    },
    {
        "line": 6,
        "fullcodeline": "if (!ReadFromRFBServer(client, (char *)&reasonLen, 4)) return;"
    },
    {
        "line": 8,
        "fullcodeline": "if(reasonLen > 1<<20) {"
    },
    {
        "line": 13,
        "fullcodeline": "if (!ReadFromRFBServer(client, reason, reasonLen)) { free(reason); return; }"
    }
]