[
    {
        "line": 7,
        "fullcodeline": "total_users = len(user_stats_dict.keys())"
    },
    {
        "line": 8,
        "fullcodeline": "rows_info_inserted = 0"
    },
    {
        "line": 9,
        "fullcodeline": "rows_info_updated = 0"
    },
    {
        "line": 10,
        "fullcodeline": "rows_stats_inserted = 0"
    },
    {
        "line": 12,
        "fullcodeline": "db_connection = mysql.connect("
    },
    {
        "line": 16,
        "fullcodeline": "cursor = db_connection.cursor()"
    },
    {
        "line": 17,
        "fullcodeline": "query = \"use \" + query_on"
    },
    {
        "line": 18,
        "fullcodeline": "cursor.execute(query)"
    },
    {
        "line": 20,
        "fullcodeline": "counter_user_id = -1"
    },
    {
        "line": 21,
        "fullcodeline": "get_max_user_id_q = ("
    },
    {
        "line": 24,
        "fullcodeline": "cursor.execute(get_max_user_id_q)"
    },
    {
        "line": 29,
        "fullcodeline": "existing_user_info = dict()"
    },
    {
        "line": 30,
        "fullcodeline": "query = ("
    },
    {
        "line": 38,
        "fullcodeline": "cursor.execute(query)"
    },
    {
        "line": 91,
        "fullcodeline": "print(\"Number of existing users:\" + str(len(existing_user_info)))"
    },
    {
        "line": 93,
        "fullcodeline": "prep_cursor = db_connection.cursor(prepared=True)"
    },
    {
        "line": 94,
        "fullcodeline": "user_info_insert_statement = ("
    },
    {
        "line": 115,
        "fullcodeline": "update_prep_cursor = db_connection.cursor(prepared=True)"
    },
    {
        "line": 116,
        "fullcodeline": "user_info_update_statement = ("
    },
    {
        "line": 136,
        "fullcodeline": "new_user_info_count = 0"
    },
    {
        "line": 137,
        "fullcodeline": "users_info_updated_count = 0"
    },
    {
        "line": 259,
        "fullcodeline": "db_connection.commit()"
    },
    {
        "line": 261,
        "fullcodeline": "print(\"Number of new users info inserted:\" + str(new_user_info_count))"
    },
    {
        "line": 262,
        "fullcodeline": "print(\"Number of users updated:\" + str(users_info_updated_count))"
    },
    {
        "line": 264,
        "fullcodeline": "dev_tokens_users = get_dev_token_users_from_mongo()"
    },
    {
        "line": 288,
        "fullcodeline": "dev_tokens_string = \"', '\".join(dev_tokens_users)"
    },
    {
        "line": 289,
        "fullcodeline": "update_new_dev_tokens_statement = ("
    },
    {
        "line": 294,
        "fullcodeline": "cursor.execute(update_new_dev_tokens_statement)"
    },
    {
        "line": 295,
        "fullcodeline": "db_connection.commit()"
    },
    {
        "line": 298,
        "fullcodeline": "user_summary_stats_insert_statement = ("
    },
    {
        "line": 305,
        "fullcodeline": "existing_user_summary_stats = dict()"
    },
    {
        "line": 306,
        "fullcodeline": "query = ("
    },
    {
        "line": 310,
        "fullcodeline": "cursor.execute(query)"
    },
    {
        "line": 324,
        "fullcodeline": "print(\"Number of existing user summaries:\" + str(len(existing_user_summary_stats)))"
    },
    {
        "line": 326,
        "fullcodeline": "new_user_summary_count = 0"
    },
    {
        "line": 327,
        "fullcodeline": "existing_user_summary_count = 0"
    },
    {
        "line": 362,
        "fullcodeline": "db_connection.commit()"
    },
    {
        "line": 367,
        "fullcodeline": "query = \"UPDATE metrics.user_info set exclude = False where last_signin_date is not NULL\""
    },
    {
        "line": 368,
        "fullcodeline": "cursor.execute(query)"
    },
    {
        "line": 369,
        "fullcodeline": "db_connection.commit()"
    },
    {
        "line": 371,
        "fullcodeline": "print(\"Number of new users summary inserted:\" + str(new_user_summary_count))"
    },
    {
        "line": 372,
        "fullcodeline": "print("
    },
    {
        "line": 25,
        "fullcodeline": "for row in cursor:"
    },
    {
        "line": 31,
        "fullcodeline": "\"select username, display_name, email, orcid, globus_login, google_login, \""
    },
    {
        "line": 39,
        "fullcodeline": "for ("
    },
    {
        "line": 95,
        "fullcodeline": "\"insert into user_info \""
    },
    {
        "line": 117,
        "fullcodeline": "\"update user_info \""
    },
    {
        "line": 139,
        "fullcodeline": "for username in user_stats_dict:"
    },
    {
        "line": 290,
        "fullcodeline": "\"update user_info set dev_token_first_seen = now() \""
    },
    {
        "line": 299,
        "fullcodeline": "\"insert into user_system_summary_stats \""
    },
    {
        "line": 307,
        "fullcodeline": "\"select username, num_orgs, narrative_count, shared_count, narratives_shared \""
    },
    {
        "line": 311,
        "fullcodeline": "for ("
    },
    {
        "line": 328,
        "fullcodeline": "for username in user_stats_dict:"
    },
    {
        "line": 373,
        "fullcodeline": "\"Number of existing users summary inserted:\" + str(existing_user_summary_count)"
    },
    {
        "line": 26,
        "fullcodeline": "counter_user_id = row[0]"
    },
    {
        "line": 65,
        "fullcodeline": "existing_user_info[username] = {"
    },
    {
        "line": 318,
        "fullcodeline": "existing_user_summary_stats[username] = {"
    },
    {
        "line": 141,
        "fullcodeline": "if username not in existing_user_info:"
    },
    {
        "line": 329,
        "fullcodeline": "if username not in existing_user_summary_stats:"
    },
    {
        "line": 142,
        "fullcodeline": "counter_user_id += 1"
    },
    {
        "line": 143,
        "fullcodeline": "input = ("
    },
    {
        "line": 170,
        "fullcodeline": "prep_cursor.execute(user_info_insert_statement, input)"
    },
    {
        "line": 171,
        "fullcodeline": "new_user_info_count += 1"
    },
    {
        "line": 331,
        "fullcodeline": "input = ("
    },
    {
        "line": 338,
        "fullcodeline": "prep_cursor.execute(user_summary_stats_insert_statement, input)"
    },
    {
        "line": 339,
        "fullcodeline": "new_user_summary_count += 1"
    },
    {
        "line": 174,
        "fullcodeline": "if not ("
    },
    {
        "line": 342,
        "fullcodeline": "if not ("
    },
    {
        "line": 176,
        "fullcodeline": "user_stats_dict[username][\"last_signin_date\"] is None"
    },
    {
        "line": 231,
        "fullcodeline": "input = ("
    },
    {
        "line": 257,
        "fullcodeline": "update_prep_cursor.execute(user_info_update_statement, input)"
    },
    {
        "line": 258,
        "fullcodeline": "users_info_updated_count += 1"
    },
    {
        "line": 343,
        "fullcodeline": "user_stats_dict[username][\"num_orgs\"]"
    },
    {
        "line": 352,
        "fullcodeline": "input = ("
    },
    {
        "line": 359,
        "fullcodeline": "prep_cursor.execute(user_summary_stats_insert_statement, input)"
    },
    {
        "line": 360,
        "fullcodeline": "existing_user_summary_count += 1"
    },
    {
        "line": 183,
        "fullcodeline": "user_stats_dict[username][\"signup_date\"].strftime("
    },
    {
        "line": 345,
        "fullcodeline": "and user_stats_dict[username][\"narrative_count\"]"
    },
    {
        "line": 177,
        "fullcodeline": "or user_stats_dict[username][\"last_signin_date\"].strftime("
    },
    {
        "line": 186,
        "fullcodeline": "== str(existing_user_info[username][\"signup_date\"])"
    },
    {
        "line": 180,
        "fullcodeline": "== str(existing_user_info[username][\"last_signin_date\"])"
    }
]