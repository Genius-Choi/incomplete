[
    {
        "line": 4,
        "fullcodeline": "struct ident_entry *ie = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "char key[256];"
    },
    {
        "line": 7,
        "fullcodeline": "int err = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "ident = 1 + rand_u64() & 0xf;  // XXX for testing"
    },
    {
        "line": 11,
        "fullcodeline": "re_snprintf(key, sizeof(key), \"%llu\", ident);"
    },
    {
        "line": 13,
        "fullcodeline": "info(\"POST: new pairing id %llu\\n\", ident);"
    },
    {
        "line": 15,
        "fullcodeline": "ie = mem_zalloc(sizeof(*ie), ie_destructor);"
    },
    {
        "line": 17,
        "fullcodeline": "ie->id = ident;"
    },
    {
        "line": 18,
        "fullcodeline": "str_dup(&ie->ident, key);"
    },
    {
        "line": 20,
        "fullcodeline": "err = dict_add(verifyd.idents, key, ie);"
    },
    {
        "line": 24,
        "fullcodeline": "mem_deref(ie); /* Owned by the dictionary */"
    },
    {
        "line": 26,
        "fullcodeline": "http_creply(conn, 200, \"OK\","
    },
    {
        "line": 32,
        "fullcodeline": "warning(\"internal error (%m)\\n\" ,err);"
    }
]