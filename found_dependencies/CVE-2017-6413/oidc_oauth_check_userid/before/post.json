[
    {
        "line": 36,
        "fullcodeline": "const char *access_token = NULL;"
    },
    {
        "line": 42,
        "fullcodeline": "json_t *token = NULL;"
    },
    {
        "line": 43,
        "fullcodeline": "char *s_token = NULL;"
    },
    {
        "line": 68,
        "fullcodeline": "oidc_request_state_set(r, OIDC_CLAIMS_SESSION_KEY, (const char *) s_token);"
    },
    {
        "line": 79,
        "fullcodeline": "char *authn_header = oidc_cfg_dir_authn_header(r);"
    },
    {
        "line": 80,
        "fullcodeline": "int pass_headers = oidc_cfg_dir_pass_info_in_headers(r);"
    },
    {
        "line": 81,
        "fullcodeline": "int pass_envvars = oidc_cfg_dir_pass_info_in_envvars(r);"
    },
    {
        "line": 90,
        "fullcodeline": "oidc_util_set_app_infos(r, token, c->claim_prefix, c->claim_delimiter,"
    },
    {
        "line": 100,
        "fullcodeline": "json_decref(token);"
    },
    {
        "line": 4,
        "fullcodeline": "if (!ap_is_initial_req(r)) {"
    },
    {
        "line": 37,
        "fullcodeline": "if (oidc_oauth_get_bearer_token(r, &access_token) == FALSE)"
    },
    {
        "line": 46,
        "fullcodeline": "if (c->oauth.introspection_endpoint_url != NULL) {"
    },
    {
        "line": 61,
        "fullcodeline": "if (token == NULL) {"
    },
    {
        "line": 71,
        "fullcodeline": "if (oidc_oauth_set_remote_user(r, c, token) == FALSE) {"
    },
    {
        "line": 83,
        "fullcodeline": "if ((r->user != NULL) && (authn_header != NULL)) {"
    },
    {
        "line": 94,
        "fullcodeline": "if (access_token != NULL) {"
    },
    {
        "line": 62,
        "fullcodeline": "oidc_error(r, \"could not resolve claims (token == NULL)\");"
    },
    {
        "line": 72,
        "fullcodeline": "oidc_error(r,"
    },
    {
        "line": 84,
        "fullcodeline": "oidc_debug(r, \"setting authn header (%s) to: %s\", authn_header,"
    },
    {
        "line": 86,
        "fullcodeline": "apr_table_set(r->headers_in, authn_header, r->user);"
    },
    {
        "line": 95,
        "fullcodeline": "oidc_util_set_app_info(r, \"access_token\", access_token,"
    },
    {
        "line": 6,
        "fullcodeline": "if (r->main != NULL)"
    },
    {
        "line": 11,
        "fullcodeline": "if (r->user != NULL) {"
    },
    {
        "line": 38,
        "fullcodeline": "return oidc_oauth_return_www_authenticate(r, \"invalid_request\","
    },
    {
        "line": 48,
        "fullcodeline": "if (oidc_oauth_resolve_access_token(r, c, access_token, &token,"
    },
    {
        "line": 63,
        "fullcodeline": "return oidc_oauth_return_www_authenticate(r, \"invalid_token\","
    },
    {
        "line": 74,
        "fullcodeline": "return oidc_oauth_return_www_authenticate(r, \"invalid_token\","
    },
    {
        "line": 14,
        "fullcodeline": "oidc_debug(r,"
    },
    {
        "line": 22,
        "fullcodeline": "} else if ((c->redirect_uri != NULL)"
    },
    {
        "line": 54,
        "fullcodeline": "if (oidc_oauth_validate_jwt_access_token(r, c, access_token, &token,"
    },
    {
        "line": 23,
        "fullcodeline": "&& (oidc_util_request_matches_url(r, c->redirect_uri))) {"
    },
    {
        "line": 50,
        "fullcodeline": "return oidc_oauth_return_www_authenticate(r, \"invalid_token\","
    },
    {
        "line": 8,
        "fullcodeline": "else if (r->prev != NULL)"
    },
    {
        "line": 25,
        "fullcodeline": "if (oidc_util_request_has_parameter(r, \"jwks\")) {"
    },
    {
        "line": 56,
        "fullcodeline": "return oidc_oauth_return_www_authenticate(r, \"invalid_token\","
    },
    {
        "line": 27,
        "fullcodeline": "return oidc_handle_jwks(r, c);"
    }
]