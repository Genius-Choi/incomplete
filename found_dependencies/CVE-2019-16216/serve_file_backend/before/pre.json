[
    {
        "line": 3,
        "fullcodeline": "path_id = \"%s/%s\" % (realm_id_str, filename)"
    },
    {
        "line": 4,
        "fullcodeline": "is_authorized = validate_attachment_request(user_profile, path_id)"
    },
    {
        "line": 6,
        "fullcodeline": "if is_authorized is None:"
    },
    {
        "line": 13,
        "fullcodeline": "return serve_s3(request, path_id)"
    },
    {
        "line": 7,
        "fullcodeline": "return HttpResponseNotFound(_(\"<p>File not found.</p>\"))"
    },
    {
        "line": 9,
        "fullcodeline": "return HttpResponseForbidden(_(\"<p>You are not authorized to view this file.</p>\"))"
    },
    {
        "line": 11,
        "fullcodeline": "return serve_local(request, path_id)"
    }
]