[
    {
        "line": 3,
        "fullcodeline": "uint8_t *buf = mempool_alloc(buf_pool);"
    },
    {
        "line": 15,
        "fullcodeline": "memset(buf, 0, L2TP_MAX_PACKET_SIZE);"
    },
    {
        "line": 17,
        "fullcodeline": "ptr = buf + sizeof(pack->hdr);"
    },
    {
        "line": 19,
        "fullcodeline": "list_for_each_entry(attr, &pack->attrs, entry) {"
    },
    {
        "line": 53,
        "fullcodeline": "pack->hdr.length = htons(len);"
    },
    {
        "line": 54,
        "fullcodeline": "memcpy(buf, &pack->hdr, sizeof(pack->hdr));"
    },
    {
        "line": 56,
        "fullcodeline": "n = sendto(sock, buf, ntohs(pack->hdr.length), 0,"
    },
    {
        "line": 58,
        "fullcodeline": "mempool_free(buf);"
    },
    {
        "line": 10,
        "fullcodeline": "if (!buf) {"
    },
    {
        "line": 25,
        "fullcodeline": "avp = (struct l2tp_avp_t *)ptr;"
    },
    {
        "line": 26,
        "fullcodeline": "avp->type = htons(attr->attr->id);"
    },
    {
        "line": 27,
        "fullcodeline": "avp->M = attr->M;"
    },
    {
        "line": 28,
        "fullcodeline": "avp->H = attr->H;"
    },
    {
        "line": 29,
        "fullcodeline": "avp->length = sizeof(*avp) + attr->length;"
    },
    {
        "line": 30,
        "fullcodeline": "*(uint16_t *)ptr = htons(*(uint16_t *)ptr);"
    },
    {
        "line": 49,
        "fullcodeline": "ptr += sizeof(*avp) + attr->length;"
    },
    {
        "line": 50,
        "fullcodeline": "len += sizeof(*avp) + attr->length;"
    },
    {
        "line": 60,
        "fullcodeline": "if (n < 0) {"
    },
    {
        "line": 71,
        "fullcodeline": "if (n != ntohs(pack->hdr.length)) {"
    },
    {
        "line": 11,
        "fullcodeline": "log_emerg(\"l2tp: out of memory\\n\");"
    },
    {
        "line": 20,
        "fullcodeline": "if (len + sizeof(*avp) + attr->length >= L2TP_MAX_PACKET_SIZE) {"
    },
    {
        "line": 12,
        "fullcodeline": "return -1;"
    },
    {
        "line": 21,
        "fullcodeline": "log_error(\"l2tp: cann't send packet (exceeds maximum size)\\n\");"
    },
    {
        "line": 22,
        "fullcodeline": "mempool_free(buf);"
    },
    {
        "line": 32,
        "fullcodeline": "memcpy(avp->val, attr->val.octets, attr->length);"
    },
    {
        "line": 61,
        "fullcodeline": "if (errno == EAGAIN) {"
    },
    {
        "line": 23,
        "fullcodeline": "return -1;"
    },
    {
        "line": 73,
        "fullcodeline": "log_warn(\"l2tp: short write (%i/%i)\\n\", n, ntohs(pack->hdr.length));"
    },
    {
        "line": 36,
        "fullcodeline": "*(int16_t *)avp->val = htons(attr->val.int16);"
    },
    {
        "line": 39,
        "fullcodeline": "*(int32_t *)avp->val = htonl(attr->val.int32);"
    },
    {
        "line": 42,
        "fullcodeline": "*(uint64_t *)avp->val = htobe64(attr->val.uint64);"
    },
    {
        "line": 46,
        "fullcodeline": "memcpy(avp->val, attr->val.string, attr->length);"
    },
    {
        "line": 63,
        "fullcodeline": "log_warn(\"l2tp: buffer overflow (packet lost)\\n\");"
    },
    {
        "line": 67,
        "fullcodeline": "return -1;"
    },
    {
        "line": 66,
        "fullcodeline": "log_warn(\"l2tp: sendto: %s\\n\", strerror(errno));"
    }
]