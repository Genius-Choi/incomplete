[
    {
        "line": 5,
        "fullcodeline": "struct l2tp_packet_t *pack = mempool_alloc(pack_pool);"
    },
    {
        "line": 9,
        "fullcodeline": "memset(pack, 0, sizeof(*pack));"
    },
    {
        "line": 10,
        "fullcodeline": "INIT_LIST_HEAD(&pack->attrs);"
    },
    {
        "line": 11,
        "fullcodeline": "pack->hdr.flags = L2TP_FLAG_T | L2TP_FLAG_L | L2TP_FLAG_S | (ver & L2TP_VER_MASK);"
    },
    {
        "line": 12,
        "fullcodeline": "memcpy(&pack->addr, addr, sizeof(*addr));"
    },
    {
        "line": 13,
        "fullcodeline": "pack->hide_avps = H;"
    },
    {
        "line": 14,
        "fullcodeline": "pack->secret = secret;"
    },
    {
        "line": 15,
        "fullcodeline": "pack->secret_len = secret_len;"
    },
    {
        "line": 6,
        "fullcodeline": "if (!pack)"
    },
    {
        "line": 18,
        "fullcodeline": "if (l2tp_packet_add_int16(pack, Message_Type, msg_type, 1)) {"
    },
    {
        "line": 19,
        "fullcodeline": "mempool_free(pack);"
    }
]