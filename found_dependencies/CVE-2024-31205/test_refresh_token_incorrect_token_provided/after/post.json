[
    {
        "line": 3,
        "fullcodeline": "csrf_token = _get_new_csrf_token()"
    },
    {
        "line": 4,
        "fullcodeline": "refresh_token = create_refresh_token(customer_user, {\"csrfToken\": csrf_token})"
    },
    {
        "line": 5,
        "fullcodeline": "api_client.cookies[JWT_REFRESH_TOKEN_COOKIE_NAME] = refresh_token"
    },
    {
        "line": 6,
        "fullcodeline": "api_client.cookies[JWT_REFRESH_TOKEN_COOKIE_NAME][\"httponly\"] = True"
    },
    {
        "line": 8,
        "fullcodeline": "variables = {\"token\": token, \"csrf_token\": csrf_token}"
    },
    {
        "line": 11,
        "fullcodeline": "response = api_client.post_graphql(MUTATION_TOKEN_REFRESH, variables)"
    },
    {
        "line": 12,
        "fullcodeline": "content = get_graphql_content(response)"
    },
    {
        "line": 16,
        "fullcodeline": "errors = data[\"errors\"]"
    },
    {
        "line": 17,
        "fullcodeline": "assert not data.get(\"token\")"
    },
    {
        "line": 18,
        "fullcodeline": "assert len(errors) == 1"
    },
    {
        "line": 19,
        "fullcodeline": "assert errors[0][\"code\"] == AccountErrorCode.JWT_DECODE_ERROR.name"
    }
]