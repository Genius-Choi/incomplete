[
    {
        "line": 2,
        "fullcodeline": "csrf_token = _get_new_csrf_token()"
    },
    {
        "line": 3,
        "fullcodeline": "refresh_token = create_refresh_token(customer_user, {\"csrfToken\": csrf_token})"
    },
    {
        "line": 4,
        "fullcodeline": "customer_user.jwt_token_key = \"new_key\""
    },
    {
        "line": 5,
        "fullcodeline": "customer_user.save()"
    },
    {
        "line": 6,
        "fullcodeline": "variables = {\"token\": None, \"csrf_token\": csrf_token}"
    },
    {
        "line": 7,
        "fullcodeline": "api_client.cookies[JWT_REFRESH_TOKEN_COOKIE_NAME] = refresh_token"
    },
    {
        "line": 8,
        "fullcodeline": "api_client.cookies[JWT_REFRESH_TOKEN_COOKIE_NAME][\"httponly\"] = True"
    },
    {
        "line": 10,
        "fullcodeline": "response = api_client.post_graphql(MUTATION_TOKEN_REFRESH, variables)"
    },
    {
        "line": 11,
        "fullcodeline": "content = get_graphql_content(response)"
    },
    {
        "line": 13,
        "fullcodeline": "data = content[\"data\"][\"tokenRefresh\"]"
    },
    {
        "line": 14,
        "fullcodeline": "errors = data[\"errors\"]"
    },
    {
        "line": 16,
        "fullcodeline": "assert not data[\"token\"]"
    },
    {
        "line": 17,
        "fullcodeline": "assert len(errors) == 1"
    },
    {
        "line": 18,
        "fullcodeline": "assert errors[0][\"code\"] == AccountErrorCode.JWT_INVALID_TOKEN.name"
    }
]