[
    {
        "line": 9,
        "fullcodeline": "int r, q = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "assert(fd >= 0);"
    },
    {
        "line": 12,
        "fullcodeline": "assert(fname);"
    },
    {
        "line": 65,
        "fullcodeline": "r = unlinkat_harder(fd, fname, is_dir ? AT_REMOVEDIR : 0, flags);"
    },
    {
        "line": 14,
        "fullcodeline": "if (is_dir < 0 ||"
    },
    {
        "line": 66,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 68,
        "fullcodeline": "if (q < 0)"
    },
    {
        "line": 16,
        "fullcodeline": "(is_dir > 0 && (root_dev || (flags & REMOVE_SUBVOLUME)))) {"
    },
    {
        "line": 18,
        "fullcodeline": "r = fstatat_harder(fd, fname, &st, AT_SYMLINK_NOFOLLOW, flags);"
    },
    {
        "line": 22,
        "fullcodeline": "is_dir = S_ISDIR(st.st_mode);"
    },
    {
        "line": 26,
        "fullcodeline": "_cleanup_close_ int subdir_fd = -1;"
    },
    {
        "line": 33,
        "fullcodeline": "r = fd_is_mount_point(fd, fname, 0);"
    },
    {
        "line": 54,
        "fullcodeline": "subdir_fd = openat(fd, fname, O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC|O_NOFOLLOW|O_NOATIME);"
    },
    {
        "line": 60,
        "fullcodeline": "q = rm_rf_children(TAKE_FD(subdir_fd), flags | REMOVE_PHYSICAL, root_dev);"
    },
    {
        "line": 19,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 29,
        "fullcodeline": "if (root_dev && st.st_dev != root_dev->st_dev)"
    },
    {
        "line": 34,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 36,
        "fullcodeline": "if (r > 0)"
    },
    {
        "line": 39,
        "fullcodeline": "if ((flags & REMOVE_SUBVOLUME) && btrfs_might_be_subvol(&st)) {"
    },
    {
        "line": 55,
        "fullcodeline": "if (subdir_fd < 0)"
    },
    {
        "line": 43,
        "fullcodeline": "r = btrfs_subvol_remove_fd(fd, fname, BTRFS_REMOVE_RECURSIVE|BTRFS_REMOVE_QUOTA);"
    },
    {
        "line": 62,
        "fullcodeline": "} else if (flags & REMOVE_ONLY_DIRECTORIES)"
    },
    {
        "line": 44,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 56,
        "fullcodeline": "return -errno;"
    },
    {
        "line": 45,
        "fullcodeline": "if (!IN_SET(r, -ENOTTY, -EINVAL))"
    }
]