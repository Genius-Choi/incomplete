[
    {
        "line": 10,
        "fullcodeline": "int r, q = 0;"
    },
    {
        "line": 12,
        "fullcodeline": "assert(fd >= 0);"
    },
    {
        "line": 13,
        "fullcodeline": "assert(fname);"
    },
    {
        "line": 66,
        "fullcodeline": "r = unlinkat_harder(fd, fname, is_dir ? AT_REMOVEDIR : 0, flags);"
    },
    {
        "line": 15,
        "fullcodeline": "if (is_dir < 0 ||"
    },
    {
        "line": 67,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 69,
        "fullcodeline": "if (q < 0)"
    },
    {
        "line": 17,
        "fullcodeline": "(is_dir > 0 && (root_dev || (flags & REMOVE_SUBVOLUME)))) {"
    },
    {
        "line": 19,
        "fullcodeline": "r = fstatat_harder(fd, fname, &st, AT_SYMLINK_NOFOLLOW, flags);"
    },
    {
        "line": 32,
        "fullcodeline": "r = fd_is_mount_point(fd, fname, 0);"
    },
    {
        "line": 55,
        "fullcodeline": "int subdir_fd = openat(fd, fname, O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC|O_NOFOLLOW|O_NOATIME);"
    },
    {
        "line": 61,
        "fullcodeline": "q = rm_rf_children(subdir_fd, flags | REMOVE_PHYSICAL, root_dev);"
    },
    {
        "line": 20,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 23,
        "fullcodeline": "is_dir = S_ISDIR(st.st_mode);"
    },
    {
        "line": 28,
        "fullcodeline": "if (root_dev && st.st_dev != root_dev->st_dev)"
    },
    {
        "line": 33,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 56,
        "fullcodeline": "if (subdir_fd < 0)"
    },
    {
        "line": 38,
        "fullcodeline": "if ((flags & REMOVE_SUBVOLUME) && btrfs_might_be_subvol(&st)) {"
    },
    {
        "line": 41,
        "fullcodeline": "r = btrfs_subvol_remove_fd(fd, fname, BTRFS_REMOVE_RECURSIVE|BTRFS_REMOVE_QUOTA);"
    },
    {
        "line": 63,
        "fullcodeline": "} else if (flags & REMOVE_ONLY_DIRECTORIES)"
    },
    {
        "line": 42,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 53,
        "fullcodeline": "return -EISDIR;"
    },
    {
        "line": 57,
        "fullcodeline": "return -errno;"
    },
    {
        "line": 43,
        "fullcodeline": "if (!IN_SET(r, -ENOTTY, -EINVAL))"
    }
]