[
    {
        "line": 2,
        "fullcodeline": "my_filters = ["
    },
    {
        "line": 5,
        "fullcodeline": "target = tmp_path.joinpath(\"target.7z\")"
    },
    {
        "line": 6,
        "fullcodeline": "good_data = b\"#!/bin/sh\\necho good\\n\""
    },
    {
        "line": 7,
        "fullcodeline": "good_path = \"good.sh\""
    },
    {
        "line": 8,
        "fullcodeline": "bad_data = b\"!#/bin/sh\\necho bad\\n\""
    },
    {
        "line": 9,
        "fullcodeline": "bad_path = \"../../.../../../../../../tmp/evil.sh\""
    },
    {
        "line": 10,
        "fullcodeline": "with SevenZipFile(target, \"w\", filters=my_filters) as archive:"
    },
    {
        "line": 13,
        "fullcodeline": "with pytest.raises(Bad7zFile):"
    },
    {
        "line": 3,
        "fullcodeline": "{\"id\": FILTER_LZMA2, \"preset\": PRESET_DEFAULT},"
    },
    {
        "line": 11,
        "fullcodeline": "archive.writestr(good_data, good_path)"
    },
    {
        "line": 12,
        "fullcodeline": "archive._writestr(bad_data, bad_path)  # bypass a path check"
    },
    {
        "line": 14,
        "fullcodeline": "with SevenZipFile(target, \"r\") as archive:"
    },
    {
        "line": 15,
        "fullcodeline": "archive.extractall(path=tmp_path)"
    }
]