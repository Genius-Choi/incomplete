[
    {
        "line": 9,
        "fullcodeline": "char ip_buf[ADDRESS_BUFFER_SIZE];"
    },
    {
        "line": 20,
        "fullcodeline": "memset(&s, 0, sizeof(s));"
    },
    {
        "line": 29,
        "fullcodeline": "memset(&s, 0, sizeof(s));"
    },
    {
        "line": 75,
        "fullcodeline": "memset(&s, 0, sizeof(s));"
    },
    {
        "line": 13,
        "fullcodeline": "if (hostname_or_ip == NULL)"
    },
    {
        "line": 106,
        "fullcodeline": "if (valid_hostname(hostname_or_ip)) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (inet_pton(AF_INET6, hostname_or_ip,"
    },
    {
        "line": 30,
        "fullcodeline": "if (strncmp(\"unix:\", hostname_or_ip, 5) == 0) {"
    },
    {
        "line": 36,
        "fullcodeline": "s.un.sun_family = AF_UNIX;"
    },
    {
        "line": 46,
        "fullcodeline": "if ((port = strrchr(hostname_or_ip, ':')) != NULL &&"
    },
    {
        "line": 47,
        "fullcodeline": "is_numeric(port + 1)) {"
    },
    {
        "line": 48,
        "fullcodeline": "len = (size_t)(port - hostname_or_ip);"
    },
    {
        "line": 49,
        "fullcodeline": "int port_num = atoi(port + 1);"
    },
    {
        "line": 64,
        "fullcodeline": "if (strcmp(\"*\", hostname_or_ip) == 0) {"
    },
    {
        "line": 65,
        "fullcodeline": "struct Address *addr = malloc(sizeof(struct Address));"
    },
    {
        "line": 76,
        "fullcodeline": "if (inet_pton(AF_INET, hostname_or_ip,"
    },
    {
        "line": 85,
        "fullcodeline": "if (hostname_or_ip[0] == '[' &&"
    },
    {
        "line": 86,
        "fullcodeline": "(port = strchr(hostname_or_ip, ']')) != NULL) {"
    },
    {
        "line": 87,
        "fullcodeline": "len = (size_t)(port - hostname_or_ip - 1);"
    },
    {
        "line": 94,
        "fullcodeline": "strncpy(ip_buf, hostname_or_ip + 1, len);"
    },
    {
        "line": 95,
        "fullcodeline": "ip_buf[len] = '\\0';"
    },
    {
        "line": 107,
        "fullcodeline": "len = strlen(hostname_or_ip);"
    },
    {
        "line": 25,
        "fullcodeline": "return new_address_sa(&s.a, sizeof(s.in6));"
    },
    {
        "line": 39,
        "fullcodeline": "sizeof(s.un.sun_path) - 1);"
    },
    {
        "line": 66,
        "fullcodeline": "if (addr != NULL) {"
    },
    {
        "line": 80,
        "fullcodeline": "return new_address_sa(&s.a, sizeof(s.in));"
    },
    {
        "line": 88,
        "fullcodeline": "if (len >= INET6_ADDRSTRLEN)"
    },
    {
        "line": 110,
        "fullcodeline": "if (addr != NULL) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (strlen(hostname_or_ip) >="
    },
    {
        "line": 51,
        "fullcodeline": "if (len < sizeof(ip_buf) && port_num >= 0 && port_num <= 65535) {"
    },
    {
        "line": 52,
        "fullcodeline": "strncpy(ip_buf, hostname_or_ip, len);"
    },
    {
        "line": 53,
        "fullcodeline": "ip_buf[len] = '\\0';"
    },
    {
        "line": 55,
        "fullcodeline": "struct Address *addr = new_address(ip_buf);"
    },
    {
        "line": 67,
        "fullcodeline": "addr->type = WILDCARD;"
    },
    {
        "line": 68,
        "fullcodeline": "addr->len = 0;"
    },
    {
        "line": 69,
        "fullcodeline": "address_set_port(addr, 0);"
    },
    {
        "line": 97,
        "fullcodeline": "if (inet_pton(AF_INET6, ip_buf,"
    },
    {
        "line": 111,
        "fullcodeline": "addr->type = HOSTNAME;"
    },
    {
        "line": 112,
        "fullcodeline": "addr->port = 0;"
    },
    {
        "line": 113,
        "fullcodeline": "addr->len = len;"
    },
    {
        "line": 114,
        "fullcodeline": "memcpy(addr->data, hostname_or_ip, len);"
    },
    {
        "line": 115,
        "fullcodeline": "addr->data[addr->len] = '\\0';"
    },
    {
        "line": 56,
        "fullcodeline": "if (addr != NULL)"
    },
    {
        "line": 101,
        "fullcodeline": "return new_address_sa(&s.a, sizeof(s.in6));"
    },
    {
        "line": 118,
        "fullcodeline": "for (char *c = addr->data; *c != '\\0'; c++)"
    },
    {
        "line": 119,
        "fullcodeline": "*c = tolower(*c);"
    },
    {
        "line": 57,
        "fullcodeline": "address_set_port(addr, (uint16_t) port_num);"
    }
]