[
    {
        "line": 15,
        "fullcodeline": "intf->in_bmc_register = true;"
    },
    {
        "line": 16,
        "fullcodeline": "mutex_unlock(&intf->bmc_reg_mutex);"
    },
    {
        "line": 22,
        "fullcodeline": "mutex_lock(&ipmidriver_mutex);"
    },
    {
        "line": 104,
        "fullcodeline": "rv = sysfs_create_link(&intf->si_dev->kobj, &bmc->pdev.dev.kobj, \"bmc\");"
    },
    {
        "line": 112,
        "fullcodeline": "intf->my_dev_name = kasprintf(GFP_KERNEL, \"ipmi%d\", intf_num);"
    },
    {
        "line": 120,
        "fullcodeline": "rv = sysfs_create_link(&bmc->pdev.dev.kobj, &intf->si_dev->kobj,"
    },
    {
        "line": 130,
        "fullcodeline": "intf->bmc_registered = true;"
    },
    {
        "line": 133,
        "fullcodeline": "mutex_unlock(&ipmidriver_mutex);"
    },
    {
        "line": 134,
        "fullcodeline": "mutex_lock(&intf->bmc_reg_mutex);"
    },
    {
        "line": 135,
        "fullcodeline": "intf->in_bmc_register = false;"
    },
    {
        "line": 140,
        "fullcodeline": "kfree(intf->my_dev_name);"
    },
    {
        "line": 141,
        "fullcodeline": "intf->my_dev_name = NULL;"
    },
    {
        "line": 144,
        "fullcodeline": "sysfs_remove_link(&intf->si_dev->kobj, \"bmc\");"
    },
    {
        "line": 147,
        "fullcodeline": "mutex_lock(&bmc->dyn_mutex);"
    },
    {
        "line": 148,
        "fullcodeline": "list_del(&intf->bmc_link);"
    },
    {
        "line": 149,
        "fullcodeline": "mutex_unlock(&bmc->dyn_mutex);"
    },
    {
        "line": 150,
        "fullcodeline": "intf->bmc = &intf->tmp_bmc;"
    },
    {
        "line": 151,
        "fullcodeline": "kref_put(&bmc->usecount, cleanup_bmc_device);"
    },
    {
        "line": 155,
        "fullcodeline": "mutex_lock(&bmc->dyn_mutex);"
    },
    {
        "line": 156,
        "fullcodeline": "list_del(&intf->bmc_link);"
    },
    {
        "line": 157,
        "fullcodeline": "mutex_unlock(&bmc->dyn_mutex);"
    },
    {
        "line": 158,
        "fullcodeline": "intf->bmc = &intf->tmp_bmc;"
    },
    {
        "line": 110,
        "fullcodeline": "if (intf_num == -1)"
    },
    {
        "line": 113,
        "fullcodeline": "if (!intf->my_dev_name) {"
    },
    {
        "line": 24,
        "fullcodeline": "old_bmc = ipmi_find_bmc_guid(&ipmidriver.driver, guid);"
    },
    {
        "line": 35,
        "fullcodeline": "bmc = old_bmc;"
    },
    {
        "line": 40,
        "fullcodeline": "intf->bmc = old_bmc;"
    },
    {
        "line": 41,
        "fullcodeline": "mutex_lock(&bmc->dyn_mutex);"
    },
    {
        "line": 42,
        "fullcodeline": "list_add_tail(&intf->bmc_link, &bmc->intfs);"
    },
    {
        "line": 43,
        "fullcodeline": "mutex_unlock(&bmc->dyn_mutex);"
    },
    {
        "line": 45,
        "fullcodeline": "dev_info(intf->si_dev,"
    },
    {
        "line": 106,
        "fullcodeline": "dev_err(intf->si_dev, \"Unable to create bmc symlink: %d\\n\", rv);"
    },
    {
        "line": 111,
        "fullcodeline": "intf_num = intf->intf_num;"
    },
    {
        "line": 114,
        "fullcodeline": "rv = -ENOMEM;"
    },
    {
        "line": 115,
        "fullcodeline": "dev_err(intf->si_dev, \"Unable to allocate link from BMC: %d\\n\","
    },
    {
        "line": 123,
        "fullcodeline": "kfree(intf->my_dev_name);"
    },
    {
        "line": 124,
        "fullcodeline": "intf->my_dev_name = NULL;"
    },
    {
        "line": 125,
        "fullcodeline": "dev_err(intf->si_dev, \"Unable to create symlink to bmc: %d\\n\","
    },
    {
        "line": 26,
        "fullcodeline": "old_bmc = ipmi_find_bmc_prod_dev_id(&ipmidriver.driver,"
    },
    {
        "line": 51,
        "fullcodeline": "bmc = kzalloc(sizeof(*bmc), GFP_KERNEL);"
    },
    {
        "line": 56,
        "fullcodeline": "INIT_LIST_HEAD(&bmc->intfs);"
    },
    {
        "line": 57,
        "fullcodeline": "mutex_init(&bmc->dyn_mutex);"
    },
    {
        "line": 58,
        "fullcodeline": "INIT_WORK(&bmc->remove_work, cleanup_bmc_work);"
    },
    {
        "line": 61,
        "fullcodeline": "bmc->dyn_id_set = 1;"
    },
    {
        "line": 62,
        "fullcodeline": "bmc->dyn_guid_set = guid_set;"
    },
    {
        "line": 64,
        "fullcodeline": "bmc->dyn_id_expiry = jiffies + IPMI_DYN_DEV_ID_EXPIRY;"
    },
    {
        "line": 66,
        "fullcodeline": "bmc->pdev.name = \"ipmi_bmc\";"
    },
    {
        "line": 68,
        "fullcodeline": "rv = ida_simple_get(&ipmi_bmc_ida, 0, 0, GFP_KERNEL);"
    },
    {
        "line": 74,
        "fullcodeline": "bmc->pdev.dev.driver = &ipmidriver.driver;"
    },
    {
        "line": 75,
        "fullcodeline": "bmc->pdev.id = rv;"
    },
    {
        "line": 76,
        "fullcodeline": "bmc->pdev.dev.release = release_bmc_device;"
    },
    {
        "line": 77,
        "fullcodeline": "bmc->pdev.dev.type = &bmc_device_type;"
    },
    {
        "line": 78,
        "fullcodeline": "kref_init(&bmc->usecount);"
    },
    {
        "line": 80,
        "fullcodeline": "intf->bmc = bmc;"
    },
    {
        "line": 81,
        "fullcodeline": "mutex_lock(&bmc->dyn_mutex);"
    },
    {
        "line": 82,
        "fullcodeline": "list_add_tail(&intf->bmc_link, &bmc->intfs);"
    },
    {
        "line": 83,
        "fullcodeline": "mutex_unlock(&bmc->dyn_mutex);"
    },
    {
        "line": 85,
        "fullcodeline": "rv = platform_device_register(&bmc->pdev);"
    },
    {
        "line": 93,
        "fullcodeline": "dev_info(intf->si_dev,"
    },
    {
        "line": 52,
        "fullcodeline": "if (!bmc) {"
    },
    {
        "line": 69,
        "fullcodeline": "if (rv < 0) {"
    },
    {
        "line": 53,
        "fullcodeline": "rv = -ENOMEM;"
    },
    {
        "line": 70,
        "fullcodeline": "kfree(bmc);"
    },
    {
        "line": 87,
        "fullcodeline": "dev_err(intf->si_dev,"
    }
]