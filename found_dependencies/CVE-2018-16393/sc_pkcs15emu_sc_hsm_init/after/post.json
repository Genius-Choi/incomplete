[
    {
        "line": 3,
        "fullcodeline": "sc_card_t *card = p15card->card;"
    },
    {
        "line": 4,
        "fullcodeline": "sc_hsm_private_data_t *priv = (sc_hsm_private_data_t *) card->drv_data;"
    },
    {
        "line": 5,
        "fullcodeline": "sc_file_t *file = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "u8 filelist[MAX_EXT_APDU_LENGTH];"
    },
    {
        "line": 15,
        "fullcodeline": "u8 efbin[1024];"
    },
    {
        "line": 19,
        "fullcodeline": "LOG_FUNC_CALLED(card->ctx);"
    },
    {
        "line": 21,
        "fullcodeline": "appinfo = calloc(1, sizeof(struct sc_app_info));"
    },
    {
        "line": 27,
        "fullcodeline": "appinfo->aid = sc_hsm_aid;"
    },
    {
        "line": 29,
        "fullcodeline": "appinfo->ddo.aid = sc_hsm_aid;"
    },
    {
        "line": 30,
        "fullcodeline": "p15card->app = appinfo;"
    },
    {
        "line": 32,
        "fullcodeline": "sc_path_set(&path, SC_PATH_TYPE_DF_NAME, sc_hsm_aid.value, sc_hsm_aid.len, 0, 0);"
    },
    {
        "line": 33,
        "fullcodeline": "r = sc_select_file(card, &path, &file);"
    },
    {
        "line": 34,
        "fullcodeline": "LOG_TEST_RET(card->ctx, r, \"Could not select SmartCard-HSM application\");"
    },
    {
        "line": 36,
        "fullcodeline": "p15card->card->version.hw_major = 24;\t/* JCOP 2.4.1r3 */"
    },
    {
        "line": 37,
        "fullcodeline": "p15card->card->version.hw_minor = 13;"
    },
    {
        "line": 43,
        "fullcodeline": "sc_file_free(file);"
    },
    {
        "line": 67,
        "fullcodeline": "memset(&devcert, 0 ,sizeof(devcert));"
    },
    {
        "line": 68,
        "fullcodeline": "r = sc_pkcs15emu_sc_hsm_decode_cvc(p15card, (const u8 **)&ptr, &len, &devcert);"
    },
    {
        "line": 69,
        "fullcodeline": "LOG_TEST_RET(card->ctx, r, \"Could not decode EF.C_DevAut\");"
    },
    {
        "line": 71,
        "fullcodeline": "sc_pkcs15emu_sc_hsm_read_tokeninfo(p15card);"
    },
    {
        "line": 100,
        "fullcodeline": "appinfo->label = strdup(p15card->tokeninfo->label);"
    },
    {
        "line": 104,
        "fullcodeline": "len = strnlen(devcert.chr, sizeof devcert.chr);\t\t/* Strip last 5 digit sequence number from CHR */"
    },
    {
        "line": 105,
        "fullcodeline": "assert(len >= 8);"
    },
    {
        "line": 106,
        "fullcodeline": "len -= 5;"
    },
    {
        "line": 108,
        "fullcodeline": "p15card->tokeninfo->serial_number = calloc(len + 1, 1);"
    },
    {
        "line": 112,
        "fullcodeline": "memcpy(p15card->tokeninfo->serial_number, devcert.chr, len);"
    },
    {
        "line": 113,
        "fullcodeline": "*(p15card->tokeninfo->serial_number + len) = 0;"
    },
    {
        "line": 115,
        "fullcodeline": "sc_hsm_set_serialnr(card, p15card->tokeninfo->serial_number);"
    },
    {
        "line": 117,
        "fullcodeline": "sc_pkcs15emu_sc_hsm_free_cvc(&devcert);"
    },
    {
        "line": 119,
        "fullcodeline": "memset(&pin_info, 0, sizeof(pin_info));"
    },
    {
        "line": 120,
        "fullcodeline": "memset(&pin_obj, 0, sizeof(pin_obj));"
    },
    {
        "line": 122,
        "fullcodeline": "pin_info.auth_id.len = 1;"
    },
    {
        "line": 123,
        "fullcodeline": "pin_info.auth_id.value[0] = 1;"
    },
    {
        "line": 124,
        "fullcodeline": "pin_info.path.aid = sc_hsm_aid;"
    },
    {
        "line": 125,
        "fullcodeline": "pin_info.auth_type = SC_PKCS15_PIN_AUTH_TYPE_PIN;"
    },
    {
        "line": 126,
        "fullcodeline": "pin_info.attrs.pin.reference = 0x81;"
    },
    {
        "line": 127,
        "fullcodeline": "pin_info.attrs.pin.flags = SC_PKCS15_PIN_FLAG_LOCAL|SC_PKCS15_PIN_FLAG_INITIALIZED|SC_PKCS15_PIN_FLAG_EXCHANGE_REF_DATA;"
    },
    {
        "line": 128,
        "fullcodeline": "pin_info.attrs.pin.type = SC_PKCS15_PIN_TYPE_ASCII_NUMERIC;"
    },
    {
        "line": 129,
        "fullcodeline": "pin_info.attrs.pin.min_length = 6;"
    },
    {
        "line": 130,
        "fullcodeline": "pin_info.attrs.pin.stored_length = 0;"
    },
    {
        "line": 131,
        "fullcodeline": "pin_info.attrs.pin.max_length = 15;"
    },
    {
        "line": 132,
        "fullcodeline": "pin_info.attrs.pin.pad_char = '\\0';"
    },
    {
        "line": 133,
        "fullcodeline": "pin_info.tries_left = 3;"
    },
    {
        "line": 134,
        "fullcodeline": "pin_info.max_tries = 3;"
    },
    {
        "line": 136,
        "fullcodeline": "pin_obj.auth_id.len = 1;"
    },
    {
        "line": 137,
        "fullcodeline": "pin_obj.auth_id.value[0] = 2;"
    },
    {
        "line": 138,
        "fullcodeline": "strlcpy(pin_obj.label, \"UserPIN\", sizeof(pin_obj.label));"
    },
    {
        "line": 139,
        "fullcodeline": "pin_obj.flags = SC_PKCS15_CO_FLAG_PRIVATE|SC_PKCS15_CO_FLAG_MODIFIABLE;"
    },
    {
        "line": 141,
        "fullcodeline": "r = sc_pkcs15emu_add_pin_obj(p15card, &pin_obj, &pin_info);"
    },
    {
        "line": 145,
        "fullcodeline": "memset(&pin_info, 0, sizeof(pin_info));"
    },
    {
        "line": 146,
        "fullcodeline": "memset(&pin_obj, 0, sizeof(pin_obj));"
    },
    {
        "line": 148,
        "fullcodeline": "pin_info.auth_id.len = 1;"
    },
    {
        "line": 149,
        "fullcodeline": "pin_info.auth_id.value[0] = 2;"
    },
    {
        "line": 150,
        "fullcodeline": "pin_info.path.aid = sc_hsm_aid;"
    },
    {
        "line": 151,
        "fullcodeline": "pin_info.auth_type = SC_PKCS15_PIN_AUTH_TYPE_PIN;"
    },
    {
        "line": 152,
        "fullcodeline": "pin_info.attrs.pin.reference = 0x88;"
    },
    {
        "line": 153,
        "fullcodeline": "pin_info.attrs.pin.flags = SC_PKCS15_PIN_FLAG_LOCAL|SC_PKCS15_PIN_FLAG_INITIALIZED|SC_PKCS15_PIN_FLAG_UNBLOCK_DISABLED|SC_PKCS15_PIN_FLAG_SO_PIN;"
    },
    {
        "line": 154,
        "fullcodeline": "pin_info.attrs.pin.type = SC_PKCS15_PIN_TYPE_BCD;"
    },
    {
        "line": 155,
        "fullcodeline": "pin_info.attrs.pin.min_length = 16;"
    },
    {
        "line": 156,
        "fullcodeline": "pin_info.attrs.pin.stored_length = 0;"
    },
    {
        "line": 157,
        "fullcodeline": "pin_info.attrs.pin.max_length = 16;"
    },
    {
        "line": 158,
        "fullcodeline": "pin_info.attrs.pin.pad_char = '\\0';"
    },
    {
        "line": 159,
        "fullcodeline": "pin_info.tries_left = 15;"
    },
    {
        "line": 160,
        "fullcodeline": "pin_info.max_tries = 15;"
    },
    {
        "line": 162,
        "fullcodeline": "strlcpy(pin_obj.label, \"SOPIN\", sizeof(pin_obj.label));"
    },
    {
        "line": 163,
        "fullcodeline": "pin_obj.flags = SC_PKCS15_CO_FLAG_PRIVATE;"
    },
    {
        "line": 165,
        "fullcodeline": "r = sc_pkcs15emu_add_pin_obj(p15card, &pin_obj, &pin_info);"
    },
    {
        "line": 195,
        "fullcodeline": "filelistlength = sc_list_files(card, filelist, sizeof(filelist));"
    },
    {
        "line": 196,
        "fullcodeline": "LOG_TEST_RET(card->ctx, filelistlength, \"Could not enumerate file and key identifier\");"
    },
    {
        "line": 215,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_SUCCESS);"
    },
    {
        "line": 23,
        "fullcodeline": "if (appinfo == NULL) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (file && file->prop_attr && file->prop_attr_len >= 2) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (priv->EF_C_DevAut && priv->EF_C_DevAut_len) {"
    },
    {
        "line": 73,
        "fullcodeline": "if (p15card->tokeninfo->label == NULL) {"
    },
    {
        "line": 84,
        "fullcodeline": "if ((p15card->tokeninfo->manufacturer_id != NULL) && !strcmp(\"(unknown)\", p15card->tokeninfo->manufacturer_id)) {"
    },
    {
        "line": 89,
        "fullcodeline": "if (p15card->tokeninfo->manufacturer_id == NULL) {"
    },
    {
        "line": 101,
        "fullcodeline": "if (appinfo->label == NULL)"
    },
    {
        "line": 109,
        "fullcodeline": "if (p15card->tokeninfo->serial_number == NULL)"
    },
    {
        "line": 142,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 166,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 170,
        "fullcodeline": "if (card->type == SC_CARD_TYPE_SC_HSM_SOC"
    },
    {
        "line": 182,
        "fullcodeline": "if (r == SC_ERROR_DATA_OBJECT_NOT_FOUND) {"
    },
    {
        "line": 191,
        "fullcodeline": "if ((r != SC_ERROR_DATA_OBJECT_NOT_FOUND) && (r != SC_ERROR_INCORRECT_PARAMETERS))"
    },
    {
        "line": 198,
        "fullcodeline": "for (i = 0; i < filelistlength; i += 2) {"
    },
    {
        "line": 24,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_OUT_OF_MEMORY);"
    },
    {
        "line": 47,
        "fullcodeline": "ptr = priv->EF_C_DevAut;"
    },
    {
        "line": 48,
        "fullcodeline": "len = priv->EF_C_DevAut_len;"
    },
    {
        "line": 85,
        "fullcodeline": "free(p15card->tokeninfo->manufacturer_id);"
    },
    {
        "line": 86,
        "fullcodeline": "p15card->tokeninfo->manufacturer_id = NULL;"
    },
    {
        "line": 102,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_OUT_OF_MEMORY);"
    },
    {
        "line": 110,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_OUT_OF_MEMORY);"
    },
    {
        "line": 143,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, r);"
    },
    {
        "line": 167,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, r);"
    },
    {
        "line": 171,
        "fullcodeline": "|| card->type == SC_CARD_TYPE_SC_HSM_GOID) {"
    },
    {
        "line": 173,
        "fullcodeline": "r = SC_SUCCESS;"
    },
    {
        "line": 183,
        "fullcodeline": "memset(&pindata, 0, sizeof(pindata));"
    },
    {
        "line": 184,
        "fullcodeline": "pindata.cmd = SC_PIN_CMD_GET_INFO;"
    },
    {
        "line": 185,
        "fullcodeline": "pindata.pin_type = SC_AC_CHV;"
    },
    {
        "line": 186,
        "fullcodeline": "pindata.pin_reference = 0x86;"
    },
    {
        "line": 188,
        "fullcodeline": "r = sc_pin_cmd(card, &pindata, NULL);"
    },
    {
        "line": 192,
        "fullcodeline": "card->caps |= SC_CARD_CAP_PROTECTED_AUTHENTICATION_PATH;"
    },
    {
        "line": 51,
        "fullcodeline": "r = read_file(p15card, (u8 *) \"\\x2F\\x02\", efbin, &len, 1);"
    },
    {
        "line": 52,
        "fullcodeline": "LOG_TEST_RET(card->ctx, r, \"Skipping optional EF.C_DevAut\");"
    },
    {
        "line": 64,
        "fullcodeline": "ptr = efbin;"
    },
    {
        "line": 74,
        "fullcodeline": "if (p15card->card->type == SC_CARD_TYPE_SC_HSM_GOID"
    },
    {
        "line": 80,
        "fullcodeline": "if (p15card->tokeninfo->label == NULL)"
    },
    {
        "line": 90,
        "fullcodeline": "if (p15card->card->type == SC_CARD_TYPE_SC_HSM_GOID"
    },
    {
        "line": 96,
        "fullcodeline": "if (p15card->tokeninfo->manufacturer_id == NULL)"
    },
    {
        "line": 175,
        "fullcodeline": "memset(&pindata, 0, sizeof(pindata));"
    },
    {
        "line": 176,
        "fullcodeline": "pindata.cmd = SC_PIN_CMD_GET_INFO;"
    },
    {
        "line": 177,
        "fullcodeline": "pindata.pin_type = SC_AC_CHV;"
    },
    {
        "line": 178,
        "fullcodeline": "pindata.pin_reference = 0x85;"
    },
    {
        "line": 180,
        "fullcodeline": "r = sc_pin_cmd(card, &pindata, NULL);"
    },
    {
        "line": 210,
        "fullcodeline": "if (r != SC_SUCCESS) {"
    },
    {
        "line": 39,
        "fullcodeline": "p15card->card->version.fw_major = file->prop_attr[file->prop_attr_len - 2];"
    },
    {
        "line": 40,
        "fullcodeline": "p15card->card->version.fw_minor = file->prop_attr[file->prop_attr_len - 1];"
    },
    {
        "line": 54,
        "fullcodeline": "if (len > 0) {"
    },
    {
        "line": 75,
        "fullcodeline": "|| p15card->card->type == SC_CARD_TYPE_SC_HSM_SOC) {"
    },
    {
        "line": 76,
        "fullcodeline": "p15card->tokeninfo->label = strdup(\"GoID\");"
    },
    {
        "line": 81,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_OUT_OF_MEMORY);"
    },
    {
        "line": 91,
        "fullcodeline": "|| p15card->card->type == SC_CARD_TYPE_SC_HSM_SOC) {"
    },
    {
        "line": 92,
        "fullcodeline": "p15card->tokeninfo->manufacturer_id = strdup(\"Bundesdruckerei GmbH\");"
    },
    {
        "line": 97,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_OUT_OF_MEMORY);"
    },
    {
        "line": 201,
        "fullcodeline": "r = sc_pkcs15emu_sc_hsm_add_prkd(p15card, filelist[i + 1]);"
    },
    {
        "line": 204,
        "fullcodeline": "r = sc_pkcs15emu_sc_hsm_add_dcod(p15card, filelist[i + 1]);"
    },
    {
        "line": 207,
        "fullcodeline": "r = sc_pkcs15emu_sc_hsm_add_cd(p15card, filelist[i + 1]);"
    },
    {
        "line": 211,
        "fullcodeline": "sc_log(card->ctx, \"Error %d adding elements to framework\", r);"
    },
    {
        "line": 56,
        "fullcodeline": "ptr = realloc(priv->EF_C_DevAut, len);"
    },
    {
        "line": 78,
        "fullcodeline": "p15card->tokeninfo->label = strdup(\"SmartCard-HSM\");"
    },
    {
        "line": 94,
        "fullcodeline": "p15card->tokeninfo->manufacturer_id = strdup(\"www.CardContact.de\");"
    },
    {
        "line": 58,
        "fullcodeline": "memcpy(ptr, efbin, len);"
    },
    {
        "line": 59,
        "fullcodeline": "priv->EF_C_DevAut = ptr;"
    },
    {
        "line": 60,
        "fullcodeline": "priv->EF_C_DevAut_len = len;"
    }
]