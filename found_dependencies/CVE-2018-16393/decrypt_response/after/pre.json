[
    {
        "line": 5,
        "fullcodeline": "unsigned char iv[16] = { 0 };"
    },
    {
        "line": 6,
        "fullcodeline": "unsigned char plaintext[4096] = { 0 };"
    },
    {
        "line": 7,
        "fullcodeline": "epass2003_exdata *exdata = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "exdata = (epass2003_exdata *)card->drv_data;"
    },
    {
        "line": 9,
        "fullcodeline": "if (!card->drv_data)"
    },
    {
        "line": 40,
        "fullcodeline": "if (KEY_TYPE_AES == exdata->smtype)"
    },
    {
        "line": 47,
        "fullcodeline": "cipher_len--;"
    },
    {
        "line": 52,
        "fullcodeline": "memcpy(out, plaintext, cipher_len - 2);"
    },
    {
        "line": 53,
        "fullcodeline": "*out_len = cipher_len - 2;"
    },
    {
        "line": 19,
        "fullcodeline": "if (0x01 == in[2] && 0x82 != in[1]) {"
    },
    {
        "line": 20,
        "fullcodeline": "cipher_len = in[1];"
    },
    {
        "line": 21,
        "fullcodeline": "i = 3;"
    },
    {
        "line": 36,
        "fullcodeline": "if (cipher_len < 2 || i+cipher_len > inlen || cipher_len > sizeof plaintext)"
    },
    {
        "line": 41,
        "fullcodeline": "aes128_decrypt_cbc(exdata->sk_enc, 16, iv, &in[i], cipher_len - 1, plaintext);"
    },
    {
        "line": 46,
        "fullcodeline": "while (0x80 != plaintext[cipher_len - 2] && (cipher_len - 2 > 0))"
    },
    {
        "line": 49,
        "fullcodeline": "if (2 == cipher_len || *out_len < cipher_len - 2)"
    },
    {
        "line": 37,
        "fullcodeline": "return -1;"
    },
    {
        "line": 43,
        "fullcodeline": "des3_decrypt_cbc(exdata->sk_enc, 16, iv, &in[i], cipher_len - 1, plaintext);"
    },
    {
        "line": 50,
        "fullcodeline": "return -1;"
    },
    {
        "line": 23,
        "fullcodeline": "else if (0x01 == in[3] && 0x81 == in[1]) {"
    },
    {
        "line": 24,
        "fullcodeline": "cipher_len = in[2];"
    },
    {
        "line": 25,
        "fullcodeline": "i = 4;"
    },
    {
        "line": 27,
        "fullcodeline": "else if (0x01 == in[4] && 0x82 == in[1]) {"
    },
    {
        "line": 28,
        "fullcodeline": "cipher_len = in[2] * 0x100;"
    },
    {
        "line": 29,
        "fullcodeline": "cipher_len += in[3];"
    },
    {
        "line": 30,
        "fullcodeline": "i = 5;"
    },
    {
        "line": 33,
        "fullcodeline": "return -1;"
    }
]