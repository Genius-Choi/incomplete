[
    {
        "line": 4,
        "fullcodeline": "u8  ibuf[GEMSAFE_MAX_OBJLEN];"
    },
    {
        "line": 9,
        "fullcodeline": "unsigned int ind, i=0;"
    },
    {
        "line": 11,
        "fullcodeline": "sc_format_path(GEMSAFE_PATH, &path);"
    },
    {
        "line": 12,
        "fullcodeline": "r = sc_select_file(card, &path, &file);"
    },
    {
        "line": 17,
        "fullcodeline": "r = sc_read_binary(card, 0, ibuf, GEMSAFE_READ_QUANTUM, 0);"
    },
    {
        "line": 24,
        "fullcodeline": "objlen = (((size_t) ibuf[0]) << 8) | ibuf[1];"
    },
    {
        "line": 47,
        "fullcodeline": "ind = 2; /* skip length */"
    },
    {
        "line": 75,
        "fullcodeline": "iptr = ibuf + GEMSAFE_READ_QUANTUM;"
    },
    {
        "line": 87,
        "fullcodeline": "i = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "if (r != SC_SUCCESS || !file)"
    },
    {
        "line": 18,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 27,
        "fullcodeline": "if (objlen < 1 || objlen > GEMSAFE_MAX_OBJLEN) {"
    },
    {
        "line": 48,
        "fullcodeline": "while (ibuf[ind] == 0x01 && i < gemsafe_cert_max) {"
    },
    {
        "line": 67,
        "fullcodeline": "for (; i < gemsafe_cert_max; i++) {"
    },
    {
        "line": 76,
        "fullcodeline": "while ((size_t)(iptr - ibuf) < objlen) {"
    },
    {
        "line": 88,
        "fullcodeline": "while (ind < objlen - 1) {"
    },
    {
        "line": 115,
        "fullcodeline": "for (; i < gemsafe_cert_max; i++) {"
    },
    {
        "line": 61,
        "fullcodeline": "i++;"
    },
    {
        "line": 68,
        "fullcodeline": "gemsafe_prkeys[i].label = NULL;"
    },
    {
        "line": 69,
        "fullcodeline": "gemsafe_cert[i].label = NULL;"
    },
    {
        "line": 77,
        "fullcodeline": "r = sc_read_binary(card, iptr - ibuf, iptr,"
    },
    {
        "line": 83,
        "fullcodeline": "iptr += GEMSAFE_READ_QUANTUM;"
    },
    {
        "line": 49,
        "fullcodeline": "if (ibuf[ind+1] == 0xFE) {"
    },
    {
        "line": 79,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 89,
        "fullcodeline": "if (ibuf[ind] == 0x30 && ibuf[ind+1] == 0x82) {"
    },
    {
        "line": 50,
        "fullcodeline": "gemsafe_prkeys[i].ref = ibuf[ind+4];"
    },
    {
        "line": 51,
        "fullcodeline": "sc_log(card->ctx, \"Key container %d is allocated and uses key_ref %d\","
    },
    {
        "line": 53,
        "fullcodeline": "ind += 9;"
    },
    {
        "line": 78,
        "fullcodeline": "MIN(GEMSAFE_READ_QUANTUM, objlen - (iptr - ibuf)), 0);"
    },
    {
        "line": 80,
        "fullcodeline": "sc_log(card->ctx, \"Could not read cert object\");"
    },
    {
        "line": 100,
        "fullcodeline": "certlen = ((((size_t) ibuf[ind+2]) << 8) | ibuf[ind+3]) + 4;"
    },
    {
        "line": 104,
        "fullcodeline": "gemsafe_cert[i].index = ind;"
    },
    {
        "line": 105,
        "fullcodeline": "gemsafe_cert[i].count = certlen;"
    },
    {
        "line": 106,
        "fullcodeline": "ind += certlen;"
    },
    {
        "line": 107,
        "fullcodeline": "i++;"
    },
    {
        "line": 117,
        "fullcodeline": "sc_log(card->ctx, \"Warning: Certificate of key container %d is missing\", i+1);"
    },
    {
        "line": 118,
        "fullcodeline": "gemsafe_prkeys[i].label = NULL;"
    },
    {
        "line": 119,
        "fullcodeline": "gemsafe_cert[i].label = NULL;"
    },
    {
        "line": 52,
        "fullcodeline": "i+1, gemsafe_prkeys[i].ref);"
    },
    {
        "line": 56,
        "fullcodeline": "gemsafe_prkeys[i].label = NULL;"
    },
    {
        "line": 57,
        "fullcodeline": "gemsafe_cert[i].label = NULL;"
    },
    {
        "line": 58,
        "fullcodeline": "sc_log(card->ctx, \"Key container %d is unallocated\", i+1);"
    },
    {
        "line": 59,
        "fullcodeline": "ind += 8;"
    },
    {
        "line": 91,
        "fullcodeline": "while (i < gemsafe_cert_max && gemsafe_cert[i].label == NULL)"
    },
    {
        "line": 92,
        "fullcodeline": "i++;"
    },
    {
        "line": 93,
        "fullcodeline": "if (i == gemsafe_cert_max) {"
    },
    {
        "line": 98,
        "fullcodeline": "if (ind+3 >= sizeof ibuf)"
    },
    {
        "line": 109,
        "fullcodeline": "ind++;"
    },
    {
        "line": 94,
        "fullcodeline": "sc_log(card->ctx, \"Warning: Found orphaned certificate at offset %d\", ind);"
    }
]