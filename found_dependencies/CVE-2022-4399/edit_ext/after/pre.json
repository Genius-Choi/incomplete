[
    {
        "line": 8,
        "fullcodeline": "char buff[512];"
    },
    {
        "line": 11,
        "fullcodeline": "strcpy(buff,\"/tmp/nodau.XXXXXX\");"
    },
    {
        "line": 12,
        "fullcodeline": "fd = mkstemp(buff);"
    },
    {
        "line": 17,
        "fullcodeline": "pid = fork();"
    },
    {
        "line": 56,
        "fullcodeline": "sz = strlen(name)+strlen(date)+strlen(data)+50;"
    },
    {
        "line": 57,
        "fullcodeline": "b = alloca(sz);"
    },
    {
        "line": 60,
        "fullcodeline": "sz = sprintf("
    },
    {
        "line": 70,
        "fullcodeline": "fsync(fd);"
    },
    {
        "line": 73,
        "fullcodeline": "st = execl(editor,editor,buff,(char*)NULL);"
    },
    {
        "line": 14,
        "fullcodeline": "if (fd < 0)"
    },
    {
        "line": 19,
        "fullcodeline": "if (pid < 0) {"
    },
    {
        "line": 67,
        "fullcodeline": "if (write(fd,b,sz) != sz) {"
    },
    {
        "line": 23,
        "fullcodeline": "waitpid(pid,&st,0);"
    },
    {
        "line": 24,
        "fullcodeline": "if (!st) {"
    },
    {
        "line": 28,
        "fullcodeline": "sz = lseek(fd,0,SEEK_END);"
    },
    {
        "line": 29,
        "fullcodeline": "lseek(fd,0,SEEK_SET);"
    },
    {
        "line": 25,
        "fullcodeline": "if ((fd = open(buff,O_RDONLY)) < 0)"
    },
    {
        "line": 32,
        "fullcodeline": "b = alloca(sz+1);"
    },
    {
        "line": 38,
        "fullcodeline": "b[sz] = 0;"
    },
    {
        "line": 40,
        "fullcodeline": "l = strstr(b,\"-----\");"
    },
    {
        "line": 33,
        "fullcodeline": "if (sz != read(fd,b,sz))"
    },
    {
        "line": 43,
        "fullcodeline": "l += 6;"
    },
    {
        "line": 44,
        "fullcodeline": "int r = db_update(name,l);"
    },
    {
        "line": 45,
        "fullcodeline": "if (r != SQLITE_DONE && r != SQLITE_OK)"
    }
]