[
    {
        "line": 2,
        "fullcodeline": "logger = logging.getLogger(__name__)"
    },
    {
        "line": 6,
        "fullcodeline": "remote_address = get_remote_address(flask.request)"
    },
    {
        "line": 7,
        "fullcodeline": "ip_check_enabled = settings().getBoolean([\"server\", \"ipCheck\", \"enabled\"])"
    },
    {
        "line": 8,
        "fullcodeline": "ip_check_trusted = settings().get([\"server\", \"ipCheck\", \"trustedSubnets\"])"
    },
    {
        "line": 14,
        "fullcodeline": "def login(u):"
    },
    {
        "line": 43,
        "fullcodeline": "def determine_user(u):"
    },
    {
        "line": 89,
        "fullcodeline": "user = login(determine_user(user))"
    },
    {
        "line": 90,
        "fullcodeline": "response = user.as_dict()"
    },
    {
        "line": 91,
        "fullcodeline": "response[\"_is_external_client\"] = ip_check_enabled and not is_lan_address("
    },
    {
        "line": 96,
        "fullcodeline": "response[\"_credentials_seen\"] = to_api_credentials_seen("
    },
    {
        "line": 10,
        "fullcodeline": "if isinstance(user, LocalProxy):"
    },
    {
        "line": 94,
        "fullcodeline": "if flask.session.get(\"login_mechanism\") is not None:"
    },
    {
        "line": 99,
        "fullcodeline": "return flask.jsonify(response)"
    },
    {
        "line": 12,
        "fullcodeline": "user = user._get_current_object()"
    },
    {
        "line": 95,
        "fullcodeline": "response[\"_login_mechanism\"] = flask.session.get(\"login_mechanism\")"
    },
    {
        "line": 97,
        "fullcodeline": "flask.session.get(\"credentials_seen\", False)"
    }
]