[
    {
        "line": 3,
        "fullcodeline": "char buf[1024];"
    },
    {
        "line": 7,
        "fullcodeline": "memset(msg, 0, sizeof(*msg));"
    },
    {
        "line": 9,
        "fullcodeline": "p = strchr(payload, ';');"
    },
    {
        "line": 12,
        "fullcodeline": "memcpy(buf, payload, p - payload);"
    },
    {
        "line": 13,
        "fullcodeline": "buf[p - payload] = '\\0';"
    },
    {
        "line": 15,
        "fullcodeline": "msg->text = p + 1;"
    },
    {
        "line": 16,
        "fullcodeline": "msg->text_len = strlen(msg->text);"
    },
    {
        "line": 21,
        "fullcodeline": "idx = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "p = buf;"
    },
    {
        "line": 83,
        "fullcodeline": "errno = EINVAL;"
    },
    {
        "line": 10,
        "fullcodeline": "if (!p || p - payload >= (signed)sizeof(buf))"
    },
    {
        "line": 17,
        "fullcodeline": "if (msg->text_len > NCRX_LINE_MAX)"
    },
    {
        "line": 23,
        "fullcodeline": "while ((tok = strsep(&p, \",\"))) {"
    },
    {
        "line": 84,
        "fullcodeline": "return -1;"
    },
    {
        "line": 18,
        "fullcodeline": "msg->text_len = NCRX_LINE_MAX;"
    },
    {
        "line": 55,
        "fullcodeline": "val = tok;"
    },
    {
        "line": 56,
        "fullcodeline": "key = strsep(&val, \"=\");"
    },
    {
        "line": 27,
        "fullcodeline": "switch (idx++) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (!val)"
    },
    {
        "line": 59,
        "fullcodeline": "if (!strcmp(key, \"ncfrag\")) {"
    },
    {
        "line": 29,
        "fullcodeline": "v = strtoul(tok, &endp, 0);"
    },
    {
        "line": 32,
        "fullcodeline": "msg->facility = v >> 3;"
    },
    {
        "line": 33,
        "fullcodeline": "msg->level = v & ((1 << 3) - 1);"
    },
    {
        "line": 36,
        "fullcodeline": "v = strtoull(tok, &endp, 0);"
    },
    {
        "line": 39,
        "fullcodeline": "msg->seq = v;"
    },
    {
        "line": 42,
        "fullcodeline": "v = strtoull(tok, &endp, 0);"
    },
    {
        "line": 45,
        "fullcodeline": "msg->ts_usec = v;"
    },
    {
        "line": 70,
        "fullcodeline": "msg->ncfrag_off = nf_off;"
    },
    {
        "line": 71,
        "fullcodeline": "msg->ncfrag_len = msg->text_len;"
    },
    {
        "line": 72,
        "fullcodeline": "msg->ncfrag_left = nf_len - msg->ncfrag_len;"
    },
    {
        "line": 73,
        "fullcodeline": "msg->text_len = nf_len;"
    },
    {
        "line": 30,
        "fullcodeline": "if (*endp != '\\0' || v > UINT8_MAX)"
    },
    {
        "line": 37,
        "fullcodeline": "if (*endp != '\\0')"
    },
    {
        "line": 43,
        "fullcodeline": "if (*endp != '\\0')"
    },
    {
        "line": 48,
        "fullcodeline": "if (tok[0] == 'c')"
    },
    {
        "line": 62,
        "fullcodeline": "if (sscanf(val, \"%u/%u\", &nf_off, &nf_len) != 2)"
    },
    {
        "line": 64,
        "fullcodeline": "if (!msg->text_len ||"
    },
    {
        "line": 49,
        "fullcodeline": "msg->cont_start = 1;"
    },
    {
        "line": 67,
        "fullcodeline": "nf_off + msg->text_len > nf_len)"
    },
    {
        "line": 74,
        "fullcodeline": "} else if (!strcmp(key, \"ncemg\")) {"
    },
    {
        "line": 66,
        "fullcodeline": "nf_off >= nf_len ||"
    },
    {
        "line": 75,
        "fullcodeline": "v = strtoul(val, &endp, 0);"
    },
    {
        "line": 78,
        "fullcodeline": "msg->emg = v;"
    },
    {
        "line": 50,
        "fullcodeline": "else if (tok[0] == '+')"
    },
    {
        "line": 65,
        "fullcodeline": "nf_len >= NCRX_LINE_MAX ||"
    },
    {
        "line": 76,
        "fullcodeline": "if (*endp != '\\0')"
    },
    {
        "line": 51,
        "fullcodeline": "msg->cont = 1;"
    }
]