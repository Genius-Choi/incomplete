[
    {
        "line": 4,
        "fullcodeline": "int extdatalen = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned char *orig = buf;"
    },
    {
        "line": 6,
        "fullcodeline": "unsigned char *ret = buf;"
    },
    {
        "line": 13,
        "fullcodeline": "int using_ecc = (alg_k & SSL_kECDHE) || (alg_a & SSL_aECDSA);"
    },
    {
        "line": 14,
        "fullcodeline": "using_ecc = using_ecc && (s->session->tlsext_ecpointformatlist != NULL);"
    },
    {
        "line": 17,
        "fullcodeline": "ret += 2;"
    },
    {
        "line": 202,
        "fullcodeline": "s->s3->next_proto_neg_seen = 0;"
    },
    {
        "line": 287,
        "fullcodeline": "s2n(extdatalen, orig);"
    },
    {
        "line": 18,
        "fullcodeline": "if (ret >= limit)"
    },
    {
        "line": 49,
        "fullcodeline": "if (s->version == SSL3_VERSION)"
    },
    {
        "line": 52,
        "fullcodeline": "if (!s->hit && s->servername_done == 1"
    },
    {
        "line": 101,
        "fullcodeline": "if (s->tlsext_ticket_expected && tls_use_ticket(s)) {"
    },
    {
        "line": 129,
        "fullcodeline": "if (SSL_IS_DTLS(s) && s->srtp_profile) {"
    },
    {
        "line": 156,
        "fullcodeline": "if (((s->s3->tmp.new_cipher->id & 0xFFFF) == 0x80"
    },
    {
        "line": 177,
        "fullcodeline": "if (SSL_IS_DTLS(s) && (s->tlsext_heartbeat & SSL_DTLSEXT_HB_ENABLED)) {"
    },
    {
        "line": 203,
        "fullcodeline": "if (next_proto_neg_seen && s->ctx->next_protos_advertised_cb) {"
    },
    {
        "line": 227,
        "fullcodeline": "if (!custom_ext_add(s, 1, &ret, limit, al))"
    },
    {
        "line": 250,
        "fullcodeline": "if (s->s3->flags & TLS1_FLAGS_RECEIVED_EXTMS) {"
    },
    {
        "line": 261,
        "fullcodeline": "if (s->s3->alpn_selected != NULL) {"
    },
    {
        "line": 284,
        "fullcodeline": "if ((extdatalen = ret - orig - 2) == 0)"
    },
    {
        "line": 37,
        "fullcodeline": "s2n(TLSEXT_TYPE_renegotiate, ret);"
    },
    {
        "line": 38,
        "fullcodeline": "s2n(el, ret);"
    },
    {
        "line": 45,
        "fullcodeline": "ret += el;"
    },
    {
        "line": 53,
        "fullcodeline": "&& s->session->tlsext_hostname != NULL) {"
    },
    {
        "line": 61,
        "fullcodeline": "s2n(TLSEXT_TYPE_server_name, ret);"
    },
    {
        "line": 62,
        "fullcodeline": "s2n(0, ret);"
    },
    {
        "line": 72,
        "fullcodeline": "tls1_get_formatlist(s, &plist, &plistlen);"
    },
    {
        "line": 88,
        "fullcodeline": "s2n(TLSEXT_TYPE_ec_point_formats, ret);"
    },
    {
        "line": 89,
        "fullcodeline": "s2n(plistlen + 1, ret);"
    },
    {
        "line": 90,
        "fullcodeline": "*(ret++) = (unsigned char)plistlen;"
    },
    {
        "line": 91,
        "fullcodeline": "memcpy(ret, plist, plistlen);"
    },
    {
        "line": 92,
        "fullcodeline": "ret += plistlen;"
    },
    {
        "line": 108,
        "fullcodeline": "s2n(TLSEXT_TYPE_session_ticket, ret);"
    },
    {
        "line": 109,
        "fullcodeline": "s2n(0, ret);"
    },
    {
        "line": 125,
        "fullcodeline": "s2n(TLSEXT_TYPE_status_request, ret);"
    },
    {
        "line": 126,
        "fullcodeline": "s2n(0, ret);"
    },
    {
        "line": 145,
        "fullcodeline": "s2n(TLSEXT_TYPE_use_srtp, ret);"
    },
    {
        "line": 146,
        "fullcodeline": "s2n(el, ret);"
    },
    {
        "line": 152,
        "fullcodeline": "ret += el;"
    },
    {
        "line": 158,
        "fullcodeline": "&& (SSL_get_options(s) & SSL_OP_CRYPTOPRO_TLSEXT_BUG)) {"
    },
    {
        "line": 159,
        "fullcodeline": "const unsigned char cryptopro_ext[36] = {"
    },
    {
        "line": 171,
        "fullcodeline": "memcpy(ret, cryptopro_ext, sizeof(cryptopro_ext));"
    },
    {
        "line": 172,
        "fullcodeline": "ret += sizeof(cryptopro_ext);"
    },
    {
        "line": 185,
        "fullcodeline": "s2n(TLSEXT_TYPE_heartbeat, ret);"
    },
    {
        "line": 186,
        "fullcodeline": "s2n(1, ret);"
    },
    {
        "line": 208,
        "fullcodeline": "r = s->ctx->next_protos_advertised_cb(s, &npa, &npalen,"
    },
    {
        "line": 257,
        "fullcodeline": "s2n(TLSEXT_TYPE_extended_master_secret, ret);"
    },
    {
        "line": 258,
        "fullcodeline": "s2n(0, ret);"
    },
    {
        "line": 262,
        "fullcodeline": "const unsigned char *selected = s->s3->alpn_selected;"
    },
    {
        "line": 274,
        "fullcodeline": "s2n(TLSEXT_TYPE_application_layer_protocol_negotiation, ret);"
    },
    {
        "line": 275,
        "fullcodeline": "s2n(3 + len, ret);"
    },
    {
        "line": 276,
        "fullcodeline": "s2n(1 + len, ret);"
    },
    {
        "line": 277,
        "fullcodeline": "*ret++ = len;"
    },
    {
        "line": 278,
        "fullcodeline": "memcpy(ret, selected, len);"
    },
    {
        "line": 279,
        "fullcodeline": "ret += len;"
    },
    {
        "line": 24,
        "fullcodeline": "if (!ssl_add_serverhello_renegotiate_ext(s, 0, &el, 0)) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (CHECKLEN(ret, 4 + el, limit))"
    },
    {
        "line": 40,
        "fullcodeline": "if (!ssl_add_serverhello_renegotiate_ext(s, ret, &el, el)) {"
    },
    {
        "line": 58,
        "fullcodeline": "if (CHECKLEN(ret, 4, limit))"
    },
    {
        "line": 74,
        "fullcodeline": "if (plistlen > 255) {"
    },
    {
        "line": 85,
        "fullcodeline": "if (CHECKLEN(ret, 5 + plistlen, limit))"
    },
    {
        "line": 106,
        "fullcodeline": "if (CHECKLEN(ret, 4, limit))"
    },
    {
        "line": 115,
        "fullcodeline": "s->tlsext_ticket_expected = 0;"
    },
    {
        "line": 123,
        "fullcodeline": "if (CHECKLEN(ret, 4, limit))"
    },
    {
        "line": 133,
        "fullcodeline": "if (ssl_add_serverhello_use_srtp_ext(s, 0, &el, 0)) {"
    },
    {
        "line": 142,
        "fullcodeline": "if (CHECKLEN(ret, 4 + el, limit))"
    },
    {
        "line": 148,
        "fullcodeline": "if (ssl_add_serverhello_use_srtp_ext(s, ret, &el, el)) {"
    },
    {
        "line": 157,
        "fullcodeline": "|| (s->s3->tmp.new_cipher->id & 0xFFFF) == 0x81)"
    },
    {
        "line": 169,
        "fullcodeline": "if (CHECKLEN(ret, sizeof(cryptopro_ext), limit))"
    },
    {
        "line": 183,
        "fullcodeline": "if (CHECKLEN(ret, 5, limit))"
    },
    {
        "line": 192,
        "fullcodeline": "if (s->tlsext_heartbeat & SSL_DTLSEXT_HB_DONT_RECV_REQUESTS)"
    },
    {
        "line": 211,
        "fullcodeline": "if (r == SSL_TLSEXT_ERR_OK) {"
    },
    {
        "line": 234,
        "fullcodeline": "if (SSL_IS_DTLS(s) || s->s3->tmp.new_cipher->algorithm_mac == SSL_AEAD"
    },
    {
        "line": 255,
        "fullcodeline": "if (CHECKLEN(ret, 4, limit))"
    },
    {
        "line": 272,
        "fullcodeline": "if (CHECKLEN(ret, 7 + len, limit))"
    },
    {
        "line": 25,
        "fullcodeline": "SSLerr(SSL_F_SSL_ADD_SERVERHELLO_TLSEXT, ERR_R_INTERNAL_ERROR);"
    },
    {
        "line": 41,
        "fullcodeline": "SSLerr(SSL_F_SSL_ADD_SERVERHELLO_TLSEXT, ERR_R_INTERNAL_ERROR);"
    },
    {
        "line": 75,
        "fullcodeline": "SSLerr(SSL_F_SSL_ADD_SERVERHELLO_TLSEXT, ERR_R_INTERNAL_ERROR);"
    },
    {
        "line": 134,
        "fullcodeline": "SSLerr(SSL_F_SSL_ADD_SERVERHELLO_TLSEXT, ERR_R_INTERNAL_ERROR);"
    },
    {
        "line": 149,
        "fullcodeline": "SSLerr(SSL_F_SSL_ADD_SERVERHELLO_TLSEXT, ERR_R_INTERNAL_ERROR);"
    },
    {
        "line": 193,
        "fullcodeline": "*(ret++) = SSL_DTLSEXT_HB_DONT_SEND_REQUESTS;"
    },
    {
        "line": 219,
        "fullcodeline": "s2n(TLSEXT_TYPE_next_proto_neg, ret);"
    },
    {
        "line": 220,
        "fullcodeline": "s2n(npalen, ret);"
    },
    {
        "line": 221,
        "fullcodeline": "memcpy(ret, npa, npalen);"
    },
    {
        "line": 222,
        "fullcodeline": "ret += npalen;"
    },
    {
        "line": 223,
        "fullcodeline": "s->s3->next_proto_neg_seen = 1;"
    },
    {
        "line": 237,
        "fullcodeline": "|| s->s3->tmp.new_cipher->algorithm_enc == SSL_eGOST2814789CNT12)"
    },
    {
        "line": 238,
        "fullcodeline": "s->tlsext_use_etm = 0;"
    },
    {
        "line": 195,
        "fullcodeline": "*(ret++) = SSL_DTLSEXT_HB_ENABLED;"
    },
    {
        "line": 217,
        "fullcodeline": "if (CHECKLEN(ret, 4 + npalen, limit))"
    },
    {
        "line": 236,
        "fullcodeline": "|| s->s3->tmp.new_cipher->algorithm_enc == SSL_eGOST2814789CNT"
    },
    {
        "line": 246,
        "fullcodeline": "s2n(TLSEXT_TYPE_encrypt_then_mac, ret);"
    },
    {
        "line": 247,
        "fullcodeline": "s2n(0, ret);"
    },
    {
        "line": 235,
        "fullcodeline": "|| s->s3->tmp.new_cipher->algorithm_enc == SSL_RC4"
    },
    {
        "line": 244,
        "fullcodeline": "if (CHECKLEN(ret, 4, limit))"
    }
]