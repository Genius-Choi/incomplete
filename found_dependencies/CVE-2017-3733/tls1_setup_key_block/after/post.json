[
    {
        "line": 8,
        "fullcodeline": "int mac_type = NID_undef, mac_secret_size = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "int ret = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "s->s3->tmp.new_sym_enc = c;"
    },
    {
        "line": 21,
        "fullcodeline": "s->s3->tmp.new_hash = hash;"
    },
    {
        "line": 22,
        "fullcodeline": "s->s3->tmp.new_mac_pkey_type = mac_type;"
    },
    {
        "line": 23,
        "fullcodeline": "s->s3->tmp.new_mac_secret_size = mac_secret_size;"
    },
    {
        "line": 24,
        "fullcodeline": "num = EVP_CIPHER_key_length(c) + mac_secret_size + EVP_CIPHER_iv_length(c);"
    },
    {
        "line": 25,
        "fullcodeline": "num *= 2;"
    },
    {
        "line": 27,
        "fullcodeline": "ssl3_cleanup_key_block(s);"
    },
    {
        "line": 34,
        "fullcodeline": "s->s3->tmp.key_block_length = num;"
    },
    {
        "line": 35,
        "fullcodeline": "s->s3->tmp.key_block = p;"
    },
    {
        "line": 90,
        "fullcodeline": "ret = 1;"
    },
    {
        "line": 11,
        "fullcodeline": "if (s->s3->tmp.key_block_length != 0)"
    },
    {
        "line": 14,
        "fullcodeline": "if (!ssl_cipher_get_evp(s->session, &c, &hash, &mac_type, &mac_secret_size,"
    },
    {
        "line": 29,
        "fullcodeline": "if ((p = OPENSSL_malloc(num)) == NULL) {"
    },
    {
        "line": 60,
        "fullcodeline": "if (!tls1_generate_key_block(s, p, num))"
    },
    {
        "line": 71,
        "fullcodeline": "if (!(s->options & SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS)"
    },
    {
        "line": 16,
        "fullcodeline": "SSLerr(SSL_F_TLS1_SETUP_KEY_BLOCK, SSL_R_CIPHER_OR_HASH_UNAVAILABLE);"
    },
    {
        "line": 30,
        "fullcodeline": "SSLerr(SSL_F_TLS1_SETUP_KEY_BLOCK, ERR_R_MALLOC_FAILURE);"
    },
    {
        "line": 72,
        "fullcodeline": "&& s->method->version <= TLS1_VERSION) {"
    },
    {
        "line": 77,
        "fullcodeline": "s->s3->need_empty_fragments = 1;"
    },
    {
        "line": 79,
        "fullcodeline": "if (s->session->cipher != NULL) {"
    },
    {
        "line": 80,
        "fullcodeline": "if (s->session->cipher->algorithm_enc == SSL_eNULL)"
    },
    {
        "line": 84,
        "fullcodeline": "if (s->session->cipher->algorithm_enc == SSL_RC4)"
    },
    {
        "line": 81,
        "fullcodeline": "s->s3->need_empty_fragments = 0;"
    },
    {
        "line": 85,
        "fullcodeline": "s->s3->need_empty_fragments = 0;"
    }
]