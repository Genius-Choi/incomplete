[
    {
        "line": 3,
        "fullcodeline": "DetectLuaData *lua = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "SigMatch *sm = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "int enabled = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "(void)ConfGetBool(\"security.lua.allow-rules\", &enabled);"
    },
    {
        "line": 16,
        "fullcodeline": "lua = DetectLuaParse(de_ctx, str);"
    },
    {
        "line": 24,
        "fullcodeline": "lua->thread_ctx_id = DetectRegisterThreadCtxFuncs(de_ctx, \"lua\","
    },
    {
        "line": 39,
        "fullcodeline": "sm = SigMatchAlloc();"
    },
    {
        "line": 43,
        "fullcodeline": "sm->type = DETECT_LUA;"
    },
    {
        "line": 44,
        "fullcodeline": "sm->ctx = (SigMatchCtx *)lua;"
    },
    {
        "line": 46,
        "fullcodeline": "int list = -1;"
    },
    {
        "line": 112,
        "fullcodeline": "SigMatchAppendSMToList(s, sm, list);"
    },
    {
        "line": 10,
        "fullcodeline": "if (!enabled) {"
    },
    {
        "line": 17,
        "fullcodeline": "if (lua == NULL)"
    },
    {
        "line": 20,
        "fullcodeline": "if (DetectLuaSetupPrime(de_ctx, lua) == -1) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (lua->thread_ctx_id == -1)"
    },
    {
        "line": 30,
        "fullcodeline": "if (lua->alproto != ALPROTO_UNKNOWN) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (sm == NULL)"
    },
    {
        "line": 47,
        "fullcodeline": "if (lua->alproto == ALPROTO_UNKNOWN) {"
    },
    {
        "line": 106,
        "fullcodeline": "if (list == -1) {"
    },
    {
        "line": 117,
        "fullcodeline": "if (lua != NULL)"
    },
    {
        "line": 119,
        "fullcodeline": "if (sm != NULL)"
    },
    {
        "line": 121,
        "fullcodeline": "return -1;"
    },
    {
        "line": 11,
        "fullcodeline": "SCLogError(SC_ERR_NO_LUA_SUPPORT,"
    },
    {
        "line": 34,
        "fullcodeline": "s->alproto = lua->alproto;"
    },
    {
        "line": 31,
        "fullcodeline": "if (s->alproto != ALPROTO_UNKNOWN && !AppProtoEquals(s->alproto, lua->alproto)) {"
    },
    {
        "line": 48,
        "fullcodeline": "if (lua->flags & DATATYPE_STREAM)"
    },
    {
        "line": 108,
        "fullcodeline": "AppLayerGetProtoName(lua->alproto));"
    },
    {
        "line": 49,
        "fullcodeline": "list = DETECT_SM_LIST_PMATCH;"
    },
    {
        "line": 62,
        "fullcodeline": "} else if (lua->alproto == ALPROTO_HTTP) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (lua->flags & DATATYPE_BUFFER) {"
    },
    {
        "line": 63,
        "fullcodeline": "if (lua->flags & DATATYPE_HTTP_RESPONSE_BODY) {"
    },
    {
        "line": 64,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"file_data\");"
    },
    {
        "line": 84,
        "fullcodeline": "} else if (lua->alproto == ALPROTO_DNS) {"
    },
    {
        "line": 52,
        "fullcodeline": "if (DetectBufferGetActiveList(de_ctx, s) != -1) {"
    },
    {
        "line": 59,
        "fullcodeline": "list = DETECT_SM_LIST_MATCH;"
    },
    {
        "line": 53,
        "fullcodeline": "list = s->init_data->list;"
    },
    {
        "line": 65,
        "fullcodeline": "} else if (lua->flags & DATATYPE_HTTP_REQUEST_BODY) {"
    },
    {
        "line": 85,
        "fullcodeline": "if (lua->flags & DATATYPE_DNS_RRNAME) {"
    },
    {
        "line": 66,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"http_client_body\");"
    },
    {
        "line": 86,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"dns_query\");"
    },
    {
        "line": 92,
        "fullcodeline": "} else if (lua->alproto == ALPROTO_TLS) {"
    },
    {
        "line": 93,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"tls_generic\");"
    },
    {
        "line": 67,
        "fullcodeline": "} else if (lua->flags & DATATYPE_HTTP_URI) {"
    },
    {
        "line": 87,
        "fullcodeline": "} else if (lua->flags & DATATYPE_DNS_REQUEST) {"
    },
    {
        "line": 68,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"http_uri\");"
    },
    {
        "line": 88,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"dns_request\");"
    },
    {
        "line": 94,
        "fullcodeline": "} else if (lua->alproto == ALPROTO_SSH) {"
    },
    {
        "line": 95,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"ssh_banner\");"
    },
    {
        "line": 69,
        "fullcodeline": "} else if (lua->flags & DATATYPE_HTTP_URI_RAW) {"
    },
    {
        "line": 89,
        "fullcodeline": "} else if (lua->flags & DATATYPE_DNS_RESPONSE) {"
    },
    {
        "line": 70,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"http_raw_uri\");"
    },
    {
        "line": 90,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"dns_response\");"
    },
    {
        "line": 96,
        "fullcodeline": "} else if (lua->alproto == ALPROTO_SMTP) {"
    },
    {
        "line": 97,
        "fullcodeline": "list = g_smtp_generic_list_id;"
    },
    {
        "line": 71,
        "fullcodeline": "} else if (lua->flags & DATATYPE_HTTP_REQUEST_COOKIE ||"
    },
    {
        "line": 72,
        "fullcodeline": "lua->flags & DATATYPE_HTTP_RESPONSE_COOKIE)"
    },
    {
        "line": 74,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"http_cookie\");"
    },
    {
        "line": 98,
        "fullcodeline": "} else if (lua->alproto == ALPROTO_DNP3) {"
    },
    {
        "line": 99,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"dnp3\");"
    },
    {
        "line": 75,
        "fullcodeline": "} else if (lua->flags & DATATYPE_HTTP_REQUEST_UA) {"
    },
    {
        "line": 76,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"http_user_agent\");"
    },
    {
        "line": 102,
        "fullcodeline": "AppLayerGetProtoName(lua->alproto));"
    },
    {
        "line": 77,
        "fullcodeline": "} else if (lua->flags & (DATATYPE_HTTP_REQUEST_HEADERS|DATATYPE_HTTP_RESPONSE_HEADERS)) {"
    },
    {
        "line": 78,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"http_header\");"
    },
    {
        "line": 79,
        "fullcodeline": "} else if (lua->flags & (DATATYPE_HTTP_REQUEST_HEADERS_RAW|DATATYPE_HTTP_RESPONSE_HEADERS_RAW)) {"
    },
    {
        "line": 80,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"http_raw_header\");"
    },
    {
        "line": 82,
        "fullcodeline": "list = DetectBufferTypeGetByName(\"http_request_line\");"
    }
]