[
    {
        "line": 2,
        "fullcodeline": "auto const type = _request->requestType();"
    },
    {
        "line": 8,
        "fullcodeline": "bool parseSuccess = false;"
    },
    {
        "line": 9,
        "fullcodeline": "VPackSlice slice = this->parseVPackBody(parseSuccess);"
    },
    {
        "line": 18,
        "fullcodeline": "VPackSlice usernameSlice = slice.get(\"username\");"
    },
    {
        "line": 19,
        "fullcodeline": "VPackSlice passwordSlice = slice.get(\"password\");"
    },
    {
        "line": 25,
        "fullcodeline": "std::string const username = usernameSlice.copyString();"
    },
    {
        "line": 26,
        "fullcodeline": "std::string const password = passwordSlice.copyString();"
    },
    {
        "line": 28,
        "fullcodeline": "bool isValid = false;"
    },
    {
        "line": 30,
        "fullcodeline": "auto guard = scopeGuard([&]() {"
    },
    {
        "line": 42,
        "fullcodeline": "auth::UserManager* um = AuthenticationFeature::instance()->userManager();"
    },
    {
        "line": 3,
        "fullcodeline": "if (type != rest::RequestType::POST) {"
    },
    {
        "line": 10,
        "fullcodeline": "if (!parseSuccess) { // error already set"
    },
    {
        "line": 14,
        "fullcodeline": "if (!slice.isObject()) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (!usernameSlice.isString() || !passwordSlice.isString()) {"
    },
    {
        "line": 43,
        "fullcodeline": "if (um == nullptr) {"
    },
    {
        "line": 4,
        "fullcodeline": "generateError(rest::ResponseCode::METHOD_NOT_ALLOWED, TRI_ERROR_HTTP_METHOD_NOT_ALLOWED);"
    },
    {
        "line": 44,
        "fullcodeline": "std::string msg = \"This server does not support users\";"
    },
    {
        "line": 45,
        "fullcodeline": "LOG_TOPIC(\"2e7d4\", ERR, Logger::AUTHENTICATION) << msg;"
    },
    {
        "line": 46,
        "fullcodeline": "generateError(rest::ResponseCode::UNAUTHORIZED, TRI_ERROR_HTTP_UNAUTHORIZED, msg);"
    },
    {
        "line": 15,
        "fullcodeline": "return badRequest();"
    },
    {
        "line": 22,
        "fullcodeline": "return badRequest();"
    },
    {
        "line": 47,
        "fullcodeline": "} else if (um->checkPassword(username, password)) {"
    },
    {
        "line": 54,
        "fullcodeline": "isValid = true;"
    },
    {
        "line": 55,
        "fullcodeline": "generateDocument(resultBuilder.slice(), true, &VPackOptions::Defaults);"
    },
    {
        "line": 50,
        "fullcodeline": "VPackObjectBuilder b(&resultBuilder);"
    },
    {
        "line": 51,
        "fullcodeline": "resultBuilder.add(\"jwt\", VPackValue(generateJwt(username)));"
    },
    {
        "line": 58,
        "fullcodeline": "generateError(rest::ResponseCode::UNAUTHORIZED, TRI_ERROR_HTTP_UNAUTHORIZED,"
    }
]