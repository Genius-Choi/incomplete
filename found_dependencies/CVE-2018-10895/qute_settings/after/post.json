[
    {
        "line": 22,
        "fullcodeline": "src = jinja.render('settings.html', title='settings',"
    },
    {
        "line": 5,
        "fullcodeline": "if url.path() == '/set':"
    },
    {
        "line": 26,
        "fullcodeline": "return 'text/html', src"
    },
    {
        "line": 16,
        "fullcodeline": "csrf_token = secrets.token_urlsafe()"
    },
    {
        "line": 19,
        "fullcodeline": "token = base64.urlsafe_b64encode(os.urandom(32))"
    },
    {
        "line": 20,
        "fullcodeline": "csrf_token = token.rstrip(b'=').decode('ascii')"
    },
    {
        "line": 6,
        "fullcodeline": "if url.password() != csrf_token:"
    },
    {
        "line": 10,
        "fullcodeline": "return _qute_settings_set(url)"
    },
    {
        "line": 7,
        "fullcodeline": "message.error(\"Invalid CSRF token for qute://settings!\")"
    },
    {
        "line": 8,
        "fullcodeline": "raise QuteSchemeError(\"Invalid CSRF token!\","
    }
]