[
    {
        "line": 3,
        "fullcodeline": "struct keyring_search_context *ctx = iterator_data;"
    },
    {
        "line": 4,
        "fullcodeline": "const struct key *key = keyring_ptr_to_key(object);"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned long kflags = READ_ONCE(key->flags);"
    },
    {
        "line": 6,
        "fullcodeline": "short state = READ_ONCE(key->state);"
    },
    {
        "line": 8,
        "fullcodeline": "kenter(\"{%d}\", key->serial);"
    },
    {
        "line": 11,
        "fullcodeline": "if (key->type != ctx->index_key.type) {"
    },
    {
        "line": 17,
        "fullcodeline": "if (ctx->flags & KEYRING_SEARCH_DO_STATE_CHECK) {"
    },
    {
        "line": 58,
        "fullcodeline": "ctx->result = make_key_ref(key, ctx->possessed);"
    },
    {
        "line": 12,
        "fullcodeline": "kleave(\" = 0 [!type]\");"
    },
    {
        "line": 34,
        "fullcodeline": "if (!ctx->match_data.cmp(key, &ctx->match_data)) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (!(ctx->flags & KEYRING_SEARCH_NO_CHECK_PERM) &&"
    },
    {
        "line": 41,
        "fullcodeline": "key_task_permission(make_key_ref(key, ctx->possessed),"
    },
    {
        "line": 25,
        "fullcodeline": "if (key->expiry && ctx->now.tv_sec >= key->expiry) {"
    },
    {
        "line": 43,
        "fullcodeline": "ctx->result = ERR_PTR(-EACCES);"
    },
    {
        "line": 50,
        "fullcodeline": "if (state < 0) {"
    },
    {
        "line": 18,
        "fullcodeline": "if (kflags & ((1 << KEY_FLAG_INVALIDATED) |"
    },
    {
        "line": 19,
        "fullcodeline": "(1 << KEY_FLAG_REVOKED))) {"
    },
    {
        "line": 20,
        "fullcodeline": "ctx->result = ERR_PTR(-EKEYREVOKED);"
    },
    {
        "line": 51,
        "fullcodeline": "ctx->result = ERR_PTR(state);"
    },
    {
        "line": 26,
        "fullcodeline": "if (!(ctx->flags & KEYRING_SEARCH_SKIP_EXPIRED))"
    },
    {
        "line": 27,
        "fullcodeline": "ctx->result = ERR_PTR(-EKEYEXPIRED);"
    }
]