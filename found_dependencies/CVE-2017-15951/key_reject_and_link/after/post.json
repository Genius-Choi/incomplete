[
    {
        "line": 9,
        "fullcodeline": "int ret, awaken, link_ret = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "key_check(key);"
    },
    {
        "line": 12,
        "fullcodeline": "key_check(keyring);"
    },
    {
        "line": 14,
        "fullcodeline": "awaken = 0;"
    },
    {
        "line": 15,
        "fullcodeline": "ret = -EBUSY;"
    },
    {
        "line": 24,
        "fullcodeline": "mutex_lock(&key_construction_mutex);"
    },
    {
        "line": 49,
        "fullcodeline": "mutex_unlock(&key_construction_mutex);"
    },
    {
        "line": 27,
        "fullcodeline": "if (key->state == KEY_IS_UNINSTANTIATED) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (keyring && link_ret == 0)"
    },
    {
        "line": 58,
        "fullcodeline": "return ret == 0 ? link_ret : ret;"
    },
    {
        "line": 21,
        "fullcodeline": "link_ret = __key_link_begin(keyring, &key->index_key, &edit);"
    },
    {
        "line": 30,
        "fullcodeline": "mark_key_instantiated(key, -error);"
    },
    {
        "line": 31,
        "fullcodeline": "now = current_kernel_time();"
    },
    {
        "line": 32,
        "fullcodeline": "key->expiry = now.tv_sec + timeout;"
    },
    {
        "line": 33,
        "fullcodeline": "key_schedule_gc(key->expiry + key_gc_delay);"
    },
    {
        "line": 38,
        "fullcodeline": "ret = 0;"
    },
    {
        "line": 52,
        "fullcodeline": "__key_link_end(keyring, &key->index_key, edit);"
    },
    {
        "line": 56,
        "fullcodeline": "wake_up_bit(&key->flags, KEY_FLAG_USER_CONSTRUCT);"
    },
    {
        "line": 35,
        "fullcodeline": "if (test_and_clear_bit(KEY_FLAG_USER_CONSTRUCT, &key->flags))"
    },
    {
        "line": 41,
        "fullcodeline": "if (keyring && link_ret == 0)"
    },
    {
        "line": 36,
        "fullcodeline": "awaken = 1;"
    },
    {
        "line": 42,
        "fullcodeline": "__key_link(key, &edit);"
    },
    {
        "line": 46,
        "fullcodeline": "key_revoke(authkey);"
    },
    {
        "line": 19,
        "fullcodeline": "return -EPERM;"
    }
]