[
    {
        "line": 4,
        "fullcodeline": "struct key *key = key_ref_to_ptr(key_ref);"
    },
    {
        "line": 8,
        "fullcodeline": "ret = key_permission(key_ref, KEY_NEED_WRITE);"
    },
    {
        "line": 12,
        "fullcodeline": "ret = -EEXIST;"
    },
    {
        "line": 16,
        "fullcodeline": "down_write(&key->sem);"
    },
    {
        "line": 18,
        "fullcodeline": "ret = key->type->update(key, prep);"
    },
    {
        "line": 23,
        "fullcodeline": "up_write(&key->sem);"
    },
    {
        "line": 31,
        "fullcodeline": "key_put(key);"
    },
    {
        "line": 32,
        "fullcodeline": "key_ref = ERR_PTR(ret);"
    },
    {
        "line": 9,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 19,
        "fullcodeline": "if (ret == 0)"
    },
    {
        "line": 25,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 21,
        "fullcodeline": "mark_key_instantiated(key, 0);"
    }
]