[
    {
        "line": 3,
        "fullcodeline": "struct key_user *newowner, *zapowner = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "uid = make_kuid(current_user_ns(), user);"
    },
    {
        "line": 11,
        "fullcodeline": "gid = make_kgid(current_user_ns(), group);"
    },
    {
        "line": 12,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 18,
        "fullcodeline": "ret = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "key_ref = lookup_user_key(id, KEY_LOOKUP_CREATE | KEY_LOOKUP_PARTIAL,"
    },
    {
        "line": 29,
        "fullcodeline": "key = key_ref_to_ptr(key_ref);"
    },
    {
        "line": 32,
        "fullcodeline": "ret = -EACCES;"
    },
    {
        "line": 33,
        "fullcodeline": "down_write(&key->sem);"
    },
    {
        "line": 94,
        "fullcodeline": "ret = 0;"
    },
    {
        "line": 97,
        "fullcodeline": "up_write(&key->sem);"
    },
    {
        "line": 98,
        "fullcodeline": "key_put(key);"
    },
    {
        "line": 105,
        "fullcodeline": "spin_unlock(&newowner->lock);"
    },
    {
        "line": 106,
        "fullcodeline": "zapowner = newowner;"
    },
    {
        "line": 107,
        "fullcodeline": "ret = -EDQUOT;"
    },
    {
        "line": 13,
        "fullcodeline": "if ((user != (uid_t) -1) && !uid_valid(uid))"
    },
    {
        "line": 15,
        "fullcodeline": "if ((group != (gid_t) -1) && !gid_valid(gid))"
    },
    {
        "line": 19,
        "fullcodeline": "if (user == (uid_t) -1 && group == (gid_t) -1)"
    },
    {
        "line": 24,
        "fullcodeline": "if (IS_ERR(key_ref)) {"
    },
    {
        "line": 35,
        "fullcodeline": "if (!capable(CAP_SYS_ADMIN)) {"
    },
    {
        "line": 47,
        "fullcodeline": "if (user != (uid_t) -1 && !uid_eq(uid, key->uid)) {"
    },
    {
        "line": 91,
        "fullcodeline": "if (group != (gid_t) -1)"
    },
    {
        "line": 25,
        "fullcodeline": "ret = PTR_ERR(key_ref);"
    },
    {
        "line": 48,
        "fullcodeline": "ret = -ENOMEM;"
    },
    {
        "line": 49,
        "fullcodeline": "newowner = key_user_lookup(uid);"
    },
    {
        "line": 78,
        "fullcodeline": "atomic_inc(&newowner->nkeys);"
    },
    {
        "line": 85,
        "fullcodeline": "zapowner = key->user;"
    },
    {
        "line": 86,
        "fullcodeline": "key->user = newowner;"
    },
    {
        "line": 87,
        "fullcodeline": "key->uid = uid;"
    },
    {
        "line": 92,
        "fullcodeline": "key->gid = gid;"
    },
    {
        "line": 100,
        "fullcodeline": "key_user_put(zapowner);"
    },
    {
        "line": 37,
        "fullcodeline": "if (user != (uid_t) -1 && !uid_eq(key->uid, uid))"
    },
    {
        "line": 42,
        "fullcodeline": "if (group != (gid_t) -1 && !gid_eq(gid, key->gid) && !in_group_p(gid))"
    },
    {
        "line": 50,
        "fullcodeline": "if (!newowner)"
    },
    {
        "line": 54,
        "fullcodeline": "if (test_bit(KEY_FLAG_IN_QUOTA, &key->flags)) {"
    },
    {
        "line": 80,
        "fullcodeline": "if (key->state != KEY_IS_UNINSTANTIATED) {"
    },
    {
        "line": 55,
        "fullcodeline": "unsigned maxkeys = uid_eq(uid, GLOBAL_ROOT_UID) ?"
    },
    {
        "line": 57,
        "fullcodeline": "unsigned maxbytes = uid_eq(uid, GLOBAL_ROOT_UID) ?"
    },
    {
        "line": 60,
        "fullcodeline": "spin_lock(&newowner->lock);"
    },
    {
        "line": 67,
        "fullcodeline": "newowner->qnkeys++;"
    },
    {
        "line": 68,
        "fullcodeline": "newowner->qnbytes += key->quotalen;"
    },
    {
        "line": 69,
        "fullcodeline": "spin_unlock(&newowner->lock);"
    },
    {
        "line": 73,
        "fullcodeline": "key->user->qnbytes -= key->quotalen;"
    },
    {
        "line": 74,
        "fullcodeline": "spin_unlock(&key->user->lock);"
    },
    {
        "line": 82,
        "fullcodeline": "atomic_inc(&newowner->nikeys);"
    },
    {
        "line": 61,
        "fullcodeline": "if (newowner->qnkeys + 1 >= maxkeys ||"
    },
    {
        "line": 63,
        "fullcodeline": "newowner->qnbytes + key->quotalen <"
    },
    {
        "line": 62,
        "fullcodeline": "newowner->qnbytes + key->quotalen >= maxbytes ||"
    }
]