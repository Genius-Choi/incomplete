[
    {
        "line": 7,
        "fullcodeline": "guint32 signature=0;"
    },
    {
        "line": 8,
        "fullcodeline": "int offset=0;"
    },
    {
        "line": 16,
        "fullcodeline": "usb_conv_info = (usb_conv_info_t *)data;"
    },
    {
        "line": 19,
        "fullcodeline": "usb_ms_conv_info=(usb_ms_conv_info_t *)usb_conv_info->class_data;"
    },
    {
        "line": 31,
        "fullcodeline": "is_request=(pinfo->srcport==NO_ENDPOINT);"
    },
    {
        "line": 33,
        "fullcodeline": "col_set_str(pinfo->cinfo, COL_PROTOCOL, \"USBMS\");"
    },
    {
        "line": 35,
        "fullcodeline": "col_clear(pinfo->cinfo, COL_INFO);"
    },
    {
        "line": 38,
        "fullcodeline": "ti = proto_tree_add_protocol_format(parent_tree, proto_usb_ms, tvb, 0, -1, \"USB Mass Storage\");"
    },
    {
        "line": 39,
        "fullcodeline": "tree = proto_item_add_subtree(ti, ett_usb_ms);"
    },
    {
        "line": 41,
        "fullcodeline": "signature=tvb_get_letohl(tvb, offset);"
    },
    {
        "line": 174,
        "fullcodeline": "itlq=(itlq_nexus_t *)wmem_tree_lookup32_le(usb_ms_conv_info->itlq, pinfo->num);"
    },
    {
        "line": 179,
        "fullcodeline": "itl=(itl_nexus_t *)wmem_tree_lookup32(usb_ms_conv_info->itl, itlq->lun);"
    },
    {
        "line": 184,
        "fullcodeline": "dissect_scsi_payload(tvb, pinfo, parent_tree, is_request, itlq, itl, 0);"
    },
    {
        "line": 14,
        "fullcodeline": "if (data == NULL)"
    },
    {
        "line": 20,
        "fullcodeline": "if(!usb_ms_conv_info){"
    },
    {
        "line": 175,
        "fullcodeline": "if(!itlq){"
    },
    {
        "line": 180,
        "fullcodeline": "if(!itl){"
    },
    {
        "line": 185,
        "fullcodeline": "return tvb_captured_length(tvb);"
    },
    {
        "line": 21,
        "fullcodeline": "usb_ms_conv_info=wmem_new(wmem_file_scope(), usb_ms_conv_info_t);"
    },
    {
        "line": 22,
        "fullcodeline": "usb_ms_conv_info->itl=wmem_tree_new(wmem_file_scope());"
    },
    {
        "line": 23,
        "fullcodeline": "usb_ms_conv_info->itlq=wmem_tree_new(wmem_file_scope());"
    },
    {
        "line": 47,
        "fullcodeline": "if(is_request&&(signature==0x43425355)&&(tvb_reported_length(tvb)==31)){"
    },
    {
        "line": 54,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCBWSignature, tvb, offset, 4, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 55,
        "fullcodeline": "offset+=4;"
    },
    {
        "line": 58,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCBWTag, tvb, offset, 4, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 59,
        "fullcodeline": "offset+=4;"
    },
    {
        "line": 62,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCBWDataTransferLength, tvb, offset, 4, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 63,
        "fullcodeline": "datalen=tvb_get_letohl(tvb, offset);"
    },
    {
        "line": 64,
        "fullcodeline": "offset+=4;"
    },
    {
        "line": 67,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCBWFlags, tvb, offset, 1, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 68,
        "fullcodeline": "flags=tvb_get_guint8(tvb, offset);"
    },
    {
        "line": 69,
        "fullcodeline": "offset+=1;"
    },
    {
        "line": 72,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCBWTarget, tvb, offset, 1, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 73,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCBWLUN, tvb, offset, 1, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 74,
        "fullcodeline": "lun=tvb_get_guint8(tvb, offset)&0x0f;"
    },
    {
        "line": 75,
        "fullcodeline": "offset+=1;"
    },
    {
        "line": 78,
        "fullcodeline": "itl=(itl_nexus_t *)wmem_tree_lookup32(usb_ms_conv_info->itl, lun);"
    },
    {
        "line": 87,
        "fullcodeline": "itlq=(itlq_nexus_t *)wmem_tree_lookup32(usb_ms_conv_info->itlq, pinfo->num);"
    },
    {
        "line": 112,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCBWCBLength, tvb, offset, 1, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 113,
        "fullcodeline": "cdbrlen=tvb_get_guint8(tvb, offset)&0x1f;"
    },
    {
        "line": 114,
        "fullcodeline": "offset+=1;"
    },
    {
        "line": 116,
        "fullcodeline": "cdblen=cdbrlen;"
    },
    {
        "line": 131,
        "fullcodeline": "if((!is_request)&&(signature==0x53425355)&&(tvb_reported_length(tvb)==13)){"
    },
    {
        "line": 135,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCSWSignature, tvb, offset, 4, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 136,
        "fullcodeline": "offset+=4;"
    },
    {
        "line": 139,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCBWTag, tvb, offset, 4, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 140,
        "fullcodeline": "offset+=4;"
    },
    {
        "line": 143,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCSWDataResidue, tvb, offset, 4, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 144,
        "fullcodeline": "offset+=4;"
    },
    {
        "line": 147,
        "fullcodeline": "proto_tree_add_item(tree, hf_usb_ms_dCSWStatus, tvb, offset, 1, ENC_LITTLE_ENDIAN);"
    },
    {
        "line": 148,
        "fullcodeline": "status=tvb_get_guint8(tvb, offset);"
    },
    {
        "line": 151,
        "fullcodeline": "itlq=(itlq_nexus_t *)wmem_tree_lookup32_le(usb_ms_conv_info->itlq, pinfo->num);"
    },
    {
        "line": 155,
        "fullcodeline": "itlq->last_exchange_frame=pinfo->num;"
    },
    {
        "line": 157,
        "fullcodeline": "itl=(itl_nexus_t *)wmem_tree_lookup32(usb_ms_conv_info->itl, itlq->lun);"
    },
    {
        "line": 79,
        "fullcodeline": "if(!itl){"
    },
    {
        "line": 88,
        "fullcodeline": "if(!itlq){"
    },
    {
        "line": 117,
        "fullcodeline": "if(cdblen>tvb_captured_length_remaining(tvb, offset)){"
    },
    {
        "line": 124,
        "fullcodeline": "return tvb_captured_length(tvb);"
    },
    {
        "line": 152,
        "fullcodeline": "if(!itlq){"
    },
    {
        "line": 158,
        "fullcodeline": "if(!itl){"
    },
    {
        "line": 168,
        "fullcodeline": "return tvb_captured_length(tvb);"
    },
    {
        "line": 176,
        "fullcodeline": "return tvb_captured_length(tvb);"
    },
    {
        "line": 181,
        "fullcodeline": "return tvb_captured_length(tvb);"
    },
    {
        "line": 80,
        "fullcodeline": "itl=wmem_new(wmem_file_scope(), itl_nexus_t);"
    },
    {
        "line": 81,
        "fullcodeline": "itl->cmdset=0xff;"
    },
    {
        "line": 82,
        "fullcodeline": "itl->conversation=NULL;"
    },
    {
        "line": 83,
        "fullcodeline": "wmem_tree_insert32(usb_ms_conv_info->itl, lun, itl);"
    },
    {
        "line": 89,
        "fullcodeline": "itlq=wmem_new(wmem_file_scope(), itlq_nexus_t);"
    },
    {
        "line": 90,
        "fullcodeline": "itlq->lun=lun;"
    },
    {
        "line": 91,
        "fullcodeline": "itlq->scsi_opcode=0xffff;"
    },
    {
        "line": 92,
        "fullcodeline": "itlq->task_flags=0;"
    },
    {
        "line": 100,
        "fullcodeline": "itlq->data_length=datalen;"
    },
    {
        "line": 101,
        "fullcodeline": "itlq->bidir_data_length=0;"
    },
    {
        "line": 102,
        "fullcodeline": "itlq->fc_time=pinfo->abs_ts;"
    },
    {
        "line": 103,
        "fullcodeline": "itlq->first_exchange_frame=pinfo->num;"
    },
    {
        "line": 104,
        "fullcodeline": "itlq->last_exchange_frame=0;"
    },
    {
        "line": 105,
        "fullcodeline": "itlq->flags=0;"
    },
    {
        "line": 106,
        "fullcodeline": "itlq->alloc_len=0;"
    },
    {
        "line": 107,
        "fullcodeline": "itlq->extra_data=NULL;"
    },
    {
        "line": 108,
        "fullcodeline": "wmem_tree_insert32(usb_ms_conv_info->itlq, pinfo->num, itlq);"
    },
    {
        "line": 118,
        "fullcodeline": "cdblen=tvb_captured_length_remaining(tvb, offset);"
    },
    {
        "line": 121,
        "fullcodeline": "cdb_tvb=tvb_new_subset(tvb, offset, cdblen, cdbrlen);"
    },
    {
        "line": 122,
        "fullcodeline": "dissect_scsi_cdb(cdb_tvb, pinfo, parent_tree, SCSI_DEV_UNKNOWN, itlq, itl);"
    },
    {
        "line": 163,
        "fullcodeline": "dissect_scsi_rsp(tvb, pinfo, parent_tree, itlq, itl, 0);"
    },
    {
        "line": 153,
        "fullcodeline": "return tvb_captured_length(tvb);"
    },
    {
        "line": 159,
        "fullcodeline": "return tvb_captured_length(tvb);"
    },
    {
        "line": 166,
        "fullcodeline": "dissect_scsi_rsp(tvb, pinfo, parent_tree, itlq, itl, 0x02);"
    },
    {
        "line": 95,
        "fullcodeline": "itlq->task_flags|=SCSI_DATA_READ;"
    },
    {
        "line": 97,
        "fullcodeline": "itlq->task_flags|=SCSI_DATA_WRITE;"
    }
]