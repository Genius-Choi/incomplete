[
    {
        "line": 10,
        "fullcodeline": "char                            *attrs[] = { LDAP_NO_ATTRS, NULL };"
    },
    {
        "line": 11,
        "fullcodeline": "cherokee_validator_ldap_props_t *props   = VAL_LDAP_PROP(ldap);"
    },
    {
        "line": 20,
        "fullcodeline": "size = cherokee_buffer_cnt_cspn (&conn->validator->user, 0, \"*()\");"
    },
    {
        "line": 26,
        "fullcodeline": "ret = init_filter (ldap, props, conn);"
    },
    {
        "line": 32,
        "fullcodeline": "re = ldap_search_s (ldap->conn, props->basedn.buf, LDAP_SCOPE_SUBTREE, ldap->filter.buf, attrs, 0, &message);"
    },
    {
        "line": 39,
        "fullcodeline": "TRACE (ENTRIES, \"subtree search (%s): done\\n\", ldap->filter.buf ? ldap->filter.buf : \"\");"
    },
    {
        "line": 43,
        "fullcodeline": "re = ldap_count_entries (ldap->conn, message);"
    },
    {
        "line": 51,
        "fullcodeline": "first = ldap_first_entry (ldap->conn, message);"
    },
    {
        "line": 59,
        "fullcodeline": "dn = ldap_get_dn (ldap->conn, first);"
    },
    {
        "line": 65,
        "fullcodeline": "ldap_msgfree (message);"
    },
    {
        "line": 69,
        "fullcodeline": "ret = validate_dn (props, dn, conn->validator->passwd.buf);"
    },
    {
        "line": 75,
        "fullcodeline": "re = ldap_unbind_s (ldap->conn);"
    },
    {
        "line": 81,
        "fullcodeline": "TRACE (ENTRIES, \"Access to use %s has been granted\\n\", conn->validator->user.buf);"
    },
    {
        "line": 15,
        "fullcodeline": "if ((conn->validator == NULL) ||"
    },
    {
        "line": 21,
        "fullcodeline": "if (size != conn->validator->user.len)"
    },
    {
        "line": 27,
        "fullcodeline": "if (ret != ret_ok)"
    },
    {
        "line": 33,
        "fullcodeline": "if (re != LDAP_SUCCESS) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (re != 1) {"
    },
    {
        "line": 52,
        "fullcodeline": "if (first == NULL) {"
    },
    {
        "line": 60,
        "fullcodeline": "if (dn == NULL) {"
    },
    {
        "line": 70,
        "fullcodeline": "if (ret != ret_ok)"
    },
    {
        "line": 76,
        "fullcodeline": "if (re != LDAP_SUCCESS)"
    },
    {
        "line": 34,
        "fullcodeline": "LOG_ERROR (CHEROKEE_ERROR_VALIDATOR_LDAP_SEARCH,"
    },
    {
        "line": 45,
        "fullcodeline": "ldap_msgfree (message);"
    },
    {
        "line": 53,
        "fullcodeline": "ldap_msgfree (message);"
    },
    {
        "line": 61,
        "fullcodeline": "ldap_msgfree (message);"
    },
    {
        "line": 35,
        "fullcodeline": "props->filter.buf ? props->filter.buf : \"\");"
    }
]