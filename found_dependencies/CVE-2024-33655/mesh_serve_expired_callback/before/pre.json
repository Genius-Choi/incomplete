[
    {
        "line": 3,
        "fullcodeline": "struct mesh_state* mstate = (struct mesh_state*) arg;"
    },
    {
        "line": 4,
        "fullcodeline": "struct module_qstate* qstate = &mstate->s;"
    },
    {
        "line": 6,
        "fullcodeline": "struct mesh_area* mesh = qstate->env->mesh;"
    },
    {
        "line": 9,
        "fullcodeline": "struct mesh_reply* prev = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "struct sldns_buffer* prev_buffer = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "struct sldns_buffer* r_buffer = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "struct reply_info* partial_rep = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "struct ub_packed_rrset_key* alias_rrset = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "struct reply_info* encode_rep = NULL;"
    },
    {
        "line": 16,
        "fullcodeline": "struct query_info* lookup_qinfo = &qstate->qinfo;"
    },
    {
        "line": 18,
        "fullcodeline": "struct timeval tv = {0, 0};"
    },
    {
        "line": 19,
        "fullcodeline": "int must_validate = (!(qstate->query_flags&BIT_CD)"
    },
    {
        "line": 21,
        "fullcodeline": "int i = 0;"
    },
    {
        "line": 23,
        "fullcodeline": "verbose(VERB_ALGO, \"Serve expired: Trying to reply with expired data\");"
    },
    {
        "line": 22,
        "fullcodeline": "if(!qstate->serve_expired_data) return;"
    },
    {
        "line": 28,
        "fullcodeline": "if(qstate->no_cache_lookup || qstate->is_drop) {"
    },
    {
        "line": 89,
        "fullcodeline": "if(verbosity >= VERB_ALGO)"
    },
    {
        "line": 92,
        "fullcodeline": "for(r = mstate->reply_list; r; r = r->next) {"
    },
    {
        "line": 124,
        "fullcodeline": "if(i > 0) {"
    },
    {
        "line": 38,
        "fullcodeline": "msg = (*qstate->serve_expired_data->get_cached_answer)(qstate,"
    },
    {
        "line": 43,
        "fullcodeline": "encode_rep = msg->rep;"
    },
    {
        "line": 44,
        "fullcodeline": "memset(&actinfo, 0, sizeof(actinfo));"
    },
    {
        "line": 45,
        "fullcodeline": "actinfo.action = respip_none;"
    },
    {
        "line": 46,
        "fullcodeline": "alias_rrset = NULL;"
    },
    {
        "line": 90,
        "fullcodeline": "log_dns_msg(\"Serve expired lookup\", &qstate->qinfo, msg->rep);"
    },
    {
        "line": 93,
        "fullcodeline": "i++;"
    },
    {
        "line": 94,
        "fullcodeline": "tv = r->start_time;"
    },
    {
        "line": 113,
        "fullcodeline": "r_buffer = r->query_reply.c->buffer;"
    },
    {
        "line": 116,
        "fullcodeline": "mesh_send_reply(mstate, LDNS_RCODE_NOERROR, msg->rep,"
    },
    {
        "line": 120,
        "fullcodeline": "prev = r;"
    },
    {
        "line": 121,
        "fullcodeline": "prev_buffer = r_buffer;"
    },
    {
        "line": 140,
        "fullcodeline": "mstate->reply_list = NULL;"
    },
    {
        "line": 150,
        "fullcodeline": "while((c = mstate->cb_list) != NULL) {"
    },
    {
        "line": 158,
        "fullcodeline": "mstate->cb_list = c->next;"
    },
    {
        "line": 162,
        "fullcodeline": "mesh_do_callback(mstate, LDNS_RCODE_NOERROR, msg->rep, c, &tv);"
    },
    {
        "line": 36,
        "fullcodeline": "fptr_ok(fptr_whitelist_serve_expired_lookup("
    },
    {
        "line": 40,
        "fullcodeline": "if(!msg)"
    },
    {
        "line": 58,
        "fullcodeline": "if(!encode_rep || alias_rrset) {"
    },
    {
        "line": 141,
        "fullcodeline": "if(!mstate->reply_list && !mstate->cb_list) {"
    },
    {
        "line": 47,
        "fullcodeline": "if((mesh->use_response_ip || mesh->use_rpz) &&"
    },
    {
        "line": 48,
        "fullcodeline": "!partial_rep && !apply_respip_action(qstate, &qstate->qinfo,"
    },
    {
        "line": 74,
        "fullcodeline": "memset(&qinfo_tmp, 0, sizeof(qinfo_tmp));"
    },
    {
        "line": 75,
        "fullcodeline": "get_cname_target(alias_rrset, &qinfo_tmp.qname,"
    },
    {
        "line": 81,
        "fullcodeline": "qinfo_tmp.qtype = qstate->qinfo.qtype;"
    },
    {
        "line": 82,
        "fullcodeline": "qinfo_tmp.qclass = qstate->qinfo.qclass;"
    },
    {
        "line": 83,
        "fullcodeline": "lookup_qinfo = &qinfo_tmp;"
    },
    {
        "line": 99,
        "fullcodeline": "respip_inform_print(&actinfo, r->qname,"
    },
    {
        "line": 107,
        "fullcodeline": "if (r->edns.edns_present && qstate->env->cfg->ede_serve_expired &&"
    },
    {
        "line": 109,
        "fullcodeline": "edns_opt_list_append_ede(&r->edns.opt_list_out,"
    },
    {
        "line": 115,
        "fullcodeline": "r_buffer = r->query_reply.c->tcp_req_info->spool_buffer;"
    },
    {
        "line": 119,
        "fullcodeline": "tcp_req_info_remove_mesh_state(r->query_reply.c->tcp_req_info, mstate);"
    },
    {
        "line": 126,
        "fullcodeline": "if(actinfo.addrinfo && qstate->env->cfg->stat_extended &&"
    },
    {
        "line": 153,
        "fullcodeline": "if(!mstate->reply_list && mstate->cb_list && !c->next) {"
    },
    {
        "line": 156,
        "fullcodeline": "qstate->env->mesh->num_reply_states--;"
    },
    {
        "line": 159,
        "fullcodeline": "if(!mstate->reply_list && !mstate->cb_list &&"
    },
    {
        "line": 160,
        "fullcodeline": "mstate->super_set.count == 0)"
    },
    {
        "line": 59,
        "fullcodeline": "if(!encode_rep) {"
    },
    {
        "line": 77,
        "fullcodeline": "if(!qinfo_tmp.qname) {"
    },
    {
        "line": 142,
        "fullcodeline": "log_assert(mesh->num_reply_states > 0);"
    },
    {
        "line": 144,
        "fullcodeline": "if(mstate->super_set.count == 0) {"
    },
    {
        "line": 155,
        "fullcodeline": "log_assert(qstate->env->mesh->num_reply_states > 0);"
    },
    {
        "line": 52,
        "fullcodeline": "} else if(partial_rep &&"
    },
    {
        "line": 53,
        "fullcodeline": "!respip_merge_cname(partial_rep, &qstate->qinfo, msg->rep,"
    },
    {
        "line": 64,
        "fullcodeline": "partial_rep = encode_rep;"
    }
]