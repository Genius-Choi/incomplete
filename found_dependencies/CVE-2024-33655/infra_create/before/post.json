[
    {
        "line": 3,
        "fullcodeline": "struct infra_cache* infra = (struct infra_cache*)calloc(1,"
    },
    {
        "line": 5,
        "fullcodeline": "size_t maxmem = cfg->infra_cache_numhosts * (sizeof(struct infra_key)+"
    },
    {
        "line": 10,
        "fullcodeline": "infra->hosts = slabhash_create(cfg->infra_cache_slabs,"
    },
    {
        "line": 17,
        "fullcodeline": "infra->host_ttl = cfg->host_ttl;"
    },
    {
        "line": 18,
        "fullcodeline": "infra->infra_keep_probing = cfg->infra_keep_probing;"
    },
    {
        "line": 19,
        "fullcodeline": "infra_dp_ratelimit = cfg->ratelimit;"
    },
    {
        "line": 20,
        "fullcodeline": "infra->domain_rates = slabhash_create(cfg->ratelimit_slabs,"
    },
    {
        "line": 33,
        "fullcodeline": "infra_ip_ratelimit = cfg->ip_ratelimit;"
    },
    {
        "line": 34,
        "fullcodeline": "infra->client_ip_rates = slabhash_create(cfg->ip_ratelimit_slabs,"
    },
    {
        "line": 7,
        "fullcodeline": "if(!infra) {"
    },
    {
        "line": 13,
        "fullcodeline": "if(!infra->hosts) {"
    },
    {
        "line": 24,
        "fullcodeline": "if(!infra->domain_rates) {"
    },
    {
        "line": 29,
        "fullcodeline": "if(!setup_domain_limits(infra, cfg)) {"
    },
    {
        "line": 37,
        "fullcodeline": "if(!infra->client_ip_rates) {"
    },
    {
        "line": 14,
        "fullcodeline": "free(infra);"
    },
    {
        "line": 25,
        "fullcodeline": "infra_delete(infra);"
    },
    {
        "line": 30,
        "fullcodeline": "infra_delete(infra);"
    },
    {
        "line": 38,
        "fullcodeline": "infra_delete(infra);"
    }
]