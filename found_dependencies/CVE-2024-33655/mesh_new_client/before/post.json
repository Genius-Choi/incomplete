[
    {
        "line": 6,
        "fullcodeline": "struct mesh_state* s = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "int unique = unique_mesh_state(edns->opt_list_in, mesh->env);"
    },
    {
        "line": 8,
        "fullcodeline": "int was_detached = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "int was_noreply = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "int added = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "int timeout = mesh->env->cfg->serve_expired?"
    },
    {
        "line": 132,
        "fullcodeline": "mesh->num_reply_addrs++;"
    },
    {
        "line": 154,
        "fullcodeline": "error_encode(r_buffer, LDNS_RCODE_SERVFAIL,"
    },
    {
        "line": 156,
        "fullcodeline": "comm_point_send_reply(rep);"
    },
    {
        "line": 17,
        "fullcodeline": "if(!unique)"
    },
    {
        "line": 20,
        "fullcodeline": "if(!s || s->list_select == mesh_no_list) {"
    },
    {
        "line": 41,
        "fullcodeline": "if(!s) {"
    },
    {
        "line": 88,
        "fullcodeline": "if(!s->reply_list && !s->cb_list) {"
    },
    {
        "line": 95,
        "fullcodeline": "if(!mesh_state_add_reply(s, edns, rep, qid, qflags, qinfo)) {"
    },
    {
        "line": 109,
        "fullcodeline": "if(timeout && !mesh_serve_expired_init(s, timeout)) {"
    },
    {
        "line": 133,
        "fullcodeline": "if(s->list_select == mesh_no_list) {"
    },
    {
        "line": 151,
        "fullcodeline": "if(!inplace_cb_reply_servfail_call(mesh->env, qinfo, &s->s,"
    },
    {
        "line": 18,
        "fullcodeline": "s = mesh_area_find(mesh, cinfo, qinfo, qflags&(BIT_RD|BIT_CD), 0, 0);"
    },
    {
        "line": 45,
        "fullcodeline": "s = mesh_state_create(mesh->env, qinfo, cinfo,"
    },
    {
        "line": 58,
        "fullcodeline": "mesh->num_detached_states++;"
    },
    {
        "line": 61,
        "fullcodeline": "s->s.rpz_passthru = rpz_passthru;"
    },
    {
        "line": 82,
        "fullcodeline": "(void)"
    },
    {
        "line": 85,
        "fullcodeline": "log_assert(n != NULL);"
    },
    {
        "line": 86,
        "fullcodeline": "added = 1;"
    },
    {
        "line": 89,
        "fullcodeline": "was_noreply = 1;"
    },
    {
        "line": 96,
        "fullcodeline": "log_err(\"mesh_new_client: out of memory; SERVFAIL\");"
    },
    {
        "line": 106,
        "fullcodeline": "http2_stream_add_meshstate(rep->c->h2_stream, mesh, s);"
    },
    {
        "line": 110,
        "fullcodeline": "log_err(\"mesh_new_client: out of memory initializing serve expired\");"
    },
    {
        "line": 126,
        "fullcodeline": "log_assert(mesh->num_detached_states > 0);"
    },
    {
        "line": 127,
        "fullcodeline": "mesh->num_detached_states--;"
    },
    {
        "line": 130,
        "fullcodeline": "mesh->num_reply_states ++;"
    },
    {
        "line": 147,
        "fullcodeline": "mesh_run(mesh, s, module_event_new, NULL);"
    },
    {
        "line": 153,
        "fullcodeline": "edns->opt_list_inplace_cb_out = NULL;"
    },
    {
        "line": 158,
        "fullcodeline": "mesh_state_delete(&s->s);"
    },
    {
        "line": 21,
        "fullcodeline": "if(!mesh_make_new_space(mesh, rep->c->buffer)) {"
    },
    {
        "line": 47,
        "fullcodeline": "if(!s) {"
    },
    {
        "line": 84,
        "fullcodeline": "rbtree_insert(&mesh->all, &s->node);"
    },
    {
        "line": 90,
        "fullcodeline": "if(s->super_set.count == 0) {"
    },
    {
        "line": 100,
        "fullcodeline": "if(!tcp_req_info_add_meshstate(rep->c->tcp_req_info, mesh, s)) {"
    },
    {
        "line": 135,
        "fullcodeline": "if(mesh->num_forever_states < mesh->max_forever_states) {"
    },
    {
        "line": 22,
        "fullcodeline": "verbose(VERB_ALGO, \"Too many queries. dropping \""
    },
    {
        "line": 24,
        "fullcodeline": "comm_point_drop_reply(rep);"
    },
    {
        "line": 25,
        "fullcodeline": "mesh->stats_dropped++;"
    },
    {
        "line": 32,
        "fullcodeline": "if(mesh->num_reply_addrs > mesh->max_reply_states*16) {"
    },
    {
        "line": 46,
        "fullcodeline": "qflags&(BIT_RD|BIT_CD), 0, 0);"
    },
    {
        "line": 48,
        "fullcodeline": "log_err(\"mesh_state_create: out of memory; SERVFAIL\");"
    },
    {
        "line": 52,
        "fullcodeline": "error_encode(r_buffer, LDNS_RCODE_SERVFAIL,"
    },
    {
        "line": 54,
        "fullcodeline": "comm_point_send_reply(rep);"
    },
    {
        "line": 60,
        "fullcodeline": "mesh_state_make_unique(s);"
    },
    {
        "line": 64,
        "fullcodeline": "s->s.edns_opts_front_in = edns_opt_copy_region(edns->opt_list_in,"
    },
    {
        "line": 91,
        "fullcodeline": "was_detached = 1;"
    },
    {
        "line": 101,
        "fullcodeline": "log_err(\"mesh_new_client: out of memory add tcpreqinfo\");"
    },
    {
        "line": 136,
        "fullcodeline": "mesh->num_forever_states ++;"
    },
    {
        "line": 137,
        "fullcodeline": "mesh_list_insert(s, &mesh->forever_first,"
    },
    {
        "line": 139,
        "fullcodeline": "s->list_select = mesh_forever_list;"
    },
    {
        "line": 33,
        "fullcodeline": "verbose(VERB_ALGO, \"Too many requests queued. \""
    },
    {
        "line": 35,
        "fullcodeline": "comm_point_drop_reply(rep);"
    },
    {
        "line": 36,
        "fullcodeline": "mesh->stats_dropped++;"
    },
    {
        "line": 49,
        "fullcodeline": "if(!inplace_cb_reply_servfail_call(mesh->env, qinfo, NULL, NULL,"
    },
    {
        "line": 66,
        "fullcodeline": "if(!s->s.edns_opts_front_in) {"
    },
    {
        "line": 141,
        "fullcodeline": "mesh_list_insert(s, &mesh->jostle_first,"
    },
    {
        "line": 143,
        "fullcodeline": "s->list_select = mesh_jostle_list;"
    },
    {
        "line": 51,
        "fullcodeline": "edns->opt_list_inplace_cb_out = NULL;"
    },
    {
        "line": 67,
        "fullcodeline": "log_err(\"edns_opt_copy_region: out of memory; SERVFAIL\");"
    },
    {
        "line": 71,
        "fullcodeline": "error_encode(r_buffer, LDNS_RCODE_SERVFAIL,"
    },
    {
        "line": 73,
        "fullcodeline": "comm_point_send_reply(rep);"
    },
    {
        "line": 74,
        "fullcodeline": "mesh_state_delete(&s->s);"
    },
    {
        "line": 68,
        "fullcodeline": "if(!inplace_cb_reply_servfail_call(mesh->env, qinfo, NULL,"
    },
    {
        "line": 70,
        "fullcodeline": "edns->opt_list_inplace_cb_out = NULL;"
    }
]