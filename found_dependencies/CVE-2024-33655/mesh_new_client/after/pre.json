[
    {
        "line": 6,
        "fullcodeline": "struct mesh_state* s = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "int unique = unique_mesh_state(edns->opt_list_in, mesh->env);"
    },
    {
        "line": 8,
        "fullcodeline": "int was_detached = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "int was_noreply = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "int added = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "int timeout = mesh->env->cfg->serve_expired?"
    },
    {
        "line": 13,
        "fullcodeline": "struct sldns_buffer* r_buffer = rep->c->buffer;"
    },
    {
        "line": 142,
        "fullcodeline": "mesh->num_reply_addrs++;"
    },
    {
        "line": 17,
        "fullcodeline": "if(!infra_wait_limit_allowed(mesh->env->infra_cache, rep,"
    },
    {
        "line": 49,
        "fullcodeline": "if(!s) {"
    },
    {
        "line": 143,
        "fullcodeline": "if(s->list_select == mesh_no_list) {"
    },
    {
        "line": 15,
        "fullcodeline": "r_buffer = rep->c->tcp_req_info->spool_buffer;"
    },
    {
        "line": 19,
        "fullcodeline": "verbose(VERB_ALGO, \"Too many queries waiting from the IP. \""
    },
    {
        "line": 21,
        "fullcodeline": "comm_point_drop_reply(rep);"
    },
    {
        "line": 22,
        "fullcodeline": "mesh->stats_dropped++;"
    },
    {
        "line": 26,
        "fullcodeline": "s = mesh_area_find(mesh, cinfo, qinfo, qflags&(BIT_RD|BIT_CD), 0, 0);"
    },
    {
        "line": 28,
        "fullcodeline": "if(!s || s->list_select == mesh_no_list) {"
    },
    {
        "line": 53,
        "fullcodeline": "s = mesh_state_create(mesh->env, qinfo, cinfo,"
    },
    {
        "line": 66,
        "fullcodeline": "mesh->num_detached_states++;"
    },
    {
        "line": 69,
        "fullcodeline": "s->s.rpz_passthru = rpz_passthru;"
    },
    {
        "line": 96,
        "fullcodeline": "if(!s->reply_list && !s->cb_list) {"
    },
    {
        "line": 103,
        "fullcodeline": "if(!mesh_state_add_reply(s, edns, rep, qid, qflags, qinfo)) {"
    },
    {
        "line": 114,
        "fullcodeline": "http2_stream_add_meshstate(rep->c->h2_stream, mesh, s);"
    },
    {
        "line": 117,
        "fullcodeline": "if(timeout && !mesh_serve_expired_init(s, timeout)) {"
    },
    {
        "line": 137,
        "fullcodeline": "mesh->num_detached_states--;"
    },
    {
        "line": 140,
        "fullcodeline": "mesh->num_reply_states ++;"
    },
    {
        "line": 157,
        "fullcodeline": "mesh_run(mesh, s, module_event_new, NULL);"
    },
    {
        "line": 161,
        "fullcodeline": "if(!inplace_cb_reply_servfail_call(mesh->env, qinfo, &s->s,"
    },
    {
        "line": 163,
        "fullcodeline": "edns->opt_list_inplace_cb_out = NULL;"
    },
    {
        "line": 55,
        "fullcodeline": "if(!s) {"
    },
    {
        "line": 92,
        "fullcodeline": "rbtree_insert(&mesh->all, &s->node);"
    },
    {
        "line": 93,
        "fullcodeline": "log_assert(n != NULL);"
    },
    {
        "line": 136,
        "fullcodeline": "log_assert(mesh->num_detached_states > 0);"
    },
    {
        "line": 145,
        "fullcodeline": "if(mesh->num_forever_states < mesh->max_forever_states) {"
    },
    {
        "line": 29,
        "fullcodeline": "if(!mesh_make_new_space(mesh, rep->c->buffer)) {"
    },
    {
        "line": 40,
        "fullcodeline": "if(mesh->num_reply_addrs > mesh->max_reply_states*16) {"
    },
    {
        "line": 54,
        "fullcodeline": "qflags&(BIT_RD|BIT_CD), 0, 0);"
    },
    {
        "line": 68,
        "fullcodeline": "mesh_state_make_unique(s);"
    },
    {
        "line": 72,
        "fullcodeline": "s->s.edns_opts_front_in = edns_opt_copy_region(edns->opt_list_in,"
    },
    {
        "line": 108,
        "fullcodeline": "if(!tcp_req_info_add_meshstate(rep->c->tcp_req_info, mesh, s)) {"
    },
    {
        "line": 146,
        "fullcodeline": "mesh->num_forever_states ++;"
    },
    {
        "line": 147,
        "fullcodeline": "mesh_list_insert(s, &mesh->forever_first,"
    },
    {
        "line": 149,
        "fullcodeline": "s->list_select = mesh_forever_list;"
    },
    {
        "line": 74,
        "fullcodeline": "if(!s->s.edns_opts_front_in) {"
    },
    {
        "line": 151,
        "fullcodeline": "mesh_list_insert(s, &mesh->jostle_first,"
    },
    {
        "line": 153,
        "fullcodeline": "s->list_select = mesh_jostle_list;"
    },
    {
        "line": 57,
        "fullcodeline": "if(!inplace_cb_reply_servfail_call(mesh->env, qinfo, NULL, NULL,"
    },
    {
        "line": 59,
        "fullcodeline": "edns->opt_list_inplace_cb_out = NULL;"
    },
    {
        "line": 76,
        "fullcodeline": "if(!inplace_cb_reply_servfail_call(mesh->env, qinfo, NULL,"
    },
    {
        "line": 78,
        "fullcodeline": "edns->opt_list_inplace_cb_out = NULL;"
    }
]