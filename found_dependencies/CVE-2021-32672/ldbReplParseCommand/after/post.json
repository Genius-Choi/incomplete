[
    {
        "line": 2,
        "fullcodeline": "static char* protocol_error = \"protocol error\";"
    },
    {
        "line": 3,
        "fullcodeline": "sds *argv = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "int argc = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "sds copy = sdsdup(ldb.cbuf);"
    },
    {
        "line": 10,
        "fullcodeline": "char *p = copy;"
    },
    {
        "line": 17,
        "fullcodeline": "p = strchr(p,'*'); if (!p) goto protoerr;"
    },
    {
        "line": 18,
        "fullcodeline": "char *plen = p+1; /* Multi bulk len pointer. */"
    },
    {
        "line": 19,
        "fullcodeline": "p = strstr(p,\"\\r\\n\"); if (!p) goto keep_reading;"
    },
    {
        "line": 20,
        "fullcodeline": "*p = '\\0'; p += 2;"
    },
    {
        "line": 21,
        "fullcodeline": "*argcp = atoi(plen);"
    },
    {
        "line": 25,
        "fullcodeline": "argv = zmalloc(sizeof(sds)*(*argcp));"
    },
    {
        "line": 26,
        "fullcodeline": "argc = 0;"
    },
    {
        "line": 43,
        "fullcodeline": "sdsfree(copy);"
    },
    {
        "line": 47,
        "fullcodeline": "*err = protocol_error;"
    },
    {
        "line": 49,
        "fullcodeline": "sdsfreesplitres(argv,argc);"
    },
    {
        "line": 50,
        "fullcodeline": "sdsfree(copy);"
    },
    {
        "line": 5,
        "fullcodeline": "if (sdslen(ldb.cbuf) == 0) return NULL;"
    },
    {
        "line": 22,
        "fullcodeline": "if (*argcp <= 0 || *argcp > 1024) goto protoerr;"
    },
    {
        "line": 27,
        "fullcodeline": "while(argc < *argcp) {"
    },
    {
        "line": 32,
        "fullcodeline": "plen = p+1; /* Bulk string len pointer. */"
    },
    {
        "line": 33,
        "fullcodeline": "p = strstr(p,\"\\r\\n\"); if (!p) goto keep_reading;"
    },
    {
        "line": 34,
        "fullcodeline": "*p = '\\0'; p += 2;"
    },
    {
        "line": 35,
        "fullcodeline": "int slen = atoi(plen); /* Length of this arg. */"
    },
    {
        "line": 38,
        "fullcodeline": "argv[argc++] = sdsnewlen(p,slen);"
    },
    {
        "line": 39,
        "fullcodeline": "p += slen; /* Skip the already parsed argument. */"
    },
    {
        "line": 41,
        "fullcodeline": "p += 2; /* Skip \\r\\n. */"
    },
    {
        "line": 29,
        "fullcodeline": "if (*p == '\\0') goto keep_reading;"
    },
    {
        "line": 31,
        "fullcodeline": "if (*p != '$') goto protoerr;"
    },
    {
        "line": 36,
        "fullcodeline": "if (slen <= 0 || slen > 1024) goto protoerr;"
    },
    {
        "line": 37,
        "fullcodeline": "if ((size_t)(p + slen + 2 - copy) > sdslen(copy) ) goto keep_reading;"
    },
    {
        "line": 40,
        "fullcodeline": "if (p[0] != '\\r' || p[1] != '\\n') goto protoerr;"
    }
]