[
    {
        "line": 3,
        "fullcodeline": "enum SCP_SERVER_STATES_E result = SCP_SERVER_STATE_OK;"
    },
    {
        "line": 4,
        "fullcodeline": "struct SCP_SESSION *session = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "tui32 version = 0;"
    },
    {
        "line": 50,
        "fullcodeline": "(*s) = session;"
    },
    {
        "line": 7,
        "fullcodeline": "if (!skipVchk)"
    },
    {
        "line": 29,
        "fullcodeline": "if (result == SCP_SERVER_STATE_OK)"
    },
    {
        "line": 9,
        "fullcodeline": "LOG_DBG(\"[v0:%d] starting connection\", __LINE__);"
    },
    {
        "line": 31,
        "fullcodeline": "session = scp_session_create();"
    },
    {
        "line": 11,
        "fullcodeline": "if (0 == scp_tcp_force_recv(c->in_sck, c->in_s->data, 8))"
    },
    {
        "line": 32,
        "fullcodeline": "if (NULL == session)"
    },
    {
        "line": 13,
        "fullcodeline": "c->in_s->end = c->in_s->data + 8;"
    },
    {
        "line": 14,
        "fullcodeline": "in_uint32_be(c->in_s, version);"
    },
    {
        "line": 34,
        "fullcodeline": "log_message(LOG_LEVEL_WARNING,"
    },
    {
        "line": 37,
        "fullcodeline": "result = SCP_SERVER_STATE_INTERNAL_ERR;"
    },
    {
        "line": 16,
        "fullcodeline": "if (version != 0)"
    },
    {
        "line": 24,
        "fullcodeline": "log_message(LOG_LEVEL_WARNING, \"[v0:%d] connection aborted: network error\", __LINE__);"
    },
    {
        "line": 25,
        "fullcodeline": "result = SCP_SERVER_STATE_NETWORK_ERR;"
    },
    {
        "line": 41,
        "fullcodeline": "result = scp_v0s_init_session(c, session);"
    },
    {
        "line": 18,
        "fullcodeline": "log_message(LOG_LEVEL_WARNING, \"[v0:%d] connection aborted: version error\", __LINE__);"
    },
    {
        "line": 19,
        "fullcodeline": "result = SCP_SERVER_STATE_VERSION_ERR;"
    },
    {
        "line": 42,
        "fullcodeline": "if (result != SCP_SERVER_STATE_OK)"
    },
    {
        "line": 44,
        "fullcodeline": "scp_session_destroy(session);"
    },
    {
        "line": 45,
        "fullcodeline": "session = NULL;"
    }
]