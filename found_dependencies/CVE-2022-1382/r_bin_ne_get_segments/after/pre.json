[
    {
        "line": 6,
        "fullcodeline": "RList *segments = r_list_newf (free);"
    },
    {
        "line": 3,
        "fullcodeline": "if (!bin || !bin->segment_entries) {"
    },
    {
        "line": 7,
        "fullcodeline": "for (i = 0; i < bin->ne_header->SegCount; i++) {"
    },
    {
        "line": 8,
        "fullcodeline": "RBinSection *bs = R_NEW0 (RBinSection);"
    },
    {
        "line": 12,
        "fullcodeline": "NE_image_segment_entry *se = &bin->segment_entries[i];"
    },
    {
        "line": 13,
        "fullcodeline": "bs->size = se->length;"
    },
    {
        "line": 14,
        "fullcodeline": "bs->vsize = se->minAllocSz ? se->minAllocSz : 64000;"
    },
    {
        "line": 15,
        "fullcodeline": "bs->bits = R_SYS_BITS_16;"
    },
    {
        "line": 16,
        "fullcodeline": "bs->is_data = se->flags & IS_DATA;"
    },
    {
        "line": 17,
        "fullcodeline": "bs->perm = __translate_perms (se->flags);"
    },
    {
        "line": 18,
        "fullcodeline": "bs->paddr = (ut64)se->offset * bin->alignment;"
    },
    {
        "line": 20,
        "fullcodeline": "bs->is_segment = true;"
    },
    {
        "line": 21,
        "fullcodeline": "r_list_append (segments, bs);"
    },
    {
        "line": 9,
        "fullcodeline": "if (!bs) {"
    }
]