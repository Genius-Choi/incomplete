[
    {
        "line": 5,
        "fullcodeline": "krb5_keyblock * subkey = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "krb5_keyblock *header_key = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "krb5_keyblock *stkt_server_key = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "krb5_db_entry *server = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "krb5_db_entry *stkt_server = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "krb5_ticket ticket_reply, *header_ticket = 0;"
    },
    {
        "line": 15,
        "fullcodeline": "const krb5_ticket *stkt = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "int newtransited = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "krb5_error_code retval = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "krb5_timestamp kdc_time, authtime = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "krb5_keyblock *reply_key = NULL;"
    },
    {
        "line": 23,
        "fullcodeline": "krb5_principal cprinc = NULL, sprinc = NULL, altcprinc = NULL;"
    },
    {
        "line": 25,
        "fullcodeline": "krb5_principal stkt_authdata_client = NULL;"
    },
    {
        "line": 26,
        "fullcodeline": "krb5_last_req_entry *nolrarray[2], nolrentry;"
    },
    {
        "line": 28,
        "fullcodeline": "const char        *status = 0;"
    },
    {
        "line": 29,
        "fullcodeline": "krb5_enc_tkt_part *header_enc_tkt = NULL; /* TGT */"
    },
    {
        "line": 30,
        "fullcodeline": "krb5_enc_tkt_part *subject_tkt = NULL; /* TGT or evidence ticket */"
    },
    {
        "line": 31,
        "fullcodeline": "krb5_db_entry *client = NULL, *header_server = NULL;"
    },
    {
        "line": 32,
        "fullcodeline": "krb5_db_entry *local_tgt, *local_tgt_storage = NULL;"
    },
    {
        "line": 33,
        "fullcodeline": "krb5_pa_s4u_x509_user *s4u_x509_user = NULL; /* protocol transition request */"
    },
    {
        "line": 34,
        "fullcodeline": "krb5_authdata **kdc_issued_auth_data = NULL; /* auth data issued by KDC */"
    },
    {
        "line": 35,
        "fullcodeline": "unsigned int c_flags = 0, s_flags = 0;       /* client/server KDB flags */"
    },
    {
        "line": 37,
        "fullcodeline": "const char *emsg = NULL;"
    },
    {
        "line": 38,
        "fullcodeline": "krb5_kvno ticket_kvno = 0;"
    },
    {
        "line": 39,
        "fullcodeline": "struct kdc_request_state *state = NULL;"
    },
    {
        "line": 42,
        "fullcodeline": "krb5_pa_data **e_data = NULL;"
    },
    {
        "line": 43,
        "fullcodeline": "krb5_audit_state *au_state = NULL;"
    },
    {
        "line": 44,
        "fullcodeline": "krb5_data **auth_indicators = NULL;"
    },
    {
        "line": 45,
        "fullcodeline": "void *ad_info = NULL, *stkt_ad_info = NULL;"
    },
    {
        "line": 47,
        "fullcodeline": "memset(&reply, 0, sizeof(reply));"
    },
    {
        "line": 48,
        "fullcodeline": "memset(&reply_encpart, 0, sizeof(reply_encpart));"
    },
    {
        "line": 49,
        "fullcodeline": "memset(&ticket_reply, 0, sizeof(ticket_reply));"
    },
    {
        "line": 50,
        "fullcodeline": "memset(&enc_tkt_reply, 0, sizeof(enc_tkt_reply));"
    },
    {
        "line": 51,
        "fullcodeline": "memset(&server_keyblock, 0, sizeof(server_keyblock));"
    },
    {
        "line": 52,
        "fullcodeline": "memset(&local_tgt_key, 0, sizeof(local_tgt_key));"
    },
    {
        "line": 53,
        "fullcodeline": "session_key.contents = NULL;"
    },
    {
        "line": 57,
        "fullcodeline": "sprinc = request->server;"
    },
    {
        "line": 64,
        "fullcodeline": "errcode = kdc_make_rstate(kdc_active_realm, &state);"
    },
    {
        "line": 69,
        "fullcodeline": "errcode = kau_init_kdc_req(kdc_context, request, from, &au_state);"
    },
    {
        "line": 74,
        "fullcodeline": "kau_tgs_req(kdc_context, TRUE, au_state);"
    },
    {
        "line": 76,
        "fullcodeline": "errcode = kdc_process_tgs_req(kdc_active_realm,"
    },
    {
        "line": 92,
        "fullcodeline": "errcode = kau_make_tkt_id(kdc_context, header_ticket,"
    },
    {
        "line": 97,
        "fullcodeline": "scratch.length = pa_tgs_req->length;"
    },
    {
        "line": 98,
        "fullcodeline": "scratch.data = (char *) pa_tgs_req->contents;"
    },
    {
        "line": 99,
        "fullcodeline": "errcode = kdc_find_fast(&request, &scratch, subkey,"
    },
    {
        "line": 102,
        "fullcodeline": "sprinc = request->server;"
    },
    {
        "line": 108,
        "fullcodeline": "errcode = get_local_tgt(kdc_context, &sprinc->realm, header_server,"
    },
    {
        "line": 116,
        "fullcodeline": "au_state->request = request;"
    },
    {
        "line": 124,
        "fullcodeline": "header_enc_tkt = header_ticket->enc_part2;"
    },
    {
        "line": 132,
        "fullcodeline": "au_state->stage = SRVC_PRINC;"
    },
    {
        "line": 142,
        "fullcodeline": "errcode = search_sprinc(kdc_active_realm, request, s_flags, &server,"
    },
    {
        "line": 146,
        "fullcodeline": "sprinc = server->princ;"
    },
    {
        "line": 150,
        "fullcodeline": "is_referral = is_cross_tgs_principal(server->princ) &&"
    },
    {
        "line": 153,
        "fullcodeline": "au_state->stage = VALIDATE_POL;"
    },
    {
        "line": 158,
        "fullcodeline": "is_crossrealm = !data_eq(header_server->princ->realm, sprinc->realm);"
    },
    {
        "line": 165,
        "fullcodeline": "errcode = kdc_process_s4u2self_req(kdc_active_realm, request, server,"
    },
    {
        "line": 177,
        "fullcodeline": "errcode = decrypt_2ndtkt(kdc_active_realm, request, c_flags,"
    },
    {
        "line": 182,
        "fullcodeline": "retval = validate_tgs_request(kdc_active_realm, request, server,"
    },
    {
        "line": 209,
        "fullcodeline": "errcode = krb5_db_get_authdata_info(kdc_context, c_flags,"
    },
    {
        "line": 258,
        "fullcodeline": "au_state->stage = ISSUE_TKT;"
    },
    {
        "line": 260,
        "fullcodeline": "errcode = gen_session_key(kdc_active_realm, request, server, &session_key,"
    },
    {
        "line": 281,
        "fullcodeline": "authtime = subject_tkt->times.authtime;"
    },
    {
        "line": 305,
        "fullcodeline": "enc_tkt_reply.flags = get_ticket_flags(request->kdc_options, client,"
    },
    {
        "line": 318,
        "fullcodeline": "enc_tkt_reply.caddrs = header_enc_tkt->caddrs;"
    },
    {
        "line": 320,
        "fullcodeline": "reply_encpart.caddrs = 0;/* optional...don't put it in */"
    },
    {
        "line": 321,
        "fullcodeline": "reply_encpart.enc_padata = NULL;"
    },
    {
        "line": 381,
        "fullcodeline": "kdc_get_ticket_renewtime(kdc_active_realm, request, header_enc_tkt, client,"
    },
    {
        "line": 384,
        "fullcodeline": "errcode = check_kdcpolicy_tgs(kdc_context, request, server, header_ticket,"
    },
    {
        "line": 393,
        "fullcodeline": "enc_tkt_reply.times.authtime = authtime;"
    },
    {
        "line": 449,
        "fullcodeline": "enc_tkt_reply.session = &session_key;"
    },
    {
        "line": 450,
        "fullcodeline": "enc_tkt_reply.transited.tr_type = KRB5_DOMAIN_X500_COMPRESS;"
    },
    {
        "line": 451,
        "fullcodeline": "enc_tkt_reply.transited.tr_contents = empty_string; /* equivalent of \"\" */"
    },
    {
        "line": 508,
        "fullcodeline": "errcode = handle_authdata(kdc_context, c_flags, client, server,"
    },
    {
        "line": 522,
        "fullcodeline": "ticket_reply.enc_part2 = &enc_tkt_reply;"
    },
    {
        "line": 534,
        "fullcodeline": "errcode = krb5_encrypt_tkt_part(kdc_context, encrypting_key,"
    },
    {
        "line": 540,
        "fullcodeline": "au_state->stage = ENCR_REP;"
    },
    {
        "line": 541,
        "fullcodeline": "reply.msg_type = KRB5_TGS_REP;"
    },
    {
        "line": 558,
        "fullcodeline": "reply.client = enc_tkt_reply.client;"
    },
    {
        "line": 560,
        "fullcodeline": "reply.ticket = &ticket_reply;"
    },
    {
        "line": 562,
        "fullcodeline": "reply_encpart.session = &session_key;"
    },
    {
        "line": 563,
        "fullcodeline": "reply_encpart.nonce = request->nonce;"
    },
    {
        "line": 566,
        "fullcodeline": "reply_encpart.times = enc_tkt_reply.times;"
    },
    {
        "line": 568,
        "fullcodeline": "nolrentry.lr_type = KRB5_LRQ_NONE;"
    },
    {
        "line": 569,
        "fullcodeline": "nolrentry.value = 0;"
    },
    {
        "line": 570,
        "fullcodeline": "nolrentry.magic = 0;"
    },
    {
        "line": 571,
        "fullcodeline": "nolrarray[0] = &nolrentry;"
    },
    {
        "line": 572,
        "fullcodeline": "nolrarray[1] = 0;"
    },
    {
        "line": 573,
        "fullcodeline": "reply_encpart.last_req = nolrarray;        /* not available for TGS reqs */"
    },
    {
        "line": 574,
        "fullcodeline": "reply_encpart.key_exp = 0;/* ditto */"
    },
    {
        "line": 575,
        "fullcodeline": "reply_encpart.flags = enc_tkt_reply.flags;"
    },
    {
        "line": 576,
        "fullcodeline": "reply_encpart.server = ticket_reply.server;"
    },
    {
        "line": 582,
        "fullcodeline": "errcode  = kdc_fast_response_handle_padata(state, request, &reply,"
    },
    {
        "line": 586,
        "fullcodeline": "errcode =kdc_fast_handle_reply_key(state,"
    },
    {
        "line": 590,
        "fullcodeline": "errcode = return_enc_padata(kdc_context, pkt, request,"
    },
    {
        "line": 600,
        "fullcodeline": "errcode = kau_make_tkt_id(kdc_context, &ticket_reply, &au_state->tkt_out_id);"
    },
    {
        "line": 606,
        "fullcodeline": "errcode = krb5_encode_kdc_rep(kdc_context, KRB5_TGS_REP, &reply_encpart,"
    },
    {
        "line": 613,
        "fullcodeline": "memset(ticket_reply.enc_part.ciphertext.data, 0,"
    },
    {
        "line": 618,
        "fullcodeline": "memset(reply.enc_part.ciphertext.data, 0,"
    },
    {
        "line": 625,
        "fullcodeline": "krb5_free_keyblock_contents(kdc_context, &server_keyblock);"
    },
    {
        "line": 641,
        "fullcodeline": "log_tgs_req(kdc_context, from, request, &reply, cprinc,"
    },
    {
        "line": 674,
        "fullcodeline": "krb5_db_free_principal(kdc_context, server);"
    },
    {
        "line": 675,
        "fullcodeline": "krb5_db_free_principal(kdc_context, stkt_server);"
    },
    {
        "line": 676,
        "fullcodeline": "krb5_db_free_principal(kdc_context, header_server);"
    },
    {
        "line": 677,
        "fullcodeline": "krb5_db_free_principal(kdc_context, client);"
    },
    {
        "line": 678,
        "fullcodeline": "krb5_db_free_principal(kdc_context, local_tgt_storage);"
    },
    {
        "line": 699,
        "fullcodeline": "krb5_free_pa_data(kdc_context, e_data);"
    },
    {
        "line": 701,
        "fullcodeline": "krb5_db_free_authdata_info(kdc_context, ad_info);"
    },
    {
        "line": 702,
        "fullcodeline": "krb5_db_free_authdata_info(kdc_context, stkt_ad_info);"
    },
    {
        "line": 59,
        "fullcodeline": "if (request->msg_type != KRB5_TGS_REQ) {"
    },
    {
        "line": 65,
        "fullcodeline": "if (errcode != 0)"
    },
    {
        "line": 80,
        "fullcodeline": "if (header_ticket && header_ticket->enc_part2)"
    },
    {
        "line": 88,
        "fullcodeline": "if (!header_ticket) {"
    },
    {
        "line": 103,
        "fullcodeline": "if (errcode !=0) {"
    },
    {
        "line": 137,
        "fullcodeline": "if (isflagset(request->kdc_options, KDC_OPT_CANONICALIZE)) {"
    },
    {
        "line": 144,
        "fullcodeline": "if (errcode != 0)"
    },
    {
        "line": 155,
        "fullcodeline": "if ((errcode = krb5_timeofday(kdc_context, &kdc_time)))"
    },
    {
        "line": 215,
        "fullcodeline": "if (errcode && errcode != KRB5_PLUGIN_OP_NOTSUPP)"
    },
    {
        "line": 219,
        "fullcodeline": "if (s4u_x509_user != NULL)"
    },
    {
        "line": 222,
        "fullcodeline": "if (isflagset(request->kdc_options, KDC_OPT_CNAME_IN_ADDL_TKT)) {"
    },
    {
        "line": 272,
        "fullcodeline": "if (isflagset(c_flags, KRB5_KDB_FLAG_CONSTRAINED_DELEGATION)) {"
    },
    {
        "line": 285,
        "fullcodeline": "if (s4u_x509_user == NULL) {"
    },
    {
        "line": 338,
        "fullcodeline": "if (isflagset(request->kdc_options, KDC_OPT_POSTDATED))"
    },
    {
        "line": 343,
        "fullcodeline": "if (isflagset(request->kdc_options, KDC_OPT_VALIDATE)) {"
    },
    {
        "line": 353,
        "fullcodeline": "if (isflagset(request->kdc_options, KDC_OPT_RENEW)) {"
    },
    {
        "line": 397,
        "fullcodeline": "if (enc_tkt_reply.times.starttime == enc_tkt_reply.times.authtime)"
    },
    {
        "line": 400,
        "fullcodeline": "if (isflagset(c_flags, KRB5_KDB_FLAG_PROTOCOL_TRANSITION)) {"
    },
    {
        "line": 409,
        "fullcodeline": "if (isflagset(request->kdc_options, KDC_OPT_ENC_TKT_IN_SKEY)) {"
    },
    {
        "line": 420,
        "fullcodeline": "if (isflagset(c_flags, KRB5_KDB_FLAG_CONSTRAINED_DELEGATION)) {"
    },
    {
        "line": 526,
        "fullcodeline": "if (isflagset(request->kdc_options, KDC_OPT_ENC_TKT_IN_SKEY)) {"
    },
    {
        "line": 604,
        "fullcodeline": "if (kdc_fast_hide_client(state))"
    },
    {
        "line": 610,
        "fullcodeline": "if (!errcode)"
    },
    {
        "line": 623,
        "fullcodeline": "if (status == NULL)"
    },
    {
        "line": 633,
        "fullcodeline": "if (au_state != NULL) {"
    },
    {
        "line": 649,
        "fullcodeline": "if (errcode && state != NULL) {"
    },
    {
        "line": 668,
        "fullcodeline": "if (header_ticket != NULL)"
    },
    {
        "line": 670,
        "fullcodeline": "if (request != NULL)"
    },
    {
        "line": 679,
        "fullcodeline": "if (local_tgt_key.contents != NULL)"
    },
    {
        "line": 681,
        "fullcodeline": "if (session_key.contents != NULL)"
    },
    {
        "line": 685,
        "fullcodeline": "if (s4u_x509_user != NULL)"
    },
    {
        "line": 687,
        "fullcodeline": "if (kdc_issued_auth_data != NULL)"
    },
    {
        "line": 689,
        "fullcodeline": "if (subkey != NULL)"
    },
    {
        "line": 691,
        "fullcodeline": "if (header_key != NULL)"
    },
    {
        "line": 697,
        "fullcodeline": "if (enc_tkt_reply.authorization_data != NULL)"
    },
    {
        "line": 60,
        "fullcodeline": "krb5_free_kdc_req(kdc_context, request);"
    },
    {
        "line": 81,
        "fullcodeline": "cprinc = header_ticket->enc_part2->client;"
    },
    {
        "line": 84,
        "fullcodeline": "status = \"PROCESS_TGS\";"
    },
    {
        "line": 89,
        "fullcodeline": "errcode = KRB5_NO_TKT_SUPPLIED;        /* XXX? */"
    },
    {
        "line": 104,
        "fullcodeline": "status = \"FIND_FAST\";"
    },
    {
        "line": 111,
        "fullcodeline": "status = \"GET_LOCAL_TGT\";"
    },
    {
        "line": 138,
        "fullcodeline": "setflag(c_flags, KRB5_KDB_FLAG_CANONICALIZE);"
    },
    {
        "line": 139,
        "fullcodeline": "setflag(s_flags, KRB5_KDB_FLAG_CANONICALIZE);"
    },
    {
        "line": 151,
        "fullcodeline": "!krb5_principal_compare(kdc_context, request->server, server->princ);"
    },
    {
        "line": 160,
        "fullcodeline": "setflag(c_flags, KRB5_KDB_FLAG_CROSS_REALM);"
    },
    {
        "line": 162,
        "fullcodeline": "setflag(c_flags, KRB5_KDB_FLAG_ISSUING_REFERRAL);"
    },
    {
        "line": 168,
        "fullcodeline": "if (s4u_x509_user != NULL || errcode != 0) {"
    },
    {
        "line": 171,
        "fullcodeline": "au_state->status = status;"
    },
    {
        "line": 172,
        "fullcodeline": "kau_s4u2self(kdc_context, errcode ? FALSE : TRUE, au_state);"
    },
    {
        "line": 173,
        "fullcodeline": "au_state->s4u2self_user = NULL;"
    },
    {
        "line": 189,
        "fullcodeline": "errcode = retval + ERROR_TABLE_BASE_krb5;"
    },
    {
        "line": 196,
        "fullcodeline": "if (s4u_x509_user != NULL && client == NULL) {"
    },
    {
        "line": 202,
        "fullcodeline": "setflag(c_flags, KRB5_KDB_FLAG_PROTOCOL_TRANSITION);"
    },
    {
        "line": 203,
        "fullcodeline": "authdata_client = s4u_x509_user->user_id.user;"
    },
    {
        "line": 220,
        "fullcodeline": "setflag(c_flags, KRB5_KDB_FLAG_PROTOCOL_TRANSITION);"
    },
    {
        "line": 224,
        "fullcodeline": "setflag(c_flags, KRB5_KDB_FLAG_CONSTRAINED_DELEGATION);"
    },
    {
        "line": 226,
        "fullcodeline": "errcode = kdc_process_s4u2proxy_req(kdc_active_realm, c_flags, request,"
    },
    {
        "line": 239,
        "fullcodeline": "au_state->status = status;"
    },
    {
        "line": 240,
        "fullcodeline": "retval = kau_make_tkt_id(kdc_context, stkt, &au_state->evid_tkt_id);"
    },
    {
        "line": 245,
        "fullcodeline": "kau_s4u2proxy(kdc_context, errcode ? FALSE : TRUE, au_state);"
    },
    {
        "line": 253,
        "fullcodeline": "krb5_db_free_authdata_info(kdc_context, ad_info);"
    },
    {
        "line": 254,
        "fullcodeline": "ad_info = stkt_ad_info;"
    },
    {
        "line": 255,
        "fullcodeline": "stkt_ad_info = NULL;"
    },
    {
        "line": 273,
        "fullcodeline": "subject_tkt = stkt->enc_part2;"
    },
    {
        "line": 274,
        "fullcodeline": "subject_server = stkt_server;"
    },
    {
        "line": 275,
        "fullcodeline": "subject_key = stkt_server_key;"
    },
    {
        "line": 286,
        "fullcodeline": "errcode = get_auth_indicators(kdc_context, subject_tkt, local_tgt,"
    },
    {
        "line": 293,
        "fullcodeline": "errcode = check_indicators(kdc_context, server, auth_indicators);"
    },
    {
        "line": 301,
        "fullcodeline": "ticket_reply.server = server->princ;"
    },
    {
        "line": 311,
        "fullcodeline": "if (isflagset(c_flags, KRB5_KDB_FLAG_PROTOCOL_TRANSITION) &&"
    },
    {
        "line": 313,
        "fullcodeline": "!isflagset(server->attributes, KRB5_KDB_OK_TO_AUTH_AS_DELEGATE))"
    },
    {
        "line": 314,
        "fullcodeline": "clear(enc_tkt_reply.flags, TKT_FLG_FORWARDABLE);"
    },
    {
        "line": 329,
        "fullcodeline": "if (isflagset(request->kdc_options, KDC_OPT_FORWARDED) ||"
    },
    {
        "line": 330,
        "fullcodeline": "isflagset(request->kdc_options, KDC_OPT_PROXY)) {"
    },
    {
        "line": 334,
        "fullcodeline": "enc_tkt_reply.caddrs = request->addresses;"
    },
    {
        "line": 335,
        "fullcodeline": "reply_encpart.caddrs = request->addresses;"
    },
    {
        "line": 347,
        "fullcodeline": "ticket_reply = *(header_ticket);"
    },
    {
        "line": 348,
        "fullcodeline": "enc_tkt_reply = *(header_ticket->enc_part2);"
    },
    {
        "line": 349,
        "fullcodeline": "enc_tkt_reply.authorization_data = NULL;"
    },
    {
        "line": 350,
        "fullcodeline": "clear(enc_tkt_reply.flags, TKT_FLG_INVALID);"
    },
    {
        "line": 360,
        "fullcodeline": "ticket_reply = *(header_ticket);"
    },
    {
        "line": 361,
        "fullcodeline": "enc_tkt_reply = *(header_ticket->enc_part2);"
    },
    {
        "line": 362,
        "fullcodeline": "enc_tkt_reply.authorization_data = NULL;"
    },
    {
        "line": 364,
        "fullcodeline": "old_starttime = enc_tkt_reply.times.starttime ?"
    },
    {
        "line": 366,
        "fullcodeline": "old_life = ts_delta(enc_tkt_reply.times.endtime, old_starttime);"
    },
    {
        "line": 368,
        "fullcodeline": "enc_tkt_reply.times.starttime = kdc_time;"
    },
    {
        "line": 369,
        "fullcodeline": "enc_tkt_reply.times.endtime ="
    },
    {
        "line": 398,
        "fullcodeline": "enc_tkt_reply.times.starttime = 0;"
    },
    {
        "line": 401,
        "fullcodeline": "altcprinc = s4u_x509_user->user_id.user;"
    },
    {
        "line": 410,
        "fullcodeline": "encrypting_key = stkt->enc_part2->session;"
    },
    {
        "line": 426,
        "fullcodeline": "clear(server->attributes, KRB5_KDB_NO_AUTH_DATA_REQUIRED);"
    },
    {
        "line": 428,
        "fullcodeline": "if (isflagset(server->attributes, KRB5_KDB_NO_AUTH_DATA_REQUIRED) == 0) {"
    },
    {
        "line": 444,
        "fullcodeline": "if (isflagset(c_flags, KRB5_KDB_FLAGS_S4U) && !is_referral)"
    },
    {
        "line": 445,
        "fullcodeline": "enc_tkt_reply.client = altcprinc;"
    },
    {
        "line": 460,
        "fullcodeline": "if (!is_crossrealm ||"
    },
    {
        "line": 461,
        "fullcodeline": "krb5_realm_compare(kdc_context, header_ticket->server,"
    },
    {
        "line": 464,
        "fullcodeline": "enc_tkt_reply.transited = header_enc_tkt->transited;"
    },
    {
        "line": 487,
        "fullcodeline": "if (!isflagset (request->kdc_options, KDC_OPT_DISABLE_TRANSITED_CHECK)) {"
    },
    {
        "line": 488,
        "fullcodeline": "errcode = kdc_check_transited_list (kdc_active_realm,"
    },
    {
        "line": 501,
        "fullcodeline": "!isflagset(enc_tkt_reply.flags, TKT_FLG_TRANSIT_POLICY_CHECKED)) {"
    },
    {
        "line": 502,
        "fullcodeline": "errcode = KRB5KDC_ERR_POLICY;"
    },
    {
        "line": 503,
        "fullcodeline": "status = \"BAD_TRANSIT\";"
    },
    {
        "line": 504,
        "fullcodeline": "au_state->violation = LOCAL_POLICY;"
    },
    {
        "line": 516,
        "fullcodeline": "krb5_klog_syslog(LOG_INFO, _(\"TGS_REQ : handle_authdata (%d)\"),"
    },
    {
        "line": 518,
        "fullcodeline": "status = \"HANDLE_AUTHDATA\";"
    },
    {
        "line": 527,
        "fullcodeline": "ticket_kvno = 0;"
    },
    {
        "line": 529,
        "fullcodeline": "kau_u2u(kdc_context, TRUE, au_state);"
    },
    {
        "line": 542,
        "fullcodeline": "if (isflagset(c_flags, KRB5_KDB_FLAG_PROTOCOL_TRANSITION) &&"
    },
    {
        "line": 543,
        "fullcodeline": "krb5int_find_pa_data(kdc_context, request->padata,"
    },
    {
        "line": 553,
        "fullcodeline": "kau_s4u2self(kdc_context, errcode ? FALSE : TRUE, au_state);"
    },
    {
        "line": 592,
        "fullcodeline": "is_referral &&"
    },
    {
        "line": 596,
        "fullcodeline": "status = \"KDC_RETURN_ENC_PADATA\";"
    },
    {
        "line": 605,
        "fullcodeline": "reply.client = (krb5_principal)krb5_anonymous_principal();"
    },
    {
        "line": 611,
        "fullcodeline": "status = \"ISSUE\";"
    },
    {
        "line": 624,
        "fullcodeline": "status = \"UNKNOWN_REASON\";"
    },
    {
        "line": 627,
        "fullcodeline": "krb5_free_keyblock(kdc_context, reply_key);"
    },
    {
        "line": 629,
        "fullcodeline": "krb5_free_keyblock(kdc_context, stkt_server_key);"
    },
    {
        "line": 631,
        "fullcodeline": "emsg = krb5_get_error_message (kdc_context, errcode);"
    },
    {
        "line": 634,
        "fullcodeline": "au_state->status = status;"
    },
    {
        "line": 637,
        "fullcodeline": "kau_tgs_req(kdc_context, errcode ? FALSE : TRUE, au_state);"
    },
    {
        "line": 645,
        "fullcodeline": "krb5_free_error_message (kdc_context, emsg);"
    },
    {
        "line": 655,
        "fullcodeline": "errcode -= ERROR_TABLE_BASE_krb5;"
    },
    {
        "line": 659,
        "fullcodeline": "retval = prepare_error_tgs(state, request, header_ticket, errcode,"
    },
    {
        "line": 669,
        "fullcodeline": "krb5_free_ticket(kdc_context, header_ticket);"
    },
    {
        "line": 671,
        "fullcodeline": "krb5_free_kdc_req(kdc_context, request);"
    },
    {
        "line": 680,
        "fullcodeline": "krb5_free_keyblock_contents(kdc_context, &local_tgt_key);"
    },
    {
        "line": 682,
        "fullcodeline": "krb5_free_keyblock_contents(kdc_context, &session_key);"
    },
    {
        "line": 686,
        "fullcodeline": "krb5_free_pa_s4u_x509_user(kdc_context, s4u_x509_user);"
    },
    {
        "line": 688,
        "fullcodeline": "krb5_free_authdata(kdc_context, kdc_issued_auth_data);"
    },
    {
        "line": 690,
        "fullcodeline": "krb5_free_keyblock(kdc_context, subkey);"
    },
    {
        "line": 692,
        "fullcodeline": "krb5_free_keyblock(kdc_context, header_key);"
    },
    {
        "line": 694,
        "fullcodeline": "krb5_free_pa_data(kdc_context, reply.padata);"
    },
    {
        "line": 696,
        "fullcodeline": "krb5_free_pa_data(kdc_context, reply_encpart.enc_padata);"
    },
    {
        "line": 698,
        "fullcodeline": "krb5_free_authdata(kdc_context, enc_tkt_reply.authorization_data);"
    },
    {
        "line": 169,
        "fullcodeline": "if (s4u_x509_user != NULL)"
    },
    {
        "line": 207,
        "fullcodeline": "authdata_client = header_enc_tkt->client;"
    },
    {
        "line": 249,
        "fullcodeline": "assert(krb5_is_tgs_principal(header_ticket->server));"
    },
    {
        "line": 277,
        "fullcodeline": "subject_tkt = header_enc_tkt;"
    },
    {
        "line": 278,
        "fullcodeline": "subject_server = header_server;"
    },
    {
        "line": 279,
        "fullcodeline": "subject_key = header_key;"
    },
    {
        "line": 303,
        "fullcodeline": "ticket_reply.server = request->server; /* XXX careful for realm... */"
    },
    {
        "line": 312,
        "fullcodeline": "!is_referral &&"
    },
    {
        "line": 344,
        "fullcodeline": "assert(isflagset(c_flags, KRB5_KDB_FLAGS_S4U) == 0);"
    },
    {
        "line": 357,
        "fullcodeline": "assert(isflagset(c_flags, KRB5_KDB_FLAGS_S4U) == 0);"
    },
    {
        "line": 370,
        "fullcodeline": "ts_min(header_ticket->enc_part2->times.renew_till,"
    },
    {
        "line": 374,
        "fullcodeline": "enc_tkt_reply.times.starttime = kdc_time;"
    },
    {
        "line": 376,
        "fullcodeline": "kdc_get_ticket_endtime(kdc_active_realm, enc_tkt_reply.times.starttime,"
    },
    {
        "line": 412,
        "fullcodeline": "errcode = get_first_current_key(kdc_context, server, &server_keyblock);"
    },
    {
        "line": 417,
        "fullcodeline": "encrypting_key = &server_keyblock;"
    },
    {
        "line": 447,
        "fullcodeline": "enc_tkt_reply.client = header_enc_tkt->client;"
    },
    {
        "line": 492,
        "fullcodeline": "if (errcode == 0) {"
    },
    {
        "line": 499,
        "fullcodeline": "krb5_klog_syslog(LOG_INFO, _(\"not checking transit path\"));"
    },
    {
        "line": 510,
        "fullcodeline": "subkey != NULL ? subkey :"
    },
    {
        "line": 531,
        "fullcodeline": "ticket_kvno = current_kvno(server);"
    },
    {
        "line": 545,
        "fullcodeline": "errcode = kdc_make_s4u2self_rep(kdc_context,"
    },
    {
        "line": 593,
        "fullcodeline": "isflagset(s_flags,"
    },
    {
        "line": 651,
        "fullcodeline": "if (status == 0) {"
    },
    {
        "line": 170,
        "fullcodeline": "au_state->s4u2self_user = s4u_x509_user->user_id.user;"
    },
    {
        "line": 187,
        "fullcodeline": "if (retval == KDC_ERR_POLICY || retval == KDC_ERR_BADOPTION)"
    },
    {
        "line": 188,
        "fullcodeline": "au_state->violation = PROT_CONSTRAINT;"
    },
    {
        "line": 235,
        "fullcodeline": "if (errcode == KDC_ERR_POLICY || errcode == KDC_ERR_BADOPTION)"
    },
    {
        "line": 236,
        "fullcodeline": "au_state->violation = PROT_CONSTRAINT;"
    },
    {
        "line": 242,
        "fullcodeline": "errcode = retval;"
    },
    {
        "line": 289,
        "fullcodeline": "status = \"GET_AUTH_INDICATORS\";"
    },
    {
        "line": 295,
        "fullcodeline": "status = \"HIGHER_AUTHENTICATION_REQUIRED\";"
    },
    {
        "line": 371,
        "fullcodeline": "ts_incr(kdc_time, old_life));"
    },
    {
        "line": 402,
        "fullcodeline": "} else if (isflagset(c_flags, KRB5_KDB_FLAG_CONSTRAINED_DELEGATION)) {"
    },
    {
        "line": 431,
        "fullcodeline": "if (!isflagset(c_flags, KRB5_KDB_FLAG_PROTOCOL_TRANSITION)) {"
    },
    {
        "line": 433,
        "fullcodeline": "setflag(c_flags, KRB5_KDB_FLAG_INCLUDE_PAC);"
    },
    {
        "line": 435,
        "fullcodeline": "setflag(c_flags, KRB5_KDB_FLAG_MAP_PRINCIPALS);"
    },
    {
        "line": 468,
        "fullcodeline": "if (header_enc_tkt->transited.tr_type !="
    },
    {
        "line": 476,
        "fullcodeline": "if ((errcode ="
    },
    {
        "line": 490,
        "fullcodeline": "krb5_princ_realm (kdc_context, header_enc_tkt->client),"
    },
    {
        "line": 491,
        "fullcodeline": "krb5_princ_realm (kdc_context, request->server));"
    },
    {
        "line": 493,
        "fullcodeline": "setflag (enc_tkt_reply.flags, TKT_FLG_TRANSIT_POLICY_CHECKED);"
    },
    {
        "line": 552,
        "fullcodeline": "au_state->status = status;"
    },
    {
        "line": 636,
        "fullcodeline": "au_state->reply = &reply;"
    },
    {
        "line": 652,
        "fullcodeline": "status = krb5_get_error_message (kdc_context, errcode);"
    },
    {
        "line": 656,
        "fullcodeline": "if (errcode < 0 || errcode > KRB_ERR_MAX)"
    },
    {
        "line": 657,
        "fullcodeline": "errcode = KRB_ERR_GENERIC;"
    },
    {
        "line": 663,
        "fullcodeline": "krb5_free_error_message (kdc_context, status);"
    },
    {
        "line": 405,
        "fullcodeline": "altcprinc = is_crossrealm ? stkt_authdata_client : subject_tkt->client;"
    },
    {
        "line": 414,
        "fullcodeline": "status = \"FINDING_SERVER_KEY\";"
    },
    {
        "line": 437,
        "fullcodeline": "assert(client == NULL); /* should not have been set already */"
    },
    {
        "line": 439,
        "fullcodeline": "errcode = krb5_db_get_principal(kdc_context, subject_tkt->client,"
    },
    {
        "line": 470,
        "fullcodeline": "status = \"VALIDATE_TRANSIT_TYPE\";"
    },
    {
        "line": 471,
        "fullcodeline": "errcode = KRB5KDC_ERR_TRTYPE_NOSUPP;"
    },
    {
        "line": 477,
        "fullcodeline": "add_to_transited(&header_enc_tkt->transited.tr_contents,"
    },
    {
        "line": 482,
        "fullcodeline": "status = \"ADD_TO_TRANSITED_LIST\";"
    },
    {
        "line": 495,
        "fullcodeline": "log_tgs_badtrans(kdc_context, cprinc, sprinc,"
    },
    {
        "line": 660,
        "fullcodeline": "(server != NULL) ? server->princ : NULL,"
    },
    {
        "line": 407,
        "fullcodeline": "altcprinc = NULL;"
    },
    {
        "line": 238,
        "fullcodeline": "au_state->violation = LOCAL_POLICY;"
    }
]