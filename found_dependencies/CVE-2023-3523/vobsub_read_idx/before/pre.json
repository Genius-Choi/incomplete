[
    {
        "line": 3,
        "fullcodeline": "char  strbuf[256];"
    },
    {
        "line": 5,
        "fullcodeline": "s32   line, id =-1, delay = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "Bool  error = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "for (line = 0; !error && gf_fgets(strbuf, sizeof(strbuf), file); line++)"
    },
    {
        "line": 199,
        "fullcodeline": "return error ? GF_CORRUPTED_DATA : GF_OK;"
    },
    {
        "line": 10,
        "fullcodeline": "str = strtrim(strbuf);"
    },
    {
        "line": 32,
        "fullcodeline": "pos = strchr(str, ':');"
    },
    {
        "line": 38,
        "fullcodeline": "entry = str;"
    },
    {
        "line": 39,
        "fullcodeline": "*pos  = '\\0';"
    },
    {
        "line": 41,
        "fullcodeline": "str = strtrim(pos + 1);"
    },
    {
        "line": 12,
        "fullcodeline": "if (line == 0)"
    },
    {
        "line": 33,
        "fullcodeline": "if (pos == NULL || pos == str)"
    },
    {
        "line": 42,
        "fullcodeline": "if (strlen(str) == 0)"
    },
    {
        "line": 47,
        "fullcodeline": "if (stricmp(entry, \"size\") == 0)"
    },
    {
        "line": 14,
        "fullcodeline": "char *buf = \"VobSub index file, v\";"
    },
    {
        "line": 16,
        "fullcodeline": "pos = strstr(str, buf);"
    },
    {
        "line": 54,
        "fullcodeline": "vobsub->width  = w;"
    },
    {
        "line": 55,
        "fullcodeline": "vobsub->height = h;"
    },
    {
        "line": 17,
        "fullcodeline": "if (pos == NULL || sscanf(pos + strlen(buf), \"%d\", version) != 1 || *version > VOBSUBIDXVER)"
    },
    {
        "line": 50,
        "fullcodeline": "if (sscanf(str, \"%dx%d\", &w, &h) != 2)"
    },
    {
        "line": 19,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 23,
        "fullcodeline": "else if (strlen(str) == 0)"
    },
    {
        "line": 52,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 57,
        "fullcodeline": "else if (stricmp(entry, \"palette\") == 0)"
    },
    {
        "line": 60,
        "fullcodeline": "u8  palette[16][4];"
    },
    {
        "line": 62,
        "fullcodeline": "if (sscanf(str, \"%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x\","
    },
    {
        "line": 72,
        "fullcodeline": "for (c = 0; c < 16; c++)"
    },
    {
        "line": 27,
        "fullcodeline": "else if (str[0] == '#')"
    },
    {
        "line": 68,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 76,
        "fullcodeline": "r = palette[c][2];"
    },
    {
        "line": 77,
        "fullcodeline": "g = palette[c][1];"
    },
    {
        "line": 78,
        "fullcodeline": "b = palette[c][0];"
    },
    {
        "line": 79,
        "fullcodeline": "vobsub->palette[c][0] = 0;"
    },
    {
        "line": 80,
        "fullcodeline": "vobsub->palette[c][1] = (( 66 * r + 129 * g +  25 * b + 128 +  4096) >> 8) & 0xff;"
    },
    {
        "line": 81,
        "fullcodeline": "vobsub->palette[c][2] = ((112 * r -  94 * g -  18 * b + 128 + 32768) >> 8) & 0xff;"
    },
    {
        "line": 82,
        "fullcodeline": "vobsub->palette[c][3] = ((-38 * r -  74 * g + 112 * b + 128 + 32768) >> 8) & 0xff;"
    },
    {
        "line": 85,
        "fullcodeline": "else if (stricmp(entry, \"id\") == 0)"
    },
    {
        "line": 63,
        "fullcodeline": "(u32 *) &palette[0], (u32 *) &palette[1], (u32 *) &palette[2], (u32 *) &palette[3],"
    },
    {
        "line": 64,
        "fullcodeline": "(u32 *) &palette[4], (u32 *) &palette[5], (u32 *) &palette[6], (u32 *) &palette[7],"
    },
    {
        "line": 65,
        "fullcodeline": "(u32 *) &palette[8], (u32 *) &palette[9], (u32 *) &palette[10], (u32 *) &palette[11],"
    },
    {
        "line": 66,
        "fullcodeline": "(u32 *) &palette[12],(u32 *) &palette[13],(u32 *) &palette[14], (u32 *) &palette[15]) != 16)"
    },
    {
        "line": 87,
        "fullcodeline": "char *buf = \"index:\";"
    },
    {
        "line": 90,
        "fullcodeline": "strlwr(str);"
    },
    {
        "line": 91,
        "fullcodeline": "lang_id = ((str[0] & 0xff) << 8) | (str[1] & 0xff);"
    },
    {
        "line": 93,
        "fullcodeline": "pos = strstr(str, buf);"
    },
    {
        "line": 106,
        "fullcodeline": "vobsub->langs[id].id   = lang_id;"
    },
    {
        "line": 107,
        "fullcodeline": "vobsub->langs[id].name = lang_table[vobsub_lang_name((u16)lang_id)].lang;"
    },
    {
        "line": 108,
        "fullcodeline": "vobsub->langs[id].idx = id;"
    },
    {
        "line": 110,
        "fullcodeline": "vobsub->langs[id].subpos = gf_list_new();"
    },
    {
        "line": 117,
        "fullcodeline": "delay = 0;"
    },
    {
        "line": 118,
        "fullcodeline": "vobsub->num_langs++;"
    },
    {
        "line": 94,
        "fullcodeline": "if (pos == NULL)"
    },
    {
        "line": 100,
        "fullcodeline": "if (sscanf(pos + strlen(buf), \"%d\", &id) != 1 || id < 0 || id >= 32)"
    },
    {
        "line": 111,
        "fullcodeline": "if (vobsub->langs[id].subpos == NULL)"
    },
    {
        "line": 96,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 102,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 113,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 120,
        "fullcodeline": "else if (id >= 0 && stricmp(entry, \"delay\") == 0)"
    },
    {
        "line": 124,
        "fullcodeline": "s32  sign = (str[0] == '-') ? -1 : 1;"
    },
    {
        "line": 126,
        "fullcodeline": "pos = str;"
    },
    {
        "line": 135,
        "fullcodeline": "delay += (hh*60*60*1000 + mm*60*1000 + ss*1000 + ms) * sign;"
    },
    {
        "line": 127,
        "fullcodeline": "while (*pos == '-' || *pos == '+') pos++;"
    },
    {
        "line": 129,
        "fullcodeline": "if (sscanf(pos, \"%d%c%d%c%d%c%d\", &hh, &c, &mm, &c, &ss, &c, &ms) != 7)"
    },
    {
        "line": 131,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 137,
        "fullcodeline": "else if (id >= 0 && stricmp(entry, \"timestamp\") == 0)"
    },
    {
        "line": 143,
        "fullcodeline": "char       *buf = \"filepos:\";"
    },
    {
        "line": 145,
        "fullcodeline": "vspos = (vobsub_pos*)gf_calloc(1, sizeof(vobsub_pos));"
    },
    {
        "line": 151,
        "fullcodeline": "sign = (str[0] == '-') ? -1 : 1;"
    },
    {
        "line": 161,
        "fullcodeline": "vspos->start = (((hh*60 + mm)*60 + ss)*1000 + ms) * sign + delay;"
    },
    {
        "line": 163,
        "fullcodeline": "pos = strstr(str, buf);"
    },
    {
        "line": 146,
        "fullcodeline": "if (vspos == NULL) {"
    },
    {
        "line": 152,
        "fullcodeline": "while (*str == '-' || *str == '+') str++;"
    },
    {
        "line": 154,
        "fullcodeline": "if (sscanf(str, \"%d%c%d%c%d%c%d\", &hh, &c, &mm, &c, &ss, &c, &ms) != 7)"
    },
    {
        "line": 164,
        "fullcodeline": "if (pos == NULL)"
    },
    {
        "line": 171,
        "fullcodeline": "if (sscanf(pos + strlen(buf), LLX, &vspos->filepos) != 1)"
    },
    {
        "line": 178,
        "fullcodeline": "if (delay < 0 && gf_list_count(vobsub->langs[id].subpos) > 0)"
    },
    {
        "line": 190,
        "fullcodeline": "if (gf_list_add(vobsub->langs[id].subpos, vspos) != GF_OK)"
    },
    {
        "line": 147,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 156,
        "fullcodeline": "gf_free(vspos);"
    },
    {
        "line": 157,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 166,
        "fullcodeline": "gf_free(vspos);"
    },
    {
        "line": 167,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 173,
        "fullcodeline": "gf_free(vspos);"
    },
    {
        "line": 174,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 182,
        "fullcodeline": "vspos_next = (vobsub_pos*)gf_list_get(vobsub->langs[id].subpos, gf_list_count(vobsub->langs[id].subpos) - 1);"
    },
    {
        "line": 192,
        "fullcodeline": "gf_free(vspos);"
    },
    {
        "line": 193,
        "fullcodeline": "error = 1;"
    },
    {
        "line": 183,
        "fullcodeline": "if (vspos->start < vspos_next->start)"
    },
    {
        "line": 185,
        "fullcodeline": "delay += (s32)(vspos_next->start - vspos->start);"
    },
    {
        "line": 186,
        "fullcodeline": "vspos->start = vspos_next->start;"
    }
]