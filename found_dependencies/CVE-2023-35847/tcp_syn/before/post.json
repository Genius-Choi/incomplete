[
    {
        "line": 3,
        "fullcodeline": "struct pico_socket_tcp *new = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "struct pico_tcp_hdr *hdr = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "new = (struct pico_socket_tcp *)pico_socket_clone(s);"
    },
    {
        "line": 10,
        "fullcodeline": "hdr = (struct pico_tcp_hdr *)f->transport_hdr;"
    },
    {
        "line": 36,
        "fullcodeline": "f->sock = &new->sock;"
    },
    {
        "line": 37,
        "fullcodeline": "mtu = (uint16_t)pico_socket_get_mss(&new->sock);"
    },
    {
        "line": 38,
        "fullcodeline": "new->mss = (uint16_t)(mtu - PICO_SIZE_TCPHDR);"
    },
    {
        "line": 41,
        "fullcodeline": "new->sock.stack = s->stack;"
    },
    {
        "line": 42,
        "fullcodeline": "new->tcpq_in.max_size = PICO_DEFAULT_SOCKETQ;"
    },
    {
        "line": 43,
        "fullcodeline": "new->tcpq_out.max_size = PICO_DEFAULT_SOCKETQ;"
    },
    {
        "line": 44,
        "fullcodeline": "new->tcpq_hold.max_size = 2u * mtu;"
    },
    {
        "line": 45,
        "fullcodeline": "new->rcv_nxt = long_be(hdr->seq) + 1;"
    },
    {
        "line": 46,
        "fullcodeline": "new->snd_nxt = long_be(pico_paws());"
    },
    {
        "line": 47,
        "fullcodeline": "new->snd_last = new->snd_nxt;"
    },
    {
        "line": 48,
        "fullcodeline": "new->cwnd = PICO_TCP_IW;"
    },
    {
        "line": 49,
        "fullcodeline": "new->ssthresh = (uint16_t)((uint16_t)(PICO_DEFAULT_SOCKETQ / new->mss) -  (((uint16_t)(PICO_DEFAULT_SOCKETQ / new->mss)) >> 3u));"
    },
    {
        "line": 50,
        "fullcodeline": "new->recv_wnd = short_be(hdr->rwnd);"
    },
    {
        "line": 51,
        "fullcodeline": "new->linger_timeout = PICO_SOCKET_LINGER_TIMEOUT;"
    },
    {
        "line": 52,
        "fullcodeline": "s->number_of_pending_conn++;"
    },
    {
        "line": 53,
        "fullcodeline": "new->sock.parent = s;"
    },
    {
        "line": 54,
        "fullcodeline": "new->sock.wakeup = s->wakeup;"
    },
    {
        "line": 55,
        "fullcodeline": "rto_set(new, PICO_TCP_RTO_MIN);"
    },
    {
        "line": 57,
        "fullcodeline": "new->sock.state = PICO_SOCKET_STATE_BOUND | PICO_SOCKET_STATE_CONNECTED | PICO_SOCKET_STATE_TCP_SYN_RECV;"
    },
    {
        "line": 58,
        "fullcodeline": "pico_socket_add(&new->sock);"
    },
    {
        "line": 59,
        "fullcodeline": "tcp_send_synack(&new->sock);"
    },
    {
        "line": 60,
        "fullcodeline": "tcp_dbg(\"SYNACK sent, socket added. snd_nxt is %08x\\n\", new->snd_nxt);"
    },
    {
        "line": 6,
        "fullcodeline": "if(s->number_of_pending_conn >= s->max_backlog)"
    },
    {
        "line": 11,
        "fullcodeline": "if (!new)"
    },
    {
        "line": 39,
        "fullcodeline": "if (tcp_parse_options(f) < 0)"
    },
    {
        "line": 21,
        "fullcodeline": "new->sock.remote_port = ((struct pico_trans *)f->transport_hdr)->sport;"
    },
    {
        "line": 7,
        "fullcodeline": "return -1;"
    },
    {
        "line": 12,
        "fullcodeline": "return -1;"
    },
    {
        "line": 40,
        "fullcodeline": "return -1;"
    }
]