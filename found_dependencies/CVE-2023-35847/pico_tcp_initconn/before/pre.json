[
    {
        "line": 3,
        "fullcodeline": "struct pico_socket_tcp *ts = TCP_SOCK(s);"
    },
    {
        "line": 6,
        "fullcodeline": "uint16_t mtu, opt_len = tcp_options_size(ts, PICO_TCP_SYN);"
    },
    {
        "line": 8,
        "fullcodeline": "syn = s->net->alloc(s->stack, s->net, NULL, (uint16_t)(PICO_SIZE_TCPHDR + opt_len));"
    },
    {
        "line": 17,
        "fullcodeline": "ts->snd_last = ts->snd_nxt;"
    },
    {
        "line": 18,
        "fullcodeline": "ts->cwnd = PICO_TCP_IW;"
    },
    {
        "line": 19,
        "fullcodeline": "mtu = (uint16_t)pico_socket_get_mss(s);"
    },
    {
        "line": 20,
        "fullcodeline": "ts->mss = (uint16_t)(mtu - PICO_SIZE_TCPHDR);"
    },
    {
        "line": 21,
        "fullcodeline": "ts->ssthresh = (uint16_t)((uint16_t)(PICO_DEFAULT_SOCKETQ / ts->mss) -  (((uint16_t)(PICO_DEFAULT_SOCKETQ / ts->mss)) >> 3u));"
    },
    {
        "line": 22,
        "fullcodeline": "syn->sock = s;"
    },
    {
        "line": 26,
        "fullcodeline": "tcp_set_space(ts);"
    },
    {
        "line": 28,
        "fullcodeline": "tcp_add_options(ts, syn, PICO_TCP_SYN, opt_len);"
    },
    {
        "line": 36,
        "fullcodeline": "tcp_dbg(\"Sending SYN... (ports: %d - %d) size: %d\\n\", short_be(ts->sock.local_port), short_be(ts->sock.remote_port), syn->buffer_len);"
    },
    {
        "line": 37,
        "fullcodeline": "ts->retrans_tmr = pico_timer_add(s->stack, PICO_TCP_SYN_TO << ts->backoff, initconn_retry, ts);"
    },
    {
        "line": 9,
        "fullcodeline": "if (!syn)"
    },
    {
        "line": 14,
        "fullcodeline": "if (!ts->snd_nxt)"
    },
    {
        "line": 23,
        "fullcodeline": "hdr->seq = long_be(ts->snd_nxt);"
    },
    {
        "line": 24,
        "fullcodeline": "hdr->len = (uint8_t)((PICO_SIZE_TCPHDR + opt_len) << 2);"
    },
    {
        "line": 27,
        "fullcodeline": "hdr->rwnd = short_be(ts->wnd);"
    },
    {
        "line": 33,
        "fullcodeline": "hdr->crc = short_be(pico_tcp_checksum(syn));"
    },
    {
        "line": 15,
        "fullcodeline": "ts->snd_nxt = long_be(pico_paws());"
    },
    {
        "line": 10,
        "fullcodeline": "return -1;"
    },
    {
        "line": 41,
        "fullcodeline": "return -1;"
    }
]