[
    {
        "line": 3,
        "fullcodeline": "struct ndpi_packet_struct* packet = &flow->packet;"
    },
    {
        "line": 4,
        "fullcodeline": "const u_int8_t * ovpn_payload = packet->payload;"
    },
    {
        "line": 9,
        "fullcodeline": "int8_t failed = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "/* No u_ */int16_t ovpn_payload_len = packet->payload_packet_len;"
    },
    {
        "line": 12,
        "fullcodeline": "if(ovpn_payload_len >= 40) {"
    },
    {
        "line": 17,
        "fullcodeline": "opcode = ovpn_payload[0] & P_OPCODE_MASK;"
    },
    {
        "line": 88,
        "fullcodeline": "flow->ovpn_counter++;"
    },
    {
        "line": 14,
        "fullcodeline": "if(packet->tcp != NULL)"
    },
    {
        "line": 15,
        "fullcodeline": "ovpn_payload += 2, ovpn_payload_len -= 2;;"
    },
    {
        "line": 42,
        "fullcodeline": "if(flow->ovpn_counter < P_HARD_RESET_CLIENT_MAX_COUNT && (opcode == P_CONTROL_HARD_RESET_CLIENT_V1 ||"
    },
    {
        "line": 28,
        "fullcodeline": "(flow->num_processed_pkts == 1)"
    },
    {
        "line": 43,
        "fullcodeline": "opcode == P_CONTROL_HARD_RESET_CLIENT_V2)) {"
    },
    {
        "line": 30,
        "fullcodeline": "((ovpn_payload_len == 112)"
    },
    {
        "line": 36,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct,\"found openvpn\\n\");"
    },
    {
        "line": 37,
        "fullcodeline": "ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_OPENVPN, NDPI_PROTOCOL_UNKNOWN);"
    },
    {
        "line": 44,
        "fullcodeline": "if(check_pkid_and_detect_hmac_size(ovpn_payload) > 0) {"
    },
    {
        "line": 45,
        "fullcodeline": "memcpy(flow->ovpn_session_id, ovpn_payload+1, 8);"
    },
    {
        "line": 47,
        "fullcodeline": "NDPI_LOG_DBG2(ndpi_struct,"
    },
    {
        "line": 33,
        "fullcodeline": "|| ((ovpn_payload_len == 80)"
    },
    {
        "line": 52,
        "fullcodeline": "} else if(flow->ovpn_counter >= 1 && flow->ovpn_counter <= P_HARD_RESET_CLIENT_MAX_COUNT &&"
    },
    {
        "line": 53,
        "fullcodeline": "(opcode == P_CONTROL_HARD_RESET_SERVER_V1 || opcode == P_CONTROL_HARD_RESET_SERVER_V2)) {"
    },
    {
        "line": 55,
        "fullcodeline": "hmac_size = check_pkid_and_detect_hmac_size(ovpn_payload);"
    },
    {
        "line": 31,
        "fullcodeline": "&& ((opcode == 168) || (opcode == 192))"
    },
    {
        "line": 34,
        "fullcodeline": "&& ((opcode == 184) || (opcode == 88) || (opcode == 160) || (opcode == 168) || (opcode == 200)))"
    },
    {
        "line": 57,
        "fullcodeline": "if(hmac_size > 0) {"
    },
    {
        "line": 58,
        "fullcodeline": "u_int16_t offset = P_PACKET_ID_ARRAY_LEN_OFFSET(hmac_size);"
    },
    {
        "line": 60,
        "fullcodeline": "alen = ovpn_payload[offset];"
    },
    {
        "line": 62,
        "fullcodeline": "if (alen > 0) {"
    },
    {
        "line": 63,
        "fullcodeline": "offset += 1 + alen * 4;"
    },
    {
        "line": 66,
        "fullcodeline": "session_remote = &ovpn_payload[offset];"
    },
    {
        "line": 68,
        "fullcodeline": "if(memcmp(flow->ovpn_session_id, session_remote, 8) == 0) {"
    },
    {
        "line": 69,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct,\"found openvpn\\n\");"
    },
    {
        "line": 73,
        "fullcodeline": "NDPI_LOG_DBG2(ndpi_struct,"
    }
]