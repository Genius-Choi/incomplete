[
    {
        "line": 3,
        "fullcodeline": "struct ndpi_packet_struct* packet = &flow->packet;"
    },
    {
        "line": 4,
        "fullcodeline": "const u_int8_t * ovpn_payload = packet->payload;"
    },
    {
        "line": 9,
        "fullcodeline": "int8_t failed = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "if(packet->payload_packet_len >= 40) {"
    },
    {
        "line": 16,
        "fullcodeline": "opcode = ovpn_payload[0] & P_OPCODE_MASK;"
    },
    {
        "line": 79,
        "fullcodeline": "flow->ovpn_counter++;"
    },
    {
        "line": 13,
        "fullcodeline": "if(packet->tcp != NULL)"
    },
    {
        "line": 41,
        "fullcodeline": "if(flow->ovpn_counter < P_HARD_RESET_CLIENT_MAX_COUNT && (opcode == P_CONTROL_HARD_RESET_CLIENT_V1 ||"
    },
    {
        "line": 14,
        "fullcodeline": "ovpn_payload += 2;"
    },
    {
        "line": 82,
        "fullcodeline": "NDPI_EXCLUDE_PROTO(ndpi_struct, flow);"
    },
    {
        "line": 27,
        "fullcodeline": "(flow->num_processed_pkts == 1)"
    },
    {
        "line": 42,
        "fullcodeline": "opcode == P_CONTROL_HARD_RESET_CLIENT_V2)) {"
    },
    {
        "line": 43,
        "fullcodeline": "if(check_pkid_and_detect_hmac_size(ovpn_payload) > 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "((packet->payload_packet_len == 112)"
    },
    {
        "line": 35,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct,\"found openvpn\\n\");"
    },
    {
        "line": 36,
        "fullcodeline": "ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_OPENVPN, NDPI_PROTOCOL_UNKNOWN);"
    },
    {
        "line": 44,
        "fullcodeline": "memcpy(flow->ovpn_session_id, ovpn_payload+1, 8);"
    },
    {
        "line": 46,
        "fullcodeline": "NDPI_LOG_DBG2(ndpi_struct,"
    },
    {
        "line": 51,
        "fullcodeline": "} else if(flow->ovpn_counter >= 1 && flow->ovpn_counter <= P_HARD_RESET_CLIENT_MAX_COUNT &&"
    },
    {
        "line": 32,
        "fullcodeline": "|| ((packet->payload_packet_len == 80)"
    },
    {
        "line": 52,
        "fullcodeline": "(opcode == P_CONTROL_HARD_RESET_SERVER_V1 || opcode == P_CONTROL_HARD_RESET_SERVER_V2)) {"
    },
    {
        "line": 54,
        "fullcodeline": "hmac_size = check_pkid_and_detect_hmac_size(ovpn_payload);"
    },
    {
        "line": 30,
        "fullcodeline": "&& ((opcode == 168) || (opcode == 192))"
    },
    {
        "line": 33,
        "fullcodeline": "&& ((opcode == 184) || (opcode == 88) || (opcode == 160) || (opcode == 168) || (opcode == 200)))"
    },
    {
        "line": 56,
        "fullcodeline": "if(hmac_size > 0) {"
    },
    {
        "line": 77,
        "fullcodeline": "failed = 1;"
    },
    {
        "line": 57,
        "fullcodeline": "alen = ovpn_payload[P_PACKET_ID_ARRAY_LEN_OFFSET(hmac_size)];"
    },
    {
        "line": 58,
        "fullcodeline": "if (alen > 0) {"
    },
    {
        "line": 75,
        "fullcodeline": "failed = 1;"
    },
    {
        "line": 59,
        "fullcodeline": "session_remote = ovpn_payload + P_PACKET_ID_ARRAY_LEN_OFFSET(hmac_size) + 1 + alen * 4;"
    },
    {
        "line": 61,
        "fullcodeline": "if(memcmp(flow->ovpn_session_id, session_remote, 8) == 0) {"
    },
    {
        "line": 73,
        "fullcodeline": "failed = 1;"
    },
    {
        "line": 62,
        "fullcodeline": "NDPI_LOG_INFO(ndpi_struct,\"found openvpn\\n\");"
    },
    {
        "line": 63,
        "fullcodeline": "ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_OPENVPN, NDPI_PROTOCOL_UNKNOWN);"
    },
    {
        "line": 66,
        "fullcodeline": "NDPI_LOG_DBG2(ndpi_struct,"
    },
    {
        "line": 70,
        "fullcodeline": "failed = 1;"
    }
]