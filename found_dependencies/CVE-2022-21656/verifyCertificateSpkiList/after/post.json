[
    {
        "line": 3,
        "fullcodeline": "X509_PUBKEY* pubkey = X509_get_X509_PUBKEY(cert);"
    },
    {
        "line": 7,
        "fullcodeline": "uint8_t* spki = nullptr;"
    },
    {
        "line": 8,
        "fullcodeline": "const int len = i2d_X509_PUBKEY(pubkey, &spki);"
    },
    {
        "line": 12,
        "fullcodeline": "bssl::UniquePtr<uint8_t> free_spki(spki);"
    },
    {
        "line": 14,
        "fullcodeline": "std::vector<uint8_t> computed_hash(SHA256_DIGEST_LENGTH);"
    },
    {
        "line": 15,
        "fullcodeline": "SHA256(spki, len, computed_hash.data());"
    },
    {
        "line": 4,
        "fullcodeline": "if (pubkey == nullptr) {"
    },
    {
        "line": 9,
        "fullcodeline": "if (len < 0) {"
    },
    {
        "line": 18,
        "fullcodeline": "if (computed_hash == expected_hash) {"
    }
]