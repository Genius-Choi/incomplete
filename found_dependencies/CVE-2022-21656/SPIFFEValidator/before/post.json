[
    {
        "line": 4,
        "fullcodeline": "ASSERT(config != nullptr);"
    },
    {
        "line": 5,
        "fullcodeline": "allow_expired_certificate_ = config->allowExpiredCertificate();"
    },
    {
        "line": 8,
        "fullcodeline": "Config::Utility::translateOpaqueConfig(config->customValidatorConfig().value().typed_config(),"
    },
    {
        "line": 17,
        "fullcodeline": "const auto size = message.trust_domains().size();"
    },
    {
        "line": 18,
        "fullcodeline": "trust_bundle_stores_.reserve(size);"
    },
    {
        "line": 11,
        "fullcodeline": "if (!config->subjectAltNameMatchers().empty()) {"
    },
    {
        "line": 25,
        "fullcodeline": "auto cert = Config::DataSource::read(domain.trust_bundle(), true, config->api());"
    },
    {
        "line": 26,
        "fullcodeline": "bssl::UniquePtr<BIO> bio(BIO_new_mem_buf(const_cast<char*>(cert.data()), cert.size()));"
    },
    {
        "line": 27,
        "fullcodeline": "RELEASE_ASSERT(bio != nullptr, \"\");"
    },
    {
        "line": 28,
        "fullcodeline": "bssl::UniquePtr<STACK_OF(X509_INFO)> list("
    },
    {
        "line": 35,
        "fullcodeline": "auto store = X509StorePtr(X509_STORE_new());"
    },
    {
        "line": 36,
        "fullcodeline": "bool has_crl = false;"
    },
    {
        "line": 37,
        "fullcodeline": "bool ca_loaded = false;"
    },
    {
        "line": 63,
        "fullcodeline": "trust_bundle_stores_[domain.name()] = std::move(store);"
    },
    {
        "line": 20,
        "fullcodeline": "if (trust_bundle_stores_.find(domain.name()) != trust_bundle_stores_.end()) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (list == nullptr || sk_X509_INFO_num(list.get()) == 0) {"
    },
    {
        "line": 13,
        "fullcodeline": "subject_alt_name_matchers_.push_back(Matchers::StringMatcherImpl(matcher));"
    },
    {
        "line": 29,
        "fullcodeline": "PEM_X509_INFO_read_bio(bio.get(), nullptr, nullptr, nullptr));"
    },
    {
        "line": 61,
        "fullcodeline": "X509_STORE_set_flags(store.get(), X509_V_FLAG_CRL_CHECK | X509_V_FLAG_CRL_CHECK_ALL);"
    },
    {
        "line": 21,
        "fullcodeline": "throw EnvoyException(absl::StrCat("
    },
    {
        "line": 31,
        "fullcodeline": "throw EnvoyException("
    },
    {
        "line": 32,
        "fullcodeline": "absl::StrCat(\"Failed to load trusted CA certificate for \", domain.name()));"
    },
    {
        "line": 40,
        "fullcodeline": "X509_STORE_add_cert(store.get(), item->x509);"
    },
    {
        "line": 41,
        "fullcodeline": "ca_certs_.push_back(bssl::UniquePtr<X509>(item->x509));"
    },
    {
        "line": 42,
        "fullcodeline": "X509_up_ref(item->x509);"
    },
    {
        "line": 56,
        "fullcodeline": "has_crl = true;"
    },
    {
        "line": 57,
        "fullcodeline": "X509_STORE_add_crl(store.get(), item->crl);"
    },
    {
        "line": 22,
        "fullcodeline": "\"Multiple trust bundles are given for one trust domain for \", domain.name()));"
    },
    {
        "line": 43,
        "fullcodeline": "if (!ca_loaded) {"
    },
    {
        "line": 47,
        "fullcodeline": "ca_loaded = true;"
    },
    {
        "line": 48,
        "fullcodeline": "ca_file_name_ = absl::StrCat(domain.name(), \": \","
    },
    {
        "line": 49,
        "fullcodeline": "domain.trust_bundle().filename().empty()"
    },
    {
        "line": 51,
        "fullcodeline": ": domain.trust_bundle().filename());"
    }
]