[
    {
        "line": 7,
        "fullcodeline": "NPT_File                 file(file_path);"
    },
    {
        "line": 17,
        "fullcodeline": "const NPT_String* range_spec = request.GetHeaders().GetHeaderValue(NPT_HTTP_HEADER_RANGE);"
    },
    {
        "line": 56,
        "fullcodeline": "PLT_HttpRequestContext tmp_context(request, context);"
    },
    {
        "line": 11,
        "fullcodeline": "if ((file_path.Find(\"../\") >= 0) || (file_path.Find(\"..\\\\\") >= 0) ||"
    },
    {
        "line": 22,
        "fullcodeline": "if (NPT_SUCCEEDED(PLT_UPnPMessageHelper::GetIfModifiedSince((NPT_HttpMessage&)request, date)) &&"
    },
    {
        "line": 42,
        "fullcodeline": "if (NPT_FAILED(file.Open(NPT_FILE_OPEN_MODE_READ)) ||"
    },
    {
        "line": 57,
        "fullcodeline": "return ServeStream(request, context, response, stream, PLT_MimeType::GetMimeType(file_path, &tmp_context));"
    },
    {
        "line": 12,
        "fullcodeline": "NPT_FAILED(NPT_File::GetInfo(file_path, &file_info))) {"
    },
    {
        "line": 23,
        "fullcodeline": "!range_spec) {"
    },
    {
        "line": 24,
        "fullcodeline": "date.ToTimeStamp(timestamp);"
    },
    {
        "line": 26,
        "fullcodeline": "NPT_LOG_INFO_5(\"File %s timestamps: request=%d (%s) vs file=%d (%s)\","
    },
    {
        "line": 44,
        "fullcodeline": "stream.IsNull()) {"
    },
    {
        "line": 50,
        "fullcodeline": "NPT_DateTime last_modified = NPT_DateTime(file_info.m_ModificationTime);"
    },
    {
        "line": 51,
        "fullcodeline": "response.GetHeaders().SetHeader(\"Last-Modified\", last_modified.ToString(NPT_DateTime::FORMAT_RFC_1123), true);"
    },
    {
        "line": 52,
        "fullcodeline": "response.GetHeaders().SetHeader(\"Cache-Control\", \"max-age=0,must-revalidate\", true);"
    },
    {
        "line": 27,
        "fullcodeline": "(const char*)request.GetUrl().GetPath(),"
    },
    {
        "line": 28,
        "fullcodeline": "(NPT_UInt32)timestamp.ToSeconds(),"
    },
    {
        "line": 29,
        "fullcodeline": "(const char*)date.ToString(),"
    },
    {
        "line": 30,
        "fullcodeline": "(NPT_UInt32)file_info.m_ModificationTime,"
    },
    {
        "line": 31,
        "fullcodeline": "(const char*)NPT_DateTime(file_info.m_ModificationTime).ToString());"
    },
    {
        "line": 33,
        "fullcodeline": "if (timestamp >= file_info.m_ModificationTime) {"
    },
    {
        "line": 43,
        "fullcodeline": "NPT_FAILED(file.GetInputStream(stream))        ||"
    },
    {
        "line": 35,
        "fullcodeline": "NPT_LOG_FINE_1(\"Returning 304 for %s\", request.GetUrl().GetPath().GetChars());"
    },
    {
        "line": 36,
        "fullcodeline": "response.SetStatus(304, \"Not Modified\", NPT_HTTP_PROTOCOL_1_1);"
    }
]