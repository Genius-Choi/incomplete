[
    {
        "line": 3,
        "fullcodeline": "static uid_t uid_server = 0;"
    },
    {
        "line": 4,
        "fullcodeline": "static gid_t gid_cluster = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "crm_client_t *client = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "CRM_LOG_ASSERT(c);"
    },
    {
        "line": 36,
        "fullcodeline": "crm_client_init();"
    },
    {
        "line": 39,
        "fullcodeline": "client = calloc(1, sizeof(crm_client_t));"
    },
    {
        "line": 41,
        "fullcodeline": "client->ipcs = c;"
    },
    {
        "line": 42,
        "fullcodeline": "client->kind = CRM_CLIENT_IPC;"
    },
    {
        "line": 43,
        "fullcodeline": "client->pid = crm_ipcs_client_pid(c);"
    },
    {
        "line": 45,
        "fullcodeline": "client->id = crm_generate_uuid();"
    },
    {
        "line": 47,
        "fullcodeline": "crm_debug(\"Connecting %p for uid=%d gid=%d pid=%u id=%s\", c, uid_client, gid_client, client->pid, client->id);"
    },
    {
        "line": 53,
        "fullcodeline": "g_hash_table_insert(client_connections, c, client);"
    },
    {
        "line": 9,
        "fullcodeline": "if (c == NULL) {"
    },
    {
        "line": 13,
        "fullcodeline": "if (gid_cluster == 0) {"
    },
    {
        "line": 24,
        "fullcodeline": "if(gid_cluster != 0 && gid_client != 0) {"
    },
    {
        "line": 14,
        "fullcodeline": "uid_server = getuid();"
    },
    {
        "line": 25,
        "fullcodeline": "uid_t best_uid = -1; /* Passing -1 to chown(2) means don't change */"
    },
    {
        "line": 32,
        "fullcodeline": "crm_trace(\"Giving access to group %u\", gid_cluster);"
    },
    {
        "line": 33,
        "fullcodeline": "qb_ipcs_connection_auth_set(c, best_uid, gid_cluster, S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP);"
    },
    {
        "line": 15,
        "fullcodeline": "if(crm_user_lookup(CRM_DAEMON_USER, NULL, &gid_cluster) < 0) {"
    },
    {
        "line": 27,
        "fullcodeline": "if(uid_client == 0 || uid_server == 0) { /* Someone is priveliged, but the other may not be */"
    },
    {
        "line": 16,
        "fullcodeline": "static bool have_error = FALSE;"
    },
    {
        "line": 28,
        "fullcodeline": "best_uid = QB_MAX(uid_client, uid_server);"
    },
    {
        "line": 29,
        "fullcodeline": "crm_trace(\"Allowing user %u to clean up after disconnect\", best_uid);"
    },
    {
        "line": 17,
        "fullcodeline": "if(have_error == FALSE) {"
    },
    {
        "line": 18,
        "fullcodeline": "crm_warn(\"Could not find group for user %s\", CRM_DAEMON_USER);"
    },
    {
        "line": 19,
        "fullcodeline": "have_error = TRUE;"
    }
]