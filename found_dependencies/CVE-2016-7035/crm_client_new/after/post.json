[
    {
        "line": 3,
        "fullcodeline": "static gid_t gid_cluster = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "crm_client_t *client = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "CRM_LOG_ASSERT(c);"
    },
    {
        "line": 28,
        "fullcodeline": "crm_client_init();"
    },
    {
        "line": 31,
        "fullcodeline": "client = calloc(1, sizeof(crm_client_t));"
    },
    {
        "line": 33,
        "fullcodeline": "client->ipcs = c;"
    },
    {
        "line": 34,
        "fullcodeline": "client->kind = CRM_CLIENT_IPC;"
    },
    {
        "line": 35,
        "fullcodeline": "client->pid = crm_ipcs_client_pid(c);"
    },
    {
        "line": 37,
        "fullcodeline": "client->id = crm_generate_uuid();"
    },
    {
        "line": 39,
        "fullcodeline": "crm_debug(\"Connecting %p for uid=%d gid=%d pid=%u id=%s\", c, uid_client, gid_client, client->pid, client->id);"
    },
    {
        "line": 45,
        "fullcodeline": "g_hash_table_insert(client_connections, c, client);"
    },
    {
        "line": 8,
        "fullcodeline": "if (c == NULL) {"
    },
    {
        "line": 12,
        "fullcodeline": "if (gid_cluster == 0) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (uid_client != 0) {"
    },
    {
        "line": 23,
        "fullcodeline": "crm_trace(\"Giving access to group %u\", gid_cluster);"
    },
    {
        "line": 25,
        "fullcodeline": "qb_ipcs_connection_auth_set(c, -1, gid_cluster, S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP);"
    },
    {
        "line": 13,
        "fullcodeline": "if(crm_user_lookup(CRM_DAEMON_USER, NULL, &gid_cluster) < 0) {"
    },
    {
        "line": 14,
        "fullcodeline": "static bool have_error = FALSE;"
    },
    {
        "line": 15,
        "fullcodeline": "if(have_error == FALSE) {"
    },
    {
        "line": 16,
        "fullcodeline": "crm_warn(\"Could not find group for user %s\", CRM_DAEMON_USER);"
    },
    {
        "line": 17,
        "fullcodeline": "have_error = TRUE;"
    }
]