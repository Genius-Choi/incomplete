[
    {
        "line": 4,
        "fullcodeline": "struct kvm_vcpu_arch *vcpu = &v->arch;"
    },
    {
        "line": 5,
        "fullcodeline": "struct kvm_arch *ka = &v->kvm->arch;"
    },
    {
        "line": 13,
        "fullcodeline": "kernel_ns = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "host_tsc = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "spin_lock(&ka->pvclock_gtod_sync_lock);"
    },
    {
        "line": 21,
        "fullcodeline": "use_master_clock = ka->use_master_clock;"
    },
    {
        "line": 26,
        "fullcodeline": "spin_unlock(&ka->pvclock_gtod_sync_lock);"
    },
    {
        "line": 29,
        "fullcodeline": "local_irq_save(flags);"
    },
    {
        "line": 30,
        "fullcodeline": "this_tsc_khz = __get_cpu_var(cpu_tsc_khz);"
    },
    {
        "line": 41,
        "fullcodeline": "tsc_timestamp = kvm_x86_ops->read_l1_tsc(v, host_tsc);"
    },
    {
        "line": 87,
        "fullcodeline": "max_kernel_ns = 0;"
    },
    {
        "line": 113,
        "fullcodeline": "vcpu->hv_clock.tsc_timestamp = tsc_timestamp;"
    },
    {
        "line": 114,
        "fullcodeline": "vcpu->hv_clock.system_time = kernel_ns + v->kvm->arch.kvmclock_offset;"
    },
    {
        "line": 123,
        "fullcodeline": "vcpu->hv_clock.version += 2;"
    },
    {
        "line": 125,
        "fullcodeline": "shared_kaddr = kmap_atomic(vcpu->time_page);"
    },
    {
        "line": 127,
        "fullcodeline": "guest_hv_clock = shared_kaddr + vcpu->time_offset;"
    },
    {
        "line": 130,
        "fullcodeline": "pvclock_flags = (guest_hv_clock->flags & PVCLOCK_GUEST_STOPPED);"
    },
    {
        "line": 141,
        "fullcodeline": "vcpu->hv_clock.flags = pvclock_flags;"
    },
    {
        "line": 31,
        "fullcodeline": "if (unlikely(this_tsc_khz == 0)) {"
    },
    {
        "line": 36,
        "fullcodeline": "if (!use_master_clock) {"
    },
    {
        "line": 63,
        "fullcodeline": "if (!vcpu->time_page)"
    },
    {
        "line": 148,
        "fullcodeline": "mark_page_dirty(v->kvm, vcpu->time >> PAGE_SHIFT);"
    },
    {
        "line": 23,
        "fullcodeline": "host_tsc = ka->master_cycle_now;"
    },
    {
        "line": 24,
        "fullcodeline": "kernel_ns = ka->master_kernel_ns;"
    },
    {
        "line": 32,
        "fullcodeline": "local_irq_restore(flags);"
    },
    {
        "line": 33,
        "fullcodeline": "kvm_make_request(KVM_REQ_CLOCK_UPDATE, v);"
    },
    {
        "line": 37,
        "fullcodeline": "host_tsc = native_read_tsc();"
    },
    {
        "line": 38,
        "fullcodeline": "kernel_ns = get_kernel_ns();"
    },
    {
        "line": 54,
        "fullcodeline": "u64 tsc = compute_guest_tsc(v, kernel_ns);"
    },
    {
        "line": 89,
        "fullcodeline": "max_kernel_ns = vcpu->last_guest_tsc -"
    },
    {
        "line": 91,
        "fullcodeline": "max_kernel_ns = pvclock_scale_delta(max_kernel_ns,"
    },
    {
        "line": 94,
        "fullcodeline": "max_kernel_ns += vcpu->last_kernel_ns;"
    },
    {
        "line": 97,
        "fullcodeline": "if (unlikely(vcpu->hw_tsc_khz != this_tsc_khz)) {"
    },
    {
        "line": 98,
        "fullcodeline": "kvm_get_time_scale(NSEC_PER_SEC / 1000, this_tsc_khz,"
    },
    {
        "line": 133,
        "fullcodeline": "pvclock_flags |= PVCLOCK_GUEST_STOPPED;"
    },
    {
        "line": 134,
        "fullcodeline": "vcpu->pvclock_set_guest_stopped_request = false;"
    },
    {
        "line": 139,
        "fullcodeline": "pvclock_flags |= PVCLOCK_TSC_STABLE_BIT;"
    },
    {
        "line": 55,
        "fullcodeline": "if (tsc > tsc_timestamp) {"
    },
    {
        "line": 109,
        "fullcodeline": "if (max_kernel_ns > kernel_ns)"
    },
    {
        "line": 56,
        "fullcodeline": "adjust_tsc_offset_guest(v, tsc - tsc_timestamp);"
    },
    {
        "line": 57,
        "fullcodeline": "tsc_timestamp = tsc;"
    },
    {
        "line": 110,
        "fullcodeline": "kernel_ns = max_kernel_ns;"
    }
]