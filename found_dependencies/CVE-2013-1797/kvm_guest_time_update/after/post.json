[
    {
        "line": 4,
        "fullcodeline": "struct kvm_vcpu_arch *vcpu = &v->arch;"
    },
    {
        "line": 12,
        "fullcodeline": "kernel_ns = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "host_tsc = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "spin_lock(&ka->pvclock_gtod_sync_lock);"
    },
    {
        "line": 20,
        "fullcodeline": "use_master_clock = ka->use_master_clock;"
    },
    {
        "line": 25,
        "fullcodeline": "spin_unlock(&ka->pvclock_gtod_sync_lock);"
    },
    {
        "line": 28,
        "fullcodeline": "local_irq_save(flags);"
    },
    {
        "line": 29,
        "fullcodeline": "this_tsc_khz = __get_cpu_var(cpu_tsc_khz);"
    },
    {
        "line": 40,
        "fullcodeline": "tsc_timestamp = kvm_x86_ops->read_l1_tsc(v, host_tsc);"
    },
    {
        "line": 60,
        "fullcodeline": "local_irq_restore(flags);"
    },
    {
        "line": 86,
        "fullcodeline": "max_kernel_ns = 0;"
    },
    {
        "line": 112,
        "fullcodeline": "vcpu->hv_clock.tsc_timestamp = tsc_timestamp;"
    },
    {
        "line": 113,
        "fullcodeline": "vcpu->hv_clock.system_time = kernel_ns + v->kvm->arch.kvmclock_offset;"
    },
    {
        "line": 114,
        "fullcodeline": "vcpu->last_kernel_ns = kernel_ns;"
    },
    {
        "line": 115,
        "fullcodeline": "vcpu->last_guest_tsc = tsc_timestamp;"
    },
    {
        "line": 122,
        "fullcodeline": "vcpu->hv_clock.version += 2;"
    },
    {
        "line": 129,
        "fullcodeline": "pvclock_flags = (guest_hv_clock.flags & PVCLOCK_GUEST_STOPPED);"
    },
    {
        "line": 140,
        "fullcodeline": "vcpu->hv_clock.flags = pvclock_flags;"
    },
    {
        "line": 142,
        "fullcodeline": "kvm_write_guest_cached(v->kvm, &vcpu->pv_time,"
    },
    {
        "line": 30,
        "fullcodeline": "if (unlikely(this_tsc_khz == 0)) {"
    },
    {
        "line": 35,
        "fullcodeline": "if (!use_master_clock) {"
    },
    {
        "line": 62,
        "fullcodeline": "if (!vcpu->pv_time_enabled)"
    },
    {
        "line": 96,
        "fullcodeline": "if (unlikely(vcpu->hw_tsc_khz != this_tsc_khz)) {"
    },
    {
        "line": 107,
        "fullcodeline": "if (!use_master_clock) {"
    },
    {
        "line": 124,
        "fullcodeline": "if (unlikely(kvm_read_guest_cached(v->kvm, &vcpu->pv_time,"
    },
    {
        "line": 22,
        "fullcodeline": "host_tsc = ka->master_cycle_now;"
    },
    {
        "line": 23,
        "fullcodeline": "kernel_ns = ka->master_kernel_ns;"
    },
    {
        "line": 31,
        "fullcodeline": "local_irq_restore(flags);"
    },
    {
        "line": 32,
        "fullcodeline": "kvm_make_request(KVM_REQ_CLOCK_UPDATE, v);"
    },
    {
        "line": 36,
        "fullcodeline": "host_tsc = native_read_tsc();"
    },
    {
        "line": 37,
        "fullcodeline": "kernel_ns = get_kernel_ns();"
    },
    {
        "line": 53,
        "fullcodeline": "u64 tsc = compute_guest_tsc(v, kernel_ns);"
    },
    {
        "line": 88,
        "fullcodeline": "max_kernel_ns = vcpu->last_guest_tsc -"
    },
    {
        "line": 90,
        "fullcodeline": "max_kernel_ns = pvclock_scale_delta(max_kernel_ns,"
    },
    {
        "line": 93,
        "fullcodeline": "max_kernel_ns += vcpu->last_kernel_ns;"
    },
    {
        "line": 97,
        "fullcodeline": "kvm_get_time_scale(NSEC_PER_SEC / 1000, this_tsc_khz,"
    },
    {
        "line": 100,
        "fullcodeline": "vcpu->hw_tsc_khz = this_tsc_khz;"
    },
    {
        "line": 132,
        "fullcodeline": "pvclock_flags |= PVCLOCK_GUEST_STOPPED;"
    },
    {
        "line": 133,
        "fullcodeline": "vcpu->pvclock_set_guest_stopped_request = false;"
    },
    {
        "line": 138,
        "fullcodeline": "pvclock_flags |= PVCLOCK_TSC_STABLE_BIT;"
    },
    {
        "line": 54,
        "fullcodeline": "if (tsc > tsc_timestamp) {"
    },
    {
        "line": 108,
        "fullcodeline": "if (max_kernel_ns > kernel_ns)"
    },
    {
        "line": 55,
        "fullcodeline": "adjust_tsc_offset_guest(v, tsc - tsc_timestamp);"
    },
    {
        "line": 56,
        "fullcodeline": "tsc_timestamp = tsc;"
    },
    {
        "line": 109,
        "fullcodeline": "kernel_ns = max_kernel_ns;"
    }
]