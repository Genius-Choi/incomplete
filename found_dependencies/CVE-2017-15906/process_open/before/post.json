[
    {
        "line": 6,
        "fullcodeline": "int r, handle, fd, flags, mode, status = SSH2_FX_FAILURE;"
    },
    {
        "line": 13,
        "fullcodeline": "debug3(\"request %u: open flags %d\", id, pflags);"
    },
    {
        "line": 14,
        "fullcodeline": "flags = flags_from_portable(pflags);"
    },
    {
        "line": 15,
        "fullcodeline": "mode = (a.flags & SSH2_FILEXFER_ATTR_PERMISSIONS) ? a.perm : 0666;"
    },
    {
        "line": 16,
        "fullcodeline": "logit(\"open \\\"%s\\\" flags %s mode 0%o\","
    },
    {
        "line": 39,
        "fullcodeline": "free(name);"
    },
    {
        "line": 8,
        "fullcodeline": "if ((r = sshbuf_get_cstring(iqueue, &name, NULL)) != 0 ||"
    },
    {
        "line": 17,
        "fullcodeline": "name, string_from_portable(pflags), mode);"
    },
    {
        "line": 18,
        "fullcodeline": "if (readonly &&"
    },
    {
        "line": 37,
        "fullcodeline": "if (status != SSH2_FX_OK)"
    },
    {
        "line": 10,
        "fullcodeline": "(r = decode_attrib(iqueue, &a)) != 0)"
    },
    {
        "line": 11,
        "fullcodeline": "fatal(\"%s: buffer error: %s\", __func__, ssh_err(r));"
    },
    {
        "line": 19,
        "fullcodeline": "((flags & O_ACCMODE) == O_WRONLY ||"
    },
    {
        "line": 21,
        "fullcodeline": "verbose(\"Refusing open request in read-only mode\");"
    },
    {
        "line": 22,
        "fullcodeline": "status = SSH2_FX_PERMISSION_DENIED;"
    },
    {
        "line": 38,
        "fullcodeline": "send_status(id, status);"
    },
    {
        "line": 9,
        "fullcodeline": "(r = sshbuf_get_u32(iqueue, &pflags)) != 0 || /* portable flags */"
    },
    {
        "line": 20,
        "fullcodeline": "(flags & O_ACCMODE) == O_RDWR)) {"
    },
    {
        "line": 24,
        "fullcodeline": "fd = open(name, flags, mode);"
    },
    {
        "line": 25,
        "fullcodeline": "if (fd < 0) {"
    },
    {
        "line": 26,
        "fullcodeline": "status = errno_to_portable(errno);"
    },
    {
        "line": 28,
        "fullcodeline": "handle = handle_new(HANDLE_FILE, name, fd, flags, NULL);"
    },
    {
        "line": 29,
        "fullcodeline": "if (handle < 0) {"
    },
    {
        "line": 30,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 32,
        "fullcodeline": "send_handle(id, handle);"
    },
    {
        "line": 33,
        "fullcodeline": "status = SSH2_FX_OK;"
    }
]