[
    {
        "line": 16,
        "fullcodeline": "json_auto_t* jwk = find_by_thp(tki, thp);"
    },
    {
        "line": 21,
        "fullcodeline": "json_auto_t* sign = json_deep_copy(tki->m_sign);"
    },
    {
        "line": 25,
        "fullcodeline": "json_auto_t* jws = jwk_sign(tki->m_payload, sign);"
    },
    {
        "line": 3,
        "fullcodeline": "if (!tki) {"
    },
    {
        "line": 7,
        "fullcodeline": "if (thp == NULL) {"
    },
    {
        "line": 17,
        "fullcodeline": "if (!jwk_valid_for_signing(jwk)) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (json_array_append(sign, jwk) == -1) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (!jws) {"
    },
    {
        "line": 29,
        "fullcodeline": "return json_incref(jws);"
    },
    {
        "line": 9,
        "fullcodeline": "json_auto_t* jws = jwk_sign(tki->m_payload, tki->m_sign);"
    },
    {
        "line": 10,
        "fullcodeline": "if (!jws) {"
    },
    {
        "line": 13,
        "fullcodeline": "return json_incref(jws);"
    }
]