[
    {
        "line": 2,
        "fullcodeline": "char buf[BUFFER_SIZE];"
    },
    {
        "line": 3,
        "fullcodeline": "char cwd[BUFFER_SIZE];"
    },
    {
        "line": 6,
        "fullcodeline": "bool read_only = (buf[0] == 'r');"
    },
    {
        "line": 8,
        "fullcodeline": "read_buf(fin, buf);"
    },
    {
        "line": 10,
        "fullcodeline": "std::string old_cwd = Process::GetCurrentDirectory();"
    },
    {
        "line": 11,
        "fullcodeline": "read_buf(fin, cwd);"
    },
    {
        "line": 20,
        "fullcodeline": "FILE *f = buf[0] ? ::popen(buf, read_only ? \"r\" : \"w\") : nullptr;"
    },
    {
        "line": 5,
        "fullcodeline": "if (!fgets(buf, BUFFER_SIZE, fin)) buf[0] = '\\0';"
    },
    {
        "line": 12,
        "fullcodeline": "if (old_cwd != cwd) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (old_cwd != cwd && chdir(old_cwd.c_str())) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (f == nullptr) {"
    },
    {
        "line": 27,
        "fullcodeline": "Logger::Error(\"Light process failed popen: %d (%s).\", errno,"
    },
    {
        "line": 29,
        "fullcodeline": "fprintf(fout, \"error\\n\");"
    },
    {
        "line": 30,
        "fullcodeline": "fflush(fout);"
    },
    {
        "line": 13,
        "fullcodeline": "if (chdir(cwd)) {"
    },
    {
        "line": 28,
        "fullcodeline": "folly::errnoStr(errno).c_str());"
    },
    {
        "line": 34,
        "fullcodeline": "int fd = fileno(f);"
    },
    {
        "line": 16,
        "fullcodeline": "Logger::Warning(\"Light Process failed chdir to %s.\", cwd);"
    }
]