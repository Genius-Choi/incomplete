[
    {
        "line": 2,
        "fullcodeline": "FILE *fin = fdopen(fdin, \"r\");"
    },
    {
        "line": 3,
        "fullcodeline": "FILE *fout = fdopen(fdout, \"w\");"
    },
    {
        "line": 5,
        "fullcodeline": "char buf[BUFFER_SIZE];"
    },
    {
        "line": 7,
        "fullcodeline": "pollfd pfd[1];"
    },
    {
        "line": 8,
        "fullcodeline": "pfd[0].fd = fdin;"
    },
    {
        "line": 9,
        "fullcodeline": "pfd[0].events = POLLIN;"
    },
    {
        "line": 40,
        "fullcodeline": "fclose(fin);"
    },
    {
        "line": 41,
        "fullcodeline": "fclose(fout);"
    },
    {
        "line": 43,
        "fullcodeline": "remove(m_afdtFilename.c_str());"
    },
    {
        "line": 44,
        "fullcodeline": "_Exit(0);"
    },
    {
        "line": 11,
        "fullcodeline": "int ret = poll(pfd, 1, -1);"
    },
    {
        "line": 12,
        "fullcodeline": "if (ret < 0 && errno == EINTR) {"
    },
    {
        "line": 15,
        "fullcodeline": "if (pfd[0].revents & POLLIN) {"
    },
    {
        "line": 16,
        "fullcodeline": "if (!fgets(buf, BUFFER_SIZE, fin)) buf[0] = '\\0';"
    },
    {
        "line": 17,
        "fullcodeline": "if (strncmp(buf, \"exit\", 4) == 0) {"
    },
    {
        "line": 18,
        "fullcodeline": "Logger::Info(\"LightProcess exiting upon request\");"
    },
    {
        "line": 33,
        "fullcodeline": "} else if (pfd[0].revents & POLLHUP) {"
    },
    {
        "line": 35,
        "fullcodeline": "Logger::Error(\"Lost parent, LightProcess exiting\");"
    },
    {
        "line": 20,
        "fullcodeline": "} else if (strncmp(buf, \"popen\", 5) == 0) {"
    },
    {
        "line": 21,
        "fullcodeline": "do_popen(fin, fout, m_afdt_fd);"
    },
    {
        "line": 22,
        "fullcodeline": "} else if (strncmp(buf, \"pclose\", 6) == 0) {"
    },
    {
        "line": 23,
        "fullcodeline": "do_pclose(fin, fout);"
    },
    {
        "line": 24,
        "fullcodeline": "} else if (strncmp(buf, \"proc_open\", 9) == 0) {"
    },
    {
        "line": 25,
        "fullcodeline": "do_proc_open(fin, fout, m_afdt_fd);"
    },
    {
        "line": 26,
        "fullcodeline": "} else if (strncmp(buf, \"waitpid\", 7) == 0) {"
    },
    {
        "line": 27,
        "fullcodeline": "do_waitpid(fin, fout);"
    },
    {
        "line": 28,
        "fullcodeline": "} else if (strncmp(buf, \"change_user\", 11) == 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "do_change_user(fin, fout);"
    },
    {
        "line": 31,
        "fullcodeline": "Logger::Info(\"LightProcess got invalid command: %.20s\", buf);"
    }
]