[
    {
        "line": 4,
        "fullcodeline": "size_t datalen = prep->datalen;"
    },
    {
        "line": 8,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 12,
        "fullcodeline": "ret = -ENOMEM;"
    },
    {
        "line": 13,
        "fullcodeline": "ckey = kmalloc(sizeof(*ckey), GFP_KERNEL);"
    },
    {
        "line": 18,
        "fullcodeline": "p = (void *)prep->data;"
    },
    {
        "line": 19,
        "fullcodeline": "ret = ceph_crypto_key_decode(ckey, &p, (char*)prep->data+datalen);"
    },
    {
        "line": 23,
        "fullcodeline": "prep->payload.data[0] = ckey;"
    },
    {
        "line": 24,
        "fullcodeline": "prep->quotalen = datalen;"
    },
    {
        "line": 28,
        "fullcodeline": "kfree(ckey);"
    },
    {
        "line": 9,
        "fullcodeline": "if (datalen <= 0 || datalen > 32767 || !prep->data)"
    },
    {
        "line": 14,
        "fullcodeline": "if (!ckey)"
    },
    {
        "line": 20,
        "fullcodeline": "if (ret < 0)"
    }
]