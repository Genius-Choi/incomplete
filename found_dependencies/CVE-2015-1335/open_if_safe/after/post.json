[
    {
        "line": 3,
        "fullcodeline": "int newfd = openat(dirfd, nextpath, O_RDONLY | O_NOFOLLOW);"
    },
    {
        "line": 4,
        "fullcodeline": "if (newfd >= 0) // was not a symlink, all good"
    },
    {
        "line": 7,
        "fullcodeline": "if (errno == ELOOP)"
    },
    {
        "line": 10,
        "fullcodeline": "if (errno == EPERM || errno == EACCES) {"
    },
    {
        "line": 13,
        "fullcodeline": "newfd = openat(dirfd, nextpath, O_PATH | O_NOFOLLOW);"
    },
    {
        "line": 14,
        "fullcodeline": "if (newfd >= 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "int ret = check_symlink(newfd);"
    },
    {
        "line": 20,
        "fullcodeline": "if (ret < 0) {"
    },
    {
        "line": 21,
        "fullcodeline": "close(newfd);"
    },
    {
        "line": 22,
        "fullcodeline": "newfd = ret;"
    }
]