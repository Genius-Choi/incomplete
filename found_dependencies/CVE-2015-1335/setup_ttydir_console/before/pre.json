[
    {
        "line": 5,
        "fullcodeline": "char path[MAXPATHLEN], lxcpath[MAXPATHLEN];"
    },
    {
        "line": 9,
        "fullcodeline": "ret = snprintf(path, sizeof(path), \"%s/dev/%s\", rootfs->mount,"
    },
    {
        "line": 13,
        "fullcodeline": "ret = mkdir(path, 0755);"
    },
    {
        "line": 20,
        "fullcodeline": "ret = snprintf(lxcpath, sizeof(lxcpath), \"%s/dev/%s/console\","
    },
    {
        "line": 27,
        "fullcodeline": "snprintf(path, sizeof(path), \"%s/dev/console\", rootfs->mount);"
    },
    {
        "line": 28,
        "fullcodeline": "ret = unlink(path);"
    },
    {
        "line": 34,
        "fullcodeline": "ret = creat(lxcpath, 0660);"
    },
    {
        "line": 53,
        "fullcodeline": "ret = snprintf(lxcpath, sizeof(lxcpath), \"%s/console\", ttydir);"
    },
    {
        "line": 11,
        "fullcodeline": "if (ret >= sizeof(path))"
    },
    {
        "line": 14,
        "fullcodeline": "if (ret && errno != EEXIST) {"
    },
    {
        "line": 39,
        "fullcodeline": "if (ret >= 0)"
    },
    {
        "line": 47,
        "fullcodeline": "if (mount(console->name, lxcpath, \"none\", MS_BIND, 0)) {"
    },
    {
        "line": 58,
        "fullcodeline": "ret = symlink(lxcpath, path);"
    },
    {
        "line": 29,
        "fullcodeline": "if (ret && errno != ENOENT) {"
    },
    {
        "line": 35,
        "fullcodeline": "if (ret==-1 && errno != EEXIST) {"
    },
    {
        "line": 12,
        "fullcodeline": "return -1;"
    },
    {
        "line": 16,
        "fullcodeline": "return -1;"
    },
    {
        "line": 24,
        "fullcodeline": "return -1;"
    },
    {
        "line": 31,
        "fullcodeline": "return -1;"
    },
    {
        "line": 37,
        "fullcodeline": "return -1;"
    },
    {
        "line": 49,
        "fullcodeline": "return -1;"
    },
    {
        "line": 56,
        "fullcodeline": "return -1;"
    },
    {
        "line": 61,
        "fullcodeline": "return -1;"
    }
]