[
    {
        "line": 4,
        "fullcodeline": "char path[MAXPATHLEN];"
    },
    {
        "line": 8,
        "fullcodeline": "INFO(\"Creating initial consoles under container /dev\");"
    },
    {
        "line": 10,
        "fullcodeline": "ret = snprintf(path, MAXPATHLEN, \"%s/dev\", rootfs->path ? rootfs->mount : \"\");"
    },
    {
        "line": 19,
        "fullcodeline": "INFO(\"Populating container /dev\");"
    },
    {
        "line": 20,
        "fullcodeline": "cmask = umask(S_IXUSR | S_IXGRP | S_IXOTH);"
    },
    {
        "line": 50,
        "fullcodeline": "umask(cmask);"
    },
    {
        "line": 52,
        "fullcodeline": "INFO(\"Populated container /dev\");"
    },
    {
        "line": 11,
        "fullcodeline": "if (ret < 0 || ret >= MAXPATHLEN) {"
    },
    {
        "line": 16,
        "fullcodeline": "if (!dir_exists(path))  // ignore, just don't try to fill in"
    },
    {
        "line": 21,
        "fullcodeline": "for (i = 0; i < sizeof(lxc_devs) / sizeof(lxc_devs[0]); i++) {"
    },
    {
        "line": 12,
        "fullcodeline": "ERROR(\"Error calculating container /dev location\");"
    },
    {
        "line": 23,
        "fullcodeline": "ret = snprintf(path, MAXPATHLEN, \"%s/dev/%s\", rootfs->path ? rootfs->mount : \"\", d->name);"
    },
    {
        "line": 26,
        "fullcodeline": "ret = mknod(path, d->mode, makedev(d->maj, d->min));"
    },
    {
        "line": 13,
        "fullcodeline": "return -1;"
    },
    {
        "line": 24,
        "fullcodeline": "if (ret < 0 || ret >= MAXPATHLEN)"
    },
    {
        "line": 27,
        "fullcodeline": "if (ret && errno != EEXIST) {"
    },
    {
        "line": 28,
        "fullcodeline": "char hostpath[MAXPATHLEN];"
    },
    {
        "line": 33,
        "fullcodeline": "ret = snprintf(hostpath, MAXPATHLEN, \"/dev/%s\", d->name);"
    },
    {
        "line": 36,
        "fullcodeline": "pathfile = fopen(path, \"wb\");"
    },
    {
        "line": 41,
        "fullcodeline": "fclose(pathfile);"
    },
    {
        "line": 25,
        "fullcodeline": "return -1;"
    },
    {
        "line": 34,
        "fullcodeline": "if (ret < 0 || ret >= MAXPATHLEN)"
    },
    {
        "line": 37,
        "fullcodeline": "if (!pathfile) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (safe_mount(hostpath, path, 0, MS_BIND, NULL,"
    },
    {
        "line": 38,
        "fullcodeline": "SYSERROR(\"Failed to create device mount target '%s'\", path);"
    },
    {
        "line": 44,
        "fullcodeline": "SYSERROR(\"Failed bind mounting device %s from host into container\","
    },
    {
        "line": 35,
        "fullcodeline": "return -1;"
    },
    {
        "line": 39,
        "fullcodeline": "return -1;"
    },
    {
        "line": 43,
        "fullcodeline": "rootfs->path ? rootfs->mount : NULL) != 0) {"
    },
    {
        "line": 46,
        "fullcodeline": "return -1;"
    }
]