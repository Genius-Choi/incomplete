[
    {
        "line": 3,
        "fullcodeline": "size_t bufsz = strlen(root) + sizeof(\"/sys/fs/cgroup\");"
    },
    {
        "line": 4,
        "fullcodeline": "char *path = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "char **parts = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "char *dirname = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "char *abs_path = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "char *abs_path2 = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "int r, saved_errno = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "cgfs_d = hdata;"
    },
    {
        "line": 16,
        "fullcodeline": "base_info = cgfs_d->info;"
    },
    {
        "line": 33,
        "fullcodeline": "path = calloc(1, bufsz);"
    },
    {
        "line": 36,
        "fullcodeline": "snprintf(path, bufsz, \"%s/sys/fs/cgroup\", root);"
    },
    {
        "line": 37,
        "fullcodeline": "r = safe_mount(\"cgroup_root\", path, \"tmpfs\","
    },
    {
        "line": 212,
        "fullcodeline": "saved_errno = errno;"
    },
    {
        "line": 14,
        "fullcodeline": "if (!cgfs_d)"
    },
    {
        "line": 22,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_FULL_NOSPEC)"
    },
    {
        "line": 34,
        "fullcodeline": "if (!path)"
    },
    {
        "line": 47,
        "fullcodeline": "for (info = base_info; info; info = info->next) {"
    },
    {
        "line": 23,
        "fullcodeline": "type = LXC_AUTO_CGROUP_FULL_MIXED;"
    },
    {
        "line": 27,
        "fullcodeline": "if (type < LXC_AUTO_CGROUP_RO || type > LXC_AUTO_CGROUP_FULL_MIXED) {"
    },
    {
        "line": 29,
        "fullcodeline": "errno = EINVAL;"
    },
    {
        "line": 38,
        "fullcodeline": "MS_NOSUID|MS_NODEV|MS_NOEXEC|MS_RELATIME,"
    },
    {
        "line": 49,
        "fullcodeline": "struct cgroup_mount_point *mp = info->designated_mount_point;"
    },
    {
        "line": 57,
        "fullcodeline": "subsystem_count = lxc_array_len((void **)info->hierarchy->subsystems);"
    },
    {
        "line": 58,
        "fullcodeline": "parts = calloc(subsystem_count + 1, sizeof(char *));"
    },
    {
        "line": 68,
        "fullcodeline": "dirname = lxc_string_join(\",\", (const char **)parts, false);"
    },
    {
        "line": 73,
        "fullcodeline": "abs_path = lxc_append_paths(path, dirname);"
    },
    {
        "line": 76,
        "fullcodeline": "r = mkdir_p(abs_path, 0755);"
    },
    {
        "line": 82,
        "fullcodeline": "abs_path2 = lxc_append_paths(abs_path, info->cgroup_path);"
    },
    {
        "line": 169,
        "fullcodeline": "abs_path = NULL;"
    },
    {
        "line": 170,
        "fullcodeline": "abs_path2 = NULL;"
    },
    {
        "line": 187,
        "fullcodeline": "dirname = NULL;"
    },
    {
        "line": 188,
        "fullcodeline": "parts = NULL;"
    },
    {
        "line": 50,
        "fullcodeline": "if (!mp)"
    },
    {
        "line": 52,
        "fullcodeline": "if (!mp) {"
    },
    {
        "line": 59,
        "fullcodeline": "if (!parts)"
    },
    {
        "line": 62,
        "fullcodeline": "for (i = 0; i < subsystem_count; i++) {"
    },
    {
        "line": 69,
        "fullcodeline": "if (!dirname)"
    },
    {
        "line": 74,
        "fullcodeline": "if (!abs_path)"
    },
    {
        "line": 77,
        "fullcodeline": "if (r < 0 && errno != EEXIST) {"
    },
    {
        "line": 83,
        "fullcodeline": "if (!abs_path2)"
    },
    {
        "line": 86,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_FULL_RO || type == LXC_AUTO_CGROUP_FULL_RW || type == LXC_AUTO_CGROUP_FULL_MIXED) {"
    },
    {
        "line": 173,
        "fullcodeline": "if (subsystem_count > 1) {"
    },
    {
        "line": 24,
        "fullcodeline": "else if (type == LXC_AUTO_CGROUP_NOSPEC)"
    },
    {
        "line": 51,
        "fullcodeline": "mp = lxc_cgroup_find_mount_point(info->hierarchy, info->cgroup_path, true);"
    },
    {
        "line": 78,
        "fullcodeline": "SYSERROR(\"could not create cgroup subsystem directory /sys/fs/cgroup/%s\", dirname);"
    },
    {
        "line": 94,
        "fullcodeline": "r = mount(mp->mount_point, abs_path, \"none\", MS_BIND, 0);"
    },
    {
        "line": 25,
        "fullcodeline": "type = LXC_AUTO_CGROUP_MIXED;"
    },
    {
        "line": 108,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_FULL_MIXED) {"
    },
    {
        "line": 122,
        "fullcodeline": "r = mkdir_p(abs_path2, 0755);"
    },
    {
        "line": 150,
        "fullcodeline": "abs_path = cgroup_to_absolute_path(mp, info->cgroup_path, NULL);"
    },
    {
        "line": 153,
        "fullcodeline": "r = mount(abs_path, abs_path2, \"none\", MS_BIND, 0);"
    },
    {
        "line": 174,
        "fullcodeline": "for (i = 0; i < subsystem_count; i++) {"
    },
    {
        "line": 63,
        "fullcodeline": "if (!strncmp(info->hierarchy->subsystems[i], \"name=\", 5))"
    },
    {
        "line": 64,
        "fullcodeline": "parts[i] = info->hierarchy->subsystems[i] + 5;"
    },
    {
        "line": 88,
        "fullcodeline": "if (strcmp(mp->mount_prefix, \"/\") != 0) {"
    },
    {
        "line": 91,
        "fullcodeline": "ERROR(\"could not automatically mount cgroup-full to /sys/fs/cgroup/%s: host has no mount point for this cgroup filesystem that has access to the root cgroup\", dirname);"
    },
    {
        "line": 96,
        "fullcodeline": "SYSERROR(\"error bind-mounting %s to %s\", mp->mount_point, abs_path);"
    },
    {
        "line": 100,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_FULL_RO || type == LXC_AUTO_CGROUP_FULL_MIXED) {"
    },
    {
        "line": 101,
        "fullcodeline": "r = mount(NULL, abs_path, NULL, MS_REMOUNT|MS_BIND|MS_RDONLY, NULL);"
    },
    {
        "line": 109,
        "fullcodeline": "r = mount(abs_path2, abs_path2, NULL, MS_BIND, NULL);"
    },
    {
        "line": 114,
        "fullcodeline": "r = mount(NULL, abs_path2, NULL, MS_REMOUNT|MS_BIND, NULL);"
    },
    {
        "line": 123,
        "fullcodeline": "if (r < 0 && errno != EEXIST) {"
    },
    {
        "line": 151,
        "fullcodeline": "if (!abs_path)"
    },
    {
        "line": 158,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_RO) {"
    },
    {
        "line": 175,
        "fullcodeline": "abs_path = lxc_append_paths(path, parts[i]);"
    },
    {
        "line": 178,
        "fullcodeline": "r = symlink(dirname, abs_path);"
    },
    {
        "line": 182,
        "fullcodeline": "abs_path = NULL;"
    },
    {
        "line": 66,
        "fullcodeline": "parts[i] = info->hierarchy->subsystems[i];"
    },
    {
        "line": 124,
        "fullcodeline": "SYSERROR(\"could not create cgroup directory /sys/fs/cgroup/%s%s\", dirname, info->cgroup_path);"
    },
    {
        "line": 133,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_MIXED || type == LXC_AUTO_CGROUP_RO) {"
    },
    {
        "line": 134,
        "fullcodeline": "r = mount(abs_path, abs_path, NULL, MS_BIND, NULL);"
    },
    {
        "line": 139,
        "fullcodeline": "r = mount(NULL, abs_path, NULL, MS_REMOUNT|MS_BIND|MS_RDONLY, NULL);"
    },
    {
        "line": 155,
        "fullcodeline": "SYSERROR(\"error bind-mounting %s to %s\", abs_path, abs_path2);"
    },
    {
        "line": 159,
        "fullcodeline": "r = mount(NULL, abs_path2, NULL, MS_REMOUNT|MS_BIND|MS_RDONLY, NULL);"
    },
    {
        "line": 176,
        "fullcodeline": "if (!abs_path)"
    },
    {
        "line": 103,
        "fullcodeline": "SYSERROR(\"error re-mounting %s readonly\", abs_path);"
    },
    {
        "line": 111,
        "fullcodeline": "SYSERROR(\"error bind-mounting %s onto itself\", abs_path2);"
    },
    {
        "line": 116,
        "fullcodeline": "SYSERROR(\"error re-mounting %s readwrite\", abs_path2);"
    },
    {
        "line": 180,
        "fullcodeline": "WARN(\"could not create symlink %s -> %s in /sys/fs/cgroup of container\", parts[i], dirname);"
    },
    {
        "line": 136,
        "fullcodeline": "SYSERROR(\"error bind-mounting %s onto itself\", abs_path);"
    },
    {
        "line": 141,
        "fullcodeline": "SYSERROR(\"error re-mounting %s readonly\", abs_path);"
    },
    {
        "line": 161,
        "fullcodeline": "SYSERROR(\"error re-mounting %s readonly\", abs_path2);"
    }
]