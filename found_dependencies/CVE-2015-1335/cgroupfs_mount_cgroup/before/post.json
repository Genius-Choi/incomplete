[
    {
        "line": 3,
        "fullcodeline": "size_t bufsz = strlen(root) + sizeof(\"/sys/fs/cgroup\");"
    },
    {
        "line": 4,
        "fullcodeline": "char *path = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "char **parts = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "char *dirname = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "char *abs_path = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "char *abs_path2 = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "int r, saved_errno = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "cgfs_d = hdata;"
    },
    {
        "line": 16,
        "fullcodeline": "base_info = cgfs_d->info;"
    },
    {
        "line": 33,
        "fullcodeline": "path = calloc(1, bufsz);"
    },
    {
        "line": 36,
        "fullcodeline": "snprintf(path, bufsz, \"%s/sys/fs/cgroup\", root);"
    },
    {
        "line": 37,
        "fullcodeline": "r = mount(\"cgroup_root\", path, \"tmpfs\", MS_NOSUID|MS_NODEV|MS_NOEXEC|MS_RELATIME, \"size=10240k,mode=755\");"
    },
    {
        "line": 204,
        "fullcodeline": "free(path);"
    },
    {
        "line": 209,
        "fullcodeline": "saved_errno = errno;"
    },
    {
        "line": 210,
        "fullcodeline": "free(path);"
    },
    {
        "line": 211,
        "fullcodeline": "free(dirname);"
    },
    {
        "line": 212,
        "fullcodeline": "free(parts);"
    },
    {
        "line": 213,
        "fullcodeline": "free(abs_path);"
    },
    {
        "line": 214,
        "fullcodeline": "free(abs_path2);"
    },
    {
        "line": 215,
        "fullcodeline": "errno = saved_errno;"
    },
    {
        "line": 14,
        "fullcodeline": "if (!cgfs_d)"
    },
    {
        "line": 22,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_FULL_NOSPEC)"
    },
    {
        "line": 27,
        "fullcodeline": "if (type < LXC_AUTO_CGROUP_RO || type > LXC_AUTO_CGROUP_FULL_MIXED) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (!path)"
    },
    {
        "line": 38,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 44,
        "fullcodeline": "for (info = base_info; info; info = info->next) {"
    },
    {
        "line": 23,
        "fullcodeline": "type = LXC_AUTO_CGROUP_FULL_MIXED;"
    },
    {
        "line": 28,
        "fullcodeline": "ERROR(\"could not mount cgroups into container: invalid type specified internally\");"
    },
    {
        "line": 29,
        "fullcodeline": "errno = EINVAL;"
    },
    {
        "line": 39,
        "fullcodeline": "SYSERROR(\"could not mount tmpfs to /sys/fs/cgroup in the container\");"
    },
    {
        "line": 46,
        "fullcodeline": "struct cgroup_mount_point *mp = info->designated_mount_point;"
    },
    {
        "line": 54,
        "fullcodeline": "subsystem_count = lxc_array_len((void **)info->hierarchy->subsystems);"
    },
    {
        "line": 55,
        "fullcodeline": "parts = calloc(subsystem_count + 1, sizeof(char *));"
    },
    {
        "line": 65,
        "fullcodeline": "dirname = lxc_string_join(\",\", (const char **)parts, false);"
    },
    {
        "line": 70,
        "fullcodeline": "abs_path = lxc_append_paths(path, dirname);"
    },
    {
        "line": 73,
        "fullcodeline": "r = mkdir_p(abs_path, 0755);"
    },
    {
        "line": 79,
        "fullcodeline": "abs_path2 = lxc_append_paths(abs_path, info->cgroup_path);"
    },
    {
        "line": 164,
        "fullcodeline": "free(abs_path);"
    },
    {
        "line": 165,
        "fullcodeline": "free(abs_path2);"
    },
    {
        "line": 166,
        "fullcodeline": "abs_path = NULL;"
    },
    {
        "line": 167,
        "fullcodeline": "abs_path2 = NULL;"
    },
    {
        "line": 182,
        "fullcodeline": "free(dirname);"
    },
    {
        "line": 183,
        "fullcodeline": "free(parts);"
    },
    {
        "line": 184,
        "fullcodeline": "dirname = NULL;"
    },
    {
        "line": 185,
        "fullcodeline": "parts = NULL;"
    },
    {
        "line": 47,
        "fullcodeline": "if (!mp)"
    },
    {
        "line": 49,
        "fullcodeline": "if (!mp) {"
    },
    {
        "line": 56,
        "fullcodeline": "if (!parts)"
    },
    {
        "line": 59,
        "fullcodeline": "for (i = 0; i < subsystem_count; i++) {"
    },
    {
        "line": 66,
        "fullcodeline": "if (!dirname)"
    },
    {
        "line": 71,
        "fullcodeline": "if (!abs_path)"
    },
    {
        "line": 74,
        "fullcodeline": "if (r < 0 && errno != EEXIST) {"
    },
    {
        "line": 80,
        "fullcodeline": "if (!abs_path2)"
    },
    {
        "line": 83,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_FULL_RO || type == LXC_AUTO_CGROUP_FULL_RW || type == LXC_AUTO_CGROUP_FULL_MIXED) {"
    },
    {
        "line": 170,
        "fullcodeline": "if (subsystem_count > 1) {"
    },
    {
        "line": 24,
        "fullcodeline": "else if (type == LXC_AUTO_CGROUP_NOSPEC)"
    },
    {
        "line": 48,
        "fullcodeline": "mp = lxc_cgroup_find_mount_point(info->hierarchy, info->cgroup_path, true);"
    },
    {
        "line": 50,
        "fullcodeline": "SYSERROR(\"could not find original mount point for cgroup hierarchy while trying to mount cgroup filesystem\");"
    },
    {
        "line": 75,
        "fullcodeline": "SYSERROR(\"could not create cgroup subsystem directory /sys/fs/cgroup/%s\", dirname);"
    },
    {
        "line": 91,
        "fullcodeline": "r = mount(mp->mount_point, abs_path, \"none\", MS_BIND, 0);"
    },
    {
        "line": 25,
        "fullcodeline": "type = LXC_AUTO_CGROUP_MIXED;"
    },
    {
        "line": 60,
        "fullcodeline": "if (!strncmp(info->hierarchy->subsystems[i], \"name=\", 5))"
    },
    {
        "line": 85,
        "fullcodeline": "if (strcmp(mp->mount_prefix, \"/\") != 0) {"
    },
    {
        "line": 92,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 97,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_FULL_RO || type == LXC_AUTO_CGROUP_FULL_MIXED) {"
    },
    {
        "line": 105,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_FULL_MIXED) {"
    },
    {
        "line": 119,
        "fullcodeline": "r = mkdir_p(abs_path2, 0755);"
    },
    {
        "line": 143,
        "fullcodeline": "free(abs_path);"
    },
    {
        "line": 144,
        "fullcodeline": "abs_path = NULL;"
    },
    {
        "line": 147,
        "fullcodeline": "abs_path = cgroup_to_absolute_path(mp, info->cgroup_path, NULL);"
    },
    {
        "line": 150,
        "fullcodeline": "r = mount(abs_path, abs_path2, \"none\", MS_BIND, 0);"
    },
    {
        "line": 171,
        "fullcodeline": "for (i = 0; i < subsystem_count; i++) {"
    },
    {
        "line": 61,
        "fullcodeline": "parts[i] = info->hierarchy->subsystems[i] + 5;"
    },
    {
        "line": 88,
        "fullcodeline": "ERROR(\"could not automatically mount cgroup-full to /sys/fs/cgroup/%s: host has no mount point for this cgroup filesystem that has access to the root cgroup\", dirname);"
    },
    {
        "line": 93,
        "fullcodeline": "SYSERROR(\"error bind-mounting %s to %s\", mp->mount_point, abs_path);"
    },
    {
        "line": 98,
        "fullcodeline": "r = mount(NULL, abs_path, NULL, MS_REMOUNT|MS_BIND|MS_RDONLY, NULL);"
    },
    {
        "line": 106,
        "fullcodeline": "r = mount(abs_path2, abs_path2, NULL, MS_BIND, NULL);"
    },
    {
        "line": 111,
        "fullcodeline": "r = mount(NULL, abs_path2, NULL, MS_REMOUNT|MS_BIND, NULL);"
    },
    {
        "line": 120,
        "fullcodeline": "if (r < 0 && errno != EEXIST) {"
    },
    {
        "line": 130,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_MIXED || type == LXC_AUTO_CGROUP_RO) {"
    },
    {
        "line": 148,
        "fullcodeline": "if (!abs_path)"
    },
    {
        "line": 151,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 155,
        "fullcodeline": "if (type == LXC_AUTO_CGROUP_RO) {"
    },
    {
        "line": 172,
        "fullcodeline": "abs_path = lxc_append_paths(path, parts[i]);"
    },
    {
        "line": 175,
        "fullcodeline": "r = symlink(dirname, abs_path);"
    },
    {
        "line": 178,
        "fullcodeline": "free(abs_path);"
    },
    {
        "line": 179,
        "fullcodeline": "abs_path = NULL;"
    },
    {
        "line": 63,
        "fullcodeline": "parts[i] = info->hierarchy->subsystems[i];"
    },
    {
        "line": 99,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 107,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 112,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 121,
        "fullcodeline": "SYSERROR(\"could not create cgroup directory /sys/fs/cgroup/%s%s\", dirname, info->cgroup_path);"
    },
    {
        "line": 131,
        "fullcodeline": "r = mount(abs_path, abs_path, NULL, MS_BIND, NULL);"
    },
    {
        "line": 136,
        "fullcodeline": "r = mount(NULL, abs_path, NULL, MS_REMOUNT|MS_BIND|MS_RDONLY, NULL);"
    },
    {
        "line": 152,
        "fullcodeline": "SYSERROR(\"error bind-mounting %s to %s\", abs_path, abs_path2);"
    },
    {
        "line": 156,
        "fullcodeline": "r = mount(NULL, abs_path2, NULL, MS_REMOUNT|MS_BIND|MS_RDONLY, NULL);"
    },
    {
        "line": 173,
        "fullcodeline": "if (!abs_path)"
    },
    {
        "line": 176,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 100,
        "fullcodeline": "SYSERROR(\"error re-mounting %s readonly\", abs_path);"
    },
    {
        "line": 108,
        "fullcodeline": "SYSERROR(\"error bind-mounting %s onto itself\", abs_path2);"
    },
    {
        "line": 113,
        "fullcodeline": "SYSERROR(\"error re-mounting %s readwrite\", abs_path2);"
    },
    {
        "line": 132,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 137,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 157,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 177,
        "fullcodeline": "WARN(\"could not create symlink %s -> %s in /sys/fs/cgroup of container\", parts[i], dirname);"
    },
    {
        "line": 133,
        "fullcodeline": "SYSERROR(\"error bind-mounting %s onto itself\", abs_path);"
    },
    {
        "line": 138,
        "fullcodeline": "SYSERROR(\"error re-mounting %s readonly\", abs_path);"
    },
    {
        "line": 158,
        "fullcodeline": "SYSERROR(\"error re-mounting %s readonly\", abs_path2);"
    }
]