[
    {
        "line": 4,
        "fullcodeline": "int srcfd = -1, destfd, ret, saved_errno;"
    },
    {
        "line": 5,
        "fullcodeline": "char srcbuf[50], destbuf[50]; // only needs enough for /proc/self/fd/<fd>"
    },
    {
        "line": 6,
        "fullcodeline": "const char *mntsrc = src;"
    },
    {
        "line": 26,
        "fullcodeline": "destfd = open_without_symlink(dest, rootfs);"
    },
    {
        "line": 33,
        "fullcodeline": "ret = snprintf(destbuf, 50, \"/proc/self/fd/%d\", destfd);"
    },
    {
        "line": 42,
        "fullcodeline": "ret = mount(mntsrc, destbuf, fstype, flags, data);"
    },
    {
        "line": 43,
        "fullcodeline": "saved_errno = errno;"
    },
    {
        "line": 46,
        "fullcodeline": "close(destfd);"
    },
    {
        "line": 8,
        "fullcodeline": "if (!rootfs)"
    },
    {
        "line": 12,
        "fullcodeline": "if (flags & MS_BIND && src && src[0] != '/') {"
    },
    {
        "line": 27,
        "fullcodeline": "if (destfd < 0) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (ret < 0 || ret > 50) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (srcfd != -1)"
    },
    {
        "line": 47,
        "fullcodeline": "if (ret < 0) {"
    },
    {
        "line": 9,
        "fullcodeline": "rootfs = \"\";"
    },
    {
        "line": 13,
        "fullcodeline": "INFO(\"this is a relative bind mount\");"
    },
    {
        "line": 14,
        "fullcodeline": "srcfd = open_without_symlink(src, NULL);"
    },
    {
        "line": 17,
        "fullcodeline": "ret = snprintf(srcbuf, 50, \"/proc/self/fd/%d\", srcfd);"
    },
    {
        "line": 23,
        "fullcodeline": "mntsrc = srcbuf;"
    },
    {
        "line": 37,
        "fullcodeline": "close(destfd);"
    },
    {
        "line": 38,
        "fullcodeline": "ERROR(\"Out of memory\");"
    },
    {
        "line": 45,
        "fullcodeline": "close(srcfd);"
    },
    {
        "line": 48,
        "fullcodeline": "errno = saved_errno;"
    },
    {
        "line": 49,
        "fullcodeline": "SYSERROR(\"Failed to mount %s onto %s\", src, dest);"
    },
    {
        "line": 15,
        "fullcodeline": "if (srcfd < 0)"
    },
    {
        "line": 18,
        "fullcodeline": "if (ret < 0 || ret > 50) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (srcfd != -1)"
    },
    {
        "line": 35,
        "fullcodeline": "if (srcfd != -1)"
    },
    {
        "line": 39,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 19,
        "fullcodeline": "close(srcfd);"
    },
    {
        "line": 20,
        "fullcodeline": "ERROR(\"Out of memory\");"
    },
    {
        "line": 29,
        "fullcodeline": "close(srcfd);"
    },
    {
        "line": 36,
        "fullcodeline": "close(srcfd);"
    },
    {
        "line": 21,
        "fullcodeline": "return -EINVAL;"
    }
]