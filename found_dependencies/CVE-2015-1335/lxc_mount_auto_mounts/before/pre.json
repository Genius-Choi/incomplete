[
    {
        "line": 13,
        "fullcodeline": "} default_mounts[] = {"
    },
    {
        "line": 44,
        "fullcodeline": "for (i = 0; default_mounts[i].match_mask; i++) {"
    },
    {
        "line": 90,
        "fullcodeline": "if (flags & LXC_AUTO_CGROUP_MASK) {"
    },
    {
        "line": 25,
        "fullcodeline": "{ LXC_AUTO_PROC_MASK, LXC_AUTO_PROC_MIXED, \"proc\",                                              \"%r/proc\",                      \"proc\",     MS_NODEV|MS_NOEXEC|MS_NOSUID,   NULL },"
    },
    {
        "line": 26,
        "fullcodeline": "{ LXC_AUTO_PROC_MASK, LXC_AUTO_PROC_MIXED, \"%r/proc/sys/net\",                                   \"%r/proc/net\",                  NULL,       MS_BIND,                        NULL },"
    },
    {
        "line": 27,
        "fullcodeline": "{ LXC_AUTO_PROC_MASK, LXC_AUTO_PROC_MIXED, \"%r/proc/sys\",                                       \"%r/proc/sys\",                  NULL,       MS_BIND,                        NULL },"
    },
    {
        "line": 28,
        "fullcodeline": "{ LXC_AUTO_PROC_MASK, LXC_AUTO_PROC_MIXED, NULL,                                                \"%r/proc/sys\",                  NULL,       MS_REMOUNT|MS_BIND|MS_RDONLY,   NULL },"
    },
    {
        "line": 29,
        "fullcodeline": "{ LXC_AUTO_PROC_MASK, LXC_AUTO_PROC_MIXED, \"%r/proc/net\",                                       \"%r/proc/sys/net\",              NULL,       MS_MOVE,                        NULL },"
    },
    {
        "line": 30,
        "fullcodeline": "{ LXC_AUTO_PROC_MASK, LXC_AUTO_PROC_MIXED, \"%r/proc/sysrq-trigger\",                             \"%r/proc/sysrq-trigger\",        NULL,       MS_BIND,                        NULL },"
    },
    {
        "line": 31,
        "fullcodeline": "{ LXC_AUTO_PROC_MASK, LXC_AUTO_PROC_MIXED, NULL,                                                \"%r/proc/sysrq-trigger\",        NULL,       MS_REMOUNT|MS_BIND|MS_RDONLY,   NULL },"
    },
    {
        "line": 32,
        "fullcodeline": "{ LXC_AUTO_PROC_MASK, LXC_AUTO_PROC_RW,    \"proc\",                                              \"%r/proc\",                      \"proc\",     MS_NODEV|MS_NOEXEC|MS_NOSUID,   NULL },"
    },
    {
        "line": 33,
        "fullcodeline": "{ LXC_AUTO_SYS_MASK,  LXC_AUTO_SYS_RW,     \"sysfs\",                                             \"%r/sys\",                       \"sysfs\",    0,                              NULL },"
    },
    {
        "line": 34,
        "fullcodeline": "{ LXC_AUTO_SYS_MASK,  LXC_AUTO_SYS_RO,     \"sysfs\",                                             \"%r/sys\",                       \"sysfs\",    MS_RDONLY,                      NULL },"
    },
    {
        "line": 35,
        "fullcodeline": "{ LXC_AUTO_SYS_MASK,  LXC_AUTO_SYS_MIXED,  \"sysfs\",                                             \"%r/sys\",                       \"sysfs\",    MS_NODEV|MS_NOEXEC|MS_NOSUID,   NULL },"
    },
    {
        "line": 36,
        "fullcodeline": "{ LXC_AUTO_SYS_MASK,  LXC_AUTO_SYS_MIXED,  \"%r/sys\",                                            \"%r/sys\",                       NULL,       MS_BIND,                        NULL },"
    },
    {
        "line": 37,
        "fullcodeline": "{ LXC_AUTO_SYS_MASK,  LXC_AUTO_SYS_MIXED,  NULL,                                                \"%r/sys\",                       NULL,       MS_REMOUNT|MS_BIND|MS_RDONLY,   NULL },"
    },
    {
        "line": 38,
        "fullcodeline": "{ LXC_AUTO_SYS_MASK,  LXC_AUTO_SYS_MIXED,  \"sysfs\",                                             \"%r/sys/devices/virtual/net\",   \"sysfs\",    0,                              NULL },"
    },
    {
        "line": 39,
        "fullcodeline": "{ LXC_AUTO_SYS_MASK,  LXC_AUTO_SYS_MIXED,  \"%r/sys/devices/virtual/net/devices/virtual/net\",    \"%r/sys/devices/virtual/net\",   NULL,       MS_BIND,                        NULL },"
    },
    {
        "line": 40,
        "fullcodeline": "{ LXC_AUTO_SYS_MASK,  LXC_AUTO_SYS_MIXED,  NULL,                                                \"%r/sys/devices/virtual/net\",   NULL,       MS_REMOUNT|MS_BIND|MS_NOSUID|MS_NODEV|MS_NOEXEC,   NULL },"
    },
    {
        "line": 41,
        "fullcodeline": "{ 0,                  0,                   NULL,                                                NULL,                           NULL,       0,                              NULL }"
    },
    {
        "line": 93,
        "fullcodeline": "cg_flags = flags & LXC_AUTO_CGROUP_MASK;"
    },
    {
        "line": 45,
        "fullcodeline": "if ((flags & default_mounts[i].match_mask) == default_mounts[i].match_flag) {"
    },
    {
        "line": 46,
        "fullcodeline": "char *source = NULL;"
    },
    {
        "line": 47,
        "fullcodeline": "char *destination = NULL;"
    },
    {
        "line": 70,
        "fullcodeline": "mflags = add_required_remount_flags(source, destination,"
    },
    {
        "line": 72,
        "fullcodeline": "r = mount(source, destination, default_mounts[i].fstype, mflags, default_mounts[i].options);"
    },
    {
        "line": 73,
        "fullcodeline": "saved_errno = errno;"
    },
    {
        "line": 102,
        "fullcodeline": "if (cg_flags == LXC_AUTO_CGROUP_NOSPEC || cg_flags == LXC_AUTO_CGROUP_FULL_NOSPEC) {"
    },
    {
        "line": 116,
        "fullcodeline": "if (!cgroup_mount(conf->rootfs.path ? conf->rootfs.mount : \"\", handler, cg_flags)) {"
    },
    {
        "line": 74,
        "fullcodeline": "if (r < 0 && errno == ENOENT) {"
    },
    {
        "line": 83,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 118,
        "fullcodeline": "return -1;"
    },
    {
        "line": 53,
        "fullcodeline": "source = lxc_string_replace(\"%r\", conf->rootfs.path ? conf->rootfs.mount : \"\", default_mounts[i].source);"
    },
    {
        "line": 61,
        "fullcodeline": "destination = lxc_string_replace(\"%r\", conf->rootfs.path ? conf->rootfs.mount : \"\", default_mounts[i].destination);"
    },
    {
        "line": 75,
        "fullcodeline": "INFO(\"Mount source or target for %s on %s doesn't exist. Skipping.\", source, destination);"
    },
    {
        "line": 76,
        "fullcodeline": "r = 0;"
    },
    {
        "line": 104,
        "fullcodeline": "if (!lxc_list_empty(&conf->keepcaps)) {"
    },
    {
        "line": 110,
        "fullcodeline": "cg_flags = has_sys_admin ? LXC_AUTO_CGROUP_RW : LXC_AUTO_CGROUP_MIXED;"
    },
    {
        "line": 54,
        "fullcodeline": "if (!source) {"
    },
    {
        "line": 62,
        "fullcodeline": "if (!destination) {"
    },
    {
        "line": 85,
        "fullcodeline": "return -1;"
    },
    {
        "line": 105,
        "fullcodeline": "has_sys_admin = in_caplist(CAP_SYS_ADMIN, &conf->keepcaps);"
    },
    {
        "line": 112,
        "fullcodeline": "cg_flags = has_sys_admin ? LXC_AUTO_CGROUP_FULL_RW : LXC_AUTO_CGROUP_FULL_MIXED;"
    },
    {
        "line": 55,
        "fullcodeline": "SYSERROR(\"memory allocation error\");"
    },
    {
        "line": 63,
        "fullcodeline": "saved_errno = errno;"
    },
    {
        "line": 78,
        "fullcodeline": "else if (r < 0)"
    },
    {
        "line": 107,
        "fullcodeline": "has_sys_admin = !in_caplist(CAP_SYS_ADMIN, &conf->caps);"
    },
    {
        "line": 56,
        "fullcodeline": "return -1;"
    },
    {
        "line": 67,
        "fullcodeline": "return -1;"
    },
    {
        "line": 79,
        "fullcodeline": "SYSERROR(\"error mounting %s on %s flags %lu\", source, destination, mflags);"
    }
]