[
    {
        "line": 12,
        "fullcodeline": "raise HTTPException(status_code=404, detail=f'resource \"{key}\" not found')"
    },
    {
        "line": 2,
        "fullcodeline": "if key in resources:"
    },
    {
        "line": 3,
        "fullcodeline": "filepath = resources[key].path / path"
    },
    {
        "line": 8,
        "fullcodeline": "if filepath.exists():"
    },
    {
        "line": 9,
        "fullcodeline": "headers = {'Cache-Control': 'public, max-age=3600'}"
    },
    {
        "line": 5,
        "fullcodeline": "filepath.resolve().relative_to(resources[key].path.resolve())  # NOTE: use is_relative_to() in Python 3.9"
    },
    {
        "line": 10,
        "fullcodeline": "media_type, _ = mimetypes.guess_type(filepath)"
    },
    {
        "line": 11,
        "fullcodeline": "return FileResponse(filepath, media_type=media_type, headers=headers)"
    },
    {
        "line": 7,
        "fullcodeline": "raise HTTPException(status_code=403, detail='forbidden') from e"
    }
]