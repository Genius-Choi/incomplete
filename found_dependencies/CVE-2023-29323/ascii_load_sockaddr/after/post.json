[
    {
        "line": 3,
        "fullcodeline": "if (!strcmp(\"local\", buf)) {"
    },
    {
        "line": 4,
        "fullcodeline": "ss->ss_family = AF_LOCAL;"
    },
    {
        "line": 6,
        "fullcodeline": "else if (buf[0] == '[' && buf[strlen(buf)-1] == ']') {"
    },
    {
        "line": 9,
        "fullcodeline": "buf[strlen(buf)-1] = '\\0';"
    },
    {
        "line": 12,
        "fullcodeline": "memset(&hints, 0, sizeof(hints));"
    },
    {
        "line": 13,
        "fullcodeline": "hints.ai_family = AF_INET6;"
    },
    {
        "line": 14,
        "fullcodeline": "hints.ai_flags = AI_NUMERICHOST;"
    },
    {
        "line": 17,
        "fullcodeline": "memcpy(ss, res0->ai_addr, res0->ai_addrlen);"
    },
    {
        "line": 18,
        "fullcodeline": "ss->ss_len = res0->ai_addrlen;"
    },
    {
        "line": 19,
        "fullcodeline": "freeaddrinfo(res0);"
    },
    {
        "line": 15,
        "fullcodeline": "if (getaddrinfo(buf+1, NULL, &hints, &res0) != 0)"
    },
    {
        "line": 24,
        "fullcodeline": "memset(&ssin, 0, sizeof ssin);"
    },
    {
        "line": 27,
        "fullcodeline": "ssin.sin_family = AF_INET;"
    },
    {
        "line": 28,
        "fullcodeline": "memcpy(ss, &ssin, sizeof(ssin));"
    },
    {
        "line": 25,
        "fullcodeline": "if (inet_pton(AF_INET, buf, &ssin.sin_addr) != 1)"
    }
]