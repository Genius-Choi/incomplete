[
    {
        "line": 2,
        "fullcodeline": "FILE *fp = openr(ip);"
    },
    {
        "line": 4,
        "fullcodeline": "bool openwdone = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "uint8_t *x = 0, *b = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "png_struct *p = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "png_info *n = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "uint8_t i[12];"
    },
    {
        "line": 9,
        "fullcodeline": "char *k[] = {\"Out of memory\", \"Broken config, file a bug report\","
    },
    {
        "line": 20,
        "fullcodeline": "size_t l = ((uint32_t)(i[4] | (i[5] << 8) | (i[6] << 16) | (i[7] << 24))) + 8;"
    },
    {
        "line": 22,
        "fullcodeline": "x = malloc(l);"
    },
    {
        "line": 27,
        "fullcodeline": "memcpy(x, i, 12); // should optimize out"
    },
    {
        "line": 32,
        "fullcodeline": "fclose(fp);"
    },
    {
        "line": 36,
        "fullcodeline": "WebPDecoderConfig c = {.options.use_threads = 1};"
    },
    {
        "line": 39,
        "fullcodeline": "VP8StatusCode r = WebPGetFeatures(x, l, &I);"
    },
    {
        "line": 54,
        "fullcodeline": "char *f[] = {\"undefined/mixed\", \"lossy\", \"lossless\"};"
    },
    {
        "line": 74,
        "fullcodeline": "b = malloc(W * H * B);"
    },
    {
        "line": 86,
        "fullcodeline": "c.output.colorspace = A ? MODE_RGBA : MODE_RGB;"
    },
    {
        "line": 87,
        "fullcodeline": "c.output.is_external_memory = 1;"
    },
    {
        "line": 89,
        "fullcodeline": "D.rgba = b;"
    },
    {
        "line": 90,
        "fullcodeline": "D.stride = (int)(W * B);"
    },
    {
        "line": 91,
        "fullcodeline": "D.size = W * H * B;"
    },
    {
        "line": 92,
        "fullcodeline": "r = WebPDecode(x, l, &c);"
    },
    {
        "line": 98,
        "fullcodeline": "free(x);"
    },
    {
        "line": 99,
        "fullcodeline": "x = 0;"
    },
    {
        "line": 101,
        "fullcodeline": "openwdone = !!op;"
    },
    {
        "line": 102,
        "fullcodeline": "p = png_create_write_struct(PNG_LIBPNG_VER_STRING, op, pngwerr, pngwarn);"
    },
    {
        "line": 107,
        "fullcodeline": "n = png_create_info_struct(p);"
    },
    {
        "line": 122,
        "fullcodeline": "pnglen = 0;"
    },
    {
        "line": 123,
        "fullcodeline": "png_set_write_fn(p, fp, pngwrite, pngflush);"
    },
    {
        "line": 124,
        "fullcodeline": "png_set_filter(p, 0, PNG_ALL_FILTERS);"
    },
    {
        "line": 125,
        "fullcodeline": "png_set_compression_level(p, 9);"
    },
    {
        "line": 127,
        "fullcodeline": "png_set_IHDR(p, n, W, H, 8, A ? 6 : 2, 0, 0, 0);"
    },
    {
        "line": 128,
        "fullcodeline": "png_write_info(p, n);"
    },
    {
        "line": 129,
        "fullcodeline": "uint8_t *w = b;"
    },
    {
        "line": 134,
        "fullcodeline": "png_write_end(p, n);"
    },
    {
        "line": 135,
        "fullcodeline": "png_destroy_write_struct(&p, &n);"
    },
    {
        "line": 136,
        "fullcodeline": "p = 0;"
    },
    {
        "line": 137,
        "fullcodeline": "n = 0;"
    },
    {
        "line": 138,
        "fullcodeline": "free(b);"
    },
    {
        "line": 139,
        "fullcodeline": "b = 0;"
    },
    {
        "line": 3,
        "fullcodeline": "if(!fp) return 1;"
    },
    {
        "line": 12,
        "fullcodeline": "if(!fread(i, 12, 1, fp)) {"
    },
    {
        "line": 16,
        "fullcodeline": "if(memcmp(i, (char[4]){\"RIFF\"}, 4) || memcmp(i + 8, (char[4]){\"WEBP\"}, 4)) {"
    },
    {
        "line": 23,
        "fullcodeline": "if(!x) {"
    },
    {
        "line": 28,
        "fullcodeline": "if(!fread(x + 12, l - 12, 1, fp)) {"
    },
    {
        "line": 63,
        "fullcodeline": "if(I.has_animation) {"
    },
    {
        "line": 75,
        "fullcodeline": "if(!b) {"
    },
    {
        "line": 100,
        "fullcodeline": "if(!(fp = openw(op))) goto w2p_free;"
    },
    {
        "line": 103,
        "fullcodeline": "if(!p) {"
    },
    {
        "line": 108,
        "fullcodeline": "if(!n) {"
    },
    {
        "line": 112,
        "fullcodeline": "if(setjmp(png_jmpbuf(p))) {"
    },
    {
        "line": 130,
        "fullcodeline": "for(unsigned y = H; y; y--) {"
    },
    {
        "line": 140,
        "fullcodeline": "if(fclose(fp)) {"
    },
    {
        "line": 13,
        "fullcodeline": "PF(\"ERROR reading %s: %s\", IP, k[6]);"
    },
    {
        "line": 17,
        "fullcodeline": "PF(\"ERROR reading %s: %s\", IP, k[2]);"
    },
    {
        "line": 24,
        "fullcodeline": "PF(\"ERROR reading %s: %s\", IP, *k);"
    },
    {
        "line": 29,
        "fullcodeline": "PF(\"ERROR reading %s: %s\", IP, k[6]);"
    },
    {
        "line": 41,
        "fullcodeline": "PF(\"ERROR reading %s: %s\", IP, k[r - 1]);"
    },
    {
        "line": 64,
        "fullcodeline": "PF(\"ERROR reading %s: Unsupported feature: \" ANMSTR \"ion\", IP ANMARG);"
    },
    {
        "line": 76,
        "fullcodeline": "PF(\"ERROR reading %s: %s\", IP, *k);"
    },
    {
        "line": 94,
        "fullcodeline": "PF(\"ERROR reading %s: %s\", IP, k[r - 1]);"
    },
    {
        "line": 104,
        "fullcodeline": "PF(\"ERROR writing %s: %s\", OP, *k);"
    },
    {
        "line": 109,
        "fullcodeline": "PF(\"ERROR writing %s: %s\", OP, *k);"
    },
    {
        "line": 114,
        "fullcodeline": "fclose(fp);"
    },
    {
        "line": 117,
        "fullcodeline": "free(x);"
    },
    {
        "line": 118,
        "fullcodeline": "free(b);"
    },
    {
        "line": 119,
        "fullcodeline": "png_destroy_write_struct(&p, &n);"
    },
    {
        "line": 131,
        "fullcodeline": "png_write_row(p, w);"
    },
    {
        "line": 132,
        "fullcodeline": "w += W * B;"
    },
    {
        "line": 141,
        "fullcodeline": "PF(\"ERROR closing %s: %s\", OP, strerror(errno));"
    },
    {
        "line": 116,
        "fullcodeline": "if(openwdone) remove(op);"
    }
]