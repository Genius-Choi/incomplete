[
    {
        "line": 4,
        "fullcodeline": "piv_private_data_t * priv = PIV_DATA(card);"
    },
    {
        "line": 8,
        "fullcodeline": "u8 rbuf[128]; /* For EC conversions  384 will fit */"
    },
    {
        "line": 15,
        "fullcodeline": "SC_FUNC_CALLED(card->ctx, SC_LOG_DEBUG_VERBOSE);"
    },
    {
        "line": 74,
        "fullcodeline": "SC_FUNC_RETURN(card->ctx, SC_LOG_DEBUG_VERBOSE, r);"
    },
    {
        "line": 24,
        "fullcodeline": "if (priv->alg_id == 0x11 || priv->alg_id == 0x14 ) {"
    },
    {
        "line": 25,
        "fullcodeline": "nLen = (priv->key_size + 7) / 8;"
    },
    {
        "line": 33,
        "fullcodeline": "memset(out, 0, outlen);"
    },
    {
        "line": 35,
        "fullcodeline": "r = piv_validate_general_authentication(card, data, datalen, rbuf, sizeof rbuf);"
    },
    {
        "line": 39,
        "fullcodeline": "pseq = rbuf;"
    },
    {
        "line": 40,
        "fullcodeline": "r = sc_asn1_read_tag(&pseq, r, &cla, &tag, &seqlen);"
    },
    {
        "line": 44,
        "fullcodeline": "pint = pseq;"
    },
    {
        "line": 45,
        "fullcodeline": "pend = pseq + seqlen;"
    },
    {
        "line": 68,
        "fullcodeline": "r = 2 * nLen;"
    },
    {
        "line": 26,
        "fullcodeline": "if (outlen < 2*nLen) {"
    },
    {
        "line": 36,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 41,
        "fullcodeline": "if (pseq == NULL || r < 0 || seqlen == 0 || (cla|tag) != 0x30)"
    },
    {
        "line": 46,
        "fullcodeline": "for (i = 0; i < 2; i++) {"
    },
    {
        "line": 70,
        "fullcodeline": "r = piv_validate_general_authentication(card, data, datalen, out, outlen);"
    },
    {
        "line": 30,
        "fullcodeline": "r = SC_ERROR_INVALID_DATA;"
    },
    {
        "line": 42,
        "fullcodeline": "LOG_TEST_GOTO_ERR(card->ctx, SC_ERROR_INVALID_DATA, \"Can't find 0x30\");"
    },
    {
        "line": 47,
        "fullcodeline": "r = sc_asn1_read_tag(&pint, (pend - pint), &cla, &tag, &intlen);"
    },
    {
        "line": 53,
        "fullcodeline": "ptemp = pint;"
    },
    {
        "line": 54,
        "fullcodeline": "templen = intlen;"
    },
    {
        "line": 64,
        "fullcodeline": "memcpy(out + nLen*i + nLen - templen , ptemp, templen);"
    },
    {
        "line": 65,
        "fullcodeline": "pint += intlen; /* next integer */"
    },
    {
        "line": 48,
        "fullcodeline": "if (pint == NULL || r < 0 || intlen == 0 || (cla|tag) != 0x02)"
    },
    {
        "line": 50,
        "fullcodeline": "if (intlen > nLen + 1)"
    },
    {
        "line": 55,
        "fullcodeline": "if (intlen > nLen) { /* drop leading 00 if present */"
    },
    {
        "line": 49,
        "fullcodeline": "LOG_TEST_GOTO_ERR(card->ctx, SC_ERROR_INVALID_DATA, \"Can't find 0x02\");"
    },
    {
        "line": 51,
        "fullcodeline": "LOG_TEST_GOTO_ERR(card->ctx, SC_ERROR_INVALID_DATA,\"Signature too long\");"
    },
    {
        "line": 61,
        "fullcodeline": "ptemp++;"
    },
    {
        "line": 62,
        "fullcodeline": "templen--;"
    },
    {
        "line": 56,
        "fullcodeline": "if (*ptemp != 0x00) {"
    },
    {
        "line": 57,
        "fullcodeline": "LOG_TEST_GOTO_ERR(card->ctx, SC_ERROR_INVALID_DATA,\"Signature too long\");"
    },
    {
        "line": 58,
        "fullcodeline": "r = SC_ERROR_INVALID_DATA;"
    }
]