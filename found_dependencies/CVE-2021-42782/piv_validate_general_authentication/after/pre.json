[
    {
        "line": 5,
        "fullcodeline": "piv_private_data_t * priv = PIV_DATA(card);"
    },
    {
        "line": 14,
        "fullcodeline": "u8 sbuf[4096]; /* needs work. for 3072 keys, needs 384+10 or so */"
    },
    {
        "line": 15,
        "fullcodeline": "size_t sbuflen = sizeof(sbuf);"
    },
    {
        "line": 16,
        "fullcodeline": "u8 rbuf[4096];"
    },
    {
        "line": 18,
        "fullcodeline": "SC_FUNC_CALLED(card->ctx, SC_LOG_DEBUG_VERBOSE);"
    },
    {
        "line": 21,
        "fullcodeline": "p = sbuf;"
    },
    {
        "line": 22,
        "fullcodeline": "tmplen = sc_asn1_put_tag(0xff, NULL, datalen, NULL, 0, NULL);"
    },
    {
        "line": 23,
        "fullcodeline": "tmplen2 = sc_asn1_put_tag(0x82, NULL, 0, NULL, 0, NULL);"
    },
    {
        "line": 27,
        "fullcodeline": "tmplen += tmplen2;"
    },
    {
        "line": 38,
        "fullcodeline": "r = sc_asn1_put_tag(op_tag, data, datalen, p, sbuflen - (p - sbuf), &p);"
    },
    {
        "line": 50,
        "fullcodeline": "real_alg_id = priv->alg_id;"
    },
    {
        "line": 62,
        "fullcodeline": "r = piv_general_io(card, 0x87, real_alg_id, priv->key_ref,"
    },
    {
        "line": 67,
        "fullcodeline": "p2 = rbuf;"
    },
    {
        "line": 68,
        "fullcodeline": "r = sc_asn1_read_tag(&p2, r, &cla, &tag, &bodylen);"
    },
    {
        "line": 73,
        "fullcodeline": "r = sc_asn1_read_tag(&p2, bodylen, &cla, &tag, &taglen);"
    },
    {
        "line": 82,
        "fullcodeline": "memcpy(out, p2, taglen);"
    },
    {
        "line": 83,
        "fullcodeline": "r = taglen;"
    },
    {
        "line": 86,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, r);"
    },
    {
        "line": 24,
        "fullcodeline": "if (tmplen <= 0 || tmplen2 <= 0) {"
    },
    {
        "line": 28,
        "fullcodeline": "if ((r = sc_asn1_put_tag(0x7c, NULL, tmplen, p, sbuflen, &p)) != SC_SUCCESS ||"
    },
    {
        "line": 32,
        "fullcodeline": "if (priv->operation == SC_SEC_OPERATION_DERIVE"
    },
    {
        "line": 39,
        "fullcodeline": "if (r != SC_SUCCESS) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (priv->alg_id == 0x06) {"
    },
    {
        "line": 64,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 69,
        "fullcodeline": "if (p2 == NULL || r < 0 || bodylen == 0 || (cla|tag) != 0x7C) {"
    },
    {
        "line": 74,
        "fullcodeline": "if (p2 == NULL || r < 0 || taglen == 0 || (cla|tag) != 0x82) {"
    },
    {
        "line": 78,
        "fullcodeline": "if (taglen > outlen) {"
    },
    {
        "line": 25,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_INTERNAL);"
    },
    {
        "line": 29,
        "fullcodeline": "(r = sc_asn1_put_tag(0x82, NULL, 0, p, sbuflen - (p - sbuf), &p)) != SC_SUCCESS) {"
    },
    {
        "line": 30,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, r);"
    },
    {
        "line": 33,
        "fullcodeline": "&& priv->algorithm == SC_ALGORITHM_EC) {"
    },
    {
        "line": 34,
        "fullcodeline": "op_tag = 0x85;"
    },
    {
        "line": 40,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, r);"
    },
    {
        "line": 63,
        "fullcodeline": "sbuf, p - sbuf, rbuf, sizeof rbuf);"
    },
    {
        "line": 70,
        "fullcodeline": "LOG_TEST_GOTO_ERR(card->ctx, SC_ERROR_INVALID_DATA, \"Can't find 0x7C\");"
    },
    {
        "line": 75,
        "fullcodeline": "LOG_TEST_GOTO_ERR(card->ctx, SC_ERROR_INVALID_DATA, \"Can't find 0x82\");"
    },
    {
        "line": 79,
        "fullcodeline": "LOG_TEST_GOTO_ERR(card->ctx, SC_ERROR_INVALID_DATA, \"data read longer then buffer\");"
    },
    {
        "line": 36,
        "fullcodeline": "op_tag = 0x81;"
    },
    {
        "line": 53,
        "fullcodeline": "case 128: real_alg_id = 0x06; break;"
    },
    {
        "line": 54,
        "fullcodeline": "case 256: real_alg_id = 0x07; break;"
    },
    {
        "line": 55,
        "fullcodeline": "case 384: real_alg_id = 0x05; break;"
    },
    {
        "line": 57,
        "fullcodeline": "SC_FUNC_RETURN(card->ctx, SC_LOG_DEBUG_VERBOSE, SC_ERROR_NO_CARD_SUPPORT);"
    }
]