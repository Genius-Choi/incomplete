[
    {
        "line": 4,
        "fullcodeline": "u8        rbuf[SC_MAX_APDU_BUFFER_SIZE];"
    },
    {
        "line": 6,
        "fullcodeline": "const u8  *p = rbuf, *q;"
    },
    {
        "line": 7,
        "fullcodeline": "size_t    len, tlen = 0, ilen = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "sc_format_apdu(card, &apdu, SC_APDU_CASE_2_SHORT, 0xca, 0x01, 0x88);"
    },
    {
        "line": 10,
        "fullcodeline": "apdu.resp    = rbuf;"
    },
    {
        "line": 12,
        "fullcodeline": "apdu.lc = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "apdu.le = 256;"
    },
    {
        "line": 14,
        "fullcodeline": "r = sc_transmit_apdu(card, &apdu);"
    },
    {
        "line": 15,
        "fullcodeline": "LOG_TEST_RET(card->ctx, r, \"APDU transmit failed\");"
    },
    {
        "line": 17,
        "fullcodeline": "if ((len = apdu.resplen) == 0)"
    },
    {
        "line": 21,
        "fullcodeline": "while (len != 0) {"
    },
    {
        "line": 22,
        "fullcodeline": "p = sc_asn1_find_tag(card->ctx, p, len, 0xe1, &tlen);"
    },
    {
        "line": 25,
        "fullcodeline": "q = sc_asn1_find_tag(card->ctx, p, tlen, 0x01, &ilen);"
    },
    {
        "line": 30,
        "fullcodeline": "p   += tlen;"
    },
    {
        "line": 31,
        "fullcodeline": "len -= tlen + 2;"
    },
    {
        "line": 23,
        "fullcodeline": "if (p == NULL)"
    },
    {
        "line": 26,
        "fullcodeline": "if (q == NULL || ilen != 4)"
    },
    {
        "line": 28,
        "fullcodeline": "if (q[0] == 0x1c)"
    }
]