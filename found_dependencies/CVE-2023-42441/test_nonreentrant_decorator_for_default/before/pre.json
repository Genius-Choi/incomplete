[
    {
        "line": 2,
        "fullcodeline": "calling_contract_code = \"\"\""
    },
    {
        "line": 19,
        "fullcodeline": "reentrant_code = \"\"\""
    },
    {
        "line": 61,
        "fullcodeline": "reentrant_contract = get_contract(reentrant_code)"
    },
    {
        "line": 62,
        "fullcodeline": "calling_contract = get_contract(calling_contract_code)"
    },
    {
        "line": 64,
        "fullcodeline": "reentrant_contract.set_callback(calling_contract.address, transact={})"
    },
    {
        "line": 65,
        "fullcodeline": "assert reentrant_contract.callback() == calling_contract.address"
    },
    {
        "line": 68,
        "fullcodeline": "reentrant_contract.unprotected_function(\"some value\", False, transact={\"value\": 1000})"
    },
    {
        "line": 69,
        "fullcodeline": "assert reentrant_contract.special_value() == \"some value\""
    },
    {
        "line": 70,
        "fullcodeline": "assert w3.eth.get_balance(reentrant_contract.address) == 0"
    },
    {
        "line": 71,
        "fullcodeline": "assert w3.eth.get_balance(calling_contract.address) == 1000"
    },
    {
        "line": 74,
        "fullcodeline": "reentrant_contract.unprotected_function(\"another value\", True, transact={\"value\": 1000})"
    },
    {
        "line": 75,
        "fullcodeline": "assert reentrant_contract.special_value() == \"another value\""
    },
    {
        "line": 76,
        "fullcodeline": "assert w3.eth.get_balance(reentrant_contract.address) == 1000"
    },
    {
        "line": 77,
        "fullcodeline": "assert w3.eth.get_balance(calling_contract.address) == 1000"
    },
    {
        "line": 80,
        "fullcodeline": "reentrant_contract.protected_function(\"surprise!\", False, transact={\"value\": 1000})"
    },
    {
        "line": 81,
        "fullcodeline": "assert reentrant_contract.special_value() == \"surprise!\""
    },
    {
        "line": 82,
        "fullcodeline": "assert w3.eth.get_balance(reentrant_contract.address) == 1000"
    },
    {
        "line": 83,
        "fullcodeline": "assert w3.eth.get_balance(calling_contract.address) == 2000"
    },
    {
        "line": 86,
        "fullcodeline": "assert_tx_failed("
    }
]