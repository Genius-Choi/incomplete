[
    {
        "line": 4,
        "fullcodeline": "@spec.cert_chain = [PUBLIC_CERT.to_pem]"
    },
    {
        "line": 5,
        "fullcodeline": "@spec.signing_key = PRIVATE_KEY"
    },
    {
        "line": 7,
        "fullcodeline": "build = Gem::Package.new @gem"
    },
    {
        "line": 8,
        "fullcodeline": "build.spec = @spec"
    },
    {
        "line": 11,
        "fullcodeline": "FileUtils.mkdir 'lib'"
    },
    {
        "line": 12,
        "fullcodeline": "FileUtils.touch 'lib/code.rb'"
    },
    {
        "line": 14,
        "fullcodeline": "File.open @gem, 'wb' do |gem_io|"
    },
    {
        "line": 35,
        "fullcodeline": "Gem::Security.trust_dir.trust_cert PUBLIC_CERT"
    },
    {
        "line": 37,
        "fullcodeline": "package = Gem::Package.new @gem"
    },
    {
        "line": 38,
        "fullcodeline": "package.security_policy = Gem::Security::HighSecurity"
    },
    {
        "line": 40,
        "fullcodeline": "e = assert_raises Gem::Security::Exception do"
    },
    {
        "line": 44,
        "fullcodeline": "assert_equal 'invalid signature', e.message"
    },
    {
        "line": 46,
        "fullcodeline": "refute package.instance_variable_get(:@spec), '@spec must not be loaded'"
    },
    {
        "line": 2,
        "fullcodeline": "skip 'openssl is missing' unless defined?(OpenSSL::SSL)"
    },
    {
        "line": 47,
        "fullcodeline": "assert_empty package.instance_variable_get(:@files), '@files must empty'"
    }
]