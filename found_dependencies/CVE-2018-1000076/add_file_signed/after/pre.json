[
    {
        "line": 2,
        "fullcodeline": "digest_algorithms = ["
    },
    {
        "line": 7,
        "fullcodeline": "digests = add_file_digest name, mode, digest_algorithms do |io|"
    },
    {
        "line": 11,
        "fullcodeline": "signature_digest = digests.values.compact.find do |digest|"
    },
    {
        "line": 23,
        "fullcodeline": "raise \"no #{signer.digest_name} in #{digests.values.compact}\" unless signature_digest"
    },
    {
        "line": 28,
        "fullcodeline": "add_file_simple \"#{name}.sig\", 0444, signature.length do |io|"
    },
    {
        "line": 26,
        "fullcodeline": "signature = signer.sign signature_digest.digest"
    }
]