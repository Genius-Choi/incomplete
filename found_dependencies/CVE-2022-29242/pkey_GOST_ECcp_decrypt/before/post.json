[
    {
        "line": 5,
        "fullcodeline": "const unsigned char *p = in;"
    },
    {
        "line": 6,
        "fullcodeline": "EVP_PKEY *priv = EVP_PKEY_CTX_get0_pkey(pctx);"
    },
    {
        "line": 7,
        "fullcodeline": "GOST_KEY_TRANSPORT *gkt = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "int ret = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "unsigned char wrappedKey[44];"
    },
    {
        "line": 10,
        "fullcodeline": "unsigned char sharedKey[32];"
    },
    {
        "line": 12,
        "fullcodeline": "const struct gost_cipher_info *param = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "EVP_PKEY *eph_key = NULL, *peerkey = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "int dgst_nid = NID_undef;"
    },
    {
        "line": 20,
        "fullcodeline": "gkt = d2i_GOST_KEY_TRANSPORT(NULL, (const unsigned char **)&p, in_len);"
    },
    {
        "line": 28,
        "fullcodeline": "eph_key = X509_PUBKEY_get(gkt->key_agreement_info->ephem_key);"
    },
    {
        "line": 43,
        "fullcodeline": "peerkey = EVP_PKEY_CTX_get0_peerkey(pctx);"
    },
    {
        "line": 49,
        "fullcodeline": "param = get_encryption_params(gkt->key_agreement_info->cipher);"
    },
    {
        "line": 54,
        "fullcodeline": "gost_init(&ctx, param->sblock);"
    },
    {
        "line": 55,
        "fullcodeline": "OPENSSL_assert(gkt->key_agreement_info->eph_iv->length == 8);"
    },
    {
        "line": 56,
        "fullcodeline": "memcpy(wrappedKey, gkt->key_agreement_info->eph_iv->data, 8);"
    },
    {
        "line": 57,
        "fullcodeline": "OPENSSL_assert(gkt->key_info->encrypted_key->length == 32);"
    },
    {
        "line": 58,
        "fullcodeline": "memcpy(wrappedKey + 8, gkt->key_info->encrypted_key->data, 32);"
    },
    {
        "line": 59,
        "fullcodeline": "OPENSSL_assert(gkt->key_info->imit->length == 4);"
    },
    {
        "line": 60,
        "fullcodeline": "memcpy(wrappedKey + 40, gkt->key_info->imit->data, 4);"
    },
    {
        "line": 62,
        "fullcodeline": "EVP_PKEY_get_default_digest_nid(priv, &dgst_nid);"
    },
    {
        "line": 79,
        "fullcodeline": "ret = 1;"
    },
    {
        "line": 81,
        "fullcodeline": "OPENSSL_cleanse(sharedKey, sizeof(sharedKey));"
    },
    {
        "line": 82,
        "fullcodeline": "EVP_PKEY_free(eph_key);"
    },
    {
        "line": 83,
        "fullcodeline": "GOST_KEY_TRANSPORT_free(gkt);"
    },
    {
        "line": 16,
        "fullcodeline": "if (!key) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (!gkt) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (!peerkey) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (!param) {"
    },
    {
        "line": 63,
        "fullcodeline": "if (dgst_nid == NID_id_GostR3411_2012_512)"
    },
    {
        "line": 66,
        "fullcodeline": "if (!VKO_compute_key(sharedKey,"
    },
    {
        "line": 73,
        "fullcodeline": "if (!keyUnwrapCryptoPro(&ctx, sharedKey, wrappedKey, key)) {"
    },
    {
        "line": 17,
        "fullcodeline": "*key_len = 32;"
    },
    {
        "line": 22,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST_ECCP_DECRYPT,"
    },
    {
        "line": 45,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST_ECCP_DECRYPT, GOST_R_NO_PEER_KEY);"
    },
    {
        "line": 64,
        "fullcodeline": "dgst_nid = NID_id_GostR3411_2012_256;"
    },
    {
        "line": 69,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST_ECCP_DECRYPT,"
    },
    {
        "line": 74,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST_ECCP_DECRYPT,"
    },
    {
        "line": 24,
        "fullcodeline": "return -1;"
    },
    {
        "line": 30,
        "fullcodeline": "if (EVP_PKEY_derive_set_peer(pctx, eph_key) <= 0) {"
    },
    {
        "line": 67,
        "fullcodeline": "EC_KEY_get0_public_key(EVP_PKEY_get0(peerkey)),"
    },
    {
        "line": 68,
        "fullcodeline": "EVP_PKEY_get0(priv), wrappedKey, 8, dgst_nid)) {"
    },
    {
        "line": 31,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST_ECCP_DECRYPT,"
    },
    {
        "line": 37,
        "fullcodeline": "if (EVP_PKEY_CTX_ctrl(pctx, -1, -1, EVP_PKEY_CTRL_PEER_KEY, 3, NULL)"
    },
    {
        "line": 39,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST_ECCP_DECRYPT, GOST_R_CTRL_CALL_FAILED);"
    }
]