[
    {
        "line": 5,
        "fullcodeline": "const unsigned char *p = in;"
    },
    {
        "line": 8,
        "fullcodeline": "PSKeyTransport_gost *pst = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "int ret = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "unsigned char expkeys[64];"
    },
    {
        "line": 11,
        "fullcodeline": "EVP_PKEY *eph_key = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "int mac_nid = NID_undef;"
    },
    {
        "line": 14,
        "fullcodeline": "int iv_len = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "pkey_nid = EVP_PKEY_base_id(priv);"
    },
    {
        "line": 39,
        "fullcodeline": "pst = d2i_PSKeyTransport_gost(NULL, (const unsigned char **)&p, in_len);"
    },
    {
        "line": 46,
        "fullcodeline": "eph_key = X509_PUBKEY_get(pst->ephem_key);"
    },
    {
        "line": 90,
        "fullcodeline": "ret = 1;"
    },
    {
        "line": 16,
        "fullcodeline": "if (!(data = EVP_PKEY_CTX_get_data(pctx)) ||"
    },
    {
        "line": 40,
        "fullcodeline": "if (!pst) {"
    },
    {
        "line": 58,
        "fullcodeline": "if (eph_key == NULL) {"
    },
    {
        "line": 17,
        "fullcodeline": "!(priv = EVP_PKEY_CTX_get0_pkey(pctx))) {"
    },
    {
        "line": 19,
        "fullcodeline": "ret = 0;"
    },
    {
        "line": 26,
        "fullcodeline": "mac_nid = NID_magma_mac;"
    },
    {
        "line": 27,
        "fullcodeline": "iv_len = 4;"
    },
    {
        "line": 30,
        "fullcodeline": "mac_nid = NID_grasshopper_mac;"
    },
    {
        "line": 31,
        "fullcodeline": "iv_len = 8;"
    },
    {
        "line": 34,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST2018_DECRYPT, GOST_R_INVALID_CIPHER);"
    },
    {
        "line": 41,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST2018_DECRYPT,"
    },
    {
        "line": 61,
        "fullcodeline": "ret = 0;"
    },
    {
        "line": 65,
        "fullcodeline": "if (data->shared_ukm_size == 0 && pst->ukm != NULL) {"
    },
    {
        "line": 73,
        "fullcodeline": "if (gost_keg(data->shared_ukm, pkey_nid,"
    },
    {
        "line": 81,
        "fullcodeline": "if (gost_kimp15(ASN1_STRING_get0_data(pst->psexp),"
    },
    {
        "line": 85,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST2018_DECRYPT, GOST_R_CANNOT_UNPACK_EPHEMERAL_KEY);"
    },
    {
        "line": 35,
        "fullcodeline": "return -1;"
    },
    {
        "line": 43,
        "fullcodeline": "return -1;"
    },
    {
        "line": 74,
        "fullcodeline": "EC_KEY_get0_public_key(EVP_PKEY_get0(eph_key)),"
    },
    {
        "line": 75,
        "fullcodeline": "EVP_PKEY_get0(priv), expkeys) <= 0) {"
    },
    {
        "line": 82,
        "fullcodeline": "ASN1_STRING_length(pst->psexp), data->cipher_nid,"
    },
    {
        "line": 66,
        "fullcodeline": "if (EVP_PKEY_CTX_ctrl(pctx, -1, -1, EVP_PKEY_CTRL_SET_IV,"
    },
    {
        "line": 68,
        "fullcodeline": "GOSTerr(GOST_F_PKEY_GOST2018_DECRYPT, GOST_R_UKM_NOT_SET);"
    },
    {
        "line": 67,
        "fullcodeline": "ASN1_STRING_length(pst->ukm), (void *)ASN1_STRING_get0_data(pst->ukm)) < 0) {"
    }
]