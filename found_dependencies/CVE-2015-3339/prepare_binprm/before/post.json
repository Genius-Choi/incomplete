[
    {
        "line": 3,
        "fullcodeline": "struct inode *inode = file_inode(bprm->file);"
    },
    {
        "line": 4,
        "fullcodeline": "umode_t mode = inode->i_mode;"
    },
    {
        "line": 9,
        "fullcodeline": "bprm->cred->euid = current_euid();"
    },
    {
        "line": 10,
        "fullcodeline": "bprm->cred->egid = current_egid();"
    },
    {
        "line": 35,
        "fullcodeline": "retval = security_bprm_set_creds(bprm);"
    },
    {
        "line": 38,
        "fullcodeline": "bprm->cred_prepared = 1;"
    },
    {
        "line": 40,
        "fullcodeline": "memset(bprm->buf, 0, BINPRM_BUF_SIZE);"
    },
    {
        "line": 12,
        "fullcodeline": "if (!(bprm->file->f_path.mnt->mnt_flags & MNT_NOSUID) &&"
    },
    {
        "line": 41,
        "fullcodeline": "return kernel_read(bprm->file, 0, bprm->buf, BINPRM_BUF_SIZE);"
    },
    {
        "line": 15,
        "fullcodeline": "kgid_has_mapping(bprm->cred->user_ns, inode->i_gid)) {"
    },
    {
        "line": 14,
        "fullcodeline": "kuid_has_mapping(bprm->cred->user_ns, inode->i_uid) &&"
    },
    {
        "line": 17,
        "fullcodeline": "if (mode & S_ISUID) {"
    },
    {
        "line": 28,
        "fullcodeline": "if ((mode & (S_ISGID | S_IXGRP)) == (S_ISGID | S_IXGRP)) {"
    },
    {
        "line": 13,
        "fullcodeline": "!task_no_new_privs(current) &&"
    },
    {
        "line": 18,
        "fullcodeline": "bprm->per_clear |= PER_CLEAR_ON_SETID;"
    },
    {
        "line": 19,
        "fullcodeline": "bprm->cred->euid = inode->i_uid;"
    },
    {
        "line": 29,
        "fullcodeline": "bprm->per_clear |= PER_CLEAR_ON_SETID;"
    },
    {
        "line": 30,
        "fullcodeline": "bprm->cred->egid = inode->i_gid;"
    }
]