[
    {
        "line": 3,
        "fullcodeline": "struct kvm_apic_map *new, *old = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "new = kzalloc(sizeof(struct kvm_apic_map), GFP_KERNEL);"
    },
    {
        "line": 14,
        "fullcodeline": "new->ldr_bits = 8;"
    },
    {
        "line": 16,
        "fullcodeline": "new->cid_shift = 8;"
    },
    {
        "line": 17,
        "fullcodeline": "new->cid_mask = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "new->lid_mask = 0xff;"
    },
    {
        "line": 20,
        "fullcodeline": "kvm_for_each_vcpu(i, vcpu, kvm) {"
    },
    {
        "line": 58,
        "fullcodeline": "old = rcu_dereference_protected(kvm->arch.apic_map,"
    },
    {
        "line": 60,
        "fullcodeline": "rcu_assign_pointer(kvm->arch.apic_map, new);"
    },
    {
        "line": 61,
        "fullcodeline": "mutex_unlock(&kvm->arch.apic_map_lock);"
    },
    {
        "line": 66,
        "fullcodeline": "kvm_vcpu_request_scan_ioapic(kvm);"
    },
    {
        "line": 11,
        "fullcodeline": "if (!new)"
    },
    {
        "line": 48,
        "fullcodeline": "new->phys_map[kvm_apic_id(apic)] = apic;"
    },
    {
        "line": 50,
        "fullcodeline": "ldr = kvm_apic_get_reg(apic, APIC_LDR);"
    },
    {
        "line": 51,
        "fullcodeline": "cid = apic_cluster_id(new, ldr);"
    },
    {
        "line": 52,
        "fullcodeline": "lid = apic_logical_id(new, ldr);"
    },
    {
        "line": 25,
        "fullcodeline": "if (!kvm_apic_present(vcpu))"
    },
    {
        "line": 35,
        "fullcodeline": "if (apic_x2apic_mode(apic)) {"
    },
    {
        "line": 59,
        "fullcodeline": "lockdep_is_held(&kvm->arch.apic_map_lock));"
    },
    {
        "line": 64,
        "fullcodeline": "kfree_rcu(old, rcu);"
    },
    {
        "line": 36,
        "fullcodeline": "new->ldr_bits = 32;"
    },
    {
        "line": 37,
        "fullcodeline": "new->cid_shift = 16;"
    },
    {
        "line": 38,
        "fullcodeline": "new->cid_mask = (1 << KVM_X2APIC_CID_BITS) - 1;"
    },
    {
        "line": 39,
        "fullcodeline": "new->lid_mask = 0xffff;"
    },
    {
        "line": 55,
        "fullcodeline": "new->logical_map[cid][ffs(lid) - 1] = apic;"
    },
    {
        "line": 40,
        "fullcodeline": "} else if (kvm_apic_sw_enabled(apic) &&"
    },
    {
        "line": 42,
        "fullcodeline": "kvm_apic_get_reg(apic, APIC_DFR) == APIC_DFR_CLUSTER) {"
    },
    {
        "line": 43,
        "fullcodeline": "new->cid_shift = 4;"
    },
    {
        "line": 44,
        "fullcodeline": "new->cid_mask = 0xf;"
    },
    {
        "line": 45,
        "fullcodeline": "new->lid_mask = 0xf;"
    },
    {
        "line": 41,
        "fullcodeline": "!new->cid_mask /* flat mode */ &&"
    }
]