[
    {
        "line": 3,
        "fullcodeline": "struct kvm_apic_map *new, *old = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "new = kzalloc(sizeof(struct kvm_apic_map), GFP_KERNEL);"
    },
    {
        "line": 9,
        "fullcodeline": "mutex_lock(&kvm->arch.apic_map_lock);"
    },
    {
        "line": 14,
        "fullcodeline": "new->ldr_bits = 8;"
    },
    {
        "line": 16,
        "fullcodeline": "new->cid_shift = 8;"
    },
    {
        "line": 17,
        "fullcodeline": "new->cid_mask = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "new->lid_mask = 0xff;"
    },
    {
        "line": 20,
        "fullcodeline": "kvm_for_each_vcpu(i, vcpu, kvm) {"
    },
    {
        "line": 57,
        "fullcodeline": "old = rcu_dereference_protected(kvm->arch.apic_map,"
    },
    {
        "line": 59,
        "fullcodeline": "rcu_assign_pointer(kvm->arch.apic_map, new);"
    },
    {
        "line": 60,
        "fullcodeline": "mutex_unlock(&kvm->arch.apic_map_lock);"
    },
    {
        "line": 65,
        "fullcodeline": "kvm_vcpu_request_scan_ioapic(kvm);"
    },
    {
        "line": 11,
        "fullcodeline": "if (!new)"
    },
    {
        "line": 21,
        "fullcodeline": "struct kvm_lapic *apic = vcpu->arch.apic;"
    },
    {
        "line": 47,
        "fullcodeline": "new->phys_map[kvm_apic_id(apic)] = apic;"
    },
    {
        "line": 49,
        "fullcodeline": "ldr = kvm_apic_get_reg(apic, APIC_LDR);"
    },
    {
        "line": 50,
        "fullcodeline": "cid = apic_cluster_id(new, ldr);"
    },
    {
        "line": 51,
        "fullcodeline": "lid = apic_logical_id(new, ldr);"
    },
    {
        "line": 25,
        "fullcodeline": "if (!kvm_apic_present(vcpu))"
    },
    {
        "line": 35,
        "fullcodeline": "if (apic_x2apic_mode(apic)) {"
    },
    {
        "line": 58,
        "fullcodeline": "lockdep_is_held(&kvm->arch.apic_map_lock));"
    },
    {
        "line": 63,
        "fullcodeline": "kfree_rcu(old, rcu);"
    },
    {
        "line": 36,
        "fullcodeline": "new->ldr_bits = 32;"
    },
    {
        "line": 37,
        "fullcodeline": "new->cid_shift = 16;"
    },
    {
        "line": 38,
        "fullcodeline": "new->cid_mask = new->lid_mask = 0xffff;"
    },
    {
        "line": 54,
        "fullcodeline": "new->logical_map[cid][ffs(lid) - 1] = apic;"
    },
    {
        "line": 39,
        "fullcodeline": "} else if (kvm_apic_sw_enabled(apic) &&"
    },
    {
        "line": 41,
        "fullcodeline": "kvm_apic_get_reg(apic, APIC_DFR) == APIC_DFR_CLUSTER) {"
    },
    {
        "line": 42,
        "fullcodeline": "new->cid_shift = 4;"
    },
    {
        "line": 43,
        "fullcodeline": "new->cid_mask = 0xf;"
    },
    {
        "line": 44,
        "fullcodeline": "new->lid_mask = 0xf;"
    },
    {
        "line": 40,
        "fullcodeline": "!new->cid_mask /* flat mode */ &&"
    }
]