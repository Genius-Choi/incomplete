[
    {
        "line": 4,
        "fullcodeline": "char proc_fn[MAXPATHLEN];"
    },
    {
        "line": 5,
        "fullcodeline": "char *line = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "size_t line_bufsz = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "long value = -1;"
    },
    {
        "line": 9,
        "fullcodeline": "uid_t uid = (uid_t)-1;"
    },
    {
        "line": 10,
        "fullcodeline": "gid_t gid = (gid_t)-1;"
    },
    {
        "line": 13,
        "fullcodeline": "snprintf(proc_fn, MAXPATHLEN, \"/proc/%d/status\", 1);"
    },
    {
        "line": 15,
        "fullcodeline": "proc_file = fopen(proc_fn, \"r\");"
    },
    {
        "line": 35,
        "fullcodeline": "fclose(proc_file);"
    },
    {
        "line": 36,
        "fullcodeline": "free(line);"
    },
    {
        "line": 16,
        "fullcodeline": "if (!proc_file)"
    },
    {
        "line": 19,
        "fullcodeline": "while (getline(&line, &line_bufsz, proc_file) != -1) {"
    },
    {
        "line": 39,
        "fullcodeline": "if (uid != (uid_t)-1)"
    },
    {
        "line": 41,
        "fullcodeline": "if (gid != (gid_t)-1)"
    },
    {
        "line": 23,
        "fullcodeline": "ret = sscanf(line, \"Uid: %ld\", &value);"
    },
    {
        "line": 40,
        "fullcodeline": "*init_uid = uid;"
    },
    {
        "line": 42,
        "fullcodeline": "*init_gid = gid;"
    },
    {
        "line": 24,
        "fullcodeline": "if (ret != EOF && ret > 0) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (uid != (uid_t)-1 && gid != (gid_t)-1)"
    },
    {
        "line": 25,
        "fullcodeline": "uid = (uid_t) value;"
    },
    {
        "line": 27,
        "fullcodeline": "ret = sscanf(line, \"Gid: %ld\", &value);"
    },
    {
        "line": 28,
        "fullcodeline": "if (ret != EOF && ret > 0)"
    },
    {
        "line": 29,
        "fullcodeline": "gid = (gid_t) value;"
    }
]