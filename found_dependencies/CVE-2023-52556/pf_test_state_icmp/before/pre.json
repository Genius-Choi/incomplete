[
    {
        "line": 6,
        "fullcodeline": "int\t\t icmp_dir, iidx, ret, copyback = 0;"
    },
    {
        "line": 25,
        "fullcodeline": "if (pf_icmp_mapping(pd, icmptype, &icmp_dir, &virtual_id,"
    },
    {
        "line": 12,
        "fullcodeline": "icmptype = pd->hdr.icmp.icmp_type;"
    },
    {
        "line": 13,
        "fullcodeline": "icmpcode = pd->hdr.icmp.icmp_code;"
    },
    {
        "line": 22,
        "fullcodeline": "panic(\"unhandled proto %d\", pd->proto);"
    },
    {
        "line": 31,
        "fullcodeline": "ret = pf_icmp_state_lookup(pd, &key, stp,"
    },
    {
        "line": 42,
        "fullcodeline": "(*stp)->timeout = PFTM_ICMP_ERROR_REPLY;"
    },
    {
        "line": 35,
        "fullcodeline": "if (ret == PF_DROP && pd->af == AF_INET6 && icmp_dir == PF_OUT)"
    },
    {
        "line": 38,
        "fullcodeline": "if (ret >= 0)"
    },
    {
        "line": 45,
        "fullcodeline": "if ((*stp)->key[PF_SK_WIRE] != (*stp)->key[PF_SK_STACK]) {"
    },
    {
        "line": 133,
        "fullcodeline": "memset(&pd2, 0, sizeof(pd2));"
    },
    {
        "line": 134,
        "fullcodeline": "pd2.af = pd->af;"
    },
    {
        "line": 135,
        "fullcodeline": "pd2.dir = pd->dir;"
    },
    {
        "line": 136,
        "fullcodeline": "pd2.kif = pd->kif;"
    },
    {
        "line": 137,
        "fullcodeline": "pd2.m = pd->m;"
    },
    {
        "line": 138,
        "fullcodeline": "pd2.rdomain = pd->rdomain;"
    },
    {
        "line": 140,
        "fullcodeline": "pd2.sidx = (pd2.dir == PF_IN) ? 1 : 0;"
    },
    {
        "line": 141,
        "fullcodeline": "pd2.didx = (pd2.dir == PF_IN) ? 0 : 1;"
    },
    {
        "line": 36,
        "fullcodeline": "ret = pf_icmp_state_lookup(pd, &key, stp, virtual_id,"
    },
    {
        "line": 196,
        "fullcodeline": "if (PF_ANEQ(pd->dst, pd2.src, pd->af)) {"
    },
    {
        "line": 49,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af))"
    },
    {
        "line": 54,
        "fullcodeline": "afto = pd->af != nk->af;"
    },
    {
        "line": 67,
        "fullcodeline": "if (!afto) {"
    },
    {
        "line": 72,
        "fullcodeline": "if (pd->rdomain != nk->rdomain)"
    },
    {
        "line": 145,
        "fullcodeline": "ipoff2 = pd->off + ICMP_MINLEN;"
    },
    {
        "line": 163,
        "fullcodeline": "pd2.off = ipoff2;"
    },
    {
        "line": 167,
        "fullcodeline": "pd2.tot_len = ntohs(h2.ip_len);"
    },
    {
        "line": 168,
        "fullcodeline": "pd2.src = (struct pf_addr *)&h2.ip_src;"
    },
    {
        "line": 169,
        "fullcodeline": "pd2.dst = (struct pf_addr *)&h2.ip_dst;"
    },
    {
        "line": 193,
        "fullcodeline": "unhandled_af(pd->af);"
    },
    {
        "line": 50,
        "fullcodeline": "nk = (*stp)->key[pd->sidx];"
    },
    {
        "line": 57,
        "fullcodeline": "iidx = afto ? !iidx : iidx;"
    },
    {
        "line": 68,
        "fullcodeline": "pf_translate_a(pd, pd->src, &nk->addr[sidx]);"
    },
    {
        "line": 69,
        "fullcodeline": "pf_translate_a(pd, pd->dst, &nk->addr[didx]);"
    },
    {
        "line": 73,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 74,
        "fullcodeline": "if (!afto && PF_ANEQ(pd->dst,"
    },
    {
        "line": 76,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 89,
        "fullcodeline": "pf_patch_16(pd,"
    },
    {
        "line": 92,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 157,
        "fullcodeline": "if (h2.ip_off & htons(IP_OFFMASK)) {"
    },
    {
        "line": 164,
        "fullcodeline": "if (pf_walk_header(&pd2, &h2, reason) != PF_PASS)"
    },
    {
        "line": 197,
        "fullcodeline": "if (pf_status.debug >= LOG_NOTICE) {"
    },
    {
        "line": 216,
        "fullcodeline": "struct tcphdr\t\t*th = &pd2.hdr.tcp;"
    },
    {
        "line": 234,
        "fullcodeline": "key.af = pd2.af;"
    },
    {
        "line": 235,
        "fullcodeline": "key.proto = IPPROTO_TCP;"
    },
    {
        "line": 236,
        "fullcodeline": "key.rdomain = pd2.rdomain;"
    },
    {
        "line": 237,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.sidx], pd2.src, key.af);"
    },
    {
        "line": 238,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.didx], pd2.dst, key.af);"
    },
    {
        "line": 241,
        "fullcodeline": "key.hash = pf_pkt_hash(pd2.af, pd2.proto,"
    },
    {
        "line": 244,
        "fullcodeline": "action = pf_find_state(&pd2, &key, stp);"
    },
    {
        "line": 272,
        "fullcodeline": "seq = ntohl(th->th_seq) - src->seqdiff;"
    },
    {
        "line": 404,
        "fullcodeline": "struct udphdr\t*uh = &pd2.hdr.udp;"
    },
    {
        "line": 414,
        "fullcodeline": "key.af = pd2.af;"
    },
    {
        "line": 415,
        "fullcodeline": "key.proto = IPPROTO_UDP;"
    },
    {
        "line": 416,
        "fullcodeline": "key.rdomain = pd2.rdomain;"
    },
    {
        "line": 417,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.sidx], pd2.src, key.af);"
    },
    {
        "line": 418,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.didx], pd2.dst, key.af);"
    },
    {
        "line": 421,
        "fullcodeline": "key.hash = pf_pkt_hash(pd2.af, pd2.proto,"
    },
    {
        "line": 424,
        "fullcodeline": "action = pf_find_state(&pd2, &key, stp);"
    },
    {
        "line": 528,
        "fullcodeline": "struct icmp\t*iih = &pd2.hdr.icmp;"
    },
    {
        "line": 542,
        "fullcodeline": "pf_icmp_mapping(&pd2, iih->icmp_type,"
    },
    {
        "line": 545,
        "fullcodeline": "ret = pf_icmp_state_lookup(&pd2, &key, stp,"
    },
    {
        "line": 751,
        "fullcodeline": "key.af = pd2.af;"
    },
    {
        "line": 752,
        "fullcodeline": "key.proto = pd2.proto;"
    },
    {
        "line": 753,
        "fullcodeline": "key.rdomain = pd2.rdomain;"
    },
    {
        "line": 754,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.sidx], pd2.src, key.af);"
    },
    {
        "line": 755,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.didx], pd2.dst, key.af);"
    },
    {
        "line": 757,
        "fullcodeline": "key.hash = pf_pkt_hash(pd2.af, pd2.proto,"
    },
    {
        "line": 760,
        "fullcodeline": "action = pf_find_state(&pd2, &key, stp);"
    },
    {
        "line": 52,
        "fullcodeline": "nk = (*stp)->key[pd->didx];"
    },
    {
        "line": 147,
        "fullcodeline": "if (!pf_pull_hdr(pd2.m, ipoff2, &h2, sizeof(h2),"
    },
    {
        "line": 158,
        "fullcodeline": "REASON_SET(reason, PFRES_FRAG);"
    },
    {
        "line": 201,
        "fullcodeline": "pf_print_host(pd->src, 0, pd->af);"
    },
    {
        "line": 205,
        "fullcodeline": "pf_print_host(pd2.src, 0, pd2.af);"
    },
    {
        "line": 245,
        "fullcodeline": "if (action != PF_MATCH)"
    },
    {
        "line": 248,
        "fullcodeline": "if (pd2.dir == (*stp)->direction) {"
    },
    {
        "line": 266,
        "fullcodeline": "if (src->wscale && dst->wscale)"
    },
    {
        "line": 309,
        "fullcodeline": "if ((*stp)->key[PF_SK_WIRE] !="
    },
    {
        "line": 425,
        "fullcodeline": "if (action != PF_MATCH)"
    },
    {
        "line": 429,
        "fullcodeline": "if ((*stp)->key[PF_SK_WIRE] !="
    },
    {
        "line": 530,
        "fullcodeline": "if (pd2.af != AF_INET) {"
    },
    {
        "line": 547,
        "fullcodeline": "if (ret >= 0)"
    },
    {
        "line": 551,
        "fullcodeline": "if ((*stp)->key[PF_SK_WIRE] !="
    },
    {
        "line": 756,
        "fullcodeline": "key.port[0] = key.port[1] = 0;"
    },
    {
        "line": 761,
        "fullcodeline": "if (action != PF_MATCH)"
    },
    {
        "line": 227,
        "fullcodeline": "if (!pf_pull_hdr(pd2.m, pd2.off, th, 8, reason,"
    },
    {
        "line": 267,
        "fullcodeline": "dws = dst->wscale & PF_WSCALE_MASK;"
    },
    {
        "line": 274,
        "fullcodeline": "pf_patch_32(pd, &th->th_seq, htonl(seq));"
    },
    {
        "line": 278,
        "fullcodeline": "if (!((*stp)->state_flags & PFSTATE_SLOPPY) &&"
    },
    {
        "line": 279,
        "fullcodeline": "(!SEQ_GEQ(src->seqhi, seq) || !SEQ_GEQ(seq,"
    },
    {
        "line": 399,
        "fullcodeline": "m_copyback(pd2.m, pd2.off, 8, th, M_NOWAIT);"
    },
    {
        "line": 407,
        "fullcodeline": "if (!pf_pull_hdr(pd2.m, pd2.off, uh, sizeof(*uh),"
    },
    {
        "line": 520,
        "fullcodeline": "pf_patch_16(pd, &uh->uh_sum, 0);"
    },
    {
        "line": 521,
        "fullcodeline": "m_copyback(pd2.m, pd2.off, sizeof(*uh), uh,"
    },
    {
        "line": 531,
        "fullcodeline": "REASON_SET(reason, PFRES_NORM);"
    },
    {
        "line": 535,
        "fullcodeline": "if (!pf_pull_hdr(pd2.m, pd2.off, iih, ICMP_MINLEN,"
    },
    {
        "line": 622,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 624,
        "fullcodeline": "m_copyback(pd2.m, ipoff2, sizeof(h2), &h2,"
    },
    {
        "line": 626,
        "fullcodeline": "m_copyback(pd2.m, pd2.off, ICMP_MINLEN, iih,"
    },
    {
        "line": 767,
        "fullcodeline": "struct pf_state_key *nk ="
    },
    {
        "line": 249,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af)) {"
    },
    {
        "line": 269,
        "fullcodeline": "dws = 0;"
    },
    {
        "line": 281,
        "fullcodeline": "if (pf_status.debug >= LOG_NOTICE) {"
    },
    {
        "line": 314,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af))"
    },
    {
        "line": 319,
        "fullcodeline": "afto = pd->af != nk->af;"
    },
    {
        "line": 434,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af))"
    },
    {
        "line": 439,
        "fullcodeline": "afto = pd->af != nk->af;"
    },
    {
        "line": 556,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af))"
    },
    {
        "line": 561,
        "fullcodeline": "afto = pd->af != nk->af;"
    },
    {
        "line": 617,
        "fullcodeline": "if (PF_ANEQ(pd2.dst,"
    },
    {
        "line": 770,
        "fullcodeline": "if (PF_ANEQ(pd2.src,"
    },
    {
        "line": 780,
        "fullcodeline": "if (PF_ANEQ(pd2.dst,"
    },
    {
        "line": 250,
        "fullcodeline": "src = &(*stp)->src;"
    },
    {
        "line": 251,
        "fullcodeline": "dst = &(*stp)->dst;"
    },
    {
        "line": 257,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af)) {"
    },
    {
        "line": 285,
        "fullcodeline": "pf_print_host(pd->src, 0, pd->af);"
    },
    {
        "line": 295,
        "fullcodeline": "if (pf_status.debug >= LOG_DEBUG) {"
    },
    {
        "line": 315,
        "fullcodeline": "nk = (*stp)->key[pd->sidx];"
    },
    {
        "line": 358,
        "fullcodeline": "if (PF_ANEQ(pd2.src,"
    },
    {
        "line": 360,
        "fullcodeline": "nk->port[pd2.sidx] != th->th_sport)"
    },
    {
        "line": 361,
        "fullcodeline": "pf_translate_icmp(pd, pd2.src,"
    },
    {
        "line": 366,
        "fullcodeline": "if (PF_ANEQ(pd2.dst, &nk->addr[pd2.didx],"
    },
    {
        "line": 367,
        "fullcodeline": "pd2.af) || pd2.rdomain != nk->rdomain)"
    },
    {
        "line": 368,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 371,
        "fullcodeline": "if (PF_ANEQ(pd2.dst,"
    },
    {
        "line": 373,
        "fullcodeline": "nk->port[pd2.didx] != th->th_dport)"
    },
    {
        "line": 374,
        "fullcodeline": "pf_translate_icmp(pd, pd2.dst,"
    },
    {
        "line": 384,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 386,
        "fullcodeline": "m_copyback(pd2.m, ipoff2, sizeof(h2),"
    },
    {
        "line": 435,
        "fullcodeline": "nk = (*stp)->key[pd->sidx];"
    },
    {
        "line": 479,
        "fullcodeline": "if (PF_ANEQ(pd2.src,"
    },
    {
        "line": 481,
        "fullcodeline": "nk->port[pd2.sidx] != uh->uh_sport)"
    },
    {
        "line": 482,
        "fullcodeline": "pf_translate_icmp(pd, pd2.src,"
    },
    {
        "line": 487,
        "fullcodeline": "if (PF_ANEQ(pd2.dst, &nk->addr[pd2.didx],"
    },
    {
        "line": 488,
        "fullcodeline": "pd2.af) || pd2.rdomain != nk->rdomain)"
    },
    {
        "line": 489,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 492,
        "fullcodeline": "if (PF_ANEQ(pd2.dst,"
    },
    {
        "line": 494,
        "fullcodeline": "nk->port[pd2.didx] != uh->uh_dport)"
    },
    {
        "line": 495,
        "fullcodeline": "pf_translate_icmp(pd, pd2.dst,"
    },
    {
        "line": 502,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 504,
        "fullcodeline": "m_copyback(pd2.m, ipoff2, sizeof(h2),"
    },
    {
        "line": 557,
        "fullcodeline": "nk = (*stp)->key[pd->sidx];"
    },
    {
        "line": 564,
        "fullcodeline": "iidx = afto ? !iidx : iidx;"
    },
    {
        "line": 601,
        "fullcodeline": "if (PF_ANEQ(pd2.src,"
    },
    {
        "line": 603,
        "fullcodeline": "(virtual_type == htons(ICMP_ECHO) &&"
    },
    {
        "line": 605,
        "fullcodeline": "pf_translate_icmp(pd, pd2.src,"
    },
    {
        "line": 612,
        "fullcodeline": "if (PF_ANEQ(pd2.dst, &nk->addr[pd2.didx],"
    },
    {
        "line": 613,
        "fullcodeline": "pd2.af) || pd2.rdomain != nk->rdomain)"
    },
    {
        "line": 614,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 619,
        "fullcodeline": "pf_translate_icmp(pd, pd2.dst, NULL,"
    },
    {
        "line": 772,
        "fullcodeline": "pf_translate_icmp(pd, pd2.src, NULL,"
    },
    {
        "line": 775,
        "fullcodeline": "if (PF_ANEQ(pd2.dst, &nk->addr[pd2.didx],"
    },
    {
        "line": 776,
        "fullcodeline": "pd2.af) || pd2.rdomain != nk->rdomain)"
    },
    {
        "line": 777,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 782,
        "fullcodeline": "pf_translate_icmp(pd, pd2.dst, NULL,"
    },
    {
        "line": 787,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 789,
        "fullcodeline": "m_copyback(pd2.m, ipoff2, sizeof(h2),"
    },
    {
        "line": 253,
        "fullcodeline": "src = &(*stp)->dst;"
    },
    {
        "line": 254,
        "fullcodeline": "dst = &(*stp)->src;"
    },
    {
        "line": 258,
        "fullcodeline": "src = &(*stp)->dst;"
    },
    {
        "line": 259,
        "fullcodeline": "dst = &(*stp)->src;"
    },
    {
        "line": 280,
        "fullcodeline": "src->seqlo - (dst->max_win << dws)))) {"
    },
    {
        "line": 299,
        "fullcodeline": "pf_print_host(pd->src, 0, pd->af);"
    },
    {
        "line": 301,
        "fullcodeline": "pf_print_host(pd->dst, 0, pd->af);"
    },
    {
        "line": 317,
        "fullcodeline": "nk = (*stp)->key[pd->didx];"
    },
    {
        "line": 437,
        "fullcodeline": "nk = (*stp)->key[pd->didx];"
    },
    {
        "line": 559,
        "fullcodeline": "nk = (*stp)->key[pd->didx];"
    },
    {
        "line": 604,
        "fullcodeline": "nk->port[iidx] != iih->icmp_id))"
    },
    {
        "line": 261,
        "fullcodeline": "src = &(*stp)->src;"
    },
    {
        "line": 262,
        "fullcodeline": "dst = &(*stp)->dst;"
    },
    {
        "line": 606,
        "fullcodeline": "(virtual_type == htons(ICMP_ECHO)) ?"
    },
    {
        "line": 609,
        "fullcodeline": "(virtual_type == htons(ICMP_ECHO)) ?"
    }
]