[
    {
        "line": 6,
        "fullcodeline": "int\t\t icmp_dir, iidx, ret, copyback = 0;"
    },
    {
        "line": 25,
        "fullcodeline": "if (pf_icmp_mapping(pd, icmptype, &icmp_dir, &virtual_id,"
    },
    {
        "line": 22,
        "fullcodeline": "panic(\"unhandled proto %d\", pd->proto);"
    },
    {
        "line": 31,
        "fullcodeline": "ret = pf_icmp_state_lookup(pd, &key, stp,"
    },
    {
        "line": 41,
        "fullcodeline": "(*stp)->expire = getuptime();"
    },
    {
        "line": 42,
        "fullcodeline": "pf_update_state_timeout(*stp, PFTM_ICMP_ERROR_REPLY);"
    },
    {
        "line": 809,
        "fullcodeline": "m_copyback(pd->m, pd->off, pd->hdrlen, &pd->hdr, M_NOWAIT);"
    },
    {
        "line": 35,
        "fullcodeline": "if (ret == PF_DROP && pd->af == AF_INET6 && icmp_dir == PF_OUT)"
    },
    {
        "line": 38,
        "fullcodeline": "if (ret >= 0)"
    },
    {
        "line": 133,
        "fullcodeline": "memset(&pd2, 0, sizeof(pd2));"
    },
    {
        "line": 134,
        "fullcodeline": "pd2.af = pd->af;"
    },
    {
        "line": 135,
        "fullcodeline": "pd2.dir = pd->dir;"
    },
    {
        "line": 136,
        "fullcodeline": "pd2.kif = pd->kif;"
    },
    {
        "line": 137,
        "fullcodeline": "pd2.m = pd->m;"
    },
    {
        "line": 138,
        "fullcodeline": "pd2.rdomain = pd->rdomain;"
    },
    {
        "line": 140,
        "fullcodeline": "pd2.sidx = (pd2.dir == PF_IN) ? 1 : 0;"
    },
    {
        "line": 141,
        "fullcodeline": "pd2.didx = (pd2.dir == PF_IN) ? 0 : 1;"
    },
    {
        "line": 36,
        "fullcodeline": "ret = pf_icmp_state_lookup(pd, &key, stp, virtual_id,"
    },
    {
        "line": 54,
        "fullcodeline": "afto = pd->af != nk->af;"
    },
    {
        "line": 55,
        "fullcodeline": "sidx = afto ? pd->didx : pd->sidx;"
    },
    {
        "line": 56,
        "fullcodeline": "didx = afto ? pd->sidx : pd->didx;"
    },
    {
        "line": 57,
        "fullcodeline": "iidx = afto ? !iidx : iidx;"
    },
    {
        "line": 77,
        "fullcodeline": "pd->m->m_pkthdr.ph_rtableid = nk->rdomain;"
    },
    {
        "line": 196,
        "fullcodeline": "if (PF_ANEQ(pd->dst, pd2.src, pd->af)) {"
    },
    {
        "line": 49,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af))"
    },
    {
        "line": 67,
        "fullcodeline": "if (!afto) {"
    },
    {
        "line": 72,
        "fullcodeline": "if (pd->rdomain != nk->rdomain)"
    },
    {
        "line": 74,
        "fullcodeline": "if (!afto && PF_ANEQ(pd->dst,"
    },
    {
        "line": 145,
        "fullcodeline": "ipoff2 = pd->off + ICMP_MINLEN;"
    },
    {
        "line": 163,
        "fullcodeline": "pd2.off = ipoff2;"
    },
    {
        "line": 167,
        "fullcodeline": "pd2.tot_len = ntohs(h2.ip_len);"
    },
    {
        "line": 168,
        "fullcodeline": "pd2.src = (struct pf_addr *)&h2.ip_src;"
    },
    {
        "line": 169,
        "fullcodeline": "pd2.dst = (struct pf_addr *)&h2.ip_dst;"
    },
    {
        "line": 193,
        "fullcodeline": "unhandled_af(pd->af);"
    },
    {
        "line": 210,
        "fullcodeline": "REASON_SET(reason, PFRES_BADSTATE);"
    },
    {
        "line": 68,
        "fullcodeline": "pf_translate_a(pd, pd->src, &nk->addr[sidx]);"
    },
    {
        "line": 69,
        "fullcodeline": "pf_translate_a(pd, pd->dst, &nk->addr[didx]);"
    },
    {
        "line": 73,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 76,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 89,
        "fullcodeline": "pf_patch_16(pd,"
    },
    {
        "line": 92,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 94,
        "fullcodeline": "copyback = 1;"
    },
    {
        "line": 147,
        "fullcodeline": "if (!pf_pull_hdr(pd2.m, ipoff2, &h2, sizeof(h2),"
    },
    {
        "line": 157,
        "fullcodeline": "if (h2.ip_off & htons(IP_OFFMASK)) {"
    },
    {
        "line": 164,
        "fullcodeline": "if (pf_walk_header(&pd2, &h2, reason) != PF_PASS)"
    },
    {
        "line": 197,
        "fullcodeline": "if (pf_status.debug >= LOG_NOTICE) {"
    },
    {
        "line": 234,
        "fullcodeline": "key.af = pd2.af;"
    },
    {
        "line": 235,
        "fullcodeline": "key.proto = IPPROTO_TCP;"
    },
    {
        "line": 236,
        "fullcodeline": "key.rdomain = pd2.rdomain;"
    },
    {
        "line": 237,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.sidx], pd2.src, key.af);"
    },
    {
        "line": 238,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.didx], pd2.dst, key.af);"
    },
    {
        "line": 239,
        "fullcodeline": "key.port[pd2.sidx] = th->th_sport;"
    },
    {
        "line": 240,
        "fullcodeline": "key.port[pd2.didx] = th->th_dport;"
    },
    {
        "line": 241,
        "fullcodeline": "key.hash = pf_pkt_hash(pd2.af, pd2.proto,"
    },
    {
        "line": 244,
        "fullcodeline": "action = pf_find_state(&pd2, &key, stp);"
    },
    {
        "line": 272,
        "fullcodeline": "seq = ntohl(th->th_seq) - src->seqdiff;"
    },
    {
        "line": 414,
        "fullcodeline": "key.af = pd2.af;"
    },
    {
        "line": 415,
        "fullcodeline": "key.proto = IPPROTO_UDP;"
    },
    {
        "line": 416,
        "fullcodeline": "key.rdomain = pd2.rdomain;"
    },
    {
        "line": 417,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.sidx], pd2.src, key.af);"
    },
    {
        "line": 418,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.didx], pd2.dst, key.af);"
    },
    {
        "line": 419,
        "fullcodeline": "key.port[pd2.sidx] = uh->uh_sport;"
    },
    {
        "line": 420,
        "fullcodeline": "key.port[pd2.didx] = uh->uh_dport;"
    },
    {
        "line": 421,
        "fullcodeline": "key.hash = pf_pkt_hash(pd2.af, pd2.proto,"
    },
    {
        "line": 424,
        "fullcodeline": "action = pf_find_state(&pd2, &key, stp);"
    },
    {
        "line": 542,
        "fullcodeline": "pf_icmp_mapping(&pd2, iih->icmp_type,"
    },
    {
        "line": 545,
        "fullcodeline": "ret = pf_icmp_state_lookup(&pd2, &key, stp,"
    },
    {
        "line": 751,
        "fullcodeline": "key.af = pd2.af;"
    },
    {
        "line": 752,
        "fullcodeline": "key.proto = pd2.proto;"
    },
    {
        "line": 753,
        "fullcodeline": "key.rdomain = pd2.rdomain;"
    },
    {
        "line": 754,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.sidx], pd2.src, key.af);"
    },
    {
        "line": 755,
        "fullcodeline": "pf_addrcpy(&key.addr[pd2.didx], pd2.dst, key.af);"
    },
    {
        "line": 756,
        "fullcodeline": "key.port[0] = key.port[1] = 0;"
    },
    {
        "line": 757,
        "fullcodeline": "key.hash = pf_pkt_hash(pd2.af, pd2.proto,"
    },
    {
        "line": 760,
        "fullcodeline": "action = pf_find_state(&pd2, &key, stp);"
    },
    {
        "line": 149,
        "fullcodeline": "DPFPRINTF(LOG_NOTICE,"
    },
    {
        "line": 158,
        "fullcodeline": "REASON_SET(reason, PFRES_FRAG);"
    },
    {
        "line": 198,
        "fullcodeline": "log(LOG_NOTICE,"
    },
    {
        "line": 201,
        "fullcodeline": "pf_print_host(pd->src, 0, pd->af);"
    },
    {
        "line": 202,
        "fullcodeline": "addlog(\" -> \");"
    },
    {
        "line": 203,
        "fullcodeline": "pf_print_host(pd->dst, 0, pd->af);"
    },
    {
        "line": 204,
        "fullcodeline": "addlog(\" inner src: \");"
    },
    {
        "line": 205,
        "fullcodeline": "pf_print_host(pd2.src, 0, pd2.af);"
    },
    {
        "line": 206,
        "fullcodeline": "addlog(\" -> \");"
    },
    {
        "line": 207,
        "fullcodeline": "pf_print_host(pd2.dst, 0, pd2.af);"
    },
    {
        "line": 208,
        "fullcodeline": "addlog(\"\\n\");"
    },
    {
        "line": 227,
        "fullcodeline": "if (!pf_pull_hdr(pd2.m, pd2.off, th, 8, reason,"
    },
    {
        "line": 245,
        "fullcodeline": "if (action != PF_MATCH)"
    },
    {
        "line": 248,
        "fullcodeline": "if (pd2.dir == (*stp)->direction) {"
    },
    {
        "line": 266,
        "fullcodeline": "if (src->wscale && dst->wscale)"
    },
    {
        "line": 278,
        "fullcodeline": "if (!((*stp)->state_flags & PFSTATE_SLOPPY) &&"
    },
    {
        "line": 407,
        "fullcodeline": "if (!pf_pull_hdr(pd2.m, pd2.off, uh, sizeof(*uh),"
    },
    {
        "line": 425,
        "fullcodeline": "if (action != PF_MATCH)"
    },
    {
        "line": 530,
        "fullcodeline": "if (pd2.af != AF_INET) {"
    },
    {
        "line": 535,
        "fullcodeline": "if (!pf_pull_hdr(pd2.m, pd2.off, iih, ICMP_MINLEN,"
    },
    {
        "line": 547,
        "fullcodeline": "if (ret >= 0)"
    },
    {
        "line": 761,
        "fullcodeline": "if (action != PF_MATCH)"
    },
    {
        "line": 229,
        "fullcodeline": "DPFPRINTF(LOG_NOTICE,"
    },
    {
        "line": 267,
        "fullcodeline": "dws = dst->wscale & PF_WSCALE_MASK;"
    },
    {
        "line": 274,
        "fullcodeline": "pf_patch_32(pd, &th->th_seq, htonl(seq));"
    },
    {
        "line": 275,
        "fullcodeline": "copyback = 1;"
    },
    {
        "line": 279,
        "fullcodeline": "(!SEQ_GEQ(src->seqhi, seq) || !SEQ_GEQ(seq,"
    },
    {
        "line": 292,
        "fullcodeline": "REASON_SET(reason, PFRES_BADSTATE);"
    },
    {
        "line": 319,
        "fullcodeline": "afto = pd->af != nk->af;"
    },
    {
        "line": 320,
        "fullcodeline": "sidx = afto ? pd2.didx : pd2.sidx;"
    },
    {
        "line": 321,
        "fullcodeline": "didx = afto ? pd2.sidx : pd2.didx;"
    },
    {
        "line": 369,
        "fullcodeline": "pd->m->m_pkthdr.ph_rtableid = nk->rdomain;"
    },
    {
        "line": 378,
        "fullcodeline": "copyback = 1;"
    },
    {
        "line": 399,
        "fullcodeline": "m_copyback(pd2.m, pd2.off, 8, th, M_NOWAIT);"
    },
    {
        "line": 409,
        "fullcodeline": "DPFPRINTF(LOG_NOTICE,"
    },
    {
        "line": 439,
        "fullcodeline": "afto = pd->af != nk->af;"
    },
    {
        "line": 440,
        "fullcodeline": "sidx = afto ? pd2.didx : pd2.sidx;"
    },
    {
        "line": 441,
        "fullcodeline": "didx = afto ? pd2.sidx : pd2.didx;"
    },
    {
        "line": 490,
        "fullcodeline": "pd->m->m_pkthdr.ph_rtableid = nk->rdomain;"
    },
    {
        "line": 520,
        "fullcodeline": "pf_patch_16(pd, &uh->uh_sum, 0);"
    },
    {
        "line": 521,
        "fullcodeline": "m_copyback(pd2.m, pd2.off, sizeof(*uh), uh,"
    },
    {
        "line": 523,
        "fullcodeline": "copyback = 1;"
    },
    {
        "line": 531,
        "fullcodeline": "REASON_SET(reason, PFRES_NORM);"
    },
    {
        "line": 537,
        "fullcodeline": "DPFPRINTF(LOG_NOTICE,"
    },
    {
        "line": 561,
        "fullcodeline": "afto = pd->af != nk->af;"
    },
    {
        "line": 562,
        "fullcodeline": "sidx = afto ? pd2.didx : pd2.sidx;"
    },
    {
        "line": 563,
        "fullcodeline": "didx = afto ? pd2.sidx : pd2.didx;"
    },
    {
        "line": 564,
        "fullcodeline": "iidx = afto ? !iidx : iidx;"
    },
    {
        "line": 615,
        "fullcodeline": "pd->m->m_pkthdr.ph_rtableid = nk->rdomain;"
    },
    {
        "line": 622,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 624,
        "fullcodeline": "m_copyback(pd2.m, ipoff2, sizeof(h2), &h2,"
    },
    {
        "line": 626,
        "fullcodeline": "m_copyback(pd2.m, pd2.off, ICMP_MINLEN, iih,"
    },
    {
        "line": 628,
        "fullcodeline": "copyback = 1;"
    },
    {
        "line": 778,
        "fullcodeline": "pd->m->m_pkthdr.ph_rtableid = nk->rdomain;"
    },
    {
        "line": 802,
        "fullcodeline": "copyback = 1;"
    },
    {
        "line": 249,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af)) {"
    },
    {
        "line": 269,
        "fullcodeline": "dws = 0;"
    },
    {
        "line": 281,
        "fullcodeline": "if (pf_status.debug >= LOG_NOTICE) {"
    },
    {
        "line": 314,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af))"
    },
    {
        "line": 358,
        "fullcodeline": "if (PF_ANEQ(pd2.src,"
    },
    {
        "line": 366,
        "fullcodeline": "if (PF_ANEQ(pd2.dst, &nk->addr[pd2.didx],"
    },
    {
        "line": 371,
        "fullcodeline": "if (PF_ANEQ(pd2.dst,"
    },
    {
        "line": 434,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af))"
    },
    {
        "line": 479,
        "fullcodeline": "if (PF_ANEQ(pd2.src,"
    },
    {
        "line": 487,
        "fullcodeline": "if (PF_ANEQ(pd2.dst, &nk->addr[pd2.didx],"
    },
    {
        "line": 492,
        "fullcodeline": "if (PF_ANEQ(pd2.dst,"
    },
    {
        "line": 556,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af))"
    },
    {
        "line": 601,
        "fullcodeline": "if (PF_ANEQ(pd2.src,"
    },
    {
        "line": 612,
        "fullcodeline": "if (PF_ANEQ(pd2.dst, &nk->addr[pd2.didx],"
    },
    {
        "line": 617,
        "fullcodeline": "if (PF_ANEQ(pd2.dst,"
    },
    {
        "line": 770,
        "fullcodeline": "if (PF_ANEQ(pd2.src,"
    },
    {
        "line": 775,
        "fullcodeline": "if (PF_ANEQ(pd2.dst, &nk->addr[pd2.didx],"
    },
    {
        "line": 780,
        "fullcodeline": "if (PF_ANEQ(pd2.dst,"
    },
    {
        "line": 257,
        "fullcodeline": "if (PF_REVERSED_KEY((*stp)->key, pd->af)) {"
    },
    {
        "line": 282,
        "fullcodeline": "log(LOG_NOTICE,"
    },
    {
        "line": 285,
        "fullcodeline": "pf_print_host(pd->src, 0, pd->af);"
    },
    {
        "line": 286,
        "fullcodeline": "addlog(\" -> \");"
    },
    {
        "line": 287,
        "fullcodeline": "pf_print_host(pd->dst, 0, pd->af);"
    },
    {
        "line": 288,
        "fullcodeline": "addlog(\" state: \");"
    },
    {
        "line": 289,
        "fullcodeline": "pf_print_state(*stp);"
    },
    {
        "line": 290,
        "fullcodeline": "addlog(\" seq=%u\\n\", seq);"
    },
    {
        "line": 295,
        "fullcodeline": "if (pf_status.debug >= LOG_DEBUG) {"
    },
    {
        "line": 360,
        "fullcodeline": "nk->port[pd2.sidx] != th->th_sport)"
    },
    {
        "line": 361,
        "fullcodeline": "pf_translate_icmp(pd, pd2.src,"
    },
    {
        "line": 367,
        "fullcodeline": "pd2.af) || pd2.rdomain != nk->rdomain)"
    },
    {
        "line": 368,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 373,
        "fullcodeline": "nk->port[pd2.didx] != th->th_dport)"
    },
    {
        "line": 374,
        "fullcodeline": "pf_translate_icmp(pd, pd2.dst,"
    },
    {
        "line": 384,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 386,
        "fullcodeline": "m_copyback(pd2.m, ipoff2, sizeof(h2),"
    },
    {
        "line": 481,
        "fullcodeline": "nk->port[pd2.sidx] != uh->uh_sport)"
    },
    {
        "line": 482,
        "fullcodeline": "pf_translate_icmp(pd, pd2.src,"
    },
    {
        "line": 488,
        "fullcodeline": "pd2.af) || pd2.rdomain != nk->rdomain)"
    },
    {
        "line": 489,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 494,
        "fullcodeline": "nk->port[pd2.didx] != uh->uh_dport)"
    },
    {
        "line": 495,
        "fullcodeline": "pf_translate_icmp(pd, pd2.dst,"
    },
    {
        "line": 502,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 504,
        "fullcodeline": "m_copyback(pd2.m, ipoff2, sizeof(h2),"
    },
    {
        "line": 603,
        "fullcodeline": "(virtual_type == htons(ICMP_ECHO) &&"
    },
    {
        "line": 605,
        "fullcodeline": "pf_translate_icmp(pd, pd2.src,"
    },
    {
        "line": 613,
        "fullcodeline": "pd2.af) || pd2.rdomain != nk->rdomain)"
    },
    {
        "line": 614,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 619,
        "fullcodeline": "pf_translate_icmp(pd, pd2.dst, NULL,"
    },
    {
        "line": 772,
        "fullcodeline": "pf_translate_icmp(pd, pd2.src, NULL,"
    },
    {
        "line": 776,
        "fullcodeline": "pd2.af) || pd2.rdomain != nk->rdomain)"
    },
    {
        "line": 777,
        "fullcodeline": "pd->destchg = 1;"
    },
    {
        "line": 782,
        "fullcodeline": "pf_translate_icmp(pd, pd2.dst, NULL,"
    },
    {
        "line": 787,
        "fullcodeline": "m_copyback(pd->m, pd->off, ICMP_MINLEN,"
    },
    {
        "line": 789,
        "fullcodeline": "m_copyback(pd2.m, ipoff2, sizeof(h2),"
    },
    {
        "line": 280,
        "fullcodeline": "src->seqlo - (dst->max_win << dws)))) {"
    },
    {
        "line": 296,
        "fullcodeline": "log(LOG_DEBUG,"
    },
    {
        "line": 299,
        "fullcodeline": "pf_print_host(pd->src, 0, pd->af);"
    },
    {
        "line": 300,
        "fullcodeline": "addlog(\" -> \");"
    },
    {
        "line": 301,
        "fullcodeline": "pf_print_host(pd->dst, 0, pd->af);"
    },
    {
        "line": 302,
        "fullcodeline": "addlog(\" state: \");"
    },
    {
        "line": 303,
        "fullcodeline": "pf_print_state(*stp);"
    },
    {
        "line": 304,
        "fullcodeline": "addlog(\" seq=%u\\n\", seq);"
    },
    {
        "line": 604,
        "fullcodeline": "nk->port[iidx] != iih->icmp_id))"
    },
    {
        "line": 606,
        "fullcodeline": "(virtual_type == htons(ICMP_ECHO)) ?"
    },
    {
        "line": 609,
        "fullcodeline": "(virtual_type == htons(ICMP_ECHO)) ?"
    }
]