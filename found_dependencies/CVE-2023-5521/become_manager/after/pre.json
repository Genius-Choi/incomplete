[
    {
        "line": 4,
        "fullcodeline": "int i = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "bool result = false;"
    },
    {
        "line": 17,
        "fullcodeline": "buf = (char *)kmalloc(PATH_MAX, GFP_ATOMIC);"
    },
    {
        "line": 25,
        "fullcodeline": "int pkg_len = strlen(pkg);"
    },
    {
        "line": 12,
        "fullcodeline": "if (task_uid(current->real_parent).val != 0) {"
    },
    {
        "line": 18,
        "fullcodeline": "if (!buf) {"
    },
    {
        "line": 23,
        "fullcodeline": "files_table = files_fdtable(current->files);"
    },
    {
        "line": 27,
        "fullcodeline": "for (i = 0; files_table->fd[i] != NULL; i++) {"
    },
    {
        "line": 13,
        "fullcodeline": "pr_info(\"parent is not zygote!\\n\");"
    },
    {
        "line": 28,
        "fullcodeline": "files_path = files_table->fd[i]->f_path;"
    },
    {
        "line": 32,
        "fullcodeline": "cwd = d_path(&files_path, buf, PATH_MAX);"
    },
    {
        "line": 38,
        "fullcodeline": "pr_info(\"found apk: %s\\n\", cwd);"
    },
    {
        "line": 39,
        "fullcodeline": "char *pkg_index = strstr(cwd, pkg);"
    },
    {
        "line": 40,
        "fullcodeline": "if (!pkg_index) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (!d_is_reg(files_path.dentry)) {"
    },
    {
        "line": 33,
        "fullcodeline": "if (startswith(cwd, \"/data/app/\") != 0 ||"
    },
    {
        "line": 34,
        "fullcodeline": "endswith(cwd, \"/base.apk\") != 0) {"
    },
    {
        "line": 53,
        "fullcodeline": "pr_info(\"invalid pkg: %s\\n\", pkg);"
    },
    {
        "line": 58,
        "fullcodeline": "uid_t uid = current_uid().val;"
    },
    {
        "line": 59,
        "fullcodeline": "pr_info(\"manager uid: %d\\n\", uid);"
    },
    {
        "line": 63,
        "fullcodeline": "result = true;"
    }
]