[
    {
        "line": 5,
        "fullcodeline": "struct iovec iov_array[VTSOCK_MAXSEGS], *iov = iov_array;"
    },
    {
        "line": 6,
        "fullcodeline": "uint16_t idx, flags[VTSOCK_MAXSEGS];"
    },
    {
        "line": 11,
        "fullcodeline": "iovec_len = vq_getchain(vq, &idx, iov, VTSOCK_MAXSEGS, flags);"
    },
    {
        "line": 12,
        "fullcodeline": "assert(iovec_len <= VTSOCK_MAXSEGS);"
    },
    {
        "line": 16,
        "fullcodeline": "dprint_chain(iov, iovec_len, \"TX\");"
    },
    {
        "line": 20,
        "fullcodeline": "pulled = iovec_pull(&iov, &iovec_len, &hdr, sizeof(hdr));"
    },
    {
        "line": 21,
        "fullcodeline": "assert(pulled == sizeof(hdr));"
    },
    {
        "line": 23,
        "fullcodeline": "dprint_header(&hdr, 1, \"TX\");"
    },
    {
        "line": 25,
        "fullcodeline": "dprint_iovec(iov, iovec_len, \"TX\");"
    },
    {
        "line": 45,
        "fullcodeline": "sock = lookup_sock(sc, VIRTIO_VSOCK_TYPE_STREAM,"
    },
    {
        "line": 231,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 232,
        "fullcodeline": "close_sock(sc, sock, \"TX\");"
    },
    {
        "line": 27,
        "fullcodeline": "if (hdr.src_cid != sc->vssc_cfg.guest_cid ||"
    },
    {
        "line": 29,
        "fullcodeline": "hdr.type != VIRTIO_VSOCK_TYPE_STREAM) {"
    },
    {
        "line": 30,
        "fullcodeline": "DPRINTF((\"TX: Bad src/dst address/type\\n\"));"
    },
    {
        "line": 31,
        "fullcodeline": "send_response_nosock(sc, VIRTIO_VSOCK_OP_RST,"
    },
    {
        "line": 41,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 46,
        "fullcodeline": "(struct vsock_addr) {"
    },
    {
        "line": 50,
        "fullcodeline": "(struct vsock_addr) {"
    },
    {
        "line": 56,
        "fullcodeline": "sock->peer_buf_alloc = hdr.buf_alloc;"
    },
    {
        "line": 57,
        "fullcodeline": "sock->peer_fwd_cnt = hdr.fwd_cnt;"
    },
    {
        "line": 62,
        "fullcodeline": "PPRINTF((\"TX: => INVALID\\n\"));"
    },
    {
        "line": 78,
        "fullcodeline": "sock = connect_sock(sc,"
    },
    {
        "line": 90,
        "fullcodeline": "send_response_sock(sc, VIRTIO_VSOCK_OP_RESPONSE, 0, sock);"
    },
    {
        "line": 91,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 107,
        "fullcodeline": "sock->state = SOCK_CONNECTED;"
    },
    {
        "line": 108,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 109,
        "fullcodeline": "kick_rx(sc, \"new outgoing sock\");"
    },
    {
        "line": 116,
        "fullcodeline": "close_sock(sc, sock, \"TX\");"
    },
    {
        "line": 117,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 142,
        "fullcodeline": "shutdown_peer_local_fd(sock, hdr.flags, \"TX\");"
    },
    {
        "line": 150,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 193,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 195,
        "fullcodeline": "sc->rx_kick_pending = true;"
    },
    {
        "line": 208,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 209,
        "fullcodeline": "set_credit_update_required(sc, sock);"
    },
    {
        "line": 214,
        "fullcodeline": "put_sock(sock);"
    },
    {
        "line": 220,
        "fullcodeline": "send_response_sock(sc, VIRTIO_VSOCK_OP_RST, 0, sock);"
    },
    {
        "line": 233,
        "fullcodeline": "if (sock) put_sock(sock);"
    },
    {
        "line": 28,
        "fullcodeline": "hdr.dst_cid != VMADDR_CID_HOST ||"
    },
    {
        "line": 33,
        "fullcodeline": "(struct vsock_addr) {"
    },
    {
        "line": 37,
        "fullcodeline": "(struct vsock_addr) {"
    },
    {
        "line": 73,
        "fullcodeline": "if (hdr.dst_cid == sc->vssc_cfg.guest_cid) {"
    },
    {
        "line": 85,
        "fullcodeline": "if (!sock) {"
    },
    {
        "line": 96,
        "fullcodeline": "if (!sock) {"
    },
    {
        "line": 100,
        "fullcodeline": "if (sock->state != SOCK_CONNECTING) {"
    },
    {
        "line": 114,
        "fullcodeline": "if (!sock)"
    },
    {
        "line": 121,
        "fullcodeline": "if (!sock) {"
    },
    {
        "line": 126,
        "fullcodeline": "if (sock->state != SOCK_CONNECTED) {"
    },
    {
        "line": 131,
        "fullcodeline": "if (hdr.flags & ~VIRTIO_VSOCK_FLAG_SHUTDOWN_ALL) {"
    },
    {
        "line": 136,
        "fullcodeline": "if (!(hdr.flags & VIRTIO_VSOCK_FLAG_SHUTDOWN_ALL)) {"
    },
    {
        "line": 147,
        "fullcodeline": "if (sock->peer_shutdown == VIRTIO_VSOCK_FLAG_SHUTDOWN_ALL)"
    },
    {
        "line": 174,
        "fullcodeline": "rc = handle_write(sc, sock, hdr.len, iov, iovec_len);"
    },
    {
        "line": 176,
        "fullcodeline": "vq_relchain(vq, idx, 0);"
    },
    {
        "line": 183,
        "fullcodeline": "if (!sock) {"
    },
    {
        "line": 187,
        "fullcodeline": "if (sock->state != SOCK_CONNECTED) {"
    },
    {
        "line": 199,
        "fullcodeline": "if (!sock) {"
    },
    {
        "line": 203,
        "fullcodeline": "if (sock->state != SOCK_CONNECTED) {"
    },
    {
        "line": 222,
        "fullcodeline": "send_response_nosock(sc, VIRTIO_VSOCK_OP_RST, hdr.type,"
    },
    {
        "line": 69,
        "fullcodeline": "PPRINTF((\"TX: Attempt to reconnect sock\\n\"));"
    },
    {
        "line": 74,
        "fullcodeline": "PPRINTF((\"TX: Attempt to connect back to guest\\n!\"));"
    },
    {
        "line": 79,
        "fullcodeline": "(struct vsock_addr){"
    },
    {
        "line": 82,
        "fullcodeline": "(struct vsock_addr){"
    },
    {
        "line": 86,
        "fullcodeline": "PPRINTF((\"TX: Failed to open sock\\n\"));"
    },
    {
        "line": 97,
        "fullcodeline": "PPRINTF((\"TX: RESPONSE to non-existent sock\\n\"));"
    },
    {
        "line": 101,
        "fullcodeline": "PPRINTF((\"TX: RESPONSE to non-connecting sock (state %d)\\n\","
    },
    {
        "line": 115,
        "fullcodeline": "PPRINTF((\"TX: RST to non-existent sock\\n\"));"
    },
    {
        "line": 127,
        "fullcodeline": "PPRINTF((\"TX: SHUTDOWN to non-connected sock (state %d)\\n\","
    },
    {
        "line": 157,
        "fullcodeline": "if (!sock) {"
    },
    {
        "line": 161,
        "fullcodeline": "if (sock->state != SOCK_CONNECTED) {"
    },
    {
        "line": 166,
        "fullcodeline": "if (sock->peer_shutdown & VIRTIO_VSOCK_FLAG_SHUTDOWN_TX) {"
    },
    {
        "line": 170,
        "fullcodeline": "if (sock->local_shutdown & VIRTIO_VSOCK_FLAG_SHUTDOWN_RX) {"
    },
    {
        "line": 175,
        "fullcodeline": "if (rc < 0) goto do_rst;"
    },
    {
        "line": 177,
        "fullcodeline": "if (rc == 1)"
    },
    {
        "line": 184,
        "fullcodeline": "PPRINTF((\"TX: CREDIT_UPDATE to non-existent sock\\n\"));"
    },
    {
        "line": 188,
        "fullcodeline": "PPRINTF((\"TX: CREDIT_UPDATE to non-connected sock (state %d)\\n\","
    },
    {
        "line": 200,
        "fullcodeline": "PPRINTF((\"TX: CREDIT_REQUEST to non-existent sock\\n\"));"
    },
    {
        "line": 204,
        "fullcodeline": "PPRINTF((\"TX: CREDIT_REQUEST to non-connected sock (state %d)\\n\","
    },
    {
        "line": 223,
        "fullcodeline": "(struct vsock_addr) {"
    },
    {
        "line": 227,
        "fullcodeline": "(struct vsock_addr) {"
    },
    {
        "line": 47,
        "fullcodeline": ".cid = hdr.dst_cid,"
    },
    {
        "line": 48,
        "fullcodeline": ".port =hdr.dst_port"
    },
    {
        "line": 51,
        "fullcodeline": ".cid = hdr.src_cid,"
    },
    {
        "line": 52,
        "fullcodeline": ".port =hdr.src_port"
    },
    {
        "line": 158,
        "fullcodeline": "PPRINTF((\"TX: RW with no sock\\n\"));"
    },
    {
        "line": 162,
        "fullcodeline": "PPRINTF((\"TX: RW to non-connected sock (state %d)\\n\","
    },
    {
        "line": 167,
        "fullcodeline": "PPRINTF((\"TX: RW to socket with peer_shutdown.TX\\n\"));"
    },
    {
        "line": 171,
        "fullcodeline": "PPRINTF((\"TX: RW to socket with local_shutdown.RX\\n\"));"
    },
    {
        "line": 178,
        "fullcodeline": "set_credit_update_required(sc, sock);"
    },
    {
        "line": 34,
        "fullcodeline": ".cid = hdr.dst_cid,"
    },
    {
        "line": 35,
        "fullcodeline": ".port =hdr.dst_port"
    },
    {
        "line": 38,
        "fullcodeline": ".cid = hdr.src_cid,"
    },
    {
        "line": 39,
        "fullcodeline": ".port =hdr.src_port"
    },
    {
        "line": 80,
        "fullcodeline": ".cid = hdr.dst_cid, .port = hdr.dst_port"
    },
    {
        "line": 83,
        "fullcodeline": ".cid = hdr.src_cid, .port = hdr.src_port"
    },
    {
        "line": 224,
        "fullcodeline": ".cid = hdr.dst_cid,"
    },
    {
        "line": 225,
        "fullcodeline": ".port =hdr.dst_port"
    },
    {
        "line": 228,
        "fullcodeline": ".cid = hdr.src_cid,"
    },
    {
        "line": 229,
        "fullcodeline": ".port =hdr.src_port"
    }
]