[
    {
        "line": 3,
        "fullcodeline": "HTTPContext *s = h->priv_data;"
    },
    {
        "line": 4,
        "fullcodeline": "char hostname[1024], hoststr[1024];"
    },
    {
        "line": 5,
        "fullcodeline": "char auth[1024], pathbuf[1024], *path;"
    },
    {
        "line": 6,
        "fullcodeline": "char lower_url[100];"
    },
    {
        "line": 7,
        "fullcodeline": "int port, ret = 0, attempts = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "av_url_split(NULL, 0, auth, sizeof(auth), hostname, sizeof(hostname), &port,"
    },
    {
        "line": 19,
        "fullcodeline": "ff_url_join(hoststr, sizeof(hoststr), NULL, NULL, hostname, port, NULL);"
    },
    {
        "line": 20,
        "fullcodeline": "path = pathbuf;"
    },
    {
        "line": 24,
        "fullcodeline": "ff_url_join(lower_url, sizeof(lower_url), \"tcp\", NULL, hostname, port,"
    },
    {
        "line": 27,
        "fullcodeline": "ret = ffurl_open_whitelist(&s->hd, lower_url, AVIO_FLAG_READ_WRITE,"
    },
    {
        "line": 33,
        "fullcodeline": "authstr = ff_http_auth_create_response(&s->proxy_auth_state, auth,"
    },
    {
        "line": 35,
        "fullcodeline": "snprintf(s->buffer, sizeof(s->buffer),"
    },
    {
        "line": 44,
        "fullcodeline": "av_freep(&authstr);"
    },
    {
        "line": 49,
        "fullcodeline": "s->buf_ptr    = s->buffer;"
    },
    {
        "line": 50,
        "fullcodeline": "s->buf_end    = s->buffer;"
    },
    {
        "line": 51,
        "fullcodeline": "s->line_count = 0;"
    },
    {
        "line": 52,
        "fullcodeline": "s->filesize   = UINT64_MAX;"
    },
    {
        "line": 53,
        "fullcodeline": "cur_auth_type = s->proxy_auth_state.auth_type;"
    },
    {
        "line": 64,
        "fullcodeline": "ret = http_read_header(h, &new_loc);"
    },
    {
        "line": 68,
        "fullcodeline": "attempts++;"
    },
    {
        "line": 78,
        "fullcodeline": "ret = ff_http_averror(s->http_code, AVERROR(EIO));"
    },
    {
        "line": 12,
        "fullcodeline": "if( s->seekable == 1 )"
    },
    {
        "line": 21,
        "fullcodeline": "if (*path == '/')"
    },
    {
        "line": 30,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 43,
        "fullcodeline": "authstr ? \"Proxy-\" : \"\", authstr ? authstr : \"\");"
    },
    {
        "line": 46,
        "fullcodeline": "if ((ret = ffurl_write(s->hd, s->buffer, strlen(s->buffer))) < 0)"
    },
    {
        "line": 65,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 69,
        "fullcodeline": "if (s->http_code == 407 &&"
    },
    {
        "line": 76,
        "fullcodeline": "if (s->http_code < 400)"
    },
    {
        "line": 13,
        "fullcodeline": "h->is_streamed = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "path++;"
    },
    {
        "line": 71,
        "fullcodeline": "s->proxy_auth_state.auth_type != HTTP_AUTH_NONE && attempts < 2) {"
    },
    {
        "line": 72,
        "fullcodeline": "ffurl_closep(&s->hd);"
    },
    {
        "line": 15,
        "fullcodeline": "h->is_streamed = 1;"
    },
    {
        "line": 70,
        "fullcodeline": "(cur_auth_type == HTTP_AUTH_NONE || s->proxy_auth_state.stale) &&"
    }
]