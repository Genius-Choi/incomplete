[
    {
        "line": 4,
        "fullcodeline": "auto pm = get_valid_mcrypt_resource(td);"
    },
    {
        "line": 9,
        "fullcodeline": "int max_key_size = mcrypt_enc_get_key_size(pm->m_td);"
    },
    {
        "line": 10,
        "fullcodeline": "int iv_size = mcrypt_enc_get_iv_size(pm->m_td);"
    },
    {
        "line": 16,
        "fullcodeline": "unsigned char *key_s = (unsigned char *)malloc(key.size());"
    },
    {
        "line": 17,
        "fullcodeline": "memset(key_s, 0, key.size());"
    },
    {
        "line": 19,
        "fullcodeline": "unsigned char *iv_s = (unsigned char *)malloc(iv_size + 1);"
    },
    {
        "line": 20,
        "fullcodeline": "memset(iv_s, 0, iv_size + 1);"
    },
    {
        "line": 30,
        "fullcodeline": "memcpy(key_s, key.data(), key.size());"
    },
    {
        "line": 36,
        "fullcodeline": "memcpy(iv_s, iv.data(), std::min(iv_size, iv.size()));"
    },
    {
        "line": 38,
        "fullcodeline": "mcrypt_generic_deinit(pm->m_td);"
    },
    {
        "line": 39,
        "fullcodeline": "int result = mcrypt_generic_init(pm->m_td, key_s, key_size, iv_s);"
    },
    {
        "line": 5,
        "fullcodeline": "if (!pm) {"
    },
    {
        "line": 12,
        "fullcodeline": "if (key.empty()) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (key.size() > max_key_size) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (iv.size() != iv_size) {"
    },
    {
        "line": 43,
        "fullcodeline": "if (result < 0) {"
    },
    {
        "line": 24,
        "fullcodeline": "raise_warning(\"Key size too large; supplied length: %d, max: %d\","
    },
    {
        "line": 26,
        "fullcodeline": "key_size = max_key_size;"
    },
    {
        "line": 33,
        "fullcodeline": "raise_warning(\"Iv size incorrect; supplied length: %d, needed: %d\","
    },
    {
        "line": 25,
        "fullcodeline": "key.size(), max_key_size);"
    },
    {
        "line": 28,
        "fullcodeline": "key_size = key.size();"
    },
    {
        "line": 34,
        "fullcodeline": "iv.size(), iv_size);"
    }
]