[
    {
        "line": 4,
        "fullcodeline": "size_t length=2, pos=0;"
    },
    {
        "line": 7,
        "fullcodeline": "if (!data || ImageInfo->Thumbnail.size < 4) {"
    },
    {
        "line": 10,
        "fullcodeline": "if (memcmp(data, \"\\xFF\\xD8\\xFF\", 3)) {"
    },
    {
        "line": 17,
        "fullcodeline": "pos += length;"
    },
    {
        "line": 20,
        "fullcodeline": "c = data[pos++];"
    },
    {
        "line": 26,
        "fullcodeline": "n = 8;"
    },
    {
        "line": 34,
        "fullcodeline": "marker = c;"
    },
    {
        "line": 35,
        "fullcodeline": "length = php_jpg_get16(data+pos);"
    },
    {
        "line": 11,
        "fullcodeline": "if (!ImageInfo->Thumbnail.width && !ImageInfo->Thumbnail.height) {"
    },
    {
        "line": 18,
        "fullcodeline": "if (pos>=ImageInfo->Thumbnail.size)"
    },
    {
        "line": 21,
        "fullcodeline": "if (pos>=ImageInfo->Thumbnail.size)"
    },
    {
        "line": 23,
        "fullcodeline": "if (c != 0xFF) {"
    },
    {
        "line": 27,
        "fullcodeline": "while ((c = data[pos++]) == 0xFF && n--) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (c == 0xFF)"
    },
    {
        "line": 36,
        "fullcodeline": "if (length > ImageInfo->Thumbnail.size || pos >= ImageInfo->Thumbnail.size - length) {"
    },
    {
        "line": 12,
        "fullcodeline": "raise_warning(\"Thumbnail is not a JPEG image\");"
    },
    {
        "line": 58,
        "fullcodeline": "exif_process_SOFn(data+pos, marker, &sof_info);"
    },
    {
        "line": 59,
        "fullcodeline": "ImageInfo->Thumbnail.height   = sof_info.height;"
    },
    {
        "line": 60,
        "fullcodeline": "ImageInfo->Thumbnail.width    = sof_info.width;"
    },
    {
        "line": 65,
        "fullcodeline": "raise_warning(\"Could not compute size of thumbnail\");"
    },
    {
        "line": 28,
        "fullcodeline": "if (pos+3>=ImageInfo->Thumbnail.size)"
    },
    {
        "line": 54,
        "fullcodeline": "if (length < 8 || ImageInfo->Thumbnail.size - 8 < pos) {"
    }
]