[
    {
        "line": 4,
        "fullcodeline": "static char rpath[PATH_MAX];"
    },
    {
        "line": 6,
        "fullcodeline": "char dir[PATH_MAX] = { 0 };"
    },
    {
        "line": 8,
        "fullcodeline": "strlcpy(dir, ctrl->cwd, sizeof(dir));"
    },
    {
        "line": 9,
        "fullcodeline": "DBG(\"Compose path from cwd: %s, arg: %s\", ctrl->cwd, path ?: \"\");"
    },
    {
        "line": 10,
        "fullcodeline": "if (!path || !strlen(path))"
    },
    {
        "line": 22,
        "fullcodeline": "while ((ptr = strstr(dir, \"//\")))"
    },
    {
        "line": 23,
        "fullcodeline": "memmove(ptr, &ptr[1], strlen(&ptr[1]) + 1);"
    },
    {
        "line": 25,
        "fullcodeline": "if (!chrooted) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (!stat(dir, &st) && S_ISDIR(st.st_mode)) {"
    },
    {
        "line": 63,
        "fullcodeline": "if (!chrooted && strncmp(dir, home, strlen(home))) {"
    },
    {
        "line": 18,
        "fullcodeline": "strlcat(dir, path, sizeof(dir));"
    },
    {
        "line": 26,
        "fullcodeline": "size_t len = strlen(home);"
    },
    {
        "line": 28,
        "fullcodeline": "DBG(\"Server path from CWD: %s\", dir);"
    },
    {
        "line": 31,
        "fullcodeline": "memmove(dir + len, dir, strlen(dir) + 1);"
    },
    {
        "line": 32,
        "fullcodeline": "memcpy(dir, home, len);"
    },
    {
        "line": 33,
        "fullcodeline": "DBG(\"Resulting non-chroot path: %s\", dir);"
    },
    {
        "line": 64,
        "fullcodeline": "DBG(\"Failed non-chroot dir:%s vs home:%s\", dir, home);"
    },
    {
        "line": 14,
        "fullcodeline": "if (path[0] != '/') {"
    },
    {
        "line": 29,
        "fullcodeline": "if (len > 0 && home[len - 1] == '/')"
    },
    {
        "line": 41,
        "fullcodeline": "if (!realpath(dir, rpath))"
    },
    {
        "line": 49,
        "fullcodeline": "name = basename(path);"
    },
    {
        "line": 50,
        "fullcodeline": "ptr = dirname(dir);"
    },
    {
        "line": 52,
        "fullcodeline": "memset(rpath, 0, sizeof(rpath));"
    },
    {
        "line": 60,
        "fullcodeline": "strlcat(rpath, name, sizeof(rpath));"
    },
    {
        "line": 30,
        "fullcodeline": "len--;"
    },
    {
        "line": 53,
        "fullcodeline": "if (!realpath(ptr, rpath)) {"
    },
    {
        "line": 58,
        "fullcodeline": "if (rpath[1] != 0)"
    },
    {
        "line": 15,
        "fullcodeline": "if (dir[strlen(dir) - 1] != '/')"
    },
    {
        "line": 54,
        "fullcodeline": "INFO(\"Failed realpath(%s): %m\", ptr);"
    },
    {
        "line": 59,
        "fullcodeline": "strlcat(rpath, \"/\", sizeof(rpath));"
    },
    {
        "line": 16,
        "fullcodeline": "strlcat(dir, \"/\", sizeof(dir));"
    }
]