[
    {
        "line": 2,
        "fullcodeline": "changes = {}"
    },
    {
        "line": 3,
        "fullcodeline": "state = inspect(target)"
    },
    {
        "line": 4,
        "fullcodeline": "for attr in state.attrs:"
    },
    {
        "line": 13,
        "fullcodeline": "cherrypy.engine.publish('user_attr_changed', target, changes)"
    },
    {
        "line": 5,
        "fullcodeline": "if attr.key in ['user_root', 'email', 'role', 'mfa']:"
    },
    {
        "line": 6,
        "fullcodeline": "hist = attr.load_history()"
    },
    {
        "line": 7,
        "fullcodeline": "if hist.has_changes():"
    },
    {
        "line": 8,
        "fullcodeline": "changes[attr.key] = ("
    },
    {
        "line": 9,
        "fullcodeline": "hist.deleted[0] if len(hist.deleted) >= 1 else None,"
    },
    {
        "line": 10,
        "fullcodeline": "hist.added[0] if len(hist.added) >= 1 else None,"
    }
]