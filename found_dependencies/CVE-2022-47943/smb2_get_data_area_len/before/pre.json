[
    {
        "line": 4,
        "fullcodeline": "int ret = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "*off = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "*len = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "if (hdr->Status && hdr->Status != STATUS_MORE_PROCESSING_REQUIRED &&"
    },
    {
        "line": 92,
        "fullcodeline": "if (*off > 4096) {"
    },
    {
        "line": 11,
        "fullcodeline": "(((struct smb2_err_rsp *)hdr)->StructureSize) == SMB2_ERROR_STRUCTURE_SIZE2_LE)"
    },
    {
        "line": 21,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_sess_setup_req *)hdr)->SecurityBufferOffset);"
    },
    {
        "line": 22,
        "fullcodeline": "*len = le16_to_cpu(((struct smb2_sess_setup_req *)hdr)->SecurityBufferLength);"
    },
    {
        "line": 25,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_tree_connect_req *)hdr)->PathOffset);"
    },
    {
        "line": 26,
        "fullcodeline": "*len = le16_to_cpu(((struct smb2_tree_connect_req *)hdr)->PathLength);"
    },
    {
        "line": 43,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_query_info_req *)hdr)->InputBufferOffset);"
    },
    {
        "line": 44,
        "fullcodeline": "*len = le32_to_cpu(((struct smb2_query_info_req *)hdr)->InputBufferLength);"
    },
    {
        "line": 47,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_set_info_req *)hdr)->BufferOffset);"
    },
    {
        "line": 48,
        "fullcodeline": "*len = le32_to_cpu(((struct smb2_set_info_req *)hdr)->BufferLength);"
    },
    {
        "line": 51,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_read_req *)hdr)->ReadChannelInfoOffset);"
    },
    {
        "line": 52,
        "fullcodeline": "*len = le16_to_cpu(((struct smb2_read_req *)hdr)->ReadChannelInfoLength);"
    },
    {
        "line": 61,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_write_req *)hdr)->WriteChannelInfoOffset);"
    },
    {
        "line": 62,
        "fullcodeline": "*len = le16_to_cpu(((struct smb2_write_req *)hdr)->WriteChannelInfoLength);"
    },
    {
        "line": 65,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_query_directory_req *)hdr)->FileNameOffset);"
    },
    {
        "line": 66,
        "fullcodeline": "*len = le16_to_cpu(((struct smb2_query_directory_req *)hdr)->FileNameLength);"
    },
    {
        "line": 84,
        "fullcodeline": "*off = le32_to_cpu(((struct smb2_ioctl_req *)hdr)->InputOffset);"
    },
    {
        "line": 85,
        "fullcodeline": "*len = le32_to_cpu(((struct smb2_ioctl_req *)hdr)->InputCount);"
    },
    {
        "line": 88,
        "fullcodeline": "ksmbd_debug(SMB, \"no length check for command\\n\");"
    },
    {
        "line": 94,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 38,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_create_req *)hdr)->NameOffset);"
    },
    {
        "line": 39,
        "fullcodeline": "*len = le16_to_cpu(((struct smb2_create_req *)hdr)->NameLength);"
    },
    {
        "line": 76,
        "fullcodeline": "lock_count = le16_to_cpu(((struct smb2_lock_req *)hdr)->LockCount) - 1;"
    },
    {
        "line": 56,
        "fullcodeline": "*off = le16_to_cpu(((struct smb2_write_req *)hdr)->DataOffset);"
    },
    {
        "line": 57,
        "fullcodeline": "*len = le32_to_cpu(((struct smb2_write_req *)hdr)->Length);"
    },
    {
        "line": 77,
        "fullcodeline": "if (lock_count > 0) {"
    },
    {
        "line": 95,
        "fullcodeline": "} else if ((u64)*off + *len > MAX_STREAM_PROT_LEN) {"
    },
    {
        "line": 31,
        "fullcodeline": "*off = le32_to_cpu(((struct smb2_create_req *)"
    },
    {
        "line": 33,
        "fullcodeline": "*len = le32_to_cpu(((struct smb2_create_req *)"
    },
    {
        "line": 78,
        "fullcodeline": "*off = __SMB2_HEADER_STRUCTURE_SIZE + 48;"
    },
    {
        "line": 79,
        "fullcodeline": "*len = sizeof(struct smb2_lock_element) * lock_count;"
    },
    {
        "line": 98,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 97,
        "fullcodeline": "MAX_STREAM_PROT_LEN, (u64)*off + *len);"
    }
]