[
    {
        "line": 43,
        "fullcodeline": "if step_output_type is None:"
    },
    {
        "line": 46,
        "fullcodeline": "if materializer_class is None:"
    },
    {
        "line": 49,
        "fullcodeline": "with TemporaryDirectory() as artifact_uri:"
    },
    {
        "line": 44,
        "fullcodeline": "step_output_type = type(step_output)"
    },
    {
        "line": 47,
        "fullcodeline": "materializer_class = materializer_registry[step_output_type]"
    },
    {
        "line": 50,
        "fullcodeline": "materializer = materializer_class(uri=artifact_uri)"
    },
    {
        "line": 51,
        "fullcodeline": "existing_files = os.listdir(artifact_uri)"
    },
    {
        "line": 54,
        "fullcodeline": "materializer.save(step_output)"
    },
    {
        "line": 60,
        "fullcodeline": "visualizations = materializer.save_visualizations(step_output)"
    },
    {
        "line": 61,
        "fullcodeline": "assert isinstance(visualizations, dict)"
    },
    {
        "line": 71,
        "fullcodeline": "metadata = materializer.extract_full_metadata(step_output)"
    },
    {
        "line": 72,
        "fullcodeline": "assert isinstance(metadata, dict)"
    },
    {
        "line": 80,
        "fullcodeline": "loaded_data = materializer.load(step_output_type)"
    },
    {
        "line": 64,
        "fullcodeline": "for uri, value in visualizations.items():"
    },
    {
        "line": 73,
        "fullcodeline": "if expected_metadata_size is not None:"
    },
    {
        "line": 75,
        "fullcodeline": "for key, value in metadata.items():"
    },
    {
        "line": 56,
        "fullcodeline": "new_files = os.listdir(artifact_uri)"
    },
    {
        "line": 57,
        "fullcodeline": "assert len(new_files) > len(existing_files)"
    },
    {
        "line": 63,
        "fullcodeline": "assert len(visualizations) > 0"
    },
    {
        "line": 74,
        "fullcodeline": "assert len(metadata) == expected_metadata_size"
    },
    {
        "line": 82,
        "fullcodeline": "assert isinstance(loaded_data, step_output_type)  # correct type"
    },
    {
        "line": 86,
        "fullcodeline": "validation_function(artifact_uri)"
    },
    {
        "line": 65,
        "fullcodeline": "assert isinstance(uri, str)"
    },
    {
        "line": 66,
        "fullcodeline": "assert \"\\\\\" not in uri"
    },
    {
        "line": 67,
        "fullcodeline": "assert isinstance(value, VisualizationType)"
    },
    {
        "line": 68,
        "fullcodeline": "assert os.path.exists(uri)"
    },
    {
        "line": 76,
        "fullcodeline": "assert isinstance(key, str)"
    },
    {
        "line": 77,
        "fullcodeline": "assert isinstance(value, MetadataTypeTuple)"
    },
    {
        "line": 90,
        "fullcodeline": "return loaded_data, metadata"
    }
]