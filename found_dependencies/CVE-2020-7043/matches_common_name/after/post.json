[
    {
        "line": 2,
        "fullcodeline": "int common_name_loc = -1;"
    },
    {
        "line": 3,
        "fullcodeline": "X509_NAME_ENTRY *common_name_entry = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "ASN1_STRING *common_name_asn1 = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "char *common_name_str = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "common_name_loc = X509_NAME_get_index_by_NID(X509_get_subject_name((X509 *) server_cert), NID_commonName, -1);"
    },
    {
        "line": 14,
        "fullcodeline": "common_name_entry = X509_NAME_get_entry(X509_get_subject_name((X509 *) server_cert), common_name_loc);"
    },
    {
        "line": 20,
        "fullcodeline": "common_name_asn1 = X509_NAME_ENTRY_get_data(common_name_entry);"
    },
    {
        "line": 24,
        "fullcodeline": "common_name_str = (char *) ASN1_STRING_data(common_name_asn1);"
    },
    {
        "line": 9,
        "fullcodeline": "if (common_name_loc < 0) {"
    },
    {
        "line": 15,
        "fullcodeline": "if (common_name_entry == NULL) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (common_name_asn1 == NULL) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (ASN1_STRING_length(common_name_asn1) != strlen(common_name_str)) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (strcasecmp(hostname, common_name_str) == 0) {"
    }
]