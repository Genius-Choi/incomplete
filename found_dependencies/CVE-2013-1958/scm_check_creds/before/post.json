[
    {
        "line": 3,
        "fullcodeline": "const struct cred *cred = current_cred();"
    },
    {
        "line": 4,
        "fullcodeline": "kuid_t uid = make_kuid(cred->user_ns, creds->uid);"
    },
    {
        "line": 5,
        "fullcodeline": "kgid_t gid = make_kgid(cred->user_ns, creds->gid);"
    },
    {
        "line": 7,
        "fullcodeline": "if (!uid_valid(uid) || !gid_valid(gid))"
    },
    {
        "line": 10,
        "fullcodeline": "if ((creds->pid == task_tgid_vnr(current) || nsown_capable(CAP_SYS_ADMIN)) &&"
    },
    {
        "line": 17,
        "fullcodeline": "return -EPERM;"
    },
    {
        "line": 13,
        "fullcodeline": "((gid_eq(gid, cred->gid)   || gid_eq(gid, cred->egid) ||"
    },
    {
        "line": 8,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 11,
        "fullcodeline": "((uid_eq(uid, cred->uid)   || uid_eq(uid, cred->euid) ||"
    },
    {
        "line": 14,
        "fullcodeline": "gid_eq(gid, cred->sgid)) || nsown_capable(CAP_SETGID))) {"
    },
    {
        "line": 12,
        "fullcodeline": "uid_eq(uid, cred->suid)) || nsown_capable(CAP_SETUID)) &&"
    }
]