[
    {
        "line": 2,
        "fullcodeline": "cookies = await app.login_user(username)"
    },
    {
        "line": 3,
        "fullcodeline": "xsrf = cookies['_xsrf']"
    },
    {
        "line": 11,
        "fullcodeline": "url = path.format(username=username)"
    },
    {
        "line": 15,
        "fullcodeline": "r = await api_request("
    },
    {
        "line": 4,
        "fullcodeline": "if xsrf_in_url == \"invalid\":"
    },
    {
        "line": 21,
        "fullcodeline": "if xsrf_in_url is True:"
    },
    {
        "line": 5,
        "fullcodeline": "cookies.pop(\"_xsrf\")"
    },
    {
        "line": 13,
        "fullcodeline": "url = f\"{url}?_xsrf={xsrf}\""
    },
    {
        "line": 22,
        "fullcodeline": "assert r.status_code == 200"
    },
    {
        "line": 7,
        "fullcodeline": "xsrf = cookies['_xsrf'] = ("
    },
    {
        "line": 24,
        "fullcodeline": "assert r.status_code == 403"
    }
]