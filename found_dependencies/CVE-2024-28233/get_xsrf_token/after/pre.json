[
    {
        "line": 21,
        "fullcodeline": "xsrf_id_cookie = _get_signed_value_urlsafe(handler, \"_xsrf\", xsrf_token)"
    },
    {
        "line": 33,
        "fullcodeline": "xsrf_id = handler._xsrf_token_id"
    },
    {
        "line": 9,
        "fullcodeline": "if hasattr(handler, \"_xsrf_token\"):"
    },
    {
        "line": 14,
        "fullcodeline": "xsrf_token = xsrf_cookie = handler.get_cookie(\"_xsrf\")"
    },
    {
        "line": 22,
        "fullcodeline": "if xsrf_cookie and not xsrf_id_cookie:"
    },
    {
        "line": 34,
        "fullcodeline": "if xsrf_id_cookie != xsrf_id:"
    },
    {
        "line": 27,
        "fullcodeline": "app_log.warning("
    },
    {
        "line": 30,
        "fullcodeline": "_clear_invalid_xsrf_cookie(handler, cookie_path)"
    },
    {
        "line": 40,
        "fullcodeline": "xsrf_token = _create_signed_value_urlsafe(handler, \"_xsrf\", xsrf_id)"
    },
    {
        "line": 52,
        "fullcodeline": "xsrf_cookie_kwargs = {}"
    },
    {
        "line": 53,
        "fullcodeline": "xsrf_cookie_kwargs.update(handler.settings.get('xsrf_cookie_kwargs', {}))"
    },
    {
        "line": 54,
        "fullcodeline": "xsrf_cookie_kwargs.setdefault(\"path\", cookie_path)"
    },
    {
        "line": 65,
        "fullcodeline": "handler.set_cookie(\"_xsrf\", xsrf_token, **xsrf_cookie_kwargs)"
    },
    {
        "line": 48,
        "fullcodeline": "handler.request.headers.get(\"Sec-Fetch-Mode\", \"navigate\") == \"navigate\""
    },
    {
        "line": 55,
        "fullcodeline": "if not handler.current_user:"
    },
    {
        "line": 17,
        "fullcodeline": "xsrf_token = xsrf_token.encode(\"ascii\")"
    },
    {
        "line": 28,
        "fullcodeline": "\"Attempting to clear invalid _xsrf cookie %r\", xsrf_cookie[:4] + \"...\""
    },
    {
        "line": 38,
        "fullcodeline": "app_log.debug(\"xsrf id mismatch %r != %r\", xsrf_id_cookie, xsrf_id)"
    },
    {
        "line": 57,
        "fullcodeline": "xsrf_cookie_kwargs.pop(\"expires\", None)"
    },
    {
        "line": 58,
        "fullcodeline": "xsrf_cookie_kwargs.pop(\"expires_days\", None)"
    },
    {
        "line": 59,
        "fullcodeline": "xsrf_cookie_kwargs[\"max_age\"] = 3600"
    },
    {
        "line": 19,
        "fullcodeline": "xsrf_token = None"
    }
]