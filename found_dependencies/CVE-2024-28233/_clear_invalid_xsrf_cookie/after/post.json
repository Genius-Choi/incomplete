[
    {
        "line": 11,
        "fullcodeline": "expired = format_timestamp(datetime.now(timezone.utc) - timedelta(days=366))"
    },
    {
        "line": 12,
        "fullcodeline": "cookie = SimpleCookie()"
    },
    {
        "line": 13,
        "fullcodeline": "cookie[\"_xsrf\"] = \"\""
    },
    {
        "line": 14,
        "fullcodeline": "morsel = cookie[\"_xsrf\"]"
    },
    {
        "line": 15,
        "fullcodeline": "morsel[\"expires\"] = expired"
    },
    {
        "line": 16,
        "fullcodeline": "morsel[\"path\"] = \"/\""
    },
    {
        "line": 20,
        "fullcodeline": "handler.add_header(\"Set-Cookie\", morsel.OutputString(None))"
    },
    {
        "line": 21,
        "fullcodeline": "if cookie_path != \"/\":"
    },
    {
        "line": 27,
        "fullcodeline": "handler.request.method.lower() == \"get\""
    },
    {
        "line": 23,
        "fullcodeline": "morsel[\"path\"] = cookie_path"
    },
    {
        "line": 24,
        "fullcodeline": "handler.add_header(\"Set-Cookie\", morsel.OutputString(None))"
    },
    {
        "line": 28,
        "fullcodeline": "and handler.request.headers.get(\"Sec-Fetch-Mode\", \"navigate\") == \"navigate\""
    },
    {
        "line": 33,
        "fullcodeline": "handler.redirect(handler.request.uri)"
    },
    {
        "line": 35,
        "fullcodeline": "raise web.Finish()"
    }
]