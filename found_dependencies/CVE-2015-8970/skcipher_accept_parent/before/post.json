[
    {
        "line": 4,
        "fullcodeline": "struct alg_sock *ask = alg_sk(sk);"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned int len = sizeof(*ctx) + crypto_skcipher_reqsize(private);"
    },
    {
        "line": 7,
        "fullcodeline": "ctx = sock_kmalloc(sk, len, GFP_KERNEL);"
    },
    {
        "line": 11,
        "fullcodeline": "ctx->iv = sock_kmalloc(sk, crypto_skcipher_ivsize(private),"
    },
    {
        "line": 18,
        "fullcodeline": "memset(ctx->iv, 0, crypto_skcipher_ivsize(private));"
    },
    {
        "line": 20,
        "fullcodeline": "INIT_LIST_HEAD(&ctx->tsgl);"
    },
    {
        "line": 21,
        "fullcodeline": "ctx->len = len;"
    },
    {
        "line": 22,
        "fullcodeline": "ctx->used = 0;"
    },
    {
        "line": 23,
        "fullcodeline": "ctx->more = 0;"
    },
    {
        "line": 24,
        "fullcodeline": "ctx->merge = 0;"
    },
    {
        "line": 25,
        "fullcodeline": "ctx->enc = 0;"
    },
    {
        "line": 26,
        "fullcodeline": "atomic_set(&ctx->inflight, 0);"
    },
    {
        "line": 27,
        "fullcodeline": "af_alg_init_completion(&ctx->completion);"
    },
    {
        "line": 29,
        "fullcodeline": "ask->private = ctx;"
    },
    {
        "line": 31,
        "fullcodeline": "skcipher_request_set_tfm(&ctx->req, private);"
    },
    {
        "line": 32,
        "fullcodeline": "skcipher_request_set_callback(&ctx->req, CRYPTO_TFM_REQ_MAY_BACKLOG,"
    },
    {
        "line": 35,
        "fullcodeline": "sk->sk_destruct = skcipher_sock_destruct;"
    },
    {
        "line": 8,
        "fullcodeline": "if (!ctx)"
    },
    {
        "line": 13,
        "fullcodeline": "if (!ctx->iv) {"
    },
    {
        "line": 14,
        "fullcodeline": "sock_kfree_s(sk, ctx, len);"
    },
    {
        "line": 9,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 15,
        "fullcodeline": "return -ENOMEM;"
    }
]