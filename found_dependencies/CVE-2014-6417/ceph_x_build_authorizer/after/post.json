[
    {
        "line": 10,
        "fullcodeline": "int ticket_blob_len ="
    },
    {
        "line": 13,
        "fullcodeline": "dout(\"build_authorizer for %s %p\\n\","
    },
    {
        "line": 16,
        "fullcodeline": "maxlen = sizeof(*msg_a) + sizeof(msg_b) +"
    },
    {
        "line": 18,
        "fullcodeline": "dout(\"  need len %d\\n\", maxlen);"
    },
    {
        "line": 28,
        "fullcodeline": "au->service = th->service;"
    },
    {
        "line": 29,
        "fullcodeline": "au->secret_id = th->secret_id;"
    },
    {
        "line": 32,
        "fullcodeline": "msg_a->struct_v = 1;"
    },
    {
        "line": 33,
        "fullcodeline": "msg_a->global_id = cpu_to_le64(ac->global_id);"
    },
    {
        "line": 34,
        "fullcodeline": "msg_a->service_id = cpu_to_le32(th->service);"
    },
    {
        "line": 35,
        "fullcodeline": "msg_a->ticket_blob.struct_v = 1;"
    },
    {
        "line": 36,
        "fullcodeline": "msg_a->ticket_blob.secret_id = cpu_to_le64(th->secret_id);"
    },
    {
        "line": 37,
        "fullcodeline": "msg_a->ticket_blob.blob_len = cpu_to_le32(ticket_blob_len);"
    },
    {
        "line": 42,
        "fullcodeline": "dout(\" th %p secret_id %lld %lld\\n\", th, th->secret_id,"
    },
    {
        "line": 45,
        "fullcodeline": "p = msg_a + 1;"
    },
    {
        "line": 46,
        "fullcodeline": "p += ticket_blob_len;"
    },
    {
        "line": 49,
        "fullcodeline": "get_random_bytes(&au->nonce, sizeof(au->nonce));"
    },
    {
        "line": 50,
        "fullcodeline": "msg_b.struct_v = 1;"
    },
    {
        "line": 51,
        "fullcodeline": "msg_b.nonce = cpu_to_le64(au->nonce);"
    },
    {
        "line": 52,
        "fullcodeline": "ret = ceph_x_encrypt(&th->session_key, &msg_b, sizeof(msg_b),"
    },
    {
        "line": 56,
        "fullcodeline": "p += ret;"
    },
    {
        "line": 57,
        "fullcodeline": "au->buf->vec.iov_len = p - au->buf->vec.iov_base;"
    },
    {
        "line": 58,
        "fullcodeline": "dout(\" built authorizer nonce %llx len %d\\n\", au->nonce,"
    },
    {
        "line": 60,
        "fullcodeline": "BUG_ON(au->buf->vec.iov_len > maxlen);"
    },
    {
        "line": 64,
        "fullcodeline": "ceph_buffer_put(au->buf);"
    },
    {
        "line": 65,
        "fullcodeline": "au->buf = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "(th->ticket_blob ? th->ticket_blob->vec.iov_len : 0);"
    },
    {
        "line": 14,
        "fullcodeline": "ceph_entity_type_name(th->service), au);"
    },
    {
        "line": 19,
        "fullcodeline": "if (au->buf && au->buf->alloc_len < maxlen) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (!au->buf) {"
    },
    {
        "line": 43,
        "fullcodeline": "le64_to_cpu(msg_a->ticket_blob.secret_id));"
    },
    {
        "line": 54,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 59,
        "fullcodeline": "(int)au->buf->vec.iov_len);"
    },
    {
        "line": 17,
        "fullcodeline": "ceph_x_encrypt_buflen(ticket_blob_len);"
    },
    {
        "line": 20,
        "fullcodeline": "ceph_buffer_put(au->buf);"
    },
    {
        "line": 21,
        "fullcodeline": "au->buf = NULL;"
    },
    {
        "line": 24,
        "fullcodeline": "au->buf = ceph_buffer_new(maxlen, GFP_NOFS);"
    },
    {
        "line": 53,
        "fullcodeline": "p, end - p);"
    },
    {
        "line": 25,
        "fullcodeline": "if (!au->buf)"
    },
    {
        "line": 26,
        "fullcodeline": "return -ENOMEM;"
    }
]