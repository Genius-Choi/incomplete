[
    {
        "line": 3,
        "fullcodeline": "const char* alg[] = {\"ES512\", \"ECMR\", NULL};"
    },
    {
        "line": 4,
        "fullcodeline": "char path[PATH_MAX];"
    },
    {
        "line": 5,
        "fullcodeline": "for (int i = 0; alg[i] != NULL; i++) {"
    },
    {
        "line": 6,
        "fullcodeline": "json_auto_t* jwk = jwk_generate(alg[i]);"
    },
    {
        "line": 10,
        "fullcodeline": "__attribute__ ((__cleanup__(cleanup_str))) char* thp = jwk_thumbprint(jwk, DEFAULT_THP_HASH);"
    },
    {
        "line": 18,
        "fullcodeline": "path[sizeof(path) - 1] = '\\0';"
    },
    {
        "line": 7,
        "fullcodeline": "if (!jwk) {"
    },
    {
        "line": 11,
        "fullcodeline": "if (!thp) {"
    },
    {
        "line": 14,
        "fullcodeline": "if (snprintf(path, PATH_MAX, \"%s/%s.jwk\", jwkdir, thp) < 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "if (json_dump_file(jwk, path, 0) == -1) {"
    },
    {
        "line": 25,
        "fullcodeline": "if (chmod(path, S_IRUSR | S_IRGRP) == -1) {"
    }
]