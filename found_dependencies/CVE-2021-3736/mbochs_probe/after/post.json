[
    {
        "line": 3,
        "fullcodeline": "int avail_mbytes = atomic_read(&mbochs_avail_mbytes);"
    },
    {
        "line": 6,
        "fullcodeline": "struct device *dev = mdev_dev(mdev);"
    },
    {
        "line": 8,
        "fullcodeline": "int ret = -ENOMEM;"
    },
    {
        "line": 16,
        "fullcodeline": "mdev_state = kzalloc(sizeof(struct mdev_state), GFP_KERNEL);"
    },
    {
        "line": 19,
        "fullcodeline": "vfio_init_group_dev(&mdev_state->vdev, &mdev->dev, &mbochs_dev_ops);"
    },
    {
        "line": 21,
        "fullcodeline": "mdev_state->vconfig = kzalloc(MBOCHS_CONFIG_SPACE_SIZE, GFP_KERNEL);"
    },
    {
        "line": 25,
        "fullcodeline": "mdev_state->memsize = type->mbytes * 1024 * 1024;"
    },
    {
        "line": 26,
        "fullcodeline": "mdev_state->pagecount = mdev_state->memsize >> PAGE_SHIFT;"
    },
    {
        "line": 27,
        "fullcodeline": "mdev_state->pages = kcalloc(mdev_state->pagecount,"
    },
    {
        "line": 33,
        "fullcodeline": "dev_info(dev, \"%s: %s, %d MB, %ld pages\\n\", __func__,"
    },
    {
        "line": 36,
        "fullcodeline": "mutex_init(&mdev_state->ops_lock);"
    },
    {
        "line": 37,
        "fullcodeline": "mdev_state->mdev = mdev;"
    },
    {
        "line": 38,
        "fullcodeline": "INIT_LIST_HEAD(&mdev_state->dmabufs);"
    },
    {
        "line": 39,
        "fullcodeline": "mdev_state->next_id = 1;"
    },
    {
        "line": 41,
        "fullcodeline": "mdev_state->type = type;"
    },
    {
        "line": 42,
        "fullcodeline": "mdev_state->edid_regs.max_xres = type->max_x;"
    },
    {
        "line": 43,
        "fullcodeline": "mdev_state->edid_regs.max_yres = type->max_y;"
    },
    {
        "line": 44,
        "fullcodeline": "mdev_state->edid_regs.edid_offset = MBOCHS_EDID_BLOB_OFFSET;"
    },
    {
        "line": 46,
        "fullcodeline": "mbochs_create_config_space(mdev_state);"
    },
    {
        "line": 47,
        "fullcodeline": "mbochs_reset(mdev_state);"
    },
    {
        "line": 49,
        "fullcodeline": "ret = vfio_register_group_dev(&mdev_state->vdev);"
    },
    {
        "line": 52,
        "fullcodeline": "dev_set_drvdata(&mdev->dev, mdev_state);"
    },
    {
        "line": 55,
        "fullcodeline": "kfree(mdev_state->pages);"
    },
    {
        "line": 56,
        "fullcodeline": "kfree(mdev_state->vconfig);"
    },
    {
        "line": 57,
        "fullcodeline": "kfree(mdev_state);"
    },
    {
        "line": 59,
        "fullcodeline": "atomic_add(type->mbytes, &mbochs_avail_mbytes);"
    },
    {
        "line": 13,
        "fullcodeline": "} while (!atomic_try_cmpxchg(&mbochs_avail_mbytes, &avail_mbytes,"
    },
    {
        "line": 17,
        "fullcodeline": "if (mdev_state == NULL)"
    },
    {
        "line": 22,
        "fullcodeline": "if (mdev_state->vconfig == NULL)"
    },
    {
        "line": 30,
        "fullcodeline": "if (!mdev_state->pages)"
    },
    {
        "line": 5,
        "fullcodeline": "&mbochs_types[mdev_get_type_group_id(mdev)];"
    },
    {
        "line": 11,
        "fullcodeline": "if (avail_mbytes < type->mbytes)"
    },
    {
        "line": 14,
        "fullcodeline": "avail_mbytes - type->mbytes));"
    },
    {
        "line": 12,
        "fullcodeline": "return -ENOSPC;"
    }
]