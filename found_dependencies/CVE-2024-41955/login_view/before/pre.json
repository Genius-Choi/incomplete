[
    {
        "line": 5,
        "fullcodeline": "sso = (settings.IDP_METADATA_URL"
    },
    {
        "line": 15,
        "fullcodeline": "nextp = request.GET.get('next', '')"
    },
    {
        "line": 16,
        "fullcodeline": "redirect_url = nextp if nextp.startswith('/') else '/'"
    },
    {
        "line": 29,
        "fullcodeline": "context = {"
    },
    {
        "line": 3,
        "fullcodeline": "if settings.DISABLE_AUTHENTICATION == '1':"
    },
    {
        "line": 9,
        "fullcodeline": "if not sso:"
    },
    {
        "line": 19,
        "fullcodeline": "if request.method == 'POST':"
    },
    {
        "line": 37,
        "fullcodeline": "return render(request, 'auth/login.html', context)"
    },
    {
        "line": 6,
        "fullcodeline": "or (settings.IDP_SSO_URL"
    },
    {
        "line": 10,
        "fullcodeline": "allow_pwd = True"
    },
    {
        "line": 22,
        "fullcodeline": "form = AuthenticationForm(request, request.POST)"
    },
    {
        "line": 28,
        "fullcodeline": "form = AuthenticationForm()"
    },
    {
        "line": 4,
        "fullcodeline": "return redirect('/')"
    },
    {
        "line": 18,
        "fullcodeline": "return redirect(redirect_url)"
    },
    {
        "line": 20,
        "fullcodeline": "if sso and not allow_pwd:"
    },
    {
        "line": 23,
        "fullcodeline": "if form.is_valid():"
    },
    {
        "line": 11,
        "fullcodeline": "elif bool(settings.SP_ALLOW_PASSWORD == '1'):"
    },
    {
        "line": 12,
        "fullcodeline": "allow_pwd = True"
    },
    {
        "line": 14,
        "fullcodeline": "allow_pwd = False"
    },
    {
        "line": 24,
        "fullcodeline": "user = form.get_user()"
    },
    {
        "line": 21,
        "fullcodeline": "return redirect('/')"
    },
    {
        "line": 26,
        "fullcodeline": "return redirect(redirect_url)"
    }
]