[
    {
        "line": 3,
        "fullcodeline": "struct device *ddev = &dev->dev;"
    },
    {
        "line": 10,
        "fullcodeline": "bos = kzalloc(sizeof(struct usb_bos_descriptor), GFP_KERNEL);"
    },
    {
        "line": 15,
        "fullcodeline": "ret = usb_get_descriptor(dev, USB_DT_BOS, 0, bos, USB_DT_BOS_SIZE);"
    },
    {
        "line": 24,
        "fullcodeline": "length = bos->bLength;"
    },
    {
        "line": 25,
        "fullcodeline": "total_len = le16_to_cpu(bos->wTotalLength);"
    },
    {
        "line": 26,
        "fullcodeline": "num = bos->bNumDeviceCaps;"
    },
    {
        "line": 31,
        "fullcodeline": "dev->bos = kzalloc(sizeof(struct usb_host_bos), GFP_KERNEL);"
    },
    {
        "line": 36,
        "fullcodeline": "buffer = kzalloc(total_len, GFP_KERNEL);"
    },
    {
        "line": 43,
        "fullcodeline": "ret = usb_get_descriptor(dev, USB_DT_BOS, 0, buffer, total_len);"
    },
    {
        "line": 50,
        "fullcodeline": "total_len -= length;"
    },
    {
        "line": 11,
        "fullcodeline": "if (!bos)"
    },
    {
        "line": 16,
        "fullcodeline": "if (ret < USB_DT_BOS_SIZE) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (total_len < length)"
    },
    {
        "line": 32,
        "fullcodeline": "if (!dev->bos)"
    },
    {
        "line": 37,
        "fullcodeline": "if (!buffer) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (ret < total_len) {"
    },
    {
        "line": 52,
        "fullcodeline": "for (i = 0; i < num; i++) {"
    },
    {
        "line": 38,
        "fullcodeline": "ret = -ENOMEM;"
    },
    {
        "line": 53,
        "fullcodeline": "buffer += length;"
    },
    {
        "line": 54,
        "fullcodeline": "cap = (struct usb_dev_cap_header *)buffer;"
    },
    {
        "line": 60,
        "fullcodeline": "length = cap->bLength;"
    },
    {
        "line": 61,
        "fullcodeline": "total_len -= length;"
    },
    {
        "line": 12,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 18,
        "fullcodeline": "if (ret >= 0)"
    },
    {
        "line": 29,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 33,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 46,
        "fullcodeline": "if (ret >= 0)"
    },
    {
        "line": 63,
        "fullcodeline": "if (cap->bDescriptorType != USB_DT_DEVICE_CAPABILITY) {"
    },
    {
        "line": 19,
        "fullcodeline": "ret = -ENOMSG;"
    },
    {
        "line": 47,
        "fullcodeline": "ret = -ENOMSG;"
    },
    {
        "line": 56,
        "fullcodeline": "if (total_len < sizeof(*cap) || total_len < cap->bLength) {"
    }
]