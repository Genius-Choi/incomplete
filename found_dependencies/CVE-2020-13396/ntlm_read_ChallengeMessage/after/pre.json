[
    {
        "line": 3,
        "fullcodeline": "SECURITY_STATUS status = SEC_E_INVALID_TOKEN;"
    },
    {
        "line": 13,
        "fullcodeline": "ntlm_generate_client_challenge(context);"
    },
    {
        "line": 14,
        "fullcodeline": "message = &context->CHALLENGE_MESSAGE;"
    },
    {
        "line": 15,
        "fullcodeline": "ZeroMemory(message, sizeof(NTLM_CHALLENGE_MESSAGE));"
    },
    {
        "line": 16,
        "fullcodeline": "s = Stream_New((BYTE*)buffer->pvBuffer, buffer->cbBuffer);"
    },
    {
        "line": 21,
        "fullcodeline": "StartOffset = Stream_GetPosition(s);"
    },
    {
        "line": 35,
        "fullcodeline": "Stream_Read_UINT32(s, message->NegotiateFlags); /* NegotiateFlags (4 bytes) */"
    },
    {
        "line": 36,
        "fullcodeline": "context->NegotiateFlags = message->NegotiateFlags;"
    },
    {
        "line": 41,
        "fullcodeline": "Stream_Read(s, message->ServerChallenge, 8); /* ServerChallenge (8 bytes) */"
    },
    {
        "line": 42,
        "fullcodeline": "CopyMemory(context->ServerChallenge, message->ServerChallenge, 8);"
    },
    {
        "line": 47,
        "fullcodeline": "Stream_Read(s, message->Reserved, 8); /* Reserved (8 bytes), should be ignored */"
    },
    {
        "line": 59,
        "fullcodeline": "PayloadOffset = Stream_GetPosition(s);"
    },
    {
        "line": 61,
        "fullcodeline": "status = SEC_E_INTERNAL_ERROR;"
    },
    {
        "line": 94,
        "fullcodeline": "length = (PayloadOffset - StartOffset) + message->TargetName.Len + message->TargetInfo.Len;"
    },
    {
        "line": 135,
        "fullcodeline": "ntlm_generate_timestamp(context); /* Timestamp */"
    },
    {
        "line": 143,
        "fullcodeline": "ntlm_generate_key_exchange_key(context);     /* KeyExchangeKey */"
    },
    {
        "line": 144,
        "fullcodeline": "ntlm_generate_random_session_key(context);   /* RandomSessionKey */"
    },
    {
        "line": 145,
        "fullcodeline": "ntlm_generate_exported_session_key(context); /* ExportedSessionKey */"
    },
    {
        "line": 146,
        "fullcodeline": "ntlm_encrypt_random_session_key(context);    /* EncryptedRandomSessionKey */"
    },
    {
        "line": 148,
        "fullcodeline": "ntlm_generate_client_signing_key(context);"
    },
    {
        "line": 149,
        "fullcodeline": "ntlm_generate_server_signing_key(context);"
    },
    {
        "line": 151,
        "fullcodeline": "ntlm_generate_client_sealing_key(context);"
    },
    {
        "line": 152,
        "fullcodeline": "ntlm_generate_server_sealing_key(context);"
    },
    {
        "line": 179,
        "fullcodeline": "context->state = NTLM_STATE_AUTHENTICATE;"
    },
    {
        "line": 181,
        "fullcodeline": "status = SEC_I_CONTINUE_NEEDED;"
    },
    {
        "line": 183,
        "fullcodeline": "Stream_Free(s, FALSE);"
    },
    {
        "line": 10,
        "fullcodeline": "if (!context || !buffer)"
    },
    {
        "line": 18,
        "fullcodeline": "if (!s)"
    },
    {
        "line": 26,
        "fullcodeline": "if (message->MessageType != MESSAGE_TYPE_CHALLENGE)"
    },
    {
        "line": 52,
        "fullcodeline": "if (context->NegotiateFlags & NTLMSSP_NEGOTIATE_VERSION)"
    },
    {
        "line": 62,
        "fullcodeline": "if (message->TargetName.Len > 0)"
    },
    {
        "line": 68,
        "fullcodeline": "if (message->TargetInfo.Len > 0)"
    },
    {
        "line": 95,
        "fullcodeline": "if (length > buffer->cbBuffer)"
    },
    {
        "line": 23,
        "fullcodeline": "if (ntlm_read_message_header(s, (NTLM_MESSAGE_HEADER*)message) < 0)"
    },
    {
        "line": 29,
        "fullcodeline": "if (ntlm_read_message_fields(s, &(message->TargetName)) < 0) /* TargetNameFields (8 bytes) */"
    },
    {
        "line": 32,
        "fullcodeline": "if (Stream_GetRemainingLength(s) < 4)"
    },
    {
        "line": 38,
        "fullcodeline": "if (Stream_GetRemainingLength(s) < 8)"
    },
    {
        "line": 44,
        "fullcodeline": "if (Stream_GetRemainingLength(s) < 8)"
    },
    {
        "line": 49,
        "fullcodeline": "if (ntlm_read_message_fields(s, &(message->TargetInfo)) < 0) /* TargetInfoFields (8 bytes) */"
    },
    {
        "line": 77,
        "fullcodeline": "AvTimestamp = ntlm_av_pair_get((NTLM_AV_PAIR*)message->TargetInfo.Buffer,"
    },
    {
        "line": 98,
        "fullcodeline": "if (!sspi_SecBufferAlloc(&context->ChallengeMessage, length))"
    },
    {
        "line": 137,
        "fullcodeline": "if (ntlm_compute_lm_v2_response(context) < 0) /* LmChallengeResponse */"
    },
    {
        "line": 140,
        "fullcodeline": "if (ntlm_compute_ntlm_v2_response(context) < 0) /* NtChallengeResponse */"
    },
    {
        "line": 54,
        "fullcodeline": "if (ntlm_read_version_info(s, &(message->Version)) < 0) /* Version (8 bytes) */"
    },
    {
        "line": 64,
        "fullcodeline": "if (ntlm_read_message_fields_buffer(s, &(message->TargetName)) < 0)"
    },
    {
        "line": 72,
        "fullcodeline": "if (ntlm_read_message_fields_buffer(s, &(message->TargetInfo)) < 0)"
    },
    {
        "line": 82,
        "fullcodeline": "PBYTE ptr = ntlm_av_pair_get_value_pointer(AvTimestamp);"
    },
    {
        "line": 90,
        "fullcodeline": "CopyMemory(context->ChallengeTimestamp, ptr, 8);"
    },
    {
        "line": 102,
        "fullcodeline": "CopyMemory(context->ChallengeMessage.pvBuffer, Stream_Buffer(s) + StartOffset, length);"
    },
    {
        "line": 127,
        "fullcodeline": "if (ntlm_construct_authenticate_target_info(context) < 0)"
    },
    {
        "line": 84,
        "fullcodeline": "if (!ptr)"
    },
    {
        "line": 88,
        "fullcodeline": "context->UseMIC = TRUE;"
    }
]