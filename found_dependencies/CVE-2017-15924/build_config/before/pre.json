[
    {
        "line": 3,
        "fullcodeline": "char *path    = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "int path_size = strlen(prefix) + strlen(server->port) + 20;"
    },
    {
        "line": 6,
        "fullcodeline": "path = ss_malloc(path_size);"
    },
    {
        "line": 7,
        "fullcodeline": "snprintf(path, path_size, \"%s/.shadowsocks_%s.conf\", prefix, server->port);"
    },
    {
        "line": 8,
        "fullcodeline": "FILE *f = fopen(path, \"w+\");"
    },
    {
        "line": 16,
        "fullcodeline": "fprintf(f, \"{\\n\");"
    },
    {
        "line": 17,
        "fullcodeline": "fprintf(f, \"\\\"server_port\\\":%d,\\n\", atoi(server->port));"
    },
    {
        "line": 18,
        "fullcodeline": "fprintf(f, \"\\\"password\\\":\\\"%s\\\"\", server->password);"
    },
    {
        "line": 24,
        "fullcodeline": "fprintf(f, \"\\n}\\n\");"
    },
    {
        "line": 9,
        "fullcodeline": "if (f == NULL) {"
    },
    {
        "line": 13,
        "fullcodeline": "ss_free(path);"
    },
    {
        "line": 19,
        "fullcodeline": "if (server->fast_open[0]) fprintf(f, \",\\n\\\"fast_open\\\": %s\", server->fast_open);"
    },
    {
        "line": 20,
        "fullcodeline": "if (server->mode)   fprintf(f, \",\\n\\\"mode\\\":\\\"%s\\\"\", server->mode);"
    },
    {
        "line": 21,
        "fullcodeline": "if (server->method) fprintf(f, \",\\n\\\"method\\\":\\\"%s\\\"\", server->method);"
    },
    {
        "line": 22,
        "fullcodeline": "if (server->plugin) fprintf(f, \",\\n\\\"plugin\\\":\\\"%s\\\"\", server->plugin);"
    },
    {
        "line": 23,
        "fullcodeline": "if (server->plugin_opts) fprintf(f, \",\\n\\\"plugin_opts\\\":\\\"%s\\\"\", server->plugin_opts);"
    },
    {
        "line": 11,
        "fullcodeline": "LOGE(\"unable to open config file\");"
    }
]