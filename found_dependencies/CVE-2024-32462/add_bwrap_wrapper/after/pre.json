[
    {
        "line": 5,
        "fullcodeline": "glnx_autofd int app_info_fd = -1;"
    },
    {
        "line": 8,
        "fullcodeline": "g_autofree char *user_runtime_dir = flatpak_get_real_xdg_runtime_dir ();"
    },
    {
        "line": 9,
        "fullcodeline": "g_autofree char *proxy_socket_dir = g_build_filename (user_runtime_dir, \".dbus-proxy/\", NULL);"
    },
    {
        "line": 11,
        "fullcodeline": "app_info_fd = open (app_info_path, O_RDONLY | O_CLOEXEC);"
    },
    {
        "line": 18,
        "fullcodeline": "flatpak_bwrap_add_arg (bwrap, flatpak_get_bwrap ());"
    },
    {
        "line": 64,
        "fullcodeline": "flatpak_bwrap_add_args (bwrap, \"--bind\", proxy_socket_dir, proxy_socket_dir, NULL);"
    },
    {
        "line": 68,
        "fullcodeline": "flatpak_bwrap_add_args (bwrap, \"--perms\", \"0600\", NULL);"
    },
    {
        "line": 69,
        "fullcodeline": "flatpak_bwrap_add_args_data_fd (bwrap, \"--file\", glnx_steal_fd (&app_info_fd), \"/.flatpak-info\");"
    },
    {
        "line": 12,
        "fullcodeline": "if (app_info_fd == -1)"
    },
    {
        "line": 15,
        "fullcodeline": "if (!glnx_dirfd_iterator_init_at (AT_FDCWD, \"/\", FALSE, &dir_iter, error))"
    },
    {
        "line": 35,
        "fullcodeline": "o_path_fd = openat (dir_iter.fd, dent->d_name, O_PATH | O_NOFOLLOW | O_CLOEXEC);"
    },
    {
        "line": 71,
        "fullcodeline": "if (!flatpak_bwrap_bundle_args (bwrap, 1, -1, FALSE, error))"
    },
    {
        "line": 13,
        "fullcodeline": "return glnx_throw_errno_prefix (error, _(\"Failed to open app info file\"));"
    },
    {
        "line": 22,
        "fullcodeline": "glnx_autofd int o_path_fd = -1;"
    },
    {
        "line": 28,
        "fullcodeline": "if (dent == NULL)"
    },
    {
        "line": 39,
        "fullcodeline": "if (dent->d_type == DT_DIR)"
    },
    {
        "line": 25,
        "fullcodeline": "if (!glnx_dirfd_iterator_next_dent_ensure_dtype (&dir_iter, &dent, NULL, error))"
    },
    {
        "line": 31,
        "fullcodeline": "if (strcmp (dent->d_name, \".flatpak-info\") == 0)"
    },
    {
        "line": 36,
        "fullcodeline": "if (o_path_fd == -1 || fstatfs (o_path_fd, &stfs) != 0 || stfs.f_type == AUTOFS_SUPER_MAGIC)"
    },
    {
        "line": 48,
        "fullcodeline": "flatpak_bwrap_add_arg_printf (bwrap, \"/%s\", dent->d_name);"
    },
    {
        "line": 49,
        "fullcodeline": "flatpak_bwrap_add_arg_printf (bwrap, \"/%s\", dent->d_name);"
    },
    {
        "line": 41,
        "fullcodeline": "if (strcmp (dent->d_name, \"tmp\") == 0 ||"
    },
    {
        "line": 43,
        "fullcodeline": "strcmp (dent->d_name, \"run\") == 0)"
    },
    {
        "line": 44,
        "fullcodeline": "flatpak_bwrap_add_arg (bwrap, \"--bind\");"
    },
    {
        "line": 51,
        "fullcodeline": "else if (dent->d_type == DT_LNK)"
    },
    {
        "line": 42,
        "fullcodeline": "strcmp (dent->d_name, \"var\") == 0 ||"
    },
    {
        "line": 46,
        "fullcodeline": "flatpak_bwrap_add_arg (bwrap, \"--ro-bind\");"
    },
    {
        "line": 53,
        "fullcodeline": "g_autofree gchar *target = NULL;"
    },
    {
        "line": 55,
        "fullcodeline": "target = glnx_readlinkat_malloc (dir_iter.fd, dent->d_name,"
    },
    {
        "line": 59,
        "fullcodeline": "flatpak_bwrap_add_args (bwrap, \"--symlink\", target, NULL);"
    },
    {
        "line": 60,
        "fullcodeline": "flatpak_bwrap_add_arg_printf (bwrap, \"/%s\", dent->d_name);"
    },
    {
        "line": 57,
        "fullcodeline": "if (target == NULL)"
    }
]