[
    {
        "line": 3,
        "fullcodeline": "unsigned char iv[96] = {0}, * key = NULL, cipherkey[64] = {0}, tag[128] = {0}, tag_b64url[256] = {0};"
    },
    {
        "line": 4,
        "fullcodeline": "size_t iv_len = 0, key_len = 0, cipherkey_len = 0, tag_b64url_len = 0, tag_len = gnutls_cipher_get_tag_size(r_jwe_get_alg_from_alg(alg));"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned int bits = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "gnutls_cipher_hd_t handle = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "if (r_jwk_key_type(jwk, &bits, x5u_flags) & R_KEY_TYPE_SYMMETRIC && o_strlen(r_jwe_get_header_str_value(jwe, \"iv\")) && o_strlen(r_jwe_get_header_str_value(jwe, \"tag\"))) {"
    },
    {
        "line": 10,
        "fullcodeline": "ret = RHN_OK;"
    },
    {
        "line": 11,
        "fullcodeline": "key_len = bits;"
    },
    {
        "line": 70,
        "fullcodeline": "o_free(key);"
    },
    {
        "line": 71,
        "fullcodeline": "if (handle != NULL) {"
    },
    {
        "line": 75,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error invalid key\");"
    },
    {
        "line": 76,
        "fullcodeline": "ret = RHN_ERROR_INVALID;"
    },
    {
        "line": 34,
        "fullcodeline": "key_g.data = key;"
    },
    {
        "line": 35,
        "fullcodeline": "key_g.size = key_len;"
    },
    {
        "line": 36,
        "fullcodeline": "iv_g.data = iv;"
    },
    {
        "line": 37,
        "fullcodeline": "iv_g.size = iv_len;"
    },
    {
        "line": 58,
        "fullcodeline": "tag_b64url[tag_b64url_len] = '\\0';"
    },
    {
        "line": 72,
        "fullcodeline": "gnutls_cipher_deinit(handle);"
    },
    {
        "line": 14,
        "fullcodeline": "if ((key = o_malloc(key_len+4)) == NULL) {"
    },
    {
        "line": 19,
        "fullcodeline": "if (r_jwk_export_to_symmetric_key(jwk, key, &key_len) != RHN_OK) {"
    },
    {
        "line": 24,
        "fullcodeline": "if (!o_base64url_decode((const unsigned char *)r_jwe_get_header_str_value(jwe, \"iv\"), o_strlen(r_jwe_get_header_str_value(jwe, \"iv\")), iv, &iv_len)) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (!o_base64url_decode((const unsigned char *)jwe->encrypted_key_b64url, o_strlen((const char *)jwe->encrypted_key_b64url), cipherkey, &cipherkey_len)) {"
    },
    {
        "line": 38,
        "fullcodeline": "if ((res = gnutls_cipher_init(&handle, r_jwe_get_alg_from_alg(alg), &key_g, &iv_g))) {"
    },
    {
        "line": 43,
        "fullcodeline": "if ((res = gnutls_cipher_decrypt(handle, cipherkey, cipherkey_len))) {"
    },
    {
        "line": 48,
        "fullcodeline": "if ((res = gnutls_cipher_tag(handle, tag, tag_len))) {"
    },
    {
        "line": 53,
        "fullcodeline": "if (!o_base64url_encode(tag, tag_len, tag_b64url, &tag_b64url_len)) {"
    },
    {
        "line": 59,
        "fullcodeline": "if (0 != o_strcmp((const char *)tag_b64url, r_jwe_get_header_str_value(jwe, \"tag\"))) {"
    },
    {
        "line": 64,
        "fullcodeline": "if (r_jwe_set_cypher_key(jwe, cipherkey, cipherkey_len) != RHN_OK) {"
    },
    {
        "line": 15,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error allocating resources for key\");"
    },
    {
        "line": 16,
        "fullcodeline": "ret = RHN_ERROR_MEMORY;"
    },
    {
        "line": 20,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error r_jwk_export_to_symmetric_key\");"
    },
    {
        "line": 21,
        "fullcodeline": "ret = RHN_ERROR;"
    },
    {
        "line": 25,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error o_base64url_decode iv\");"
    },
    {
        "line": 26,
        "fullcodeline": "ret = RHN_ERROR_INVALID;"
    },
    {
        "line": 30,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error o_base64url_decode cipherkey\");"
    },
    {
        "line": 31,
        "fullcodeline": "ret = RHN_ERROR_INVALID;"
    },
    {
        "line": 39,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error gnutls_cipher_init: '%s'\", gnutls_strerror(res));"
    },
    {
        "line": 40,
        "fullcodeline": "ret = RHN_ERROR_INVALID;"
    },
    {
        "line": 44,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error gnutls_cipher_decrypt: '%s'\", gnutls_strerror(res));"
    },
    {
        "line": 45,
        "fullcodeline": "ret = RHN_ERROR;"
    },
    {
        "line": 49,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error gnutls_cipher_tag: '%s'\", gnutls_strerror(res));"
    },
    {
        "line": 50,
        "fullcodeline": "ret = RHN_ERROR;"
    },
    {
        "line": 54,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error o_base64url_encode tag\");"
    },
    {
        "line": 55,
        "fullcodeline": "ret = RHN_ERROR;"
    },
    {
        "line": 60,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Invalid tag %s %s\", tag_b64url, r_jwe_get_header_str_value(jwe, \"tag\"));"
    },
    {
        "line": 61,
        "fullcodeline": "ret = RHN_ERROR_INVALID;"
    },
    {
        "line": 65,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"r_jwe_aesgcm_key_unwrap - Error r_jwe_set_cypher_key\");"
    },
    {
        "line": 66,
        "fullcodeline": "ret = RHN_ERROR;"
    }
]