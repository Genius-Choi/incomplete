[
    {
        "line": 2,
        "fullcodeline": "back_url = params[:back_url].to_s"
    },
    {
        "line": 1,
        "fullcodeline": "def redirect_back_or_default(default, options={})"
    },
    {
        "line": 5,
        "fullcodeline": "uri = URI.parse(back_url)"
    },
    {
        "line": 7,
        "fullcodeline": "if ((uri.relative? && back_url.match(%r{\\A/\\w})) || (uri.host == request.host)) && !uri.path.match(%r{/(login|account/register)})"
    },
    {
        "line": 8,
        "fullcodeline": "redirect_to(back_url)"
    },
    {
        "line": 12,
        "fullcodeline": "logger.warn(\"Could not redirect to invalid URL #{back_url}\")"
    }
]