[
    {
        "line": 2,
        "fullcodeline": "form = forms.PasswordLoginForm()"
    },
    {
        "line": 3,
        "fullcodeline": "magic_form = forms.EmailLoginForm()"
    },
    {
        "line": 31,
        "fullcodeline": "bad_link = request.session.pop(\"bad_link\", None)"
    },
    {
        "line": 32,
        "fullcodeline": "ctx = {"
    },
    {
        "line": 5,
        "fullcodeline": "if request.method == \"POST\":"
    },
    {
        "line": 40,
        "fullcodeline": "return render(request, \"accounts/login.html\", ctx)"
    },
    {
        "line": 6,
        "fullcodeline": "if request.POST.get(\"action\") == \"login\":"
    },
    {
        "line": 29,
        "fullcodeline": "return _redirect_after_login(request)"
    },
    {
        "line": 7,
        "fullcodeline": "form = forms.PasswordLoginForm(request.POST)"
    },
    {
        "line": 12,
        "fullcodeline": "magic_form = forms.EmailLoginForm(request.POST)"
    },
    {
        "line": 8,
        "fullcodeline": "if form.is_valid():"
    },
    {
        "line": 13,
        "fullcodeline": "if magic_form.is_valid():"
    },
    {
        "line": 14,
        "fullcodeline": "redirect_url = request.GET.get(\"next\")"
    },
    {
        "line": 22,
        "fullcodeline": "response = redirect(\"hc-login-link-sent\")"
    },
    {
        "line": 25,
        "fullcodeline": "response.set_cookie(\"auto-login\", \"1\", max_age=300, httponly=True)"
    },
    {
        "line": 9,
        "fullcodeline": "return _check_2fa(request, form.user)"
    },
    {
        "line": 15,
        "fullcodeline": "if not _allow_redirect(redirect_url):"
    },
    {
        "line": 16,
        "fullcodeline": "redirect_url = None"
    },
    {
        "line": 19,
        "fullcodeline": "profile = Profile.objects.for_user(magic_form.user)"
    },
    {
        "line": 20,
        "fullcodeline": "profile.send_instant_login_link(redirect_url=redirect_url)"
    }
]