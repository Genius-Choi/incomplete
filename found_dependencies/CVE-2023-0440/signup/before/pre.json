[
    {
        "line": 5,
        "fullcodeline": "ctx = {}"
    },
    {
        "line": 6,
        "fullcodeline": "form = forms.SignupForm(request.POST)"
    },
    {
        "line": 17,
        "fullcodeline": "response = render(request, \"accounts/signup_result.html\", ctx)"
    },
    {
        "line": 2,
        "fullcodeline": "if not settings.REGISTRATION_OPEN:"
    },
    {
        "line": 7,
        "fullcodeline": "if form.is_valid():"
    },
    {
        "line": 8,
        "fullcodeline": "email = form.cleaned_data[\"identity\"]"
    },
    {
        "line": 9,
        "fullcodeline": "tz = form.cleaned_data[\"tz\"]"
    },
    {
        "line": 10,
        "fullcodeline": "user = _make_user(email, tz)"
    },
    {
        "line": 11,
        "fullcodeline": "profile = Profile.objects.for_user(user)"
    },
    {
        "line": 13,
        "fullcodeline": "ctx[\"created\"] = True"
    },
    {
        "line": 15,
        "fullcodeline": "ctx = {\"form\": form}"
    },
    {
        "line": 19,
        "fullcodeline": "response.set_cookie(\"auto-login\", \"1\", max_age=300, httponly=True)"
    },
    {
        "line": 3,
        "fullcodeline": "return HttpResponseForbidden()"
    }
]