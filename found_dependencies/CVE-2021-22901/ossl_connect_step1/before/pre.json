[
    {
        "line": 4,
        "fullcodeline": "CURLcode result = CURLE_OK;"
    },
    {
        "line": 6,
        "fullcodeline": "SSL_METHOD_QUAL SSL_METHOD *req_method = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "X509_LOOKUP *lookup = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "curl_socket_t sockfd = conn->sock[sockindex];"
    },
    {
        "line": 9,
        "fullcodeline": "struct ssl_connect_data *connssl = &conn->ssl[sockindex];"
    },
    {
        "line": 10,
        "fullcodeline": "ctx_option_t ctx_options = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "const long int ssl_version = SSL_CONN_CONFIG(version);"
    },
    {
        "line": 26,
        "fullcodeline": "char * const ssl_cert = SSL_SET_OPTION(primary.clientcert);"
    },
    {
        "line": 27,
        "fullcodeline": "const struct curl_blob *ssl_cert_blob = SSL_SET_OPTION(primary.cert_blob);"
    },
    {
        "line": 28,
        "fullcodeline": "const struct curl_blob *ca_info_blob = SSL_CONN_CONFIG(ca_info_blob);"
    },
    {
        "line": 29,
        "fullcodeline": "const char * const ssl_cert_type = SSL_SET_OPTION(cert_type);"
    },
    {
        "line": 30,
        "fullcodeline": "const char * const ssl_cafile ="
    },
    {
        "line": 33,
        "fullcodeline": "const char * const ssl_capath = SSL_CONN_CONFIG(CApath);"
    },
    {
        "line": 34,
        "fullcodeline": "const bool verifypeer = SSL_CONN_CONFIG(verifypeer);"
    },
    {
        "line": 35,
        "fullcodeline": "const char * const ssl_crlfile = SSL_SET_OPTION(CRLfile);"
    },
    {
        "line": 36,
        "fullcodeline": "char error_buffer[256];"
    },
    {
        "line": 37,
        "fullcodeline": "struct ssl_backend_data *backend = connssl->backend;"
    },
    {
        "line": 38,
        "fullcodeline": "bool imported_native_ca = false;"
    },
    {
        "line": 40,
        "fullcodeline": "DEBUGASSERT(ssl_connect_1 == connssl->connecting_state);"
    },
    {
        "line": 43,
        "fullcodeline": "result = ossl_seed(data);"
    },
    {
        "line": 47,
        "fullcodeline": "SSL_SET_OPTION_LVALUE(certverifyresult) = !X509_V_OK;"
    },
    {
        "line": 79,
        "fullcodeline": "backend->ctx = SSL_CTX_new(req_method);"
    },
    {
        "line": 136,
        "fullcodeline": "ctx_options = SSL_OP_ALL;"
    },
    {
        "line": 190,
        "fullcodeline": "SSL_CTX_set_options(backend->ctx, ctx_options);"
    },
    {
        "line": 243,
        "fullcodeline": "ciphers = SSL_CONN_CONFIG(cipher_list);"
    },
    {
        "line": 581,
        "fullcodeline": "SSL_CTX_set_verify(backend->ctx,"
    },
    {
        "line": 595,
        "fullcodeline": "SSL_CTX_set_session_cache_mode(backend->ctx,"
    },
    {
        "line": 597,
        "fullcodeline": "SSL_CTX_sess_set_new_cb(backend->ctx, ossl_new_session_cb);"
    },
    {
        "line": 614,
        "fullcodeline": "backend->handle = SSL_new(backend->ctx);"
    },
    {
        "line": 630,
        "fullcodeline": "SSL_set_connect_state(backend->handle);"
    },
    {
        "line": 715,
        "fullcodeline": "connssl->connecting_state = ssl_connect_2;"
    },
    {
        "line": 32,
        "fullcodeline": "(ca_info_blob ? NULL : SSL_CONN_CONFIG(CAfile));"
    },
    {
        "line": 81,
        "fullcodeline": "if(!backend->ctx) {"
    },
    {
        "line": 231,
        "fullcodeline": "if(ssl_cert || ssl_cert_blob || ssl_cert_type) {"
    },
    {
        "line": 244,
        "fullcodeline": "if(!ciphers)"
    },
    {
        "line": 497,
        "fullcodeline": "if(ssl_cafile || ssl_capath) {"
    },
    {
        "line": 582,
        "fullcodeline": "verifypeer ? SSL_VERIFY_PEER : SSL_VERIFY_NONE, NULL);"
    },
    {
        "line": 596,
        "fullcodeline": "SSL_SESS_CACHE_CLIENT | SSL_SESS_CACHE_NO_INTERNAL);"
    },
    {
        "line": 615,
        "fullcodeline": "if(!backend->handle) {"
    },
    {
        "line": 62,
        "fullcodeline": "req_method = SSLv23_client_method();"
    },
    {
        "line": 64,
        "fullcodeline": "use_sni(TRUE);"
    },
    {
        "line": 172,
        "fullcodeline": "ctx_options |= SSL_OP_NO_SSLv2;"
    },
    {
        "line": 173,
        "fullcodeline": "ctx_options |= SSL_OP_NO_SSLv3;"
    },
    {
        "line": 178,
        "fullcodeline": "result = set_ssl_version_min_max_legacy(&ctx_options, data, conn,"
    },
    {
        "line": 245,
        "fullcodeline": "ciphers = (char *)DEFAULT_CIPHER_SELECTION;"
    },
    {
        "line": 251,
        "fullcodeline": "infof(data, \"Cipher selection: %s\\n\", ciphers);"
    },
    {
        "line": 456,
        "fullcodeline": "result = load_cacert_from_memory(backend->ctx, ca_info_blob);"
    },
    {
        "line": 518,
        "fullcodeline": "infof(data, \" CAfile: %s\\n\", ssl_cafile ? ssl_cafile : \"none\");"
    },
    {
        "line": 519,
        "fullcodeline": "infof(data, \" CApath: %s\\n\", ssl_capath ? ssl_capath : \"none\");"
    },
    {
        "line": 535,
        "fullcodeline": "lookup = X509_STORE_add_lookup(SSL_CTX_get_cert_store(backend->ctx),"
    },
    {
        "line": 543,
        "fullcodeline": "infof(data, \"successfully load CRL file:\\n\");"
    },
    {
        "line": 547,
        "fullcodeline": "infof(data, \"  CRLfile: %s\\n\", ssl_crlfile);"
    },
    {
        "line": 601,
        "fullcodeline": "Curl_set_in_callback(data, true);"
    },
    {
        "line": 602,
        "fullcodeline": "result = (*data->set.ssl.fsslctx)(data, backend->ctx,"
    },
    {
        "line": 604,
        "fullcodeline": "Curl_set_in_callback(data, false);"
    },
    {
        "line": 657,
        "fullcodeline": "void *ssl_sessionid = NULL;"
    },
    {
        "line": 658,
        "fullcodeline": "int data_idx = ossl_get_ssl_data_index();"
    },
    {
        "line": 659,
        "fullcodeline": "int connectdata_idx = ossl_get_ssl_conn_index();"
    },
    {
        "line": 660,
        "fullcodeline": "int sockindex_idx = ossl_get_ssl_sockindex_index();"
    },
    {
        "line": 661,
        "fullcodeline": "int proxy_idx = ossl_get_proxy_index();"
    },
    {
        "line": 679,
        "fullcodeline": "Curl_ssl_sessionid_lock(data);"
    },
    {
        "line": 693,
        "fullcodeline": "Curl_ssl_sessionid_unlock(data);"
    },
    {
        "line": 698,
        "fullcodeline": "BIO *const bio = BIO_new(BIO_f_ssl());"
    },
    {
        "line": 699,
        "fullcodeline": "SSL *handle = conn->proxy_ssl[sockindex].backend->handle;"
    },
    {
        "line": 703,
        "fullcodeline": "BIO_set_ssl(bio, handle, FALSE);"
    },
    {
        "line": 83,
        "fullcodeline": "ossl_strerror(ERR_peek_error(), error_buffer, sizeof(error_buffer)));"
    },
    {
        "line": 181,
        "fullcodeline": "if(result != CURLE_OK)"
    },
    {
        "line": 544,
        "fullcodeline": "X509_STORE_set_flags(SSL_CTX_get_cert_store(backend->ctx),"
    },
    {
        "line": 545,
        "fullcodeline": "X509_V_FLAG_CRL_CHECK|X509_V_FLAG_CRL_CHECK_ALL);"
    },
    {
        "line": 700,
        "fullcodeline": "DEBUGASSERT(ssl_connection_complete == conn->proxy_ssl[sockindex].state);"
    },
    {
        "line": 701,
        "fullcodeline": "DEBUGASSERT(handle != NULL);"
    },
    {
        "line": 702,
        "fullcodeline": "DEBUGASSERT(bio != NULL);"
    },
    {
        "line": 232,
        "fullcodeline": "if(!result &&"
    },
    {
        "line": 233,
        "fullcodeline": "!cert_stuff(data, backend->ctx,"
    },
    {
        "line": 237,
        "fullcodeline": "result = CURLE_SSL_CERTPROBLEM;"
    },
    {
        "line": 247,
        "fullcodeline": "if(!SSL_CTX_set_cipher_list(backend->ctx, ciphers)) {"
    },
    {
        "line": 464,
        "fullcodeline": "infof(data, \"error importing CA certificate blob, continuing anyway\\n\");"
    },
    {
        "line": 500,
        "fullcodeline": "if(!SSL_CTX_load_verify_locations(backend->ctx, ssl_cafile, ssl_capath)) {"
    },
    {
        "line": 511,
        "fullcodeline": "infof(data, \"error setting certificate verify locations,\""
    },
    {
        "line": 537,
        "fullcodeline": "if(!lookup ||"
    },
    {
        "line": 538,
        "fullcodeline": "(!X509_load_crl_file(lookup, ssl_crlfile, X509_FILETYPE_PEM)) ) {"
    },
    {
        "line": 663,
        "fullcodeline": "if(data_idx >= 0 && connectdata_idx >= 0 && sockindex_idx >= 0 &&"
    },
    {
        "line": 664,
        "fullcodeline": "proxy_idx >= 0) {"
    },
    {
        "line": 667,
        "fullcodeline": "SSL_set_ex_data(backend->handle, data_idx, data);"
    },
    {
        "line": 668,
        "fullcodeline": "SSL_set_ex_data(backend->handle, connectdata_idx, conn);"
    },
    {
        "line": 669,
        "fullcodeline": "SSL_set_ex_data(backend->handle, sockindex_idx, conn->sock + sockindex);"
    },
    {
        "line": 671,
        "fullcodeline": "SSL_set_ex_data(backend->handle, proxy_idx, SSL_IS_PROXY() ? (void *) 1:"
    },
    {
        "line": 680,
        "fullcodeline": "if(!Curl_ssl_getsessionid(data, conn, SSL_IS_PROXY() ? TRUE : FALSE,"
    },
    {
        "line": 691,
        "fullcodeline": "infof(data, \"SSL re-using session ID\\n\");"
    },
    {
        "line": 516,
        "fullcodeline": "infof(data, \"successfully set certificate verify locations:\\n\");"
    },
    {
        "line": 708,
        "fullcodeline": "if(!SSL_set_fd(backend->handle, (int)sockfd)) {"
    },
    {
        "line": 235,
        "fullcodeline": "SSL_SET_OPTION(key), SSL_SET_OPTION(key_blob),"
    },
    {
        "line": 236,
        "fullcodeline": "SSL_SET_OPTION(key_type), SSL_SET_OPTION(key_passwd)))"
    },
    {
        "line": 458,
        "fullcodeline": "if(result == CURLE_OUT_OF_MEMORY ||"
    },
    {
        "line": 459,
        "fullcodeline": "(verifypeer && !imported_native_ca)) {"
    },
    {
        "line": 501,
        "fullcodeline": "if(verifypeer && !imported_native_ca) {"
    },
    {
        "line": 683,
        "fullcodeline": "if(!SSL_set_session(backend->handle, ssl_sessionid)) {"
    },
    {
        "line": 684,
        "fullcodeline": "Curl_ssl_sessionid_unlock(data);"
    },
    {
        "line": 711,
        "fullcodeline": "ossl_strerror(ERR_get_error(), error_buffer, sizeof(error_buffer)));"
    },
    {
        "line": 686,
        "fullcodeline": "ossl_strerror(ERR_get_error(), error_buffer,"
    }
]