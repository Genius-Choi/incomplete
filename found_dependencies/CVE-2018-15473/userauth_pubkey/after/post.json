[
    {
        "line": 3,
        "fullcodeline": "Authctxt *authctxt = ssh->authctxt;"
    },
    {
        "line": 4,
        "fullcodeline": "struct passwd *pw = authctxt->pw;"
    },
    {
        "line": 5,
        "fullcodeline": "struct sshbuf *b = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "struct sshkey *key = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "char *pkalg = NULL, *userstyle = NULL, *key_s = NULL, *ca_s = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "u_char *pkblob = NULL, *sig = NULL, have_sig;"
    },
    {
        "line": 11,
        "fullcodeline": "int authenticated = 0;"
    },
    {
        "line": 12,
        "fullcodeline": "struct sshauthopt *authopts = NULL;"
    },
    {
        "line": 18,
        "fullcodeline": "pktype = sshkey_type_from_name(pkalg);"
    },
    {
        "line": 54,
        "fullcodeline": "key_s = format_key(key);"
    },
    {
        "line": 149,
        "fullcodeline": "debug2(\"%s: authenticated %d pkalg %s\", __func__, authenticated, pkalg);"
    },
    {
        "line": 151,
        "fullcodeline": "sshauthopt_free(authopts);"
    },
    {
        "line": 152,
        "fullcodeline": "sshkey_free(key);"
    },
    {
        "line": 153,
        "fullcodeline": "free(userstyle);"
    },
    {
        "line": 154,
        "fullcodeline": "free(pkalg);"
    },
    {
        "line": 155,
        "fullcodeline": "free(pkblob);"
    },
    {
        "line": 156,
        "fullcodeline": "free(key_s);"
    },
    {
        "line": 157,
        "fullcodeline": "free(ca_s);"
    },
    {
        "line": 158,
        "fullcodeline": "free(sig);"
    },
    {
        "line": 14,
        "fullcodeline": "if ((r = sshpkt_get_u8(ssh, &have_sig)) != 0 ||"
    },
    {
        "line": 19,
        "fullcodeline": "if (pktype == KEY_UNSPEC) {"
    },
    {
        "line": 25,
        "fullcodeline": "if ((r = sshkey_from_blob(pkblob, blen, &key)) != 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (key == NULL) {"
    },
    {
        "line": 33,
        "fullcodeline": "if (key->type != pktype) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (sshkey_type_plain(key->type) == KEY_RSA &&"
    },
    {
        "line": 44,
        "fullcodeline": "if (auth2_key_already_used(authctxt, key)) {"
    },
    {
        "line": 48,
        "fullcodeline": "if (match_pattern_list(pkalg, options.pubkey_key_types, 0) != 1) {"
    },
    {
        "line": 55,
        "fullcodeline": "if (sshkey_is_cert(key))"
    },
    {
        "line": 145,
        "fullcodeline": "if (authenticated == 1 && auth_activate_options(ssh, authopts) != 0) {"
    },
    {
        "line": 16,
        "fullcodeline": "(r = sshpkt_get_string(ssh, &pkblob, &blen)) != 0)"
    },
    {
        "line": 17,
        "fullcodeline": "fatal(\"%s: parse request failed: %s\", __func__, ssh_err(r));"
    },
    {
        "line": 21,
        "fullcodeline": "verbose(\"%s: unsupported public key algorithm: %s\","
    },
    {
        "line": 26,
        "fullcodeline": "error(\"%s: could not parse key: %s\", __func__, ssh_err(r));"
    },
    {
        "line": 30,
        "fullcodeline": "error(\"%s: cannot decode key: %s\", __func__, pkalg);"
    },
    {
        "line": 34,
        "fullcodeline": "error(\"%s: type mismatch for decoded key \""
    },
    {
        "line": 39,
        "fullcodeline": "(ssh->compat & SSH_BUG_RSASIGMD5) != 0) {"
    },
    {
        "line": 40,
        "fullcodeline": "logit(\"Refusing RSA key because client uses unsafe \""
    },
    {
        "line": 45,
        "fullcodeline": "logit(\"refusing previously-used %s key\", sshkey_type(key));"
    },
    {
        "line": 49,
        "fullcodeline": "logit(\"%s: key type %s not in PubkeyAcceptedKeyTypes\","
    },
    {
        "line": 56,
        "fullcodeline": "ca_s = format_key(key->cert->signature_key);"
    },
    {
        "line": 59,
        "fullcodeline": "debug3(\"%s: have %s signature for %s%s%s\","
    },
    {
        "line": 85,
        "fullcodeline": "xasprintf(&userstyle, \"%s%s%s\", authctxt->user,"
    },
    {
        "line": 101,
        "fullcodeline": "authenticated = 0;"
    },
    {
        "line": 109,
        "fullcodeline": "sshbuf_free(b);"
    },
    {
        "line": 110,
        "fullcodeline": "auth2_record_key(authctxt, authenticated, key);"
    },
    {
        "line": 146,
        "fullcodeline": "debug(\"%s: key options inconsistent with existing\", __func__);"
    },
    {
        "line": 147,
        "fullcodeline": "authenticated = 0;"
    },
    {
        "line": 15,
        "fullcodeline": "(r = sshpkt_get_cstring(ssh, &pkalg, NULL)) != 0 ||"
    },
    {
        "line": 50,
        "fullcodeline": "__func__, sshkey_ssh_name(key));"
    },
    {
        "line": 61,
        "fullcodeline": "ca_s == NULL ? \"\" : \" CA \","
    },
    {
        "line": 62,
        "fullcodeline": "ca_s == NULL ? \"\" : ca_s);"
    },
    {
        "line": 63,
        "fullcodeline": "if ((r = sshpkt_get_string(ssh, &sig, &slen)) != 0 ||"
    },
    {
        "line": 66,
        "fullcodeline": "if ((b = sshbuf_new()) == NULL)"
    },
    {
        "line": 68,
        "fullcodeline": "if (ssh->compat & SSH_OLD_SESSIONID) {"
    },
    {
        "line": 79,
        "fullcodeline": "if (!authctxt->valid || authctxt->user == NULL) {"
    },
    {
        "line": 86,
        "fullcodeline": "authctxt->style ? \":\" : \"\","
    },
    {
        "line": 87,
        "fullcodeline": "authctxt->style ? authctxt->style : \"\");"
    },
    {
        "line": 88,
        "fullcodeline": "if ((r = sshbuf_put_u8(b, SSH2_MSG_USERAUTH_REQUEST)) != 0 ||"
    },
    {
        "line": 102,
        "fullcodeline": "if (PRIVSEP(user_key_allowed(ssh, pw, key, 1, &authopts)) &&"
    },
    {
        "line": 112,
        "fullcodeline": "debug(\"%s: test pkalg %s pkblob %s%s%s\","
    },
    {
        "line": 64,
        "fullcodeline": "(r = sshpkt_get_end(ssh)) != 0)"
    },
    {
        "line": 65,
        "fullcodeline": "fatal(\"%s: %s\", __func__, ssh_err(r));"
    },
    {
        "line": 67,
        "fullcodeline": "fatal(\"%s: sshbuf_new failed\", __func__);"
    },
    {
        "line": 80,
        "fullcodeline": "debug2(\"%s: disabled because of invalid user\","
    },
    {
        "line": 94,
        "fullcodeline": "(r = sshbuf_put_string(b, pkblob, blen)) != 0)"
    },
    {
        "line": 95,
        "fullcodeline": "fatal(\"%s: build packet failed: %s\","
    },
    {
        "line": 103,
        "fullcodeline": "PRIVSEP(sshkey_verify(key, sig, slen,"
    },
    {
        "line": 107,
        "fullcodeline": "authenticated = 1;"
    },
    {
        "line": 114,
        "fullcodeline": "ca_s == NULL ? \"\" : \" CA \","
    },
    {
        "line": 115,
        "fullcodeline": "ca_s == NULL ? \"\" : ca_s);"
    },
    {
        "line": 117,
        "fullcodeline": "if ((r = sshpkt_get_end(ssh)) != 0)"
    },
    {
        "line": 120,
        "fullcodeline": "if (!authctxt->valid || authctxt->user == NULL) {"
    },
    {
        "line": 133,
        "fullcodeline": "if (PRIVSEP(user_key_allowed(ssh, pw, key, 0, NULL))) {"
    },
    {
        "line": 69,
        "fullcodeline": "if ((r = sshbuf_put(b, session_id2,"
    },
    {
        "line": 93,
        "fullcodeline": "(r = sshbuf_put_cstring(b, pkalg) != 0) ||"
    },
    {
        "line": 96,
        "fullcodeline": "__func__, ssh_err(r));"
    },
    {
        "line": 118,
        "fullcodeline": "fatal(\"%s: %s\", __func__, ssh_err(r));"
    },
    {
        "line": 121,
        "fullcodeline": "debug2(\"%s: disabled because of invalid user\","
    },
    {
        "line": 141,
        "fullcodeline": "authctxt->postponed = 1;"
    },
    {
        "line": 71,
        "fullcodeline": "fatal(\"%s: sshbuf_put session id: %s\","
    },
    {
        "line": 74,
        "fullcodeline": "if ((r = sshbuf_put_string(b, session_id2,"
    },
    {
        "line": 92,
        "fullcodeline": "(r = sshbuf_put_u8(b, have_sig)) != 0 ||"
    },
    {
        "line": 134,
        "fullcodeline": "if ((r = sshpkt_start(ssh, SSH2_MSG_USERAUTH_PK_OK))"
    },
    {
        "line": 72,
        "fullcodeline": "__func__, ssh_err(r));"
    },
    {
        "line": 76,
        "fullcodeline": "fatal(\"%s: sshbuf_put_string session id: %s\","
    },
    {
        "line": 91,
        "fullcodeline": "(r = sshbuf_put_cstring(b, \"publickey\")) != 0 ||"
    },
    {
        "line": 104,
        "fullcodeline": "sshbuf_ptr(b), sshbuf_len(b),"
    },
    {
        "line": 105,
        "fullcodeline": "(ssh->compat & SSH_BUG_SIGTYPE) == 0 ? pkalg : NULL,"
    },
    {
        "line": 139,
        "fullcodeline": "(r = ssh_packet_write_wait(ssh)) != 0)"
    },
    {
        "line": 140,
        "fullcodeline": "fatal(\"%s: %s\", __func__, ssh_err(r));"
    },
    {
        "line": 77,
        "fullcodeline": "__func__, ssh_err(r));"
    },
    {
        "line": 90,
        "fullcodeline": "(r = sshbuf_put_cstring(b, authctxt->service)) != 0 ||"
    },
    {
        "line": 138,
        "fullcodeline": "(r = sshpkt_send(ssh)) != 0 ||"
    },
    {
        "line": 89,
        "fullcodeline": "(r = sshbuf_put_cstring(b, userstyle)) != 0 ||"
    },
    {
        "line": 137,
        "fullcodeline": "(r = sshpkt_put_string(ssh, pkblob, blen)) != 0 ||"
    },
    {
        "line": 136,
        "fullcodeline": "(r = sshpkt_put_cstring(ssh, pkalg)) != 0 ||"
    }
]