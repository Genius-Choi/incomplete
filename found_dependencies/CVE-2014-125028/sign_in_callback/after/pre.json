[
    {
        "line": 2,
        "fullcodeline": "code = request.args.get('code')"
    },
    {
        "line": 3,
        "fullcodeline": "state = request.args.get('state')"
    },
    {
        "line": 10,
        "fullcodeline": "tokens = exchange_code_for_tokens(code)"
    },
    {
        "line": 19,
        "fullcodeline": "user_info = jwt.decode(tokens[\"id_token\"], verify=False)"
    },
    {
        "line": 21,
        "fullcodeline": "session['signed_in'] = True"
    },
    {
        "line": 22,
        "fullcodeline": "session['email'] = user_info['email']"
    },
    {
        "line": 24,
        "fullcodeline": "resp = make_response(redirect('/'))"
    },
    {
        "line": 25,
        "fullcodeline": "resp.set_cookie('python-flask-csrf', '', expires=0)"
    },
    {
        "line": 5,
        "fullcodeline": "if state != request.cookies.get('python-flask-csrf'):"
    },
    {
        "line": 6,
        "fullcodeline": "raise Exception(\"Possible CSRF detected (state does not match stored state)\")"
    }
]