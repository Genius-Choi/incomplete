[
    {
        "line": 3,
        "fullcodeline": "idprime_private_data_t * priv = card->drv_data;"
    },
    {
        "line": 4,
        "fullcodeline": "sc_path_t tinfo_path = {\"\\x00\\x00\", 2, 0, 0, SC_PATH_TYPE_PATH, {\"\", 0}};"
    },
    {
        "line": 5,
        "fullcodeline": "sc_file_t *file = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "u8 buf[2];"
    },
    {
        "line": 10,
        "fullcodeline": "LOG_FUNC_CALLED(card->ctx);"
    },
    {
        "line": 20,
        "fullcodeline": "memcpy(tinfo_path.value, priv->tinfo_df, 2);"
    },
    {
        "line": 21,
        "fullcodeline": "r = iso_ops->select_file(card, &tinfo_path, &file);"
    },
    {
        "line": 28,
        "fullcodeline": "r = iso_ops->read_binary(card, 0, buf, 2, 0);"
    },
    {
        "line": 33,
        "fullcodeline": "sc_file_free(file);"
    },
    {
        "line": 35,
        "fullcodeline": "name = malloc(buf[1]);"
    },
    {
        "line": 40,
        "fullcodeline": "r = iso_ops->read_binary(card, 2, (unsigned char *)name, buf[1], 0);"
    },
    {
        "line": 49,
        "fullcodeline": "*tname = name;"
    },
    {
        "line": 51,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_SUCCESS);"
    },
    {
        "line": 12,
        "fullcodeline": "if (tname == NULL) {"
    },
    {
        "line": 16,
        "fullcodeline": "if (!priv->tinfo_present) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (r != SC_SUCCESS || file->size == 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (r < 2 || buf[1] > file->size) { /* make sure we do not overrun */"
    },
    {
        "line": 36,
        "fullcodeline": "if (name == NULL) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (r < 1) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (name[r-1] != '\\0') {"
    },
    {
        "line": 13,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_INVALID_ARGUMENTS);"
    },
    {
        "line": 17,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_NOT_SUPPORTED);"
    },
    {
        "line": 23,
        "fullcodeline": "sc_file_free(file);"
    },
    {
        "line": 24,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_NOT_SUPPORTED);"
    },
    {
        "line": 30,
        "fullcodeline": "sc_file_free(file);"
    },
    {
        "line": 31,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, r);"
    },
    {
        "line": 37,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_OUT_OF_MEMORY);"
    },
    {
        "line": 42,
        "fullcodeline": "free(name);"
    },
    {
        "line": 43,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, r);"
    },
    {
        "line": 47,
        "fullcodeline": "name[r-1] = '\\0';"
    }
]