[
    {
        "line": 4,
        "fullcodeline": "krb5_error_code retval = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "char *r = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "krb5_data *data = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "krb5_int32 count = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "krb5_int32 size = 2;  /* initial guess at needed space */"
    },
    {
        "line": 9,
        "fullcodeline": "char *component = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "data = malloc(size * sizeof(krb5_data));"
    },
    {
        "line": 54,
        "fullcodeline": "free(r);"
    },
    {
        "line": 12,
        "fullcodeline": "if (!data) { retval = ENOMEM; }"
    },
    {
        "line": 14,
        "fullcodeline": "if (!retval)"
    },
    {
        "line": 38,
        "fullcodeline": "if (!retval) {"
    },
    {
        "line": 15,
        "fullcodeline": "r = k5memdup0(realm, rlen, &retval);"
    },
    {
        "line": 39,
        "fullcodeline": "princ->type = KRB5_NT_UNKNOWN;"
    },
    {
        "line": 40,
        "fullcodeline": "princ->magic = KV5M_PRINCIPAL;"
    },
    {
        "line": 41,
        "fullcodeline": "princ->realm = make_data(r, rlen);"
    },
    {
        "line": 42,
        "fullcodeline": "princ->data = data;"
    },
    {
        "line": 43,
        "fullcodeline": "princ->length = count;"
    },
    {
        "line": 44,
        "fullcodeline": "r = NULL;    /* take ownership */"
    },
    {
        "line": 45,
        "fullcodeline": "data = NULL; /* take ownership */"
    },
    {
        "line": 52,
        "fullcodeline": "free(data);"
    },
    {
        "line": 18,
        "fullcodeline": "if (count == size) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (!retval) {"
    },
    {
        "line": 49,
        "fullcodeline": "while (--count >= 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "krb5_data *new_data = NULL;"
    },
    {
        "line": 21,
        "fullcodeline": "size *= 2;"
    },
    {
        "line": 22,
        "fullcodeline": "new_data = realloc(data, size * sizeof(krb5_data));"
    },
    {
        "line": 31,
        "fullcodeline": "data[count].length = strlen(component);"
    },
    {
        "line": 32,
        "fullcodeline": "data[count].data = strdup(component);"
    },
    {
        "line": 34,
        "fullcodeline": "count++;"
    },
    {
        "line": 33,
        "fullcodeline": "if (!data[count].data) { retval = ENOMEM; }"
    },
    {
        "line": 24,
        "fullcodeline": "data = new_data;"
    },
    {
        "line": 26,
        "fullcodeline": "retval = ENOMEM;"
    }
]