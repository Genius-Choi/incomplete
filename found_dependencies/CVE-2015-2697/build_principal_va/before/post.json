[
    {
        "line": 4,
        "fullcodeline": "krb5_error_code retval = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "char *r = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "krb5_data *data = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "krb5_int32 count = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "krb5_int32 size = 2;  /* initial guess at needed space */"
    },
    {
        "line": 9,
        "fullcodeline": "char *component = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "data = malloc(size * sizeof(krb5_data));"
    },
    {
        "line": 56,
        "fullcodeline": "free(r);"
    },
    {
        "line": 12,
        "fullcodeline": "if (!data) { retval = ENOMEM; }"
    },
    {
        "line": 14,
        "fullcodeline": "if (!retval) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (!retval) {"
    },
    {
        "line": 15,
        "fullcodeline": "r = strdup(realm);"
    },
    {
        "line": 41,
        "fullcodeline": "princ->type = KRB5_NT_UNKNOWN;"
    },
    {
        "line": 42,
        "fullcodeline": "princ->magic = KV5M_PRINCIPAL;"
    },
    {
        "line": 43,
        "fullcodeline": "princ->realm = make_data(r, rlen);"
    },
    {
        "line": 44,
        "fullcodeline": "princ->data = data;"
    },
    {
        "line": 45,
        "fullcodeline": "princ->length = count;"
    },
    {
        "line": 46,
        "fullcodeline": "r = NULL;    /* take ownership */"
    },
    {
        "line": 47,
        "fullcodeline": "data = NULL; /* take ownership */"
    },
    {
        "line": 54,
        "fullcodeline": "free(data);"
    },
    {
        "line": 16,
        "fullcodeline": "if (!r) { retval = ENOMEM; }"
    },
    {
        "line": 20,
        "fullcodeline": "if (count == size) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (!retval) {"
    },
    {
        "line": 51,
        "fullcodeline": "while (--count >= 0) {"
    },
    {
        "line": 21,
        "fullcodeline": "krb5_data *new_data = NULL;"
    },
    {
        "line": 23,
        "fullcodeline": "size *= 2;"
    },
    {
        "line": 24,
        "fullcodeline": "new_data = realloc(data, size * sizeof(krb5_data));"
    },
    {
        "line": 33,
        "fullcodeline": "data[count].length = strlen(component);"
    },
    {
        "line": 34,
        "fullcodeline": "data[count].data = strdup(component);"
    },
    {
        "line": 36,
        "fullcodeline": "count++;"
    },
    {
        "line": 35,
        "fullcodeline": "if (!data[count].data) { retval = ENOMEM; }"
    },
    {
        "line": 26,
        "fullcodeline": "data = new_data;"
    },
    {
        "line": 28,
        "fullcodeline": "retval = ENOMEM;"
    }
]