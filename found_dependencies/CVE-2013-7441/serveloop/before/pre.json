[
    {
        "line": 3,
        "fullcodeline": "socklen_t addrinlen=sizeof(addrin);"
    },
    {
        "line": 16,
        "fullcodeline": "max=0;"
    },
    {
        "line": 17,
        "fullcodeline": "FD_ZERO(&mset);"
    },
    {
        "line": 18,
        "fullcodeline": "for(i=0;i<servers->len;i++) {"
    },
    {
        "line": 25,
        "fullcodeline": "for(i=0;i<modernsocks->len;i++) {"
    },
    {
        "line": 27,
        "fullcodeline": "FD_SET(sock, &mset);"
    },
    {
        "line": 28,
        "fullcodeline": "max=sock>max?sock:max;"
    },
    {
        "line": 64,
        "fullcodeline": "memcpy(&rset, &mset, sizeof(fd_set));"
    },
    {
        "line": 20,
        "fullcodeline": "if((sock=(g_array_index(servers, SERVER, i)).socket) >= 0) {"
    },
    {
        "line": 21,
        "fullcodeline": "FD_SET(sock, &mset);"
    },
    {
        "line": 22,
        "fullcodeline": "max=sock>max?sock:max;"
    },
    {
        "line": 39,
        "fullcodeline": "GError *gerror = NULL;"
    },
    {
        "line": 41,
        "fullcodeline": "msg(LOG_INFO, \"reconfiguration request received\");"
    },
    {
        "line": 42,
        "fullcodeline": "is_sighup_caught = 0; /* Reset to allow catching"
    },
    {
        "line": 45,
        "fullcodeline": "n = append_new_servers(servers, &gerror);"
    },
    {
        "line": 65,
        "fullcodeline": "if(select(max+1, &rset, NULL, NULL, NULL)>0) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (n == -1)"
    },
    {
        "line": 50,
        "fullcodeline": "for (i = servers->len - n; i < servers->len; ++i) {"
    },
    {
        "line": 69,
        "fullcodeline": "for(i=0; i < modernsocks->len; i++) {"
    },
    {
        "line": 87,
        "fullcodeline": "for(i=0; i < servers->len; i++) {"
    },
    {
        "line": 47,
        "fullcodeline": "msg(LOG_ERR, \"failed to append new servers: %s\","
    },
    {
        "line": 51,
        "fullcodeline": "const SERVER server = g_array_index(servers,"
    },
    {
        "line": 59,
        "fullcodeline": "msg(LOG_INFO, \"reconfigured new server: %s\","
    },
    {
        "line": 80,
        "fullcodeline": "client = negotiate(net, NULL, servers, NEG_INIT | NEG_MODERN);"
    },
    {
        "line": 85,
        "fullcodeline": "handle_connection(servers, net, client->server, client);"
    },
    {
        "line": 90,
        "fullcodeline": "serve=&(g_array_index(servers, SERVER, i));"
    },
    {
        "line": 54,
        "fullcodeline": "if (server.socket >= 0) {"
    },
    {
        "line": 81,
        "fullcodeline": "if(!client) {"
    },
    {
        "line": 91,
        "fullcodeline": "if(serve->socket < 0) {"
    },
    {
        "line": 94,
        "fullcodeline": "if(FD_ISSET(serve->socket, &rset)) {"
    },
    {
        "line": 55,
        "fullcodeline": "FD_SET(server.socket, &mset);"
    },
    {
        "line": 56,
        "fullcodeline": "max = server.socket > max ? server.socket : max;"
    },
    {
        "line": 71,
        "fullcodeline": "if(!FD_ISSET(sock, &rset)) {"
    },
    {
        "line": 76,
        "fullcodeline": "if((net=accept(sock, (struct sockaddr *) &addrin, &addrinlen)) < 0) {"
    },
    {
        "line": 99,
        "fullcodeline": "handle_connection(servers, net, serve, NULL);"
    },
    {
        "line": 95,
        "fullcodeline": "if ((net=accept(serve->socket, (struct sockaddr *) &addrin, &addrinlen)) < 0) {"
    }
]