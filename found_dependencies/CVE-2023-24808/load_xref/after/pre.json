[
    {
        "line": 7,
        "fullcodeline": "bool\t\tdone = false;\t\t// Are we done?"
    },
    {
        "line": 8,
        "fullcodeline": "char\t\tline[1024],\t\t// Line from file"
    },
    {
        "line": 405,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: Root=%p(%lu)\\n\", pdf->root_obj, (unsigned long)pdf->root_obj->number);"
    },
    {
        "line": 19,
        "fullcodeline": "while (!done)"
    },
    {
        "line": 407,
        "fullcodeline": "return (load_pages(pdf, pdfioDictGetObj(pdfioObjGetDict(pdf->root_obj), \"Pages\"), 0));"
    },
    {
        "line": 39,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: line_offset=%lu, line='%s'\\n\", (unsigned long)line_offset, line);"
    },
    {
        "line": 388,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: Contents of trailer dictionary:\\n\");"
    },
    {
        "line": 389,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: \");"
    },
    {
        "line": 390,
        "fullcodeline": "PDFIO_DEBUG_VALUE(&trailer);"
    },
    {
        "line": 391,
        "fullcodeline": "PDFIO_DEBUG(\"\\n\");"
    },
    {
        "line": 399,
        "fullcodeline": "if ((pdf->root_obj = pdfioDictGetObj(pdf->trailer_dict, \"Root\")) == NULL)"
    },
    {
        "line": 21,
        "fullcodeline": "if (_pdfioFileSeek(pdf, xref_offset, SEEK_SET) != xref_offset)"
    },
    {
        "line": 37,
        "fullcodeline": "while (!line[0]);"
    },
    {
        "line": 41,
        "fullcodeline": "if (isdigit(line[0] & 255) && strlen(line) > 4 && (!strcmp(line + strlen(line) - 4, \" obj\") || ((ptr = strstr(line, \" obj\")) != NULL && ptr[4] == '<')))"
    },
    {
        "line": 393,
        "fullcodeline": "if ((xref_offset = (off_t)pdfioDictGetNumber(trailer.value.dict, \"Prev\")) <= 0)"
    },
    {
        "line": 23,
        "fullcodeline": "_pdfioFileError(pdf, \"Unable to seek to start of xref table.\");"
    },
    {
        "line": 29,
        "fullcodeline": "line_offset = _pdfioFileTell(pdf);"
    },
    {
        "line": 51,
        "fullcodeline": "size_t\t\tw[3];\t\t// Size of each cross-reference field"
    },
    {
        "line": 56,
        "fullcodeline": "unsigned char\tbuffer[32];\t// Read buffer"
    },
    {
        "line": 58,
        "fullcodeline": "sobjs[4096];\t// Object streams to load"
    },
    {
        "line": 57,
        "fullcodeline": "size_t\t\tnum_sobjs = 0,\t// Number of object streams"
    },
    {
        "line": 88,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: Loading object %lu %u.\\n\", (unsigned long)number, (unsigned)generation);"
    },
    {
        "line": 96,
        "fullcodeline": "_pdfioTokenInit(&tb, pdf, (_pdfio_tconsume_cb_t)_pdfioFileConsume, (_pdfio_tpeek_cb_t)_pdfioFilePeek, pdf);"
    },
    {
        "line": 109,
        "fullcodeline": "obj->value = trailer;"
    },
    {
        "line": 117,
        "fullcodeline": "_pdfioTokenFlush(&tb);"
    },
    {
        "line": 119,
        "fullcodeline": "obj->stream_offset = _pdfioFileTell(pdf);"
    },
    {
        "line": 132,
        "fullcodeline": "w[0]    = (size_t)pdfioArrayGetNumber(w_array, 0);"
    },
    {
        "line": 133,
        "fullcodeline": "w[1]    = (size_t)pdfioArrayGetNumber(w_array, 1);"
    },
    {
        "line": 134,
        "fullcodeline": "w[2]    = (size_t)pdfioArrayGetNumber(w_array, 2);"
    },
    {
        "line": 135,
        "fullcodeline": "w_total = w[0] + w[1] + w[2];"
    },
    {
        "line": 136,
        "fullcodeline": "w_2     = w[0];"
    },
    {
        "line": 137,
        "fullcodeline": "w_3     = w[0] + w[1];"
    },
    {
        "line": 240,
        "fullcodeline": "pdfioStreamClose(st);"
    },
    {
        "line": 257,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: %lu compressed object streams to load.\\n\", (unsigned long)num_sobjs);"
    },
    {
        "line": 394,
        "fullcodeline": "done = true;"
    },
    {
        "line": 31,
        "fullcodeline": "if (!_pdfioFileGets(pdf, line, sizeof(line)))"
    },
    {
        "line": 61,
        "fullcodeline": "if ((number = strtoimax(line, &ptr, 10)) < 1)"
    },
    {
        "line": 67,
        "fullcodeline": "if ((generation = (int)strtol(ptr, &ptr, 10)) < 0 || generation > 65535)"
    },
    {
        "line": 73,
        "fullcodeline": "while (isspace(*ptr & 255))"
    },
    {
        "line": 74,
        "fullcodeline": "ptr ++;"
    },
    {
        "line": 76,
        "fullcodeline": "if (strncmp(ptr, \"obj\", 3))"
    },
    {
        "line": 82,
        "fullcodeline": "if (_pdfioFileSeek(pdf, line_offset + ptr + 3 - line, SEEK_SET) < 0)"
    },
    {
        "line": 90,
        "fullcodeline": "if ((obj = add_obj(pdf, (size_t)number, (unsigned short)generation, xref_offset)) == NULL)"
    },
    {
        "line": 98,
        "fullcodeline": "if (!_pdfioValueRead(pdf, obj, &tb, &trailer, 0))"
    },
    {
        "line": 111,
        "fullcodeline": "if (!_pdfioTokenGet(&tb, line, sizeof(line)) || strcmp(line, \"stream\"))"
    },
    {
        "line": 121,
        "fullcodeline": "if ((index_array = pdfioDictGetArray(trailer.value.dict, \"Index\")) != NULL)"
    },
    {
        "line": 126,
        "fullcodeline": "if ((w_array = pdfioDictGetArray(trailer.value.dict, \"W\")) == NULL)"
    },
    {
        "line": 139,
        "fullcodeline": "if (w[1] == 0 || w[2] > 2 || w[0] > sizeof(buffer) || w[1] > sizeof(buffer) || w[2] > sizeof(buffer) || w_total > sizeof(buffer))"
    },
    {
        "line": 145,
        "fullcodeline": "if ((st = pdfioObjOpenStream(obj, true)) == NULL)"
    },
    {
        "line": 151,
        "fullcodeline": "for (index_n = 0; index_n < index_count; index_n += 2)"
    },
    {
        "line": 242,
        "fullcodeline": "if (!pdf->trailer_dict)"
    },
    {
        "line": 259,
        "fullcodeline": "for (i = 0; i < num_sobjs; i ++)"
    },
    {
        "line": 122,
        "fullcodeline": "index_count = index_array->num_values;"
    },
    {
        "line": 246,
        "fullcodeline": "pdf->trailer_dict = trailer.value.dict;"
    },
    {
        "line": 247,
        "fullcodeline": "pdf->info_obj     = pdfioDictGetObj(pdf->trailer_dict, \"Info\");"
    },
    {
        "line": 248,
        "fullcodeline": "pdf->encrypt_obj  = pdfioDictGetObj(pdf->trailer_dict, \"Encrypt\");"
    },
    {
        "line": 249,
        "fullcodeline": "pdf->id_array     = pdfioDictGetArray(pdf->trailer_dict, \"ID\");"
    },
    {
        "line": 275,
        "fullcodeline": "else if (!strcmp(line, \"xref\"))"
    },
    {
        "line": 124,
        "fullcodeline": "index_count = 1;"
    },
    {
        "line": 153,
        "fullcodeline": "if (index_count == 1)"
    },
    {
        "line": 164,
        "fullcodeline": "while (count > 0 && pdfioStreamRead(st, buffer, w_total) > 0)"
    },
    {
        "line": 252,
        "fullcodeline": "if (pdf->encrypt_obj && !_pdfioCryptoUnlock(pdf, password_cb, password_data))"
    },
    {
        "line": 261,
        "fullcodeline": "if ((obj = pdfioFileFindObj(pdf, sobjs[i])) != NULL)"
    },
    {
        "line": 351,
        "fullcodeline": "_pdfioTokenInit(&tb, pdf, (_pdfio_tconsume_cb_t)_pdfioFileConsume, (_pdfio_tpeek_cb_t)_pdfioFilePeek, pdf);"
    },
    {
        "line": 364,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: Got trailer dict.\\n\");"
    },
    {
        "line": 366,
        "fullcodeline": "_pdfioTokenFlush(&tb);"
    },
    {
        "line": 103,
        "fullcodeline": "else if (trailer.type != PDFIO_VALTYPE_DICT)"
    },
    {
        "line": 155,
        "fullcodeline": "number = 0;"
    },
    {
        "line": 156,
        "fullcodeline": "count  = 999999999;"
    },
    {
        "line": 166,
        "fullcodeline": "count --;"
    },
    {
        "line": 168,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: number=%u %02X%02X%02X%02X%02X\\n\", (unsigned)number, buffer[0], buffer[1], buffer[2], buffer[3], buffer[4]);"
    },
    {
        "line": 236,
        "fullcodeline": "number ++;"
    },
    {
        "line": 263,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: Loading compressed object stream %lu (pdf=%p, obj->pdf=%p).\\n\", (unsigned long)sobjs[i], pdf, obj->pdf);"
    },
    {
        "line": 278,
        "fullcodeline": "while (_pdfioFileGets(pdf, line, sizeof(line)))"
    },
    {
        "line": 345,
        "fullcodeline": "if (strcmp(line, \"trailer\"))"
    },
    {
        "line": 353,
        "fullcodeline": "if (!_pdfioValueRead(pdf, NULL, &tb, &trailer, 0))"
    },
    {
        "line": 368,
        "fullcodeline": "if (!pdf->trailer_dict)"
    },
    {
        "line": 160,
        "fullcodeline": "number = (intmax_t)pdfioArrayGetNumber(index_array, index_n);"
    },
    {
        "line": 161,
        "fullcodeline": "count  = (size_t)pdfioArrayGetNumber(index_array, index_n + 1);"
    },
    {
        "line": 171,
        "fullcodeline": "if (w[0] > 0)"
    },
    {
        "line": 181,
        "fullcodeline": "for (i = 1, offset = buffer[w_2]; i < w[1]; i ++)"
    },
    {
        "line": 182,
        "fullcodeline": "offset = (offset << 8) | buffer[w_2 + i];"
    },
    {
        "line": 198,
        "fullcodeline": "if ((current = pdfioFileFindObj(pdf, (size_t)number)) != NULL)"
    },
    {
        "line": 216,
        "fullcodeline": "if (w[0] > 0 && buffer[0] == 2)"
    },
    {
        "line": 265,
        "fullcodeline": "if (!load_obj_stream(obj))"
    },
    {
        "line": 372,
        "fullcodeline": "pdf->trailer_dict = trailer.value.dict;"
    },
    {
        "line": 373,
        "fullcodeline": "pdf->info_obj     = pdfioDictGetObj(pdf->trailer_dict, \"Info\");"
    },
    {
        "line": 374,
        "fullcodeline": "pdf->encrypt_obj  = pdfioDictGetObj(pdf->trailer_dict, \"Encrypt\");"
    },
    {
        "line": 375,
        "fullcodeline": "pdf->id_array     = pdfioDictGetArray(pdf->trailer_dict, \"ID\");"
    },
    {
        "line": 187,
        "fullcodeline": "generation = 0;"
    },
    {
        "line": 190,
        "fullcodeline": "generation = buffer[w_3];"
    },
    {
        "line": 193,
        "fullcodeline": "generation = (buffer[w_3] << 8) | buffer[w_3 + 1];"
    },
    {
        "line": 200,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: existing object, prev offset=%u\\n\", (unsigned)current->offset);"
    },
    {
        "line": 213,
        "fullcodeline": "PDFIO_DEBUG(\"load_xref: new offset=%u\\n\", (unsigned)current->offset);"
    },
    {
        "line": 280,
        "fullcodeline": "if (!strcmp(line, \"trailer\"))"
    },
    {
        "line": 285,
        "fullcodeline": "if (sscanf(line, \"%jd%jd\", &number, &num_objects) != 2)"
    },
    {
        "line": 292,
        "fullcodeline": "for (; num_objects > 0; num_objects --, number ++)"
    },
    {
        "line": 378,
        "fullcodeline": "if (pdf->encrypt_obj && !_pdfioCryptoUnlock(pdf, password_cb, password_data))"
    },
    {
        "line": 173,
        "fullcodeline": "if (buffer[0] == 0)"
    },
    {
        "line": 202,
        "fullcodeline": "if (w[0] == 0 || buffer[0] == 1)"
    },
    {
        "line": 220,
        "fullcodeline": "for (i = 0; i < num_sobjs; i ++)"
    },
    {
        "line": 226,
        "fullcodeline": "if (i >= num_sobjs && num_sobjs < (sizeof(sobjs) / sizeof(sobjs[0])))"
    },
    {
        "line": 298,
        "fullcodeline": "line[20] = '\\0';"
    },
    {
        "line": 305,
        "fullcodeline": "line[18] = '\\0';"
    },
    {
        "line": 326,
        "fullcodeline": "ptr ++;"
    },
    {
        "line": 358,
        "fullcodeline": "else if (trailer.type != PDFIO_VALTYPE_DICT)"
    },
    {
        "line": 176,
        "fullcodeline": "number ++;"
    },
    {
        "line": 205,
        "fullcodeline": "current->offset = offset;"
    },
    {
        "line": 227,
        "fullcodeline": "sobjs[num_sobjs ++] = (size_t)offset;"
    },
    {
        "line": 229,
        "fullcodeline": "else if (!current)"
    },
    {
        "line": 295,
        "fullcodeline": "if (_pdfioFileRead(pdf, line, 20) != 20)"
    },
    {
        "line": 300,
        "fullcodeline": "if (strcmp(line + 18, \"\\r\\n\") && strcmp(line + 18, \" \\n\") && strcmp(line + 18, \" \\r\"))"
    },
    {
        "line": 308,
        "fullcodeline": "if ((offset = strtoimax(line, &ptr, 10)) < 0)"
    },
    {
        "line": 314,
        "fullcodeline": "if ((generation = (int)strtol(ptr, &ptr, 10)) < 0 || generation > 65535)"
    },
    {
        "line": 320,
        "fullcodeline": "if (*ptr != ' ')"
    },
    {
        "line": 327,
        "fullcodeline": "if (*ptr != 'f' && *ptr != 'n')"
    },
    {
        "line": 333,
        "fullcodeline": "if (*ptr == 'f')"
    },
    {
        "line": 337,
        "fullcodeline": "if (pdfioFileFindObj(pdf, (size_t)number))"
    },
    {
        "line": 340,
        "fullcodeline": "if (!add_obj(pdf, (size_t)number, (unsigned short)generation, offset))"
    },
    {
        "line": 222,
        "fullcodeline": "if (sobjs[i] == (size_t)offset)"
    },
    {
        "line": 282,
        "fullcodeline": "else if (!line[0])"
    },
    {
        "line": 207,
        "fullcodeline": "else if (number != offset)"
    },
    {
        "line": 232,
        "fullcodeline": "if (!add_obj(pdf, (size_t)number, (unsigned short)generation, offset))"
    },
    {
        "line": 210,
        "fullcodeline": "current->offset = 0;"
    }
]