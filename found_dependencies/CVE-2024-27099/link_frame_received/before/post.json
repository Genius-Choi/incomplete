[
    {
        "line": 3,
        "fullcodeline": "LINK_INSTANCE* link_instance = (LINK_INSTANCE*)context;"
    },
    {
        "line": 4,
        "fullcodeline": "AMQP_VALUE descriptor = amqpvalue_get_inplace_descriptor(performative);"
    },
    {
        "line": 6,
        "fullcodeline": "if (is_attach_type_by_descriptor(descriptor))"
    },
    {
        "line": 10,
        "fullcodeline": "if (amqpvalue_get_attach(performative, &attach_handle) != 0)"
    },
    {
        "line": 12,
        "fullcodeline": "LogError(\"Cannot get attach performative\");"
    },
    {
        "line": 57,
        "fullcodeline": "else if (is_flow_type_by_descriptor(descriptor))"
    },
    {
        "line": 54,
        "fullcodeline": "attach_destroy(attach_handle);"
    },
    {
        "line": 94,
        "fullcodeline": "flow_destroy(flow_handle);"
    },
    {
        "line": 16,
        "fullcodeline": "if ((link_instance->role == role_receiver) &&"
    },
    {
        "line": 60,
        "fullcodeline": "if (amqpvalue_get_flow(performative, &flow_handle) != 0)"
    },
    {
        "line": 17,
        "fullcodeline": "(attach_get_initial_delivery_count(attach_handle, &link_instance->delivery_count) != 0))"
    },
    {
        "line": 19,
        "fullcodeline": "LogError(\"Cannot get initial delivery count\");"
    },
    {
        "line": 20,
        "fullcodeline": "remove_all_pending_deliveries(link_instance, true);"
    },
    {
        "line": 21,
        "fullcodeline": "set_link_state(link_instance, LINK_STATE_DETACHED);"
    },
    {
        "line": 62,
        "fullcodeline": "LogError(\"Cannot get flow performative\");"
    },
    {
        "line": 96,
        "fullcodeline": "else if (is_transfer_type_by_descriptor(descriptor))"
    },
    {
        "line": 25,
        "fullcodeline": "if (attach_get_max_message_size(attach_handle, &link_instance->peer_max_message_size) != 0)"
    },
    {
        "line": 30,
        "fullcodeline": "if ((link_instance->link_state == LINK_STATE_DETACHED) ||"
    },
    {
        "line": 66,
        "fullcodeline": "if (link_instance->role == role_sender)"
    },
    {
        "line": 98,
        "fullcodeline": "if (link_instance->on_transfer_received != NULL)"
    },
    {
        "line": 27,
        "fullcodeline": "LogError(\"Could not retrieve peer_max_message_size from attach frame\");"
    },
    {
        "line": 31,
        "fullcodeline": "(link_instance->link_state == LINK_STATE_HALF_ATTACHED_ATTACH_SENT))"
    },
    {
        "line": 196,
        "fullcodeline": "else if (is_disposition_type_by_descriptor(descriptor))"
    },
    {
        "line": 33,
        "fullcodeline": "if (link_instance->role == role_receiver)"
    },
    {
        "line": 43,
        "fullcodeline": "if (link_instance->link_state == LINK_STATE_DETACHED)"
    },
    {
        "line": 71,
        "fullcodeline": "if (flow_get_link_credit(flow_handle, &rcv_link_credit) != 0)"
    },
    {
        "line": 101,
        "fullcodeline": "if (amqpvalue_get_transfer(performative, &transfer_handle) != 0)"
    },
    {
        "line": 35,
        "fullcodeline": "link_instance->current_link_credit = link_instance->max_link_credit;"
    },
    {
        "line": 36,
        "fullcodeline": "send_flow(link_instance);"
    },
    {
        "line": 45,
        "fullcodeline": "set_link_state(link_instance, LINK_STATE_HALF_ATTACHED_ATTACH_RECEIVED);"
    },
    {
        "line": 73,
        "fullcodeline": "LogError(\"Cannot get link credit\");"
    },
    {
        "line": 74,
        "fullcodeline": "remove_all_pending_deliveries(link_instance, true);"
    },
    {
        "line": 75,
        "fullcodeline": "set_link_state(link_instance, LINK_STATE_DETACHED);"
    },
    {
        "line": 103,
        "fullcodeline": "LogError(\"Cannot get transfer performative\");"
    },
    {
        "line": 199,
        "fullcodeline": "if (amqpvalue_get_disposition(performative, &disposition) != 0)"
    },
    {
        "line": 40,
        "fullcodeline": "link_instance->current_link_credit = 0;"
    },
    {
        "line": 49,
        "fullcodeline": "set_link_state(link_instance, LINK_STATE_ATTACHED);"
    },
    {
        "line": 117,
        "fullcodeline": "more = false;"
    },
    {
        "line": 119,
        "fullcodeline": "(void)transfer_get_more(transfer_handle, &more);"
    },
    {
        "line": 120,
        "fullcodeline": "is_error = false;"
    },
    {
        "line": 192,
        "fullcodeline": "transfer_destroy(transfer_handle);"
    },
    {
        "line": 201,
        "fullcodeline": "LogError(\"Cannot get disposition performative\");"
    },
    {
        "line": 272,
        "fullcodeline": "else if (is_detach_type_by_descriptor(descriptor))"
    },
    {
        "line": 77,
        "fullcodeline": "else if (flow_get_delivery_count(flow_handle, &rcv_delivery_count) != 0)"
    },
    {
        "line": 111,
        "fullcodeline": "if (link_instance->current_link_credit == 0)"
    },
    {
        "line": 122,
        "fullcodeline": "if (transfer_get_delivery_id(transfer_handle, &link_instance->received_delivery_id) != 0)"
    },
    {
        "line": 132,
        "fullcodeline": "if (!is_error)"
    },
    {
        "line": 269,
        "fullcodeline": "disposition_destroy(disposition);"
    },
    {
        "line": 79,
        "fullcodeline": "LogError(\"Cannot get delivery count\");"
    },
    {
        "line": 80,
        "fullcodeline": "remove_all_pending_deliveries(link_instance, true);"
    },
    {
        "line": 81,
        "fullcodeline": "set_link_state(link_instance, LINK_STATE_DETACHED);"
    },
    {
        "line": 113,
        "fullcodeline": "link_instance->current_link_credit = link_instance->max_link_credit;"
    },
    {
        "line": 114,
        "fullcodeline": "send_flow(link_instance);"
    },
    {
        "line": 208,
        "fullcodeline": "if (disposition_get_first(disposition, &first) != 0)"
    },
    {
        "line": 277,
        "fullcodeline": "if (amqpvalue_get_detach(performative, &detach) != 0)"
    },
    {
        "line": 85,
        "fullcodeline": "link_instance->current_link_credit = rcv_delivery_count + rcv_link_credit - link_instance->delivery_count;"
    },
    {
        "line": 125,
        "fullcodeline": "if (link_instance->received_payload_size == 0)"
    },
    {
        "line": 135,
        "fullcodeline": "if ((link_instance->received_payload_size > 0) || more)"
    },
    {
        "line": 152,
        "fullcodeline": "if (!more)"
    },
    {
        "line": 210,
        "fullcodeline": "LogError(\"Cannot get first field\");"
    },
    {
        "line": 279,
        "fullcodeline": "LogError(\"Cannot get detach performative\");"
    },
    {
        "line": 86,
        "fullcodeline": "if (link_instance->current_link_credit > 0)"
    },
    {
        "line": 127,
        "fullcodeline": "LogError(\"Could not get the delivery Id from the transfer performative\");"
    },
    {
        "line": 128,
        "fullcodeline": "is_error = true;"
    },
    {
        "line": 138,
        "fullcodeline": "size_t realloc_size = safe_add_size_t((size_t)link_instance->received_payload_size, payload_size);"
    },
    {
        "line": 157,
        "fullcodeline": "link_instance->current_link_credit--;"
    },
    {
        "line": 158,
        "fullcodeline": "link_instance->delivery_count++;"
    },
    {
        "line": 171,
        "fullcodeline": "delivery_state = link_instance->on_transfer_received(link_instance->callback_context, transfer_handle, indicate_payload_size, indicate_payload_bytes);"
    },
    {
        "line": 283,
        "fullcodeline": "bool closed = false;"
    },
    {
        "line": 286,
        "fullcodeline": "(void)detach_get_closed(detach, &closed);"
    },
    {
        "line": 319,
        "fullcodeline": "remove_all_pending_deliveries(link_instance, true);"
    },
    {
        "line": 336,
        "fullcodeline": "detach_destroy(detach);"
    },
    {
        "line": 88,
        "fullcodeline": "link_instance->on_link_flow_on(link_instance->callback_context);"
    },
    {
        "line": 139,
        "fullcodeline": "if (realloc_size == SIZE_MAX ||"
    },
    {
        "line": 160,
        "fullcodeline": "if (link_instance->received_payload_size > 0)"
    },
    {
        "line": 173,
        "fullcodeline": "if (link_instance->received_payload_size > 0)"
    },
    {
        "line": 180,
        "fullcodeline": "if (delivery_state != NULL)"
    },
    {
        "line": 216,
        "fullcodeline": "if (disposition_get_last(disposition, &last) != 0)"
    },
    {
        "line": 221,
        "fullcodeline": "if (disposition_get_settled(disposition, &settled) != 0)"
    },
    {
        "line": 226,
        "fullcodeline": "if (settled &&"
    },
    {
        "line": 289,
        "fullcodeline": "if (link_instance->link_state == LINK_STATE_ATTACHED)"
    },
    {
        "line": 315,
        "fullcodeline": "if (detach_get_error(detach, &error) != 0)"
    },
    {
        "line": 321,
        "fullcodeline": "if (link_instance->on_link_detach_received_event_subscription.on_link_detach_received != NULL)"
    },
    {
        "line": 326,
        "fullcodeline": "if (error != NULL)"
    },
    {
        "line": 140,
        "fullcodeline": "(new_received_payload = (unsigned char*)realloc(link_instance->received_payload, realloc_size)) == NULL)"
    },
    {
        "line": 142,
        "fullcodeline": "LogError(\"Could not allocate memory for the received payload, size:%zu\", realloc_size);"
    },
    {
        "line": 162,
        "fullcodeline": "indicate_payload_size = link_instance->received_payload_size;"
    },
    {
        "line": 163,
        "fullcodeline": "indicate_payload_bytes = link_instance->received_payload;"
    },
    {
        "line": 175,
        "fullcodeline": "free(link_instance->received_payload);"
    },
    {
        "line": 176,
        "fullcodeline": "link_instance->received_payload = NULL;"
    },
    {
        "line": 177,
        "fullcodeline": "link_instance->received_payload_size = 0;"
    },
    {
        "line": 187,
        "fullcodeline": "amqpvalue_destroy(delivery_state);"
    },
    {
        "line": 218,
        "fullcodeline": "last = first;"
    },
    {
        "line": 223,
        "fullcodeline": "settled = false;"
    },
    {
        "line": 227,
        "fullcodeline": "link_instance->pending_deliveries != NULL)"
    },
    {
        "line": 229,
        "fullcodeline": "LIST_ITEM_HANDLE pending_delivery = singlylinkedlist_get_head_item(link_instance->pending_deliveries);"
    },
    {
        "line": 317,
        "fullcodeline": "error = NULL;"
    },
    {
        "line": 323,
        "fullcodeline": "link_instance->on_link_detach_received_event_subscription.on_link_detach_received(link_instance->on_link_detach_received_event_subscription.context, error);"
    },
    {
        "line": 328,
        "fullcodeline": "set_link_state(link_instance, LINK_STATE_ERROR);"
    },
    {
        "line": 329,
        "fullcodeline": "error_destroy(error);"
    },
    {
        "line": 146,
        "fullcodeline": "link_instance->received_payload = new_received_payload;"
    },
    {
        "line": 147,
        "fullcodeline": "(void)memcpy(link_instance->received_payload + link_instance->received_payload_size, payload_bytes, payload_size);"
    },
    {
        "line": 148,
        "fullcodeline": "link_instance->received_payload_size += payload_size;"
    },
    {
        "line": 167,
        "fullcodeline": "indicate_payload_size = payload_size;"
    },
    {
        "line": 168,
        "fullcodeline": "indicate_payload_bytes = payload_bytes;"
    },
    {
        "line": 182,
        "fullcodeline": "if (send_disposition(link_instance, link_instance->received_delivery_id, delivery_state) != 0)"
    },
    {
        "line": 230,
        "fullcodeline": "while (pending_delivery != NULL)"
    },
    {
        "line": 292,
        "fullcodeline": "if (send_detach(link_instance, closed, NULL) != 0)"
    },
    {
        "line": 333,
        "fullcodeline": "set_link_state(link_instance, LINK_STATE_DETACHED);"
    },
    {
        "line": 184,
        "fullcodeline": "LogError(\"Cannot send disposition frame\");"
    },
    {
        "line": 232,
        "fullcodeline": "LIST_ITEM_HANDLE next_pending_delivery = singlylinkedlist_get_next_item(pending_delivery);"
    },
    {
        "line": 233,
        "fullcodeline": "ASYNC_OPERATION_HANDLE pending_delivery_operation = (ASYNC_OPERATION_HANDLE)singlylinkedlist_item_get_value(pending_delivery);"
    },
    {
        "line": 294,
        "fullcodeline": "LogError(\"Failed sending detach frame\");"
    },
    {
        "line": 298,
        "fullcodeline": "else if (closed &&"
    },
    {
        "line": 234,
        "fullcodeline": "if (pending_delivery_operation == NULL)"
    },
    {
        "line": 300,
        "fullcodeline": "!link_instance->is_closed)"
    },
    {
        "line": 236,
        "fullcodeline": "LogError(\"Cannot obtain pending delivery\");"
    },
    {
        "line": 299,
        "fullcodeline": "((link_instance->link_state == LINK_STATE_HALF_ATTACHED_ATTACH_SENT) || (link_instance->link_state == LINK_STATE_HALF_ATTACHED_ATTACH_RECEIVED)) &&"
    },
    {
        "line": 304,
        "fullcodeline": "if (send_attach(link_instance, link_instance->name, 0, link_instance->role) != 0)"
    },
    {
        "line": 309,
        "fullcodeline": "if (send_detach(link_instance, true, NULL) != 0)"
    },
    {
        "line": 241,
        "fullcodeline": "DELIVERY_INSTANCE* delivery_instance = (DELIVERY_INSTANCE*)GET_ASYNC_OPERATION_CONTEXT(DELIVERY_INSTANCE, pending_delivery_operation);"
    },
    {
        "line": 263,
        "fullcodeline": "pending_delivery = next_pending_delivery;"
    },
    {
        "line": 306,
        "fullcodeline": "LogError(\"Failed sending attach frame\");"
    },
    {
        "line": 311,
        "fullcodeline": "LogError(\"Failed sending detach frame\");"
    },
    {
        "line": 243,
        "fullcodeline": "if ((delivery_instance->delivery_id >= first) && (delivery_instance->delivery_id <= last))"
    },
    {
        "line": 246,
        "fullcodeline": "if (disposition_get_state(disposition, &delivery_state) == 0)"
    },
    {
        "line": 256,
        "fullcodeline": "if (singlylinkedlist_remove(link_instance->pending_deliveries, pending_delivery) != 0)"
    },
    {
        "line": 248,
        "fullcodeline": "delivery_instance->on_delivery_settled(delivery_instance->callback_context, delivery_instance->delivery_id, LINK_DELIVERY_SETTLE_REASON_DISPOSITION_RECEIVED, delivery_state);"
    },
    {
        "line": 249,
        "fullcodeline": "async_operation_destroy(pending_delivery_operation);"
    },
    {
        "line": 258,
        "fullcodeline": "LogError(\"Cannot remove pending delivery\");"
    },
    {
        "line": 253,
        "fullcodeline": "LogError(\"Failed getting the disposition state\");"
    }
]