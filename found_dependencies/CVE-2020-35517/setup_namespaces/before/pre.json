[
    {
        "line": 4,
        "fullcodeline": "char template[] = \"virtiofsd-XXXXXX\";"
    },
    {
        "line": 22,
        "fullcodeline": "child = fork();"
    },
    {
        "line": 51,
        "fullcodeline": "prctl(PR_SET_PDEATHSIG, SIGTERM);"
    },
    {
        "line": 69,
        "fullcodeline": "tmpdir = mkdtemp(template);"
    },
    {
        "line": 82,
        "fullcodeline": "lo->proc_self_fd = open(tmpdir, O_PATH);"
    },
    {
        "line": 17,
        "fullcodeline": "if (unshare(CLONE_NEWPID | CLONE_NEWNS | CLONE_NEWNET) != 0) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (child < 0) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (child > 0) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (mount(NULL, \"/\", NULL, MS_REC | MS_SLAVE, NULL) < 0) {"
    },
    {
        "line": 63,
        "fullcodeline": "if (mount(\"proc\", \"/proc\", \"proc\","
    },
    {
        "line": 70,
        "fullcodeline": "if (!tmpdir) {"
    },
    {
        "line": 75,
        "fullcodeline": "if (mount(\"/proc/self/fd\", tmpdir, NULL, MS_BIND, NULL) < 0) {"
    },
    {
        "line": 83,
        "fullcodeline": "if (lo->proc_self_fd == -1) {"
    },
    {
        "line": 88,
        "fullcodeline": "if (umount2(tmpdir, MNT_DETACH) < 0) {"
    },
    {
        "line": 93,
        "fullcodeline": "if (rmdir(tmpdir) < 0) {"
    },
    {
        "line": 18,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"unshare(CLONE_NEWPID | CLONE_NEWNS): %m\\n\");"
    },
    {
        "line": 24,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"fork() failed: %m\\n\");"
    },
    {
        "line": 31,
        "fullcodeline": "setup_wait_parent_capabilities();"
    },
    {
        "line": 58,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"mount(/, MS_REC|MS_SLAVE): %m\\n\");"
    },
    {
        "line": 65,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"mount(/proc): %m\\n\");"
    },
    {
        "line": 71,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"tmpdir(%s): %m\\n\", template);"
    },
    {
        "line": 76,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"mount(/proc/self/fd, %s, MS_BIND): %m\\n\","
    },
    {
        "line": 84,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"open(%s, O_PATH): %m\\n\", tmpdir);"
    },
    {
        "line": 89,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"umount2(%s, MNT_DETACH): %m\\n\", tmpdir);"
    },
    {
        "line": 94,
        "fullcodeline": "fuse_log(FUSE_LOG_ERR, \"rmdir(%s): %m\\n\", tmpdir);"
    },
    {
        "line": 36,
        "fullcodeline": "} while (waited < 0 && errno == EINTR && !se->exited);"
    },
    {
        "line": 43,
        "fullcodeline": "if (WIFEXITED(wstatus)) {"
    },
    {
        "line": 64,
        "fullcodeline": "MS_NODEV | MS_NOEXEC | MS_NOSUID | MS_RELATIME, NULL) < 0) {"
    },
    {
        "line": 35,
        "fullcodeline": "waited = waitpid(child, &wstatus, 0);"
    },
    {
        "line": 44,
        "fullcodeline": "exit(WEXITSTATUS(wstatus));"
    }
]