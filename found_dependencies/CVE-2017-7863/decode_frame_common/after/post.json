[
    {
        "line": 4,
        "fullcodeline": "AVDictionary *metadata  = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "int decode_next_dat = 0;"
    },
    {
        "line": 193,
        "fullcodeline": "ff_thread_report_progress(&s->picture, INT_MAX, 0);"
    },
    {
        "line": 194,
        "fullcodeline": "ff_thread_report_progress(&s->previous_picture, INT_MAX, 0);"
    },
    {
        "line": 196,
        "fullcodeline": "av_frame_set_metadata(p, metadata);"
    },
    {
        "line": 197,
        "fullcodeline": "metadata   = NULL;"
    },
    {
        "line": 201,
        "fullcodeline": "av_dict_free(&metadata);"
    },
    {
        "line": 202,
        "fullcodeline": "ff_thread_report_progress(&s->picture, INT_MAX, 0);"
    },
    {
        "line": 203,
        "fullcodeline": "ff_thread_report_progress(&s->previous_picture, INT_MAX, 0);"
    },
    {
        "line": 144,
        "fullcodeline": "if (avctx->codec_id == AV_CODEC_ID_PNG &&"
    },
    {
        "line": 150,
        "fullcodeline": "if (s->bits_per_pixel <= 4)"
    },
    {
        "line": 154,
        "fullcodeline": "if (s->has_trns && s->color_type != PNG_COLOR_TYPE_PALETTE) {"
    },
    {
        "line": 10,
        "fullcodeline": "length = bytestream2_get_bytes_left(&s->gb);"
    },
    {
        "line": 33,
        "fullcodeline": "length = bytestream2_get_be32(&s->gb);"
    },
    {
        "line": 39,
        "fullcodeline": "tag = bytestream2_get_le32(&s->gb);"
    },
    {
        "line": 145,
        "fullcodeline": "avctx->skip_frame == AVDISCARD_ALL) {"
    },
    {
        "line": 146,
        "fullcodeline": "av_frame_set_metadata(p, metadata);"
    },
    {
        "line": 151,
        "fullcodeline": "handle_small_bpp(s, p);"
    },
    {
        "line": 155,
        "fullcodeline": "size_t byte_depth = s->bit_depth > 8 ? 2 : 1;"
    },
    {
        "line": 156,
        "fullcodeline": "size_t raw_bpp = s->bpp - byte_depth;"
    },
    {
        "line": 159,
        "fullcodeline": "av_assert0(s->bit_depth > 1);"
    },
    {
        "line": 11,
        "fullcodeline": "if (length <= 0) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (length > 0x7fffffff || length > bytestream2_get_bytes_left(&s->gb)) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (avctx->debug & FF_DEBUG_STARTCODE)"
    },
    {
        "line": 47,
        "fullcodeline": "if (avctx->codec_id == AV_CODEC_ID_PNG &&"
    },
    {
        "line": 161,
        "fullcodeline": "for (y = 0; y < s->height; ++y) {"
    },
    {
        "line": 180,
        "fullcodeline": "if (   !(avpkt->flags & AV_PKT_FLAG_KEY) && avctx->codec_tag != AV_RL32(\"MPNG\")"
    },
    {
        "line": 25,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"%d bytes left\\n\", length);"
    },
    {
        "line": 29,
        "fullcodeline": "ret = AVERROR_INVALIDDATA;"
    },
    {
        "line": 35,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"chunk too big\\n\");"
    },
    {
        "line": 36,
        "fullcodeline": "ret = AVERROR_INVALIDDATA;"
    },
    {
        "line": 41,
        "fullcodeline": "av_log(avctx, AV_LOG_DEBUG, \"png: tag=%c%c%c%c length=%u\\n\","
    },
    {
        "line": 48,
        "fullcodeline": "avctx->skip_frame == AVDISCARD_ALL) {"
    },
    {
        "line": 62,
        "fullcodeline": "case MKTAG('I', 'H', 'D', 'R'):"
    },
    {
        "line": 66,
        "fullcodeline": "case MKTAG('p', 'H', 'Y', 's'):"
    },
    {
        "line": 70,
        "fullcodeline": "case MKTAG('f', 'c', 'T', 'L'):"
    },
    {
        "line": 75,
        "fullcodeline": "decode_next_dat = 1;"
    },
    {
        "line": 77,
        "fullcodeline": "case MKTAG('f', 'd', 'A', 'T'):"
    },
    {
        "line": 84,
        "fullcodeline": "bytestream2_get_be32(&s->gb);"
    },
    {
        "line": 85,
        "fullcodeline": "length -= 4;"
    },
    {
        "line": 87,
        "fullcodeline": "case MKTAG('I', 'D', 'A', 'T'):"
    },
    {
        "line": 93,
        "fullcodeline": "case MKTAG('P', 'L', 'T', 'E'):"
    },
    {
        "line": 97,
        "fullcodeline": "case MKTAG('t', 'R', 'N', 'S'):"
    },
    {
        "line": 101,
        "fullcodeline": "case MKTAG('t', 'E', 'X', 't'):"
    },
    {
        "line": 104,
        "fullcodeline": "bytestream2_skip(&s->gb, length + 4);"
    },
    {
        "line": 106,
        "fullcodeline": "case MKTAG('z', 'T', 'X', 't'):"
    },
    {
        "line": 109,
        "fullcodeline": "bytestream2_skip(&s->gb, length + 4);"
    },
    {
        "line": 111,
        "fullcodeline": "case MKTAG('s', 'T', 'E', 'R'): {"
    },
    {
        "line": 127,
        "fullcodeline": "case MKTAG('I', 'E', 'N', 'D'):"
    },
    {
        "line": 134,
        "fullcodeline": "bytestream2_skip(&s->gb, 4); /* crc */"
    },
    {
        "line": 139,
        "fullcodeline": "bytestream2_skip(&s->gb, length + 4);"
    },
    {
        "line": 183,
        "fullcodeline": "&& s->last_picture.f->format== p->format"
    },
    {
        "line": 13,
        "fullcodeline": "if (avctx->codec_id == AV_CODEC_ID_PNG &&"
    },
    {
        "line": 19,
        "fullcodeline": "if (CONFIG_APNG_DECODER && avctx->codec_id == AV_CODEC_ID_APNG && length == 0) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (   s->state & PNG_ALLIMAGE"
    },
    {
        "line": 42,
        "fullcodeline": "(tag & 0xff),"
    },
    {
        "line": 43,
        "fullcodeline": "((tag >> 8) & 0xff),"
    },
    {
        "line": 44,
        "fullcodeline": "((tag >> 16) & 0xff),"
    },
    {
        "line": 45,
        "fullcodeline": "((tag >> 24) & 0xff), length);"
    },
    {
        "line": 63,
        "fullcodeline": "if ((ret = decode_ihdr_chunk(avctx, s, length)) < 0)"
    },
    {
        "line": 67,
        "fullcodeline": "if ((ret = decode_phys_chunk(avctx, s)) < 0)"
    },
    {
        "line": 71,
        "fullcodeline": "if (!CONFIG_APNG_DECODER || avctx->codec_id != AV_CODEC_ID_APNG)"
    },
    {
        "line": 73,
        "fullcodeline": "if ((ret = decode_fctl_chunk(avctx, s, length)) < 0)"
    },
    {
        "line": 78,
        "fullcodeline": "if (!CONFIG_APNG_DECODER || avctx->codec_id != AV_CODEC_ID_APNG)"
    },
    {
        "line": 80,
        "fullcodeline": "if (!decode_next_dat) {"
    },
    {
        "line": 88,
        "fullcodeline": "if (CONFIG_APNG_DECODER && avctx->codec_id == AV_CODEC_ID_APNG && !decode_next_dat)"
    },
    {
        "line": 90,
        "fullcodeline": "if ((ret = decode_idat_chunk(avctx, s, length, p)) < 0)"
    },
    {
        "line": 94,
        "fullcodeline": "if (decode_plte_chunk(avctx, s, length) < 0)"
    },
    {
        "line": 98,
        "fullcodeline": "if (decode_trns_chunk(avctx, s, length) < 0)"
    },
    {
        "line": 102,
        "fullcodeline": "if (decode_text_chunk(s, length, 0, &metadata) < 0)"
    },
    {
        "line": 107,
        "fullcodeline": "if (decode_text_chunk(s, length, 1, &metadata) < 0)"
    },
    {
        "line": 112,
        "fullcodeline": "int mode = bytestream2_get_byte(&s->gb);"
    },
    {
        "line": 113,
        "fullcodeline": "AVStereo3D *stereo3d = av_stereo3d_create_side_data(p);"
    },
    {
        "line": 124,
        "fullcodeline": "bytestream2_skip(&s->gb, 4); /* crc */"
    },
    {
        "line": 128,
        "fullcodeline": "if (!(s->state & PNG_ALLIMAGE))"
    },
    {
        "line": 130,
        "fullcodeline": "if (!(s->state & (PNG_ALLIMAGE|PNG_IDAT))) {"
    },
    {
        "line": 165,
        "fullcodeline": "for (x = s->width; x > 0; --x) {"
    },
    {
        "line": 182,
        "fullcodeline": "&& s->last_picture.f->height== p->height"
    },
    {
        "line": 185,
        "fullcodeline": "if (CONFIG_PNG_DECODER && avctx->codec_id != AV_CODEC_ID_APNG)"
    },
    {
        "line": 14,
        "fullcodeline": "avctx->skip_frame == AVDISCARD_ALL) {"
    },
    {
        "line": 15,
        "fullcodeline": "av_frame_set_metadata(p, metadata);"
    },
    {
        "line": 27,
        "fullcodeline": "&& avctx->strict_std_compliance <= FF_COMPLIANCE_NORMAL)"
    },
    {
        "line": 50,
        "fullcodeline": "case MKTAG('I', 'H', 'D', 'R'):"
    },
    {
        "line": 51,
        "fullcodeline": "case MKTAG('p', 'H', 'Y', 's'):"
    },
    {
        "line": 52,
        "fullcodeline": "case MKTAG('t', 'E', 'X', 't'):"
    },
    {
        "line": 53,
        "fullcodeline": "case MKTAG('I', 'D', 'A', 'T'):"
    },
    {
        "line": 54,
        "fullcodeline": "case MKTAG('t', 'R', 'N', 'S'):"
    },
    {
        "line": 81,
        "fullcodeline": "ret = AVERROR_INVALIDDATA;"
    },
    {
        "line": 103,
        "fullcodeline": "av_log(avctx, AV_LOG_WARNING, \"Broken tEXt chunk\\n\");"
    },
    {
        "line": 108,
        "fullcodeline": "av_log(avctx, AV_LOG_WARNING, \"Broken zTXt chunk\\n\");"
    },
    {
        "line": 114,
        "fullcodeline": "if (!stereo3d)"
    },
    {
        "line": 117,
        "fullcodeline": "if (mode == 0 || mode == 1) {"
    },
    {
        "line": 129,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"IEND without all image\\n\");"
    },
    {
        "line": 131,
        "fullcodeline": "ret = AVERROR_INVALIDDATA;"
    },
    {
        "line": 166,
        "fullcodeline": "uint8_t *pixel = &row[s->bpp * (x - 1)];"
    },
    {
        "line": 167,
        "fullcodeline": "memmove(pixel, &row[raw_bpp * (x - 1)], raw_bpp);"
    },
    {
        "line": 181,
        "fullcodeline": "&& s->last_picture.f->width == p->width"
    },
    {
        "line": 186,
        "fullcodeline": "handle_p_frame_png(s, p);"
    },
    {
        "line": 20,
        "fullcodeline": "if (!(s->state & PNG_IDAT))"
    },
    {
        "line": 118,
        "fullcodeline": "stereo3d->type  = AV_STEREO3D_SIDEBYSIDE;"
    },
    {
        "line": 119,
        "fullcodeline": "stereo3d->flags = mode ? 0 : AV_STEREO3D_FLAG_INVERT;"
    },
    {
        "line": 162,
        "fullcodeline": "uint8_t *row = &s->image_buf[s->image_linesize * y];"
    },
    {
        "line": 169,
        "fullcodeline": "if (!memcmp(pixel, s->transparent_color_be, raw_bpp)) {"
    },
    {
        "line": 121,
        "fullcodeline": "av_log(avctx, AV_LOG_WARNING,"
    },
    {
        "line": 170,
        "fullcodeline": "memset(&pixel[raw_bpp], 0, byte_depth);"
    },
    {
        "line": 187,
        "fullcodeline": "else if (CONFIG_APNG_DECODER &&"
    },
    {
        "line": 172,
        "fullcodeline": "memset(&pixel[raw_bpp], 0xff, byte_depth);"
    },
    {
        "line": 189,
        "fullcodeline": "(ret = handle_p_frame_apng(avctx, s, p)) < 0)"
    },
    {
        "line": 188,
        "fullcodeline": "avctx->codec_id == AV_CODEC_ID_APNG &&"
    }
]