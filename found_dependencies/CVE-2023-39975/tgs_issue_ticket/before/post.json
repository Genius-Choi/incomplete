[
    {
        "line": 8,
        "fullcodeline": "krb5_context context = realm->realm_context;"
    },
    {
        "line": 10,
        "fullcodeline": "krb5_keyblock session_key = { 0 }, server_key = { 0 };"
    },
    {
        "line": 12,
        "fullcodeline": "krb5_keyblock *initial_reply_key, *fast_reply_key = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "krb5_enc_tkt_part enc_tkt_reply = { 0 };"
    },
    {
        "line": 14,
        "fullcodeline": "krb5_ticket ticket_reply = { 0 };"
    },
    {
        "line": 15,
        "fullcodeline": "krb5_enc_kdc_rep_part reply_encpart = { 0 };"
    },
    {
        "line": 16,
        "fullcodeline": "krb5_kdc_rep reply = { 0 };"
    },
    {
        "line": 20,
        "fullcodeline": "krb5_last_req_entry nolrentry = { KV5M_LAST_REQ_ENTRY, KRB5_LRQ_NONE, 0 };"
    },
    {
        "line": 21,
        "fullcodeline": "krb5_last_req_entry *nolrarray[2] = { &nolrentry, NULL };"
    },
    {
        "line": 23,
        "fullcodeline": "au_state->stage = ISSUE_TKT;"
    },
    {
        "line": 25,
        "fullcodeline": "ret = gen_session_key(context, t->req, t->server, &session_key, status);"
    },
    {
        "line": 39,
        "fullcodeline": "initial_reply_key = (t->subkey != NULL) ? t->subkey :"
    },
    {
        "line": 76,
        "fullcodeline": "enc_tkt_reply.flags = tktflags;"
    },
    {
        "line": 78,
        "fullcodeline": "enc_tkt_reply.client = t->tkt_client;"
    },
    {
        "line": 79,
        "fullcodeline": "enc_tkt_reply.session = &session_key;"
    },
    {
        "line": 80,
        "fullcodeline": "enc_tkt_reply.transited = t->transited;"
    },
    {
        "line": 82,
        "fullcodeline": "ret = handle_authdata(realm, t->flags, t->client, t->server,"
    },
    {
        "line": 94,
        "fullcodeline": "ticket_reply.enc_part2 = &enc_tkt_reply;"
    },
    {
        "line": 96,
        "fullcodeline": "ret = krb5_encrypt_tkt_part(context, ticket_encrypting_key, &ticket_reply);"
    },
    {
        "line": 107,
        "fullcodeline": "au_state->stage = ENCR_REP;"
    },
    {
        "line": 121,
        "fullcodeline": "reply_encpart.session = &session_key;"
    },
    {
        "line": 123,
        "fullcodeline": "reply_encpart.times = enc_tkt_reply.times;"
    },
    {
        "line": 124,
        "fullcodeline": "reply_encpart.last_req = nolrarray;"
    },
    {
        "line": 125,
        "fullcodeline": "reply_encpart.key_exp = 0;"
    },
    {
        "line": 126,
        "fullcodeline": "reply_encpart.flags = enc_tkt_reply.flags;"
    },
    {
        "line": 127,
        "fullcodeline": "reply_encpart.server = ticket_reply.server;"
    },
    {
        "line": 129,
        "fullcodeline": "reply.msg_type = KRB5_TGS_REP;"
    },
    {
        "line": 130,
        "fullcodeline": "reply.client = enc_tkt_reply.client;"
    },
    {
        "line": 131,
        "fullcodeline": "reply.ticket = &ticket_reply;"
    },
    {
        "line": 132,
        "fullcodeline": "reply.enc_part.kvno = 0;"
    },
    {
        "line": 133,
        "fullcodeline": "reply.enc_part.enctype = initial_reply_key->enctype;"
    },
    {
        "line": 134,
        "fullcodeline": "ret = kdc_fast_response_handle_padata(fast_state, t->req, &reply,"
    },
    {
        "line": 138,
        "fullcodeline": "ret = kdc_fast_handle_reply_key(fast_state, initial_reply_key,"
    },
    {
        "line": 142,
        "fullcodeline": "ret = return_enc_padata(context, pkt, t->req, fast_reply_key, t->server,"
    },
    {
        "line": 151,
        "fullcodeline": "ret = kau_make_tkt_id(context, &ticket_reply, &au_state->tkt_out_id);"
    },
    {
        "line": 157,
        "fullcodeline": "ret = krb5_encode_kdc_rep(context, KRB5_TGS_REP, &reply_encpart,"
    },
    {
        "line": 163,
        "fullcodeline": "log_tgs_req(context, from, t->req, &reply, t->cprinc, t->sprinc,"
    },
    {
        "line": 165,
        "fullcodeline": "au_state->status = \"ISSUE\";"
    },
    {
        "line": 166,
        "fullcodeline": "au_state->reply = &reply;"
    },
    {
        "line": 169,
        "fullcodeline": "kau_tgs_req(context, TRUE, au_state);"
    },
    {
        "line": 170,
        "fullcodeline": "au_state->reply = NULL;"
    },
    {
        "line": 176,
        "fullcodeline": "krb5_free_pa_data(context, reply.padata);"
    },
    {
        "line": 177,
        "fullcodeline": "krb5_free_pa_data(context, reply_encpart.enc_padata);"
    },
    {
        "line": 178,
        "fullcodeline": "krb5_free_authdata(context, enc_tkt_reply.authorization_data);"
    },
    {
        "line": 179,
        "fullcodeline": "krb5_free_keyblock_contents(context, &session_key);"
    },
    {
        "line": 180,
        "fullcodeline": "krb5_free_keyblock_contents(context, &server_key);"
    },
    {
        "line": 181,
        "fullcodeline": "krb5_free_keyblock(context, fast_reply_key);"
    },
    {
        "line": 29,
        "fullcodeline": "if (t->flags & KRB5_KDB_FLAG_CONSTRAINED_DELEGATION) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (t->req->kdc_options & KDC_OPT_ENC_TKT_IN_SKEY) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (t->req->kdc_options & (KDC_OPT_VALIDATE | KDC_OPT_RENEW)) {"
    },
    {
        "line": 100,
        "fullcodeline": "if (t->req->kdc_options & KDC_OPT_ENC_TKT_IN_SKEY) {"
    },
    {
        "line": 109,
        "fullcodeline": "if (t->s4u2self != NULL &&"
    },
    {
        "line": 155,
        "fullcodeline": "if (kdc_fast_hide_client(fast_state))"
    },
    {
        "line": 167,
        "fullcodeline": "if (t->flags & KRB5_KDB_FLAG_CONSTRAINED_DELEGATION)"
    },
    {
        "line": 30,
        "fullcodeline": "subject_pac = t->stkt_pac;"
    },
    {
        "line": 31,
        "fullcodeline": "subject_server = t->stkt_server;"
    },
    {
        "line": 32,
        "fullcodeline": "subject_key = t->stkt_server_key;"
    },
    {
        "line": 61,
        "fullcodeline": "enc_tkt_reply.authorization_data = NULL;"
    },
    {
        "line": 89,
        "fullcodeline": "krb5_klog_syslog(LOG_INFO, _(\"TGS_REQ : handle_authdata (%d)\"), ret);"
    },
    {
        "line": 90,
        "fullcodeline": "*status = \"HANDLE_AUTHDATA\";"
    },
    {
        "line": 101,
        "fullcodeline": "ticket_reply.enc_part.kvno = 0;"
    },
    {
        "line": 102,
        "fullcodeline": "kau_u2u(context, TRUE, au_state);"
    },
    {
        "line": 110,
        "fullcodeline": "krb5int_find_pa_data(context, t->req->padata,"
    },
    {
        "line": 114,
        "fullcodeline": "ret = kdc_make_s4u2self_rep(context, t->subkey,"
    },
    {
        "line": 144,
        "fullcodeline": "t->is_referral &&"
    },
    {
        "line": 147,
        "fullcodeline": "*status = \"KDC_RETURN_ENC_PADATA\";"
    },
    {
        "line": 156,
        "fullcodeline": "reply.client = (krb5_principal)krb5_anonymous_principal();"
    },
    {
        "line": 158,
        "fullcodeline": "t->subkey != NULL, fast_reply_key, &reply,"
    },
    {
        "line": 168,
        "fullcodeline": "kau_s4u2proxy(context, TRUE, au_state);"
    },
    {
        "line": 34,
        "fullcodeline": "subject_pac = t->header_pac;"
    },
    {
        "line": 35,
        "fullcodeline": "subject_server = t->header_server;"
    },
    {
        "line": 36,
        "fullcodeline": "subject_key = t->header_key;"
    },
    {
        "line": 49,
        "fullcodeline": "ret = get_first_current_key(context, t->server, &server_key);"
    },
    {
        "line": 54,
        "fullcodeline": "ticket_encrypting_key = &server_key;"
    },
    {
        "line": 73,
        "fullcodeline": "ticket_reply.server = t->is_referral ? t->sprinc : t->req->server;"
    },
    {
        "line": 104,
        "fullcodeline": "ticket_reply.enc_part.kvno = current_kvno(t->server);"
    },
    {
        "line": 145,
        "fullcodeline": "(t->req->kdc_options & KDC_OPT_CANONICALIZE));"
    },
    {
        "line": 63,
        "fullcodeline": "if (t->req->kdc_options & (KDC_OPT_FORWARDED | KDC_OPT_PROXY)) {"
    },
    {
        "line": 51,
        "fullcodeline": "*status = \"FINDING_SERVER_KEY\";"
    },
    {
        "line": 69,
        "fullcodeline": "enc_tkt_reply.caddrs = header_enc_tkt->caddrs;"
    },
    {
        "line": 70,
        "fullcodeline": "reply_encpart.caddrs = NULL;"
    }
]