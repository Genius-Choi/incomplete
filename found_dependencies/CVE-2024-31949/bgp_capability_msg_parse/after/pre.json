[
    {
        "line": 14,
        "fullcodeline": "end = pnt + length;"
    },
    {
        "line": 16,
        "fullcodeline": "while (pnt < end) {"
    },
    {
        "line": 26,
        "fullcodeline": "action = *pnt;"
    },
    {
        "line": 27,
        "fullcodeline": "hdr = (struct capability_header *)(pnt + 1);"
    },
    {
        "line": 56,
        "fullcodeline": "capability = lookup_msg(capcode_str, hdr->code, \"Unknown\");"
    },
    {
        "line": 180,
        "fullcodeline": "pnt += hdr->length + 3;"
    },
    {
        "line": 19,
        "fullcodeline": "if (pnt + 3 > end) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (action != CAPABILITY_ACTION_SET"
    },
    {
        "line": 39,
        "fullcodeline": "if (bgp_debug_neighbor_events(peer))"
    },
    {
        "line": 44,
        "fullcodeline": "if ((pnt + hdr->length + 3) > end) {"
    },
    {
        "line": 53,
        "fullcodeline": "if (CHECK_FLAG(peer->flags, PEER_FLAG_OVERRIDE_CAPABILITY))"
    },
    {
        "line": 20,
        "fullcodeline": "zlog_err(\"%pBP: Capability length error\", peer);"
    },
    {
        "line": 21,
        "fullcodeline": "bgp_notify_send(peer->connection, BGP_NOTIFY_CEASE,"
    },
    {
        "line": 23,
        "fullcodeline": "pnt += length;"
    },
    {
        "line": 31,
        "fullcodeline": "&& action != CAPABILITY_ACTION_UNSET) {"
    },
    {
        "line": 32,
        "fullcodeline": "zlog_err(\"%pBP: Capability Action Value error %d\", peer,"
    },
    {
        "line": 34,
        "fullcodeline": "bgp_notify_send(peer->connection, BGP_NOTIFY_CEASE,"
    },
    {
        "line": 40,
        "fullcodeline": "zlog_debug(\"%pBP: CAPABILITY has action: %d, code: %u, length %u\","
    },
    {
        "line": 45,
        "fullcodeline": "zlog_err(\"%pBP: Capability length error\", peer);"
    },
    {
        "line": 60,
        "fullcodeline": "bgp_dynamic_capability_software_version(pnt, action,"
    },
    {
        "line": 72,
        "fullcodeline": "memcpy(&mpc, pnt + 3, sizeof(struct capability_mp_data));"
    },
    {
        "line": 73,
        "fullcodeline": "pkt_afi = ntohs(mpc.afi);"
    },
    {
        "line": 74,
        "fullcodeline": "pkt_safi = mpc.safi;"
    },
    {
        "line": 124,
        "fullcodeline": "bgp_dynamic_capability_graceful_restart(pnt, action,"
    },
    {
        "line": 128,
        "fullcodeline": "bgp_dynamic_capability_llgr(pnt, action, hdr, peer);"
    },
    {
        "line": 131,
        "fullcodeline": "bgp_dynamic_capability_addpath(pnt, action, hdr, peer);"
    },
    {
        "line": 134,
        "fullcodeline": "bgp_dynamic_capability_paths_limit(pnt, action, hdr,"
    },
    {
        "line": 138,
        "fullcodeline": "bgp_dynamic_capability_orf(pnt, action, hdr, peer);"
    },
    {
        "line": 141,
        "fullcodeline": "bgp_dynamic_capability_fqdn(pnt, action, hdr, peer);"
    },
    {
        "line": 173,
        "fullcodeline": "flog_warn(EC_BGP_UNRECOGNIZED_CAPABILITY,"
    },
    {
        "line": 64,
        "fullcodeline": "if (hdr->length < sizeof(struct capability_mp_data)) {"
    },
    {
        "line": 77,
        "fullcodeline": "if (bgp_map_afi_safi_iana2int(pkt_afi, pkt_safi, &afi,"
    },
    {
        "line": 88,
        "fullcodeline": "if (bgp_debug_neighbor_events(peer))"
    },
    {
        "line": 97,
        "fullcodeline": "if (action == CAPABILITY_ACTION_SET) {"
    },
    {
        "line": 115,
        "fullcodeline": "if ((hdr->length - 2) % 4) {"
    },
    {
        "line": 151,
        "fullcodeline": "if (hdr->length != CAPABILITY_CODE_ROLE_LEN) {"
    },
    {
        "line": 162,
        "fullcodeline": "if (action == CAPABILITY_ACTION_SET) {"
    },
    {
        "line": 65,
        "fullcodeline": "zlog_err(\"%pBP: Capability (%s) structure is not properly filled out, expected at least %zu bytes but header length specified is %d\","
    },
    {
        "line": 89,
        "fullcodeline": "zlog_debug(\"%pBP: CAPABILITY has %s %s CAP for afi/safi: %s/%s\","
    },
    {
        "line": 98,
        "fullcodeline": "peer->afc_recv[afi][safi] = 1;"
    },
    {
        "line": 116,
        "fullcodeline": "zlog_err(\"%pBP: Received invalid Graceful-Restart capability length %d\","
    },
    {
        "line": 118,
        "fullcodeline": "bgp_notify_send(peer->connection,"
    },
    {
        "line": 152,
        "fullcodeline": "zlog_err(\"%pBP: Capability (%s) length error\","
    },
    {
        "line": 154,
        "fullcodeline": "bgp_notify_send(peer->connection,"
    },
    {
        "line": 163,
        "fullcodeline": "SET_FLAG(peer->cap, PEER_CAP_ROLE_RCV);"
    },
    {
        "line": 164,
        "fullcodeline": "memcpy(&role, pnt + 3, sizeof(role));"
    },
    {
        "line": 166,
        "fullcodeline": "peer->remote_role = role;"
    },
    {
        "line": 67,
        "fullcodeline": "sizeof(struct capability_mp_data),"
    },
    {
        "line": 79,
        "fullcodeline": "if (bgp_debug_neighbor_events(peer))"
    },
    {
        "line": 94,
        "fullcodeline": "capability, iana_afi2str(pkt_afi),"
    },
    {
        "line": 95,
        "fullcodeline": "iana_safi2str(pkt_safi));"
    },
    {
        "line": 105,
        "fullcodeline": "peer->afc_recv[afi][safi] = 0;"
    },
    {
        "line": 106,
        "fullcodeline": "peer->afc_nego[afi][safi] = 0;"
    },
    {
        "line": 168,
        "fullcodeline": "UNSET_FLAG(peer->cap, PEER_CAP_ROLE_RCV);"
    },
    {
        "line": 169,
        "fullcodeline": "peer->remote_role = ROLE_UNDEFINED;"
    },
    {
        "line": 80,
        "fullcodeline": "zlog_debug(\"%pBP: Dynamic Capability %s afi/safi invalid (%s/%s)\","
    },
    {
        "line": 91,
        "fullcodeline": "action == CAPABILITY_ACTION_SET"
    },
    {
        "line": 100,
        "fullcodeline": "peer->afc_nego[afi][safi] = 1;"
    },
    {
        "line": 101,
        "fullcodeline": "bgp_announce_route(peer, afi, safi,"
    },
    {
        "line": 108,
        "fullcodeline": "if (peer_active_nego(peer))"
    },
    {
        "line": 82,
        "fullcodeline": "iana_afi2str(pkt_afi),"
    },
    {
        "line": 83,
        "fullcodeline": "iana_safi2str(pkt_safi));"
    },
    {
        "line": 109,
        "fullcodeline": "bgp_clear_route(peer, afi, safi);"
    }
]