[
    {
        "line": 4,
        "fullcodeline": "next_url = get_redirect_url(fallback=\"app.dashboard\")"
    },
    {
        "line": 6,
        "fullcodeline": "if flask.request.method == \"POST\":"
    },
    {
        "line": 20,
        "fullcodeline": "if is_authenticated():"
    },
    {
        "line": 23,
        "fullcodeline": "if api.get_config_value(\"webui\", \"autologin\"):"
    },
    {
        "line": 33,
        "fullcodeline": "return render_template(\"login.html\")"
    },
    {
        "line": 9,
        "fullcodeline": "user_info = api.check_auth(user, password)"
    },
    {
        "line": 11,
        "fullcodeline": "sanitized_user = user.replace(\"\\n\", \"\\\\n\").replace(\"\\r\", \"\\\\r\")"
    },
    {
        "line": 16,
        "fullcodeline": "set_session(user_info)"
    },
    {
        "line": 17,
        "fullcodeline": "log.info(f\"User '{sanitized_user}' successfully logged in\")"
    },
    {
        "line": 18,
        "fullcodeline": "flask.flash(\"Logged in successfully\")"
    },
    {
        "line": 24,
        "fullcodeline": "allusers = api.get_all_userdata()"
    },
    {
        "line": 12,
        "fullcodeline": "if not user_info:"
    },
    {
        "line": 21,
        "fullcodeline": "return flask.redirect(next_url)"
    },
    {
        "line": 25,
        "fullcodeline": "if len(allusers) == 1:  # TODO: check if localhost"
    },
    {
        "line": 13,
        "fullcodeline": "log.error(f\"Login failed for user '{sanitized_user}'\")"
    },
    {
        "line": 27,
        "fullcodeline": "set_session(user_info)"
    },
    {
        "line": 14,
        "fullcodeline": "return render_template(\"login.html\", errors=True)"
    },
    {
        "line": 30,
        "fullcodeline": "if is_authenticated():"
    },
    {
        "line": 26,
        "fullcodeline": "user_info = list(allusers.values())[0]"
    },
    {
        "line": 31,
        "fullcodeline": "return flask.redirect(next_url)"
    }
]