[
    {
        "line": 2,
        "fullcodeline": "login_url = urljoin(flask.request.url_root, flask.url_for('app.login'))"
    },
    {
        "line": 3,
        "fullcodeline": "request_url = unquote(flask.request.url)"
    },
    {
        "line": 4,
        "fullcodeline": "for location in flask.request.values.get(\"next\"), flask.request.referrer:"
    },
    {
        "line": 5,
        "fullcodeline": "if not location:"
    },
    {
        "line": 7,
        "fullcodeline": "if location in (request_url, login_url):  # don't redirect to same location"
    },
    {
        "line": 9,
        "fullcodeline": "if is_safe_url(location):"
    }
]