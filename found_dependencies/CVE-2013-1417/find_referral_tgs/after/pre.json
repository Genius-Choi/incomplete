[
    {
        "line": 4,
        "fullcodeline": "krb5_error_code retval = KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 5,
        "fullcodeline": "char **realms = NULL, *hostname = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "krb5_data srealm = request->server->realm;"
    },
    {
        "line": 11,
        "fullcodeline": "hostname = data2string(krb5_princ_component(kdc_context,"
    },
    {
        "line": 20,
        "fullcodeline": "retval = krb5_get_host_realm(kdc_context, hostname, &realms);"
    },
    {
        "line": 32,
        "fullcodeline": "retval = krb5_build_principal(kdc_context, krbtgt_princ,"
    },
    {
        "line": 36,
        "fullcodeline": "krb5_free_host_realm(kdc_context, realms);"
    },
    {
        "line": 37,
        "fullcodeline": "free(hostname);"
    },
    {
        "line": 8,
        "fullcodeline": "if (!is_referral_req(kdc_active_realm, request))"
    },
    {
        "line": 13,
        "fullcodeline": "if (hostname == NULL) {"
    },
    {
        "line": 18,
        "fullcodeline": "if (strchr(hostname, '.') == NULL)"
    },
    {
        "line": 27,
        "fullcodeline": "if (realms == NULL || realms[0] == NULL || *realms[0] == '\\0' ||"
    },
    {
        "line": 14,
        "fullcodeline": "retval = ENOMEM;"
    },
    {
        "line": 23,
        "fullcodeline": "kdc_err(kdc_context, retval, \"unable to find realm of host\");"
    },
    {
        "line": 28,
        "fullcodeline": "data_eq_string(srealm, realms[0])) {"
    },
    {
        "line": 29,
        "fullcodeline": "retval = KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN;"
    }
]