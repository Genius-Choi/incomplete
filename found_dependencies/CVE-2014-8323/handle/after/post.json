[
    {
        "line": 3,
        "fullcodeline": "char buf[2048];"
    },
    {
        "line": 4,
        "fullcodeline": "unsigned short *cmd = (unsigned short *)buf;"
    },
    {
        "line": 6,
        "fullcodeline": "struct in_addr *addr = &s_in->sin_addr;"
    },
    {
        "line": 7,
        "fullcodeline": "unsigned short *pid = (unsigned short*) data;"
    },
    {
        "line": 26,
        "fullcodeline": "*cmd++ = htons(S_CMD_PACKET);"
    },
    {
        "line": 28,
        "fullcodeline": "plen = len - 2;"
    },
    {
        "line": 32,
        "fullcodeline": "last_id = ntohs(*pid);"
    },
    {
        "line": 40,
        "fullcodeline": "printf(\"Got packet %d %d\", last_id, plen);"
    },
    {
        "line": 45,
        "fullcodeline": "printf(\"\\n\");"
    },
    {
        "line": 47,
        "fullcodeline": "*cmd++ = htons(plen);"
    },
    {
        "line": 48,
        "fullcodeline": "memcpy(cmd, data+2, plen);"
    },
    {
        "line": 50,
        "fullcodeline": "plen += 2 + 2 + 2;"
    },
    {
        "line": 51,
        "fullcodeline": "assert(plen <= (int) sizeof(buf));"
    },
    {
        "line": 10,
        "fullcodeline": "if (len == S_HELLO_LEN && memcmp(data, \"sorbo\", 5) == 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (plen < 0)"
    },
    {
        "line": 33,
        "fullcodeline": "if (last_id > 20000)"
    },
    {
        "line": 35,
        "fullcodeline": "if (wrap && last_id < 100) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (is_dup(last_id)) {"
    },
    {
        "line": 52,
        "fullcodeline": "if (send(s, buf, plen, 0) != plen)"
    },
    {
        "line": 11,
        "fullcodeline": "unsigned short *id = (unsigned short*) (data+5);"
    },
    {
        "line": 12,
        "fullcodeline": "int x = 2+4+2;"
    },
    {
        "line": 14,
        "fullcodeline": "*cmd = htons(S_CMD_INET_CHECK);"
    },
    {
        "line": 15,
        "fullcodeline": "memcpy(cmd+1, addr, 4);"
    },
    {
        "line": 16,
        "fullcodeline": "memcpy(cmd+1+2, id, 2);"
    },
    {
        "line": 18,
        "fullcodeline": "printf(\"Inet check by %s %d\\n\","
    },
    {
        "line": 27,
        "fullcodeline": "*cmd++ = *pid;"
    },
    {
        "line": 34,
        "fullcodeline": "wrap = 1;"
    },
    {
        "line": 36,
        "fullcodeline": "wrap = 0;"
    },
    {
        "line": 37,
        "fullcodeline": "memset(ids, 0, sizeof(ids));"
    },
    {
        "line": 42,
        "fullcodeline": "printf(\" (DUP)\\n\");"
    },
    {
        "line": 20,
        "fullcodeline": "if (send(s, buf, x, 0) != x)"
    }
]