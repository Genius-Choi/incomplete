[
    {
        "line": 3,
        "fullcodeline": "char buf[2048];"
    },
    {
        "line": 4,
        "fullcodeline": "unsigned short *cmd = (unsigned short *)buf;"
    },
    {
        "line": 6,
        "fullcodeline": "struct in_addr *addr = &s_in->sin_addr;"
    },
    {
        "line": 7,
        "fullcodeline": "unsigned short *pid = (unsigned short*) data;"
    },
    {
        "line": 28,
        "fullcodeline": "plen = len - 2;"
    },
    {
        "line": 30,
        "fullcodeline": "last_id = ntohs(*pid);"
    },
    {
        "line": 38,
        "fullcodeline": "printf(\"Got packet %d %d\", last_id, plen);"
    },
    {
        "line": 46,
        "fullcodeline": "memcpy(cmd, data+2, plen);"
    },
    {
        "line": 48,
        "fullcodeline": "plen += 2 + 2 + 2;"
    },
    {
        "line": 10,
        "fullcodeline": "if (len == S_HELLO_LEN && memcmp(data, \"sorbo\", 5) == 0) {"
    },
    {
        "line": 26,
        "fullcodeline": "*cmd++ = htons(S_CMD_PACKET);"
    },
    {
        "line": 31,
        "fullcodeline": "if (last_id > 20000)"
    },
    {
        "line": 45,
        "fullcodeline": "*cmd++ = htons(plen);"
    },
    {
        "line": 49,
        "fullcodeline": "assert(plen <= (int) sizeof(buf));"
    },
    {
        "line": 11,
        "fullcodeline": "unsigned short *id = (unsigned short*) (data+5);"
    },
    {
        "line": 12,
        "fullcodeline": "int x = 2+4+2;"
    },
    {
        "line": 14,
        "fullcodeline": "*cmd = htons(S_CMD_INET_CHECK);"
    },
    {
        "line": 15,
        "fullcodeline": "memcpy(cmd+1, addr, 4);"
    },
    {
        "line": 16,
        "fullcodeline": "memcpy(cmd+1+2, id, 2);"
    },
    {
        "line": 18,
        "fullcodeline": "printf(\"Inet check by %s %d\\n\","
    },
    {
        "line": 27,
        "fullcodeline": "*cmd++ = *pid;"
    },
    {
        "line": 32,
        "fullcodeline": "wrap = 1;"
    },
    {
        "line": 33,
        "fullcodeline": "if (wrap && last_id < 100) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (send(s, buf, plen, 0) != plen)"
    },
    {
        "line": 19,
        "fullcodeline": "inet_ntoa(*addr), ntohs(*id));"
    },
    {
        "line": 20,
        "fullcodeline": "if (send(s, buf, x, 0) != x)"
    }
]