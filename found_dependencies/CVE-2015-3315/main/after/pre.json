[
    {
        "line": 8,
        "fullcodeline": "int fd = xopen(\"/dev/null\", O_RDWR);"
    },
    {
        "line": 36,
        "fullcodeline": "logmode = LOGMODE_JOURNAL;"
    },
    {
        "line": 39,
        "fullcodeline": "load_abrt_conf();"
    },
    {
        "line": 57,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 58,
        "fullcodeline": "const char* signal_str = argv[1];"
    },
    {
        "line": 59,
        "fullcodeline": "int signal_no = xatoi_positive(signal_str);"
    },
    {
        "line": 60,
        "fullcodeline": "off_t ulimit_c = strtoull(argv[2], NULL, 10);"
    },
    {
        "line": 66,
        "fullcodeline": "const char *pid_str = argv[3];"
    },
    {
        "line": 67,
        "fullcodeline": "pid_t pid = xatoi_positive(argv[3]);"
    },
    {
        "line": 68,
        "fullcodeline": "uid_t uid = xatoi_positive(argv[4]);"
    },
    {
        "line": 90,
        "fullcodeline": "char path[PATH_MAX];"
    },
    {
        "line": 92,
        "fullcodeline": "int src_fd_binary = -1;"
    },
    {
        "line": 93,
        "fullcodeline": "char *executable = get_executable(pid, setting_SaveBinaryImage ? &src_fd_binary : NULL);"
    },
    {
        "line": 100,
        "fullcodeline": "user_pwd = get_cwd(pid); /* may be NULL on error */"
    },
    {
        "line": 101,
        "fullcodeline": "log_notice(\"user_pwd:'%s'\", user_pwd);"
    },
    {
        "line": 103,
        "fullcodeline": "sprintf(path, \"/proc/%lu/status\", (long)pid);"
    },
    {
        "line": 104,
        "fullcodeline": "proc_pid_status = xmalloc_xopen_read_close(path, /*maxsz:*/ NULL);"
    },
    {
        "line": 106,
        "fullcodeline": "uid_t fsuid = uid;"
    },
    {
        "line": 107,
        "fullcodeline": "uid_t tmp_fsuid = get_fsuid();"
    },
    {
        "line": 108,
        "fullcodeline": "int suid_policy = dump_suid_policy();"
    },
    {
        "line": 131,
        "fullcodeline": "const char *signame = NULL;"
    },
    {
        "line": 170,
        "fullcodeline": "snprintf(path, sizeof(path), \"%s/last-ccpp\", g_settings_dump_location);"
    },
    {
        "line": 177,
        "fullcodeline": "const char *last_slash = strrchr(executable, '/');"
    },
    {
        "line": 199,
        "fullcodeline": "unsigned path_len = snprintf(path, sizeof(path), \"%s/ccpp-%s-%lu.new\","
    },
    {
        "line": 209,
        "fullcodeline": "dd = dd_create(path, fsuid, DEFAULT_DUMP_DIR_MODE);"
    },
    {
        "line": 9,
        "fullcodeline": "while (fd < 2)"
    },
    {
        "line": 10,
        "fullcodeline": "fd = xdup(fd);"
    },
    {
        "line": 11,
        "fullcodeline": "if (fd > 2)"
    },
    {
        "line": 14,
        "fullcodeline": "if (argc < 8)"
    },
    {
        "line": 27,
        "fullcodeline": "if (strchr(argv[1], ' '))"
    },
    {
        "line": 44,
        "fullcodeline": "map_string_t *settings = new_map_string();"
    },
    {
        "line": 45,
        "fullcodeline": "load_abrt_plugin_conf_file(\"CCpp.conf\", settings);"
    },
    {
        "line": 47,
        "fullcodeline": "value = get_map_string_item_or_NULL(settings, \"MakeCompatCore\");"
    },
    {
        "line": 48,
        "fullcodeline": "setting_MakeCompatCore = value && string_to_bool(value);"
    },
    {
        "line": 49,
        "fullcodeline": "value = get_map_string_item_or_NULL(settings, \"SaveBinaryImage\");"
    },
    {
        "line": 50,
        "fullcodeline": "setting_SaveBinaryImage = value && string_to_bool(value);"
    },
    {
        "line": 51,
        "fullcodeline": "value = get_map_string_item_or_NULL(settings, \"VerboseLog\");"
    },
    {
        "line": 54,
        "fullcodeline": "free_map_string(settings);"
    },
    {
        "line": 61,
        "fullcodeline": "if (ulimit_c < 0) /* unlimited? */"
    },
    {
        "line": 69,
        "fullcodeline": "if (errno || pid <= 0)"
    },
    {
        "line": 84,
        "fullcodeline": "if (!argv[8]) /* no HOSTNAME? */"
    },
    {
        "line": 94,
        "fullcodeline": "if (executable && strstr(executable, \"/abrt-hook-ccpp\"))"
    },
    {
        "line": 109,
        "fullcodeline": "if (tmp_fsuid != uid)"
    },
    {
        "line": 120,
        "fullcodeline": "if (setting_MakeCompatCore && ulimit_c != 0)"
    },
    {
        "line": 124,
        "fullcodeline": "if (executable == NULL)"
    },
    {
        "line": 150,
        "fullcodeline": "if (!daemon_is_ok())"
    },
    {
        "line": 160,
        "fullcodeline": "if (g_settings_nMaxCrashReportsSize > 0)"
    },
    {
        "line": 171,
        "fullcodeline": "if (check_recent_crash_file(path, executable))"
    },
    {
        "line": 178,
        "fullcodeline": "if (last_slash && strncmp(++last_slash, \"abrt\", 4) == 0)"
    },
    {
        "line": 401,
        "fullcodeline": "if (user_core_fd >= 0)"
    },
    {
        "line": 12,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 18,
        "fullcodeline": "error_msg_and_die(\"Usage: %s SIGNO CORE_SIZE_LIMIT PID UID GID TIME BINARY_NAME [HOSTNAME]\", argv[0]);"
    },
    {
        "line": 64,
        "fullcodeline": "ulimit_c = ~((off_t)1 << (sizeof(off_t)*8-1));"
    },
    {
        "line": 71,
        "fullcodeline": "perror_msg_and_die(\"PID '%s' or limit '%s' is bogus\", argv[3], argv[2]);"
    },
    {
        "line": 77,
        "fullcodeline": "if (s && s[0] != '|')"
    },
    {
        "line": 86,
        "fullcodeline": "uname(&uts);"
    },
    {
        "line": 87,
        "fullcodeline": "argv[8] = uts.nodename;"
    },
    {
        "line": 96,
        "fullcodeline": "error_msg_and_die(\"PID %lu is '%s', not dumping it to avoid recursion\","
    },
    {
        "line": 112,
        "fullcodeline": "fsuid = 0;"
    },
    {
        "line": 122,
        "fullcodeline": "user_core_fd = open_user_core(uid, fsuid, pid, &argv[1]);"
    },
    {
        "line": 134,
        "fullcodeline": "case SIGILL : signame = \"ILL\" ; break;"
    },
    {
        "line": 135,
        "fullcodeline": "case SIGFPE : signame = \"FPE\" ; break;"
    },
    {
        "line": 136,
        "fullcodeline": "case SIGSEGV: signame = \"SEGV\"; break;"
    },
    {
        "line": 137,
        "fullcodeline": "case SIGBUS : signame = \"BUS\" ; break; //Bus error (bad memory access)"
    },
    {
        "line": 138,
        "fullcodeline": "case SIGABRT: signame = \"ABRT\"; break; //usually when abort() was called"
    },
    {
        "line": 141,
        "fullcodeline": "case SIGTRAP: signame = \"TRAP\"; break; //Trace/breakpoint trap"
    },
    {
        "line": 185,
        "fullcodeline": "snprintf(path, sizeof(path), \"%s/%s-coredump\", g_settings_dump_location, last_slash);"
    },
    {
        "line": 186,
        "fullcodeline": "int abrt_core_fd = xopen3(path, O_WRONLY | O_CREAT | O_TRUNC, 0600);"
    },
    {
        "line": 187,
        "fullcodeline": "off_t core_size = copyfd_eof(STDIN_FILENO, abrt_core_fd, COPYFD_SPARSE);"
    },
    {
        "line": 195,
        "fullcodeline": "log(\"Saved core dump of pid %lu (%s) to %s (%llu bytes)\", (long)pid, executable, path, (long long)core_size);"
    },
    {
        "line": 200,
        "fullcodeline": "g_settings_dump_location, iso_date_string(NULL), (long)pid);"
    },
    {
        "line": 212,
        "fullcodeline": "char *rootdir = get_rootdir(pid);"
    },
    {
        "line": 214,
        "fullcodeline": "dd_create_basic_files(dd, fsuid, NULL);"
    },
    {
        "line": 216,
        "fullcodeline": "char source_filename[sizeof(\"/proc/%lu/somewhat_long_name\") + sizeof(long)*3];"
    },
    {
        "line": 217,
        "fullcodeline": "int source_base_ofs = sprintf(source_filename, \"/proc/%lu/smaps\", (long)pid);"
    },
    {
        "line": 218,
        "fullcodeline": "source_base_ofs -= strlen(\"smaps\");"
    },
    {
        "line": 219,
        "fullcodeline": "char *dest_filename = concat_path_file(dd->dd_dirname, \"also_somewhat_longish_name\");"
    },
    {
        "line": 220,
        "fullcodeline": "char *dest_base = strrchr(dest_filename, '/') + 1;"
    },
    {
        "line": 227,
        "fullcodeline": "strcpy(dest_base, FILENAME_MAPS);"
    },
    {
        "line": 228,
        "fullcodeline": "copy_file_ext(source_filename, dest_filename, 0640, dd->dd_uid, dd->dd_gid, O_RDONLY, O_WRONLY | O_CREAT | O_TRUNC | O_EXCL);"
    },
    {
        "line": 231,
        "fullcodeline": "strcpy(dest_base, FILENAME_LIMITS);"
    },
    {
        "line": 232,
        "fullcodeline": "copy_file_ext(source_filename, dest_filename, 0640, dd->dd_uid, dd->dd_gid, O_RDONLY, O_WRONLY | O_CREAT | O_TRUNC | O_EXCL);"
    },
    {
        "line": 235,
        "fullcodeline": "strcpy(dest_base, FILENAME_CGROUP);"
    },
    {
        "line": 236,
        "fullcodeline": "copy_file_ext(source_filename, dest_filename, 0640, dd->dd_uid, dd->dd_gid, O_RDONLY, O_WRONLY | O_CREAT | O_TRUNC | O_EXCL);"
    },
    {
        "line": 238,
        "fullcodeline": "strcpy(dest_base, FILENAME_OPEN_FDS);"
    },
    {
        "line": 239,
        "fullcodeline": "dump_fd_info(dest_filename, source_filename, source_base_ofs, dd->dd_uid, dd->dd_gid);"
    },
    {
        "line": 243,
        "fullcodeline": "dd_save_text(dd, FILENAME_ANALYZER, \"CCpp\");"
    },
    {
        "line": 244,
        "fullcodeline": "dd_save_text(dd, FILENAME_TYPE, \"CCpp\");"
    },
    {
        "line": 245,
        "fullcodeline": "dd_save_text(dd, FILENAME_EXECUTABLE, executable);"
    },
    {
        "line": 246,
        "fullcodeline": "dd_save_text(dd, FILENAME_PID, pid_str);"
    },
    {
        "line": 247,
        "fullcodeline": "dd_save_text(dd, FILENAME_PROC_PID_STATUS, proc_pid_status);"
    },
    {
        "line": 256,
        "fullcodeline": "char *reason = xasprintf(\"%s killed by SIG%s\","
    },
    {
        "line": 258,
        "fullcodeline": "dd_save_text(dd, FILENAME_REASON, reason);"
    },
    {
        "line": 262,
        "fullcodeline": "dd_save_text(dd, FILENAME_CMDLINE, cmdline ? : \"\");"
    },
    {
        "line": 266,
        "fullcodeline": "dd_save_text(dd, FILENAME_ENVIRON, environ ? : \"\");"
    },
    {
        "line": 269,
        "fullcodeline": "char *fips_enabled = xmalloc_fopen_fgetline_fclose(\"/proc/sys/crypto/fips_enabled\");"
    },
    {
        "line": 277,
        "fullcodeline": "dd_save_text(dd, FILENAME_ABRT_VERSION, VERSION);"
    },
    {
        "line": 293,
        "fullcodeline": "int abrt_core_fd = create_or_die(path);"
    },
    {
        "line": 305,
        "fullcodeline": "off_t core_size = copyfd_sparse(STDIN_FILENO, abrt_core_fd, user_core_fd, ulimit_c);"
    },
    {
        "line": 374,
        "fullcodeline": "path[path_len] = '\\0'; /* path now contains only directory name */"
    },
    {
        "line": 375,
        "fullcodeline": "char *newpath = xstrndup(path, path_len - (sizeof(\".new\")-1));"
    },
    {
        "line": 380,
        "fullcodeline": "log(\"Saved core dump of pid %lu (%s) to %s (%llu bytes)\", (long)pid, executable, path, (long long)core_size);"
    },
    {
        "line": 382,
        "fullcodeline": "notify_new_path(path);"
    },
    {
        "line": 403,
        "fullcodeline": "off_t core_size = copyfd_size(STDIN_FILENO, user_core_fd, ulimit_c, COPYFD_SPARSE);"
    },
    {
        "line": 30,
        "fullcodeline": "for (i = 1; argv[i]; i++)"
    },
    {
        "line": 53,
        "fullcodeline": "g_verbose = xatoi_positive(value);"
    },
    {
        "line": 78,
        "fullcodeline": "core_basename = s;"
    },
    {
        "line": 113,
        "fullcodeline": "if (suid_policy == DUMP_SUID_UNSAFE)"
    },
    {
        "line": 163,
        "fullcodeline": "if (low_free_space(g_settings_nMaxCrashReportsSize, g_settings_dump_location))"
    },
    {
        "line": 188,
        "fullcodeline": "if (core_size < 0 || fsync(abrt_core_fd) != 0)"
    },
    {
        "line": 261,
        "fullcodeline": "char *cmdline = get_cmdline(pid);"
    },
    {
        "line": 265,
        "fullcodeline": "char *environ = get_environ(pid);"
    },
    {
        "line": 279,
        "fullcodeline": "if (src_fd_binary > 0)"
    },
    {
        "line": 385,
        "fullcodeline": "if (g_settings_nMaxCrashReportsSize > 0)"
    },
    {
        "line": 32,
        "fullcodeline": "strchrnul(argv[i], ' ')[0] = '\\0';"
    },
    {
        "line": 80,
        "fullcodeline": "free(s);"
    },
    {
        "line": 115,
        "fullcodeline": "fsuid = tmp_fsuid;"
    },
    {
        "line": 190,
        "fullcodeline": "unlink(path);"
    },
    {
        "line": 193,
        "fullcodeline": "error_msg_and_die(\"Error saving '%s'\", path);"
    },
    {
        "line": 249,
        "fullcodeline": "dd_save_text(dd, FILENAME_PWD, user_pwd);"
    },
    {
        "line": 282,
        "fullcodeline": "int dst_fd = create_or_die(path);"
    },
    {
        "line": 283,
        "fullcodeline": "off_t sz = copyfd_eof(src_fd_binary, dst_fd, COPYFD_SPARSE);"
    },
    {
        "line": 306,
        "fullcodeline": "if (fsync(abrt_core_fd) != 0 || close(abrt_core_fd) != 0 || core_size < 0)"
    },
    {
        "line": 308,
        "fullcodeline": "unlink(path);"
    },
    {
        "line": 309,
        "fullcodeline": "dd_delete(dd);"
    },
    {
        "line": 317,
        "fullcodeline": "error_msg_and_die(\"Error writing '%s'\", path);"
    },
    {
        "line": 319,
        "fullcodeline": "if (user_core_fd >= 0"
    },
    {
        "line": 321,
        "fullcodeline": "&& (fsync(user_core_fd) != 0 || close(user_core_fd) != 0"
    },
    {
        "line": 376,
        "fullcodeline": "if (rename(path, newpath) == 0)"
    },
    {
        "line": 377,
        "fullcodeline": "strcpy(path, newpath);"
    },
    {
        "line": 390,
        "fullcodeline": "unsigned maxsize = g_settings_nMaxCrashReportsSize + g_settings_nMaxCrashReportsSize / 4;"
    },
    {
        "line": 391,
        "fullcodeline": "maxsize |= 63;"
    },
    {
        "line": 404,
        "fullcodeline": "if (fsync(user_core_fd) != 0 || close(user_core_fd) != 0 || core_size < 0)"
    },
    {
        "line": 412,
        "fullcodeline": "if (ulimit_c == 0 || core_size > ulimit_c)"
    },
    {
        "line": 310,
        "fullcodeline": "if (user_core_fd >= 0)"
    },
    {
        "line": 323,
        "fullcodeline": "|| (ulimit_c == 0 /* paranoia */ || core_size > ulimit_c)"
    },
    {
        "line": 392,
        "fullcodeline": "trim_problem_dirs(g_settings_dump_location, maxsize * (double)(1024*1024), path);"
    },
    {
        "line": 252,
        "fullcodeline": "if (strcmp(rootdir, \"/\") != 0)"
    },
    {
        "line": 253,
        "fullcodeline": "dd_save_text(dd, FILENAME_ROOTDIR, rootdir);"
    },
    {
        "line": 272,
        "fullcodeline": "if (strcmp(fips_enabled, \"0\") != 0)"
    },
    {
        "line": 273,
        "fullcodeline": "dd_save_text(dd, \"fips_enabled\", fips_enabled);"
    },
    {
        "line": 284,
        "fullcodeline": "if (fsync(dst_fd) != 0 || close(dst_fd) != 0 || sz < 0)"
    },
    {
        "line": 286,
        "fullcodeline": "dd_delete(dd);"
    },
    {
        "line": 287,
        "fullcodeline": "error_msg_and_die(\"Error saving '%s'\", path);"
    },
    {
        "line": 312,
        "fullcodeline": "xchdir(user_pwd);"
    },
    {
        "line": 313,
        "fullcodeline": "unlink(core_basename);"
    }
]