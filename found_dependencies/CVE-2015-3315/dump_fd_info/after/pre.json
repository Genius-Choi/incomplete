[
    {
        "line": 3,
        "fullcodeline": "FILE *fp = fopen(dest_filename, \"wx\");"
    },
    {
        "line": 7,
        "fullcodeline": "unsigned fd = 0;"
    },
    {
        "line": 34,
        "fullcodeline": "const int dest_fd = fileno(fp);"
    },
    {
        "line": 4,
        "fullcodeline": "if (!fp)"
    },
    {
        "line": 8,
        "fullcodeline": "while (fd <= 99999) /* paranoia check */"
    },
    {
        "line": 10,
        "fullcodeline": "sprintf(source_filename + source_base_ofs, \"fd/%u\", fd);"
    },
    {
        "line": 11,
        "fullcodeline": "char *name = malloc_readlink(source_filename);"
    },
    {
        "line": 14,
        "fullcodeline": "fprintf(fp, \"%u:%s\\n\", fd, name);"
    },
    {
        "line": 17,
        "fullcodeline": "sprintf(source_filename + source_base_ofs, \"fdinfo/%u\", fd);"
    },
    {
        "line": 18,
        "fullcodeline": "fd++;"
    },
    {
        "line": 19,
        "fullcodeline": "FILE *in = fopen(source_filename, \"r\");"
    },
    {
        "line": 35,
        "fullcodeline": "if (fchown(dest_fd, uid, gid) < 0)"
    },
    {
        "line": 37,
        "fullcodeline": "perror_msg(\"Can't change '%s' ownership to %lu:%lu\", dest_filename, (long)uid, (long)gid);"
    },
    {
        "line": 12,
        "fullcodeline": "if (!name)"
    },
    {
        "line": 20,
        "fullcodeline": "if (!in)"
    },
    {
        "line": 22,
        "fullcodeline": "char buf[128];"
    },
    {
        "line": 23,
        "fullcodeline": "while (fgets(buf, sizeof(buf)-1, in))"
    },
    {
        "line": 29,
        "fullcodeline": "fputs(buf, fp);"
    },
    {
        "line": 26,
        "fullcodeline": "char *eol = strchrnul(buf, '\\n');"
    }
]