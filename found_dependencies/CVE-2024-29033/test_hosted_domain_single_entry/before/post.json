[
    {
        "line": 7,
        "fullcodeline": "c = Config()"
    },
    {
        "line": 8,
        "fullcodeline": "c.GoogleOAuthenticator.hosted_domain = [\"In-Hosted-Domain.com\"]"
    },
    {
        "line": 9,
        "fullcodeline": "c.GoogleOAuthenticator.admin_users = {\"user1\"}"
    },
    {
        "line": 10,
        "fullcodeline": "c.GoogleOAuthenticator.allowed_users = {\"user2\"}"
    },
    {
        "line": 11,
        "fullcodeline": "authenticator = GoogleOAuthenticator(config=c)"
    },
    {
        "line": 13,
        "fullcodeline": "handled_user_model = user_model(\"user1@iN-hosteD-domaiN.com\")"
    },
    {
        "line": 14,
        "fullcodeline": "handler = google_client.handler_for_user(handled_user_model)"
    },
    {
        "line": 15,
        "fullcodeline": "auth_model = await authenticator.get_authenticated_user(handler, None)"
    },
    {
        "line": 16,
        "fullcodeline": "assert auth_model"
    },
    {
        "line": 17,
        "fullcodeline": "assert auth_model[\"name\"] == \"user1\""
    },
    {
        "line": 18,
        "fullcodeline": "assert auth_model[\"admin\"] == True"
    },
    {
        "line": 20,
        "fullcodeline": "handled_user_model = user_model(\"user2@iN-hosteD-domaiN.com\")"
    },
    {
        "line": 21,
        "fullcodeline": "handler = google_client.handler_for_user(handled_user_model)"
    },
    {
        "line": 22,
        "fullcodeline": "auth_model = await authenticator.get_authenticated_user(handler, None)"
    },
    {
        "line": 23,
        "fullcodeline": "assert auth_model"
    },
    {
        "line": 24,
        "fullcodeline": "assert auth_model[\"name\"] == \"user2\""
    },
    {
        "line": 25,
        "fullcodeline": "assert auth_model[\"admin\"] == None"
    },
    {
        "line": 27,
        "fullcodeline": "handled_user_model = user_model(\"user1@not-in-hosted-domain.com\")"
    },
    {
        "line": 28,
        "fullcodeline": "handler = google_client.handler_for_user(handled_user_model)"
    },
    {
        "line": 31,
        "fullcodeline": "assert exc.value.status_code == 403"
    },
    {
        "line": 29,
        "fullcodeline": "with raises(HTTPError) as exc:"
    },
    {
        "line": 30,
        "fullcodeline": "await authenticator.get_authenticated_user(handler, None)"
    }
]