[
    {
        "line": 6,
        "fullcodeline": "http_ctx_t *ctx = f->ctx;"
    },
    {
        "line": 11,
        "fullcodeline": "conf = (core_server_config *)"
    },
    {
        "line": 15,
        "fullcodeline": "if (mode != AP_MODE_READBYTES && mode != AP_MODE_GETLINE) {"
    },
    {
        "line": 19,
        "fullcodeline": "if (!ctx) {"
    },
    {
        "line": 12,
        "fullcodeline": "ap_get_module_config(f->r->server->module_config, &core_module);"
    },
    {
        "line": 21,
        "fullcodeline": "f->ctx = ctx = apr_pcalloc(f->r->pool, sizeof(*ctx));"
    },
    {
        "line": 22,
        "fullcodeline": "ctx->state = BODY_NONE;"
    },
    {
        "line": 36,
        "fullcodeline": "tenc = apr_table_get(f->r->headers_in, \"Transfer-Encoding\");"
    },
    {
        "line": 37,
        "fullcodeline": "lenp = apr_table_get(f->r->headers_in, \"Content-Length\");"
    },
    {
        "line": 157,
        "fullcodeline": "e = apr_bucket_eos_create(f->c->bucket_alloc);"
    },
    {
        "line": 163,
        "fullcodeline": "apr_brigade_cleanup(b);"
    },
    {
        "line": 16,
        "fullcodeline": "return ap_get_brigade(f->next, b, mode, block, readbytes);"
    },
    {
        "line": 29,
        "fullcodeline": "if (!f->r->proxyreq) {"
    },
    {
        "line": 30,
        "fullcodeline": "ctx->limit = ap_get_limit_req_body(f->r);"
    },
    {
        "line": 64,
        "fullcodeline": "lenp = NULL;"
    },
    {
        "line": 69,
        "fullcodeline": "ctx->state = BODY_LENGTH;"
    },
    {
        "line": 109,
        "fullcodeline": "if (ctx->state == BODY_NONE && f->r->proxyreq != PROXYREQ_RESPONSE) {"
    },
    {
        "line": 110,
        "fullcodeline": "e = apr_bucket_eos_create(f->c->bucket_alloc);"
    },
    {
        "line": 118,
        "fullcodeline": "if ((ctx->state == BODY_CHUNK"
    },
    {
        "line": 121,
        "fullcodeline": "&& !(f->r->eos_sent || f->r->bytes_sent)) {"
    },
    {
        "line": 33,
        "fullcodeline": "ctx->limit = 0;"
    },
    {
        "line": 88,
        "fullcodeline": "if (ctx->limit && ctx->limit < ctx->remaining) {"
    },
    {
        "line": 120,
        "fullcodeline": "&& f->r->expecting_100 && f->r->proto_num >= HTTP_VERSION(1,1)"
    },
    {
        "line": 173,
        "fullcodeline": "rv = ap_get_brigade(f->next, b, AP_MODE_GETLINE, block, 0);"
    },
    {
        "line": 190,
        "fullcodeline": "e = APR_BRIGADE_FIRST(b);"
    },
    {
        "line": 303,
        "fullcodeline": "rv = ap_get_brigade(f->next, b, mode, block, readbytes);"
    },
    {
        "line": 40,
        "fullcodeline": "if (strcasecmp(tenc, \"chunked\") == 0 /* fast path */"
    },
    {
        "line": 41,
        "fullcodeline": "|| ap_find_last_token(f->r->pool, tenc, \"chunked\")) {"
    },
    {
        "line": 42,
        "fullcodeline": "ctx->state = BODY_CHUNK;"
    },
    {
        "line": 74,
        "fullcodeline": "if (apr_strtoff(&ctx->remaining, lenp, &endstr, 10)"
    },
    {
        "line": 75,
        "fullcodeline": "|| endstr == lenp || *endstr || ctx->remaining < 0) {"
    },
    {
        "line": 122,
        "fullcodeline": "if (!ap_is_HTTP_SUCCESS(f->r->status)) {"
    },
    {
        "line": 123,
        "fullcodeline": "ctx->state = BODY_NONE;"
    },
    {
        "line": 124,
        "fullcodeline": "ctx->eos_sent = 1;"
    },
    {
        "line": 176,
        "fullcodeline": "if (block == APR_NONBLOCK_READ"
    },
    {
        "line": 182,
        "fullcodeline": "if (rv == APR_EOF) {"
    },
    {
        "line": 186,
        "fullcodeline": "if (rv != APR_SUCCESS) {"
    },
    {
        "line": 191,
        "fullcodeline": "while (e != APR_BRIGADE_SENTINEL(b)) {"
    },
    {
        "line": 214,
        "fullcodeline": "if (ctx->state == BODY_CHUNK_TRAILER) {"
    },
    {
        "line": 228,
        "fullcodeline": "if (ctx->state != BODY_NONE && ctx->remaining < readbytes) {"
    },
    {
        "line": 231,
        "fullcodeline": "if (readbytes > 0) {"
    },
    {
        "line": 306,
        "fullcodeline": "if (block == APR_NONBLOCK_READ"
    },
    {
        "line": 312,
        "fullcodeline": "if (rv != APR_SUCCESS) {"
    },
    {
        "line": 119,
        "fullcodeline": "|| (ctx->state == BODY_LENGTH && ctx->remaining > 0))"
    },
    {
        "line": 131,
        "fullcodeline": "bb = apr_brigade_create(f->r->pool, f->c->bucket_alloc);"
    },
    {
        "line": 139,
        "fullcodeline": "len = strlen(tmp);"
    },
    {
        "line": 140,
        "fullcodeline": "ap_xlate_proto_to_ascii(tmp, len);"
    },
    {
        "line": 141,
        "fullcodeline": "e = apr_bucket_pool_create(tmp, len, f->r->pool,"
    },
    {
        "line": 143,
        "fullcodeline": "APR_BRIGADE_INSERT_HEAD(bb, e);"
    },
    {
        "line": 144,
        "fullcodeline": "e = apr_bucket_flush_create(f->c->bucket_alloc);"
    },
    {
        "line": 145,
        "fullcodeline": "APR_BRIGADE_INSERT_TAIL(bb, e);"
    },
    {
        "line": 147,
        "fullcodeline": "rv = ap_pass_brigade(f->c->output_filters, bb);"
    },
    {
        "line": 177,
        "fullcodeline": "&& ((rv == APR_SUCCESS && APR_BRIGADE_EMPTY(b))"
    },
    {
        "line": 210,
        "fullcodeline": "e = APR_BRIGADE_FIRST(b);"
    },
    {
        "line": 216,
        "fullcodeline": "int merge_trailers ="
    },
    {
        "line": 229,
        "fullcodeline": "readbytes = ctx->remaining;"
    },
    {
        "line": 233,
        "fullcodeline": "rv = ap_get_brigade(f->next, b, mode, block, readbytes);"
    },
    {
        "line": 252,
        "fullcodeline": "apr_brigade_length(b, 0, &totalread);"
    },
    {
        "line": 279,
        "fullcodeline": "if (ctx->state == BODY_LENGTH && ctx->remaining == 0) {"
    },
    {
        "line": 280,
        "fullcodeline": "e = apr_bucket_eos_create(f->c->bucket_alloc);"
    },
    {
        "line": 281,
        "fullcodeline": "APR_BRIGADE_INSERT_TAIL(b, e);"
    },
    {
        "line": 282,
        "fullcodeline": "ctx->eos_sent = 1;"
    },
    {
        "line": 290,
        "fullcodeline": "ctx->limit_used += totalread;"
    },
    {
        "line": 307,
        "fullcodeline": "&& ((rv == APR_SUCCESS && APR_BRIGADE_EMPTY(b))"
    },
    {
        "line": 44,
        "fullcodeline": "else if (f->r->proxyreq == PROXYREQ_RESPONSE) {"
    },
    {
        "line": 148,
        "fullcodeline": "if (rv != APR_SUCCESS) {"
    },
    {
        "line": 178,
        "fullcodeline": "|| (APR_STATUS_IS_EAGAIN(rv)))) {"
    },
    {
        "line": 217,
        "fullcodeline": "conf->merge_trailers == AP_MERGE_TRAILERS_ENABLE;"
    },
    {
        "line": 218,
        "fullcodeline": "return read_chunked_trailers(ctx, f, b, merge_trailers);"
    },
    {
        "line": 247,
        "fullcodeline": "if (rv != APR_SUCCESS) {"
    },
    {
        "line": 256,
        "fullcodeline": "AP_DEBUG_ASSERT(totalread >= 0);"
    },
    {
        "line": 258,
        "fullcodeline": "if (ctx->state != BODY_NONE) {"
    },
    {
        "line": 291,
        "fullcodeline": "if (ctx->limit < ctx->limit_used) {"
    },
    {
        "line": 308,
        "fullcodeline": "|| (APR_STATUS_IS_EAGAIN(rv)))) {"
    },
    {
        "line": 195,
        "fullcodeline": "if (!APR_BUCKET_IS_METADATA(e)) {"
    },
    {
        "line": 196,
        "fullcodeline": "rv = apr_bucket_read(e, &buffer, &len, APR_BLOCK_READ);"
    },
    {
        "line": 236,
        "fullcodeline": "if (block == APR_NONBLOCK_READ"
    },
    {
        "line": 237,
        "fullcodeline": "&& ((rv == APR_SUCCESS && APR_BRIGADE_EMPTY(b))"
    },
    {
        "line": 242,
        "fullcodeline": "if (rv == APR_EOF && ctx->state != BODY_NONE"
    },
    {
        "line": 243,
        "fullcodeline": "&& ctx->remaining > 0) {"
    },
    {
        "line": 259,
        "fullcodeline": "ctx->remaining -= totalread;"
    },
    {
        "line": 198,
        "fullcodeline": "if (rv == APR_SUCCESS) {"
    },
    {
        "line": 202,
        "fullcodeline": "if (rv != APR_SUCCESS) {"
    },
    {
        "line": 238,
        "fullcodeline": "|| (APR_STATUS_IS_EAGAIN(rv)))) {"
    },
    {
        "line": 260,
        "fullcodeline": "if (ctx->remaining > 0) {"
    },
    {
        "line": 199,
        "fullcodeline": "rv = parse_chunk_size(ctx, buffer, len,"
    },
    {
        "line": 261,
        "fullcodeline": "e = APR_BRIGADE_LAST(b);"
    },
    {
        "line": 262,
        "fullcodeline": "if (APR_BUCKET_IS_EOS(e)) {"
    },
    {
        "line": 267,
        "fullcodeline": "else if (ctx->state == BODY_CHUNK_DATA) {"
    },
    {
        "line": 269,
        "fullcodeline": "ctx->state = BODY_CHUNK_END;"
    },
    {
        "line": 270,
        "fullcodeline": "ctx->chunk_used = 0;"
    }
]