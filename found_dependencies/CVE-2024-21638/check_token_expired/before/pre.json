[
    {
        "line": 2,
        "fullcodeline": "now = int(time.time()) + 10"
    },
    {
        "line": 3,
        "fullcodeline": "auth = request.headers.get('authorization')"
    },
    {
        "line": 8,
        "fullcodeline": "user_assertion=auth.split(' ')[1]"
    },
    {
        "line": 18,
        "fullcodeline": "request.state.tenant_id = decoded['tid']"
    },
    {
        "line": 20,
        "fullcodeline": "await check_admin(request, decoded['oid'], decoded['tid'])"
    },
    {
        "line": 5,
        "fullcodeline": "if not auth:"
    },
    {
        "line": 15,
        "fullcodeline": "if(now >= int(decoded['exp'])):"
    },
    {
        "line": 6,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Authorization header missing.\")"
    },
    {
        "line": 11,
        "fullcodeline": "decoded = jwt.decode(user_assertion, options={\"verify_signature\": False})"
    },
    {
        "line": 16,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Token has expired.\")"
    },
    {
        "line": 13,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Authorization token missing or invalid in header.\")"
    }
]