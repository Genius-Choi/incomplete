[
    {
        "line": 2,
        "fullcodeline": "auth = request.headers.get(\"Authorization\", None)"
    },
    {
        "line": 7,
        "fullcodeline": "parts = auth.split()"
    },
    {
        "line": 16,
        "fullcodeline": "token = parts[1]"
    },
    {
        "line": 4,
        "fullcodeline": "if not auth:"
    },
    {
        "line": 9,
        "fullcodeline": "if parts[0].lower() != \"bearer\":"
    },
    {
        "line": 5,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Authorization header is missing.\")"
    },
    {
        "line": 10,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Authorization header must start with 'Bearer'.\")"
    },
    {
        "line": 11,
        "fullcodeline": "elif len(parts) == 1:"
    },
    {
        "line": 12,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Token not found.\")"
    },
    {
        "line": 13,
        "fullcodeline": "elif len(parts) > 2:"
    },
    {
        "line": 14,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Authorization header must be of type Bearer token.\")"
    }
]