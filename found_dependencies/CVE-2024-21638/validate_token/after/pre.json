[
    {
        "line": 48,
        "fullcodeline": "request.state.tenant_id = payload['tid']"
    },
    {
        "line": 3,
        "fullcodeline": "token = await get_token_auth_header(request)"
    },
    {
        "line": 4,
        "fullcodeline": "jwks = await fetch_jwks_keys()"
    },
    {
        "line": 5,
        "fullcodeline": "unverified_header = jwt.get_unverified_header(token)"
    },
    {
        "line": 7,
        "fullcodeline": "rsa_key = {}"
    },
    {
        "line": 22,
        "fullcodeline": "rsa_pem_key = jwt.algorithms.RSAAlgorithm.from_jwk(json.dumps(rsa_key))"
    },
    {
        "line": 23,
        "fullcodeline": "rsa_pem_key_bytes = rsa_pem_key.public_bytes("
    },
    {
        "line": 46,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Unable to find appropriate signing key.\")"
    },
    {
        "line": 9,
        "fullcodeline": "for key in jwks[\"keys\"]:"
    },
    {
        "line": 19,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Unable to parse authorization token.\")"
    },
    {
        "line": 29,
        "fullcodeline": "payload = jwt.decode("
    },
    {
        "line": 10,
        "fullcodeline": "if key[\"kid\"] == unverified_header[\"kid\"]:"
    },
    {
        "line": 33,
        "fullcodeline": "algorithms=[\"RS256\"],"
    },
    {
        "line": 35,
        "fullcodeline": "issuer=\"https://\" + globals.AUTHORITY_HOST + \"/\" + globals.TENANT_ID + \"/v2.0\""
    },
    {
        "line": 38,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Token has expired.\")"
    },
    {
        "line": 40,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Incorrect token claims, please check the audience and issuer.\")"
    },
    {
        "line": 42,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Invalid token signature.\")"
    },
    {
        "line": 44,
        "fullcodeline": "raise HTTPException(status_code=401, detail=\"Unable to parse authorization token.\")"
    },
    {
        "line": 11,
        "fullcodeline": "rsa_key = {"
    }
]