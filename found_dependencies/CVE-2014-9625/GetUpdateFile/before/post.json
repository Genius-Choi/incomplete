[
    {
        "line": 3,
        "fullcodeline": "stream_t *p_stream = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "char *psz_version_line = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "char *psz_update_data = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "p_stream = stream_UrlNew( p_update->p_libvlc, UPDATE_VLC_STATUS_URL );"
    },
    {
        "line": 15,
        "fullcodeline": "const int64_t i_read = stream_Size( p_stream );"
    },
    {
        "line": 16,
        "fullcodeline": "psz_update_data = malloc( i_read + 1 ); /* terminating '\\0' */"
    },
    {
        "line": 26,
        "fullcodeline": "psz_update_data[i_read] = '\\0';"
    },
    {
        "line": 28,
        "fullcodeline": "stream_Delete( p_stream );"
    },
    {
        "line": 29,
        "fullcodeline": "p_stream = NULL;"
    },
    {
        "line": 32,
        "fullcodeline": "char *psz_update_data_parser = psz_update_data;"
    },
    {
        "line": 33,
        "fullcodeline": "size_t i_len = strcspn( psz_update_data, \"\\r\\n\" );"
    },
    {
        "line": 34,
        "fullcodeline": "psz_update_data_parser += i_len;"
    },
    {
        "line": 40,
        "fullcodeline": "strncpy( psz_version_line, psz_update_data, i_len );"
    },
    {
        "line": 41,
        "fullcodeline": "psz_version_line[i_len] = '\\0';"
    },
    {
        "line": 43,
        "fullcodeline": "p_update->release.i_extra = 0;"
    },
    {
        "line": 44,
        "fullcodeline": "int ret = sscanf( psz_version_line, \"%i.%i.%i.%i\","
    },
    {
        "line": 54,
        "fullcodeline": "i_len = strcspn( psz_update_data_parser, \"\\r\\n\" );"
    },
    {
        "line": 65,
        "fullcodeline": "strncpy( p_update->release.psz_url, psz_update_data_parser, i_len );"
    },
    {
        "line": 66,
        "fullcodeline": "p_update->release.psz_url[i_len] = '\\0';"
    },
    {
        "line": 68,
        "fullcodeline": "psz_update_data_parser += i_len;"
    },
    {
        "line": 73,
        "fullcodeline": "i_len = strlen( psz_update_data_parser );"
    },
    {
        "line": 84,
        "fullcodeline": "strncpy( p_update->release.psz_desc, psz_update_data_parser, i_len );"
    },
    {
        "line": 85,
        "fullcodeline": "p_update->release.psz_desc[i_len] = '\\0';"
    },
    {
        "line": 115,
        "fullcodeline": "memcpy( p_update->p_pkey->longid, videolan_public_key_longid, 8 );"
    },
    {
        "line": 155,
        "fullcodeline": "uint8_t *p_hash = hash_from_text( psz_update_data, &sign );"
    },
    {
        "line": 190,
        "fullcodeline": "free( psz_version_line );"
    },
    {
        "line": 191,
        "fullcodeline": "free( psz_update_data );"
    },
    {
        "line": 8,
        "fullcodeline": "if( !p_stream )"
    },
    {
        "line": 17,
        "fullcodeline": "if( !psz_update_data )"
    },
    {
        "line": 20,
        "fullcodeline": "if( stream_Read( p_stream, psz_update_data, i_read ) != i_read )"
    },
    {
        "line": 35,
        "fullcodeline": "while( *psz_update_data_parser == '\\r' || *psz_update_data_parser == '\\n' )"
    },
    {
        "line": 36,
        "fullcodeline": "psz_update_data_parser++;"
    },
    {
        "line": 38,
        "fullcodeline": "if( !(psz_version_line = malloc( i_len + 1)) )"
    },
    {
        "line": 47,
        "fullcodeline": "if( ret != 3 && ret != 4 )"
    },
    {
        "line": 55,
        "fullcodeline": "if( i_len == 0 )"
    },
    {
        "line": 63,
        "fullcodeline": "if( !(p_update->release.psz_url = malloc( i_len + 1)) )"
    },
    {
        "line": 69,
        "fullcodeline": "while( *psz_update_data_parser == '\\r' || *psz_update_data_parser == '\\n' )"
    },
    {
        "line": 70,
        "fullcodeline": "psz_update_data_parser++;"
    },
    {
        "line": 74,
        "fullcodeline": "if( i_len == 0 )"
    },
    {
        "line": 82,
        "fullcodeline": "if( !(p_update->release.psz_desc = malloc( i_len + 1)) )"
    },
    {
        "line": 90,
        "fullcodeline": "if( download_signature( VLC_OBJECT( p_update->p_libvlc ), &sign,"
    },
    {
        "line": 97,
        "fullcodeline": "if( sign.type != BINARY_SIGNATURE && sign.type != TEXT_SIGNATURE )"
    },
    {
        "line": 104,
        "fullcodeline": "if( !p_update->p_pkey )"
    },
    {
        "line": 107,
        "fullcodeline": "if( parse_public_key( videolan_public_key, sizeof( videolan_public_key ),"
    },
    {
        "line": 117,
        "fullcodeline": "if( memcmp( sign.issuer_longid, p_update->p_pkey->longid , 8 ) != 0 )"
    },
    {
        "line": 156,
        "fullcodeline": "if( !p_hash )"
    },
    {
        "line": 10,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Failed to open %s for reading\","
    },
    {
        "line": 22,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Couldn't download update file %s\","
    },
    {
        "line": 49,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Update version false formated\" );"
    },
    {
        "line": 57,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Update file %s is corrupted: URL missing\","
    },
    {
        "line": 76,
        "fullcodeline": "msg_Err( p_update->p_libvlc,"
    },
    {
        "line": 93,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Couldn't download signature of status file\" );"
    },
    {
        "line": 99,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Invalid signature type\" );"
    },
    {
        "line": 110,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Couldn't parse embedded public key, something went really wrong...\" );"
    },
    {
        "line": 111,
        "fullcodeline": "FREENULL( p_update->p_pkey );"
    },
    {
        "line": 119,
        "fullcodeline": "msg_Dbg( p_update->p_libvlc, \"Need to download the GPG key\" );"
    },
    {
        "line": 120,
        "fullcodeline": "public_key_t *p_new_pkey = download_key("
    },
    {
        "line": 130,
        "fullcodeline": "uint8_t *p_hash = hash_from_public_key( p_new_pkey );"
    },
    {
        "line": 158,
        "fullcodeline": "msg_Warn( p_update->p_libvlc, \"Can't compute hash for status file\" );"
    },
    {
        "line": 189,
        "fullcodeline": "stream_Delete( p_stream );"
    },
    {
        "line": 123,
        "fullcodeline": "if( !p_new_pkey )"
    },
    {
        "line": 131,
        "fullcodeline": "if( !p_hash )"
    },
    {
        "line": 139,
        "fullcodeline": "if( verify_signature( &p_new_pkey->sig,"
    },
    {
        "line": 121,
        "fullcodeline": "VLC_OBJECT(p_update->p_libvlc),"
    },
    {
        "line": 125,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Couldn't download GPG key\" );"
    },
    {
        "line": 126,
        "fullcodeline": "FREENULL( p_update->p_pkey );"
    },
    {
        "line": 133,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Failed to hash signature\" );"
    },
    {
        "line": 134,
        "fullcodeline": "free( p_new_pkey );"
    },
    {
        "line": 135,
        "fullcodeline": "FREENULL( p_update->p_pkey );"
    },
    {
        "line": 142,
        "fullcodeline": "free( p_hash );"
    },
    {
        "line": 143,
        "fullcodeline": "msg_Info( p_update->p_libvlc, \"Key authenticated\" );"
    },
    {
        "line": 144,
        "fullcodeline": "free( p_update->p_pkey );"
    },
    {
        "line": 145,
        "fullcodeline": "p_update->p_pkey = p_new_pkey;"
    },
    {
        "line": 162,
        "fullcodeline": "else if( p_hash[0] != sign.hash_verification[0] ||"
    },
    {
        "line": 149,
        "fullcodeline": "free( p_hash );"
    },
    {
        "line": 150,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"Key signature invalid !\" );"
    },
    {
        "line": 163,
        "fullcodeline": "p_hash[1] != sign.hash_verification[1] )"
    },
    {
        "line": 165,
        "fullcodeline": "msg_Warn( p_update->p_libvlc, \"Bad hash for status file\" );"
    },
    {
        "line": 166,
        "fullcodeline": "free( p_hash );"
    },
    {
        "line": 170,
        "fullcodeline": "else if( verify_signature( &sign, &p_update->p_pkey->key, p_hash )"
    },
    {
        "line": 173,
        "fullcodeline": "msg_Err( p_update->p_libvlc, \"BAD SIGNATURE for status file\" );"
    },
    {
        "line": 174,
        "fullcodeline": "free( p_hash );"
    },
    {
        "line": 180,
        "fullcodeline": "msg_Info( p_update->p_libvlc, \"Status file authenticated\" );"
    },
    {
        "line": 181,
        "fullcodeline": "free( p_hash );"
    },
    {
        "line": 182,
        "fullcodeline": "free( psz_version_line );"
    },
    {
        "line": 183,
        "fullcodeline": "free( psz_update_data );"
    }
]