[
    {
        "line": 3,
        "fullcodeline": "struct session_state *state = ssh->state;"
    },
    {
        "line": 39,
        "fullcodeline": "slen = cipher_get_keycontext(state->send_context, NULL);"
    },
    {
        "line": 40,
        "fullcodeline": "rlen = cipher_get_keycontext(state->receive_context, NULL);"
    },
    {
        "line": 8,
        "fullcodeline": "if (!compat20) {"
    },
    {
        "line": 41,
        "fullcodeline": "if ((r = sshbuf_put_u32(m, slen)) != 0 ||"
    },
    {
        "line": 44,
        "fullcodeline": "if (cipher_get_keycontext(state->send_context, p) != (int)slen)"
    },
    {
        "line": 46,
        "fullcodeline": "if ((r = sshbuf_put_u32(m, rlen)) != 0 ||"
    },
    {
        "line": 49,
        "fullcodeline": "if (cipher_get_keycontext(state->receive_context, p) != (int)rlen)"
    },
    {
        "line": 52,
        "fullcodeline": "if ((r = ssh_packet_get_compress_state(m, ssh)) != 0 ||"
    },
    {
        "line": 9,
        "fullcodeline": "ssh1cipher = cipher_ctx_get_number(state->receive_context);"
    },
    {
        "line": 10,
        "fullcodeline": "slen = cipher_get_keyiv_len(state->send_context);"
    },
    {
        "line": 11,
        "fullcodeline": "rlen = cipher_get_keyiv_len(state->receive_context);"
    },
    {
        "line": 42,
        "fullcodeline": "(r = sshbuf_reserve(m, slen, &p)) != 0)"
    },
    {
        "line": 47,
        "fullcodeline": "(r = sshbuf_reserve(m, rlen, &p)) != 0)"
    },
    {
        "line": 54,
        "fullcodeline": "(r = sshbuf_put_stringb(m, state->output)) != 0)"
    },
    {
        "line": 12,
        "fullcodeline": "if ((r = sshbuf_put_u32(m, state->remote_protocol_flags)) != 0 ||"
    },
    {
        "line": 53,
        "fullcodeline": "(r = sshbuf_put_stringb(m, state->input)) != 0 ||"
    },
    {
        "line": 20,
        "fullcodeline": "(r = cipher_get_keyiv(state->receive_context, p, rlen)) != 0)"
    },
    {
        "line": 23,
        "fullcodeline": "if ((r = kex_to_blob(m, ssh->kex)) != 0 ||"
    },
    {
        "line": 19,
        "fullcodeline": "(r = sshbuf_reserve(m, rlen, &p)) != 0 ||"
    },
    {
        "line": 35,
        "fullcodeline": "(r = sshbuf_put_u64(m, state->p_read.bytes)) != 0)"
    },
    {
        "line": 18,
        "fullcodeline": "(r = sshbuf_put_u32(m, rlen)) != 0 ||"
    },
    {
        "line": 34,
        "fullcodeline": "(r = sshbuf_put_u32(m, state->p_read.packets)) != 0 ||"
    },
    {
        "line": 17,
        "fullcodeline": "(r = cipher_get_keyiv(state->send_context, p, slen)) != 0 ||"
    },
    {
        "line": 33,
        "fullcodeline": "(r = sshbuf_put_u64(m, state->p_read.blocks)) != 0 ||"
    },
    {
        "line": 16,
        "fullcodeline": "(r = sshbuf_reserve(m, slen, &p)) != 0 ||"
    },
    {
        "line": 32,
        "fullcodeline": "(r = sshbuf_put_u32(m, state->p_read.seqnr)) != 0 ||"
    },
    {
        "line": 15,
        "fullcodeline": "(r = sshbuf_put_u32(m, slen)) != 0 ||"
    },
    {
        "line": 31,
        "fullcodeline": "(r = sshbuf_put_u64(m, state->p_send.bytes)) != 0 ||"
    },
    {
        "line": 14,
        "fullcodeline": "(r = sshbuf_put_string(m, state->ssh1_key, state->ssh1_keylen)) != 0 ||"
    },
    {
        "line": 30,
        "fullcodeline": "(r = sshbuf_put_u32(m, state->p_send.packets)) != 0 ||"
    },
    {
        "line": 13,
        "fullcodeline": "(r = sshbuf_put_u32(m, ssh1cipher)) != 0 ||"
    },
    {
        "line": 29,
        "fullcodeline": "(r = sshbuf_put_u64(m, state->p_send.blocks)) != 0 ||"
    },
    {
        "line": 28,
        "fullcodeline": "(r = sshbuf_put_u32(m, state->p_send.seqnr)) != 0 ||"
    },
    {
        "line": 27,
        "fullcodeline": "(r = sshbuf_put_u32(m, state->rekey_interval)) != 0 ||"
    },
    {
        "line": 26,
        "fullcodeline": "(r = sshbuf_put_u64(m, state->rekey_limit)) != 0 ||"
    },
    {
        "line": 25,
        "fullcodeline": "(r = newkeys_to_blob(m, ssh, MODE_IN)) != 0 ||"
    },
    {
        "line": 24,
        "fullcodeline": "(r = newkeys_to_blob(m, ssh, MODE_OUT)) != 0 ||"
    }
]