[
    {
        "line": 5,
        "fullcodeline": "char *address = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "uint16_t port = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "or_circuit_t *or_circ = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "origin_circuit_t *origin_circ = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "crypt_path_t *layer_hint = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "const or_options_t *options = get_options();"
    },
    {
        "line": 13,
        "fullcodeline": "uint8_t end_reason=0;"
    },
    {
        "line": 15,
        "fullcodeline": "assert_circuit_ok(circ);"
    },
    {
        "line": 24,
        "fullcodeline": "relay_header_unpack(&rh, cell->payload);"
    },
    {
        "line": 42,
        "fullcodeline": "rv = begin_cell_parse(cell, &bcell, &end_reason);"
    },
    {
        "line": 117,
        "fullcodeline": "log_debug(LD_EXIT,\"Creating new exit connection.\");"
    },
    {
        "line": 120,
        "fullcodeline": "n_stream = edge_connection_new(CONN_TYPE_EXIT, AF_INET);"
    },
    {
        "line": 124,
        "fullcodeline": "n_stream->dirreq_id = circ->dirreq_id;"
    },
    {
        "line": 126,
        "fullcodeline": "n_stream->base_.purpose = EXIT_PURPOSE_CONNECT;"
    },
    {
        "line": 127,
        "fullcodeline": "n_stream->begincell_flags = bcell.flags;"
    },
    {
        "line": 128,
        "fullcodeline": "n_stream->stream_id = rh.stream_id;"
    },
    {
        "line": 129,
        "fullcodeline": "n_stream->base_.port = port;"
    },
    {
        "line": 131,
        "fullcodeline": "n_stream->package_window = STREAMWINDOW_START;"
    },
    {
        "line": 132,
        "fullcodeline": "n_stream->deliver_window = STREAMWINDOW_START;"
    },
    {
        "line": 188,
        "fullcodeline": "tor_strlower(address);"
    },
    {
        "line": 189,
        "fullcodeline": "n_stream->base_.address = address;"
    },
    {
        "line": 190,
        "fullcodeline": "n_stream->base_.state = EXIT_CONN_STATE_RESOLVEFAILED;"
    },
    {
        "line": 200,
        "fullcodeline": "n_stream->on_circuit = circ;"
    },
    {
        "line": 212,
        "fullcodeline": "log_debug(LD_EXIT,\"about to start the dns_resolve().\");"
    },
    {
        "line": 16,
        "fullcodeline": "if (!CIRCUIT_IS_ORIGIN(circ)) {"
    },
    {
        "line": 25,
        "fullcodeline": "if (rh.length > RELAY_PAYLOAD_SIZE)"
    },
    {
        "line": 33,
        "fullcodeline": "if (!server_mode(options) &&"
    },
    {
        "line": 43,
        "fullcodeline": "if (rv < -1) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (! bcell.is_begindir) {"
    },
    {
        "line": 105,
        "fullcodeline": "if (! options->IPv6Exit) {"
    },
    {
        "line": 134,
        "fullcodeline": "if (circ->purpose == CIRCUIT_PURPOSE_S_REND_JOINED) {"
    },
    {
        "line": 193,
        "fullcodeline": "if (we_are_hibernating()) {"
    },
    {
        "line": 202,
        "fullcodeline": "if (rh.command == RELAY_COMMAND_BEGIN_DIR) {"
    },
    {
        "line": 215,
        "fullcodeline": "switch (dns_resolve(n_stream)) {"
    },
    {
        "line": 17,
        "fullcodeline": "or_circ = TO_OR_CIRCUIT(circ);"
    },
    {
        "line": 34,
        "fullcodeline": "circ->purpose != CIRCUIT_PURPOSE_S_REND_JOINED) {"
    },
    {
        "line": 35,
        "fullcodeline": "log_fn(LOG_PROTOCOL_WARN, LD_PROTOCOL,"
    },
    {
        "line": 37,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ,"
    },
    {
        "line": 53,
        "fullcodeline": "address = bcell.address;"
    },
    {
        "line": 54,
        "fullcodeline": "port = bcell.port;"
    },
    {
        "line": 107,
        "fullcodeline": "bcell.flags &= ~BEGIN_FLAG_IPV6_PREFERRED;"
    },
    {
        "line": 135,
        "fullcodeline": "tor_assert(origin_circ);"
    },
    {
        "line": 136,
        "fullcodeline": "log_info(LD_REND,\"begin is for rendezvous. configuring stream.\");"
    },
    {
        "line": 137,
        "fullcodeline": "n_stream->base_.address = tor_strdup(\"(rendezvous)\");"
    },
    {
        "line": 138,
        "fullcodeline": "n_stream->base_.state = EXIT_CONN_STATE_CONNECTING;"
    },
    {
        "line": 139,
        "fullcodeline": "n_stream->rend_data = rend_data_dup(origin_circ->rend_data);"
    },
    {
        "line": 140,
        "fullcodeline": "tor_assert(connection_edge_is_rendezvous_stream(n_stream));"
    },
    {
        "line": 141,
        "fullcodeline": "assert_circuit_ok(circ);"
    },
    {
        "line": 143,
        "fullcodeline": "const int r = rend_service_set_connection_addr_port(n_stream, origin_circ);"
    },
    {
        "line": 168,
        "fullcodeline": "assert_circuit_ok(circ);"
    },
    {
        "line": 169,
        "fullcodeline": "log_debug(LD_REND,\"Finished assigning addr/port\");"
    },
    {
        "line": 173,
        "fullcodeline": "n_stream->next_stream = origin_circ->p_streams;"
    },
    {
        "line": 174,
        "fullcodeline": "n_stream->on_circuit = circ;"
    },
    {
        "line": 175,
        "fullcodeline": "origin_circ->p_streams = n_stream;"
    },
    {
        "line": 176,
        "fullcodeline": "assert_circuit_ok(circ);"
    },
    {
        "line": 180,
        "fullcodeline": "connection_exit_connect(n_stream);"
    },
    {
        "line": 183,
        "fullcodeline": "pathbias_mark_use_success(origin_circ);"
    },
    {
        "line": 185,
        "fullcodeline": "tor_free(address);"
    },
    {
        "line": 194,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ,"
    },
    {
        "line": 196,
        "fullcodeline": "connection_free(TO_CONN(n_stream));"
    },
    {
        "line": 204,
        "fullcodeline": "tor_assert(or_circ);"
    },
    {
        "line": 217,
        "fullcodeline": "assert_circuit_ok(circ);"
    },
    {
        "line": 218,
        "fullcodeline": "log_debug(LD_EXIT,\"about to call connection_exit_connect().\");"
    },
    {
        "line": 219,
        "fullcodeline": "connection_exit_connect(n_stream);"
    },
    {
        "line": 221,
        "fullcodeline": "case -1: /* resolve failed */"
    },
    {
        "line": 222,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ,"
    },
    {
        "line": 227,
        "fullcodeline": "assert_circuit_ok(circ);"
    },
    {
        "line": 19,
        "fullcodeline": "tor_assert(circ->purpose == CIRCUIT_PURPOSE_S_REND_JOINED);"
    },
    {
        "line": 20,
        "fullcodeline": "origin_circ = TO_ORIGIN_CIRCUIT(circ);"
    },
    {
        "line": 26,
        "fullcodeline": "return -END_CIRC_REASON_TORPROTOCOL;"
    },
    {
        "line": 44,
        "fullcodeline": "return -END_CIRC_REASON_TORPROTOCOL;"
    },
    {
        "line": 56,
        "fullcodeline": "if (or_circ && or_circ->p_chan) {"
    },
    {
        "line": 109,
        "fullcodeline": "if (bcell.flags & BEGIN_FLAG_IPV4_NOT_OK) {"
    },
    {
        "line": 144,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 205,
        "fullcodeline": "if (or_circ->p_chan &&"
    },
    {
        "line": 209,
        "fullcodeline": "return connection_exit_connect_dir(n_stream);"
    },
    {
        "line": 45,
        "fullcodeline": "} else if (rv == -1) {"
    },
    {
        "line": 80,
        "fullcodeline": "} else if (rh.command == RELAY_COMMAND_BEGIN_DIR) {"
    },
    {
        "line": 110,
        "fullcodeline": "tor_free(address);"
    },
    {
        "line": 111,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ,"
    },
    {
        "line": 145,
        "fullcodeline": "log_info(LD_REND,\"Didn't find rendezvous service (port %d)\","
    },
    {
        "line": 153,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ,"
    },
    {
        "line": 156,
        "fullcodeline": "connection_free(TO_CONN(n_stream));"
    },
    {
        "line": 157,
        "fullcodeline": "tor_free(address);"
    },
    {
        "line": 206,
        "fullcodeline": "channel_get_addr_if_possible(or_circ->p_chan, &tmp_addr)) {"
    },
    {
        "line": 207,
        "fullcodeline": "tor_addr_copy(&n_stream->base_.addr, &tmp_addr);"
    },
    {
        "line": 46,
        "fullcodeline": "tor_free(bcell.address);"
    },
    {
        "line": 47,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ, end_reason, layer_hint);"
    },
    {
        "line": 57,
        "fullcodeline": "if (!options->AllowSingleHopExits &&"
    },
    {
        "line": 95,
        "fullcodeline": "port = 1; /* XXXX This value is never actually used anywhere, and there"
    },
    {
        "line": 163,
        "fullcodeline": "if (r < -1)"
    },
    {
        "line": 58,
        "fullcodeline": "(or_circ->is_first_hop ||"
    },
    {
        "line": 66,
        "fullcodeline": "log_fn(LOG_PROTOCOL_WARN, LD_PROTOCOL,"
    },
    {
        "line": 71,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ,"
    },
    {
        "line": 76,
        "fullcodeline": "tor_free(address);"
    },
    {
        "line": 81,
        "fullcodeline": "if (!directory_permits_begindir_requests(options) ||"
    },
    {
        "line": 91,
        "fullcodeline": "if (or_circ && or_circ->p_chan)"
    },
    {
        "line": 99,
        "fullcodeline": "log_warn(LD_BUG, \"Got an unexpected command %d\", (int)rh.command);"
    },
    {
        "line": 100,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ,"
    },
    {
        "line": 59,
        "fullcodeline": "(!connection_or_digest_is_known_relay("
    },
    {
        "line": 68,
        "fullcodeline": "safe_str(channel_get_canonical_remote_descr(or_circ->p_chan)),"
    },
    {
        "line": 69,
        "fullcodeline": "or_circ->is_first_hop ? \"on first hop of circuit\" :"
    },
    {
        "line": 72,
        "fullcodeline": "or_circ->is_first_hop ?"
    },
    {
        "line": 82,
        "fullcodeline": "circ->purpose != CIRCUIT_PURPOSE_OR) {"
    },
    {
        "line": 83,
        "fullcodeline": "relay_send_end_cell_from_edge(rh.stream_id, circ,"
    },
    {
        "line": 92,
        "fullcodeline": "address = tor_strdup(channel_get_actual_remote_address(or_circ->p_chan));"
    },
    {
        "line": 61,
        "fullcodeline": "should_refuse_unknown_exits(options)))) {"
    },
    {
        "line": 94,
        "fullcodeline": "address = tor_strdup(\"127.0.0.1\");"
    }
]