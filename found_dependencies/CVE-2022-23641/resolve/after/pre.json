[
    {
        "line": 31,
        "fullcodeline": "headers = request_headers"
    },
    {
        "line": 32,
        "fullcodeline": "middlewares = Excon.defaults[:middlewares]"
    },
    {
        "line": 36,
        "fullcodeline": "response_body = +\"\""
    },
    {
        "line": 37,
        "fullcodeline": "request_validator = lambda do |chunk, _remaining_bytes, _total_bytes|"
    },
    {
        "line": 43,
        "fullcodeline": "response = Excon.public_send(@http_verb,"
    },
    {
        "line": 52,
        "fullcodeline": "location = nil"
    },
    {
        "line": 53,
        "fullcodeline": "response_headers = nil"
    },
    {
        "line": 54,
        "fullcodeline": "response_status = response.status.to_i"
    },
    {
        "line": 135,
        "fullcodeline": "@status = :failure"
    },
    {
        "line": 136,
        "fullcodeline": "@status_code = response.status"
    },
    {
        "line": 2,
        "fullcodeline": "if @uri && @uri.port == 80 && FinalDestination.is_https_domain?(@uri.hostname)"
    },
    {
        "line": 7,
        "fullcodeline": "if @limit < 0"
    },
    {
        "line": 13,
        "fullcodeline": "unless validate_uri"
    },
    {
        "line": 33,
        "fullcodeline": "middlewares << Excon::Middleware::Decompress if @http_verb == :get"
    },
    {
        "line": 56,
        "fullcodeline": "case response.status"
    },
    {
        "line": 98,
        "fullcodeline": "unless response_headers"
    },
    {
        "line": 109,
        "fullcodeline": "if cookies = response_headers[:cookies]"
    },
    {
        "line": 3,
        "fullcodeline": "@uri.scheme = \"https\""
    },
    {
        "line": 4,
        "fullcodeline": "@uri = URI(@uri.to_s)"
    },
    {
        "line": 8,
        "fullcodeline": "@status = :too_many_redirects"
    },
    {
        "line": 14,
        "fullcodeline": "@status = :invalid_address"
    },
    {
        "line": 19,
        "fullcodeline": "@ignored.each do |host|"
    },
    {
        "line": 27,
        "fullcodeline": "@status = :resolved"
    },
    {
        "line": 57,
        "fullcodeline": "when 200"
    },
    {
        "line": 99,
        "fullcodeline": "response_headers = {"
    },
    {
        "line": 106,
        "fullcodeline": "location = response_headers[:location]"
    },
    {
        "line": 110,
        "fullcodeline": "@cookie = Array.wrap(cookies).map { |c| c.split(';').first.strip }.join('; ')"
    },
    {
        "line": 114,
        "fullcodeline": "redirect_uri = uri(location)"
    },
    {
        "line": 120,
        "fullcodeline": "old_port = @uri.port"
    },
    {
        "line": 123,
        "fullcodeline": "@uri = uri(location)"
    },
    {
        "line": 124,
        "fullcodeline": "@limit -= 1"
    },
    {
        "line": 138,
        "fullcodeline": "log(:warn, \"FinalDestination could not resolve URL (status #{response.status}): #{@uri}\") if @verbose"
    },
    {
        "line": 26,
        "fullcodeline": "if Oneboxer.cached_response_body_exists?(@uri.to_s)"
    },
    {
        "line": 78,
        "fullcodeline": "@status = :resolved"
    },
    {
        "line": 105,
        "fullcodeline": "if (300..399).include?(response_status)"
    },
    {
        "line": 121,
        "fullcodeline": "location = \"#{location}##{@uri.fragment}\" if @preserve_fragment_url && @uri.fragment.present?"
    },
    {
        "line": 122,
        "fullcodeline": "location = \"#{@uri.scheme}://#{@uri.host}#{location}\" if location[0] == \"/\""
    },
    {
        "line": 131,
        "fullcodeline": "return resolve"
    },
    {
        "line": 9,
        "fullcodeline": "log(:warn, \"FinalDestination could not resolve URL (too many redirects): #{@uri}\") if @verbose"
    },
    {
        "line": 15,
        "fullcodeline": "log(:warn, \"FinalDestination could not resolve URL (invalid URI): #{@uri}\") if @verbose"
    },
    {
        "line": 59,
        "fullcodeline": "if @http_verb == :get"
    },
    {
        "line": 100,
        "fullcodeline": "cookies: response.data[:cookies] || response.headers[:\"set-cookie\"],"
    },
    {
        "line": 101,
        "fullcodeline": "location: response.headers[:location]"
    },
    {
        "line": 115,
        "fullcodeline": "if @uri.host == redirect_uri.host && (redirect_uri.path =~ /\\/login/ || redirect_uri.path =~ /\\/session/)"
    },
    {
        "line": 116,
        "fullcodeline": "@status = :resolved"
    },
    {
        "line": 127,
        "fullcodeline": "if old_port == 80 && @uri.port == 443 && (URI::HTTPS === @uri)"
    },
    {
        "line": 141,
        "fullcodeline": "log(:warn, \"FinalDestination could not resolve URL (timeout): #{@uri}\") if @verbose"
    },
    {
        "line": 66,
        "fullcodeline": "next_url = fetch_canonical_url(response_body)"
    },
    {
        "line": 77,
        "fullcodeline": "@content_type = response.headers['Content-Type'] if response.headers.has_key?('Content-Type')"
    },
    {
        "line": 80,
        "fullcodeline": "when 103, 400, 405, 406, 409, 500, 501"
    },
    {
        "line": 81,
        "fullcodeline": "response_status, small_headers = small_get(request_headers)"
    },
    {
        "line": 88,
        "fullcodeline": "response_headers = {}"
    },
    {
        "line": 60,
        "fullcodeline": "if Oneboxer.cache_response_body?(@uri)"
    },
    {
        "line": 83,
        "fullcodeline": "if response_status == 200"
    },
    {
        "line": 89,
        "fullcodeline": "if cookie_val = small_headers['set-cookie']"
    },
    {
        "line": 93,
        "fullcodeline": "if location_val = small_headers['location']"
    },
    {
        "line": 128,
        "fullcodeline": "FinalDestination.cache_https_domain(@uri.hostname)"
    },
    {
        "line": 61,
        "fullcodeline": "Oneboxer.cache_response_body(@uri.to_s, response_body)"
    },
    {
        "line": 68,
        "fullcodeline": "if next_url.to_s.present? && next_url != @uri"
    },
    {
        "line": 69,
        "fullcodeline": "@follow_canonical = false"
    },
    {
        "line": 70,
        "fullcodeline": "@uri = next_url"
    },
    {
        "line": 71,
        "fullcodeline": "@http_verb = http_verb(@force_get_hosts, @follow_canonical)"
    },
    {
        "line": 84,
        "fullcodeline": "@status = :resolved"
    },
    {
        "line": 90,
        "fullcodeline": "response_headers[:cookies] = cookie_val"
    },
    {
        "line": 94,
        "fullcodeline": "response_headers[:location] = location_val.join"
    },
    {
        "line": 73,
        "fullcodeline": "return resolve"
    }
]