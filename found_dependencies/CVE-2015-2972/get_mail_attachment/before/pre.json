[
    {
        "line": 2,
        "fullcodeline": "Log.add_info(request, params.inspect)"
    },
    {
        "line": 4,
        "fullcodeline": "attached_id = params[:id].to_i"
    },
    {
        "line": 5,
        "fullcodeline": "mail_attach = MailAttachment.find_by_id(attached_id)"
    },
    {
        "line": 12,
        "fullcodeline": "email = Email.find_by_id(mail_attach.email_id)"
    },
    {
        "line": 18,
        "fullcodeline": "mail_attach_name = mail_attach.name"
    },
    {
        "line": 20,
        "fullcodeline": "agent = request.env['HTTP_USER_AGENT']"
    },
    {
        "line": 29,
        "fullcodeline": "filepath = mail_attach.get_path"
    },
    {
        "line": 21,
        "fullcodeline": "unless agent.nil?"
    },
    {
        "line": 30,
        "fullcodeline": "if FileTest.exist?(filepath)"
    },
    {
        "line": 8,
        "fullcodeline": "redirect_to(THETIS_RELATIVE_URL_ROOT + '/404.html')"
    },
    {
        "line": 13,
        "fullcodeline": "if email.nil? or email.user_id != @login_user.id"
    },
    {
        "line": 22,
        "fullcodeline": "ie_ver = nil"
    },
    {
        "line": 31,
        "fullcodeline": "send_file(filepath, :filename => mail_attach_name, :stream => true, :disposition => 'attachment')"
    },
    {
        "line": 33,
        "fullcodeline": "send_data('', :type => 'application/octet-stream;', :disposition => 'attachment;filename=\"'+mail_attach_name+'\"')"
    },
    {
        "line": 26,
        "fullcodeline": "mail_attach_name = CGI::escape(mail_attach_name) unless ie_ver.nil?"
    }
]