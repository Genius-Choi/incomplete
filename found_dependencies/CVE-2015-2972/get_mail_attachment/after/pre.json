[
    {
        "line": 2,
        "fullcodeline": "Log.add_info(request, params.inspect)"
    },
    {
        "line": 4,
        "fullcodeline": "attached_id = params[:id].to_i"
    },
    {
        "line": 24,
        "fullcodeline": "mail_attach_name = mail_attach.name"
    },
    {
        "line": 26,
        "fullcodeline": "agent = request.env['HTTP_USER_AGENT']"
    },
    {
        "line": 35,
        "fullcodeline": "filepath = mail_attach.get_path"
    },
    {
        "line": 27,
        "fullcodeline": "unless agent.nil?"
    },
    {
        "line": 36,
        "fullcodeline": "if FileTest.exist?(filepath)"
    },
    {
        "line": 6,
        "fullcodeline": "mail_attach = MailAttachment.find(attached_id)"
    },
    {
        "line": 11,
        "fullcodeline": "redirect_to(THETIS_RELATIVE_URL_ROOT + '/404.html')"
    },
    {
        "line": 16,
        "fullcodeline": "email = Email.find(mail_attach.email_id)"
    },
    {
        "line": 19,
        "fullcodeline": "if email.nil? or email.user_id != @login_user.id"
    },
    {
        "line": 28,
        "fullcodeline": "ie_ver = nil"
    },
    {
        "line": 37,
        "fullcodeline": "send_file(filepath, :filename => mail_attach_name, :stream => true, :disposition => 'attachment')"
    },
    {
        "line": 39,
        "fullcodeline": "send_data('', :type => 'application/octet-stream;', :disposition => 'attachment;filename=\"'+mail_attach_name+'\"')"
    },
    {
        "line": 32,
        "fullcodeline": "mail_attach_name = CGI::escape(mail_attach_name) unless ie_ver.nil?"
    }
]