[
    {
        "line": 2,
        "fullcodeline": "Log.add_info(request, params.inspect)"
    },
    {
        "line": 6,
        "fullcodeline": "email = Email.find_by_id(email_id)"
    },
    {
        "line": 12,
        "fullcodeline": "download_name = \"mail_attachments#{email.id}.zip\""
    },
    {
        "line": 13,
        "fullcodeline": "zip_file = email.zip_attachments(params[:enc])"
    },
    {
        "line": 7,
        "fullcodeline": "if email.nil? or email.user_id != @login_user.id"
    },
    {
        "line": 8,
        "fullcodeline": "render(:text => '')"
    },
    {
        "line": 18,
        "fullcodeline": "filepath = zip_file.path"
    },
    {
        "line": 16,
        "fullcodeline": "send_data('', :type => 'application/octet-stream;', :disposition => 'attachment;filename=\"'+download_name+'\"')"
    },
    {
        "line": 19,
        "fullcodeline": "send_file(filepath, :filename => download_name, :stream => true, :disposition => 'attachment')"
    }
]