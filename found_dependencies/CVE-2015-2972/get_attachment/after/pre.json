[
    {
        "line": 2,
        "fullcodeline": "Log.add_info(request, params.inspect)"
    },
    {
        "line": 4,
        "fullcodeline": "attach = Attachment.find(params[:id])"
    },
    {
        "line": 10,
        "fullcodeline": "parent_item = (attach.item || ((attach.comment.nil?) ? nil : attach.comment.item))"
    },
    {
        "line": 17,
        "fullcodeline": "attach_name = attach.name"
    },
    {
        "line": 19,
        "fullcodeline": "agent = request.env['HTTP_USER_AGENT']"
    },
    {
        "line": 20,
        "fullcodeline": "unless agent.nil?"
    },
    {
        "line": 6,
        "fullcodeline": "redirect_to(THETIS_RELATIVE_URL_ROOT + '/404.html')"
    },
    {
        "line": 11,
        "fullcodeline": "if parent_item.nil? or !parent_item.check_user_auth(@login_user, 'r', true)"
    },
    {
        "line": 12,
        "fullcodeline": "Log.add_check(request, '[Item.check_user_auth]'+request.to_s)"
    },
    {
        "line": 21,
        "fullcodeline": "ie_ver = nil"
    },
    {
        "line": 29,
        "fullcodeline": "attach_location = attach.location"
    },
    {
        "line": 36,
        "fullcodeline": "filepath = AttachmentsHelper.get_path(attach)"
    },
    {
        "line": 31,
        "fullcodeline": "attach_location = Attachment::LOCATION_DB   # for lower versions"
    },
    {
        "line": 38,
        "fullcodeline": "send_file(filepath, :filename => attach_name, :stream => true, :disposition => 'attachment')"
    },
    {
        "line": 40,
        "fullcodeline": "send_data(attach.content, :type => (attach.content_type || 'application/octet-stream')+';charset=UTF-8', :disposition => 'attachment;filename=\"'+attach_name+'\"')"
    },
    {
        "line": 25,
        "fullcodeline": "attach_name = CGI::escape(attach_name) unless ie_ver.nil?"
    }
]