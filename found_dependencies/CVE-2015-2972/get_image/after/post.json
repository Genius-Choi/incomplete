[
    {
        "line": 2,
        "fullcodeline": "img = Image.find(params[:id])"
    },
    {
        "line": 9,
        "fullcodeline": "parent_item = img.item"
    },
    {
        "line": 16,
        "fullcodeline": "response.headers[\"Content-Type\"] = img.content_type"
    },
    {
        "line": 17,
        "fullcodeline": "response.headers[\"Content-Disposition\"] = \"inline\""
    },
    {
        "line": 10,
        "fullcodeline": "if parent_item.nil? or !parent_item.check_user_auth(@login_user, 'r', true)"
    },
    {
        "line": 18,
        "fullcodeline": "render(:text => img.content)"
    },
    {
        "line": 5,
        "fullcodeline": "redirect_to(THETIS_RELATIVE_URL_ROOT + '/404.html' )"
    },
    {
        "line": 11,
        "fullcodeline": "Log.add_check(request, '[Item.check_user_auth]'+request.to_s)"
    },
    {
        "line": 12,
        "fullcodeline": "redirect_to(:controller => 'frames', :action => 'http_error', :id => '401')"
    }
]