[
    {
        "line": 3,
        "fullcodeline": "int ok = 0;"
    },
    {
        "line": 4,
        "fullcodeline": "unsigned char challenge[30];"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned char signature[256];"
    },
    {
        "line": 7,
        "fullcodeline": "const EVP_MD *md = EVP_sha1();"
    },
    {
        "line": 8,
        "fullcodeline": "EVP_MD_CTX *md_ctx = EVP_MD_CTX_new();"
    },
    {
        "line": 9,
        "fullcodeline": "EVP_PKEY *privkey = PKCS11_get_private_key(authkey);"
    },
    {
        "line": 10,
        "fullcodeline": "EVP_PKEY *pubkey = PKCS11_get_public_key(authkey);"
    },
    {
        "line": 35,
        "fullcodeline": "ok = 1;"
    },
    {
        "line": 19,
        "fullcodeline": "if (1 != randomize(pamh, challenge, sizeof challenge)) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (NULL == pubkey || NULL == privkey || NULL == md_ctx || NULL == md"
    },
    {
        "line": 38,
        "fullcodeline": "if (NULL != pubkey)"
    },
    {
        "line": 40,
        "fullcodeline": "if (NULL != privkey)"
    },
    {
        "line": 42,
        "fullcodeline": "if (NULL != md_ctx) {"
    },
    {
        "line": 29,
        "fullcodeline": "|| 1 != EVP_VerifyFinal(md_ctx, signature, siglen, pubkey)) {"
    },
    {
        "line": 30,
        "fullcodeline": "pam_syslog(pamh, LOG_DEBUG, \"Error verifying key: %s\\n\","
    },
    {
        "line": 32,
        "fullcodeline": "prompt(flags, pamh, PAM_ERROR_MSG, NULL, _(\"Error verifying key\"));"
    },
    {
        "line": 39,
        "fullcodeline": "EVP_PKEY_free(pubkey);"
    },
    {
        "line": 41,
        "fullcodeline": "EVP_PKEY_free(privkey);"
    },
    {
        "line": 43,
        "fullcodeline": "EVP_MD_CTX_free(md_ctx);"
    },
    {
        "line": 28,
        "fullcodeline": "|| !EVP_VerifyUpdate(md_ctx, challenge, sizeof challenge)"
    },
    {
        "line": 31,
        "fullcodeline": "ERR_reason_error_string(ERR_get_error()));"
    },
    {
        "line": 27,
        "fullcodeline": "|| !EVP_VerifyInit(md_ctx, md)"
    },
    {
        "line": 26,
        "fullcodeline": "|| !EVP_MD_CTX_reset(md_ctx)"
    },
    {
        "line": 25,
        "fullcodeline": "|| !EVP_SignFinal(md_ctx, signature, &siglen, privkey)"
    },
    {
        "line": 24,
        "fullcodeline": "|| !EVP_SignUpdate(md_ctx, challenge, sizeof challenge)"
    },
    {
        "line": 23,
        "fullcodeline": "|| !EVP_SignInit(md_ctx, md)"
    }
]