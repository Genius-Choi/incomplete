[
    {
        "line": 5,
        "fullcodeline": "int sync_child_pipe[2], sync_grandchild_pipe[2];"
    },
    {
        "line": 6,
        "fullcodeline": "struct nlconfig_t config = { 0 };"
    },
    {
        "line": 12,
        "fullcodeline": "pipenum = initpipe();"
    },
    {
        "line": 25,
        "fullcodeline": "nl_parse(pipenum, &config);"
    },
    {
        "line": 33,
        "fullcodeline": "update_oom_score_adj(config.oom_score_adj, config.oom_score_adj_len);"
    },
    {
        "line": 466,
        "fullcodeline": "bail(\"should never be reached\");"
    },
    {
        "line": 13,
        "fullcodeline": "if (pipenum == -1)"
    },
    {
        "line": 21,
        "fullcodeline": "if (ensure_cloned_binary() < 0)"
    },
    {
        "line": 51,
        "fullcodeline": "if (socketpair(AF_LOCAL, SOCK_STREAM, 0, sync_child_pipe) < 0)"
    },
    {
        "line": 58,
        "fullcodeline": "if (socketpair(AF_LOCAL, SOCK_STREAM, 0, sync_grandchild_pipe) < 0)"
    },
    {
        "line": 110,
        "fullcodeline": "switch (setjmp(env)) {"
    },
    {
        "line": 22,
        "fullcodeline": "bail(\"could not ensure we are a cloned binary\");"
    },
    {
        "line": 52,
        "fullcodeline": "bail(\"failed to setup sync pipe between parent and child\");"
    },
    {
        "line": 59,
        "fullcodeline": "bail(\"failed to setup sync pipe between parent and grandchild\");"
    },
    {
        "line": 462,
        "fullcodeline": "bail(\"unexpected jump value\");"
    },
    {
        "line": 46,
        "fullcodeline": "if (prctl(PR_SET_DUMPABLE, 0, 0, 0, 0) < 0)"
    },
    {
        "line": 120,
        "fullcodeline": "pid_t child, first_child = -1;"
    },
    {
        "line": 121,
        "fullcodeline": "bool ready = false;"
    },
    {
        "line": 124,
        "fullcodeline": "prctl(PR_SET_NAME, (unsigned long)\"runc:[0:PARENT]\", 0, 0, 0);"
    },
    {
        "line": 127,
        "fullcodeline": "child = clone_parent(&env, JUMP_CHILD);"
    },
    {
        "line": 220,
        "fullcodeline": "ready = false;"
    },
    {
        "line": 251,
        "fullcodeline": "exit(0);"
    },
    {
        "line": 268,
        "fullcodeline": "syncfd = sync_child_pipe[0];"
    },
    {
        "line": 269,
        "fullcodeline": "close(sync_child_pipe[1]);"
    },
    {
        "line": 272,
        "fullcodeline": "prctl(PR_SET_NAME, (unsigned long)\"runc:[1:CHILD]\", 0, 0, 0);"
    },
    {
        "line": 359,
        "fullcodeline": "child = clone_parent(&env, JUMP_INIT);"
    },
    {
        "line": 364,
        "fullcodeline": "s = SYNC_RECVPID_PLS;"
    },
    {
        "line": 385,
        "fullcodeline": "s = SYNC_CHILD_READY;"
    },
    {
        "line": 392,
        "fullcodeline": "exit(0);"
    },
    {
        "line": 409,
        "fullcodeline": "syncfd = sync_grandchild_pipe[0];"
    },
    {
        "line": 410,
        "fullcodeline": "close(sync_grandchild_pipe[1]);"
    },
    {
        "line": 411,
        "fullcodeline": "close(sync_child_pipe[0]);"
    },
    {
        "line": 412,
        "fullcodeline": "close(sync_child_pipe[1]);"
    },
    {
        "line": 415,
        "fullcodeline": "prctl(PR_SET_NAME, (unsigned long)\"runc:[2:INIT]\", 0, 0, 0);"
    },
    {
        "line": 448,
        "fullcodeline": "s = SYNC_CHILD_READY;"
    },
    {
        "line": 453,
        "fullcodeline": "close(sync_grandchild_pipe[0]);"
    },
    {
        "line": 456,
        "fullcodeline": "nl_free(&config);"
    },
    {
        "line": 47,
        "fullcodeline": "bail(\"failed to set process as non-dumpable\");"
    },
    {
        "line": 128,
        "fullcodeline": "if (child < 0)"
    },
    {
        "line": 138,
        "fullcodeline": "while (!ready) {"
    },
    {
        "line": 221,
        "fullcodeline": "while (!ready) {"
    },
    {
        "line": 302,
        "fullcodeline": "if (config.cloneflags & CLONE_NEWUSER) {"
    },
    {
        "line": 347,
        "fullcodeline": "if (unshare(config.cloneflags & ~CLONE_NEWCGROUP) < 0)"
    },
    {
        "line": 360,
        "fullcodeline": "if (child < 0)"
    },
    {
        "line": 365,
        "fullcodeline": "if (write(syncfd, &s, sizeof(s)) != sizeof(s)) {"
    },
    {
        "line": 369,
        "fullcodeline": "if (write(syncfd, &child, sizeof(child)) != sizeof(child)) {"
    },
    {
        "line": 376,
        "fullcodeline": "if (read(syncfd, &s, sizeof(s)) != sizeof(s)) {"
    },
    {
        "line": 380,
        "fullcodeline": "if (s != SYNC_RECVPID_ACK) {"
    },
    {
        "line": 386,
        "fullcodeline": "if (write(syncfd, &s, sizeof(s)) != sizeof(s)) {"
    },
    {
        "line": 417,
        "fullcodeline": "if (read(syncfd, &s, sizeof(s)) != sizeof(s))"
    },
    {
        "line": 419,
        "fullcodeline": "if (s != SYNC_GRANDCHILD)"
    },
    {
        "line": 422,
        "fullcodeline": "if (setsid() < 0)"
    },
    {
        "line": 425,
        "fullcodeline": "if (setuid(0) < 0)"
    },
    {
        "line": 428,
        "fullcodeline": "if (setgid(0) < 0)"
    },
    {
        "line": 431,
        "fullcodeline": "if (!config.is_rootless_euid && config.is_setgroup) {"
    },
    {
        "line": 437,
        "fullcodeline": "if (config.cloneflags & CLONE_NEWCGROUP) {"
    },
    {
        "line": 449,
        "fullcodeline": "if (write(syncfd, &s, sizeof(s)) != sizeof(s))"
    },
    {
        "line": 129,
        "fullcodeline": "bail(\"unable to fork: child_func\");"
    },
    {
        "line": 142,
        "fullcodeline": "syncfd = sync_child_pipe[1];"
    },
    {
        "line": 143,
        "fullcodeline": "close(sync_child_pipe[0]);"
    },
    {
        "line": 225,
        "fullcodeline": "syncfd = sync_grandchild_pipe[1];"
    },
    {
        "line": 226,
        "fullcodeline": "close(sync_grandchild_pipe[0]);"
    },
    {
        "line": 228,
        "fullcodeline": "s = SYNC_GRANDCHILD;"
    },
    {
        "line": 281,
        "fullcodeline": "join_namespaces(config.namespaces);"
    },
    {
        "line": 305,
        "fullcodeline": "config.cloneflags &= ~CLONE_NEWUSER;"
    },
    {
        "line": 317,
        "fullcodeline": "s = SYNC_USERMAP_PLS;"
    },
    {
        "line": 348,
        "fullcodeline": "bail(\"failed to unshare namespaces\");"
    },
    {
        "line": 361,
        "fullcodeline": "bail(\"unable to fork: init_func\");"
    },
    {
        "line": 366,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 367,
        "fullcodeline": "bail(\"failed to sync with parent: write(SYNC_RECVPID_PLS)\");"
    },
    {
        "line": 370,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 371,
        "fullcodeline": "bail(\"failed to sync with parent: write(childpid)\");"
    },
    {
        "line": 377,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 378,
        "fullcodeline": "bail(\"failed to sync with parent: read(SYNC_RECVPID_ACK)\");"
    },
    {
        "line": 381,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 382,
        "fullcodeline": "bail(\"failed to sync with parent: SYNC_RECVPID_ACK: got %u\", s);"
    },
    {
        "line": 387,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 388,
        "fullcodeline": "bail(\"failed to sync with parent: write(SYNC_CHILD_READY)\");"
    },
    {
        "line": 418,
        "fullcodeline": "bail(\"failed to sync with parent: read(SYNC_GRANDCHILD)\");"
    },
    {
        "line": 420,
        "fullcodeline": "bail(\"failed to sync with parent: SYNC_GRANDCHILD: got %u\", s);"
    },
    {
        "line": 423,
        "fullcodeline": "bail(\"setsid failed\");"
    },
    {
        "line": 426,
        "fullcodeline": "bail(\"setuid failed\");"
    },
    {
        "line": 429,
        "fullcodeline": "bail(\"setgid failed\");"
    },
    {
        "line": 450,
        "fullcodeline": "bail(\"failed to sync with patent: write(SYNC_CHILD_READY)\");"
    },
    {
        "line": 145,
        "fullcodeline": "if (read(syncfd, &s, sizeof(s)) != sizeof(s))"
    },
    {
        "line": 229,
        "fullcodeline": "if (write(syncfd, &s, sizeof(s)) != sizeof(s)) {"
    },
    {
        "line": 234,
        "fullcodeline": "if (read(syncfd, &s, sizeof(s)) != sizeof(s))"
    },
    {
        "line": 303,
        "fullcodeline": "if (unshare(CLONE_NEWUSER) < 0)"
    },
    {
        "line": 318,
        "fullcodeline": "if (write(syncfd, &s, sizeof(s)) != sizeof(s))"
    },
    {
        "line": 323,
        "fullcodeline": "if (read(syncfd, &s, sizeof(s)) != sizeof(s))"
    },
    {
        "line": 325,
        "fullcodeline": "if (s != SYNC_USERMAP_ACK)"
    },
    {
        "line": 334,
        "fullcodeline": "if (setresuid(0, 0, 0) < 0)"
    },
    {
        "line": 432,
        "fullcodeline": "if (setgroups(0, NULL) < 0)"
    },
    {
        "line": 439,
        "fullcodeline": "if (read(pipenum, &value, sizeof(value)) != sizeof(value))"
    },
    {
        "line": 441,
        "fullcodeline": "if (value == CREATECGROUPNS) {"
    },
    {
        "line": 146,
        "fullcodeline": "bail(\"failed to sync with child: next state\");"
    },
    {
        "line": 154,
        "fullcodeline": "exit(ret);"
    },
    {
        "line": 171,
        "fullcodeline": "update_uidmap(config.uidmappath, child, config.uidmap, config.uidmap_len);"
    },
    {
        "line": 172,
        "fullcodeline": "update_gidmap(config.gidmappath, child, config.gidmap, config.gidmap_len);"
    },
    {
        "line": 174,
        "fullcodeline": "s = SYNC_USERMAP_ACK;"
    },
    {
        "line": 211,
        "fullcodeline": "ready = true;"
    },
    {
        "line": 214,
        "fullcodeline": "bail(\"unexpected sync value: %u\", s);"
    },
    {
        "line": 230,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 231,
        "fullcodeline": "bail(\"failed to sync with child: write(SYNC_GRANDCHILD)\");"
    },
    {
        "line": 235,
        "fullcodeline": "bail(\"failed to sync with child: next state\");"
    },
    {
        "line": 243,
        "fullcodeline": "exit(ret);"
    },
    {
        "line": 245,
        "fullcodeline": "ready = true;"
    },
    {
        "line": 248,
        "fullcodeline": "bail(\"unexpected sync value: %u\", s);"
    },
    {
        "line": 304,
        "fullcodeline": "bail(\"failed to unshare user namespace\");"
    },
    {
        "line": 319,
        "fullcodeline": "bail(\"failed to sync with parent: write(SYNC_USERMAP_PLS)\");"
    },
    {
        "line": 324,
        "fullcodeline": "bail(\"failed to sync with parent: read(SYNC_USERMAP_ACK)\");"
    },
    {
        "line": 326,
        "fullcodeline": "bail(\"failed to sync with parent: SYNC_USERMAP_ACK: got %u\", s);"
    },
    {
        "line": 335,
        "fullcodeline": "bail(\"failed to become root in user namespace\");"
    },
    {
        "line": 433,
        "fullcodeline": "bail(\"setgroups failed\");"
    },
    {
        "line": 440,
        "fullcodeline": "bail(\"read synchronisation value failed\");"
    },
    {
        "line": 151,
        "fullcodeline": "if (read(syncfd, &ret, sizeof(ret)) != sizeof(ret))"
    },
    {
        "line": 167,
        "fullcodeline": "if (config.is_rootless_euid && !config.is_setgroup)"
    },
    {
        "line": 175,
        "fullcodeline": "if (write(syncfd, &s, sizeof(s)) != sizeof(s)) {"
    },
    {
        "line": 181,
        "fullcodeline": "first_child = child;"
    },
    {
        "line": 190,
        "fullcodeline": "s = SYNC_RECVPID_ACK;"
    },
    {
        "line": 203,
        "fullcodeline": "len = dprintf(pipenum, \"{\\\"pid\\\": %d, \\\"pid_first\\\": %d}\\n\", child, first_child);"
    },
    {
        "line": 240,
        "fullcodeline": "if (read(syncfd, &ret, sizeof(ret)) != sizeof(ret))"
    },
    {
        "line": 314,
        "fullcodeline": "if (prctl(PR_SET_DUMPABLE, 1, 0, 0, 0) < 0)"
    },
    {
        "line": 329,
        "fullcodeline": "if (prctl(PR_SET_DUMPABLE, 0, 0, 0, 0) < 0)"
    },
    {
        "line": 442,
        "fullcodeline": "if (unshare(CLONE_NEWCGROUP) < 0)"
    },
    {
        "line": 445,
        "fullcodeline": "bail(\"received unknown synchronisation value\");"
    },
    {
        "line": 152,
        "fullcodeline": "bail(\"failed to sync with child: read(error code)\");"
    },
    {
        "line": 168,
        "fullcodeline": "update_setgroups(child, SETGROUPS_DENY);"
    },
    {
        "line": 176,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 177,
        "fullcodeline": "bail(\"failed to sync with child: write(SYNC_USERMAP_ACK)\");"
    },
    {
        "line": 184,
        "fullcodeline": "if (read(syncfd, &child, sizeof(child)) != sizeof(child)) {"
    },
    {
        "line": 191,
        "fullcodeline": "if (write(syncfd, &s, sizeof(s)) != sizeof(s)) {"
    },
    {
        "line": 204,
        "fullcodeline": "if (len < 0) {"
    },
    {
        "line": 241,
        "fullcodeline": "bail(\"failed to sync with child: read(error code)\");"
    },
    {
        "line": 315,
        "fullcodeline": "bail(\"failed to set process as dumpable\");"
    },
    {
        "line": 330,
        "fullcodeline": "bail(\"failed to set process as dumpable\");"
    },
    {
        "line": 443,
        "fullcodeline": "bail(\"failed to unshare cgroup namespace\");"
    },
    {
        "line": 185,
        "fullcodeline": "kill(first_child, SIGKILL);"
    },
    {
        "line": 186,
        "fullcodeline": "bail(\"failed to sync with child: read(childpid)\");"
    },
    {
        "line": 192,
        "fullcodeline": "kill(first_child, SIGKILL);"
    },
    {
        "line": 193,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 194,
        "fullcodeline": "bail(\"failed to sync with child: write(SYNC_RECVPID_ACK)\");"
    },
    {
        "line": 205,
        "fullcodeline": "kill(child, SIGKILL);"
    },
    {
        "line": 206,
        "fullcodeline": "bail(\"unable to generate JSON for child pid\");"
    }
]