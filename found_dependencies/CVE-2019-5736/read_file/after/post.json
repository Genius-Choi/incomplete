[
    {
        "line": 4,
        "fullcodeline": "char buf[4096], *copy = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "fd = open(path, O_RDONLY | O_CLOEXEC);"
    },
    {
        "line": 13,
        "fullcodeline": "*length = 0;"
    },
    {
        "line": 27,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 31,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 32,
        "fullcodeline": "free(copy);"
    },
    {
        "line": 6,
        "fullcodeline": "if (!length)"
    },
    {
        "line": 10,
        "fullcodeline": "if (fd < 0)"
    },
    {
        "line": 17,
        "fullcodeline": "n = read(fd, buf, sizeof(buf));"
    },
    {
        "line": 23,
        "fullcodeline": "copy = must_realloc(copy, (*length + n) * sizeof(*copy));"
    },
    {
        "line": 24,
        "fullcodeline": "memcpy(copy + *length, buf, n);"
    },
    {
        "line": 25,
        "fullcodeline": "*length += n;"
    },
    {
        "line": 18,
        "fullcodeline": "if (n < 0)"
    },
    {
        "line": 20,
        "fullcodeline": "if (!n)"
    }
]