[
    {
        "line": 4,
        "fullcodeline": "ssize_t sent = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "memfd = open(\"/tmp\", O_TMPFILE | O_EXCL | O_RDWR | O_CLOEXEC, 0711);"
    },
    {
        "line": 14,
        "fullcodeline": "binfd = open(\"/proc/self/exe\", O_RDONLY | O_CLOEXEC);"
    },
    {
        "line": 18,
        "fullcodeline": "sent = sendfile(memfd, binfd, NULL, RUNC_SENDFILE_MAX);"
    },
    {
        "line": 30,
        "fullcodeline": "char *fdpath = NULL;"
    },
    {
        "line": 34,
        "fullcodeline": "newfd = open(fdpath, O_RDONLY | O_CLOEXEC);"
    },
    {
        "line": 40,
        "fullcodeline": "memfd = newfd;"
    },
    {
        "line": 11,
        "fullcodeline": "if (memfd < 0)"
    },
    {
        "line": 15,
        "fullcodeline": "if (binfd < 0)"
    },
    {
        "line": 36,
        "fullcodeline": "if (newfd < 0)"
    },
    {
        "line": 46,
        "fullcodeline": "return -EIO;"
    },
    {
        "line": 32,
        "fullcodeline": "if (asprintf(&fdpath, \"/proc/self/fd/%d\", memfd) < 0)"
    },
    {
        "line": 12,
        "fullcodeline": "return -ENOTRECOVERABLE;"
    }
]