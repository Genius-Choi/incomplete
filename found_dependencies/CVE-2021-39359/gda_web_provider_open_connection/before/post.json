[
    {
        "line": 4,
        "fullcodeline": "g_return_val_if_fail (GDA_IS_WEB_PROVIDER (provider), FALSE);"
    },
    {
        "line": 5,
        "fullcodeline": "g_return_val_if_fail (GDA_IS_CONNECTION (cnc), FALSE);"
    },
    {
        "line": 8,
        "fullcodeline": "const gchar *db_name, *host, *path, *port, *serversecret, *pass = NULL, *use_ssl;"
    },
    {
        "line": 16,
        "fullcodeline": "host = gda_quark_list_find (params, \"HOST\");"
    },
    {
        "line": 22,
        "fullcodeline": "serversecret = gda_quark_list_find (params, \"SECRET\");"
    },
    {
        "line": 28,
        "fullcodeline": "path = gda_quark_list_find (params, \"PATH\");"
    },
    {
        "line": 29,
        "fullcodeline": "port = gda_quark_list_find (params, \"PORT\");"
    },
    {
        "line": 30,
        "fullcodeline": "db_name = gda_quark_list_find (params, \"DB_NAME\");"
    },
    {
        "line": 36,
        "fullcodeline": "use_ssl = gda_quark_list_find (params, \"USE_SSL\");"
    },
    {
        "line": 44,
        "fullcodeline": "cdata = g_new0 (WebConnectionData, 1);"
    },
    {
        "line": 45,
        "fullcodeline": "g_rec_mutex_init (& (cdata->mutex));"
    },
    {
        "line": 46,
        "fullcodeline": "cdata->server_id = NULL;"
    },
    {
        "line": 47,
        "fullcodeline": "cdata->forced_closing = FALSE;"
    },
    {
        "line": 48,
        "fullcodeline": "cdata->worker_session = soup_session_new ();"
    },
    {
        "line": 49,
        "fullcodeline": "cdata->front_session = soup_session_new_with_options (\"max-conns-per-host\", 1, NULL);"
    },
    {
        "line": 56,
        "fullcodeline": "g_string_append (server_url, host);"
    },
    {
        "line": 61,
        "fullcodeline": "cdata->front_url = g_strdup_printf (\"%s/gda-front.php\", server_url->str);"
    },
    {
        "line": 62,
        "fullcodeline": "cdata->worker_url = g_strdup_printf (\"%s/gda-worker.php\", server_url->str);"
    },
    {
        "line": 63,
        "fullcodeline": "cdata->server_base_url = g_string_free (server_url, FALSE);"
    },
    {
        "line": 66,
        "fullcodeline": "gda_connection_internal_set_provider_data (cnc, (GdaServerProviderConnectionData*) cdata, (GDestroyNotify) _gda_web_free_cnc_data);"
    },
    {
        "line": 83,
        "fullcodeline": "doc = _gda_web_send_message_to_frontend (cnc, cdata, MESSAGE_HELLO, HELLO_MSG, NULL, &status);"
    },
    {
        "line": 96,
        "fullcodeline": "xmlFreeDoc (doc);"
    },
    {
        "line": 109,
        "fullcodeline": "cdata->key = g_strdup_printf (\"%s/AND/%s\", db_name, pass);"
    },
    {
        "line": 111,
        "fullcodeline": "token = _gda_web_compute_token (cdata);"
    },
    {
        "line": 112,
        "fullcodeline": "tmp = g_strdup_printf (CONNECT_MSG, token);"
    },
    {
        "line": 113,
        "fullcodeline": "g_free (token);"
    },
    {
        "line": 115,
        "fullcodeline": "cdata->server_secret = g_strdup (serversecret);"
    },
    {
        "line": 116,
        "fullcodeline": "doc = _gda_web_send_message_to_frontend (cnc, cdata, MESSAGE_CONNECT, tmp, serversecret, &status);"
    },
    {
        "line": 117,
        "fullcodeline": "g_free (tmp);"
    },
    {
        "line": 130,
        "fullcodeline": "xmlFreeDoc (doc);"
    },
    {
        "line": 136,
        "fullcodeline": "md5str = g_compute_checksum_for_data (G_CHECKSUM_MD5, (const guchar*) cdata->key, strlen (cdata->key));"
    },
    {
        "line": 137,
        "fullcodeline": "g_free (cdata->key);"
    },
    {
        "line": 138,
        "fullcodeline": "cdata->key = md5str;"
    },
    {
        "line": 12,
        "fullcodeline": "if (!pass) {"
    },
    {
        "line": 17,
        "fullcodeline": "if (!host) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (!serversecret) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (!db_name) {"
    },
    {
        "line": 37,
        "fullcodeline": "if (use_ssl && (*use_ssl != 'T') && (*use_ssl != 't'))"
    },
    {
        "line": 71,
        "fullcodeline": "if (! do_server_setup (cnc, cdata))"
    },
    {
        "line": 84,
        "fullcodeline": "if (!doc) {"
    },
    {
        "line": 89,
        "fullcodeline": "if (status != 'O') {"
    },
    {
        "line": 118,
        "fullcodeline": "if (!doc) {"
    },
    {
        "line": 123,
        "fullcodeline": "if (status != 'O') {"
    },
    {
        "line": 11,
        "fullcodeline": "pass = gda_quark_list_find (auth, \"PASSWORD\");"
    },
    {
        "line": 13,
        "fullcodeline": "gda_connection_add_event_string (cnc, _(\"The connection string must contain the %s value\"), \"PASSWORD\");"
    },
    {
        "line": 18,
        "fullcodeline": "gda_connection_add_event_string (cnc,"
    },
    {
        "line": 24,
        "fullcodeline": "gda_connection_add_event_string (cnc,"
    },
    {
        "line": 32,
        "fullcodeline": "gda_connection_add_event_string (cnc,"
    },
    {
        "line": 38,
        "fullcodeline": "use_ssl = NULL;"
    },
    {
        "line": 51,
        "fullcodeline": "server_url = g_string_new (\"https://\");"
    },
    {
        "line": 52,
        "fullcodeline": "g_print (\"USING SSL\\n\");"
    },
    {
        "line": 58,
        "fullcodeline": "g_string_append_printf (server_url, \":%s\", port);"
    },
    {
        "line": 60,
        "fullcodeline": "g_string_append_printf (server_url, \"/%s\", path);"
    },
    {
        "line": 65,
        "fullcodeline": "cdata->key = g_strdup (serversecret);"
    },
    {
        "line": 85,
        "fullcodeline": "gda_connection_internal_set_provider_data (cnc, NULL, NULL);"
    },
    {
        "line": 86,
        "fullcodeline": "_gda_web_do_server_cleanup (cnc, cdata);"
    },
    {
        "line": 90,
        "fullcodeline": "_gda_web_set_connection_error_from_xmldoc (cnc, doc, NULL);"
    },
    {
        "line": 91,
        "fullcodeline": "xmlFreeDoc (doc);"
    },
    {
        "line": 92,
        "fullcodeline": "gda_connection_internal_set_provider_data (cnc, NULL, NULL);"
    },
    {
        "line": 93,
        "fullcodeline": "_gda_web_do_server_cleanup (cnc, cdata);"
    },
    {
        "line": 108,
        "fullcodeline": "g_free (cdata->key);"
    },
    {
        "line": 119,
        "fullcodeline": "gda_connection_internal_set_provider_data (cnc, NULL, NULL);"
    },
    {
        "line": 120,
        "fullcodeline": "_gda_web_do_server_cleanup (cnc, cdata);"
    },
    {
        "line": 124,
        "fullcodeline": "_gda_web_set_connection_error_from_xmldoc (cnc, doc, NULL);"
    },
    {
        "line": 125,
        "fullcodeline": "xmlFreeDoc (doc);"
    },
    {
        "line": 126,
        "fullcodeline": "gda_connection_internal_set_provider_data (cnc, NULL, NULL);"
    },
    {
        "line": 127,
        "fullcodeline": "_gda_web_do_server_cleanup (cnc, cdata);"
    },
    {
        "line": 19,
        "fullcodeline": "_(\"The connection string must contain the %s value\"), \"HOST\");"
    },
    {
        "line": 25,
        "fullcodeline": "_(\"The connection string must contain the %s value\"), \"SECRET\");"
    },
    {
        "line": 33,
        "fullcodeline": "_(\"The connection string must contain the %s value\"), \"DB_NAME\");"
    },
    {
        "line": 55,
        "fullcodeline": "server_url = g_string_new (\"http://\");"
    }
]