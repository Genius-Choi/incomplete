[
    {
        "line": 6,
        "fullcodeline": "int ret = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "images_noffset = fdt_path_offset(fit, FIT_IMAGES_PATH);"
    },
    {
        "line": 19,
        "fullcodeline": "ndepth = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "noffset = fdt_next_node(fit, images_noffset, &ndepth);"
    },
    {
        "line": 8,
        "fullcodeline": "if (!fit)"
    },
    {
        "line": 11,
        "fullcodeline": "if (fit_check_format((void *)fit, IMAGE_SIZE_INVAL)) {"
    },
    {
        "line": 21,
        "fullcodeline": "while (noffset >= 0 && ndepth > 0) {"
    },
    {
        "line": 12,
        "fullcodeline": "printf(\"Bad FIT format of the update file, aborting auto-update\\n\");"
    },
    {
        "line": 25,
        "fullcodeline": "fit_image_name = (char *)fit_get_name(fit, noffset, NULL);"
    },
    {
        "line": 26,
        "fullcodeline": "printf(\"Processing update '%s' :\", fit_image_name);"
    },
    {
        "line": 34,
        "fullcodeline": "printf(\"\\n\");"
    },
    {
        "line": 50,
        "fullcodeline": "noffset = fdt_next_node(fit, noffset, &ndepth);"
    },
    {
        "line": 9,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 13,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 22,
        "fullcodeline": "if (ndepth != 1)"
    },
    {
        "line": 28,
        "fullcodeline": "if (!fit_image_verify(fit, noffset)) {"
    },
    {
        "line": 35,
        "fullcodeline": "if (update_fit_getparams(fit, noffset, &update_addr,"
    },
    {
        "line": 42,
        "fullcodeline": "if (fit_image_check_type(fit, noffset, IH_TYPE_FIRMWARE)) {"
    },
    {
        "line": 29,
        "fullcodeline": "printf(\"Error: invalid update hash, aborting\\n\");"
    },
    {
        "line": 30,
        "fullcodeline": "ret = 1;"
    },
    {
        "line": 37,
        "fullcodeline": "printf(\"Error: can't get update parameters, aborting\\n\");"
    },
    {
        "line": 38,
        "fullcodeline": "ret = 1;"
    },
    {
        "line": 43,
        "fullcodeline": "ret = dfu_write_by_name(fit_image_name,"
    },
    {
        "line": 44,
        "fullcodeline": "(void *)update_addr,"
    }
]