[
    {
        "line": 2,
        "fullcodeline": "unsigned char c, *data = (unsigned char*)ImageInfo->Thumbnail.data;"
    },
    {
        "line": 4,
        "fullcodeline": "size_t length=2, pos=0;"
    },
    {
        "line": 7,
        "fullcodeline": "if (!data || ImageInfo->Thumbnail.size < 4) {"
    },
    {
        "line": 10,
        "fullcodeline": "if (memcmp(data, \"\\xFF\\xD8\\xFF\", 3)) {"
    },
    {
        "line": 17,
        "fullcodeline": "pos += length;"
    },
    {
        "line": 20,
        "fullcodeline": "c = data[pos++];"
    },
    {
        "line": 26,
        "fullcodeline": "n = 8;"
    },
    {
        "line": 34,
        "fullcodeline": "marker = c;"
    },
    {
        "line": 36,
        "fullcodeline": "length = php_jpg_get16(data+pos);"
    },
    {
        "line": 18,
        "fullcodeline": "if (pos>=ImageInfo->Thumbnail.size)"
    },
    {
        "line": 21,
        "fullcodeline": "if (pos>=ImageInfo->Thumbnail.size)"
    },
    {
        "line": 32,
        "fullcodeline": "if (c == 0xFF)"
    },
    {
        "line": 35,
        "fullcodeline": "if (ImageInfo->Thumbnail.size - 2 < pos) return 0;"
    },
    {
        "line": 11,
        "fullcodeline": "if (!ImageInfo->Thumbnail.width && !ImageInfo->Thumbnail.height) {"
    },
    {
        "line": 27,
        "fullcodeline": "while ((c = data[pos++]) == 0xFF && n--) {"
    },
    {
        "line": 37,
        "fullcodeline": "if (length > ImageInfo->Thumbnail.size || pos >= ImageInfo->Thumbnail.size - length) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (pos+3>=ImageInfo->Thumbnail.size)"
    },
    {
        "line": 55,
        "fullcodeline": "if (length < 8 || ImageInfo->Thumbnail.size - 8 < pos) {"
    }
]