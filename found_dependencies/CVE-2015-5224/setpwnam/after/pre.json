[
    {
        "line": 3,
        "fullcodeline": "FILE *fp = NULL, *pwf = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "int buflen = 256;"
    },
    {
        "line": 9,
        "fullcodeline": "char *linebuf = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "char *tmpname = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "pw_init();"
    },
    {
        "line": 24,
        "fullcodeline": "pwf = fopen(PASSWD_FILE, \"r\");"
    },
    {
        "line": 28,
        "fullcodeline": "namelen = strlen(pwd->pw_name);"
    },
    {
        "line": 30,
        "fullcodeline": "linebuf = malloc(buflen);"
    },
    {
        "line": 35,
        "fullcodeline": "found = false;"
    },
    {
        "line": 74,
        "fullcodeline": "rc = close_stream(fp);"
    },
    {
        "line": 75,
        "fullcodeline": "fp = NULL;"
    },
    {
        "line": 80,
        "fullcodeline": "pwf = NULL;"
    },
    {
        "line": 99,
        "fullcodeline": "save_errno = errno;"
    },
    {
        "line": 14,
        "fullcodeline": "if ((fp = xfmkstemp(&tmpname, \"/etc\", prefix)) == NULL)"
    },
    {
        "line": 25,
        "fullcodeline": "if (!pwf)"
    },
    {
        "line": 31,
        "fullcodeline": "if (!linebuf)"
    },
    {
        "line": 39,
        "fullcodeline": "while (fgets(linebuf, buflen, pwf) != NULL) {"
    },
    {
        "line": 101,
        "fullcodeline": "if (fp != NULL)"
    },
    {
        "line": 103,
        "fullcodeline": "if (tmpname != NULL)"
    },
    {
        "line": 106,
        "fullcodeline": "if (pwf != NULL)"
    },
    {
        "line": 110,
        "fullcodeline": "return -1;"
    },
    {
        "line": 18,
        "fullcodeline": "if (fchown(fileno(fp), (uid_t) 0, (gid_t) 0) < 0)"
    },
    {
        "line": 40,
        "fullcodeline": "contlen = strlen(linebuf);"
    },
    {
        "line": 68,
        "fullcodeline": "fputs(linebuf, fp);"
    },
    {
        "line": 72,
        "fullcodeline": "if (fchmod(fileno(fp), 0644) < 0)"
    },
    {
        "line": 83,
        "fullcodeline": "errno = ENOENT;\t/* give me something better */"
    },
    {
        "line": 92,
        "fullcodeline": "if (rename(tmpname, PASSWD_FILE) < 0)"
    },
    {
        "line": 104,
        "fullcodeline": "unlink(tmpname);"
    },
    {
        "line": 15,
        "fullcodeline": "return -1;"
    },
    {
        "line": 41,
        "fullcodeline": "while (linebuf[contlen - 1] != '\\n' && !feof(pwf)) {"
    },
    {
        "line": 45,
        "fullcodeline": "buflen *= 2;"
    },
    {
        "line": 46,
        "fullcodeline": "tmp = realloc(linebuf, buflen);"
    },
    {
        "line": 49,
        "fullcodeline": "linebuf = tmp;"
    },
    {
        "line": 53,
        "fullcodeline": "contlen = strlen(linebuf);"
    },
    {
        "line": 58,
        "fullcodeline": "if (!found && linebuf[namelen] == ':' &&"
    },
    {
        "line": 59,
        "fullcodeline": "!strncmp(linebuf, pwd->pw_name, namelen)) {"
    },
    {
        "line": 64,
        "fullcodeline": "found = true;"
    },
    {
        "line": 47,
        "fullcodeline": "if (tmp == NULL)"
    },
    {
        "line": 51,
        "fullcodeline": "if (fgets(&linebuf[contlen], buflen / 2, pwf) == NULL)"
    },
    {
        "line": 62,
        "fullcodeline": "if (putpwent(pwd, fp) < 0)"
    }
]