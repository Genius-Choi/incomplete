[
    {
        "line": 3,
        "fullcodeline": "FILE *fp = NULL, *pwf = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "int buflen = 256;"
    },
    {
        "line": 9,
        "fullcodeline": "char *linebuf = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "char *tmpname = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "char *atomic_dir = \"/etc\";"
    },
    {
        "line": 13,
        "fullcodeline": "pw_init();"
    },
    {
        "line": 25,
        "fullcodeline": "pwf = fopen(PASSWD_FILE, \"r\");"
    },
    {
        "line": 29,
        "fullcodeline": "namelen = strlen(pwd->pw_name);"
    },
    {
        "line": 31,
        "fullcodeline": "linebuf = malloc(buflen);"
    },
    {
        "line": 36,
        "fullcodeline": "found = false;"
    },
    {
        "line": 75,
        "fullcodeline": "rc = close_stream(fp);"
    },
    {
        "line": 76,
        "fullcodeline": "fp = NULL;"
    },
    {
        "line": 81,
        "fullcodeline": "pwf = NULL;"
    },
    {
        "line": 100,
        "fullcodeline": "save_errno = errno;"
    },
    {
        "line": 15,
        "fullcodeline": "if ((fp = xfmkstemp(&tmpname, atomic_dir)) == NULL)"
    },
    {
        "line": 26,
        "fullcodeline": "if (!pwf)"
    },
    {
        "line": 32,
        "fullcodeline": "if (!linebuf)"
    },
    {
        "line": 40,
        "fullcodeline": "while (fgets(linebuf, buflen, pwf) != NULL) {"
    },
    {
        "line": 102,
        "fullcodeline": "if (fp != NULL)"
    },
    {
        "line": 104,
        "fullcodeline": "if (tmpname != NULL)"
    },
    {
        "line": 107,
        "fullcodeline": "if (pwf != NULL)"
    },
    {
        "line": 111,
        "fullcodeline": "return -1;"
    },
    {
        "line": 19,
        "fullcodeline": "if (fchown(fileno(fp), (uid_t) 0, (gid_t) 0) < 0)"
    },
    {
        "line": 41,
        "fullcodeline": "contlen = strlen(linebuf);"
    },
    {
        "line": 69,
        "fullcodeline": "fputs(linebuf, fp);"
    },
    {
        "line": 73,
        "fullcodeline": "if (fchmod(fileno(fp), 0644) < 0)"
    },
    {
        "line": 84,
        "fullcodeline": "errno = ENOENT;\t/* give me something better */"
    },
    {
        "line": 93,
        "fullcodeline": "if (rename(tmpname, PASSWD_FILE) < 0)"
    },
    {
        "line": 105,
        "fullcodeline": "unlink(tmpname);"
    },
    {
        "line": 16,
        "fullcodeline": "return -1;"
    },
    {
        "line": 42,
        "fullcodeline": "while (linebuf[contlen - 1] != '\\n' && !feof(pwf)) {"
    },
    {
        "line": 46,
        "fullcodeline": "buflen *= 2;"
    },
    {
        "line": 47,
        "fullcodeline": "tmp = realloc(linebuf, buflen);"
    },
    {
        "line": 50,
        "fullcodeline": "linebuf = tmp;"
    },
    {
        "line": 54,
        "fullcodeline": "contlen = strlen(linebuf);"
    },
    {
        "line": 59,
        "fullcodeline": "if (!found && linebuf[namelen] == ':' &&"
    },
    {
        "line": 60,
        "fullcodeline": "!strncmp(linebuf, pwd->pw_name, namelen)) {"
    },
    {
        "line": 65,
        "fullcodeline": "found = true;"
    },
    {
        "line": 48,
        "fullcodeline": "if (tmp == NULL)"
    },
    {
        "line": 52,
        "fullcodeline": "if (fgets(&linebuf[contlen], buflen / 2, pwf) == NULL)"
    },
    {
        "line": 63,
        "fullcodeline": "if (putpwent(pwd, fp) < 0)"
    }
]