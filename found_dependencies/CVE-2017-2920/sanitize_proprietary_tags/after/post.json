[
    {
        "line": 4,
        "fullcodeline": "bool strip = false;"
    },
    {
        "line": 5,
        "fullcodeline": "bool tag_open = false;"
    },
    {
        "line": 6,
        "fullcodeline": "int tag_open_idx = 0; //Are we within < > ?"
    },
    {
        "line": 7,
        "fullcodeline": "bool closing_tag_open = false; //Are we within </ > ?"
    },
    {
        "line": 8,
        "fullcodeline": "int orig_tag_open_idx = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "bool proprietary_tag = false; //Are we within a proprietary element?"
    },
    {
        "line": 10,
        "fullcodeline": "bool proprietary_closing_tag = false;"
    },
    {
        "line": 11,
        "fullcodeline": "int crop_end_idx = 0;"
    },
    {
        "line": 12,
        "fullcodeline": "char buffer[READ_BUFFER_SIZE] = \"\";"
    },
    {
        "line": 13,
        "fullcodeline": "char tagname[READ_BUFFER_SIZE] = \"\";"
    },
    {
        "line": 14,
        "fullcodeline": "int tagname_idx = 0;"
    },
    {
        "line": 15,
        "fullcodeline": "char close_tagname[READ_BUFFER_SIZE] = \"\";"
    },
    {
        "line": 24,
        "fullcodeline": "size_t input_string_size = input_string.size();"
    },
    {
        "line": 17,
        "fullcodeline": "for (i = 0; i < READ_BUFFER_SIZE; i++)"
    },
    {
        "line": 34,
        "fullcodeline": "for (i = 0; i < std::min(input_string_size, size_t(READ_BUFFER_SIZE)); i++)"
    },
    {
        "line": 107,
        "fullcodeline": "if (proprietary_tag == true && orig_tag_open_idx < input_string.size())"
    },
    {
        "line": 19,
        "fullcodeline": "buffer[i] = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "tagname[i] = 0;"
    },
    {
        "line": 21,
        "fullcodeline": "close_tagname[i] = 0;"
    },
    {
        "line": 113,
        "fullcodeline": "input_string.copy(buffer, (crop_end_idx - orig_tag_open_idx) + 1, orig_tag_open_idx);"
    },
    {
        "line": 114,
        "fullcodeline": "message_out(INFO, \"sanitize_proprietary_tags() (end of line) removed: \" + string(buffer));"
    },
    {
        "line": 115,
        "fullcodeline": "input_string.erase(orig_tag_open_idx, (crop_end_idx - orig_tag_open_idx) + 1);"
    },
    {
        "line": 116,
        "fullcodeline": "input_string_size = input_string.size();"
    },
    {
        "line": 36,
        "fullcodeline": "if (input_string.c_str()[i] == '<')"
    },
    {
        "line": 91,
        "fullcodeline": "if (strip == true && orig_tag_open_idx < input_string.size())"
    },
    {
        "line": 109,
        "fullcodeline": "if (crop_end_idx == 0)   //no closing tag"
    },
    {
        "line": 38,
        "fullcodeline": "tag_open = true;"
    },
    {
        "line": 39,
        "fullcodeline": "tag_open_idx = i;"
    },
    {
        "line": 93,
        "fullcodeline": "input_string.copy(buffer, (crop_end_idx - orig_tag_open_idx) + 1, orig_tag_open_idx);"
    },
    {
        "line": 94,
        "fullcodeline": "message_out(INFO, \"sanitize_proprietary_tags() (end tag or new tag) removed: \" + string(buffer));"
    },
    {
        "line": 95,
        "fullcodeline": "input_string.erase(orig_tag_open_idx, (crop_end_idx - orig_tag_open_idx) + 1);"
    },
    {
        "line": 96,
        "fullcodeline": "i = orig_tag_open_idx - 1;"
    },
    {
        "line": 97,
        "fullcodeline": "proprietary_tag = false;"
    },
    {
        "line": 98,
        "fullcodeline": "proprietary_closing_tag = false;"
    },
    {
        "line": 99,
        "fullcodeline": "closing_tag_open = false;"
    },
    {
        "line": 100,
        "fullcodeline": "tag_open = false;"
    },
    {
        "line": 101,
        "fullcodeline": "strip = false;"
    },
    {
        "line": 103,
        "fullcodeline": "input_string_size = input_string.size();"
    },
    {
        "line": 111,
        "fullcodeline": "crop_end_idx = input_string.size() - 1;"
    },
    {
        "line": 40,
        "fullcodeline": "if (proprietary_tag == true && input_string.c_str()[i+1] == '/')"
    },
    {
        "line": 43,
        "fullcodeline": "closing_tag_open = true;"
    },
    {
        "line": 65,
        "fullcodeline": "else if (input_string.c_str()[i] == '>')"
    },
    {
        "line": 45,
        "fullcodeline": "if (strncmp(tagname, &(input_string.c_str()[i+2]), strlen(tagname)) != 0)"
    },
    {
        "line": 67,
        "fullcodeline": "tag_open = false;"
    },
    {
        "line": 68,
        "fullcodeline": "closing_tag_open = false;"
    },
    {
        "line": 69,
        "fullcodeline": "tagname[tagname_idx] = 0;"
    },
    {
        "line": 70,
        "fullcodeline": "tagname_idx = 0;"
    },
    {
        "line": 49,
        "fullcodeline": "crop_end_idx = i - 1;"
    },
    {
        "line": 50,
        "fullcodeline": "strip = true;"
    },
    {
        "line": 58,
        "fullcodeline": "else if (proprietary_tag == true)"
    },
    {
        "line": 71,
        "fullcodeline": "if (proprietary_closing_tag == true)"
    },
    {
        "line": 55,
        "fullcodeline": "proprietary_closing_tag = true;"
    },
    {
        "line": 61,
        "fullcodeline": "crop_end_idx = i - 1;"
    },
    {
        "line": 62,
        "fullcodeline": "strip = true;"
    },
    {
        "line": 73,
        "fullcodeline": "crop_end_idx = i;"
    },
    {
        "line": 74,
        "fullcodeline": "strip = true;"
    },
    {
        "line": 77,
        "fullcodeline": "else if (tag_open == true && closing_tag_open == false)"
    },
    {
        "line": 87,
        "fullcodeline": "tagname[tagname_idx] = input_string.c_str()[i];"
    },
    {
        "line": 88,
        "fullcodeline": "tagname_idx++;"
    },
    {
        "line": 79,
        "fullcodeline": "if (input_string.c_str()[i] == '.')"
    },
    {
        "line": 81,
        "fullcodeline": "if (proprietary_tag != true)"
    },
    {
        "line": 83,
        "fullcodeline": "orig_tag_open_idx = tag_open_idx;"
    },
    {
        "line": 84,
        "fullcodeline": "proprietary_tag = true;"
    }
]