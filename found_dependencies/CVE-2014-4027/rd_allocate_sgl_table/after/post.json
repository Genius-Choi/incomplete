[
    {
        "line": 4,
        "fullcodeline": "u32 i = 0, j, page_offset = 0, sg_per_table;"
    },
    {
        "line": 5,
        "fullcodeline": "u32 max_sg_per_table = (RD_MAX_ALLOCATION_SIZE /"
    },
    {
        "line": 12,
        "fullcodeline": "sg_per_table = (total_sg_needed > max_sg_per_table) ?"
    },
    {
        "line": 15,
        "fullcodeline": "sg = kzalloc(sg_per_table * sizeof(struct scatterlist),"
    },
    {
        "line": 23,
        "fullcodeline": "sg_init_table(sg, sg_per_table);"
    },
    {
        "line": 25,
        "fullcodeline": "sg_table[i].sg_table = sg;"
    },
    {
        "line": 26,
        "fullcodeline": "sg_table[i].rd_sg_count = sg_per_table;"
    },
    {
        "line": 27,
        "fullcodeline": "sg_table[i].page_start_offset = page_offset;"
    },
    {
        "line": 28,
        "fullcodeline": "sg_table[i++].page_end_offset = (page_offset + sg_per_table)"
    },
    {
        "line": 46,
        "fullcodeline": "page_offset += sg_per_table;"
    },
    {
        "line": 47,
        "fullcodeline": "total_sg_needed -= sg_per_table;"
    },
    {
        "line": 17,
        "fullcodeline": "if (!sg) {"
    },
    {
        "line": 31,
        "fullcodeline": "for (j = 0; j < sg_per_table; j++) {"
    },
    {
        "line": 18,
        "fullcodeline": "pr_err(\"Unable to allocate scatterlist array\""
    },
    {
        "line": 32,
        "fullcodeline": "pg = alloc_pages(GFP_KERNEL, 0);"
    },
    {
        "line": 38,
        "fullcodeline": "sg_assign_page(&sg[j], pg);"
    },
    {
        "line": 39,
        "fullcodeline": "sg[j].length = PAGE_SIZE;"
    },
    {
        "line": 41,
        "fullcodeline": "p = kmap(pg);"
    },
    {
        "line": 42,
        "fullcodeline": "memset(p, init_payload, PAGE_SIZE);"
    },
    {
        "line": 43,
        "fullcodeline": "kunmap(pg);"
    },
    {
        "line": 20,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 33,
        "fullcodeline": "if (!pg) {"
    },
    {
        "line": 34,
        "fullcodeline": "pr_err(\"Unable to allocate scatterlist\""
    },
    {
        "line": 36,
        "fullcodeline": "return -ENOMEM;"
    }
]