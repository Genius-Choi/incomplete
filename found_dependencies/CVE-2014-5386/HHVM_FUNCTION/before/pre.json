[
    {
        "line": 8,
        "fullcodeline": "int n = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "char *iv = (char*)calloc(size + 1, 1);"
    },
    {
        "line": 2,
        "fullcodeline": "if (size <= 0 || size >= INT_MAX) {"
    },
    {
        "line": 34,
        "fullcodeline": "return String(iv, n, AttachString);"
    },
    {
        "line": 3,
        "fullcodeline": "raise_warning(\"Can not create an IV with a size of less than 1 or \""
    },
    {
        "line": 10,
        "fullcodeline": "if (source == RANDOM || source == URANDOM) {"
    },
    {
        "line": 11,
        "fullcodeline": "int fd = open(source == RANDOM ? \"/dev/random\" : \"/dev/urandom\", O_RDONLY);"
    },
    {
        "line": 21,
        "fullcodeline": "n = read_bytes;"
    },
    {
        "line": 12,
        "fullcodeline": "if (fd < 0) {"
    },
    {
        "line": 18,
        "fullcodeline": "for (read_bytes = 0; read_bytes < size && n >= 0; read_bytes += n) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (n < size) {"
    },
    {
        "line": 29,
        "fullcodeline": "n = size;"
    },
    {
        "line": 19,
        "fullcodeline": "n = read(fd, iv + read_bytes, size - read_bytes);"
    },
    {
        "line": 31,
        "fullcodeline": "iv[--size] = (char)(255.0 * rand() / RAND_MAX);"
    }
]