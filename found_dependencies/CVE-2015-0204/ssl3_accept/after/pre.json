[
    {
        "line": 4,
        "fullcodeline": "unsigned long alg_k,Time=(unsigned long)time(NULL);"
    },
    {
        "line": 6,
        "fullcodeline": "int ret= -1;"
    },
    {
        "line": 7,
        "fullcodeline": "int new_state,state,skip=0;"
    },
    {
        "line": 9,
        "fullcodeline": "RAND_add(&Time,sizeof(Time),0);"
    },
    {
        "line": 10,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 11,
        "fullcodeline": "clear_sys_error();"
    },
    {
        "line": 19,
        "fullcodeline": "s->in_handshake++;"
    },
    {
        "line": 658,
        "fullcodeline": "s->in_handshake--;"
    },
    {
        "line": 13,
        "fullcodeline": "if (s->info_callback != NULL)"
    },
    {
        "line": 20,
        "fullcodeline": "if (!SSL_in_init(s) || SSL_in_before(s)) SSL_clear(s);"
    },
    {
        "line": 22,
        "fullcodeline": "if (s->cert == NULL)"
    },
    {
        "line": 14,
        "fullcodeline": "cb=s->info_callback;"
    },
    {
        "line": 24,
        "fullcodeline": "SSLerr(SSL_F_SSL3_ACCEPT,SSL_R_NO_CERTIFICATE_SET);"
    },
    {
        "line": 35,
        "fullcodeline": "s->tlsext_hb_pending = 0;"
    },
    {
        "line": 36,
        "fullcodeline": "s->tlsext_hb_seq++;"
    },
    {
        "line": 42,
        "fullcodeline": "state=s->state;"
    },
    {
        "line": 653,
        "fullcodeline": "skip=0;"
    },
    {
        "line": 660,
        "fullcodeline": "cb(s,SSL_CB_ACCEPT_EXIT,ret);"
    },
    {
        "line": 25,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 15,
        "fullcodeline": "else if (s->ctx->info_callback != NULL)"
    },
    {
        "line": 47,
        "fullcodeline": "s->renegotiate=1;"
    },
    {
        "line": 52,
        "fullcodeline": "case SSL_ST_BEFORE|SSL_ST_ACCEPT:"
    },
    {
        "line": 53,
        "fullcodeline": "case SSL_ST_OK|SSL_ST_ACCEPT:"
    },
    {
        "line": 55,
        "fullcodeline": "s->server=1;"
    },
    {
        "line": 71,
        "fullcodeline": "s->type=SSL_ST_ACCEPT;"
    },
    {
        "line": 95,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 96,
        "fullcodeline": "s->s3->flags &= ~TLS1_FLAGS_SKIP_CERT_VERIFY;"
    },
    {
        "line": 97,
        "fullcodeline": "s->s3->flags &= ~SSL3_FLAGS_CCS_OK;"
    },
    {
        "line": 99,
        "fullcodeline": "s->s3->change_cipher_spec = 0;"
    },
    {
        "line": 136,
        "fullcodeline": "s->shutdown=0;"
    },
    {
        "line": 137,
        "fullcodeline": "ret=ssl3_send_hello_request(s);"
    },
    {
        "line": 139,
        "fullcodeline": "s->s3->tmp.next_state=SSL3_ST_SW_HELLO_REQ_C;"
    },
    {
        "line": 140,
        "fullcodeline": "s->state=SSL3_ST_SW_FLUSH;"
    },
    {
        "line": 141,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 143,
        "fullcodeline": "ssl3_init_finished_mac(s);"
    },
    {
        "line": 147,
        "fullcodeline": "s->state=SSL_ST_OK;"
    },
    {
        "line": 154,
        "fullcodeline": "ret=ssl3_get_client_hello(s);"
    },
    {
        "line": 157,
        "fullcodeline": "s->state = SSL3_ST_SR_CLNT_HELLO_D;"
    },
    {
        "line": 181,
        "fullcodeline": "s->renegotiate = 2;"
    },
    {
        "line": 182,
        "fullcodeline": "s->state=SSL3_ST_SW_SRVR_HELLO_A;"
    },
    {
        "line": 183,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 188,
        "fullcodeline": "ret=ssl3_send_server_hello(s);"
    },
    {
        "line": 204,
        "fullcodeline": "s->init_num = 0;"
    },
    {
        "line": 234,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 286,
        "fullcodeline": "s->state=SSL3_ST_SW_CERT_REQ_A;"
    },
    {
        "line": 287,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 338,
        "fullcodeline": "ret=ssl3_send_server_done(s);"
    },
    {
        "line": 340,
        "fullcodeline": "s->s3->tmp.next_state=SSL3_ST_SR_CERT_A;"
    },
    {
        "line": 341,
        "fullcodeline": "s->state=SSL3_ST_SW_FLUSH;"
    },
    {
        "line": 342,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 357,
        "fullcodeline": "s->rwstate=SSL_WRITING;"
    },
    {
        "line": 363,
        "fullcodeline": "s->rwstate=SSL_NOTHING;"
    },
    {
        "line": 365,
        "fullcodeline": "s->state=s->s3->tmp.next_state;"
    },
    {
        "line": 375,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 376,
        "fullcodeline": "s->state=SSL3_ST_SR_KEY_EXCH_A;"
    },
    {
        "line": 381,
        "fullcodeline": "ret=ssl3_get_client_key_exchange(s);"
    },
    {
        "line": 466,
        "fullcodeline": "ret=ssl3_get_cert_verify(s);"
    },
    {
        "line": 477,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 496,
        "fullcodeline": "ret=ssl3_get_next_proto(s);"
    },
    {
        "line": 498,
        "fullcodeline": "s->init_num = 0;"
    },
    {
        "line": 499,
        "fullcodeline": "s->state=SSL3_ST_SR_FINISHED_A;"
    },
    {
        "line": 517,
        "fullcodeline": "ret=ssl3_get_finished(s,SSL3_ST_SR_FINISHED_A,"
    },
    {
        "line": 528,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 534,
        "fullcodeline": "ret=ssl3_send_newsession_ticket(s);"
    },
    {
        "line": 536,
        "fullcodeline": "s->state=SSL3_ST_SW_CHANGE_A;"
    },
    {
        "line": 537,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 542,
        "fullcodeline": "ret=ssl3_send_cert_status(s);"
    },
    {
        "line": 544,
        "fullcodeline": "s->state=SSL3_ST_SW_KEY_EXCH_A;"
    },
    {
        "line": 545,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 557,
        "fullcodeline": "ret=ssl3_send_change_cipher_spec(s,"
    },
    {
        "line": 561,
        "fullcodeline": "s->state=SSL3_ST_SW_FINISHED_A;"
    },
    {
        "line": 562,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 575,
        "fullcodeline": "ret=ssl3_send_finished(s,"
    },
    {
        "line": 580,
        "fullcodeline": "s->state=SSL3_ST_SW_FLUSH;"
    },
    {
        "line": 596,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 601,
        "fullcodeline": "ssl3_cleanup_key_block(s);"
    },
    {
        "line": 604,
        "fullcodeline": "s->init_buf=NULL;"
    },
    {
        "line": 607,
        "fullcodeline": "ssl_free_wbio_buffer(s);"
    },
    {
        "line": 609,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 625,
        "fullcodeline": "ret = 1;"
    },
    {
        "line": 630,
        "fullcodeline": "SSLerr(SSL_F_SSL3_ACCEPT,SSL_R_UNKNOWN_STATE);"
    },
    {
        "line": 631,
        "fullcodeline": "ret= -1;"
    },
    {
        "line": 636,
        "fullcodeline": "if (!s->s3->tmp.reuse_message && !skip)"
    },
    {
        "line": 16,
        "fullcodeline": "cb=s->ctx->info_callback;"
    },
    {
        "line": 56,
        "fullcodeline": "if (cb != NULL) cb(s,SSL_CB_HANDSHAKE_START,1);"
    },
    {
        "line": 73,
        "fullcodeline": "if (s->init_buf == NULL)"
    },
    {
        "line": 101,
        "fullcodeline": "if (s->state != SSL_ST_RENEGOTIATE)"
    },
    {
        "line": 138,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 155,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 189,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 339,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 382,
        "fullcodeline": "if (ret <= 0)"
    },
    {
        "line": 463,
        "fullcodeline": "if (!s->s3->change_cipher_spec)"
    },
    {
        "line": 467,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 493,
        "fullcodeline": "if (!s->s3->change_cipher_spec)"
    },
    {
        "line": 497,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 515,
        "fullcodeline": "if (!s->s3->change_cipher_spec)"
    },
    {
        "line": 519,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 535,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 543,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 560,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 579,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 611,
        "fullcodeline": "if (s->renegotiate == 2) /* skipped if we just sent a HelloRequest */"
    },
    {
        "line": 58,
        "fullcodeline": "if ((s->version>>8) != 3)"
    },
    {
        "line": 64,
        "fullcodeline": "if (!ssl_security(s, SSL_SECOP_VERSION, 0,"
    },
    {
        "line": 67,
        "fullcodeline": "SSLerr(SSL_F_SSL3_ACCEPT, SSL_R_VERSION_TOO_LOW);"
    },
    {
        "line": 86,
        "fullcodeline": "s->init_buf=buf;"
    },
    {
        "line": 89,
        "fullcodeline": "if (!ssl3_setup_buffers(s))"
    },
    {
        "line": 91,
        "fullcodeline": "ret= -1;"
    },
    {
        "line": 108,
        "fullcodeline": "ssl3_init_finished_mac(s);"
    },
    {
        "line": 109,
        "fullcodeline": "s->state=SSL3_ST_SR_CLNT_HELLO_A;"
    },
    {
        "line": 167,
        "fullcodeline": "if (ret != SSL_ERROR_NONE)"
    },
    {
        "line": 211,
        "fullcodeline": "if (!(s->s3->tmp.new_cipher->algorithm_auth & (SSL_aNULL|SSL_aKRB5|SSL_aSRP))"
    },
    {
        "line": 212,
        "fullcodeline": "&& !(s->s3->tmp.new_cipher->algorithm_mkey & SSL_kPSK))"
    },
    {
        "line": 214,
        "fullcodeline": "ret=ssl3_send_server_certificate(s);"
    },
    {
        "line": 280,
        "fullcodeline": "ret=ssl3_send_server_key_exchange(s);"
    },
    {
        "line": 293,
        "fullcodeline": "!(s->verify_mode & SSL_VERIFY_PEER) ||"
    },
    {
        "line": 311,
        "fullcodeline": "|| (s->s3->tmp.new_cipher->algorithm_mkey & SSL_kPSK))"
    },
    {
        "line": 314,
        "fullcodeline": "skip=1;"
    },
    {
        "line": 316,
        "fullcodeline": "s->state=SSL3_ST_SW_SRVR_DONE_A;"
    },
    {
        "line": 358,
        "fullcodeline": "if (BIO_flush(s->wbio) <= 0)"
    },
    {
        "line": 360,
        "fullcodeline": "ret= -1;"
    },
    {
        "line": 372,
        "fullcodeline": "ret=ssl3_get_client_certificate(s);"
    },
    {
        "line": 402,
        "fullcodeline": "s->init_num = 0;"
    },
    {
        "line": 464,
        "fullcodeline": "s->s3->flags |= SSL3_FLAGS_CCS_OK;"
    },
    {
        "line": 473,
        "fullcodeline": "s->state=SSL3_ST_SR_NEXT_PROTO_A;"
    },
    {
        "line": 494,
        "fullcodeline": "s->s3->flags |= SSL3_FLAGS_CCS_OK;"
    },
    {
        "line": 516,
        "fullcodeline": "s->s3->flags |= SSL3_FLAGS_CCS_OK;"
    },
    {
        "line": 521,
        "fullcodeline": "s->state=SSL_ST_OK;"
    },
    {
        "line": 554,
        "fullcodeline": "if (!s->method->ssl3_enc->setup_key_block(s))"
    },
    {
        "line": 555,
        "fullcodeline": "{ ret= -1; goto end; }"
    },
    {
        "line": 564,
        "fullcodeline": "if (!s->method->ssl3_enc->change_cipher_state(s,"
    },
    {
        "line": 567,
        "fullcodeline": "ret= -1;"
    },
    {
        "line": 613,
        "fullcodeline": "s->renegotiate=0;"
    },
    {
        "line": 614,
        "fullcodeline": "s->new_session=0;"
    },
    {
        "line": 616,
        "fullcodeline": "ssl_update_cache(s,SSL_SESS_CACHE_SERVER);"
    },
    {
        "line": 620,
        "fullcodeline": "s->handshake_func=ssl3_accept;"
    },
    {
        "line": 645,
        "fullcodeline": "if ((cb != NULL) && (s->state != state))"
    },
    {
        "line": 647,
        "fullcodeline": "new_state=s->state;"
    },
    {
        "line": 648,
        "fullcodeline": "s->state=state;"
    },
    {
        "line": 649,
        "fullcodeline": "cb(s,SSL_CB_ACCEPT_LOOP,1);"
    },
    {
        "line": 650,
        "fullcodeline": "s->state=new_state;"
    },
    {
        "line": 61,
        "fullcodeline": "return -1;"
    },
    {
        "line": 68,
        "fullcodeline": "return -1;"
    },
    {
        "line": 75,
        "fullcodeline": "if ((buf=BUF_MEM_new()) == NULL)"
    },
    {
        "line": 161,
        "fullcodeline": "if ((ret = ssl_check_srp_ext_ClientHello(s,&al))  < 0)"
    },
    {
        "line": 164,
        "fullcodeline": "s->rwstate=SSL_X509_LOOKUP;"
    },
    {
        "line": 169,
        "fullcodeline": "ssl3_send_alert(s,SSL3_AL_FATAL,al);"
    },
    {
        "line": 174,
        "fullcodeline": "ret = SSL_TLSEXT_ERR_ALERT_FATAL;"
    },
    {
        "line": 175,
        "fullcodeline": "ret= -1;"
    },
    {
        "line": 203,
        "fullcodeline": "s->state = SSL3_ST_SW_CERT_A;"
    },
    {
        "line": 215,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 224,
        "fullcodeline": "skip = 1;"
    },
    {
        "line": 225,
        "fullcodeline": "s->state=SSL3_ST_SW_KEY_EXCH_A;"
    },
    {
        "line": 281,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 284,
        "fullcodeline": "skip=1;"
    },
    {
        "line": 308,
        "fullcodeline": "(s->s3->tmp.new_cipher->algorithm_auth & SSL_aSRP)"
    },
    {
        "line": 324,
        "fullcodeline": "ret=ssl3_send_certificate_request(s);"
    },
    {
        "line": 327,
        "fullcodeline": "s->state=SSL3_ST_SW_SRVR_DONE_A;"
    },
    {
        "line": 332,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 373,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 475,
        "fullcodeline": "s->state=SSL3_ST_SR_FINISHED_A;"
    },
    {
        "line": 595,
        "fullcodeline": "s->s3->tmp.next_state=SSL_ST_OK;"
    },
    {
        "line": 622,
        "fullcodeline": "if (cb != NULL) cb(s,SSL_CB_HANDSHAKE_DONE,1);"
    },
    {
        "line": 77,
        "fullcodeline": "ret= -1;"
    },
    {
        "line": 80,
        "fullcodeline": "if (!BUF_MEM_grow(buf,SSL3_RT_MAX_PLAIN_LENGTH))"
    },
    {
        "line": 83,
        "fullcodeline": "ret= -1;"
    },
    {
        "line": 106,
        "fullcodeline": "if (!ssl_init_wbio_buffer(s,1)) { ret= -1; goto end; }"
    },
    {
        "line": 172,
        "fullcodeline": "if (al != TLS1_AD_UNKNOWN_PSK_IDENTITY)"
    },
    {
        "line": 194,
        "fullcodeline": "s->state=SSL3_ST_SW_SESSION_TICKET_A;"
    },
    {
        "line": 218,
        "fullcodeline": "s->state=SSL3_ST_SW_CERT_STATUS_A;"
    },
    {
        "line": 306,
        "fullcodeline": "(s->s3->tmp.new_cipher->algorithm_auth & SSL_aKRB5) ||"
    },
    {
        "line": 325,
        "fullcodeline": "if (ret <= 0) goto end;"
    },
    {
        "line": 398,
        "fullcodeline": "s->state=SSL3_ST_SR_NEXT_PROTO_A;"
    },
    {
        "line": 404,
        "fullcodeline": "else if (SSL_USE_SIGALGS(s))"
    },
    {
        "line": 588,
        "fullcodeline": "s->s3->tmp.next_state=SSL3_ST_SR_NEXT_PROTO_A;"
    },
    {
        "line": 640,
        "fullcodeline": "if ((ret=BIO_flush(s->wbio)) <= 0)"
    },
    {
        "line": 112,
        "fullcodeline": "else if (!s->s3->send_connection_binding &&"
    },
    {
        "line": 113,
        "fullcodeline": "!(s->options & SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION))"
    },
    {
        "line": 119,
        "fullcodeline": "SSLerr(SSL_F_SSL3_ACCEPT, SSL_R_UNSAFE_LEGACY_RENEGOTIATION_DISABLED);"
    },
    {
        "line": 120,
        "fullcodeline": "ssl3_send_alert(s,SSL3_AL_FATAL,SSL_AD_HANDSHAKE_FAILURE);"
    },
    {
        "line": 121,
        "fullcodeline": "ret = -1;"
    },
    {
        "line": 173,
        "fullcodeline": "SSLerr(SSL_F_SSL3_ACCEPT,SSL_R_CLIENTHELLO_TLSEXT);"
    },
    {
        "line": 196,
        "fullcodeline": "s->state=SSL3_ST_SW_CHANGE_A;"
    },
    {
        "line": 220,
        "fullcodeline": "s->state=SSL3_ST_SW_KEY_EXCH_A;"
    },
    {
        "line": 301,
        "fullcodeline": "((s->s3->tmp.new_cipher->algorithm_auth & SSL_aNULL) &&"
    },
    {
        "line": 400,
        "fullcodeline": "s->state=SSL3_ST_SR_FINISHED_A;"
    },
    {
        "line": 406,
        "fullcodeline": "s->state=SSL3_ST_SR_CERT_VRFY_A;"
    },
    {
        "line": 407,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 418,
        "fullcodeline": "s->s3->flags |= TLS1_FLAGS_KEEP_HANDSHAKE;"
    },
    {
        "line": 524,
        "fullcodeline": "s->state=SSL3_ST_SW_SESSION_TICKET_A;"
    },
    {
        "line": 591,
        "fullcodeline": "s->s3->tmp.next_state=SSL3_ST_SR_FINISHED_A;"
    },
    {
        "line": 129,
        "fullcodeline": "s->state=SSL3_ST_SW_HELLO_REQ_A;"
    },
    {
        "line": 296,
        "fullcodeline": "((s->session->peer != NULL) &&"
    },
    {
        "line": 304,
        "fullcodeline": "!(s->verify_mode & SSL_VERIFY_FAIL_IF_NO_PEER_CERT)) ||"
    },
    {
        "line": 318,
        "fullcodeline": "if (!ssl3_digest_cached_records(s))"
    },
    {
        "line": 408,
        "fullcodeline": "if (!s->session->peer)"
    },
    {
        "line": 424,
        "fullcodeline": "int offset=0;"
    },
    {
        "line": 427,
        "fullcodeline": "s->state=SSL3_ST_SR_CERT_VRFY_A;"
    },
    {
        "line": 428,
        "fullcodeline": "s->init_num=0;"
    },
    {
        "line": 527,
        "fullcodeline": "s->state=SSL3_ST_SW_CHANGE_A;"
    },
    {
        "line": 297,
        "fullcodeline": "(s->verify_mode & SSL_VERIFY_CLIENT_ONCE)) ||"
    },
    {
        "line": 319,
        "fullcodeline": "return -1;"
    },
    {
        "line": 419,
        "fullcodeline": "if (!ssl3_digest_cached_records(s))"
    },
    {
        "line": 438,
        "fullcodeline": "for (dgst_num=0; dgst_num<SSL_MAX_DIGEST;dgst_num++)"
    },
    {
        "line": 416,
        "fullcodeline": "return -1;"
    },
    {
        "line": 420,
        "fullcodeline": "return -1;"
    },
    {
        "line": 443,
        "fullcodeline": "s->method->ssl3_enc->cert_verify_mac(s,EVP_MD_CTX_type(s->s3->handshake_dgst[dgst_num]),&(s->s3->tmp.cert_verify_md[offset]));"
    },
    {
        "line": 444,
        "fullcodeline": "dgst_size=EVP_MD_CTX_size(s->s3->handshake_dgst[dgst_num]);"
    },
    {
        "line": 436,
        "fullcodeline": "if (!ssl3_digest_cached_records(s))"
    },
    {
        "line": 445,
        "fullcodeline": "if (dgst_size < 0)"
    },
    {
        "line": 437,
        "fullcodeline": "return -1;"
    },
    {
        "line": 447,
        "fullcodeline": "ret = -1;"
    }
]