[
    {
        "line": 6,
        "fullcodeline": "int verified = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "int reqd_sigs = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "bool reqd_policy_all = true;"
    },
    {
        "line": 12,
        "fullcodeline": "sig_node = fdt_subnode_offset(sig_blob, 0, FIT_SIG_NODENAME);"
    },
    {
        "line": 20,
        "fullcodeline": "reqd_mode = fdt_getprop(sig_blob, sig_node, \"required-mode\", NULL);"
    },
    {
        "line": 24,
        "fullcodeline": "debug(\"%s: required-mode policy set to '%s'\\n\", __func__,"
    },
    {
        "line": 27,
        "fullcodeline": "fdt_for_each_subnode(noffset, sig_blob, sig_node) {"
    },
    {
        "line": 13,
        "fullcodeline": "if (sig_node < 0) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (reqd_mode && !strcmp(reqd_mode, \"any\"))"
    },
    {
        "line": 25,
        "fullcodeline": "reqd_policy_all ? \"all\" : \"any\");"
    },
    {
        "line": 31,
        "fullcodeline": "required = fdt_getprop(sig_blob, noffset, FIT_KEY_REQUIRED,"
    },
    {
        "line": 36,
        "fullcodeline": "reqd_sigs++;"
    },
    {
        "line": 38,
        "fullcodeline": "ret = fit_config_verify_sig(fit, conf_noffset, sig_blob,"
    },
    {
        "line": 53,
        "fullcodeline": "if (reqd_sigs && !verified) {"
    },
    {
        "line": 14,
        "fullcodeline": "debug(\"%s: No signature node found: %s\\n\", __func__,"
    },
    {
        "line": 22,
        "fullcodeline": "reqd_policy_all = false;"
    },
    {
        "line": 33,
        "fullcodeline": "if (!required || strcmp(required, \"conf\"))"
    },
    {
        "line": 54,
        "fullcodeline": "printf(\"Failed to verify 'any' of the required signature(s)\\n\");"
    },
    {
        "line": 15,
        "fullcodeline": "fdt_strerror(sig_node));"
    },
    {
        "line": 55,
        "fullcodeline": "return -EPERM;"
    },
    {
        "line": 47,
        "fullcodeline": "verified++;"
    },
    {
        "line": 42,
        "fullcodeline": "printf(\"Failed to verify required signature '%s'\\n\","
    },
    {
        "line": 48,
        "fullcodeline": "if (!reqd_policy_all)"
    },
    {
        "line": 43,
        "fullcodeline": "fit_get_name(sig_blob, noffset, NULL));"
    }
]