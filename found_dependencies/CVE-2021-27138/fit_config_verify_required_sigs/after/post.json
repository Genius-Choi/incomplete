[
    {
        "line": 4,
        "fullcodeline": "const char *name = fit_get_name(fit, conf_noffset, NULL);"
    },
    {
        "line": 7,
        "fullcodeline": "int verified = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "int reqd_sigs = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "bool reqd_policy_all = true;"
    },
    {
        "line": 22,
        "fullcodeline": "sig_node = fdt_subnode_offset(sig_blob, 0, FIT_SIG_NODENAME);"
    },
    {
        "line": 30,
        "fullcodeline": "reqd_mode = fdt_getprop(sig_blob, sig_node, \"required-mode\", NULL);"
    },
    {
        "line": 34,
        "fullcodeline": "debug(\"%s: required-mode policy set to '%s'\\n\", __func__,"
    },
    {
        "line": 37,
        "fullcodeline": "fdt_for_each_subnode(noffset, sig_blob, sig_node) {"
    },
    {
        "line": 16,
        "fullcodeline": "if (strchr(name, '@')) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (sig_node < 0) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (reqd_mode && !strcmp(reqd_mode, \"any\"))"
    },
    {
        "line": 35,
        "fullcodeline": "reqd_policy_all ? \"all\" : \"any\");"
    },
    {
        "line": 41,
        "fullcodeline": "required = fdt_getprop(sig_blob, noffset, FIT_KEY_REQUIRED,"
    },
    {
        "line": 46,
        "fullcodeline": "reqd_sigs++;"
    },
    {
        "line": 48,
        "fullcodeline": "ret = fit_config_verify_sig(fit, conf_noffset, sig_blob,"
    },
    {
        "line": 63,
        "fullcodeline": "if (reqd_sigs && !verified) {"
    },
    {
        "line": 17,
        "fullcodeline": "printf(\"Configuration node '%s' contains '@'\\n\", name);"
    },
    {
        "line": 24,
        "fullcodeline": "debug(\"%s: No signature node found: %s\\n\", __func__,"
    },
    {
        "line": 32,
        "fullcodeline": "reqd_policy_all = false;"
    },
    {
        "line": 43,
        "fullcodeline": "if (!required || strcmp(required, \"conf\"))"
    },
    {
        "line": 64,
        "fullcodeline": "printf(\"Failed to verify 'any' of the required signature(s)\\n\");"
    },
    {
        "line": 18,
        "fullcodeline": "return -EPERM;"
    },
    {
        "line": 25,
        "fullcodeline": "fdt_strerror(sig_node));"
    },
    {
        "line": 65,
        "fullcodeline": "return -EPERM;"
    },
    {
        "line": 57,
        "fullcodeline": "verified++;"
    },
    {
        "line": 52,
        "fullcodeline": "printf(\"Failed to verify required signature '%s'\\n\","
    },
    {
        "line": 58,
        "fullcodeline": "if (!reqd_policy_all)"
    },
    {
        "line": 53,
        "fullcodeline": "fit_get_name(sig_blob, noffset, NULL));"
    }
]