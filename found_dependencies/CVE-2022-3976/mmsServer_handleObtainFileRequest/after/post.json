[
    {
        "line": 7,
        "fullcodeline": "char sourceFilename[256];"
    },
    {
        "line": 8,
        "fullcodeline": "bool hasSourceFileName = false;"
    },
    {
        "line": 10,
        "fullcodeline": "char destinationFilename[256];"
    },
    {
        "line": 11,
        "fullcodeline": "bool hasDestinationFilename = false;"
    },
    {
        "line": 147,
        "fullcodeline": "mmsMsg_createMmsRejectPdu(&invokeId, MMS_ERROR_REJECT_REQUEST_INVALID_ARGUMENT, response);"
    },
    {
        "line": 151,
        "fullcodeline": "createServiceErrorObtainFileError(invokeId, response, MMS_ERROR_FILE_FILE_ACCESS_DENIED, 1);"
    },
    {
        "line": 155,
        "fullcodeline": "createServiceErrorObtainFileError(invokeId, response, MMS_ERROR_FILE_DUPLICATE_FILENAME, 1);"
    },
    {
        "line": 159,
        "fullcodeline": "mmsMsg_createServiceErrorPdu(invokeId, response, MMS_ERROR_ACCESS_TEMPORARILY_UNAVAILABLE);"
    },
    {
        "line": 163,
        "fullcodeline": "mmsMsg_createMmsRejectPdu(&invokeId, MMS_ERROR_REJECT_INVALID_PDU, response);"
    },
    {
        "line": 13,
        "fullcodeline": "while (bufPos < maxBufPos) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (hasSourceFileName && hasDestinationFilename) {"
    },
    {
        "line": 14,
        "fullcodeline": "uint8_t tag = buffer[bufPos++];"
    },
    {
        "line": 17,
        "fullcodeline": "bufPos = BerDecoder_decodeLength(buffer, &length, bufPos, maxBufPos);"
    },
    {
        "line": 85,
        "fullcodeline": "char extendedFileName[sizeof(CONFIG_VIRTUAL_FILESTORE_BASEPATH) + 256];"
    },
    {
        "line": 87,
        "fullcodeline": "mmsMsg_createExtendedFilename(MmsServerConnection_getFilesystemBasepath(connection),"
    },
    {
        "line": 101,
        "fullcodeline": "MmsObtainFileTask task = MmsServer_getObtainFileTask(connection->server);"
    },
    {
        "line": 19,
        "fullcodeline": "if (bufPos < 0) goto exit_reject_invalid_pdu;"
    },
    {
        "line": 52,
        "fullcodeline": "if (mmsMsg_isFilenameSave(destinationFilename) == false) {"
    },
    {
        "line": 62,
        "fullcodeline": "if (connection->server->fileAccessHandler != NULL) {"
    },
    {
        "line": 88,
        "fullcodeline": "sizeof(CONFIG_VIRTUAL_FILESTORE_BASEPATH) + 256,"
    },
    {
        "line": 92,
        "fullcodeline": "if (FileSystem_getFileInfo(extendedFileName, NULL, NULL)) {"
    },
    {
        "line": 103,
        "fullcodeline": "if (task != NULL) {"
    },
    {
        "line": 28,
        "fullcodeline": "hasSourceFileName = true;"
    },
    {
        "line": 37,
        "fullcodeline": "hasDestinationFilename = true;"
    },
    {
        "line": 45,
        "fullcodeline": "bufPos += length;"
    },
    {
        "line": 63,
        "fullcodeline": "MmsError access = connection->server->fileAccessHandler(connection->server->fileAccessHandlerParameter,"
    },
    {
        "line": 99,
        "fullcodeline": "printf(\"MMS_SERVER: Start download file %s from client to local file %s...\\n\", sourceFilename, destinationFilename);"
    },
    {
        "line": 105,
        "fullcodeline": "FileHandle fileHandle = openFile(MmsServerConnection_getFilesystemBasepath(connection),"
    },
    {
        "line": 108,
        "fullcodeline": "task->connection = connection;"
    },
    {
        "line": 109,
        "fullcodeline": "task->obtainFileRequestInvokeId = invokeId;"
    },
    {
        "line": 135,
        "fullcodeline": "Semaphore_post(task->taskLock);"
    },
    {
        "line": 25,
        "fullcodeline": "if (!mmsMsg_parseFileName(sourceFilename, buffer, &bufPos, bufPos + length, invokeId, response))"
    },
    {
        "line": 34,
        "fullcodeline": "if (!mmsMsg_parseFileName(destinationFilename, buffer, &bufPos, bufPos + length, invokeId, response))"
    },
    {
        "line": 66,
        "fullcodeline": "if (access != MMS_ERROR_NONE) {"
    },
    {
        "line": 74,
        "fullcodeline": "if (connection->server->obtainFileHandler(connection->server->obtainFileHandlerParameter, connection, sourceFilename, destinationFilename) == false)"
    },
    {
        "line": 111,
        "fullcodeline": "if (fileHandle == NULL) {"
    },
    {
        "line": 56,
        "fullcodeline": "printf(\"MMS_SERVER: remote provided unsave filename -> rejected\\n\");"
    },
    {
        "line": 67,
        "fullcodeline": "mmsMsg_createServiceErrorPdu(invokeId, response, access);"
    },
    {
        "line": 94,
        "fullcodeline": "printf(\"MMS_SERVER: obtainFile - file already exists on server\\n\");"
    },
    {
        "line": 112,
        "fullcodeline": "task->state = MMS_FILE_UPLOAD_STATE_SEND_OBTAIN_FILE_ERROR_DESTINATION;"
    },
    {
        "line": 116,
        "fullcodeline": "task->lastRequestInvokeId = MmsServerConnection_getNextRequestInvokeId(connection);"
    },
    {
        "line": 117,
        "fullcodeline": "task->fileHandle = fileHandle;"
    },
    {
        "line": 119,
        "fullcodeline": "StringUtils_copyStringMax(task->destinationFilename, 256, destinationFilename);"
    },
    {
        "line": 121,
        "fullcodeline": "ByteBuffer* request = MmsServer_reserveTransmitBuffer(connection->server);"
    },
    {
        "line": 123,
        "fullcodeline": "mmsClient_createFileOpenRequest(task->lastRequestInvokeId, request, sourceFilename, 0);"
    },
    {
        "line": 125,
        "fullcodeline": "IsoConnection_sendMessage(task->connection->isoConnection, request);"
    },
    {
        "line": 127,
        "fullcodeline": "MmsServer_releaseTransmitBuffer(connection->server);"
    },
    {
        "line": 129,
        "fullcodeline": "task->nextTimeout = Hal_getTimeInMs() + 2000; /* timeout 2000 ms */"
    },
    {
        "line": 131,
        "fullcodeline": "task->state = MMS_FILE_UPLOAD_STATE_FILE_OPEN_SENT;"
    }
]