[
    {
        "line": 3,
        "fullcodeline": "const char *safepath = SAFE_PATH;"
    },
    {
        "line": 4,
        "fullcodeline": "const char *confpath = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "char *shargv[] = { NULL, NULL };"
    },
    {
        "line": 8,
        "fullcodeline": "char cmdline[LINE_MAX];"
    },
    {
        "line": 9,
        "fullcodeline": "char myname[_PW_NAME_LEN + 1];"
    },
    {
        "line": 13,
        "fullcodeline": "uid_t target = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "gid_t groups[NGROUPS_MAX + 1];"
    },
    {
        "line": 17,
        "fullcodeline": "int sflag = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "int nflag = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "char cwdpath[PATH_MAX];"
    },
    {
        "line": 21,
        "fullcodeline": "char *login_style = NULL;"
    },
    {
        "line": 25,
        "fullcodeline": "setprogname(\"doas\");"
    },
    {
        "line": 29,
        "fullcodeline": "closefrom(STDERR_FILENO + 1);"
    },
    {
        "line": 32,
        "fullcodeline": "uid = getuid();"
    },
    {
        "line": 64,
        "fullcodeline": "argv += optind;"
    },
    {
        "line": 65,
        "fullcodeline": "argc -= optind;"
    },
    {
        "line": 73,
        "fullcodeline": "original_pw = getpwuid(uid);"
    },
    {
        "line": 79,
        "fullcodeline": "ngroups = getgroups(NGROUPS_MAX, groups);"
    },
    {
        "line": 82,
        "fullcodeline": "groups[ngroups++] = getgid();"
    },
    {
        "line": 105,
        "fullcodeline": "parseconfig(DOAS_CONF, 1);"
    },
    {
        "line": 108,
        "fullcodeline": "(void)strlcpy(cmdline, argv[0], sizeof(cmdline));"
    },
    {
        "line": 116,
        "fullcodeline": "cmd = argv[0];"
    },
    {
        "line": 237,
        "fullcodeline": "target_pw = getpwuid(target);"
    },
    {
        "line": 279,
        "fullcodeline": "syslog(LOG_AUTHPRIV | LOG_INFO, \"%s ran command %s as %s from %s\","
    },
    {
        "line": 282,
        "fullcodeline": "envp = prepenv(rule, original_pw, target_pw);"
    },
    {
        "line": 288,
        "fullcodeline": "execvpe(cmd, argv, envp);"
    },
    {
        "line": 291,
        "fullcodeline": "err(1, \"%s\", cmd);"
    },
    {
        "line": 34,
        "fullcodeline": "while ((ch = getopt(argc, argv, \"a:C:nsu:\")) != -1) {"
    },
    {
        "line": 74,
        "fullcodeline": "if (! original_pw)"
    },
    {
        "line": 76,
        "fullcodeline": "if (strlcpy(myname, original_pw->pw_name, sizeof(myname)) >= sizeof(myname))"
    },
    {
        "line": 80,
        "fullcodeline": "if (ngroups == -1)"
    },
    {
        "line": 102,
        "fullcodeline": "if (geteuid())"
    },
    {
        "line": 109,
        "fullcodeline": "for (i = 1; i < argc; i++) {"
    },
    {
        "line": 117,
        "fullcodeline": "if (!permit(uid, groups, ngroups, &rule, target, cmd,"
    },
    {
        "line": 124,
        "fullcodeline": "if (!(rule->options & NOPASS)) {"
    },
    {
        "line": 238,
        "fullcodeline": "if (! target_pw)"
    },
    {
        "line": 251,
        "fullcodeline": "if (setregid(target_pw->pw_gid, target_pw->pw_gid) == -1)"
    },
    {
        "line": 254,
        "fullcodeline": "if (initgroups(target_pw->pw_name, target_pw->pw_gid) == -1)"
    },
    {
        "line": 260,
        "fullcodeline": "if (setreuid(target, target) == -1)"
    },
    {
        "line": 269,
        "fullcodeline": "if (getcwd(cwdpath, sizeof(cwdpath)) == NULL)"
    },
    {
        "line": 289,
        "fullcodeline": "if (errno == ENOENT)"
    },
    {
        "line": 75,
        "fullcodeline": "err(1, \"getpwuid failed\");"
    },
    {
        "line": 77,
        "fullcodeline": "errx(1, \"pw_name too long\");"
    },
    {
        "line": 81,
        "fullcodeline": "err(1, \"can't get groups\");"
    },
    {
        "line": 85,
        "fullcodeline": "sh = getenv(\"SHELL\");"
    },
    {
        "line": 92,
        "fullcodeline": "argv = shargv;"
    },
    {
        "line": 93,
        "fullcodeline": "argc = 1;"
    },
    {
        "line": 97,
        "fullcodeline": "checkconfig(confpath, argc, argv, uid, groups, ngroups,"
    },
    {
        "line": 103,
        "fullcodeline": "errx(1, \"not installed setuid\");"
    },
    {
        "line": 119,
        "fullcodeline": "syslog(LOG_AUTHPRIV | LOG_NOTICE,"
    },
    {
        "line": 121,
        "fullcodeline": "errc(1, EPERM, NULL);"
    },
    {
        "line": 239,
        "fullcodeline": "errx(1, \"no passwd entry for target\");"
    },
    {
        "line": 252,
        "fullcodeline": "err(1, \"setregid\");"
    },
    {
        "line": 255,
        "fullcodeline": "err(1, \"initgroups\");"
    },
    {
        "line": 261,
        "fullcodeline": "err(1, \"setreuid\");"
    },
    {
        "line": 270,
        "fullcodeline": "cwd = \"(failed)\";"
    },
    {
        "line": 290,
        "fullcodeline": "errx(1, \"%s: command not found\", cmd);"
    },
    {
        "line": 86,
        "fullcodeline": "if (sh == NULL || *sh == '\\0') {"
    },
    {
        "line": 110,
        "fullcodeline": "if (strlcat(cmdline, \" \", sizeof(cmdline)) >= sizeof(cmdline))"
    },
    {
        "line": 112,
        "fullcodeline": "if (strlcat(cmdline, argv[i], sizeof(cmdline)) >= sizeof(cmdline))"
    },
    {
        "line": 118,
        "fullcodeline": "(const char **)argv + 1)) {"
    },
    {
        "line": 272,
        "fullcodeline": "cwd = cwdpath;"
    },
    {
        "line": 285,
        "fullcodeline": "if (setenv(\"PATH\", safepath, 1) == -1)"
    },
    {
        "line": 38,
        "fullcodeline": "login_style = optarg;"
    },
    {
        "line": 41,
        "fullcodeline": "confpath = optarg;"
    },
    {
        "line": 54,
        "fullcodeline": "nflag = 1;"
    },
    {
        "line": 57,
        "fullcodeline": "sflag = 1;"
    },
    {
        "line": 60,
        "fullcodeline": "usage();"
    },
    {
        "line": 69,
        "fullcodeline": "usage();"
    },
    {
        "line": 70,
        "fullcodeline": "} else if ((!sflag && !argc) || (sflag && argc))"
    },
    {
        "line": 87,
        "fullcodeline": "shargv[0] = strdup(original_pw->pw_shell);"
    },
    {
        "line": 126,
        "fullcodeline": "errx(1, \"Authorization required\");"
    },
    {
        "line": 286,
        "fullcodeline": "err(1, \"failed to set PATH '%s'\", safepath);"
    },
    {
        "line": 50,
        "fullcodeline": "if (parseuid(optarg, &target) != 0)"
    },
    {
        "line": 71,
        "fullcodeline": "usage();"
    },
    {
        "line": 88,
        "fullcodeline": "if (shargv[0] == NULL)"
    },
    {
        "line": 91,
        "fullcodeline": "shargv[0] = sh;"
    },
    {
        "line": 51,
        "fullcodeline": "errx(1, \"unknown user\");"
    },
    {
        "line": 89,
        "fullcodeline": "err(1, NULL);"
    }
]