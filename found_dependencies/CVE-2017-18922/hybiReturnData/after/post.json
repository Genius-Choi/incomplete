[
    {
        "line": 3,
        "fullcodeline": "int nextState = WS_HYBI_STATE_ERR;"
    },
    {
        "line": 6,
        "fullcodeline": "if (wsctx->readlen > 0) {"
    },
    {
        "line": 27,
        "fullcodeline": "rfbLog(\"after copy: readPos=%p, readLen=%d\\n\", wsctx->readPos, wsctx->readlen);"
    },
    {
        "line": 8,
        "fullcodeline": "if (wsctx->readlen > len) {"
    },
    {
        "line": 9,
        "fullcodeline": "rfbLog(\"copy to %d bytes to dst buffer; readPos=%p, readLen=%d\\n\", len, wsctx->readPos, wsctx->readlen);"
    },
    {
        "line": 10,
        "fullcodeline": "memcpy(dst, wsctx->readPos, len);"
    },
    {
        "line": 11,
        "fullcodeline": "*nWritten = len;"
    },
    {
        "line": 12,
        "fullcodeline": "wsctx->readlen -= len;"
    },
    {
        "line": 13,
        "fullcodeline": "wsctx->readPos += len;"
    },
    {
        "line": 14,
        "fullcodeline": "nextState = WS_HYBI_STATE_DATA_AVAILABLE;"
    },
    {
        "line": 28,
        "fullcodeline": "} else if (wsctx->hybiDecodeState == WS_HYBI_STATE_CLOSE_REASON_PENDING) {"
    },
    {
        "line": 16,
        "fullcodeline": "rfbLog(\"copy to %d bytes to dst buffer; readPos=%p, readLen=%d\\n\", wsctx->readlen, wsctx->readPos, wsctx->readlen);"
    },
    {
        "line": 17,
        "fullcodeline": "memcpy(dst, wsctx->readPos, wsctx->readlen);"
    },
    {
        "line": 18,
        "fullcodeline": "*nWritten = wsctx->readlen;"
    },
    {
        "line": 19,
        "fullcodeline": "wsctx->readlen = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "wsctx->readPos = NULL;"
    },
    {
        "line": 29,
        "fullcodeline": "nextState = WS_HYBI_STATE_CLOSE_REASON_PENDING;"
    },
    {
        "line": 21,
        "fullcodeline": "if (hybiRemaining(wsctx) == 0) {"
    },
    {
        "line": 22,
        "fullcodeline": "nextState = WS_HYBI_STATE_FRAME_COMPLETE;"
    },
    {
        "line": 24,
        "fullcodeline": "nextState = WS_HYBI_STATE_DATA_NEEDED;"
    }
]