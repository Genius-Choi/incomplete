[
    {
        "line": 3,
        "fullcodeline": "int ret = 0;"
    },
    {
        "line": 4,
        "fullcodeline": "struct capsule_info *cap_info = file->private_data;"
    },
    {
        "line": 6,
        "fullcodeline": "if (cap_info->index > 0) {"
    },
    {
        "line": 7,
        "fullcodeline": "pr_err(\"capsule upload not complete\\n\");"
    },
    {
        "line": 8,
        "fullcodeline": "efi_free_all_buff_pages(cap_info);"
    },
    {
        "line": 9,
        "fullcodeline": "ret = -ECANCELED;"
    }
]