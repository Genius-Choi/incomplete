[
    {
        "line": 2,
        "fullcodeline": "context = {}"
    },
    {
        "line": 3,
        "fullcodeline": "if request.method == \"POST\":"
    },
    {
        "line": 16,
        "fullcodeline": "return HttpResponseRedirect(reverse('scan_history'))"
    },
    {
        "line": 4,
        "fullcodeline": "list_of_scan_id = []"
    },
    {
        "line": 12,
        "fullcodeline": "messages.add_message("
    },
    {
        "line": 6,
        "fullcodeline": "for key, value in request.POST.items():"
    },
    {
        "line": 7,
        "fullcodeline": "if key != \"scan_history_table_length\" and key != \"csrfmiddlewaretoken\":"
    },
    {
        "line": 8,
        "fullcodeline": "obj = get_object_or_404(ScanHistory, id=value)"
    },
    {
        "line": 9,
        "fullcodeline": "delete_dir = obj.results_dir"
    },
    {
        "line": 10,
        "fullcodeline": "os.system('rm -rf /usr/src/scan_results/' + delete_dir)"
    },
    {
        "line": 11,
        "fullcodeline": "obj.delete()"
    }
]