[
    {
        "line": 16,
        "fullcodeline": "char buf[MAXHOSTNAMELEN + 100];"
    },
    {
        "line": 17,
        "fullcodeline": "struct cksum_vec vec[1];"
    },
    {
        "line": 19,
        "fullcodeline": "dp = (const struct icmp *)bp;"
    },
    {
        "line": 20,
        "fullcodeline": "ext_dp = (const struct icmp_ext_t *)bp;"
    },
    {
        "line": 21,
        "fullcodeline": "ip = (const struct ip *)bp2;"
    },
    {
        "line": 22,
        "fullcodeline": "str = buf;"
    },
    {
        "line": 24,
        "fullcodeline": "ND_TCHECK(dp->icmp_code);"
    },
    {
        "line": 229,
        "fullcodeline": "ND_PRINT((ndo, \"ICMP %s, length %u\", str, plen));"
    },
    {
        "line": 230,
        "fullcodeline": "if (ndo->ndo_vflag && !fragmented) { /* don't attempt checksumming if this is a frag */"
    },
    {
        "line": 250,
        "fullcodeline": "if (ndo->ndo_vflag >= 1 && ICMP_ERRTYPE(dp->icmp_type)) {"
    },
    {
        "line": 264,
        "fullcodeline": "if (ndo->ndo_vflag >= 1 && plen > ICMP_EXTD_MINLEN && ICMP_MPLS_EXT_TYPE(dp->icmp_type)) {"
    },
    {
        "line": 29,
        "fullcodeline": "ND_TCHECK(dp->icmp_seq);"
    },
    {
        "line": 30,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf), \"echo %s, id %u, seq %u\","
    },
    {
        "line": 38,
        "fullcodeline": "ND_TCHECK(dp->icmp_ip.ip_dst);"
    },
    {
        "line": 108,
        "fullcodeline": "ND_TCHECK(dp->icmp_ip.ip_dst);"
    },
    {
        "line": 109,
        "fullcodeline": "fmt = tok2str(type2str, \"redirect-#%d %%s to net %%s\","
    },
    {
        "line": 111,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf), fmt,"
    },
    {
        "line": 168,
        "fullcodeline": "ND_TCHECK(dp->icmp_ip.ip_dst);"
    },
    {
        "line": 198,
        "fullcodeline": "ND_TCHECK(dp->icmp_mask);"
    },
    {
        "line": 199,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf), \"address mask is 0x%08x\","
    },
    {
        "line": 204,
        "fullcodeline": "ND_TCHECK(dp->icmp_seq);"
    },
    {
        "line": 205,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 212,
        "fullcodeline": "ND_TCHECK(dp->icmp_ttime);"
    },
    {
        "line": 213,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 219,
        "fullcodeline": "(void)snprintf(buf+strlen(buf),sizeof(buf)-strlen(buf),\", recv %s\","
    },
    {
        "line": 221,
        "fullcodeline": "(void)snprintf(buf+strlen(buf),sizeof(buf)-strlen(buf),\", xmit %s\","
    },
    {
        "line": 226,
        "fullcodeline": "str = tok2str(icmp2str, \"type-#%d\", dp->icmp_type);"
    },
    {
        "line": 251,
        "fullcodeline": "bp += 8;"
    },
    {
        "line": 252,
        "fullcodeline": "ND_PRINT((ndo, \"\\n\\t\"));"
    },
    {
        "line": 253,
        "fullcodeline": "ip = (const struct ip *)bp;"
    },
    {
        "line": 254,
        "fullcodeline": "ndo->ndo_snaplen = ndo->ndo_snapend - bp;"
    },
    {
        "line": 255,
        "fullcodeline": "snapend_save = ndo->ndo_snapend;"
    },
    {
        "line": 256,
        "fullcodeline": "ND_TCHECK_16BITS(&ip->ip_len);"
    },
    {
        "line": 257,
        "fullcodeline": "ip_print(ndo, bp, EXTRACT_16BITS(&ip->ip_len));"
    },
    {
        "line": 258,
        "fullcodeline": "ndo->ndo_snapend = snapend_save;"
    },
    {
        "line": 266,
        "fullcodeline": "ND_TCHECK(*ext_dp);"
    },
    {
        "line": 295,
        "fullcodeline": "hlen = plen - ICMP_EXTD_MINLEN;"
    },
    {
        "line": 305,
        "fullcodeline": "hlen -= 4; /* subtract common header size */"
    },
    {
        "line": 306,
        "fullcodeline": "obj_tptr = (const uint8_t *)ext_dp->icmp_ext_data;"
    },
    {
        "line": 122,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf), \"router advertisement\");"
    },
    {
        "line": 123,
        "fullcodeline": "cp = buf + strlen(buf);"
    },
    {
        "line": 125,
        "fullcodeline": "ihp = (const struct ih_rdiscovery *)&dp->icmp_void;"
    },
    {
        "line": 126,
        "fullcodeline": "ND_TCHECK(*ihp);"
    },
    {
        "line": 127,
        "fullcodeline": "(void)strncpy(cp, \" lifetime \", sizeof(buf) - (cp - buf));"
    },
    {
        "line": 128,
        "fullcodeline": "cp = buf + strlen(buf);"
    },
    {
        "line": 129,
        "fullcodeline": "lifetime = EXTRACT_16BITS(&ihp->ird_lifetime);"
    },
    {
        "line": 143,
        "fullcodeline": "cp = buf + strlen(buf);"
    },
    {
        "line": 145,
        "fullcodeline": "num = ihp->ird_addrnum;"
    },
    {
        "line": 146,
        "fullcodeline": "(void)snprintf(cp, sizeof(buf) - (cp - buf), \" %d:\", num);"
    },
    {
        "line": 147,
        "fullcodeline": "cp = buf + strlen(buf);"
    },
    {
        "line": 149,
        "fullcodeline": "size = ihp->ird_addrsiz;"
    },
    {
        "line": 155,
        "fullcodeline": "idp = (const struct id_rdiscovery *)&dp->icmp_data;"
    },
    {
        "line": 231,
        "fullcodeline": "if (ND_TTEST2(*bp, plen)) {"
    },
    {
        "line": 274,
        "fullcodeline": "if (!ext_dp->icmp_length &&"
    },
    {
        "line": 283,
        "fullcodeline": "ND_PRINT((ndo, \"\\n\\tMPLS extension v%u\","
    },
    {
        "line": 289,
        "fullcodeline": "if (ICMP_MPLS_EXT_EXTRACT_VERSION(*(ext_dp->icmp_ext_version_res)) !="
    },
    {
        "line": 296,
        "fullcodeline": "if (ND_TTEST2(ext_dp->icmp_ext_version_res, hlen)) {"
    },
    {
        "line": 308,
        "fullcodeline": "while (hlen > sizeof(struct icmp_mpls_ext_object_header_t)) {"
    },
    {
        "line": 31,
        "fullcodeline": "dp->icmp_type == ICMP_ECHO ?"
    },
    {
        "line": 33,
        "fullcodeline": "EXTRACT_16BITS(&dp->icmp_id),"
    },
    {
        "line": 34,
        "fullcodeline": "EXTRACT_16BITS(&dp->icmp_seq));"
    },
    {
        "line": 42,
        "fullcodeline": "ND_TCHECK(dp->icmp_ip.ip_p);"
    },
    {
        "line": 43,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 50,
        "fullcodeline": "ND_TCHECK(dp->icmp_ip.ip_p);"
    },
    {
        "line": 51,
        "fullcodeline": "oip = &dp->icmp_ip;"
    },
    {
        "line": 52,
        "fullcodeline": "hlen = IP_HL(oip) * 4;"
    },
    {
        "line": 53,
        "fullcodeline": "ouh = (const struct udphdr *)(((const u_char *)oip) + hlen);"
    },
    {
        "line": 54,
        "fullcodeline": "ND_TCHECK(ouh->uh_dport);"
    },
    {
        "line": 55,
        "fullcodeline": "dport = EXTRACT_16BITS(&ouh->uh_dport);"
    },
    {
        "line": 99,
        "fullcodeline": "fmt = tok2str(unreach2str, \"#%d %%s unreachable\","
    },
    {
        "line": 101,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf), fmt,"
    },
    {
        "line": 112,
        "fullcodeline": "ipaddr_string(ndo, &dp->icmp_ip.ip_dst),"
    },
    {
        "line": 113,
        "fullcodeline": "ipaddr_string(ndo, &dp->icmp_gwaddr));"
    },
    {
        "line": 130,
        "fullcodeline": "if (lifetime < 60) {"
    },
    {
        "line": 150,
        "fullcodeline": "if (size != 2) {"
    },
    {
        "line": 156,
        "fullcodeline": "while (num-- > 0) {"
    },
    {
        "line": 172,
        "fullcodeline": "str = \"time exceeded in-transit\";"
    },
    {
        "line": 176,
        "fullcodeline": "str = \"ip reassembly time exceeded\";"
    },
    {
        "line": 180,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf), \"time exceeded-#%u\","
    },
    {
        "line": 188,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 200,
        "fullcodeline": "EXTRACT_32BITS(&dp->icmp_mask));"
    },
    {
        "line": 207,
        "fullcodeline": "EXTRACT_16BITS(&dp->icmp_id),"
    },
    {
        "line": 208,
        "fullcodeline": "EXTRACT_16BITS(&dp->icmp_seq));"
    },
    {
        "line": 215,
        "fullcodeline": "EXTRACT_16BITS(&dp->icmp_id),"
    },
    {
        "line": 216,
        "fullcodeline": "EXTRACT_16BITS(&dp->icmp_seq),"
    },
    {
        "line": 217,
        "fullcodeline": "icmp_tstamp_print(EXTRACT_32BITS(&dp->icmp_otime)));"
    },
    {
        "line": 220,
        "fullcodeline": "icmp_tstamp_print(EXTRACT_32BITS(&dp->icmp_rtime)));"
    },
    {
        "line": 222,
        "fullcodeline": "icmp_tstamp_print(EXTRACT_32BITS(&dp->icmp_ttime)));"
    },
    {
        "line": 234,
        "fullcodeline": "vec[0].ptr = (const uint8_t *)(const void *)dp;"
    },
    {
        "line": 235,
        "fullcodeline": "vec[0].len = plen;"
    },
    {
        "line": 236,
        "fullcodeline": "sum = in_cksum(vec, 1);"
    },
    {
        "line": 275,
        "fullcodeline": "ND_TTEST2(ext_dp->icmp_ext_version_res, plen - ICMP_EXTD_MINLEN)) {"
    },
    {
        "line": 276,
        "fullcodeline": "vec[0].ptr = (const uint8_t *)(const void *)&ext_dp->icmp_ext_version_res;"
    },
    {
        "line": 277,
        "fullcodeline": "vec[0].len = plen - ICMP_EXTD_MINLEN;"
    },
    {
        "line": 310,
        "fullcodeline": "icmp_mpls_ext_object_header = (const struct icmp_mpls_ext_object_header_t *)obj_tptr;"
    },
    {
        "line": 312,
        "fullcodeline": "obj_tlen = EXTRACT_16BITS(icmp_mpls_ext_object_header->length);"
    },
    {
        "line": 313,
        "fullcodeline": "obj_class_num = icmp_mpls_ext_object_header->class_num;"
    },
    {
        "line": 314,
        "fullcodeline": "obj_ctype = icmp_mpls_ext_object_header->ctype;"
    },
    {
        "line": 315,
        "fullcodeline": "obj_tptr += sizeof(struct icmp_mpls_ext_object_header_t);"
    },
    {
        "line": 323,
        "fullcodeline": "hlen-=sizeof(struct icmp_mpls_ext_object_header_t); /* length field includes tlv header */"
    },
    {
        "line": 330,
        "fullcodeline": "obj_tlen-=sizeof(struct icmp_mpls_ext_object_header_t);"
    },
    {
        "line": 359,
        "fullcodeline": "hlen -= obj_tlen;"
    },
    {
        "line": 360,
        "fullcodeline": "obj_tptr += obj_tlen;"
    },
    {
        "line": 84,
        "fullcodeline": "mp = (const struct mtu_discovery *)(const u_char *)&dp->icmp_void;"
    },
    {
        "line": 85,
        "fullcodeline": "mtu = EXTRACT_16BITS(&mp->nexthopmtu);"
    },
    {
        "line": 131,
        "fullcodeline": "(void)snprintf(cp, sizeof(buf) - (cp - buf), \"%u\","
    },
    {
        "line": 151,
        "fullcodeline": "(void)snprintf(cp, sizeof(buf) - (cp - buf),"
    },
    {
        "line": 157,
        "fullcodeline": "ND_TCHECK(*idp);"
    },
    {
        "line": 158,
        "fullcodeline": "(void)snprintf(cp, sizeof(buf) - (cp - buf), \" {%s %u}\","
    },
    {
        "line": 161,
        "fullcodeline": "cp = buf + strlen(buf);"
    },
    {
        "line": 162,
        "fullcodeline": "++idp;"
    },
    {
        "line": 191,
        "fullcodeline": "ND_TCHECK(dp->icmp_pptr);"
    },
    {
        "line": 192,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 237,
        "fullcodeline": "if (sum != 0) {"
    },
    {
        "line": 278,
        "fullcodeline": "if (in_cksum(vec, 1)) {"
    },
    {
        "line": 284,
        "fullcodeline": "ICMP_MPLS_EXT_EXTRACT_VERSION(*(ext_dp->icmp_ext_version_res))));"
    },
    {
        "line": 291,
        "fullcodeline": "ND_PRINT((ndo, \" packet not supported\"));"
    },
    {
        "line": 299,
        "fullcodeline": "ND_PRINT((ndo, \", checksum 0x%04x (%scorrect), length %u\","
    },
    {
        "line": 317,
        "fullcodeline": "ND_PRINT((ndo, \"\\n\\t  %s Object (%u), Class-Type: %u, length %u\","
    },
    {
        "line": 357,
        "fullcodeline": "if (hlen < obj_tlen)"
    },
    {
        "line": 45,
        "fullcodeline": "ipaddr_string(ndo, &dp->icmp_ip.ip_dst),"
    },
    {
        "line": 59,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 66,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 73,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 102,
        "fullcodeline": "ipaddr_string(ndo, &dp->icmp_ip.ip_dst));"
    },
    {
        "line": 238,
        "fullcodeline": "uint16_t icmp_sum = EXTRACT_16BITS(&dp->icmp_cksum);"
    },
    {
        "line": 239,
        "fullcodeline": "ND_PRINT((ndo, \" (wrong icmp cksum %x (->%x)!)\","
    },
    {
        "line": 326,
        "fullcodeline": "if ((obj_class_num == 0) ||"
    },
    {
        "line": 327,
        "fullcodeline": "(obj_tlen < sizeof(struct icmp_mpls_ext_object_header_t))) {"
    },
    {
        "line": 354,
        "fullcodeline": "print_unknown_data(ndo, obj_tptr, \"\\n\\t    \", obj_tlen);"
    },
    {
        "line": 87,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 133,
        "fullcodeline": "} else if (lifetime < 60 * 60) {"
    },
    {
        "line": 159,
        "fullcodeline": "ipaddr_string(ndo, &idp->ird_addr),"
    },
    {
        "line": 160,
        "fullcodeline": "EXTRACT_32BITS(&idp->ird_pref));"
    },
    {
        "line": 300,
        "fullcodeline": "EXTRACT_16BITS(ext_dp->icmp_ext_checksum),"
    },
    {
        "line": 318,
        "fullcodeline": "tok2str(icmp_mpls_ext_obj_values,\"unknown\",obj_class_num),"
    },
    {
        "line": 61,
        "fullcodeline": "ipaddr_string(ndo, &oip->ip_dst),"
    },
    {
        "line": 62,
        "fullcodeline": "tcpport_string(ndo, dport));"
    },
    {
        "line": 68,
        "fullcodeline": "ipaddr_string(ndo, &oip->ip_dst),"
    },
    {
        "line": 69,
        "fullcodeline": "udpport_string(ndo, dport));"
    },
    {
        "line": 75,
        "fullcodeline": "ipaddr_string(ndo, &oip->ip_dst),"
    },
    {
        "line": 91,
        "fullcodeline": "(void)snprintf(buf, sizeof(buf),"
    },
    {
        "line": 134,
        "fullcodeline": "(void)snprintf(cp, sizeof(buf) - (cp - buf), \"%u:%02u\","
    },
    {
        "line": 336,
        "fullcodeline": "ND_TCHECK2(*obj_tptr, 4);"
    },
    {
        "line": 337,
        "fullcodeline": "raw_label = EXTRACT_32BITS(obj_tptr);"
    },
    {
        "line": 344,
        "fullcodeline": "print_unknown_data(ndo, obj_tptr, \"\\n\\t    \", obj_tlen);"
    },
    {
        "line": 89,
        "fullcodeline": "ipaddr_string(ndo, &dp->icmp_ip.ip_dst), mtu);"
    },
    {
        "line": 137,
        "fullcodeline": "(void)snprintf(cp, sizeof(buf) - (cp - buf),"
    },
    {
        "line": 241,
        "fullcodeline": "in_cksum_shouldbe(icmp_sum, sum)));"
    },
    {
        "line": 338,
        "fullcodeline": "ND_PRINT((ndo, \"\\n\\t    label %u, exp %u\", MPLS_LABEL(raw_label), MPLS_EXP(raw_label)));"
    },
    {
        "line": 339,
        "fullcodeline": "if (MPLS_STACK(raw_label))"
    },
    {
        "line": 341,
        "fullcodeline": "ND_PRINT((ndo, \", ttl %u\", MPLS_TTL(raw_label)));"
    },
    {
        "line": 93,
        "fullcodeline": "ipaddr_string(ndo, &dp->icmp_ip.ip_dst));"
    },
    {
        "line": 135,
        "fullcodeline": "lifetime / 60, lifetime % 60);"
    },
    {
        "line": 139,
        "fullcodeline": "lifetime / 3600,"
    },
    {
        "line": 140,
        "fullcodeline": "(lifetime % 3600) / 60,"
    },
    {
        "line": 141,
        "fullcodeline": "lifetime % 60);"
    },
    {
        "line": 340,
        "fullcodeline": "ND_PRINT((ndo, \", [S]\"));"
    }
]