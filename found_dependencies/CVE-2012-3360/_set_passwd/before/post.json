[
    {
        "line": 15,
        "fullcodeline": "salt_set = ('abcdefghijklmnopqrstuvwxyz'"
    },
    {
        "line": 19,
        "fullcodeline": "algos = {'SHA-512': '$6$', 'SHA-256': '$5$', 'MD5': '$1$', 'DES': ''}"
    },
    {
        "line": 21,
        "fullcodeline": "salt = 16 * ' '"
    },
    {
        "line": 22,
        "fullcodeline": "salt = ''.join([random.choice(salt_set) for c in salt])"
    },
    {
        "line": 31,
        "fullcodeline": "encrypted_passwd = crypt.crypt(admin_passwd, algos['MD5'] + salt)"
    },
    {
        "line": 32,
        "fullcodeline": "if len(encrypted_passwd) == 13:"
    },
    {
        "line": 33,
        "fullcodeline": "encrypted_passwd = crypt.crypt(admin_passwd, algos['DES'] + salt)"
    },
    {
        "line": 36,
        "fullcodeline": "p_file = open(passwd_file, 'rb')"
    },
    {
        "line": 37,
        "fullcodeline": "s_file = open(shadow_file, 'rb')"
    },
    {
        "line": 40,
        "fullcodeline": "found = False"
    },
    {
        "line": 52,
        "fullcodeline": "new_shadow = list()"
    },
    {
        "line": 53,
        "fullcodeline": "found = False"
    },
    {
        "line": 61,
        "fullcodeline": "s_file.close()"
    },
    {
        "line": 65,
        "fullcodeline": "s_file = open(shadow_file, 'wb')"
    },
    {
        "line": 41,
        "fullcodeline": "for entry in p_file:"
    },
    {
        "line": 46,
        "fullcodeline": "if not found:"
    },
    {
        "line": 54,
        "fullcodeline": "for entry in s_file:"
    },
    {
        "line": 62,
        "fullcodeline": "if not found:"
    },
    {
        "line": 66,
        "fullcodeline": "for entry in new_shadow:"
    },
    {
        "line": 69,
        "fullcodeline": "p_file.close()"
    },
    {
        "line": 70,
        "fullcodeline": "s_file.close()"
    },
    {
        "line": 47,
        "fullcodeline": "msg = _('User %(username)s not found in password file.')"
    },
    {
        "line": 48,
        "fullcodeline": "raise exception.Error(msg % username)"
    },
    {
        "line": 63,
        "fullcodeline": "msg = _('User %(username)s not found in shadow file.')"
    },
    {
        "line": 64,
        "fullcodeline": "raise exception.Error(msg % username)"
    },
    {
        "line": 42,
        "fullcodeline": "split_entry = entry.split(':')"
    },
    {
        "line": 55,
        "fullcodeline": "split_entry = entry.split(':')"
    },
    {
        "line": 59,
        "fullcodeline": "new_entry = ':'.join(split_entry)"
    },
    {
        "line": 60,
        "fullcodeline": "new_shadow.append(new_entry)"
    },
    {
        "line": 67,
        "fullcodeline": "s_file.write(entry)"
    },
    {
        "line": 43,
        "fullcodeline": "if split_entry[0] == username:"
    },
    {
        "line": 56,
        "fullcodeline": "if split_entry[0] == username:"
    },
    {
        "line": 44,
        "fullcodeline": "found = True"
    },
    {
        "line": 57,
        "fullcodeline": "split_entry[1] = encrypted_passwd"
    },
    {
        "line": 58,
        "fullcodeline": "found = True"
    }
]