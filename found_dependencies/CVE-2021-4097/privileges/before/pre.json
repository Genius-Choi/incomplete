[
    {
        "line": 2,
        "fullcodeline": "name = split_name(@resource[:name])"
    },
    {
        "line": 3,
        "fullcodeline": "privs = ''"
    },
    {
        "line": 5,
        "fullcodeline": "case name[:type]"
    },
    {
        "line": 12,
        "fullcodeline": "if privs.match(/^$/)"
    },
    {
        "line": 22,
        "fullcodeline": "privs.collect do |p| p[0] end"
    },
    {
        "line": 6,
        "fullcodeline": "when :user"
    },
    {
        "line": 13,
        "fullcodeline": "privs = [] # no result, no privs"
    },
    {
        "line": 16,
        "fullcodeline": "privs = privs.split(/\\n/).map! do |l| l.chomp.split(/\\t/) end"
    },
    {
        "line": 18,
        "fullcodeline": "privs = privs[0].zip(privs[1])"
    },
    {
        "line": 19,
        "fullcodeline": "privs = privs.select do |p| p[0].match(/_priv$/) and p[1] == 'Y' end"
    },
    {
        "line": 7,
        "fullcodeline": "privs = mysql([defaults_file, 'mysql', '-Be', \"select * from mysql.user where user='%s' and host='%s'\" % [ name[:user], name[:host] ]].compact)"
    },
    {
        "line": 8,
        "fullcodeline": "when :db"
    },
    {
        "line": 9,
        "fullcodeline": "privs = mysql([defaults_file, 'mysql', '-Be', \"select * from mysql.db where user='%s' and host='%s' and db='%s'\" % [ name[:user], name[:host], name[:db] ]].compact)"
    }
]