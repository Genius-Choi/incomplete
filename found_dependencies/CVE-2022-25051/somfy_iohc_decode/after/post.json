[
    {
        "line": 3,
        "fullcodeline": "uint8_t const preamble_pattern[] = {0x57, 0xfd, 0x99};"
    },
    {
        "line": 5,
        "fullcodeline": "uint8_t b[19 + 15]; // 19 byte + up 15 byte payload"
    },
    {
        "line": 10,
        "fullcodeline": "unsigned offset = bitbuffer_search(bitbuffer, 0, 0, preamble_pattern, 24) + 24;"
    },
    {
        "line": 14,
        "fullcodeline": "unsigned num_bits = bitbuffer->bits_per_row[0] - offset;"
    },
    {
        "line": 15,
        "fullcodeline": "num_bits = MIN(num_bits, sizeof (b) * 8);"
    },
    {
        "line": 17,
        "fullcodeline": "int len = extract_bytes_uart(bitbuffer->bb[0], offset, num_bits, b);"
    },
    {
        "line": 24,
        "fullcodeline": "int msg_len = b[0] & 0xf; // should be 6 or 8"
    },
    {
        "line": 31,
        "fullcodeline": "bitrow_printf(b, len * 8, \"%s: offset %u, num_bits %u, len %d, msg_len %d\\n\", __func__, offset, num_bits, len, msg_len);"
    },
    {
        "line": 33,
        "fullcodeline": "int msg_type = (b[0]);"
    },
    {
        "line": 34,
        "fullcodeline": "int dst_id   = ((unsigned)b[4] << 24) | (b[3] << 16) | (b[2] << 8) | (b[1]); // assume Little-Endian"
    },
    {
        "line": 35,
        "fullcodeline": "int src_id   = ((unsigned)b[8] << 24) | (b[7] << 16) | (b[6] << 8) | (b[5]); // assume Little-Endian"
    },
    {
        "line": 36,
        "fullcodeline": "int counter  = (b[len - 10] << 8) | (b[len - 9]);"
    },
    {
        "line": 37,
        "fullcodeline": "char msg_str[15 * 2 + 1];"
    },
    {
        "line": 38,
        "fullcodeline": "bitrow_snprint(&b[9], msg_len * 8, msg_str, 15 * 2 + 1);"
    },
    {
        "line": 39,
        "fullcodeline": "char mac_str[13];"
    },
    {
        "line": 40,
        "fullcodeline": "bitrow_snprint(&b[len - 8], 6 * 8, mac_str, 13);"
    },
    {
        "line": 43,
        "fullcodeline": "data_t *data = data_make("
    },
    {
        "line": 55,
        "fullcodeline": "decoder_output_data(decoder, data);"
    },
    {
        "line": 7,
        "fullcodeline": "if (bitbuffer->num_rows != 1)"
    },
    {
        "line": 11,
        "fullcodeline": "if (offset + 19 * 10 >= bitbuffer->bits_per_row[0])"
    },
    {
        "line": 18,
        "fullcodeline": "if (len < 19)"
    },
    {
        "line": 21,
        "fullcodeline": "if ((b[0] & 0xf0) != 0xf0)"
    },
    {
        "line": 25,
        "fullcodeline": "if (len < 19 + msg_len)"
    },
    {
        "line": 29,
        "fullcodeline": "if (crc16lsb(b, len, 0x8408, 0x0000) != 0) // unreflected poly 0x1021"
    }
]