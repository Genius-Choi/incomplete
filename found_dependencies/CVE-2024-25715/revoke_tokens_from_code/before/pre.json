[
    {
        "line": 4,
        "fullcodeline": "json_t * j_result, * j_result_r, * j_element = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "size_t index = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "res = h_execute_query_json(config->glewlwyd_config->glewlwyd_config->conn, query, &j_result);"
    },
    {
        "line": 9,
        "fullcodeline": "o_free(query);"
    },
    {
        "line": 10,
        "fullcodeline": "if (res == H_OK) {"
    },
    {
        "line": 11,
        "fullcodeline": "json_array_foreach(j_result, index, j_element) {"
    },
    {
        "line": 14,
        "fullcodeline": "json_decref(j_result);"
    },
    {
        "line": 16,
        "fullcodeline": "res = h_execute_query_json(config->glewlwyd_config->glewlwyd_config->conn, query, &j_result_r);"
    },
    {
        "line": 17,
        "fullcodeline": "o_free(query);"
    },
    {
        "line": 12,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_INFO, \"Event oauth2 - Plugin '%s' - Access token generated for client '%s' revoked, origin: %s\", config->name, json_string_value(json_object_get(j_element, \"client_id\")), ip_source);"
    },
    {
        "line": 18,
        "fullcodeline": "if (res == H_OK) {"
    },
    {
        "line": 48,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc revoke_tokens_from_code - Error executing query (1)\");"
    },
    {
        "line": 49,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_DATABSE_ERROR, 1, NULL);"
    },
    {
        "line": 50,
        "fullcodeline": "ret = G_ERROR_DB;"
    },
    {
        "line": 22,
        "fullcodeline": "json_decref(j_result_r);"
    },
    {
        "line": 24,
        "fullcodeline": "res = h_execute_query(config->glewlwyd_config->glewlwyd_config->conn, query, NULL, H_OPTION_EXEC);"
    },
    {
        "line": 25,
        "fullcodeline": "o_free(query);"
    },
    {
        "line": 19,
        "fullcodeline": "if (json_array_size(j_result_r)) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (res == H_OK) {"
    },
    {
        "line": 43,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc revoke_tokens_from_code - Error executing query (2)\");"
    },
    {
        "line": 44,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_DATABSE_ERROR, 1, NULL);"
    },
    {
        "line": 45,
        "fullcodeline": "ret = G_ERROR_DB;"
    },
    {
        "line": 20,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_INFO, \"Event oauth2 - Plugin '%s' - Refresh token generated for client '%s' revoked, origin: %s\", config->name, json_string_value(json_object_get(json_array_get(j_result_r, 0), \"client_id\")), ip_source);"
    },
    {
        "line": 28,
        "fullcodeline": "res = h_execute_query(config->glewlwyd_config->glewlwyd_config->conn, query, NULL, H_OPTION_EXEC);"
    },
    {
        "line": 29,
        "fullcodeline": "o_free(query);"
    },
    {
        "line": 30,
        "fullcodeline": "if (res == H_OK) {"
    },
    {
        "line": 38,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"revoke_tokens_from_code - oauth2 - Error executing query (3)\");"
    },
    {
        "line": 39,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_DATABSE_ERROR, 1, NULL);"
    },
    {
        "line": 40,
        "fullcodeline": "ret = G_ERROR_DB;"
    },
    {
        "line": 31,
        "fullcodeline": "ret = G_OK;"
    },
    {
        "line": 33,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"revoke_tokens_from_code - oauth2 - Error executing query (4)\");"
    },
    {
        "line": 34,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_DATABSE_ERROR, 1, NULL);"
    },
    {
        "line": 35,
        "fullcodeline": "ret = G_ERROR_DB;"
    }
]