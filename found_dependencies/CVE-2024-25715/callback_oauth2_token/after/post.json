[
    {
        "line": 2,
        "fullcodeline": "struct _oauth2_config * config = (struct _oauth2_config *)user_data;"
    },
    {
        "line": 3,
        "fullcodeline": "const char * grant_type = u_map_get(request->map_post_body, \"grant_type\");"
    },
    {
        "line": 4,
        "fullcodeline": "int result = U_CALLBACK_CONTINUE;"
    },
    {
        "line": 6,
        "fullcodeline": "u_map_put(response->map_header, \"Cache-Control\", \"no-store\");"
    },
    {
        "line": 7,
        "fullcodeline": "u_map_put(response->map_header, \"Pragma\", \"no-cache\");"
    },
    {
        "line": 8,
        "fullcodeline": "u_map_put(response->map_header, \"Referrer-Policy\", \"no-referrer\");"
    },
    {
        "line": 10,
        "fullcodeline": "if (0 == o_strcmp(\"authorization_code\", grant_type)) {"
    },
    {
        "line": 11,
        "fullcodeline": "if (is_authorization_type_enabled(config, GLEWLWYD_AUTHORIZATION_TYPE_AUTHORIZATION_CODE)) {"
    },
    {
        "line": 12,
        "fullcodeline": "result = check_auth_type_access_token_request(request, response, user_data);"
    },
    {
        "line": 16,
        "fullcodeline": "} else if (0 == o_strcmp(\"password\", grant_type)) {"
    },
    {
        "line": 14,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 17,
        "fullcodeline": "if (is_authorization_type_enabled(config, GLEWLWYD_AUTHORIZATION_TYPE_RESOURCE_OWNER_PASSWORD_CREDENTIALS)) {"
    },
    {
        "line": 18,
        "fullcodeline": "result = check_auth_type_resource_owner_pwd_cred(request, response, user_data);"
    },
    {
        "line": 22,
        "fullcodeline": "} else if (0 == o_strcmp(\"client_credentials\", grant_type)) {"
    },
    {
        "line": 20,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 23,
        "fullcodeline": "if (is_authorization_type_enabled(config, GLEWLWYD_AUTHORIZATION_TYPE_CLIENT_CREDENTIALS)) {"
    },
    {
        "line": 24,
        "fullcodeline": "result = check_auth_type_client_credentials_grant(request, response, user_data);"
    },
    {
        "line": 28,
        "fullcodeline": "} else if (0 == o_strcmp(\"refresh_token\", grant_type)) {"
    },
    {
        "line": 26,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 29,
        "fullcodeline": "result = get_access_token_from_refresh(request, response, user_data);"
    },
    {
        "line": 30,
        "fullcodeline": "} else if (0 == o_strcmp(\"delete_token\", grant_type)) {"
    },
    {
        "line": 31,
        "fullcodeline": "result = delete_refresh_token(request, response, user_data);"
    },
    {
        "line": 32,
        "fullcodeline": "} else if (0 == o_strcmp(\"urn:ietf:params:oauth:grant-type:device_code\", grant_type)) {"
    },
    {
        "line": 33,
        "fullcodeline": "result = check_auth_type_device_code(request, response, user_data);"
    },
    {
        "line": 35,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oauth2_token - oauth2 - Unknown grant_type '%s', origin: %s\", grant_type, get_ip_source(request, config->glewlwyd_config->glewlwyd_config->originating_ip_header));"
    },
    {
        "line": 36,
        "fullcodeline": "response->status = 400;"
    }
]