[
    {
        "line": 2,
        "fullcodeline": "json_t * j_client, * j_element = NULL, * j_return;"
    },
    {
        "line": 3,
        "fullcodeline": "int uri_found = 0, authorization_type_enabled;"
    },
    {
        "line": 4,
        "fullcodeline": "size_t index = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "j_client = config->glewlwyd_config->glewlwyd_callback_check_client_valid(config->glewlwyd_config, client_id, client_header_password);"
    },
    {
        "line": 63,
        "fullcodeline": "json_decref(j_client);"
    },
    {
        "line": 6,
        "fullcodeline": "if (client_id == NULL) {"
    },
    {
        "line": 14,
        "fullcodeline": "if (check_result_value(j_client, G_OK) && json_object_get(json_object_get(j_client, \"client\"), \"enabled\") == json_true()) {"
    },
    {
        "line": 7,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"check_client_valid - oauth2 - Error client_id is NULL, origin: %s\", ip_source);"
    },
    {
        "line": 8,
        "fullcodeline": "return json_pack(\"{si}\", \"result\", G_ERROR_PARAM);"
    },
    {
        "line": 15,
        "fullcodeline": "if (!implicit_flow && client_header_password == NULL && json_object_get(json_object_get(j_client, \"client\"), \"confidential\") == json_true()) {"
    },
    {
        "line": 60,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"check_client_valid - oauth2 - Error, client '%s' is invalid, origin: %s\", client_id, ip_source);"
    },
    {
        "line": 61,
        "fullcodeline": "j_return = json_pack(\"{si}\", \"result\", G_ERROR_UNAUTHORIZED);"
    },
    {
        "line": 9,
        "fullcodeline": "} else if (client_header_login != NULL && 0 != o_strcmp(client_header_login, client_id)) {"
    },
    {
        "line": 16,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"check_client_valid - oauth2 - Error, confidential client must be authentified with its password, origin: %s\", ip_source);"
    },
    {
        "line": 17,
        "fullcodeline": "j_return = json_pack(\"{si}\", \"result\", G_ERROR_UNAUTHORIZED);"
    },
    {
        "line": 10,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"check_client_valid - oauth2 - Error, client_id specified is different from client_id in the basic auth header, origin: %s\", ip_source);"
    },
    {
        "line": 27,
        "fullcodeline": "authorization_type_enabled = 0;"
    },
    {
        "line": 28,
        "fullcodeline": "json_array_foreach(json_object_get(json_object_get(j_client, \"client\"), \"authorization_type\"), index, j_element) {"
    },
    {
        "line": 11,
        "fullcodeline": "return json_pack(\"{si}\", \"result\", G_ERROR_PARAM);"
    },
    {
        "line": 19,
        "fullcodeline": "if (redirect_uri != NULL) {"
    },
    {
        "line": 47,
        "fullcodeline": "if (!uri_found) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (!authorization_type_enabled) {"
    },
    {
        "line": 53,
        "fullcodeline": "if (uri_found && authorization_type_enabled) {"
    },
    {
        "line": 20,
        "fullcodeline": "json_array_foreach(json_object_get(json_object_get(j_client, \"client\"), \"redirect_uri\"), index, j_element) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (authorization_type == GLEWLWYD_AUTHORIZATION_TYPE_AUTHORIZATION_CODE && 0 == o_strcmp(json_string_value(j_element), \"code\")) {"
    },
    {
        "line": 48,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"check_client_valid - oauth2 - Error, redirect_uri '%s' is invalid for the client '%s', origin: %s\", redirect_uri, client_id, ip_source);"
    },
    {
        "line": 51,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"check_client_valid - oauth2 - Error, authorization type is not enabled for the client '%s', origin: %s\", client_id, ip_source);"
    },
    {
        "line": 54,
        "fullcodeline": "j_return = json_pack(\"{sisO}\", \"result\", G_OK, \"client\", json_object_get(j_client, \"client\"));"
    },
    {
        "line": 30,
        "fullcodeline": "authorization_type_enabled = 1;"
    },
    {
        "line": 56,
        "fullcodeline": "j_return = json_pack(\"{si}\", \"result\", G_ERROR_PARAM);"
    },
    {
        "line": 21,
        "fullcodeline": "if (0 == o_strcmp(json_string_value(j_element), redirect_uri)) {"
    },
    {
        "line": 22,
        "fullcodeline": "uri_found = 1;"
    },
    {
        "line": 31,
        "fullcodeline": "} else if (authorization_type == GLEWLWYD_AUTHORIZATION_TYPE_IMPLICIT && 0 == o_strcmp(json_string_value(j_element), \"token\")) {"
    },
    {
        "line": 32,
        "fullcodeline": "authorization_type_enabled = 1;"
    },
    {
        "line": 33,
        "fullcodeline": "} else if (authorization_type == GLEWLWYD_AUTHORIZATION_TYPE_RESOURCE_OWNER_PASSWORD_CREDENTIALS && 0 == o_strcmp(json_string_value(j_element), \"password\")) {"
    },
    {
        "line": 34,
        "fullcodeline": "authorization_type_enabled = 1;"
    },
    {
        "line": 35,
        "fullcodeline": "uri_found = 1; // bypass redirect_uri check for client credentials since it's not needed"
    },
    {
        "line": 36,
        "fullcodeline": "} else if (authorization_type == GLEWLWYD_AUTHORIZATION_TYPE_REFRESH_TOKEN && 0 == o_strcmp(json_string_value(j_element), \"refresh_token\")) {"
    },
    {
        "line": 37,
        "fullcodeline": "authorization_type_enabled = 1;"
    },
    {
        "line": 38,
        "fullcodeline": "uri_found = 1; // bypass redirect_uri check for client credentials since it's not needed"
    },
    {
        "line": 39,
        "fullcodeline": "} else if (authorization_type == GLEWLWYD_AUTHORIZATION_TYPE_DELETE_TOKEN && 0 == o_strcmp(json_string_value(j_element), \"delete_token\")) {"
    },
    {
        "line": 40,
        "fullcodeline": "authorization_type_enabled = 1;"
    },
    {
        "line": 41,
        "fullcodeline": "uri_found = 1; // bypass redirect_uri check for client credentials since it's not needed"
    },
    {
        "line": 42,
        "fullcodeline": "} else if (authorization_type == GLEWLWYD_AUTHORIZATION_TYPE_DEVICE_AUTHORIZATION && 0 == o_strcmp(json_string_value(j_element), \"device_authorization\")) {"
    },
    {
        "line": 43,
        "fullcodeline": "authorization_type_enabled = 1;"
    },
    {
        "line": 44,
        "fullcodeline": "uri_found = 1; // bypass redirect_uri check for client credentials since it's not needed"
    }
]