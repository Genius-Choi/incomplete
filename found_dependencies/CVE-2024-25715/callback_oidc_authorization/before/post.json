[
    {
        "line": 2,
        "fullcodeline": "struct _oidc_config * config = (struct _oidc_config *)user_data;"
    },
    {
        "line": 3,
        "fullcodeline": "const char * response_type = NULL,"
    },
    {
        "line": 4,
        "fullcodeline": "* redirect_uri = NULL,"
    },
    {
        "line": 5,
        "fullcodeline": "* client_id = NULL,"
    },
    {
        "line": 6,
        "fullcodeline": "* scope = NULL,"
    },
    {
        "line": 7,
        "fullcodeline": "* nonce = NULL,"
    },
    {
        "line": 8,
        "fullcodeline": "* resource = NULL,"
    },
    {
        "line": 9,
        "fullcodeline": "* claims = NULL,"
    },
    {
        "line": 10,
        "fullcodeline": "* code_challenge = NULL,"
    },
    {
        "line": 11,
        "fullcodeline": "* code_challenge_method = NULL,"
    },
    {
        "line": 12,
        "fullcodeline": "* display = NULL,"
    },
    {
        "line": 13,
        "fullcodeline": "* ui_locales = NULL,"
    },
    {
        "line": 14,
        "fullcodeline": "* login_hint = NULL,"
    },
    {
        "line": 15,
        "fullcodeline": "* prompt = NULL,"
    },
    {
        "line": 16,
        "fullcodeline": "* id_token_hint = NULL,"
    },
    {
        "line": 17,
        "fullcodeline": "* ip_source = get_ip_source(request, config->glewlwyd_config->glewlwyd_config->originating_ip_header),"
    },
    {
        "line": 18,
        "fullcodeline": "* key = NULL,"
    },
    {
        "line": 19,
        "fullcodeline": "* max_age = NULL,"
    },
    {
        "line": 20,
        "fullcodeline": "* str_response_mode = NULL,"
    },
    {
        "line": 21,
        "fullcodeline": "* state = NULL,"
    },
    {
        "line": 22,
        "fullcodeline": "* authorization_code = NULL,"
    },
    {
        "line": 23,
        "fullcodeline": "* dpop_jkt = NULL;"
    },
    {
        "line": 43,
        "fullcodeline": "jti[OIDC_JTI_LENGTH+1] = {0},"
    },
    {
        "line": 44,
        "fullcodeline": "sid[OIDC_SID_LENGTH+1] = {0},"
    },
    {
        "line": 45,
        "fullcodeline": "code_challenge_stored[GLEWLWYD_CODE_CHALLENGE_MAX_LENGTH + 1] = {0};"
    },
    {
        "line": 24,
        "fullcodeline": "char * redirect_url = NULL,"
    },
    {
        "line": 25,
        "fullcodeline": "** resp_type_array = NULL,"
    },
    {
        "line": 26,
        "fullcodeline": "** scope_list = NULL,"
    },
    {
        "line": 27,
        "fullcodeline": "** resource_list = NULL,"
    },
    {
        "line": 28,
        "fullcodeline": "* authorization_code_out = NULL,"
    },
    {
        "line": 29,
        "fullcodeline": "* access_token = NULL,"
    },
    {
        "line": 30,
        "fullcodeline": "* id_token = NULL,"
    },
    {
        "line": 31,
        "fullcodeline": "* id_token_out = NULL,"
    },
    {
        "line": 32,
        "fullcodeline": "* expires_in_str = NULL,"
    },
    {
        "line": 33,
        "fullcodeline": "* iat_str = NULL,"
    },
    {
        "line": 34,
        "fullcodeline": "* str_request = NULL,"
    },
    {
        "line": 35,
        "fullcodeline": "* access_token_out = NULL,"
    },
    {
        "line": 36,
        "fullcodeline": "* session_state = NULL,"
    },
    {
        "line": 37,
        "fullcodeline": "* rar_list = NULL,"
    },
    {
        "line": 38,
        "fullcodeline": "* scope_reduced = NULL,"
    },
    {
        "line": 39,
        "fullcodeline": "* id_token_hash = NULL,"
    },
    {
        "line": 40,
        "fullcodeline": "* issued_for = NULL,"
    },
    {
        "line": 41,
        "fullcodeline": "* endptr = NULL,"
    },
    {
        "line": 42,
        "fullcodeline": "* s_hash = NULL,"
    },
    {
        "line": 46,
        "fullcodeline": "json_t * j_request = NULL,"
    },
    {
        "line": 47,
        "fullcodeline": "* j_client = NULL,"
    },
    {
        "line": 48,
        "fullcodeline": "* j_client_checked = NULL,"
    },
    {
        "line": 49,
        "fullcodeline": "* j_authorization_details = NULL,"
    },
    {
        "line": 50,
        "fullcodeline": "* j_authorization_details_processed = NULL,"
    },
    {
        "line": 51,
        "fullcodeline": "* j_authorization_code = NULL,"
    },
    {
        "line": 52,
        "fullcodeline": "* j_element = NULL,"
    },
    {
        "line": 53,
        "fullcodeline": "* j_claims = NULL,"
    },
    {
        "line": 54,
        "fullcodeline": "* j_session = NULL,"
    },
    {
        "line": 55,
        "fullcodeline": "* j_reduced_scope = NULL,"
    },
    {
        "line": 56,
        "fullcodeline": "* j_last_token = NULL,"
    },
    {
        "line": 57,
        "fullcodeline": "* j_rar_filtered_result = NULL;"
    },
    {
        "line": 58,
        "fullcodeline": "time_t now = 0;"
    },
    {
        "line": 59,
        "fullcodeline": "int auth_type = GLEWLWYD_AUTHORIZATION_TYPE_NULL_FLAG,"
    },
    {
        "line": 60,
        "fullcodeline": "check_request = 0,"
    },
    {
        "line": 61,
        "fullcodeline": "request_par = 0,"
    },
    {
        "line": 62,
        "fullcodeline": "has_code = 0,"
    },
    {
        "line": 63,
        "fullcodeline": "has_token = 0,"
    },
    {
        "line": 64,
        "fullcodeline": "has_id_token = 0,"
    },
    {
        "line": 65,
        "fullcodeline": "has_none = 0,"
    },
    {
        "line": 67,
        "fullcodeline": "enc_res = G_OK,"
    },
    {
        "line": 68,
        "fullcodeline": "resource_error = 0;"
    },
    {
        "line": 69,
        "fullcodeline": "struct _u_map map_redirect, map_login, * map = get_map(request);"
    },
    {
        "line": 70,
        "fullcodeline": "int response_mode = GLEWLWYD_RESPONSE_MODE_QUERY;"
    },
    {
        "line": 71,
        "fullcodeline": "size_t index = 0, count_resource;"
    },
    {
        "line": 73,
        "fullcodeline": "jwk_t * jwk_id_token = NULL;"
    },
    {
        "line": 74,
        "fullcodeline": "jwt_t * jwt = NULL;"
    },
    {
        "line": 77,
        "fullcodeline": "u_map_put(response->map_header, \"Cache-Control\", \"no-store\");"
    },
    {
        "line": 78,
        "fullcodeline": "u_map_put(response->map_header, \"Pragma\", \"no-cache\");"
    },
    {
        "line": 79,
        "fullcodeline": "u_map_put(response->map_header, \"Referrer-Policy\", \"no-referrer\");"
    },
    {
        "line": 81,
        "fullcodeline": "time(&now);"
    },
    {
        "line": 1005,
        "fullcodeline": "o_free(access_token);"
    },
    {
        "line": 1006,
        "fullcodeline": "o_free(id_token);"
    },
    {
        "line": 1007,
        "fullcodeline": "o_free(scope_reduced);"
    },
    {
        "line": 1008,
        "fullcodeline": "o_free(issued_for);"
    },
    {
        "line": 1009,
        "fullcodeline": "o_free(id_token_hash);"
    },
    {
        "line": 1010,
        "fullcodeline": "o_free(s_hash);"
    },
    {
        "line": 1011,
        "fullcodeline": "free_string_array(resp_type_array);"
    },
    {
        "line": 1012,
        "fullcodeline": "free_string_array(scope_list);"
    },
    {
        "line": 1013,
        "fullcodeline": "free_string_array(resource_list);"
    },
    {
        "line": 1014,
        "fullcodeline": "u_map_clean(&map_redirect);"
    },
    {
        "line": 1015,
        "fullcodeline": "u_map_clean(&map_login);"
    },
    {
        "line": 1016,
        "fullcodeline": "json_decref(j_request);"
    },
    {
        "line": 1017,
        "fullcodeline": "json_decref(j_client);"
    },
    {
        "line": 1018,
        "fullcodeline": "json_decref(j_client_checked);"
    },
    {
        "line": 1019,
        "fullcodeline": "json_decref(j_authorization_details);"
    },
    {
        "line": 1020,
        "fullcodeline": "json_decref(j_authorization_details_processed);"
    },
    {
        "line": 1021,
        "fullcodeline": "json_decref(j_claims);"
    },
    {
        "line": 1022,
        "fullcodeline": "json_decref(j_session);"
    },
    {
        "line": 1023,
        "fullcodeline": "json_decref(j_reduced_scope);"
    },
    {
        "line": 1024,
        "fullcodeline": "json_decref(j_last_token);"
    },
    {
        "line": 1025,
        "fullcodeline": "json_decref(j_rar_filtered_result);"
    },
    {
        "line": 1026,
        "fullcodeline": "json_decref(j_authorization_code);"
    },
    {
        "line": 1027,
        "fullcodeline": "r_jwt_free(jwt);"
    },
    {
        "line": 1028,
        "fullcodeline": "r_jwk_free(jwk_id_token);"
    },
    {
        "line": 83,
        "fullcodeline": "if (u_map_init(&map_redirect) != U_OK) {"
    },
    {
        "line": 89,
        "fullcodeline": "if (u_map_init(&map_login) != U_OK) {"
    },
    {
        "line": 84,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"callback_oidc_authorization - Error u_map_init map_redirect\");"
    },
    {
        "line": 85,
        "fullcodeline": "response->status = 500;"
    },
    {
        "line": 90,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"callback_oidc_authorization - Error u_map_init map_login\");"
    },
    {
        "line": 91,
        "fullcodeline": "response->status = 500;"
    },
    {
        "line": 379,
        "fullcodeline": "has_code = string_array_has_value((const char **)resp_type_array, \"code\");"
    },
    {
        "line": 380,
        "fullcodeline": "has_token = string_array_has_value((const char **)resp_type_array, \"token\");"
    },
    {
        "line": 381,
        "fullcodeline": "has_id_token = string_array_has_value((const char **)resp_type_array, \"id_token\");"
    },
    {
        "line": 382,
        "fullcodeline": "has_none = string_array_has_value((const char **)resp_type_array, \"none\");"
    },
    {
        "line": 431,
        "fullcodeline": "j_client_checked = check_client_valid_without_secret(config, client_id, redirect_uri, (short unsigned int)auth_type, ip_source);"
    },
    {
        "line": 559,
        "fullcodeline": "j_session = validate_session_client_scope(config, request, client_id, scope_reduced);"
    },
    {
        "line": 672,
        "fullcodeline": "issued_for = get_client_hostname(request, config->glewlwyd_config->glewlwyd_config->originating_ip_header);"
    },
    {
        "line": 993,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 96,
        "fullcodeline": "if (u_map_has_key(map, \"state\")) {"
    },
    {
        "line": 100,
        "fullcodeline": "if (u_map_has_key(map, \"redirect_uri\")) {"
    },
    {
        "line": 103,
        "fullcodeline": "if (u_map_has_key(map, \"client_id\")) {"
    },
    {
        "line": 106,
        "fullcodeline": "if (u_map_has_key(map, \"scope\")) {"
    },
    {
        "line": 109,
        "fullcodeline": "if (u_map_has_key(map, \"nonce\")) {"
    },
    {
        "line": 112,
        "fullcodeline": "if (u_map_has_key(map, \"claims\")) {"
    },
    {
        "line": 115,
        "fullcodeline": "if (u_map_has_key(map, \"display\")) {"
    },
    {
        "line": 118,
        "fullcodeline": "if (u_map_has_key(map, \"ui_locales\")) {"
    },
    {
        "line": 121,
        "fullcodeline": "if (u_map_has_key(map, \"login_hint\")) {"
    },
    {
        "line": 124,
        "fullcodeline": "if (u_map_has_key(map, \"prompt\")) {"
    },
    {
        "line": 127,
        "fullcodeline": "if (u_map_has_key(map, \"id_token_hint\")) {"
    },
    {
        "line": 130,
        "fullcodeline": "if (u_map_has_key(map, \"max_age\")) {"
    },
    {
        "line": 133,
        "fullcodeline": "if (u_map_has_key(map, \"code_challenge\")) {"
    },
    {
        "line": 136,
        "fullcodeline": "if (u_map_has_key(map, \"code_challenge_method\")) {"
    },
    {
        "line": 139,
        "fullcodeline": "if (u_map_has_key(map, \"resource\") && json_object_get(config->j_params, \"resource-allowed\") == json_true()) {"
    },
    {
        "line": 142,
        "fullcodeline": "if (u_map_has_key(map, \"dpop_jkt\") && json_object_get(config->j_params, \"oauth-dpop-allowed\") == json_true()) {"
    },
    {
        "line": 146,
        "fullcodeline": "if (u_map_has_key(map, \"response_type\")) {"
    },
    {
        "line": 153,
        "fullcodeline": "if (!o_strnullempty(client_id) && !o_strnullempty(redirect_uri) && check_client_redirect_uri_valid(config, client_id, redirect_uri, ip_source) != G_OK) {"
    },
    {
        "line": 159,
        "fullcodeline": "if (u_map_has_key(map, \"response_mode\")) {"
    },
    {
        "line": 176,
        "fullcodeline": "if (!o_strnullempty(u_map_get(map, \"authorization_details\")) && json_object_get(config->j_params, \"oauth-rar-allowed\") == json_true() && json_object_get(config->j_params, \"rar-allow-auth-unsigned\") == json_true()) {"
    },
    {
        "line": 186,
        "fullcodeline": "if (json_object_get(config->j_params, \"oauth-par-allowed\") == json_true()) {"
    },
    {
        "line": 199,
        "fullcodeline": "if (j_request == NULL && (!o_strnullempty(u_map_get(map, \"request\")) || !o_strnullempty(u_map_get(map, \"request_uri\")))) {"
    },
    {
        "line": 324,
        "fullcodeline": "if (j_authorization_details!= NULL && authorization_details_validate(config, j_authorization_details, client_id, scope) != G_OK) {"
    },
    {
        "line": 332,
        "fullcodeline": "if (j_request != NULL) {"
    },
    {
        "line": 348,
        "fullcodeline": "if (json_object_get(json_object_get(j_client, \"client\"), \"response_mode\") != NULL) {"
    },
    {
        "line": 365,
        "fullcodeline": "if (o_strnullempty(response_type)) {"
    },
    {
        "line": 372,
        "fullcodeline": "if (!split_string(response_type, \" \", &resp_type_array)) {"
    },
    {
        "line": 384,
        "fullcodeline": "if (request_par && json_object_get(json_object_get(j_request, \"request\"), \"additional_parameters\") != NULL) {"
    },
    {
        "line": 390,
        "fullcodeline": "if (!has_code && !has_token && !has_id_token && !has_none) {"
    },
    {
        "line": 396,
        "fullcodeline": "if (string_array_size(resp_type_array) == 1 && has_token && !config->allow_non_oidc) {"
    },
    {
        "line": 406,
        "fullcodeline": "if (has_token && config->allow_non_oidc) {"
    },
    {
        "line": 418,
        "fullcodeline": "if (json_object_get(json_object_get(j_request, \"request\"), \"claims\") != NULL) {"
    },
    {
        "line": 432,
        "fullcodeline": "if (!check_result_value(j_client_checked, G_OK)) {"
    },
    {
        "line": 439,
        "fullcodeline": "if (display != NULL) {"
    },
    {
        "line": 443,
        "fullcodeline": "if (ui_locales != NULL) {"
    },
    {
        "line": 447,
        "fullcodeline": "if (login_hint != NULL) {"
    },
    {
        "line": 451,
        "fullcodeline": "if (j_claims != NULL && parse_claims_request(j_claims) != G_OK) {"
    },
    {
        "line": 474,
        "fullcodeline": "if (j_authorization_details != NULL) {"
    },
    {
        "line": 489,
        "fullcodeline": "if (!u_map_has_key(map, \"g_continue\") && (0 == o_strcmp(\"login\", prompt) || 0 == o_strcmp(\"consent\", prompt) || 0 == o_strcmp(\"select_account\", prompt))) {"
    },
    {
        "line": 500,
        "fullcodeline": "if (!u_map_has_key(map, \"g_continue\") && 0 != o_strcmp(\"none\", prompt)) {"
    },
    {
        "line": 510,
        "fullcodeline": "if (o_strnullempty(scope)) {"
    },
    {
        "line": 518,
        "fullcodeline": "if (!json_string_null_or_empty(json_object_get(config->j_params, \"restrict-scope-client-property\"))) {"
    },
    {
        "line": 540,
        "fullcodeline": "if (!split_string_remove_duplicates(scope_reduced, \" \", &scope_list)) {"
    },
    {
        "line": 548,
        "fullcodeline": "if ((!string_array_has_value((const char **)scope_list, \"openid\") &&"
    },
    {
        "line": 560,
        "fullcodeline": "if (check_result_value(j_session, G_ERROR_NOT_FOUND)) {"
    },
    {
        "line": 604,
        "fullcodeline": "if (0 == o_strcmp(\"none\", prompt)) {"
    },
    {
        "line": 655,
        "fullcodeline": "if (json_object_get(json_object_get(j_session, \"session\"), \"authorization_required\") == json_true()) {"
    },
    {
        "line": 673,
        "fullcodeline": "if (issued_for == NULL) {"
    },
    {
        "line": 681,
        "fullcodeline": "if (config->glewlwyd_config->glewlwyd_callback_trigger_session_used(config->glewlwyd_config, request, json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\"))) != G_OK) {"
    },
    {
        "line": 689,
        "fullcodeline": "if (((auth_type & GLEWLWYD_AUTHORIZATION_TYPE_ID_TOKEN_FLAG) || string_array_has_value((const char **)scope_list, \"openid\")) && o_strnullempty(nonce)) {"
    },
    {
        "line": 697,
        "fullcodeline": "if (j_authorization_details != NULL) {"
    },
    {
        "line": 724,
        "fullcodeline": "if (!o_strnullempty(max_age)) {"
    },
    {
        "line": 746,
        "fullcodeline": "if (json_object_get(config->j_params, \"session-management-allowed\") == json_true()) {"
    },
    {
        "line": 754,
        "fullcodeline": "if (!o_strnullempty(resource)) {"
    },
    {
        "line": 788,
        "fullcodeline": "if (json_object_get(config->j_params, \"oauth-fapi-add-s_hash\") == json_true()) {"
    },
    {
        "line": 792,
        "fullcodeline": "if (get_session_token(config, request, response, sid) != G_OK) {"
    },
    {
        "line": 97,
        "fullcodeline": "u_map_put(&map_redirect, \"state\", u_map_get(map, \"state\"));"
    },
    {
        "line": 98,
        "fullcodeline": "state = u_map_get(map, \"state\");"
    },
    {
        "line": 101,
        "fullcodeline": "redirect_uri = u_map_get(map, \"redirect_uri\");"
    },
    {
        "line": 104,
        "fullcodeline": "client_id = u_map_get(map, \"client_id\");"
    },
    {
        "line": 107,
        "fullcodeline": "scope = u_map_get(map, \"scope\");"
    },
    {
        "line": 110,
        "fullcodeline": "nonce = u_map_get(map, \"nonce\");"
    },
    {
        "line": 113,
        "fullcodeline": "claims = u_map_get(map, \"claims\");"
    },
    {
        "line": 116,
        "fullcodeline": "display = u_map_get(map, \"display\");"
    },
    {
        "line": 119,
        "fullcodeline": "ui_locales = u_map_get(map, \"ui_locales\");"
    },
    {
        "line": 122,
        "fullcodeline": "login_hint = u_map_get(map, \"login_hint\");"
    },
    {
        "line": 125,
        "fullcodeline": "prompt = u_map_get(map, \"prompt\");"
    },
    {
        "line": 128,
        "fullcodeline": "id_token_hint = u_map_get(map, \"id_token_hint\");"
    },
    {
        "line": 131,
        "fullcodeline": "max_age = u_map_get(map, \"max_age\");"
    },
    {
        "line": 134,
        "fullcodeline": "code_challenge = u_map_get(map, \"code_challenge\");"
    },
    {
        "line": 137,
        "fullcodeline": "code_challenge_method = u_map_get(map, \"code_challenge_method\");"
    },
    {
        "line": 140,
        "fullcodeline": "resource = u_map_get(map, \"resource\");"
    },
    {
        "line": 143,
        "fullcodeline": "dpop_jkt = u_map_get(map, \"dpop_jkt\");"
    },
    {
        "line": 147,
        "fullcodeline": "response_type = u_map_get(map, \"response_type\");"
    },
    {
        "line": 154,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - invlid client identified with redirect_uri\");"
    },
    {
        "line": 155,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 160,
        "fullcodeline": "str_response_mode = u_map_get(map, \"response_mode\");"
    },
    {
        "line": 325,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - Invalid authorization_details content, origin: %s\", ip_source);"
    },
    {
        "line": 326,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 327,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"Invalid authorization_details content\");"
    },
    {
        "line": 328,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 333,
        "fullcodeline": "j_client = json_pack(\"{sisO}\", \"result\", G_OK, \"client\", json_object_get(j_request, \"client\"));"
    },
    {
        "line": 349,
        "fullcodeline": "str_response_mode = json_string_value(json_object_get(json_object_get(j_client, \"client\"), \"response_mode\"));"
    },
    {
        "line": 366,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 367,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"response_type missing\");"
    },
    {
        "line": 368,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 373,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"callback_oidc_authorization - Error split_string\");"
    },
    {
        "line": 374,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 375,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 385,
        "fullcodeline": "json_object_foreach(json_object_get(json_object_get(j_request, \"request\"), \"additional_parameters\"), key, j_element) {"
    },
    {
        "line": 391,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"unsupported_response_type\");"
    },
    {
        "line": 392,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 397,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"unsupported_response_type\");"
    },
    {
        "line": 398,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 403,
        "fullcodeline": "auth_type |= GLEWLWYD_AUTHORIZATION_TYPE_AUTHORIZATION_CODE_FLAG;"
    },
    {
        "line": 407,
        "fullcodeline": "auth_type |= GLEWLWYD_AUTHORIZATION_TYPE_TOKEN_FLAG;"
    },
    {
        "line": 411,
        "fullcodeline": "auth_type |= GLEWLWYD_AUTHORIZATION_TYPE_ID_TOKEN_FLAG;"
    },
    {
        "line": 415,
        "fullcodeline": "auth_type |= GLEWLWYD_AUTHORIZATION_TYPE_NONE_FLAG;"
    },
    {
        "line": 419,
        "fullcodeline": "j_claims = json_incref(json_object_get(json_object_get(j_request, \"request\"), \"claims\"));"
    },
    {
        "line": 433,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"unauthorized_client\");"
    },
    {
        "line": 434,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", json_string_value(json_object_get(j_client, \"error_description\")));"
    },
    {
        "line": 435,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 440,
        "fullcodeline": "u_map_put(&map_login, \"display\", display);"
    },
    {
        "line": 444,
        "fullcodeline": "u_map_put(&map_login, \"ui_locales\", ui_locales);"
    },
    {
        "line": 448,
        "fullcodeline": "u_map_put(&map_login, \"login_hint\", login_hint);"
    },
    {
        "line": 452,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - error parsing claims parameter, origin: %s\", ip_source);"
    },
    {
        "line": 453,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 454,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"claims parameter invalid format\");"
    },
    {
        "line": 455,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 475,
        "fullcodeline": "json_array_foreach(j_authorization_details, index, j_element) {"
    },
    {
        "line": 482,
        "fullcodeline": "u_map_put(&map_redirect, \"authorization_details\", rar_list);"
    },
    {
        "line": 483,
        "fullcodeline": "u_map_put(&map_redirect, \"plugin\", config->name);"
    },
    {
        "line": 484,
        "fullcodeline": "u_map_put(&map_login, \"authorization_details\", rar_list);"
    },
    {
        "line": 485,
        "fullcodeline": "u_map_put(&map_login, \"plugin\", config->name);"
    },
    {
        "line": 486,
        "fullcodeline": "o_free(rar_list);"
    },
    {
        "line": 491,
        "fullcodeline": "u_map_put(&map_login, \"prompt\", prompt);"
    },
    {
        "line": 492,
        "fullcodeline": "redirect_url = get_login_url(config, request, \"auth\", client_id, scope, &map_login);"
    },
    {
        "line": 493,
        "fullcodeline": "response->status = 302;"
    },
    {
        "line": 494,
        "fullcodeline": "ulfius_add_header_to_response(response, \"Location\", redirect_url);"
    },
    {
        "line": 495,
        "fullcodeline": "o_free(redirect_url);"
    },
    {
        "line": 502,
        "fullcodeline": "redirect_url = get_login_url(config, request, \"auth\", client_id, scope, &map_login);"
    },
    {
        "line": 503,
        "fullcodeline": "response->status = 302;"
    },
    {
        "line": 504,
        "fullcodeline": "ulfius_add_header_to_response(response, \"Location\", redirect_url);"
    },
    {
        "line": 505,
        "fullcodeline": "o_free(redirect_url);"
    },
    {
        "line": 512,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - scope list is missing or empty or scope 'openid' missing, origin: %s\", ip_source);"
    },
    {
        "line": 513,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_scope\");"
    },
    {
        "line": 514,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 519,
        "fullcodeline": "j_reduced_scope = reduce_scope(scope, json_object_get(json_object_get(j_client, \"client\"), json_string_value(json_object_get(config->j_params, \"restrict-scope-client-property\"))));"
    },
    {
        "line": 541,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - Error split_string_remove_duplicates\");"
    },
    {
        "line": 542,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 543,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 550,
        "fullcodeline": "(auth_type & GLEWLWYD_AUTHORIZATION_TYPE_ID_TOKEN_FLAG && !string_array_has_value((const char **)scope_list, \"openid\"))) {"
    },
    {
        "line": 552,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - scope 'openid' missing, origin: %s\", ip_source);"
    },
    {
        "line": 553,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_scope\");"
    },
    {
        "line": 554,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 674,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - Error get_client_hostname\");"
    },
    {
        "line": 675,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"interaction_required\");"
    },
    {
        "line": 676,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 682,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - Error glewlwyd_callback_trigger_session_used\");"
    },
    {
        "line": 683,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"interaction_required\");"
    },
    {
        "line": 684,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 690,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - nonce required, origin: %s\", ip_source);"
    },
    {
        "line": 691,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 692,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"nonce required\");"
    },
    {
        "line": 693,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 698,
        "fullcodeline": "j_rar_filtered_result = authorization_details_filter(config, j_authorization_details, json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\")), json_object_get(j_client, \"client\"), json_object_get(json_object_get(j_session, \"session\"), \"user\"), ip_source);"
    },
    {
        "line": 725,
        "fullcodeline": "l_max_age = strtol(max_age, &endptr, 10);"
    },
    {
        "line": 747,
        "fullcodeline": "session_state = generate_session_state(client_id, redirect_uri, json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")));"
    },
    {
        "line": 751,
        "fullcodeline": "o_free(session_state);"
    },
    {
        "line": 755,
        "fullcodeline": "count_resource = split_string(resource, \",\", &resource_list);"
    },
    {
        "line": 789,
        "fullcodeline": "s_hash = generate_x_hash(config, json_object_get(j_client, \"client\"), state);"
    },
    {
        "line": 793,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"callback_oidc_authorization - Error get_session_token\");"
    },
    {
        "line": 794,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 795,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 148,
        "fullcodeline": "if (o_strstr(response_type, \"code\") == NULL) {"
    },
    {
        "line": 161,
        "fullcodeline": "if (0 == o_strcmp(\"query\", str_response_mode)) {"
    },
    {
        "line": 177,
        "fullcodeline": "if ((j_authorization_details = json_loads(u_map_get(map, \"authorization_details\"), JSON_DECODE_ANY, NULL)) == NULL) {"
    },
    {
        "line": 187,
        "fullcodeline": "if (o_strlen(u_map_get(map, \"request_uri\")) > json_string_length(json_object_get(config->j_params, \"oauth-par-request_uri-prefix\")) &&"
    },
    {
        "line": 200,
        "fullcodeline": "if (json_object_get(config->j_params, \"request-parameter-allow\") != json_false()) {"
    },
    {
        "line": 233,
        "fullcodeline": "if (check_result_value(j_request, G_ERROR_UNAUTHORIZED) || check_result_value(j_request, G_ERROR_PARAM)) {"
    },
    {
        "line": 335,
        "fullcodeline": "j_client = config->glewlwyd_config->glewlwyd_plugin_callback_get_client(config->glewlwyd_config, client_id);"
    },
    {
        "line": 350,
        "fullcodeline": "if (0 == o_strcmp(\"query\", str_response_mode)) {"
    },
    {
        "line": 386,
        "fullcodeline": "u_map_put(&map_redirect, key, json_string_value(j_element));"
    },
    {
        "line": 461,
        "fullcodeline": "if ((res = is_code_challenge_valid(config, scope, code_challenge, code_challenge_method, code_challenge_stored, (json_object_get(json_object_get(j_client, \"client\"), \"confidential\") == json_true()))) == G_ERROR_PARAM) {"
    },
    {
        "line": 520,
        "fullcodeline": "if (check_result_value(j_reduced_scope, G_OK)) {"
    },
    {
        "line": 536,
        "fullcodeline": "scope_reduced = o_strdup(scope);"
    },
    {
        "line": 549,
        "fullcodeline": "!config->allow_non_oidc) ||"
    },
    {
        "line": 561,
        "fullcodeline": "if (0 == o_strcmp(\"none\", prompt)) {"
    },
    {
        "line": 605,
        "fullcodeline": "if (!o_strnullempty(id_token_hint)) {"
    },
    {
        "line": 656,
        "fullcodeline": "if (0 == o_strcmp(\"none\", prompt)) {"
    },
    {
        "line": 699,
        "fullcodeline": "if (check_result_value(j_rar_filtered_result, G_ERROR_UNAUTHORIZED)) {"
    },
    {
        "line": 726,
        "fullcodeline": "if (!(*endptr) && l_max_age > 0) {"
    },
    {
        "line": 748,
        "fullcodeline": "if (!o_strnullempty(session_state)) {"
    },
    {
        "line": 800,
        "fullcodeline": "if (is_authorization_type_enabled((struct _oidc_config *)user_data, GLEWLWYD_AUTHORIZATION_TYPE_AUTHORIZATION_CODE) && redirect_uri != NULL) {"
    },
    {
        "line": 849,
        "fullcodeline": "if (is_authorization_type_enabled((struct _oidc_config *)user_data, GLEWLWYD_AUTHORIZATION_TYPE_TOKEN) && redirect_uri != NULL) {"
    },
    {
        "line": 919,
        "fullcodeline": "if (is_authorization_type_enabled((struct _oidc_config *)user_data, GLEWLWYD_AUTHORIZATION_TYPE_ID_TOKEN) && redirect_uri != NULL) {"
    },
    {
        "line": 985,
        "fullcodeline": "if (!is_authorization_type_enabled((struct _oidc_config *)user_data, GLEWLWYD_AUTHORIZATION_TYPE_NONE)) {"
    },
    {
        "line": 996,
        "fullcodeline": "if (complete_pushed_authorization_request(config, json_integer_value(json_object_get(json_object_get(j_request, \"request\"), \"gpop_id\")), json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\"))) != G_OK) {"
    },
    {
        "line": 149,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FRAGMENT;"
    },
    {
        "line": 162,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_QUERY;"
    },
    {
        "line": 178,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - Invalid authorization_details, origin: %s\", ip_source);"
    },
    {
        "line": 179,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 180,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"Invalid authorization_details\");"
    },
    {
        "line": 181,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 188,
        "fullcodeline": "0 == o_strncmp(u_map_get(map, \"request_uri\"), json_string_value(json_object_get(config->j_params, \"oauth-par-request_uri-prefix\")), json_string_length(json_object_get(config->j_params, \"oauth-par-request_uri-prefix\")))) {"
    },
    {
        "line": 189,
        "fullcodeline": "j_request = verify_pushed_authorization_request(config, u_map_get(map, \"request_uri\"), client_id, ip_source);"
    },
    {
        "line": 190,
        "fullcodeline": "check_request = 1;"
    },
    {
        "line": 191,
        "fullcodeline": "request_par = 1;"
    },
    {
        "line": 234,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request_object\");"
    },
    {
        "line": 235,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 336,
        "fullcodeline": "if (check_result_value(j_client, G_ERROR_NOT_FOUND) || check_result_value(j_client, G_ERROR_PARAM) || json_object_get(json_object_get(j_client, \"client\"), \"enabled\") != json_true()) {"
    },
    {
        "line": 351,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_QUERY;"
    },
    {
        "line": 420,
        "fullcodeline": "} else if (!o_strnullempty(claims)) {"
    },
    {
        "line": 462,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - code challenge invalid\");"
    },
    {
        "line": 463,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 464,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 476,
        "fullcodeline": "if (rar_list == NULL) {"
    },
    {
        "line": 521,
        "fullcodeline": "scope_reduced = o_strdup(json_string_value(json_object_get(j_reduced_scope, \"scope\")));"
    },
    {
        "line": 563,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - prompt 'none', avoid login page, origin: %s\", ip_source);"
    },
    {
        "line": 564,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"interaction_required\");"
    },
    {
        "line": 565,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 574,
        "fullcodeline": "} else if (check_result_value(j_session, G_ERROR_UNAUTHORIZED)) {"
    },
    {
        "line": 606,
        "fullcodeline": "alg = get_token_sign_alg(config, json_object_get(j_client, \"client\"), GLEWLWYD_TOKEN_TYPE_ID_TOKEN);"
    },
    {
        "line": 607,
        "fullcodeline": "jwk_id_token = get_jwk_sign(config, json_object_get(j_client, \"client\"), alg);"
    },
    {
        "line": 658,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - prompt 'none', avoid login page, origin: %s\", ip_source);"
    },
    {
        "line": 659,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"interaction_required\");"
    },
    {
        "line": 660,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 700,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - authorization_details is invalid for client %s, origin: %s\", client_id, ip_source);"
    },
    {
        "line": 701,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 702,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"authorization_details is invalid for client\");"
    },
    {
        "line": 703,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 727,
        "fullcodeline": "time(&now);"
    },
    {
        "line": 749,
        "fullcodeline": "u_map_put(&map_redirect, \"session_state\", session_state);"
    },
    {
        "line": 802,
        "fullcodeline": "j_authorization_code = generate_authorization_code(config,"
    },
    {
        "line": 850,
        "fullcodeline": "j_authorization_details_processed = authorization_details_process_resource(json_object_get(j_rar_filtered_result, \"authorization_details\"), resource, 1);"
    },
    {
        "line": 986,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"unsupported_response_type\");"
    },
    {
        "line": 987,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 997,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"callback_oidc_authorization - Error complete_pushed_authorization_request\");"
    },
    {
        "line": 998,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 999,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 201,
        "fullcodeline": "if (!o_strnullempty(u_map_get(map, \"request\")) && !o_strnullempty(u_map_get(map, \"request_uri\"))) {"
    },
    {
        "line": 337,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"unauthorized_client\");"
    },
    {
        "line": 338,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 421,
        "fullcodeline": "j_claims = json_loads(claims, JSON_DECODE_ANY, NULL);"
    },
    {
        "line": 477,
        "fullcodeline": "rar_list = o_strdup(json_string_value(json_object_get(j_element, \"type\")));"
    },
    {
        "line": 568,
        "fullcodeline": "response->status = 302;"
    },
    {
        "line": 569,
        "fullcodeline": "redirect_url = get_login_url(config, request, \"auth\", client_id, scope_reduced, &map_login);"
    },
    {
        "line": 570,
        "fullcodeline": "ulfius_add_header_to_response(response, \"Location\", redirect_url);"
    },
    {
        "line": 571,
        "fullcodeline": "o_free(redirect_url);"
    },
    {
        "line": 608,
        "fullcodeline": "if ((jwt = r_jwt_quick_parse(id_token_hint, R_PARSE_NONE, 0)) != NULL &&"
    },
    {
        "line": 646,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - no id_token provided in the request, origin: %s\", ip_source);"
    },
    {
        "line": 647,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 648,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"id_token mandatory\");"
    },
    {
        "line": 649,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 664,
        "fullcodeline": "redirect_url = get_login_url(config, request, \"auth\", client_id, scope_reduced, &map_login);"
    },
    {
        "line": 665,
        "fullcodeline": "ulfius_add_header_to_response(response, \"Location\", redirect_url);"
    },
    {
        "line": 666,
        "fullcodeline": "o_free(redirect_url);"
    },
    {
        "line": 667,
        "fullcodeline": "response->status = 302;"
    },
    {
        "line": 728,
        "fullcodeline": "if (l_max_age < (now - (time_t)config->glewlwyd_config->glewlwyd_callback_get_session_age(config->glewlwyd_config, request, json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\"))))) {"
    },
    {
        "line": 738,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - max_age invalid, origin: %s\", ip_source);"
    },
    {
        "line": 739,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 740,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"max_age invalid\");"
    },
    {
        "line": 741,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 757,
        "fullcodeline": "if (has_token && count_resource > 1) {"
    },
    {
        "line": 764,
        "fullcodeline": "for (index = 0; resource_list[index] != NULL && !resource_error; index++) {"
    },
    {
        "line": 781,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"callback_oidc_authorization - Error split_string resource\");"
    },
    {
        "line": 782,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 783,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 819,
        "fullcodeline": "if (check_result_value(j_authorization_code, G_OK)) {"
    },
    {
        "line": 842,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"unsupported_response_type\");"
    },
    {
        "line": 843,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 851,
        "fullcodeline": "if ((access_token = generate_access_token(config,"
    },
    {
        "line": 912,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"unsupported_response_type\");"
    },
    {
        "line": 913,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 920,
        "fullcodeline": "if ((id_token = generate_id_token(config,"
    },
    {
        "line": 978,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"unsupported_response_type\");"
    },
    {
        "line": 979,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 163,
        "fullcodeline": "} else if (0 == o_strcmp(\"fragment\", str_response_mode)) {"
    },
    {
        "line": 192,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-par-required\") == json_true()) {"
    },
    {
        "line": 203,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 204,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"request_uri forbidden\");"
    },
    {
        "line": 205,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 221,
        "fullcodeline": "} else if (!o_strnullempty(u_map_get(map, \"request\"))) {"
    },
    {
        "line": 237,
        "fullcodeline": "} else if (!check_result_value(j_request, G_OK)) {"
    },
    {
        "line": 352,
        "fullcodeline": "} else if (0 == o_strcmp(\"fragment\", str_response_mode)) {"
    },
    {
        "line": 422,
        "fullcodeline": "if (j_claims == NULL) {"
    },
    {
        "line": 466,
        "fullcodeline": "} else if (res != G_OK) {"
    },
    {
        "line": 479,
        "fullcodeline": "rar_list = mstrcatf(rar_list, \",%s\", json_string_value(json_object_get(j_element, \"type\")));"
    },
    {
        "line": 522,
        "fullcodeline": "} else if (check_result_value(j_reduced_scope, G_ERROR_UNAUTHORIZED)) {"
    },
    {
        "line": 575,
        "fullcodeline": "if (0 == o_strcmp(\"none\", prompt)) {"
    },
    {
        "line": 609,
        "fullcodeline": "r_jwt_verify_signature(jwt, jwk_id_token, 0) == RHN_OK) {"
    },
    {
        "line": 610,
        "fullcodeline": "j_last_token = get_last_id_token(config, json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")), client_id);"
    },
    {
        "line": 705,
        "fullcodeline": "} else if (check_result_value(j_rar_filtered_result, G_OK)) {"
    },
    {
        "line": 730,
        "fullcodeline": "u_map_put(&map_login, \"refresh_login\", \"true\");"
    },
    {
        "line": 731,
        "fullcodeline": "redirect_url = get_login_url(config, request, \"auth\", client_id, scope_reduced, &map_login);"
    },
    {
        "line": 732,
        "fullcodeline": "ulfius_add_header_to_response(response, \"Location\", redirect_url);"
    },
    {
        "line": 733,
        "fullcodeline": "o_free(redirect_url);"
    },
    {
        "line": 734,
        "fullcodeline": "response->status = 302;"
    },
    {
        "line": 758,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"Using multiple resource parameters with the response_type token is forbidden\");"
    },
    {
        "line": 759,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_target\");"
    },
    {
        "line": 760,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"Invalid Resource\");"
    },
    {
        "line": 761,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 803,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")),"
    },
    {
        "line": 805,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\")),"
    },
    {
        "line": 808,
        "fullcodeline": "u_map_get_case(request->map_header, \"user-agent\"),"
    },
    {
        "line": 811,
        "fullcodeline": "json_object_get(json_object_get(j_session, \"session\"), \"amr\"),"
    },
    {
        "line": 815,
        "fullcodeline": "json_object_get(j_rar_filtered_result, \"authorization_details\"),"
    },
    {
        "line": 820,
        "fullcodeline": "authorization_code = json_string_value(json_object_get(j_authorization_code, \"code\"));"
    },
    {
        "line": 834,
        "fullcodeline": "o_free(authorization_code_out);"
    },
    {
        "line": 835,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_OIDC_CODE, 1, \"plugin\", config->name, NULL);"
    },
    {
        "line": 164,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FRAGMENT;"
    },
    {
        "line": 193,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - Pushed authorization request is mandatory, origin: %s\", ip_source);"
    },
    {
        "line": 194,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 222,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"request_not_supported\");"
    },
    {
        "line": 223,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 238,
        "fullcodeline": "response->status = 500;"
    },
    {
        "line": 340,
        "fullcodeline": "} else if (!check_result_value(j_client, G_OK)) {"
    },
    {
        "line": 353,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FRAGMENT;"
    },
    {
        "line": 423,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - error claims parameter not in JSON format, origin: %s\", ip_source);"
    },
    {
        "line": 424,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 425,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"claims parameter not in JSON format\");"
    },
    {
        "line": 426,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 467,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - error is_code_challenge_valid\");"
    },
    {
        "line": 468,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 469,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 523,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - error client %s is not allowed to claim scopes '%s'\", client_id, scope);"
    },
    {
        "line": 524,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_WARNING, \"Security - Authorization invalid for client_id %s at IP Address %s\", client_id, ip_source);"
    },
    {
        "line": 525,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_OIDC_UNAUTHORIZED_CLIENT, 1, \"plugin\", config->name, NULL);"
    },
    {
        "line": 526,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_scope\");"
    },
    {
        "line": 527,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 577,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - prompt 'none', avoid login page, origin: %s\", ip_source);"
    },
    {
        "line": 578,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"interaction_required\");"
    },
    {
        "line": 579,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 596,
        "fullcodeline": "} else if (!check_result_value(j_session, G_OK)) {"
    },
    {
        "line": 611,
        "fullcodeline": "if (check_result_value(j_last_token, G_OK)) {"
    },
    {
        "line": 639,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - id_token has invalid content or signature, origin: %s\", ip_source);"
    },
    {
        "line": 640,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 641,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"id_token invalid\");"
    },
    {
        "line": 642,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 765,
        "fullcodeline": "if ((res = verify_resource(config, resource_list[index], json_object_get(j_client, \"client\"), json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\")))) == G_ERROR_PARAM) {"
    },
    {
        "line": 821,
        "fullcodeline": "if ((authorization_code_out = encrypt_token_if_required(config, authorization_code, json_object_get(j_client, \"client\"), GLEWLWYD_TOKEN_TYPE_CODE, &enc_res)) != NULL) {"
    },
    {
        "line": 837,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc check_auth_type_auth_code_grant - Error generate_authorization_code\");"
    },
    {
        "line": 838,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 839,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 864,
        "fullcodeline": "if (serialize_access_token(config,"
    },
    {
        "line": 906,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc check_auth_type_implicit_grant - Error generate_access_token\");"
    },
    {
        "line": 907,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 908,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 939,
        "fullcodeline": "if (serialize_id_token(config,"
    },
    {
        "line": 972,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc check_auth_type_access_token_request - Error generate_id_token\");"
    },
    {
        "line": 973,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 974,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 206,
        "fullcodeline": "} else if (!o_strnullempty(u_map_get(map, \"request_uri\"))) {"
    },
    {
        "line": 341,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"callback_oidc_authorization - Error glewlwyd_plugin_callback_get_client\");"
    },
    {
        "line": 342,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 343,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 530,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - error reduce_scope\");"
    },
    {
        "line": 531,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 532,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 597,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - Error validate_session_client_scope %s\", json_dumps(j_session, JSON_ENCODE_ANY));"
    },
    {
        "line": 598,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 599,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 706,
        "fullcodeline": "if (json_object_get(j_rar_filtered_result, \"requires_consent\") == json_true()) {"
    },
    {
        "line": 716,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - Error authorization_details_filter\");"
    },
    {
        "line": 717,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 718,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"authorization_details invalid\");"
    },
    {
        "line": 719,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 766,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_target\");"
    },
    {
        "line": 767,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"Invalid Resource\");"
    },
    {
        "line": 768,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 769,
        "fullcodeline": "resource_error = 1;"
    },
    {
        "line": 822,
        "fullcodeline": "u_map_put(&map_redirect, \"code\", authorization_code_out);"
    },
    {
        "line": 852,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")),"
    },
    {
        "line": 853,
        "fullcodeline": "json_object_get(j_client, \"client\"),"
    },
    {
        "line": 854,
        "fullcodeline": "json_object_get(json_object_get(j_session, \"session\"), \"user\"),"
    },
    {
        "line": 855,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\")),"
    },
    {
        "line": 856,
        "fullcodeline": "json_object_get(j_claims, \"userinfo\"),"
    },
    {
        "line": 863,
        "fullcodeline": "get_ip_source(request, config->glewlwyd_config->glewlwyd_config->originating_ip_header))) != NULL) {"
    },
    {
        "line": 877,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc check_auth_type_implicit_grant - Error serialize_access_token\");"
    },
    {
        "line": 878,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 879,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 921,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")),"
    },
    {
        "line": 922,
        "fullcodeline": "json_object_get(json_object_get(j_session, \"session\"), \"user\"),"
    },
    {
        "line": 923,
        "fullcodeline": "json_object_get(j_client, \"client\"),"
    },
    {
        "line": 925,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_callback_get_session_age(config->glewlwyd_config,"
    },
    {
        "line": 929,
        "fullcodeline": "json_object_get(json_object_get(j_session, \"session\"), \"amr\"),"
    },
    {
        "line": 932,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\")),"
    },
    {
        "line": 933,
        "fullcodeline": "json_object_get(j_claims, \"id_token\"),"
    },
    {
        "line": 950,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc check_auth_type_access_token_request - Error serialize_id_token\");"
    },
    {
        "line": 951,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 952,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 165,
        "fullcodeline": "} else if (0 == o_strcmp(\"form_post\", str_response_mode)) {"
    },
    {
        "line": 216,
        "fullcodeline": "o_free(str_request);"
    },
    {
        "line": 225,
        "fullcodeline": "} else if (!o_strnullempty(u_map_get(map, \"request_uri\"))) {"
    },
    {
        "line": 240,
        "fullcodeline": "if (json_string_null_or_empty(json_object_get(json_object_get(j_request, \"request\"), \"client_id\")) || (u_map_has_key(map, \"client_id\") && 0 != o_strcmp(json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"client_id\")), u_map_get(map, \"client_id\")))) {"
    },
    {
        "line": 354,
        "fullcodeline": "} else if (0 == o_strcmp(\"form_post\", str_response_mode)) {"
    },
    {
        "line": 581,
        "fullcodeline": "if (json_object_get(json_object_get(j_session, \"session\"), \"user\") != NULL) {"
    },
    {
        "line": 612,
        "fullcodeline": "if ((id_token_hash = config->glewlwyd_config->glewlwyd_callback_generate_hash(config->glewlwyd_config, id_token_hint)) != NULL) {"
    },
    {
        "line": 708,
        "fullcodeline": "u_map_put(&map_login, \"prompt\", \"consent\");"
    },
    {
        "line": 709,
        "fullcodeline": "redirect_url = get_login_url(config, request, \"auth\", client_id, scope_reduced, &map_login);"
    },
    {
        "line": 710,
        "fullcodeline": "ulfius_add_header_to_response(response, \"Location\", redirect_url);"
    },
    {
        "line": 711,
        "fullcodeline": "o_free(redirect_url);"
    },
    {
        "line": 712,
        "fullcodeline": "response->status = 302;"
    },
    {
        "line": 865,
        "fullcodeline": "(unsigned int)auth_type,"
    },
    {
        "line": 867,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")),"
    },
    {
        "line": 869,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\")),"
    },
    {
        "line": 873,
        "fullcodeline": "u_map_get_case(request->map_header, \"user-agent\"),"
    },
    {
        "line": 902,
        "fullcodeline": "o_free(access_token_out);"
    },
    {
        "line": 903,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_OIDC_USER_ACCESS_TOKEN, 1, \"plugin\", config->name, NULL);"
    },
    {
        "line": 927,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\"))),"
    },
    {
        "line": 942,
        "fullcodeline": "json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")),"
    },
    {
        "line": 945,
        "fullcodeline": "json_integer_value(json_object_get(j_authorization_code, \"gpoc_id\")),"
    },
    {
        "line": 949,
        "fullcodeline": "u_map_get_case(request->map_header, \"user-agent\")) != G_OK) {"
    },
    {
        "line": 967,
        "fullcodeline": "o_free(id_token_out);"
    },
    {
        "line": 968,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_OIDC_ID_TOKEN, 1, \"plugin\", config->name, \"response_type\", response_type, NULL);"
    },
    {
        "line": 969,
        "fullcodeline": "config->glewlwyd_config->glewlwyd_plugin_callback_metrics_increment_counter(config->glewlwyd_config, GLWD_METRICS_OIDC_ID_TOKEN, 1, \"plugin\", config->name, NULL);"
    },
    {
        "line": 166,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FORM_POST;"
    },
    {
        "line": 207,
        "fullcodeline": "if ((str_request = get_request_from_uri(config, u_map_get(map, \"request_uri\"))) == NULL) {"
    },
    {
        "line": 226,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"request_uri_not_supported\");"
    },
    {
        "line": 227,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 242,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - client_id missing or invalid, origin: %s\", ip_source);"
    },
    {
        "line": 243,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 355,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FORM_POST;"
    },
    {
        "line": 583,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - scope list '%s' is invalid for user '%s', origin: %s\", scope, json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")), ip_source);"
    },
    {
        "line": 584,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_scope\");"
    },
    {
        "line": 585,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 626,
        "fullcodeline": "} else if (check_result_value(j_last_token, G_ERROR_NOT_FOUND)) {"
    },
    {
        "line": 770,
        "fullcodeline": "} else if (res != G_OK) {"
    },
    {
        "line": 823,
        "fullcodeline": "} else if (enc_res == G_ERROR_UNAUTHORIZED) {"
    },
    {
        "line": 882,
        "fullcodeline": "if ((access_token_out = encrypt_token_if_required(config, access_token, json_object_get(j_client, \"client\"), GLEWLWYD_TOKEN_TYPE_ACCESS_TOKEN, &enc_res)) != NULL) {"
    },
    {
        "line": 955,
        "fullcodeline": "if ((id_token_out = encrypt_token_if_required(config, id_token, json_object_get(j_client, \"client\"), GLEWLWYD_TOKEN_TYPE_ID_TOKEN, &enc_res)) != NULL) {"
    },
    {
        "line": 208,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - Error getting request from uri %s, origin: %s\", u_map_get(map, \"request_uri\"), ip_source);"
    },
    {
        "line": 209,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request_uri\");"
    },
    {
        "line": 210,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 217,
        "fullcodeline": "} else if (!o_strnullempty(u_map_get(map, \"request\"))) {"
    },
    {
        "line": 588,
        "fullcodeline": "u_map_put(&map_login, \"prompt\", prompt);"
    },
    {
        "line": 589,
        "fullcodeline": "redirect_url = get_login_url(config, request, \"auth\", client_id, scope_reduced, &map_login);"
    },
    {
        "line": 590,
        "fullcodeline": "ulfius_add_header_to_response(response, \"Location\", redirect_url);"
    },
    {
        "line": 591,
        "fullcodeline": "o_free(redirect_url);"
    },
    {
        "line": 592,
        "fullcodeline": "response->status = 302;"
    },
    {
        "line": 613,
        "fullcodeline": "if (0 != o_strcmp(id_token_hash, json_string_value(json_object_get(json_object_get(j_last_token, \"id_token\"), \"token_hash\")))) {"
    },
    {
        "line": 621,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - Error glewlwyd_callback_generate_hash\");"
    },
    {
        "line": 622,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 623,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 627,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - no id_token was provided to client '%s' for user '%s', origin: %s\", client_id, json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")), ip_source);"
    },
    {
        "line": 628,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 629,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"id_token mandatory\");"
    },
    {
        "line": 630,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 771,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"callback_oidc_authorization - Error verify_resource\");"
    },
    {
        "line": 772,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 773,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 774,
        "fullcodeline": "resource_error = 1;"
    },
    {
        "line": 824,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 825,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"Invalid encryption parameters\");"
    },
    {
        "line": 826,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 884,
        "fullcodeline": "iat_str = msprintf(\"%ld\", now);"
    },
    {
        "line": 885,
        "fullcodeline": "u_map_put(&map_redirect, \"access_token\", access_token_out);"
    },
    {
        "line": 886,
        "fullcodeline": "u_map_put(&map_redirect, \"token_type\", \"bearer\");"
    },
    {
        "line": 887,
        "fullcodeline": "u_map_put(&map_redirect, \"expires_in\", expires_in_str);"
    },
    {
        "line": 888,
        "fullcodeline": "u_map_put(&map_redirect, \"iat\", iat_str);"
    },
    {
        "line": 889,
        "fullcodeline": "u_map_put(&map_redirect, \"scope\", json_string_value(json_object_get(json_object_get(j_session, \"session\"), \"scope_filtered\")));"
    },
    {
        "line": 890,
        "fullcodeline": "o_free(expires_in_str);"
    },
    {
        "line": 891,
        "fullcodeline": "o_free(iat_str);"
    },
    {
        "line": 956,
        "fullcodeline": "u_map_put(&map_redirect, \"id_token\", id_token_out);"
    },
    {
        "line": 167,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && (0 == o_strcmp(\"query.jwt\", str_response_mode) || 0 == o_strcmp(\"jwt\", str_response_mode))) {"
    },
    {
        "line": 213,
        "fullcodeline": "j_request = validate_jwt_auth_request(config, str_request, client_id, ip_source);"
    },
    {
        "line": 214,
        "fullcodeline": "check_request = 1;"
    },
    {
        "line": 218,
        "fullcodeline": "j_request = validate_jwt_auth_request(config, u_map_get(map, \"request\"), client_id, ip_source);"
    },
    {
        "line": 219,
        "fullcodeline": "check_request = 1;"
    },
    {
        "line": 244,
        "fullcodeline": "} else if (json_string_null_or_empty(json_object_get(json_object_get(j_request, \"request\"), \"response_type\")) || (u_map_has_key(map, \"response_type\") && 0 != o_strcmp(json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"response_type\")), u_map_get(map, \"response_type\")))) {"
    },
    {
        "line": 356,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && (0 == o_strcmp(\"query.jwt\", str_response_mode) || 0 == o_strcmp(\"jwt\", str_response_mode))) {"
    },
    {
        "line": 614,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"oidc validate_endpoint_auth - id_token_hint was not the last one provided to client '%s' for user '%s', origin: %s\", client_id, json_string_value(json_object_get(json_object_get(json_object_get(j_session, \"session\"), \"user\"), \"username\")), ip_source);"
    },
    {
        "line": 615,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 616,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"id_token invalid\");"
    },
    {
        "line": 617,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 633,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc validate_endpoint_auth - Error get_last_id_token\");"
    },
    {
        "line": 634,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 635,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 829,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_ERROR, \"oidc check_auth_type_auth_code_grant - encrypt_token_if_required for code\");"
    },
    {
        "line": 830,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 831,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 168,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_QUERY_JWT;"
    },
    {
        "line": 246,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - response_type missing or invalid, origin: %s\", ip_source);"
    },
    {
        "line": 247,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 357,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_QUERY_JWT;"
    },
    {
        "line": 892,
        "fullcodeline": "} else if (enc_res == G_ERROR_UNAUTHORIZED) {"
    },
    {
        "line": 957,
        "fullcodeline": "} else if (enc_res == G_ERROR_UNAUTHORIZED) {"
    },
    {
        "line": 893,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 894,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"Invalid encryption parameters\");"
    },
    {
        "line": 895,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 958,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"invalid_request\");"
    },
    {
        "line": 959,
        "fullcodeline": "u_map_put(&map_redirect, \"error_description\", \"Invalid encryption parameters\");"
    },
    {
        "line": 960,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 169,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && 0 == o_strcmp(\"fragment.jwt\", str_response_mode)) {"
    },
    {
        "line": 248,
        "fullcodeline": "} else if (json_string_null_or_empty(json_object_get(json_object_get(j_request, \"request\"), \"redirect_uri\"))) {"
    },
    {
        "line": 358,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && 0 == o_strcmp(\"fragment.jwt\", str_response_mode)) {"
    },
    {
        "line": 898,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 899,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 963,
        "fullcodeline": "u_map_put(&map_redirect, \"error\", \"server_error\");"
    },
    {
        "line": 964,
        "fullcodeline": "build_auth_response(config, response, response_mode, json_object_get(j_client, \"client\"), redirect_uri, &map_redirect);"
    },
    {
        "line": 170,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FRAGMENT_JWT;"
    },
    {
        "line": 249,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - redirect_uri missing, origin: %s\", ip_source);"
    },
    {
        "line": 251,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 359,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FRAGMENT_JWT;"
    },
    {
        "line": 253,
        "fullcodeline": "response_type = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"response_type\"));"
    },
    {
        "line": 254,
        "fullcodeline": "redirect_uri = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"redirect_uri\"));"
    },
    {
        "line": 255,
        "fullcodeline": "client_id = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"client_id\"));"
    },
    {
        "line": 256,
        "fullcodeline": "scope = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"scope\"));"
    },
    {
        "line": 257,
        "fullcodeline": "display = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"display\"));"
    },
    {
        "line": 258,
        "fullcodeline": "ui_locales = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"ui_locales\"));"
    },
    {
        "line": 259,
        "fullcodeline": "login_hint = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"login_hint\"));"
    },
    {
        "line": 260,
        "fullcodeline": "prompt = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"prompt\"));"
    },
    {
        "line": 261,
        "fullcodeline": "max_age = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"max_age\"));"
    },
    {
        "line": 171,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && 0 == o_strcmp(\"form_post.jwt\", str_response_mode)) {"
    },
    {
        "line": 262,
        "fullcodeline": "if (!o_strnullempty(client_id) && !o_strnullempty(redirect_uri) && check_client_redirect_uri_valid(config, client_id, redirect_uri, ip_source) != G_OK) {"
    },
    {
        "line": 267,
        "fullcodeline": "if (code_challenge == NULL || request_par) {"
    },
    {
        "line": 270,
        "fullcodeline": "if (code_challenge_method == NULL || request_par) {"
    },
    {
        "line": 273,
        "fullcodeline": "if (nonce == NULL || request_par) {"
    },
    {
        "line": 276,
        "fullcodeline": "if (!u_map_has_key(&map_redirect, \"state\")) {"
    },
    {
        "line": 280,
        "fullcodeline": "if ((resource == NULL || request_par) && json_object_get(config->j_params, \"resource-allowed\") == json_true()) {"
    },
    {
        "line": 283,
        "fullcodeline": "if ((dpop_jkt == NULL || request_par) && json_object_get(config->j_params, \"oauth-dpop-allowed\") == json_true()) {"
    },
    {
        "line": 286,
        "fullcodeline": "if ((j_authorization_details == NULL || request_par) && json_object_get(json_object_get(j_request, \"request\"), \"authorization_details\") != NULL) {"
    },
    {
        "line": 304,
        "fullcodeline": "if (json_object_get(json_object_get(j_request, \"request\"), \"response_mode\") != NULL) {"
    },
    {
        "line": 360,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && 0 == o_strcmp(\"form_post.jwt\", str_response_mode)) {"
    },
    {
        "line": 172,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FORM_POST_JWT;"
    },
    {
        "line": 263,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - invlid client identified with redirect_uri\");"
    },
    {
        "line": 264,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 268,
        "fullcodeline": "code_challenge = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"code_challenge\"));"
    },
    {
        "line": 271,
        "fullcodeline": "code_challenge_method = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"code_challenge_method\"));"
    },
    {
        "line": 274,
        "fullcodeline": "nonce = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"nonce\"));"
    },
    {
        "line": 277,
        "fullcodeline": "u_map_put(&map_redirect, \"state\", json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"state\")));"
    },
    {
        "line": 278,
        "fullcodeline": "state = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"state\"));"
    },
    {
        "line": 281,
        "fullcodeline": "resource = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"resource\"));"
    },
    {
        "line": 284,
        "fullcodeline": "dpop_jkt = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"dpop_jkt\"));"
    },
    {
        "line": 305,
        "fullcodeline": "str_response_mode = json_string_value(json_object_get(json_object_get(j_request, \"request\"), \"response_mode\"));"
    },
    {
        "line": 361,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FORM_POST_JWT;"
    },
    {
        "line": 287,
        "fullcodeline": "if (json_object_get(config->j_params, \"oauth-rar-allowed\") == json_true()) {"
    },
    {
        "line": 306,
        "fullcodeline": "if (0 == o_strcmp(\"query\", str_response_mode)) {"
    },
    {
        "line": 307,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_QUERY;"
    },
    {
        "line": 288,
        "fullcodeline": "if ((json_integer_value(json_object_get(j_request, \"type\")) != R_JWT_TYPE_NESTED_SIGN_THEN_ENCRYPT && json_object_get(config->j_params, \"rar-allow-auth-unencrypted\") == json_true()) || json_integer_value(json_object_get(j_request, \"type\")) == R_JWT_TYPE_NESTED_SIGN_THEN_ENCRYPT) {"
    },
    {
        "line": 298,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - authorization_details fobidden, origin: %s\", ip_source);"
    },
    {
        "line": 300,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 289,
        "fullcodeline": "json_decref(j_authorization_details);"
    },
    {
        "line": 290,
        "fullcodeline": "j_authorization_details = json_incref(json_object_get(json_object_get(j_request, \"request\"), \"authorization_details\"));"
    },
    {
        "line": 308,
        "fullcodeline": "} else if (0 == o_strcmp(\"fragment\", str_response_mode)) {"
    },
    {
        "line": 292,
        "fullcodeline": "y_log_message(Y_LOG_LEVEL_DEBUG, \"callback_oidc_authorization - unencrypted authorization_details fobidden, origin: %s\", ip_source);"
    },
    {
        "line": 294,
        "fullcodeline": "response->status = 403;"
    },
    {
        "line": 309,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FRAGMENT;"
    },
    {
        "line": 310,
        "fullcodeline": "} else if (0 == o_strcmp(\"form_post\", str_response_mode)) {"
    },
    {
        "line": 311,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FORM_POST;"
    },
    {
        "line": 312,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && (0 == o_strcmp(\"query.jwt\", str_response_mode) || 0 == o_strcmp(\"jwt\", str_response_mode))) {"
    },
    {
        "line": 313,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_QUERY_JWT;"
    },
    {
        "line": 314,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && 0 == o_strcmp(\"fragment.jwt\", str_response_mode)) {"
    },
    {
        "line": 315,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FRAGMENT_JWT;"
    },
    {
        "line": 316,
        "fullcodeline": "} else if (json_object_get(config->j_params, \"oauth-fapi-allow-jarm\") == json_true() && 0 == o_strcmp(\"form_post.jwt\", str_response_mode)) {"
    },
    {
        "line": 317,
        "fullcodeline": "response_mode = GLEWLWYD_RESPONSE_MODE_FORM_POST_JWT;"
    }
]