[
    {
        "line": 4,
        "fullcodeline": "struct usb_cdc_union_desc *union_header = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "struct usb_cdc_country_functional_desc *cfd = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "struct usb_endpoint_descriptor *epctrl = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "struct usb_endpoint_descriptor *epread = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "struct usb_endpoint_descriptor *epwrite = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "struct usb_device *usb_dev = interface_to_usbdev(intf);"
    },
    {
        "line": 18,
        "fullcodeline": "u8 ac_management_function = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "u8 call_management_function = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "int call_interface_num = -1;"
    },
    {
        "line": 21,
        "fullcodeline": "int data_interface_num = -1;"
    },
    {
        "line": 25,
        "fullcodeline": "unsigned int elength = 0;"
    },
    {
        "line": 26,
        "fullcodeline": "int combined_interfaces = 0;"
    },
    {
        "line": 28,
        "fullcodeline": "int rv = -ENOMEM;"
    },
    {
        "line": 31,
        "fullcodeline": "quirks = (unsigned long)id->driver_info;"
    },
    {
        "line": 36,
        "fullcodeline": "num_rx_buf = (quirks == SINGLE_RX_URB) ? 1 : ACM_NR;"
    },
    {
        "line": 228,
        "fullcodeline": "dev_dbg(&intf->dev, \"interfaces are valid\\n\");"
    },
    {
        "line": 230,
        "fullcodeline": "acm = kzalloc(sizeof(struct acm), GFP_KERNEL);"
    },
    {
        "line": 234,
        "fullcodeline": "minor = acm_alloc_minor(acm);"
    },
    {
        "line": 241,
        "fullcodeline": "ctrlsize = usb_endpoint_maxp(epctrl);"
    },
    {
        "line": 242,
        "fullcodeline": "readsize = usb_endpoint_maxp(epread) *"
    },
    {
        "line": 244,
        "fullcodeline": "acm->combined_interfaces = combined_interfaces;"
    },
    {
        "line": 245,
        "fullcodeline": "acm->writesize = usb_endpoint_maxp(epwrite) * 20;"
    },
    {
        "line": 246,
        "fullcodeline": "acm->control = control_interface;"
    },
    {
        "line": 247,
        "fullcodeline": "acm->data = data_interface;"
    },
    {
        "line": 248,
        "fullcodeline": "acm->minor = minor;"
    },
    {
        "line": 249,
        "fullcodeline": "acm->dev = usb_dev;"
    },
    {
        "line": 250,
        "fullcodeline": "acm->ctrl_caps = ac_management_function;"
    },
    {
        "line": 253,
        "fullcodeline": "acm->ctrlsize = ctrlsize;"
    },
    {
        "line": 254,
        "fullcodeline": "acm->readsize = readsize;"
    },
    {
        "line": 255,
        "fullcodeline": "acm->rx_buflimit = num_rx_buf;"
    },
    {
        "line": 256,
        "fullcodeline": "INIT_WORK(&acm->work, acm_softint);"
    },
    {
        "line": 257,
        "fullcodeline": "init_waitqueue_head(&acm->wioctl);"
    },
    {
        "line": 258,
        "fullcodeline": "spin_lock_init(&acm->write_lock);"
    },
    {
        "line": 259,
        "fullcodeline": "spin_lock_init(&acm->read_lock);"
    },
    {
        "line": 260,
        "fullcodeline": "mutex_init(&acm->mutex);"
    },
    {
        "line": 261,
        "fullcodeline": "acm->rx_endpoint = usb_rcvbulkpipe(usb_dev, epread->bEndpointAddress);"
    },
    {
        "line": 262,
        "fullcodeline": "acm->is_int_ep = usb_endpoint_xfer_int(epread);"
    },
    {
        "line": 265,
        "fullcodeline": "tty_port_init(&acm->port);"
    },
    {
        "line": 266,
        "fullcodeline": "acm->port.ops = &acm_port_ops;"
    },
    {
        "line": 267,
        "fullcodeline": "init_usb_anchor(&acm->delayed);"
    },
    {
        "line": 268,
        "fullcodeline": "acm->quirks = quirks;"
    },
    {
        "line": 270,
        "fullcodeline": "buf = usb_alloc_coherent(usb_dev, ctrlsize, GFP_KERNEL, &acm->ctrl_dma);"
    },
    {
        "line": 273,
        "fullcodeline": "acm->ctrl_buffer = buf;"
    },
    {
        "line": 278,
        "fullcodeline": "acm->ctrlurb = usb_alloc_urb(0, GFP_KERNEL);"
    },
    {
        "line": 338,
        "fullcodeline": "usb_set_intfdata(intf, acm);"
    },
    {
        "line": 340,
        "fullcodeline": "i = device_create_file(&intf->dev, &dev_attr_bmCapabilities);"
    },
    {
        "line": 373,
        "fullcodeline": "usb_fill_int_urb(acm->ctrlurb, usb_dev,"
    },
    {
        "line": 378,
        "fullcodeline": "acm->ctrlurb->transfer_flags |= URB_NO_TRANSFER_DMA_MAP;"
    },
    {
        "line": 379,
        "fullcodeline": "acm->ctrlurb->transfer_dma = acm->ctrl_dma;"
    },
    {
        "line": 381,
        "fullcodeline": "dev_info(&intf->dev, \"ttyACM%d: USB ACM device\\n\", minor);"
    },
    {
        "line": 383,
        "fullcodeline": "acm->line.dwDTERate = cpu_to_le32(9600);"
    },
    {
        "line": 384,
        "fullcodeline": "acm->line.bDataBits = 8;"
    },
    {
        "line": 385,
        "fullcodeline": "acm_set_line(acm, &acm->line);"
    },
    {
        "line": 387,
        "fullcodeline": "usb_driver_claim_interface(&acm_driver, data_interface, acm);"
    },
    {
        "line": 388,
        "fullcodeline": "usb_set_intfdata(data_interface, acm);"
    },
    {
        "line": 390,
        "fullcodeline": "usb_get_intf(control_interface);"
    },
    {
        "line": 391,
        "fullcodeline": "tty_dev = tty_port_register_device(&acm->port, acm_tty_driver, minor,"
    },
    {
        "line": 412,
        "fullcodeline": "device_remove_file(&acm->control->dev, &dev_attr_bmCapabilities);"
    },
    {
        "line": 414,
        "fullcodeline": "usb_set_intfdata(intf, NULL);"
    },
    {
        "line": 420,
        "fullcodeline": "acm_read_buffers_free(acm);"
    },
    {
        "line": 421,
        "fullcodeline": "usb_free_urb(acm->ctrlurb);"
    },
    {
        "line": 423,
        "fullcodeline": "acm_write_buffers_free(acm);"
    },
    {
        "line": 425,
        "fullcodeline": "usb_free_coherent(usb_dev, ctrlsize, acm->ctrl_buffer, acm->ctrl_dma);"
    },
    {
        "line": 427,
        "fullcodeline": "acm_release_minor(acm);"
    },
    {
        "line": 428,
        "fullcodeline": "kfree(acm);"
    },
    {
        "line": 33,
        "fullcodeline": "if (quirks == IGNORE_DEVICE)"
    },
    {
        "line": 39,
        "fullcodeline": "if (quirks == NO_UNION_NORMAL) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (!buffer) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (!buflen) {"
    },
    {
        "line": 66,
        "fullcodeline": "while (buflen > 0) {"
    },
    {
        "line": 122,
        "fullcodeline": "if (!union_header) {"
    },
    {
        "line": 147,
        "fullcodeline": "if (!control_interface || !data_interface) {"
    },
    {
        "line": 152,
        "fullcodeline": "if (data_interface_num != call_interface_num)"
    },
    {
        "line": 155,
        "fullcodeline": "if (control_interface == data_interface) {"
    },
    {
        "line": 188,
        "fullcodeline": "if (data_interface->cur_altsetting->desc.bInterfaceClass"
    },
    {
        "line": 201,
        "fullcodeline": "if (!combined_interfaces && intf != control_interface)"
    },
    {
        "line": 204,
        "fullcodeline": "if (!combined_interfaces && usb_interface_claimed(data_interface)) {"
    },
    {
        "line": 211,
        "fullcodeline": "if (data_interface->cur_altsetting->desc.bNumEndpoints < 2 ||"
    },
    {
        "line": 221,
        "fullcodeline": "if (!usb_endpoint_dir_in(epread)) {"
    },
    {
        "line": 231,
        "fullcodeline": "if (acm == NULL)"
    },
    {
        "line": 235,
        "fullcodeline": "if (minor < 0) {"
    },
    {
        "line": 251,
        "fullcodeline": "if (quirks & NO_CAP_LINE)"
    },
    {
        "line": 271,
        "fullcodeline": "if (!buf)"
    },
    {
        "line": 275,
        "fullcodeline": "if (acm_write_buffers_alloc(acm) < 0)"
    },
    {
        "line": 279,
        "fullcodeline": "if (!acm->ctrlurb)"
    },
    {
        "line": 282,
        "fullcodeline": "for (i = 0; i < num_rx_buf; i++) {"
    },
    {
        "line": 317,
        "fullcodeline": "for (i = 0; i < ACM_NW; i++) {"
    },
    {
        "line": 341,
        "fullcodeline": "if (i < 0)"
    },
    {
        "line": 374,
        "fullcodeline": "usb_rcvintpipe(usb_dev, epctrl->bEndpointAddress),"
    },
    {
        "line": 377,
        "fullcodeline": "epctrl->bInterval ? epctrl->bInterval : 16);"
    },
    {
        "line": 393,
        "fullcodeline": "if (IS_ERR(tty_dev)) {"
    },
    {
        "line": 398,
        "fullcodeline": "if (quirks & CLEAR_HALT_CONDITIONS) {"
    },
    {
        "line": 415,
        "fullcodeline": "for (i = 0; i < ACM_NW; i++)"
    },
    {
        "line": 418,
        "fullcodeline": "for (i = 0; i < num_rx_buf; i++)"
    },
    {
        "line": 419,
        "fullcodeline": "usb_free_urb(acm->read_urbs[i]);"
    },
    {
        "line": 40,
        "fullcodeline": "data_interface = usb_ifnum_to_if(usb_dev, 1);"
    },
    {
        "line": 41,
        "fullcodeline": "control_interface = usb_ifnum_to_if(usb_dev, 0);"
    },
    {
        "line": 47,
        "fullcodeline": "dev_err(&intf->dev, \"Weird descriptor references\\n\");"
    },
    {
        "line": 67,
        "fullcodeline": "elength = buffer[0];"
    },
    {
        "line": 118,
        "fullcodeline": "buflen -= elength;"
    },
    {
        "line": 119,
        "fullcodeline": "buffer += elength;"
    },
    {
        "line": 148,
        "fullcodeline": "dev_dbg(&intf->dev, \"no interfaces\\n\");"
    },
    {
        "line": 153,
        "fullcodeline": "dev_dbg(&intf->dev, \"Separate call control interface. That is not fully supported.\\n\");"
    },
    {
        "line": 157,
        "fullcodeline": "dev_warn(&intf->dev,\"Control and data interfaces are not separated!\\n\");"
    },
    {
        "line": 158,
        "fullcodeline": "combined_interfaces = 1;"
    },
    {
        "line": 160,
        "fullcodeline": "quirks |= NO_CAP_LINE;"
    },
    {
        "line": 206,
        "fullcodeline": "dev_dbg(&intf->dev, \"The data interface isn't available\\n\");"
    },
    {
        "line": 212,
        "fullcodeline": "control_interface->cur_altsetting->desc.bNumEndpoints == 0)"
    },
    {
        "line": 223,
        "fullcodeline": "dev_dbg(&intf->dev,"
    },
    {
        "line": 225,
        "fullcodeline": "swap(epread, epwrite);"
    },
    {
        "line": 236,
        "fullcodeline": "dev_err(&intf->dev, \"no more free acm devices\\n\");"
    },
    {
        "line": 237,
        "fullcodeline": "kfree(acm);"
    },
    {
        "line": 243,
        "fullcodeline": "(quirks == SINGLE_RX_URB ? 1 : 2);"
    },
    {
        "line": 252,
        "fullcodeline": "acm->ctrl_caps &= ~USB_CDC_CAP_LINE;"
    },
    {
        "line": 264,
        "fullcodeline": "acm->bInterval = epread->bInterval;"
    },
    {
        "line": 286,
        "fullcodeline": "rb->base = usb_alloc_coherent(acm->dev, readsize, GFP_KERNEL,"
    },
    {
        "line": 290,
        "fullcodeline": "rb->index = i;"
    },
    {
        "line": 291,
        "fullcodeline": "rb->instance = acm;"
    },
    {
        "line": 293,
        "fullcodeline": "urb = usb_alloc_urb(0, GFP_KERNEL);"
    },
    {
        "line": 297,
        "fullcodeline": "urb->transfer_flags |= URB_NO_TRANSFER_DMA_MAP;"
    },
    {
        "line": 298,
        "fullcodeline": "urb->transfer_dma = rb->dma;"
    },
    {
        "line": 314,
        "fullcodeline": "acm->read_urbs[i] = urb;"
    },
    {
        "line": 315,
        "fullcodeline": "__set_bit(i, &acm->read_urbs_free);"
    },
    {
        "line": 320,
        "fullcodeline": "snd->urb = usb_alloc_urb(0, GFP_KERNEL);"
    },
    {
        "line": 332,
        "fullcodeline": "snd->urb->transfer_flags |= URB_NO_TRANSFER_DMA_MAP;"
    },
    {
        "line": 335,
        "fullcodeline": "snd->instance = acm;"
    },
    {
        "line": 345,
        "fullcodeline": "acm->country_codes = kmalloc(cfd->bLength - 4, GFP_KERNEL);"
    },
    {
        "line": 348,
        "fullcodeline": "acm->country_code_size = cfd->bLength - 4;"
    },
    {
        "line": 349,
        "fullcodeline": "memcpy(acm->country_codes, (u8 *)&cfd->wCountyCode0,"
    },
    {
        "line": 351,
        "fullcodeline": "acm->country_rel_date = cfd->iCountryCodeRelDate;"
    },
    {
        "line": 353,
        "fullcodeline": "i = device_create_file(&intf->dev, &dev_attr_wCountryCodes);"
    },
    {
        "line": 361,
        "fullcodeline": "i = device_create_file(&intf->dev,"
    },
    {
        "line": 394,
        "fullcodeline": "rv = PTR_ERR(tty_dev);"
    },
    {
        "line": 399,
        "fullcodeline": "usb_clear_halt(usb_dev, usb_rcvbulkpipe(usb_dev, epread->bEndpointAddress));"
    },
    {
        "line": 400,
        "fullcodeline": "usb_clear_halt(usb_dev, usb_sndbulkpipe(usb_dev, epwrite->bEndpointAddress));"
    },
    {
        "line": 406,
        "fullcodeline": "device_remove_file(&acm->control->dev,"
    },
    {
        "line": 408,
        "fullcodeline": "device_remove_file(&acm->control->dev,"
    },
    {
        "line": 410,
        "fullcodeline": "kfree(acm->country_codes);"
    },
    {
        "line": 34,
        "fullcodeline": "return -ENODEV;"
    },
    {
        "line": 48,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 52,
        "fullcodeline": "if (intf->cur_altsetting->endpoint &&"
    },
    {
        "line": 68,
        "fullcodeline": "if (!elength) {"
    },
    {
        "line": 73,
        "fullcodeline": "if (buffer[1] != USB_DT_CS_INTERFACE) {"
    },
    {
        "line": 123,
        "fullcodeline": "if (call_interface_num > 0) {"
    },
    {
        "line": 143,
        "fullcodeline": "control_interface = usb_ifnum_to_if(usb_dev, union_header->bMasterInterface0);"
    },
    {
        "line": 144,
        "fullcodeline": "data_interface = usb_ifnum_to_if(usb_dev, (data_interface_num = union_header->bSlaveInterface0));"
    },
    {
        "line": 149,
        "fullcodeline": "return -ENODEV;"
    },
    {
        "line": 161,
        "fullcodeline": "if (data_interface->cur_altsetting->desc.bNumEndpoints != 3) {"
    },
    {
        "line": 166,
        "fullcodeline": "for (i = 0; i < 3; i++) {"
    },
    {
        "line": 179,
        "fullcodeline": "if (!epctrl || !epread || !epwrite)"
    },
    {
        "line": 190,
        "fullcodeline": "if (control_interface->cur_altsetting->desc.bInterfaceClass"
    },
    {
        "line": 202,
        "fullcodeline": "return -ENODEV;"
    },
    {
        "line": 207,
        "fullcodeline": "return -EBUSY;"
    },
    {
        "line": 213,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 238,
        "fullcodeline": "return -ENODEV;"
    },
    {
        "line": 288,
        "fullcodeline": "if (!rb->base)"
    },
    {
        "line": 294,
        "fullcodeline": "if (!urb)"
    },
    {
        "line": 321,
        "fullcodeline": "if (snd->urb == NULL)"
    },
    {
        "line": 324,
        "fullcodeline": "if (usb_endpoint_xfer_int(epwrite))"
    },
    {
        "line": 333,
        "fullcodeline": "if (quirks & SEND_ZERO_PACKET)"
    },
    {
        "line": 346,
        "fullcodeline": "if (!acm->country_codes)"
    },
    {
        "line": 350,
        "fullcodeline": "cfd->bLength - 4);"
    },
    {
        "line": 354,
        "fullcodeline": "if (i < 0) {"
    },
    {
        "line": 363,
        "fullcodeline": "if (i < 0) {"
    },
    {
        "line": 55,
        "fullcodeline": "dev_dbg(&intf->dev,"
    },
    {
        "line": 57,
        "fullcodeline": "buflen = intf->cur_altsetting->endpoint->extralen;"
    },
    {
        "line": 58,
        "fullcodeline": "buffer = intf->cur_altsetting->endpoint->extra;"
    },
    {
        "line": 69,
        "fullcodeline": "dev_err(&intf->dev, \"skipping garbage byte\\n\");"
    },
    {
        "line": 70,
        "fullcodeline": "elength = 1;"
    },
    {
        "line": 74,
        "fullcodeline": "dev_err(&intf->dev, \"skipping garbage\\n\");"
    },
    {
        "line": 87,
        "fullcodeline": "union_header = (struct usb_cdc_union_desc *)buffer;"
    },
    {
        "line": 92,
        "fullcodeline": "cfd = (struct usb_cdc_country_functional_desc *)buffer;"
    },
    {
        "line": 99,
        "fullcodeline": "ac_management_function = buffer[3];"
    },
    {
        "line": 104,
        "fullcodeline": "call_management_function = buffer[3];"
    },
    {
        "line": 105,
        "fullcodeline": "call_interface_num = buffer[4];"
    },
    {
        "line": 112,
        "fullcodeline": "dev_dbg(&intf->dev, \"Ignoring descriptor: \""
    },
    {
        "line": 124,
        "fullcodeline": "dev_dbg(&intf->dev, \"No union descriptor, using call management descriptor\\n\");"
    },
    {
        "line": 130,
        "fullcodeline": "control_interface = intf;"
    },
    {
        "line": 162,
        "fullcodeline": "dev_err(&intf->dev, \"This needs exactly 3 endpoints\\n\");"
    },
    {
        "line": 192,
        "fullcodeline": "dev_dbg(&intf->dev,"
    },
    {
        "line": 194,
        "fullcodeline": "swap(control_interface, data_interface);"
    },
    {
        "line": 300,
        "fullcodeline": "usb_fill_int_urb(urb, acm->dev,"
    },
    {
        "line": 325,
        "fullcodeline": "usb_fill_int_urb(snd->urb, usb_dev,"
    },
    {
        "line": 334,
        "fullcodeline": "snd->urb->transfer_flags |= URB_ZERO_PACKET;"
    },
    {
        "line": 355,
        "fullcodeline": "kfree(acm->country_codes);"
    },
    {
        "line": 356,
        "fullcodeline": "acm->country_codes = NULL;"
    },
    {
        "line": 357,
        "fullcodeline": "acm->country_code_size = 0;"
    },
    {
        "line": 364,
        "fullcodeline": "device_remove_file(&intf->dev, &dev_attr_wCountryCodes);"
    },
    {
        "line": 365,
        "fullcodeline": "kfree(acm->country_codes);"
    },
    {
        "line": 366,
        "fullcodeline": "acm->country_codes = NULL;"
    },
    {
        "line": 367,
        "fullcodeline": "acm->country_code_size = 0;"
    },
    {
        "line": 60,
        "fullcodeline": "dev_err(&intf->dev,"
    },
    {
        "line": 80,
        "fullcodeline": "if (elength < sizeof(struct usb_cdc_union_desc))"
    },
    {
        "line": 90,
        "fullcodeline": "if (elength < sizeof(struct usb_cdc_country_functional_desc))"
    },
    {
        "line": 97,
        "fullcodeline": "if (elength < 4)"
    },
    {
        "line": 102,
        "fullcodeline": "if (elength < 5)"
    },
    {
        "line": 126,
        "fullcodeline": "if (quirks & NO_DATA_INTERFACE)"
    },
    {
        "line": 163,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 170,
        "fullcodeline": "if (usb_endpoint_is_int_in(ep))"
    },
    {
        "line": 180,
        "fullcodeline": "return -ENODEV;"
    },
    {
        "line": 307,
        "fullcodeline": "usb_fill_bulk_urb(urb, acm->dev,"
    },
    {
        "line": 326,
        "fullcodeline": "usb_sndintpipe(usb_dev, epwrite->bEndpointAddress),"
    },
    {
        "line": 329,
        "fullcodeline": "usb_fill_bulk_urb(snd->urb, usb_dev,"
    },
    {
        "line": 62,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 83,
        "fullcodeline": "dev_err(&intf->dev, \"More than one \""
    },
    {
        "line": 127,
        "fullcodeline": "data_interface = usb_ifnum_to_if(usb_dev, 0);"
    },
    {
        "line": 132,
        "fullcodeline": "if (intf->cur_altsetting->desc.bNumEndpoints != 3) {"
    },
    {
        "line": 171,
        "fullcodeline": "epctrl = ep;"
    },
    {
        "line": 196,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 330,
        "fullcodeline": "usb_sndbulkpipe(usb_dev, epwrite->bEndpointAddress),"
    },
    {
        "line": 129,
        "fullcodeline": "data_interface = usb_ifnum_to_if(usb_dev, (data_interface_num = call_interface_num));"
    },
    {
        "line": 133,
        "fullcodeline": "dev_dbg(&intf->dev,\"No union descriptor, giving up\\n\");"
    },
    {
        "line": 134,
        "fullcodeline": "return -ENODEV;"
    },
    {
        "line": 136,
        "fullcodeline": "dev_warn(&intf->dev,\"No union descriptor, testing for castrated device\\n\");"
    },
    {
        "line": 137,
        "fullcodeline": "combined_interfaces = 1;"
    },
    {
        "line": 138,
        "fullcodeline": "control_interface = data_interface = intf;"
    },
    {
        "line": 172,
        "fullcodeline": "else if (usb_endpoint_is_bulk_out(ep))"
    },
    {
        "line": 173,
        "fullcodeline": "epwrite = ep;"
    },
    {
        "line": 174,
        "fullcodeline": "else if (usb_endpoint_is_bulk_in(ep))"
    },
    {
        "line": 175,
        "fullcodeline": "epread = ep;"
    },
    {
        "line": 177,
        "fullcodeline": "return -EINVAL;"
    }
]