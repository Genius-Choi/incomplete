[
    {
        "line": 5,
        "fullcodeline": "int syncpipe[2];"
    },
    {
        "line": 6,
        "fullcodeline": "struct nlconfig_t config = {0};"
    },
    {
        "line": 12,
        "fullcodeline": "pipenum = initpipe();"
    },
    {
        "line": 17,
        "fullcodeline": "nl_parse(pipenum, &config);"
    },
    {
        "line": 13,
        "fullcodeline": "if (pipenum == -1)"
    },
    {
        "line": 20,
        "fullcodeline": "if (config.cloneflags == -1)"
    },
    {
        "line": 28,
        "fullcodeline": "if (setjmp(env) == JUMP_VAL) {"
    },
    {
        "line": 24,
        "fullcodeline": "if (pipe(syncpipe) < 0)"
    },
    {
        "line": 33,
        "fullcodeline": "uint8_t s = 0;"
    },
    {
        "line": 34,
        "fullcodeline": "int consolefd = config.consolefd;"
    },
    {
        "line": 55,
        "fullcodeline": "if (consolefd != -1) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (read(syncpipe[0], &s, sizeof(s)) != sizeof(s) || s != SYNC_VAL)"
    },
    {
        "line": 46,
        "fullcodeline": "if (setuid(0) < 0)"
    },
    {
        "line": 49,
        "fullcodeline": "if (setgid(0) < 0)"
    },
    {
        "line": 52,
        "fullcodeline": "if (setgroups(0, NULL) < 0)"
    },
    {
        "line": 56,
        "fullcodeline": "if (ioctl(consolefd, TIOCSCTTY, 0) < 0)"
    },
    {
        "line": 58,
        "fullcodeline": "if (dup3(consolefd, STDIN_FILENO, 0) != STDIN_FILENO)"
    },
    {
        "line": 60,
        "fullcodeline": "if (dup3(consolefd, STDOUT_FILENO, 0) != STDOUT_FILENO)"
    },
    {
        "line": 62,
        "fullcodeline": "if (dup3(consolefd, STDERR_FILENO, 0) != STDERR_FILENO)"
    }
]