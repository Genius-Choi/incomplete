[
    {
        "line": 3,
        "fullcodeline": "struct addrinfo hints = { 0 };"
    },
    {
        "line": 7,
        "fullcodeline": "char addr[INET6_ADDRSTRLEN];"
    },
    {
        "line": 8,
        "fullcodeline": "char strport[8];"
    },
    {
        "line": 9,
        "fullcodeline": "int yes = 1;"
    },
    {
        "line": 10,
        "fullcodeline": "int no = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "cfgaddr = cfg_getstr(cfg_getsec(cfg, \"general\"), \"bind_address\");"
    },
    {
        "line": 16,
        "fullcodeline": "hints.ai_socktype = (type & (SOCK_STREAM | SOCK_DGRAM)); // filter since type can be SOCK_STREAM | SOCK_NONBLOCK"
    },
    {
        "line": 17,
        "fullcodeline": "hints.ai_family = (cfg_getbool(cfg_getsec(cfg, \"general\"), \"ipv6\")) ? AF_INET6 : AF_INET;"
    },
    {
        "line": 18,
        "fullcodeline": "hints.ai_flags = cfgaddr ? 0 : AI_PASSIVE;"
    },
    {
        "line": 20,
        "fullcodeline": "snprintf(strport, sizeof(strport), \"%hu\", *port);"
    },
    {
        "line": 21,
        "fullcodeline": "ret = getaddrinfo(cfgaddr, strport, &hints, &servinfo);"
    },
    {
        "line": 61,
        "fullcodeline": "freeaddrinfo(servinfo);"
    },
    {
        "line": 70,
        "fullcodeline": "ret = getsockname(fd, ptr->ai_addr, &ptr->ai_addrlen);"
    },
    {
        "line": 77,
        "fullcodeline": "net_port_get(port, (union net_sockaddr *)ptr->ai_addr);"
    },
    {
        "line": 78,
        "fullcodeline": "net_address_get(addr, sizeof(addr), (union net_sockaddr *)ptr->ai_addr);"
    },
    {
        "line": 80,
        "fullcodeline": "DPRINTF(E_DBG, L_MISC, \"Service '%s' bound to %s, port %hu, socket %d\\n\", log_service_name, addr, *port, fd);"
    },
    {
        "line": 85,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 22,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 28,
        "fullcodeline": "for (ptr = servinfo, fd = -1; ptr != NULL; ptr = ptr->ai_next)"
    },
    {
        "line": 63,
        "fullcodeline": "if (!ptr)"
    },
    {
        "line": 71,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 86,
        "fullcodeline": "return -1;"
    },
    {
        "line": 24,
        "fullcodeline": "DPRINTF(E_LOG, L_MISC, \"Failure creating '%s' service, could not resolve '%s' (port %s): %s\\n\", log_service_name, cfgaddr ? cfgaddr : \"(ANY)\", strport, gai_strerror(ret));"
    },
    {
        "line": 33,
        "fullcodeline": "fd = socket(ptr->ai_family, type | SOCK_CLOEXEC, ptr->ai_protocol);"
    },
    {
        "line": 38,
        "fullcodeline": "ret = setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, &yes, sizeof(yes));"
    },
    {
        "line": 42,
        "fullcodeline": "ret = setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(yes));"
    },
    {
        "line": 54,
        "fullcodeline": "ret = bind(fd, ptr->ai_addr, ptr->ai_addrlen);"
    },
    {
        "line": 65,
        "fullcodeline": "DPRINTF(E_LOG, L_MISC, \"Could not create service '%s' with address %s, port %hu: %s\\n\", log_service_name, cfgaddr ? cfgaddr : \"(ANY)\", *port, strerror(errno));"
    },
    {
        "line": 73,
        "fullcodeline": "DPRINTF(E_LOG, L_MISC, \"Could not find address of service '%s': %s\\n\", log_service_name, strerror(errno));"
    },
    {
        "line": 25,
        "fullcodeline": "return -1;"
    },
    {
        "line": 30,
        "fullcodeline": "if (fd >= 0)"
    },
    {
        "line": 34,
        "fullcodeline": "if (fd < 0)"
    },
    {
        "line": 39,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 43,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 46,
        "fullcodeline": "if (ptr->ai_family == AF_INET6)"
    },
    {
        "line": 55,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 31,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 49,
        "fullcodeline": "ret = setsockopt(fd, IPPROTO_IPV6, IPV6_V6ONLY, &no, sizeof(no));"
    },
    {
        "line": 50,
        "fullcodeline": "if (ret < 0)"
    }
]