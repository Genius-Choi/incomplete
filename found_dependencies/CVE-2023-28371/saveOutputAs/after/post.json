[
    {
        "line": 4,
        "fullcodeline": "const QFileInfo outputInfo(outputFile);"
    },
    {
        "line": 5,
        "fullcodeline": "const QDir dir=outputInfo.dir(); // will hold complete dirname"
    },
    {
        "line": 6,
        "fullcodeline": "const QFileInfo newFileNameInfo(name);"
    },
    {
        "line": 8,
        "fullcodeline": "const bool okToSaveToAbsolutePath=StelApp::getInstance().getSettings()->value(\"scripts/flag_script_allow_write_absolute_path\", false).toBool();"
    },
    {
        "line": 37,
        "fullcodeline": "qDebug() << \"saving copy of output.txt to \" << asFile.fileName();"
    },
    {
        "line": 38,
        "fullcodeline": "asFile.write(qPrintable(outputText), outputText.size());"
    },
    {
        "line": 39,
        "fullcodeline": "asFile.close();"
    },
    {
        "line": 10,
        "fullcodeline": "if (name.contains(\"config.ini\"))"
    },
    {
        "line": 16,
        "fullcodeline": "if (!okToSaveToAbsolutePath && ((newFileNameInfo.isAbsolute() || (name.contains(\"..\"))))) // The last condition may include dangerous/malicious paths"
    },
    {
        "line": 32,
        "fullcodeline": "if (!asFile.open(QIODevice::WriteOnly | QIODevice::Truncate | QIODevice::Text | QIODevice::Unbuffered))"
    },
    {
        "line": 12,
        "fullcodeline": "qWarning() << \"SCRIPTING ERROR: You are trying to overwrite config.ini. Ignoring.\";"
    },
    {
        "line": 18,
        "fullcodeline": "qWarning() << \"SCRIPTING CONFIGURATION ISSUE: You are trying to save to an absolute pathname or move up in directories.\";"
    },
    {
        "line": 19,
        "fullcodeline": "qWarning() << \"  To enable this, edit config.ini and set [scripts]/flag_script_allow_write_absolute_path=true\";"
    },
    {
        "line": 20,
        "fullcodeline": "asFile.setFileName(dir.absolutePath() + \"/\" + newFileNameInfo.fileName());"
    },
    {
        "line": 21,
        "fullcodeline": "qWarning() << \"  Storing to \" << asFile.fileName() << \" instead\";"
    },
    {
        "line": 34,
        "fullcodeline": "qDebug() << \"ERROR: Cannot open file\" << asFile.fileName();"
    },
    {
        "line": 23,
        "fullcodeline": "else if (okToSaveToAbsolutePath && (newFileNameInfo.isAbsolute()))"
    },
    {
        "line": 25,
        "fullcodeline": "asFile.setFileName(name);"
    },
    {
        "line": 29,
        "fullcodeline": "asFile.setFileName(dir.absolutePath() + \"/\" + name);"
    }
]