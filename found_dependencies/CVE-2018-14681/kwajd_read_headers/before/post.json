[
    {
        "line": 5,
        "fullcodeline": "unsigned char buf[16];"
    },
    {
        "line": 21,
        "fullcodeline": "hdr->comp_type    = EndGetI16(&buf[kwajh_CompMethod]);"
    },
    {
        "line": 22,
        "fullcodeline": "hdr->data_offset  = EndGetI16(&buf[kwajh_DataOffset]);"
    },
    {
        "line": 23,
        "fullcodeline": "hdr->headers      = EndGetI16(&buf[kwajh_Flags]);"
    },
    {
        "line": 24,
        "fullcodeline": "hdr->length       = 0;"
    },
    {
        "line": 25,
        "fullcodeline": "hdr->filename     = NULL;"
    },
    {
        "line": 26,
        "fullcodeline": "hdr->extra        = NULL;"
    },
    {
        "line": 27,
        "fullcodeline": "hdr->extra_length = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "if (sys->read(fh, &buf[0], kwajh_SIZEOF) != kwajh_SIZEOF) {"
    },
    {
        "line": 14,
        "fullcodeline": "if (((unsigned int) EndGetI32(&buf[kwajh_Signature1]) != 0x4A41574B) ||"
    },
    {
        "line": 32,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASLENGTH) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASUNKNOWN1) {"
    },
    {
        "line": 43,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASUNKNOWN2) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (hdr->headers & (MSKWAJ_HDR_HASFILENAME | MSKWAJ_HDR_HASFILEEXT)) {"
    },
    {
        "line": 80,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASEXTRATEXT) {"
    },
    {
        "line": 15,
        "fullcodeline": "((unsigned int) EndGetI32(&buf[kwajh_Signature2]) != 0xD127F088))"
    },
    {
        "line": 34,
        "fullcodeline": "hdr->length = EndGetI32(&buf[0]);"
    },
    {
        "line": 45,
        "fullcodeline": "i = EndGetI16(&buf[0]);"
    },
    {
        "line": 51,
        "fullcodeline": "off_t pos = sys->tell(fh);"
    },
    {
        "line": 52,
        "fullcodeline": "char *fn = (char *) sys->alloc(sys, (size_t) 13);"
    },
    {
        "line": 56,
        "fullcodeline": "hdr->filename = fn;"
    },
    {
        "line": 76,
        "fullcodeline": "*fn = '\\0';"
    },
    {
        "line": 82,
        "fullcodeline": "i = EndGetI16(&buf[0]);"
    },
    {
        "line": 83,
        "fullcodeline": "hdr->extra = (char *) sys->alloc(sys, (size_t)i+1);"
    },
    {
        "line": 86,
        "fullcodeline": "hdr->extra[i] = '\\0';"
    },
    {
        "line": 87,
        "fullcodeline": "hdr->extra_length = i;"
    },
    {
        "line": 33,
        "fullcodeline": "if (sys->read(fh, &buf[0], 4) != 4) return MSPACK_ERR_READ;"
    },
    {
        "line": 39,
        "fullcodeline": "if (sys->read(fh, &buf[0], 2) != 2) return MSPACK_ERR_READ;"
    },
    {
        "line": 44,
        "fullcodeline": "if (sys->read(fh, &buf[0], 2) != 2) return MSPACK_ERR_READ;"
    },
    {
        "line": 46,
        "fullcodeline": "if (sys->seek(fh, (off_t)i, MSPACK_SYS_SEEK_CUR)) return MSPACK_ERR_SEEK;"
    },
    {
        "line": 55,
        "fullcodeline": "if (! fn) return MSPACK_ERR_NOMEMORY;"
    },
    {
        "line": 59,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASFILENAME) {"
    },
    {
        "line": 68,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASFILEEXT) {"
    },
    {
        "line": 81,
        "fullcodeline": "if (sys->read(fh, &buf[0], 2) != 2) return MSPACK_ERR_READ;"
    },
    {
        "line": 84,
        "fullcodeline": "if (! hdr->extra) return MSPACK_ERR_NOMEMORY;"
    },
    {
        "line": 85,
        "fullcodeline": "if (sys->read(fh, hdr->extra, i) != i) return MSPACK_ERR_READ;"
    },
    {
        "line": 62,
        "fullcodeline": "pos += (i < 9) ? i+1 : 9;"
    },
    {
        "line": 69,
        "fullcodeline": "*fn++ = '.';"
    },
    {
        "line": 72,
        "fullcodeline": "pos += (i < 4) ? i+1 : 4;"
    },
    {
        "line": 60,
        "fullcodeline": "if (sys->read(fh, &buf[0], 9) != 9) return MSPACK_ERR_READ;"
    },
    {
        "line": 61,
        "fullcodeline": "for (i = 0; i < 9; i++, fn++) if (!(*fn = buf[i])) break;"
    },
    {
        "line": 63,
        "fullcodeline": "if (sys->seek(fh, pos, MSPACK_SYS_SEEK_START))"
    },
    {
        "line": 70,
        "fullcodeline": "if (sys->read(fh, &buf[0], 4) != 4) return MSPACK_ERR_READ;"
    },
    {
        "line": 71,
        "fullcodeline": "for (i = 0; i < 4; i++, fn++) if (!(*fn = buf[i])) break;"
    },
    {
        "line": 73,
        "fullcodeline": "if (sys->seek(fh, pos, MSPACK_SYS_SEEK_START))"
    }
]