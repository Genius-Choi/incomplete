[
    {
        "line": 5,
        "fullcodeline": "unsigned char buf[16];"
    },
    {
        "line": 21,
        "fullcodeline": "hdr->comp_type    = EndGetI16(&buf[kwajh_CompMethod]);"
    },
    {
        "line": 22,
        "fullcodeline": "hdr->data_offset  = EndGetI16(&buf[kwajh_DataOffset]);"
    },
    {
        "line": 23,
        "fullcodeline": "hdr->headers      = EndGetI16(&buf[kwajh_Flags]);"
    },
    {
        "line": 24,
        "fullcodeline": "hdr->length       = 0;"
    },
    {
        "line": 25,
        "fullcodeline": "hdr->filename     = NULL;"
    },
    {
        "line": 26,
        "fullcodeline": "hdr->extra        = NULL;"
    },
    {
        "line": 27,
        "fullcodeline": "hdr->extra_length = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "if (sys->read(fh, &buf[0], kwajh_SIZEOF) != kwajh_SIZEOF) {"
    },
    {
        "line": 14,
        "fullcodeline": "if (((unsigned int) EndGetI32(&buf[kwajh_Signature1]) != 0x4A41574B) ||"
    },
    {
        "line": 32,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASLENGTH) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASUNKNOWN1) {"
    },
    {
        "line": 43,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASUNKNOWN2) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (hdr->headers & (MSKWAJ_HDR_HASFILENAME | MSKWAJ_HDR_HASFILEEXT)) {"
    },
    {
        "line": 86,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASEXTRATEXT) {"
    },
    {
        "line": 15,
        "fullcodeline": "((unsigned int) EndGetI32(&buf[kwajh_Signature2]) != 0xD127F088))"
    },
    {
        "line": 34,
        "fullcodeline": "hdr->length = EndGetI32(&buf[0]);"
    },
    {
        "line": 45,
        "fullcodeline": "i = EndGetI16(&buf[0]);"
    },
    {
        "line": 53,
        "fullcodeline": "char *fn = (char *) sys->alloc(sys, (size_t) 13);"
    },
    {
        "line": 82,
        "fullcodeline": "*fn = '\\0';"
    },
    {
        "line": 88,
        "fullcodeline": "i = EndGetI16(&buf[0]);"
    },
    {
        "line": 89,
        "fullcodeline": "hdr->extra = (char *) sys->alloc(sys, (size_t)i+1);"
    },
    {
        "line": 92,
        "fullcodeline": "hdr->extra[i] = '\\0';"
    },
    {
        "line": 93,
        "fullcodeline": "hdr->extra_length = i;"
    },
    {
        "line": 33,
        "fullcodeline": "if (sys->read(fh, &buf[0], 4) != 4) return MSPACK_ERR_READ;"
    },
    {
        "line": 39,
        "fullcodeline": "if (sys->read(fh, &buf[0], 2) != 2) return MSPACK_ERR_READ;"
    },
    {
        "line": 44,
        "fullcodeline": "if (sys->read(fh, &buf[0], 2) != 2) return MSPACK_ERR_READ;"
    },
    {
        "line": 46,
        "fullcodeline": "if (sys->seek(fh, (off_t)i, MSPACK_SYS_SEEK_CUR)) return MSPACK_ERR_SEEK;"
    },
    {
        "line": 54,
        "fullcodeline": "if (!(hdr->filename = fn)) return MSPACK_ERR_NOMEMORY;"
    },
    {
        "line": 57,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASFILENAME) {"
    },
    {
        "line": 70,
        "fullcodeline": "if (hdr->headers & MSKWAJ_HDR_HASFILEEXT) {"
    },
    {
        "line": 87,
        "fullcodeline": "if (sys->read(fh, &buf[0], 2) != 2) return MSPACK_ERR_READ;"
    },
    {
        "line": 90,
        "fullcodeline": "if (! hdr->extra) return MSPACK_ERR_NOMEMORY;"
    },
    {
        "line": 91,
        "fullcodeline": "if (sys->read(fh, hdr->extra, i) != i) return MSPACK_ERR_READ;"
    },
    {
        "line": 66,
        "fullcodeline": "fn--; /* remove the null terminator */"
    },
    {
        "line": 71,
        "fullcodeline": "*fn++ = '.';"
    },
    {
        "line": 80,
        "fullcodeline": "fn--; /* remove the null terminator */"
    },
    {
        "line": 59,
        "fullcodeline": "if ((len = sys->read(fh, &buf[0], 9)) < 2) return MSPACK_ERR_READ;"
    },
    {
        "line": 60,
        "fullcodeline": "for (i = 0; i < len; i++) if (!(*fn++ = buf[i])) break;"
    },
    {
        "line": 62,
        "fullcodeline": "if (i == 9 && buf[8] != '\\0') return MSPACK_ERR_DATAFORMAT;"
    },
    {
        "line": 64,
        "fullcodeline": "if (sys->seek(fh, (off_t)(i + 1 - len), MSPACK_SYS_SEEK_CUR))"
    },
    {
        "line": 73,
        "fullcodeline": "if ((len = sys->read(fh, &buf[0], 4)) < 2) return MSPACK_ERR_READ;"
    },
    {
        "line": 74,
        "fullcodeline": "for (i = 0; i < len; i++) if (!(*fn++ = buf[i])) break;"
    },
    {
        "line": 76,
        "fullcodeline": "if (i == 4 && buf[3] != '\\0') return MSPACK_ERR_DATAFORMAT;"
    },
    {
        "line": 78,
        "fullcodeline": "if (sys->seek(fh, (off_t)(i + 1 - len), MSPACK_SYS_SEEK_CUR))"
    }
]