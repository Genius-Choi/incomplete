[
    {
        "line": 2,
        "fullcodeline": "@user = find_user_for_update"
    },
    {
        "line": 4,
        "fullcodeline": "if @user.update_password password_from_password_reset_params"
    },
    {
        "line": 7,
        "fullcodeline": "sign_in @user"
    },
    {
        "line": 8,
        "fullcodeline": "redirect_to url_after_update"
    },
    {
        "line": 5,
        "fullcodeline": "@user.reset_api_key! if reset_params[:reset_api_key] == \"true\""
    },
    {
        "line": 6,
        "fullcodeline": "@user.api_keys.expire_all! if reset_params[:reset_api_keys] == \"true\""
    },
    {
        "line": 9,
        "fullcodeline": "session[:password_reset_token] = nil"
    },
    {
        "line": 12,
        "fullcodeline": "render template: \"passwords/edit\""
    }
]