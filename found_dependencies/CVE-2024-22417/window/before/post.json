[
    {
        "line": 2,
        "fullcodeline": "target_url = request.args.get('location')"
    },
    {
        "line": 7,
        "fullcodeline": "content_filter = Filter("
    },
    {
        "line": 11,
        "fullcodeline": "target = urlparse.urlparse(target_url)"
    },
    {
        "line": 12,
        "fullcodeline": "host_url = f'{target.scheme}://{target.netloc}'"
    },
    {
        "line": 14,
        "fullcodeline": "get_body = g.user_request.send(base_url=target_url).text"
    },
    {
        "line": 16,
        "fullcodeline": "results = bsoup(get_body, 'html.parser')"
    },
    {
        "line": 17,
        "fullcodeline": "src_attrs = ['src', 'href', 'srcset', 'data-srcset', 'data-src']"
    },
    {
        "line": 35,
        "fullcodeline": "img_sources = ['src', 'data-src', 'data-srcset', 'srcset']"
    },
    {
        "line": 3,
        "fullcodeline": "if target_url.startswith('gAAAAA'):"
    },
    {
        "line": 20,
        "fullcodeline": "for element in results.find_all():"
    },
    {
        "line": 28,
        "fullcodeline": "for script in results.find_all('script', {'src': True}):"
    },
    {
        "line": 36,
        "fullcodeline": "for img in results.find_all('img'):"
    },
    {
        "line": 43,
        "fullcodeline": "for link in results.find_all('link', {'href': True}):"
    },
    {
        "line": 47,
        "fullcodeline": "for a in results.find_all('a', {'href': True}):"
    },
    {
        "line": 53,
        "fullcodeline": "for iframe in results.find_all('iframe'):"
    },
    {
        "line": 56,
        "fullcodeline": "return render_template("
    },
    {
        "line": 4,
        "fullcodeline": "cipher_suite = Fernet(g.session_key)"
    },
    {
        "line": 5,
        "fullcodeline": "target_url = cipher_suite.decrypt(target_url.encode()).decode()"
    },
    {
        "line": 37,
        "fullcodeline": "_ = ["
    },
    {
        "line": 44,
        "fullcodeline": "content_filter.update_element_src(link, 'text/css', attr='href')"
    },
    {
        "line": 48,
        "fullcodeline": "a['href'] = f'{Endpoint.window}?location=' + a['href'] + ("
    },
    {
        "line": 54,
        "fullcodeline": "iframe.decompose()"
    },
    {
        "line": 21,
        "fullcodeline": "for attr in src_attrs:"
    },
    {
        "line": 29,
        "fullcodeline": "if 'nojs' in request.args:"
    },
    {
        "line": 60,
        "fullcodeline": "g.user_config.get_localization_lang()"
    },
    {
        "line": 30,
        "fullcodeline": "script.decompose()"
    },
    {
        "line": 32,
        "fullcodeline": "content_filter.update_element_src(script, 'application/javascript')"
    },
    {
        "line": 49,
        "fullcodeline": "'&nojs=1' if 'nojs' in request.args else '')"
    },
    {
        "line": 25,
        "fullcodeline": "element[attr] = host_url + element[attr]"
    },
    {
        "line": 22,
        "fullcodeline": "if not element.has_attr(attr) or not element[attr].startswith('/'):"
    },
    {
        "line": 39,
        "fullcodeline": "for _ in img_sources if img.has_attr(_)"
    },
    {
        "line": 38,
        "fullcodeline": "content_filter.update_element_src(img, 'image/png', attr=_)"
    }
]