[
    {
        "line": 2,
        "fullcodeline": "lock_guard<recursive_mutex> guard(routerMutex);"
    },
    {
        "line": 3,
        "fullcodeline": "LOG(INFO) << \"Listening to id/key FIFO\";"
    },
    {
        "line": 4,
        "fullcodeline": "int terminalFd = socketHandler->accept(serverFd);"
    },
    {
        "line": 5,
        "fullcodeline": "if (terminalFd < 0) {"
    },
    {
        "line": 13,
        "fullcodeline": "LOG(INFO) << \"Connected\";"
    },
    {
        "line": 32,
        "fullcodeline": "return IdKeyPair({\"\", \"\"});"
    },
    {
        "line": 23,
        "fullcodeline": "TerminalUserInfo tui = stringToProto<TerminalUserInfo>(packet.getPayload());"
    },
    {
        "line": 24,
        "fullcodeline": "tui.set_fd(terminalFd);"
    },
    {
        "line": 6,
        "fullcodeline": "if (GetErrno() != EAGAIN && GetErrno() != EWOULDBLOCK) {"
    },
    {
        "line": 26,
        "fullcodeline": "return IdKeyPair({tui.id(), tui.passkey()});"
    },
    {
        "line": 17,
        "fullcodeline": "if (!socketHandler->readPacket(terminalFd, &packet)) {"
    },
    {
        "line": 18,
        "fullcodeline": "STFATAL << \"Missing user info packet\";"
    },
    {
        "line": 20,
        "fullcodeline": "if (packet.getHeader() != TerminalPacketType::TERMINAL_USER_INFO) {"
    },
    {
        "line": 25,
        "fullcodeline": "idInfoMap[tui.id()] = tui;"
    },
    {
        "line": 28,
        "fullcodeline": "STFATAL << \"Router can't talk to terminal: \" << re.what();"
    },
    {
        "line": 7,
        "fullcodeline": "FATAL_FAIL(-1);  // STFATAL with the error"
    },
    {
        "line": 21,
        "fullcodeline": "STFATAL << \"Got an invalid packet header: \" << int(packet.getHeader());"
    },
    {
        "line": 9,
        "fullcodeline": "return IdKeyPair({\"\", \"\"});  // Nothing to accept this time"
    }
]