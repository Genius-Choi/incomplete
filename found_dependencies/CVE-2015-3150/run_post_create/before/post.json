[
    {
        "line": 51,
        "fullcodeline": "int child_pid = spawn_event_handler_child(dirname, \"post-create\", &child_stdout_fd);"
    },
    {
        "line": 53,
        "fullcodeline": "char *dup_of_dir = NULL;"
    },
    {
        "line": 54,
        "fullcodeline": "struct strbuf *cmd_output = strbuf_new();"
    },
    {
        "line": 56,
        "fullcodeline": "bool child_is_post_create = 1; /* else it is a notify child */"
    },
    {
        "line": 102,
        "fullcodeline": "int status = 0;"
    },
    {
        "line": 130,
        "fullcodeline": "const char *work_dir = (dup_of_dir ? dup_of_dir : dirname);"
    },
    {
        "line": 133,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(work_dir, /*flags:*/ 0);"
    },
    {
        "line": 139,
        "fullcodeline": "char *count_str = dd_load_text_ext(dd, FILENAME_COUNT, DD_FAIL_QUIETLY_ENOENT);"
    },
    {
        "line": 140,
        "fullcodeline": "unsigned long count = strtoul(count_str, NULL, 10);"
    },
    {
        "line": 189,
        "fullcodeline": "dd_sanitize_mode_and_owner(dd);"
    },
    {
        "line": 191,
        "fullcodeline": "dd_close(dd);"
    },
    {
        "line": 205,
        "fullcodeline": "child_pid = spawn_event_handler_child("
    },
    {
        "line": 211,
        "fullcodeline": "xmove_fd(fd, child_stdout_fd);"
    },
    {
        "line": 212,
        "fullcodeline": "child_is_post_create = 0;"
    },
    {
        "line": 213,
        "fullcodeline": "strbuf_clear(cmd_output);"
    },
    {
        "line": 214,
        "fullcodeline": "free(dup_of_dir);"
    },
    {
        "line": 215,
        "fullcodeline": "dup_of_dir = NULL;"
    },
    {
        "line": 219,
        "fullcodeline": "log_warning(\"Deleting problem directory '%s'\", dirname);"
    },
    {
        "line": 220,
        "fullcodeline": "delete_dump_dir(dirname);"
    },
    {
        "line": 223,
        "fullcodeline": "strbuf_free(cmd_output);"
    },
    {
        "line": 224,
        "fullcodeline": "free(dup_of_dir);"
    },
    {
        "line": 225,
        "fullcodeline": "close(child_stdout_fd);"
    },
    {
        "line": 4,
        "fullcodeline": "if (!dir_is_in_dump_location(dirname))"
    },
    {
        "line": 103,
        "fullcodeline": "if (safe_waitpid(child_pid, &status, 0) <= 0)"
    },
    {
        "line": 108,
        "fullcodeline": "if (!child_is_post_create)"
    },
    {
        "line": 113,
        "fullcodeline": "if (status != 0)"
    },
    {
        "line": 134,
        "fullcodeline": "if (!dd)"
    },
    {
        "line": 145,
        "fullcodeline": "if ((status != 0 && dup_of_dir) || count == 0)"
    },
    {
        "line": 193,
        "fullcodeline": "if (!dup_of_dir)"
    },
    {
        "line": 7,
        "fullcodeline": "error_msg(\"Bad problem directory name '%s', should start with: '%s'\", dirname, g_settings_dump_location);"
    },
    {
        "line": 19,
        "fullcodeline": "struct group *gr = getgrnam(\"abrt\");"
    },
    {
        "line": 30,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(dirname, DD_OPEN_READONLY);"
    },
    {
        "line": 31,
        "fullcodeline": "const bool complete = dd && problem_dump_dir_is_complete(dd);"
    },
    {
        "line": 32,
        "fullcodeline": "dd_close(dd);"
    },
    {
        "line": 64,
        "fullcodeline": "char buf[250]; /* usually we get one line, no need to have big buf */"
    },
    {
        "line": 65,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 66,
        "fullcodeline": "int r = safe_read(child_stdout_fd, buf, sizeof(buf) - 1);"
    },
    {
        "line": 69,
        "fullcodeline": "buf[r] = '\\0';"
    },
    {
        "line": 72,
        "fullcodeline": "char *raw = buf;"
    },
    {
        "line": 96,
        "fullcodeline": "strbuf_append_str(cmd_output, raw);"
    },
    {
        "line": 105,
        "fullcodeline": "perror_msg(\"waitpid(%d)\", child_pid);"
    },
    {
        "line": 147,
        "fullcodeline": "count++;"
    },
    {
        "line": 148,
        "fullcodeline": "char new_count_str[sizeof(long)*3 + 2];"
    },
    {
        "line": 149,
        "fullcodeline": "sprintf(new_count_str, \"%lu\", count);"
    },
    {
        "line": 150,
        "fullcodeline": "dd_save_text(dd, FILENAME_COUNT, new_count_str);"
    },
    {
        "line": 194,
        "fullcodeline": "log_notice(\"New problem directory %s, processing\", work_dir);"
    },
    {
        "line": 207,
        "fullcodeline": "(dup_of_dir ? \"notify-dup\" : \"notify\"),"
    },
    {
        "line": 13,
        "fullcodeline": "if (lstat(dirname, &statbuf) != 0 || !S_ISDIR(statbuf.st_mode))"
    },
    {
        "line": 20,
        "fullcodeline": "if (!gr)"
    },
    {
        "line": 25,
        "fullcodeline": "if (statbuf.st_uid != 0 || !(statbuf.st_gid == 0 || statbuf.st_gid == gr->gr_gid) || statbuf.st_mode & 07)"
    },
    {
        "line": 67,
        "fullcodeline": "if (r <= 0)"
    },
    {
        "line": 74,
        "fullcodeline": "while ((newline = strchr(raw, '\\n')) != NULL)"
    },
    {
        "line": 115,
        "fullcodeline": "if (WIFSIGNALED(status))"
    },
    {
        "line": 122,
        "fullcodeline": "if (!dup_of_dir)"
    },
    {
        "line": 157,
        "fullcodeline": "if (strcmp(dd->dd_dirname, dirname) != 0)"
    },
    {
        "line": 197,
        "fullcodeline": "log_warning(\"Deleting problem directory %s (dup of %s)\","
    },
    {
        "line": 200,
        "fullcodeline": "delete_dump_dir(dirname);"
    },
    {
        "line": 15,
        "fullcodeline": "error_msg(\"Path '%s' isn't directory\", dirname);"
    },
    {
        "line": 22,
        "fullcodeline": "error_msg(\"Group 'abrt' does not exist\");"
    },
    {
        "line": 27,
        "fullcodeline": "error_msg(\"Problem directory '%s' isn't owned by root:abrt or others are not restricted from access\", dirname);"
    },
    {
        "line": 35,
        "fullcodeline": "error_msg(\"Problem directory '%s' has already been processed\", dirname);"
    },
    {
        "line": 39,
        "fullcodeline": "else if (!dump_dir_accessible_by_uid(dirname, client_uid))"
    },
    {
        "line": 76,
        "fullcodeline": "*newline = '\\0';"
    },
    {
        "line": 77,
        "fullcodeline": "strbuf_append_str(cmd_output, raw);"
    },
    {
        "line": 78,
        "fullcodeline": "char *msg = cmd_output->buf;"
    },
    {
        "line": 81,
        "fullcodeline": "log(\"%s\", msg);"
    },
    {
        "line": 90,
        "fullcodeline": "strbuf_clear(cmd_output);"
    },
    {
        "line": 92,
        "fullcodeline": "raw = newline + 1;"
    },
    {
        "line": 117,
        "fullcodeline": "log(\"'post-create' on '%s' killed by signal %d\","
    },
    {
        "line": 124,
        "fullcodeline": "log(\"'post-create' on '%s' exited with %d\","
    },
    {
        "line": 160,
        "fullcodeline": "struct dump_dir *new_dd = dd_opendir(dirname, DD_OPEN_READONLY);"
    },
    {
        "line": 161,
        "fullcodeline": "char *last_ocr = NULL;"
    },
    {
        "line": 182,
        "fullcodeline": "dd_save_text(dd, FILENAME_LAST_OCCURRENCE, last_ocr);"
    },
    {
        "line": 184,
        "fullcodeline": "free(last_ocr);"
    },
    {
        "line": 198,
        "fullcodeline": "strrchr(dirname, '/') + 1,"
    },
    {
        "line": 199,
        "fullcodeline": "strrchr(dup_of_dir, '/') + 1);"
    },
    {
        "line": 46,
        "fullcodeline": "error_msg(\"Problem directory '%s' can't be accessed by user with uid %ld\", dirname, (long)client_uid);"
    },
    {
        "line": 83,
        "fullcodeline": "if (child_is_post_create"
    },
    {
        "line": 118,
        "fullcodeline": "dirname, WTERMSIG(status));"
    },
    {
        "line": 125,
        "fullcodeline": "dirname, WEXITSTATUS(status));"
    },
    {
        "line": 175,
        "fullcodeline": "if (!last_ocr)"
    },
    {
        "line": 41,
        "fullcodeline": "if (errno == ENOTDIR)"
    },
    {
        "line": 84,
        "fullcodeline": "&& prefixcmp(msg, \"DUP_OF_DIR: \") == 0"
    },
    {
        "line": 86,
        "fullcodeline": "free(dup_of_dir);"
    },
    {
        "line": 87,
        "fullcodeline": "dup_of_dir = xstrdup(msg + strlen(\"DUP_OF_DIR: \"));"
    },
    {
        "line": 166,
        "fullcodeline": "last_ocr = dd_load_text_ext(new_dd, FILENAME_TIME,"
    },
    {
        "line": 168,
        "fullcodeline": "dd_close(new_dd);"
    },
    {
        "line": 177,
        "fullcodeline": "log(\"Using current time for the last occurrence file which may be incorrect.\");"
    },
    {
        "line": 178,
        "fullcodeline": "time_t t = time(NULL);"
    },
    {
        "line": 179,
        "fullcodeline": "last_ocr = xasprintf(\"%lu\", (long)t);"
    },
    {
        "line": 43,
        "fullcodeline": "error_msg(\"Path '%s' isn't problem directory\", dirname);"
    },
    {
        "line": 172,
        "fullcodeline": "error_msg(\"Can't read the last occurrence file from the new dump directory.\");"
    },
    {
        "line": 167,
        "fullcodeline": "DD_LOAD_TEXT_RETURN_NULL_ON_FAILURE | DD_FAIL_QUIETLY_ENOENT);"
    }
]