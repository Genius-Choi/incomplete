[
    {
        "line": 38,
        "fullcodeline": "int child_pid = spawn_event_handler_child(dirname, \"post-create\", &child_stdout_fd);"
    },
    {
        "line": 40,
        "fullcodeline": "char *dup_of_dir = NULL;"
    },
    {
        "line": 41,
        "fullcodeline": "struct strbuf *cmd_output = strbuf_new();"
    },
    {
        "line": 43,
        "fullcodeline": "bool child_is_post_create = 1; /* else it is a notify child */"
    },
    {
        "line": 89,
        "fullcodeline": "int status = 0;"
    },
    {
        "line": 117,
        "fullcodeline": "const char *work_dir = (dup_of_dir ? dup_of_dir : dirname);"
    },
    {
        "line": 120,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(work_dir, /*flags:*/ 0);"
    },
    {
        "line": 126,
        "fullcodeline": "char *count_str = dd_load_text_ext(dd, FILENAME_COUNT, DD_FAIL_QUIETLY_ENOENT);"
    },
    {
        "line": 127,
        "fullcodeline": "unsigned long count = strtoul(count_str, NULL, 10);"
    },
    {
        "line": 176,
        "fullcodeline": "dd_sanitize_mode_and_owner(dd);"
    },
    {
        "line": 178,
        "fullcodeline": "dd_close(dd);"
    },
    {
        "line": 192,
        "fullcodeline": "child_pid = spawn_event_handler_child("
    },
    {
        "line": 198,
        "fullcodeline": "xmove_fd(fd, child_stdout_fd);"
    },
    {
        "line": 199,
        "fullcodeline": "child_is_post_create = 0;"
    },
    {
        "line": 200,
        "fullcodeline": "strbuf_clear(cmd_output);"
    },
    {
        "line": 201,
        "fullcodeline": "free(dup_of_dir);"
    },
    {
        "line": 202,
        "fullcodeline": "dup_of_dir = NULL;"
    },
    {
        "line": 206,
        "fullcodeline": "log_warning(\"Deleting problem directory '%s'\", dirname);"
    },
    {
        "line": 207,
        "fullcodeline": "delete_dump_dir(dirname);"
    },
    {
        "line": 210,
        "fullcodeline": "strbuf_free(cmd_output);"
    },
    {
        "line": 211,
        "fullcodeline": "free(dup_of_dir);"
    },
    {
        "line": 212,
        "fullcodeline": "close(child_stdout_fd);"
    },
    {
        "line": 4,
        "fullcodeline": "if (!dir_is_in_dump_location(dirname))"
    },
    {
        "line": 10,
        "fullcodeline": "if (!dir_has_correct_permissions(dirname))"
    },
    {
        "line": 90,
        "fullcodeline": "if (safe_waitpid(child_pid, &status, 0) <= 0)"
    },
    {
        "line": 95,
        "fullcodeline": "if (!child_is_post_create)"
    },
    {
        "line": 100,
        "fullcodeline": "if (status != 0)"
    },
    {
        "line": 121,
        "fullcodeline": "if (!dd)"
    },
    {
        "line": 132,
        "fullcodeline": "if ((status != 0 && dup_of_dir) || count == 0)"
    },
    {
        "line": 180,
        "fullcodeline": "if (!dup_of_dir)"
    },
    {
        "line": 7,
        "fullcodeline": "error_msg(\"Bad problem directory name '%s', should start with: '%s'\", dirname, g_settings_dump_location);"
    },
    {
        "line": 12,
        "fullcodeline": "error_msg(\"Problem directory '%s' isn't owned by root:abrt or others are not restricted from access\", dirname);"
    },
    {
        "line": 17,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(dirname, DD_OPEN_READONLY);"
    },
    {
        "line": 18,
        "fullcodeline": "const bool complete = dd && problem_dump_dir_is_complete(dd);"
    },
    {
        "line": 19,
        "fullcodeline": "dd_close(dd);"
    },
    {
        "line": 51,
        "fullcodeline": "char buf[250]; /* usually we get one line, no need to have big buf */"
    },
    {
        "line": 52,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 53,
        "fullcodeline": "int r = safe_read(child_stdout_fd, buf, sizeof(buf) - 1);"
    },
    {
        "line": 56,
        "fullcodeline": "buf[r] = '\\0';"
    },
    {
        "line": 59,
        "fullcodeline": "char *raw = buf;"
    },
    {
        "line": 83,
        "fullcodeline": "strbuf_append_str(cmd_output, raw);"
    },
    {
        "line": 92,
        "fullcodeline": "perror_msg(\"waitpid(%d)\", child_pid);"
    },
    {
        "line": 134,
        "fullcodeline": "count++;"
    },
    {
        "line": 135,
        "fullcodeline": "char new_count_str[sizeof(long)*3 + 2];"
    },
    {
        "line": 136,
        "fullcodeline": "sprintf(new_count_str, \"%lu\", count);"
    },
    {
        "line": 137,
        "fullcodeline": "dd_save_text(dd, FILENAME_COUNT, new_count_str);"
    },
    {
        "line": 181,
        "fullcodeline": "log_notice(\"New problem directory %s, processing\", work_dir);"
    },
    {
        "line": 194,
        "fullcodeline": "(dup_of_dir ? \"notify-dup\" : \"notify\"),"
    },
    {
        "line": 54,
        "fullcodeline": "if (r <= 0)"
    },
    {
        "line": 61,
        "fullcodeline": "while ((newline = strchr(raw, '\\n')) != NULL)"
    },
    {
        "line": 102,
        "fullcodeline": "if (WIFSIGNALED(status))"
    },
    {
        "line": 109,
        "fullcodeline": "if (!dup_of_dir)"
    },
    {
        "line": 144,
        "fullcodeline": "if (strcmp(dd->dd_dirname, dirname) != 0)"
    },
    {
        "line": 184,
        "fullcodeline": "log_warning(\"Deleting problem directory %s (dup of %s)\","
    },
    {
        "line": 187,
        "fullcodeline": "delete_dump_dir(dirname);"
    },
    {
        "line": 22,
        "fullcodeline": "error_msg(\"Problem directory '%s' has already been processed\", dirname);"
    },
    {
        "line": 26,
        "fullcodeline": "else if (!dump_dir_accessible_by_uid(dirname, client_uid))"
    },
    {
        "line": 63,
        "fullcodeline": "*newline = '\\0';"
    },
    {
        "line": 64,
        "fullcodeline": "strbuf_append_str(cmd_output, raw);"
    },
    {
        "line": 65,
        "fullcodeline": "char *msg = cmd_output->buf;"
    },
    {
        "line": 68,
        "fullcodeline": "log(\"%s\", msg);"
    },
    {
        "line": 77,
        "fullcodeline": "strbuf_clear(cmd_output);"
    },
    {
        "line": 79,
        "fullcodeline": "raw = newline + 1;"
    },
    {
        "line": 104,
        "fullcodeline": "log(\"'post-create' on '%s' killed by signal %d\","
    },
    {
        "line": 111,
        "fullcodeline": "log(\"'post-create' on '%s' exited with %d\","
    },
    {
        "line": 147,
        "fullcodeline": "struct dump_dir *new_dd = dd_opendir(dirname, DD_OPEN_READONLY);"
    },
    {
        "line": 148,
        "fullcodeline": "char *last_ocr = NULL;"
    },
    {
        "line": 169,
        "fullcodeline": "dd_save_text(dd, FILENAME_LAST_OCCURRENCE, last_ocr);"
    },
    {
        "line": 171,
        "fullcodeline": "free(last_ocr);"
    },
    {
        "line": 185,
        "fullcodeline": "strrchr(dirname, '/') + 1,"
    },
    {
        "line": 186,
        "fullcodeline": "strrchr(dup_of_dir, '/') + 1);"
    },
    {
        "line": 33,
        "fullcodeline": "error_msg(\"Problem directory '%s' can't be accessed by user with uid %ld\", dirname, (long)client_uid);"
    },
    {
        "line": 70,
        "fullcodeline": "if (child_is_post_create"
    },
    {
        "line": 105,
        "fullcodeline": "dirname, WTERMSIG(status));"
    },
    {
        "line": 112,
        "fullcodeline": "dirname, WEXITSTATUS(status));"
    },
    {
        "line": 162,
        "fullcodeline": "if (!last_ocr)"
    },
    {
        "line": 28,
        "fullcodeline": "if (errno == ENOTDIR)"
    },
    {
        "line": 71,
        "fullcodeline": "&& prefixcmp(msg, \"DUP_OF_DIR: \") == 0"
    },
    {
        "line": 73,
        "fullcodeline": "free(dup_of_dir);"
    },
    {
        "line": 74,
        "fullcodeline": "dup_of_dir = xstrdup(msg + strlen(\"DUP_OF_DIR: \"));"
    },
    {
        "line": 153,
        "fullcodeline": "last_ocr = dd_load_text_ext(new_dd, FILENAME_TIME,"
    },
    {
        "line": 155,
        "fullcodeline": "dd_close(new_dd);"
    },
    {
        "line": 164,
        "fullcodeline": "log(\"Using current time for the last occurrence file which may be incorrect.\");"
    },
    {
        "line": 165,
        "fullcodeline": "time_t t = time(NULL);"
    },
    {
        "line": 166,
        "fullcodeline": "last_ocr = xasprintf(\"%lu\", (long)t);"
    },
    {
        "line": 30,
        "fullcodeline": "error_msg(\"Path '%s' isn't problem directory\", dirname);"
    },
    {
        "line": 159,
        "fullcodeline": "error_msg(\"Can't read the last occurrence file from the new dump directory.\");"
    },
    {
        "line": 154,
        "fullcodeline": "DD_LOAD_TEXT_RETURN_NULL_ON_FAILURE | DD_FAIL_QUIETLY_ENOENT);"
    }
]