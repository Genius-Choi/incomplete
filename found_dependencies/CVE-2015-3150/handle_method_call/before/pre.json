[
    {
        "line": 10,
        "fullcodeline": "reset_timeout();"
    },
    {
        "line": 15,
        "fullcodeline": "caller_uid = get_caller_uid(connection, invocation, caller);"
    },
    {
        "line": 17,
        "fullcodeline": "log_notice(\"caller_uid:%ld method:'%s'\", (long)caller_uid, method_name);"
    },
    {
        "line": 19,
        "fullcodeline": "if (caller_uid == (uid_t) -1)"
    },
    {
        "line": 22,
        "fullcodeline": "if (g_strcmp0(method_name, \"NewProblem\") == 0)"
    },
    {
        "line": 24,
        "fullcodeline": "char *error = NULL;"
    },
    {
        "line": 25,
        "fullcodeline": "char *problem_id = handle_new_problem(g_variant_get_child_value(parameters, 0), caller_uid, &error);"
    },
    {
        "line": 35,
        "fullcodeline": "response = g_variant_new(\"(s)\", problem_id);"
    },
    {
        "line": 42,
        "fullcodeline": "if (g_strcmp0(method_name, \"GetProblems\") == 0)"
    },
    {
        "line": 44,
        "fullcodeline": "GList *dirs = get_problem_dirs_for_uid(caller_uid, g_settings_dump_location);"
    },
    {
        "line": 45,
        "fullcodeline": "response = variant_from_string_list(dirs);"
    },
    {
        "line": 54,
        "fullcodeline": "if (g_strcmp0(method_name, \"GetAllProblems\") == 0)"
    },
    {
        "line": 67,
        "fullcodeline": "GList * dirs = get_problem_dirs_for_uid(caller_uid, g_settings_dump_location);"
    },
    {
        "line": 68,
        "fullcodeline": "response = variant_from_string_list(dirs);"
    },
    {
        "line": 76,
        "fullcodeline": "if (g_strcmp0(method_name, \"GetForeignProblems\") == 0)"
    },
    {
        "line": 78,
        "fullcodeline": "GList * dirs = get_problem_dirs_not_accessible_by_uid(caller_uid, g_settings_dump_location);"
    },
    {
        "line": 79,
        "fullcodeline": "response = variant_from_string_list(dirs);"
    },
    {
        "line": 86,
        "fullcodeline": "if (g_strcmp0(method_name, \"ChownProblemDir\") == 0)"
    },
    {
        "line": 89,
        "fullcodeline": "g_variant_get(parameters, \"(&s)\", &problem_dir);"
    },
    {
        "line": 90,
        "fullcodeline": "log_notice(\"problem_dir:'%s'\", problem_dir);"
    },
    {
        "line": 98,
        "fullcodeline": "int ddstat = dump_dir_stat_for_uid(problem_dir, caller_uid);"
    },
    {
        "line": 132,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(problem_dir, DD_OPEN_READONLY | DD_FAIL_QUIETLY_EACCES);"
    },
    {
        "line": 139,
        "fullcodeline": "int chown_res = dd_chown(dd, caller_uid);"
    },
    {
        "line": 151,
        "fullcodeline": "if (g_strcmp0(method_name, \"GetInfo\") == 0)"
    },
    {
        "line": 157,
        "fullcodeline": "g_variant_get_child(parameters, 0, \"&s\", &problem_dir);"
    },
    {
        "line": 158,
        "fullcodeline": "log_notice(\"problem_dir:'%s'\", problem_dir);"
    },
    {
        "line": 185,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(problem_dir, DD_OPEN_READONLY | DD_FAIL_QUIETLY_EACCES);"
    },
    {
        "line": 193,
        "fullcodeline": "GVariant *array = g_variant_get_child_value(parameters, 1);"
    },
    {
        "line": 194,
        "fullcodeline": "GList *elements = string_list_from_variant(array);"
    },
    {
        "line": 197,
        "fullcodeline": "GVariantBuilder *builder = NULL;"
    },
    {
        "line": 220,
        "fullcodeline": "GVariant *response = g_variant_new(\"(a{ss})\", builder);"
    },
    {
        "line": 230,
        "fullcodeline": "if (g_strcmp0(method_name, \"SetElement\") == 0)"
    },
    {
        "line": 236,
        "fullcodeline": "g_variant_get(parameters, \"(&s&s&s)\", &problem_id, &element, &value);"
    },
    {
        "line": 250,
        "fullcodeline": "struct dump_dir *dd = open_directory_for_modification_of_element("
    },
    {
        "line": 257,
        "fullcodeline": "const double max_dir_size = g_settings_nMaxCrashReportsSize * (1024 * 1024);"
    },
    {
        "line": 258,
        "fullcodeline": "const long item_size = dd_get_item_size(dd, element);"
    },
    {
        "line": 269,
        "fullcodeline": "const double requested_size = (double)strlen(value) - item_size;"
    },
    {
        "line": 290,
        "fullcodeline": "if (g_strcmp0(method_name, \"DeleteElement\") == 0)"
    },
    {
        "line": 295,
        "fullcodeline": "g_variant_get(parameters, \"(&s&s)\", &problem_id, &element);"
    },
    {
        "line": 297,
        "fullcodeline": "struct dump_dir *dd = open_directory_for_modification_of_element("
    },
    {
        "line": 303,
        "fullcodeline": "const int res = dd_delete_item(dd, element);"
    },
    {
        "line": 322,
        "fullcodeline": "if (g_strcmp0(method_name, \"DeleteProblem\") == 0)"
    },
    {
        "line": 328,
        "fullcodeline": "GVariant *array = g_variant_get_child_value(parameters, 0);"
    },
    {
        "line": 329,
        "fullcodeline": "GList *problem_dirs = string_list_from_variant(array);"
    },
    {
        "line": 368,
        "fullcodeline": "if (g_strcmp0(method_name, \"FindProblemByElementInTimeRange\") == 0)"
    },
    {
        "line": 376,
        "fullcodeline": "g_variant_get_child(parameters, 0, \"&s\", &element);"
    },
    {
        "line": 377,
        "fullcodeline": "g_variant_get_child(parameters, 1, \"&s\", &value);"
    },
    {
        "line": 378,
        "fullcodeline": "g_variant_get_child(parameters, 2, \"x\", &timestamp_from);"
    },
    {
        "line": 379,
        "fullcodeline": "g_variant_get_child(parameters, 3, \"x\", &timestamp_to);"
    },
    {
        "line": 380,
        "fullcodeline": "g_variant_get_child(parameters, 4, \"b\", &all);"
    },
    {
        "line": 385,
        "fullcodeline": "GList *dirs = get_problem_dirs_for_element_in_time(caller_uid, element, value, timestamp_from,"
    },
    {
        "line": 387,
        "fullcodeline": "response = variant_from_string_list(dirs);"
    },
    {
        "line": 394,
        "fullcodeline": "if (g_strcmp0(method_name, \"Quit\") == 0)"
    },
    {
        "line": 397,
        "fullcodeline": "g_main_loop_quit(loop);"
    },
    {
        "line": 26,
        "fullcodeline": "if (!problem_id)"
    },
    {
        "line": 61,
        "fullcodeline": "if (caller_uid != 0)"
    },
    {
        "line": 99,
        "fullcodeline": "if (ddstat < 0)"
    },
    {
        "line": 115,
        "fullcodeline": "if (ddstat & DD_STAT_OWNED_BY_UID)"
    },
    {
        "line": 133,
        "fullcodeline": "if (!dd)"
    },
    {
        "line": 186,
        "fullcodeline": "if (!dd)"
    },
    {
        "line": 198,
        "fullcodeline": "for (GList *l = elements; l; l = l->next)"
    },
    {
        "line": 252,
        "fullcodeline": "if (!dd)"
    },
    {
        "line": 259,
        "fullcodeline": "if (item_size < 0)"
    },
    {
        "line": 299,
        "fullcodeline": "if (!dd)"
    },
    {
        "line": 332,
        "fullcodeline": "for (GList *l = problem_dirs; l; l = l->next)"
    },
    {
        "line": 343,
        "fullcodeline": "for (GList *l = problem_dirs; l; l = l->next)"
    },
    {
        "line": 28,
        "fullcodeline": "g_dbus_method_invocation_return_dbus_error(invocation,"
    },
    {
        "line": 92,
        "fullcodeline": "if (!allowed_problem_dir(problem_dir))"
    },
    {
        "line": 122,
        "fullcodeline": "if ((ddstat & DD_STAT_ACCESSIBLE_BY_UID) == 0 &&"
    },
    {
        "line": 123,
        "fullcodeline": "polkit_check_authorization_dname(caller, \"org.freedesktop.problems.getall\") != PolkitYes)"
    },
    {
        "line": 160,
        "fullcodeline": "if (!allowed_problem_dir(problem_dir))"
    },
    {
        "line": 166,
        "fullcodeline": "if (!dump_dir_accessible_by_uid(problem_dir, caller_uid))"
    },
    {
        "line": 200,
        "fullcodeline": "const char *element_name = (const char*)l->data;"
    },
    {
        "line": 205,
        "fullcodeline": "log_notice(\"element '%s' %s\", element_name, value ? \"fetched\" : \"not found\");"
    },
    {
        "line": 238,
        "fullcodeline": "if (element == NULL || element[0] == '\\0' || strlen(element) > 64)"
    },
    {
        "line": 240,
        "fullcodeline": "log_notice(\"'%s' is not a valid element name of '%s'\", element, problem_id);"
    },
    {
        "line": 241,
        "fullcodeline": "char *error = xasprintf(_(\"'%s' is not a valid element name\"), element);"
    },
    {
        "line": 242,
        "fullcodeline": "g_dbus_method_invocation_return_dbus_error(invocation,"
    },
    {
        "line": 261,
        "fullcodeline": "log_notice(\"Can't get size of '%s/%s'\", problem_id, element);"
    },
    {
        "line": 262,
        "fullcodeline": "char *error = xasprintf(_(\"Can't get size of '%s'\"), element);"
    },
    {
        "line": 271,
        "fullcodeline": "if (requested_size > 0"
    },
    {
        "line": 272,
        "fullcodeline": "&& requested_size > (max_dir_size - get_dirsize(g_settings_dump_location)))"
    },
    {
        "line": 308,
        "fullcodeline": "log_notice(\"Can't delete the element '%s' from the problem directory '%s'\", element, problem_id);"
    },
    {
        "line": 309,
        "fullcodeline": "char *error = xasprintf(_(\"Can't delete the element '%s' from the problem directory '%s'\"), element, problem_id);"
    },
    {
        "line": 310,
        "fullcodeline": "g_dbus_method_invocation_return_dbus_error(invocation,"
    },
    {
        "line": 334,
        "fullcodeline": "const char *dir_name = (const char*)l->data;"
    },
    {
        "line": 335,
        "fullcodeline": "log_notice(\"dir_name:'%s'\", dir_name);"
    },
    {
        "line": 345,
        "fullcodeline": "const char *dir_name = (const char*)l->data;"
    },
    {
        "line": 382,
        "fullcodeline": "if (all && polkit_check_authorization_dname(caller, \"org.freedesktop.problems.getall\") == PolkitYes)"
    },
    {
        "line": 383,
        "fullcodeline": "caller_uid = 0;"
    },
    {
        "line": 128,
        "fullcodeline": "_(\"Not Authorized\"));"
    },
    {
        "line": 143,
        "fullcodeline": "_(\"Chowning directory failed. Check system logs for more details.\"));"
    },
    {
        "line": 201,
        "fullcodeline": "char *value = dd_load_text_ext(dd, element_name, 0"
    },
    {
        "line": 277,
        "fullcodeline": "_(\"No problem space left\"));"
    },
    {
        "line": 281,
        "fullcodeline": "dd_save_text(dd, element, value);"
    },
    {
        "line": 63,
        "fullcodeline": "if (polkit_check_authorization_dname(caller, \"org.freedesktop.problems.getall\") == PolkitYes)"
    },
    {
        "line": 64,
        "fullcodeline": "caller_uid = 0;"
    },
    {
        "line": 103,
        "fullcodeline": "log_notice(\"requested directory does not exist '%s'\", problem_dir);"
    },
    {
        "line": 170,
        "fullcodeline": "log_notice(\"Requested directory does not exist '%s'\", problem_dir);"
    },
    {
        "line": 175,
        "fullcodeline": "if (polkit_check_authorization_dname(caller, \"org.freedesktop.problems.getall\") != PolkitYes)"
    },
    {
        "line": 212,
        "fullcodeline": "g_variant_builder_add(builder, \"{ss}\", element_name, value);"
    },
    {
        "line": 336,
        "fullcodeline": "if (!allowed_problem_dir(dir_name))"
    },
    {
        "line": 346,
        "fullcodeline": "if (!dump_dir_accessible_by_uid(dir_name, caller_uid))"
    },
    {
        "line": 107,
        "fullcodeline": "perror_msg(\"can't get stat of '%s'\", problem_dir);"
    },
    {
        "line": 180,
        "fullcodeline": "_(\"Not Authorized\"));"
    },
    {
        "line": 208,
        "fullcodeline": "if (!builder)"
    },
    {
        "line": 209,
        "fullcodeline": "builder = g_variant_builder_new(G_VARIANT_TYPE_ARRAY);"
    },
    {
        "line": 354,
        "fullcodeline": "if (polkit_check_authorization_dname(caller, \"org.freedesktop.problems.getall\") != PolkitYes)"
    }
]