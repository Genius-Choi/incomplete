[
    {
        "line": 56,
        "fullcodeline": "log_info(\"Locked '%s'\", lock_file);"
    },
    {
        "line": 3,
        "fullcodeline": "while (symlink(pid, lock_file) != 0)"
    },
    {
        "line": 15,
        "fullcodeline": "char pid_buf[sizeof(pid_t)*3 + 4];"
    },
    {
        "line": 16,
        "fullcodeline": "ssize_t r = readlink(lock_file, pid_buf, sizeof(pid_buf) - 1);"
    },
    {
        "line": 29,
        "fullcodeline": "pid_buf[r] = '\\0';"
    },
    {
        "line": 5,
        "fullcodeline": "if (errno != EEXIST)"
    },
    {
        "line": 17,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 31,
        "fullcodeline": "if (strcmp(pid_buf, pid) == 0)"
    },
    {
        "line": 36,
        "fullcodeline": "if (isdigit_str(pid_buf))"
    },
    {
        "line": 48,
        "fullcodeline": "if (unlink(lock_file) != 0 && errno != ENOENT)"
    },
    {
        "line": 25,
        "fullcodeline": "perror_msg(\"Can't read lock file '%s'\", lock_file);"
    },
    {
        "line": 26,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 33,
        "fullcodeline": "log(\"Lock file '%s' is already locked by us\", lock_file);"
    },
    {
        "line": 38,
        "fullcodeline": "char pid_str[sizeof(\"/proc/\") + sizeof(pid_buf)];"
    },
    {
        "line": 39,
        "fullcodeline": "snprintf(pid_str, sizeof(pid_str), \"/proc/%s\", pid_buf);"
    },
    {
        "line": 45,
        "fullcodeline": "log(\"Lock file '%s' was locked by process %s, but it crashed?\", lock_file, pid_buf);"
    },
    {
        "line": 50,
        "fullcodeline": "perror_msg(\"Can't remove stale lock file '%s'\", lock_file);"
    },
    {
        "line": 51,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "if (errno != ENOENT && errno != ENOTDIR && errno != EACCES)"
    },
    {
        "line": 12,
        "fullcodeline": "return -1;"
    },
    {
        "line": 19,
        "fullcodeline": "if (errno == ENOENT)"
    },
    {
        "line": 27,
        "fullcodeline": "return -1;"
    },
    {
        "line": 40,
        "fullcodeline": "if (access(pid_str, F_OK) == 0)"
    },
    {
        "line": 52,
        "fullcodeline": "return -1;"
    },
    {
        "line": 9,
        "fullcodeline": "perror_msg(\"Can't create lock file '%s'\", lock_file);"
    },
    {
        "line": 10,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "usleep(SYMLINK_RETRY_USLEEP); /* avoid CPU eating loop */"
    },
    {
        "line": 42,
        "fullcodeline": "log(\"Lock file '%s' is locked by process %s\", lock_file, pid_buf);"
    }
]