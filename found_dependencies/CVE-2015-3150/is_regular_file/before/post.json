[
    {
        "line": 8,
        "fullcodeline": "char *fullname = xasprintf(\"%s/%s\", dirname, dent->d_name);"
    },
    {
        "line": 10,
        "fullcodeline": "int r = lstat(fullname, &statbuf);"
    },
    {
        "line": 11,
        "fullcodeline": "free(fullname);"
    },
    {
        "line": 3,
        "fullcodeline": "if (dent->d_type == DT_REG)"
    },
    {
        "line": 5,
        "fullcodeline": "if (dent->d_type != DT_UNKNOWN)"
    },
    {
        "line": 13,
        "fullcodeline": "return r == 0 && S_ISREG(statbuf.st_mode);"
    }
]