[
    {
        "line": 6,
        "fullcodeline": "DIR *dp = opendir(path);"
    },
    {
        "line": 14,
        "fullcodeline": "int brk = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "if (!dp)"
    },
    {
        "line": 16,
        "fullcodeline": "while ((dent = readdir(dp)) != NULL)"
    },
    {
        "line": 21,
        "fullcodeline": "char *full_name = concat_path_file(path, dent->d_name);"
    },
    {
        "line": 18,
        "fullcodeline": "if (dot_or_dotdot(dent->d_name))"
    },
    {
        "line": 22,
        "fullcodeline": "if (caller_uid == -1 || dump_dir_accessible_by_uid(full_name, caller_uid))"
    },
    {
        "line": 28,
        "fullcodeline": "int sv_logmode = logmode;"
    },
    {
        "line": 30,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(full_name, DD_OPEN_READONLY | DD_FAIL_QUIETLY_EACCES | DD_DONT_WAIT_FOR_LOCK);"
    },
    {
        "line": 31,
        "fullcodeline": "logmode = sv_logmode;"
    },
    {
        "line": 34,
        "fullcodeline": "brk = callback ? callback(dd, arg) : 0;"
    }
]