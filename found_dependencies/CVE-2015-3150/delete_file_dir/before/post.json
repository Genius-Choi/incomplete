[
    {
        "line": 3,
        "fullcodeline": "DIR *d = opendir(dir);"
    },
    {
        "line": 18,
        "fullcodeline": "bool unlink_lock_file = false;"
    },
    {
        "line": 48,
        "fullcodeline": "closedir(d);"
    },
    {
        "line": 75,
        "fullcodeline": "int r = rmdir(dir);"
    },
    {
        "line": 4,
        "fullcodeline": "if (!d)"
    },
    {
        "line": 20,
        "fullcodeline": "while ((dent = readdir(d)) != NULL)"
    },
    {
        "line": 29,
        "fullcodeline": "char *full_path = concat_path_file(dir, dent->d_name);"
    },
    {
        "line": 46,
        "fullcodeline": "free(full_path);"
    },
    {
        "line": 57,
        "fullcodeline": "char *full_path = concat_path_file(dir, \".lock\");"
    },
    {
        "line": 58,
        "fullcodeline": "xunlink(full_path);"
    },
    {
        "line": 59,
        "fullcodeline": "free(full_path);"
    },
    {
        "line": 61,
        "fullcodeline": "unsigned cnt = RMDIR_FAIL_COUNT;"
    },
    {
        "line": 77,
        "fullcodeline": "perror_msg(\"Can't remove directory '%s'\", dir);"
    },
    {
        "line": 10,
        "fullcodeline": "if (errno == ENOENT || errno == ENOTDIR)"
    },
    {
        "line": 15,
        "fullcodeline": "return -1;"
    },
    {
        "line": 22,
        "fullcodeline": "if (dot_or_dotdot(dent->d_name))"
    },
    {
        "line": 24,
        "fullcodeline": "if (skip_lock_file && strcmp(dent->d_name, \".lock\") == 0)"
    },
    {
        "line": 30,
        "fullcodeline": "if (unlink(full_path) == -1 && errno != ENOENT)"
    },
    {
        "line": 72,
        "fullcodeline": "} while (--cnt != 0);"
    },
    {
        "line": 12,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 26,
        "fullcodeline": "unlink_lock_file = true;"
    },
    {
        "line": 32,
        "fullcodeline": "int err = 0;"
    },
    {
        "line": 71,
        "fullcodeline": "usleep(RMDIR_FAIL_USLEEP);"
    },
    {
        "line": 33,
        "fullcodeline": "if (errno == EISDIR)"
    },
    {
        "line": 38,
        "fullcodeline": "if (errno || err)"
    },
    {
        "line": 63,
        "fullcodeline": "if (rmdir(dir) == 0)"
    },
    {
        "line": 35,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 36,
        "fullcodeline": "err = delete_file_dir(full_path, /*skip_lock_file:*/ false);"
    },
    {
        "line": 40,
        "fullcodeline": "perror_msg(\"Can't remove '%s'\", full_path);"
    },
    {
        "line": 41,
        "fullcodeline": "free(full_path);"
    },
    {
        "line": 42,
        "fullcodeline": "closedir(d);"
    },
    {
        "line": 43,
        "fullcodeline": "return -1;"
    }
]