[
    {
        "line": 3,
        "fullcodeline": "static char reopen_buf[sizeof(\"/proc/self/fd/\") + 3*sizeof(int) + 1];"
    },
    {
        "line": 5,
        "fullcodeline": "int path_fd = openat(dir_fd, pathname, O_PATH | O_NOFOLLOW);"
    },
    {
        "line": 10,
        "fullcodeline": "int r = fstat(path_fd, &path_sb);"
    },
    {
        "line": 31,
        "fullcodeline": "const int fd = open(reopen_buf, O_RDONLY);"
    },
    {
        "line": 6,
        "fullcodeline": "if (path_fd < 0)"
    },
    {
        "line": 18,
        "fullcodeline": "if (!S_ISREG(path_sb.st_mode) || path_sb.st_nlink > 1)"
    },
    {
        "line": 21,
        "fullcodeline": "errno = EINVAL;"
    },
    {
        "line": 26,
        "fullcodeline": "if (snprintf(reopen_buf, sizeof(reopen_buf), \"/proc/self/fd/%d\", path_fd) >= sizeof(reopen_buf)) {"
    },
    {
        "line": 7,
        "fullcodeline": "return -1;"
    },
    {
        "line": 15,
        "fullcodeline": "return -1;"
    },
    {
        "line": 23,
        "fullcodeline": "return -1;"
    }
]