[
    {
        "line": 3,
        "fullcodeline": "static char reopen_buf[sizeof(\"/proc/self/fd/\") + 3*sizeof(int) + 1];"
    },
    {
        "line": 5,
        "fullcodeline": "int path_fd = openat(dir_fd, pathname, O_PATH | O_NOFOLLOW);"
    },
    {
        "line": 10,
        "fullcodeline": "int r = fstat(path_fd, &path_sb);"
    },
    {
        "line": 31,
        "fullcodeline": "const int fd = open(reopen_buf, O_RDONLY);"
    },
    {
        "line": 32,
        "fullcodeline": "close(path_fd);"
    },
    {
        "line": 6,
        "fullcodeline": "if (path_fd < 0)"
    },
    {
        "line": 11,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 18,
        "fullcodeline": "if (!S_ISREG(path_sb.st_mode) || path_sb.st_nlink > 1)"
    },
    {
        "line": 26,
        "fullcodeline": "if (snprintf(reopen_buf, sizeof(reopen_buf), \"/proc/self/fd/%d\", path_fd) >= sizeof(reopen_buf)) {"
    },
    {
        "line": 13,
        "fullcodeline": "perror_msg(\"stat\");"
    },
    {
        "line": 14,
        "fullcodeline": "close(path_fd);"
    },
    {
        "line": 20,
        "fullcodeline": "log_notice(\"Path isn't a regular file or has more links (%lu)\", path_sb.st_nlink);"
    },
    {
        "line": 21,
        "fullcodeline": "errno = EINVAL;"
    },
    {
        "line": 22,
        "fullcodeline": "close(path_fd);"
    },
    {
        "line": 27,
        "fullcodeline": "error_msg(\"BUG: too long path to a file descriptor\");"
    },
    {
        "line": 28,
        "fullcodeline": "abort();"
    },
    {
        "line": 7,
        "fullcodeline": "return -1;"
    },
    {
        "line": 15,
        "fullcodeline": "return -1;"
    },
    {
        "line": 23,
        "fullcodeline": "return -1;"
    }
]