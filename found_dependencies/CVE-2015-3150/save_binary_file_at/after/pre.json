[
    {
        "line": 3,
        "fullcodeline": "assert(name[0] != '/');"
    },
    {
        "line": 6,
        "fullcodeline": "unlinkat(dir_fd, name, /*remove only files*/0);"
    },
    {
        "line": 7,
        "fullcodeline": "int fd = openat(dir_fd, name, O_WRONLY | O_EXCL | O_CREAT | O_NOFOLLOW, mode);"
    },
    {
        "line": 37,
        "fullcodeline": "unsigned r = full_write(fd, data, size);"
    },
    {
        "line": 8,
        "fullcodeline": "if (fd < 0)"
    },
    {
        "line": 14,
        "fullcodeline": "if (uid != (uid_t)-1L)"
    },
    {
        "line": 10,
        "fullcodeline": "perror_msg(\"Can't open file '%s'\", name);"
    },
    {
        "line": 30,
        "fullcodeline": "if (fchmod(fd, mode) == -1)"
    },
    {
        "line": 16,
        "fullcodeline": "if (fchown(fd, uid, gid) == -1)"
    }
]