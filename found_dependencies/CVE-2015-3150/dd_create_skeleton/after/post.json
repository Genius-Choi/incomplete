[
    {
        "line": 4,
        "fullcodeline": "mode_t dir_mode = mode | ((mode & 0444) >> 2);"
    },
    {
        "line": 5,
        "fullcodeline": "struct dump_dir *dd = dd_init();"
    },
    {
        "line": 7,
        "fullcodeline": "dd->mode = mode;"
    },
    {
        "line": 13,
        "fullcodeline": "dir = dd->dd_dirname = rm_trailing_slashes(dir);"
    },
    {
        "line": 15,
        "fullcodeline": "const char *last_component = strrchr(dir, '/');"
    },
    {
        "line": 45,
        "fullcodeline": "dd->dd_fd = open(dd->dd_dirname, O_DIRECTORY | O_NOFOLLOW);"
    },
    {
        "line": 69,
        "fullcodeline": "dd->dd_uid = (uid_t)-1L;"
    },
    {
        "line": 70,
        "fullcodeline": "dd->dd_gid = (gid_t)-1L;"
    },
    {
        "line": 110,
        "fullcodeline": "dd_close(dd);"
    },
    {
        "line": 20,
        "fullcodeline": "if (dot_or_dotdot(last_component))"
    },
    {
        "line": 34,
        "fullcodeline": "if ((flags & DD_CREATE_PARENTS))"
    },
    {
        "line": 39,
        "fullcodeline": "if (r != 0)"
    },
    {
        "line": 46,
        "fullcodeline": "if (dd->dd_fd < 0)"
    },
    {
        "line": 53,
        "fullcodeline": "if (fstat(dd->dd_fd, &stat_sb) < 0)"
    },
    {
        "line": 59,
        "fullcodeline": "if (dd_lock(dd, CREATE_LOCK_USLEEP, /*flags:*/ 0) < 0)"
    },
    {
        "line": 63,
        "fullcodeline": "if (fchmod(dd->dd_fd, dir_mode) == -1)"
    },
    {
        "line": 71,
        "fullcodeline": "if (uid != (uid_t)-1L)"
    },
    {
        "line": 17,
        "fullcodeline": "last_component++;"
    },
    {
        "line": 25,
        "fullcodeline": "error_msg(\"Bad dir name '%s'\", dir);"
    },
    {
        "line": 35,
        "fullcodeline": "r = g_mkdir_with_parents(dd->dd_dirname, dir_mode);"
    },
    {
        "line": 41,
        "fullcodeline": "perror_msg(\"Can't create directory '%s'\", dir);"
    },
    {
        "line": 48,
        "fullcodeline": "perror_msg(\"Can't open newly created directory '%s'\", dir);"
    },
    {
        "line": 55,
        "fullcodeline": "perror_msg(\"stat(%s)\", dd->dd_dirname);"
    },
    {
        "line": 65,
        "fullcodeline": "perror_msg(\"Can't change mode of '%s'\", dir);"
    },
    {
        "line": 73,
        "fullcodeline": "dd->dd_uid = 0;"
    },
    {
        "line": 74,
        "fullcodeline": "dd->dd_uid = 0;"
    },
    {
        "line": 92,
        "fullcodeline": "struct passwd *pw = getpwnam(\"abrt\");"
    },
    {
        "line": 99,
        "fullcodeline": "pw = getpwuid(uid);"
    },
    {
        "line": 19,
        "fullcodeline": "last_component = dir;"
    },
    {
        "line": 37,
        "fullcodeline": "r = mkdir(dd->dd_dirname, dir_mode);"
    },
    {
        "line": 94,
        "fullcodeline": "dd->dd_uid = pw->pw_uid;"
    },
    {
        "line": 101,
        "fullcodeline": "dd->dd_gid = pw->pw_gid;"
    },
    {
        "line": 96,
        "fullcodeline": "error_msg(\"User 'abrt' does not exist, using uid 0\");"
    },
    {
        "line": 103,
        "fullcodeline": "error_msg(\"User %lu does not exist, using gid 0\", (long)uid);"
    }
]