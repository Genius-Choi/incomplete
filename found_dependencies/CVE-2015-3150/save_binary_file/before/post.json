[
    {
        "line": 4,
        "fullcodeline": "unlink(path);"
    },
    {
        "line": 5,
        "fullcodeline": "int fd = open(path, O_WRONLY | O_TRUNC | O_CREAT | O_NOFOLLOW, mode);"
    },
    {
        "line": 31,
        "fullcodeline": "unsigned r = full_write(fd, data, size);"
    },
    {
        "line": 32,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 6,
        "fullcodeline": "if (fd < 0)"
    },
    {
        "line": 12,
        "fullcodeline": "if (uid != (uid_t)-1L)"
    },
    {
        "line": 26,
        "fullcodeline": "if (fchmod(fd, mode) == -1)"
    },
    {
        "line": 33,
        "fullcodeline": "if (r != size)"
    },
    {
        "line": 8,
        "fullcodeline": "perror_msg(\"Can't open file '%s'\", path);"
    },
    {
        "line": 28,
        "fullcodeline": "perror_msg(\"Can't change mode of '%s'\", path);"
    },
    {
        "line": 35,
        "fullcodeline": "error_msg(\"Can't save file '%s'\", path);"
    },
    {
        "line": 14,
        "fullcodeline": "if (fchown(fd, uid, gid) == -1)"
    },
    {
        "line": 16,
        "fullcodeline": "perror_msg(\"Can't change '%s' ownership to %lu:%lu\", path, (long)uid, (long)gid);"
    }
]