[
    {
        "line": 8,
        "fullcodeline": "int fd = open(name, O_RDONLY);"
    },
    {
        "line": 12,
        "fullcodeline": "off_t size = lseek(fd, 0, SEEK_END);"
    },
    {
        "line": 18,
        "fullcodeline": "lseek(fd, 0, SEEK_SET);"
    },
    {
        "line": 20,
        "fullcodeline": "unsigned char *buf = xmalloc(*sz);"
    },
    {
        "line": 21,
        "fullcodeline": "ssize_t r = full_read(fd, buf, *sz);"
    },
    {
        "line": 33,
        "fullcodeline": "const char *base = strrchr(name, '/');"
    },
    {
        "line": 52,
        "fullcodeline": "const unsigned RATIO = 10;"
    },
    {
        "line": 53,
        "fullcodeline": "unsigned total_chars = r + RATIO;"
    },
    {
        "line": 54,
        "fullcodeline": "unsigned bad_chars = 1; /* 1 prevents division by 0 later */"
    },
    {
        "line": 55,
        "fullcodeline": "bool prev_was_unicode = 0;"
    },
    {
        "line": 56,
        "fullcodeline": "ssize_t i = -1;"
    },
    {
        "line": 9,
        "fullcodeline": "if (fd < 0)"
    },
    {
        "line": 13,
        "fullcodeline": "if (size < 0)"
    },
    {
        "line": 23,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 28,
        "fullcodeline": "if (r < *sz)"
    },
    {
        "line": 91,
        "fullcodeline": "if (size > CD_MAX_TEXT_SIZE)"
    },
    {
        "line": 96,
        "fullcodeline": "return (char*)buf;"
    },
    {
        "line": 29,
        "fullcodeline": "buf[r] = '\\0';"
    },
    {
        "line": 36,
        "fullcodeline": "base++;"
    },
    {
        "line": 57,
        "fullcodeline": "while (++i < r)"
    },
    {
        "line": 81,
        "fullcodeline": "prev_was_unicode = (buf[i] > 0x7f);"
    },
    {
        "line": 84,
        "fullcodeline": "if ((total_chars / bad_chars) >= RATIO)"
    },
    {
        "line": 68,
        "fullcodeline": "if (buf[i] == 0x7f)"
    },
    {
        "line": 37,
        "fullcodeline": "if (is_in_string_list(base, (char**)always_text_files))"
    },
    {
        "line": 60,
        "fullcodeline": "if (buf[i] < ' ' && !isspace(buf[i]))"
    },
    {
        "line": 69,
        "fullcodeline": "bad_chars++;"
    },
    {
        "line": 70,
        "fullcodeline": "else if (buf[i] > 0x7f)"
    },
    {
        "line": 78,
        "fullcodeline": "if (prev_was_unicode == ((buf[i] & 0x40) == 0x40))"
    },
    {
        "line": 79,
        "fullcodeline": "bad_chars++;"
    }
]