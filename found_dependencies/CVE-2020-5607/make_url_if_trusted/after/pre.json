[
    {
        "line": 4,
        "fullcodeline": "ref = URI::decode(ref)"
    },
    {
        "line": 6,
        "fullcodeline": "site_url = URI.parse(@cur_site.full_url)"
    },
    {
        "line": 7,
        "fullcodeline": "full_url = URI.join(site_url, ref) rescue nil"
    },
    {
        "line": 9,
        "fullcodeline": "return unless %w(http https).include?(full_url.scheme)"
    }
]