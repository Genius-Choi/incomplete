[
    {
        "line": 3,
        "fullcodeline": "if (socket()->bytesAvailable() < 4)"
    },
    {
        "line": 13,
        "fullcodeline": "magic = qFromBigEndian<quint32>(magic);"
    },
    {
        "line": 26,
        "fullcodeline": "quint8 features = magic & 0xff;"
    },
    {
        "line": 37,
        "fullcodeline": "while (socket()->bytesAvailable() >= 4) {"
    },
    {
        "line": 40,
        "fullcodeline": "data = qFromBigEndian<quint32>(data);"
    },
    {
        "line": 42,
        "fullcodeline": "Protocol::Type type = static_cast<Protocol::Type>(data & 0xff);"
    },
    {
        "line": 43,
        "fullcodeline": "quint16 protoFeatures = static_cast<quint16>(data>>8 & 0xffff);"
    },
    {
        "line": 44,
        "fullcodeline": "_supportedProtos.append(PeerFactory::ProtoDescriptor(type, protoFeatures));"
    },
    {
        "line": 30,
        "fullcodeline": "if (features & Protocol::Compression)"
    },
    {
        "line": 46,
        "fullcodeline": "if (data >= 0x80000000) { // last protocol"
    },
    {
        "line": 15,
        "fullcodeline": "if ((magic & 0xffffff00) != Protocol::magic) {"
    },
    {
        "line": 19,
        "fullcodeline": "RemotePeer *peer = PeerFactory::createPeer(PeerFactory::ProtoDescriptor(Protocol::LegacyProtocol, 0), this, socket(), Compressor::NoCompression, this);"
    },
    {
        "line": 28,
        "fullcodeline": "if (Core::sslSupported() && (features & Protocol::Encryption))"
    },
    {
        "line": 29,
        "fullcodeline": "_connectionFeatures |= Protocol::Encryption;"
    },
    {
        "line": 31,
        "fullcodeline": "_connectionFeatures |= Protocol::Compression;"
    },
    {
        "line": 53,
        "fullcodeline": "RemotePeer *peer = PeerFactory::createPeer(_supportedProtos, this, socket(), level, this);"
    },
    {
        "line": 58,
        "fullcodeline": "setPeer(peer);"
    },
    {
        "line": 61,
        "fullcodeline": "quint32 reply = peer->protocol() | peer->enabledFeatures()<<8 | _connectionFeatures<<24;"
    },
    {
        "line": 62,
        "fullcodeline": "reply = qToBigEndian<quint32>(reply);"
    },
    {
        "line": 48,
        "fullcodeline": "if (_connectionFeatures & Protocol::Compression)"
    },
    {
        "line": 49,
        "fullcodeline": "level = Compressor::BestCompression;"
    },
    {
        "line": 54,
        "fullcodeline": "if (peer->protocol() == Protocol::LegacyProtocol) {"
    },
    {
        "line": 55,
        "fullcodeline": "_legacy = true;"
    },
    {
        "line": 66,
        "fullcodeline": "if (!_legacy && (_connectionFeatures & Protocol::Encryption))"
    },
    {
        "line": 51,
        "fullcodeline": "level = Compressor::NoCompression;"
    }
]