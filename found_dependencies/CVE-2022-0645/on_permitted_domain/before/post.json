[
    {
        "line": 2,
        "fullcodeline": "permitted_domains = [\"127.0.0.1\", \"localhost\"]"
    },
    {
        "line": 9,
        "fullcodeline": "origin = parse_domain(request.headers.get(\"Origin\"))"
    },
    {
        "line": 10,
        "fullcodeline": "referer = parse_domain(request.headers.get(\"Referer\"))"
    },
    {
        "line": 4,
        "fullcodeline": "for url in team.app_urls:"
    },
    {
        "line": 11,
        "fullcodeline": "for permitted_domain in permitted_domains:"
    },
    {
        "line": 5,
        "fullcodeline": "hostname = parse_domain(url)"
    },
    {
        "line": 12,
        "fullcodeline": "if \"*\" in permitted_domain:"
    },
    {
        "line": 7,
        "fullcodeline": "permitted_domains.append(hostname)"
    },
    {
        "line": 13,
        "fullcodeline": "pattern = \"^{}$\".format(permitted_domain.replace(\".\", \"\\\\.\").replace(\"*\", \"(.*)\"))"
    },
    {
        "line": 14,
        "fullcodeline": "if (origin and re.search(pattern, origin)) or (referer and re.search(pattern, referer)):"
    },
    {
        "line": 17,
        "fullcodeline": "if permitted_domain == origin or permitted_domain == referer:"
    }
]