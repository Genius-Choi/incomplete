[
    {
        "line": 7,
        "fullcodeline": "referer_url = urlparse(request.META[\"HTTP_REFERER\"])"
    },
    {
        "line": 8,
        "fullcodeline": "redirect_url = urlparse(request.GET[\"redirect\"])"
    },
    {
        "line": 2,
        "fullcodeline": "if not request.GET.get(\"redirect\"):"
    },
    {
        "line": 4,
        "fullcodeline": "if not request.META.get(\"HTTP_REFERER\"):"
    },
    {
        "line": 10,
        "fullcodeline": "if referer_url.hostname != redirect_url.hostname:"
    },
    {
        "line": 13,
        "fullcodeline": "if referer_url.scheme != redirect_url.scheme:"
    },
    {
        "line": 16,
        "fullcodeline": "if referer_url.port != redirect_url.port:"
    },
    {
        "line": 21,
        "fullcodeline": "return render_template("
    },
    {
        "line": 3,
        "fullcodeline": "return HttpResponse(\"You need to pass a url to ?redirect=\", status=401)"
    },
    {
        "line": 5,
        "fullcodeline": "return HttpResponse('You need to make a request that includes the \"Referer\" header.', status=400)"
    },
    {
        "line": 11,
        "fullcodeline": "return HttpResponse(f\"Can only redirect to the same domain as the referer: {referer_url.hostname}\", status=400)"
    },
    {
        "line": 14,
        "fullcodeline": "return HttpResponse(f\"Can only redirect to the same scheme as the referer: {referer_url.scheme}\", status=400)"
    },
    {
        "line": 17,
        "fullcodeline": "return HttpResponse("
    },
    {
        "line": 24,
        "fullcodeline": "context={\"domain\": redirect_url.hostname, \"redirect_url\": request.GET[\"redirect\"]},"
    },
    {
        "line": 18,
        "fullcodeline": "f\"Can only redirect to the same port as the referer: {referer_url.port or 'no port in URL'}\", status=400"
    }
]