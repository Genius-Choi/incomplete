[
    {
        "line": 2,
        "fullcodeline": "filename = determine_filename(attachment)"
    },
    {
        "line": 5,
        "fullcodeline": "name = File.basename(filename, File.extname(filename))"
    },
    {
        "line": 1,
        "fullcodeline": "def truncated_file_name_for(attachment, max_length = 31)"
    },
    {
        "line": 3,
        "fullcodeline": "return decidim_html_escape(filename).html_safe if filename.length <= max_length"
    },
    {
        "line": 6,
        "fullcodeline": "decidim_html_escape(name.truncate(max_length, omission: \"...#{name.last((max_length / 2) - 3)}#{File.extname(filename)}\")).html_safe"
    }
]