[
    {
        "line": 7,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 9,
        "fullcodeline": "ctx = SSL_CTX_new(SSLv23_client_method());"
    },
    {
        "line": 30,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 55,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 56,
        "fullcodeline": "X509_VERIFY_PARAM *x509_param = X509_VERIFY_PARAM_new();"
    },
    {
        "line": 65,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 74,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 83,
        "fullcodeline": "X509_VERIFY_PARAM_free(x509_param);     // try not freeing this as SSL_CTX_free seems to be ring to free it"
    },
    {
        "line": 86,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 87,
        "fullcodeline": "ssl = SSL_new(ctx);"
    },
    {
        "line": 88,
        "fullcodeline": "SSL_set_options(ssl, SSL_OP_ALL);"
    },
    {
        "line": 89,
        "fullcodeline": "SSL_set_mode(ssl, SSL_MODE_AUTO_RETRY);"
    },
    {
        "line": 93,
        "fullcodeline": "SSL_set_fd(ssl, this->getFD());"
    },
    {
        "line": 94,
        "fullcodeline": "SSL_set_tlsext_host_name(ssl, hostname.c_str());"
    },
    {
        "line": 103,
        "fullcodeline": "ERR_clear_error();"
    },
    {
        "line": 104,
        "fullcodeline": "int rc = SSL_connect(ssl);"
    },
    {
        "line": 119,
        "fullcodeline": "isssl = true;"
    },
    {
        "line": 120,
        "fullcodeline": "issslserver = false;"
    },
    {
        "line": 14,
        "fullcodeline": "if (ctx == NULL) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (SSL_CTX_set_timeout(ctx, 130l) < 1) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (certificate_path.length()) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (!x509_param) {"
    },
    {
        "line": 66,
        "fullcodeline": "if (!X509_VERIFY_PARAM_set_flags(x509_param, X509_V_FLAG_TRUSTED_FIRST)) {"
    },
    {
        "line": 75,
        "fullcodeline": "if (!SSL_CTX_set1_param(ctx, x509_param)) {"
    },
    {
        "line": 105,
        "fullcodeline": "if (rc < 0) {"
    },
    {
        "line": 4,
        "fullcodeline": "stopSsl();"
    },
    {
        "line": 18,
        "fullcodeline": "log_ssl_errors(\"Error ssl context is null for %s\", hostname.c_str());"
    },
    {
        "line": 25,
        "fullcodeline": "ctx = NULL;"
    },
    {
        "line": 58,
        "fullcodeline": "log_ssl_errors(\"couldnt add validation params for %s\", hostname.c_str());"
    },
    {
        "line": 61,
        "fullcodeline": "ctx = NULL;"
    },
    {
        "line": 67,
        "fullcodeline": "log_ssl_errors(\"couldnt add validation params for %s\", hostname.c_str());"
    },
    {
        "line": 68,
        "fullcodeline": "X509_VERIFY_PARAM_free(x509_param);"
    },
    {
        "line": 70,
        "fullcodeline": "ctx = NULL;"
    },
    {
        "line": 76,
        "fullcodeline": "log_ssl_errors(\"couldnt add validation params for %s\", hostname.c_str());"
    },
    {
        "line": 77,
        "fullcodeline": "X509_VERIFY_PARAM_free(x509_param);"
    },
    {
        "line": 79,
        "fullcodeline": "ctx = NULL;"
    },
    {
        "line": 106,
        "fullcodeline": "log_ssl_errors(\"ssl_connect failed to %s\", hostname.c_str());"
    },
    {
        "line": 111,
        "fullcodeline": "SSL_free(ssl);"
    },
    {
        "line": 112,
        "fullcodeline": "ssl = NULL;"
    },
    {
        "line": 114,
        "fullcodeline": "ctx = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "return -1;"
    },
    {
        "line": 26,
        "fullcodeline": "return -1;"
    },
    {
        "line": 32,
        "fullcodeline": "if (!SSL_CTX_load_verify_locations(ctx, NULL, certificate_path.c_str())) {"
    },
    {
        "line": 62,
        "fullcodeline": "return -2;"
    },
    {
        "line": 71,
        "fullcodeline": "return -2;"
    },
    {
        "line": 80,
        "fullcodeline": "return -2;"
    },
    {
        "line": 115,
        "fullcodeline": "return -3;"
    },
    {
        "line": 36,
        "fullcodeline": "log_ssl_errors(\"couldnt load certificates from %s\", certificate_path.c_str());"
    },
    {
        "line": 39,
        "fullcodeline": "ctx = NULL;"
    },
    {
        "line": 42,
        "fullcodeline": "} else if (!SSL_CTX_set_default_verify_paths(ctx)) //use default if no certPpath given"
    },
    {
        "line": 40,
        "fullcodeline": "return -2;"
    },
    {
        "line": 47,
        "fullcodeline": "log_ssl_errors(\"couldnt load default certificates for %s\", hostname.c_str());"
    },
    {
        "line": 50,
        "fullcodeline": "ctx = NULL;"
    },
    {
        "line": 51,
        "fullcodeline": "return -2;"
    }
]