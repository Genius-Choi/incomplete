[
    {
        "line": 2,
        "fullcodeline": "secdir = config.WORK_DIR + \"/secure\""
    },
    {
        "line": 4,
        "fullcodeline": "if not config.MOUNT_SECURE:"
    },
    {
        "line": 5,
        "fullcodeline": "secdir = config.WORK_DIR + \"/tmpfs-dev\""
    },
    {
        "line": 10,
        "fullcodeline": "if not check_mounted(secdir):"
    },
    {
        "line": 14,
        "fullcodeline": "config.chownroot(secdir, logger)"
    },
    {
        "line": 15,
        "fullcodeline": "size = config.get('cloud_agent', 'secure_size')"
    },
    {
        "line": 17,
        "fullcodeline": "cmd = ('mount', '-t', 'tmpfs', '-o', 'size=%s,mode=0700' % size,"
    },
    {
        "line": 6,
        "fullcodeline": "if not os.path.isdir(secdir):"
    },
    {
        "line": 16,
        "fullcodeline": "logger.info(\"mounting secure storage location %s on tmpfs\" % secdir)"
    },
    {
        "line": 7,
        "fullcodeline": "os.makedirs(secdir)"
    },
    {
        "line": 13,
        "fullcodeline": "os.makedirs(secdir, 0o700)"
    },
    {
        "line": 12,
        "fullcodeline": "if not os.path.exists(secdir):"
    }
]