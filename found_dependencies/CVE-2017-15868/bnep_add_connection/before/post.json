[
    {
        "line": 5,
        "fullcodeline": "u8 dst[ETH_ALEN], src[ETH_ALEN];"
    },
    {
        "line": 8,
        "fullcodeline": "BT_DBG(\"\");"
    },
    {
        "line": 10,
        "fullcodeline": "baswap((void *) dst, &l2cap_pi(sock->sk)->chan->dst);"
    },
    {
        "line": 11,
        "fullcodeline": "baswap((void *) src, &l2cap_pi(sock->sk)->chan->src);"
    },
    {
        "line": 14,
        "fullcodeline": "dev = alloc_netdev(sizeof(struct bnep_session),"
    },
    {
        "line": 21,
        "fullcodeline": "down_write(&bnep_session_sem);"
    },
    {
        "line": 23,
        "fullcodeline": "ss = __bnep_get_session(dst);"
    },
    {
        "line": 29,
        "fullcodeline": "s = netdev_priv(dev);"
    },
    {
        "line": 33,
        "fullcodeline": "memcpy(s->eh.h_dest,   &src, ETH_ALEN);"
    },
    {
        "line": 34,
        "fullcodeline": "memcpy(s->eh.h_source, &dst, ETH_ALEN);"
    },
    {
        "line": 35,
        "fullcodeline": "memcpy(dev->dev_addr, s->eh.h_dest, ETH_ALEN);"
    },
    {
        "line": 37,
        "fullcodeline": "s->dev   = dev;"
    },
    {
        "line": 38,
        "fullcodeline": "s->sock  = sock;"
    },
    {
        "line": 39,
        "fullcodeline": "s->role  = req->role;"
    },
    {
        "line": 40,
        "fullcodeline": "s->state = BT_CONNECTED;"
    },
    {
        "line": 42,
        "fullcodeline": "s->msg.msg_flags = MSG_NOSIGNAL;"
    },
    {
        "line": 54,
        "fullcodeline": "SET_NETDEV_DEV(dev, bnep_get_device(s));"
    },
    {
        "line": 55,
        "fullcodeline": "SET_NETDEV_DEVTYPE(dev, &bnep_type);"
    },
    {
        "line": 57,
        "fullcodeline": "err = register_netdev(dev);"
    },
    {
        "line": 61,
        "fullcodeline": "__bnep_link_session(s);"
    },
    {
        "line": 63,
        "fullcodeline": "__module_get(THIS_MODULE);"
    },
    {
        "line": 64,
        "fullcodeline": "s->task = kthread_run(bnep_session, s, \"kbnepd %s\", dev->name);"
    },
    {
        "line": 74,
        "fullcodeline": "up_write(&bnep_session_sem);"
    },
    {
        "line": 75,
        "fullcodeline": "strcpy(req->device, dev->name);"
    },
    {
        "line": 79,
        "fullcodeline": "up_write(&bnep_session_sem);"
    },
    {
        "line": 80,
        "fullcodeline": "free_netdev(dev);"
    },
    {
        "line": 18,
        "fullcodeline": "if (!dev)"
    },
    {
        "line": 24,
        "fullcodeline": "if (ss && ss->state == BT_CONNECTED) {"
    },
    {
        "line": 65,
        "fullcodeline": "if (IS_ERR(s->task)) {"
    },
    {
        "line": 15,
        "fullcodeline": "(*req->device) ? req->device : \"bnep%d\","
    },
    {
        "line": 25,
        "fullcodeline": "err = -EEXIST;"
    },
    {
        "line": 67,
        "fullcodeline": "module_put(THIS_MODULE);"
    },
    {
        "line": 68,
        "fullcodeline": "unregister_netdev(dev);"
    },
    {
        "line": 69,
        "fullcodeline": "__bnep_unlink_session(s);"
    },
    {
        "line": 70,
        "fullcodeline": "err = PTR_ERR(s->task);"
    },
    {
        "line": 19,
        "fullcodeline": "return -ENOMEM;"
    }
]