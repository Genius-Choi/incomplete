[
    {
        "line": 4,
        "fullcodeline": "session['omniauth.params'] = request.GET"
    },
    {
        "line": 12,
        "fullcodeline": "redirect(callback_url)"
    },
    {
        "line": 5,
        "fullcodeline": "OmniAuth.config.before_request_phase.call(env) if OmniAuth.config.before_request_phase"
    },
    {
        "line": 7,
        "fullcodeline": "@env['rack.session']['omniauth.origin'] = request.params['origin']"
    },
    {
        "line": 8,
        "fullcodeline": "elsif env['HTTP_REFERER'] && !env['HTTP_REFERER'].match(/#{request_path}$/)"
    },
    {
        "line": 9,
        "fullcodeline": "@env['rack.session']['omniauth.origin'] = env['HTTP_REFERER']"
    }
]