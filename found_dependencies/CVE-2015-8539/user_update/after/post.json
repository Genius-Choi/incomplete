[
    {
        "line": 4,
        "fullcodeline": "size_t datalen = prep->datalen;"
    },
    {
        "line": 7,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 12,
        "fullcodeline": "ret = -ENOMEM;"
    },
    {
        "line": 13,
        "fullcodeline": "upayload = kmalloc(sizeof(*upayload) + datalen, GFP_KERNEL);"
    },
    {
        "line": 17,
        "fullcodeline": "upayload->datalen = datalen;"
    },
    {
        "line": 18,
        "fullcodeline": "memcpy(upayload->data, prep->data, datalen);"
    },
    {
        "line": 21,
        "fullcodeline": "zap = upayload;"
    },
    {
        "line": 23,
        "fullcodeline": "ret = key_payload_reserve(key, datalen);"
    },
    {
        "line": 8,
        "fullcodeline": "if (datalen <= 0 || datalen > 32767 || !prep->data)"
    },
    {
        "line": 14,
        "fullcodeline": "if (!upayload)"
    },
    {
        "line": 25,
        "fullcodeline": "if (ret == 0) {"
    },
    {
        "line": 31,
        "fullcodeline": "rcu_assign_keypointer(key, upayload);"
    },
    {
        "line": 32,
        "fullcodeline": "key->expiry = 0;"
    },
    {
        "line": 36,
        "fullcodeline": "kfree_rcu(zap, rcu);"
    },
    {
        "line": 27,
        "fullcodeline": "if (!test_bit(KEY_FLAG_NEGATIVE, &key->flags))"
    },
    {
        "line": 30,
        "fullcodeline": "zap = NULL;"
    }
]