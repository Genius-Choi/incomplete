[
    {
        "line": 2,
        "fullcodeline": "domain = key_id.start_with?('acct:') ? key_id.split('@').last : key_id"
    },
    {
        "line": 4,
        "fullcodeline": "if domain_not_allowed?(domain)"
    },
    {
        "line": 9,
        "fullcodeline": "if key_id.start_with?('acct:')"
    },
    {
        "line": 5,
        "fullcodeline": "@signature_verification_failure_code = 403"
    },
    {
        "line": 10,
        "fullcodeline": "stoplight_wrap_request { ResolveAccountService.new.call(key_id.delete_prefix('acct:'), suppress_errors: false) }"
    },
    {
        "line": 11,
        "fullcodeline": "elsif !ActivityPub::TagManager.instance.local_uri?(key_id)"
    },
    {
        "line": 12,
        "fullcodeline": "account   = ActivityPub::TagManager.instance.uri_to_actor(key_id)"
    },
    {
        "line": 13,
        "fullcodeline": "account ||= stoplight_wrap_request { ActivityPub::FetchRemoteKeyService.new.call(key_id, suppress_errors: false) }"
    }
]