[
    {
        "line": 10,
        "fullcodeline": "creator = ActivityPub::TagManager.instance.uri_to_actor(creator_uri)"
    },
    {
        "line": 15,
        "fullcodeline": "options_hash   = hash(@json['signature'].without('type', 'id', 'signatureValue').merge('@context' => CONTEXT))"
    },
    {
        "line": 16,
        "fullcodeline": "document_hash  = hash(@json.without('signature'))"
    },
    {
        "line": 17,
        "fullcodeline": "to_be_verified = options_hash + document_hash"
    },
    {
        "line": 2,
        "fullcodeline": "return unless @json['signature'].is_a?(Hash)"
    },
    {
        "line": 8,
        "fullcodeline": "return unless type == 'RsaSignature2017'"
    },
    {
        "line": 19,
        "fullcodeline": "creator if creator.keypair.public_key.verify(OpenSSL::Digest.new('SHA256'), Base64.decode64(signature), to_be_verified)"
    },
    {
        "line": 11,
        "fullcodeline": "creator = ActivityPub::FetchRemoteKeyService.new.call(creator_uri, id: false) if creator&.public_key.blank?"
    }
]