[
    {
        "line": 8,
        "fullcodeline": "webhook = body.get(\"webhook\")"
    },
    {
        "line": 12,
        "fullcodeline": "message = {\"text\": \"_Greetings_ from PostHog!\"}"
    },
    {
        "line": 10,
        "fullcodeline": "if not webhook:"
    },
    {
        "line": 4,
        "fullcodeline": "body = json.loads(request.body)"
    },
    {
        "line": 16,
        "fullcodeline": "response = requests.post(webhook, verify=False, json=message)"
    },
    {
        "line": 11,
        "fullcodeline": "return JsonResponse({\"error\": \"no webhook URL\"})"
    },
    {
        "line": 14,
        "fullcodeline": "if is_cloud():  # Protect against SSRF"
    },
    {
        "line": 15,
        "fullcodeline": "raise_if_user_provided_url_unsafe(webhook)"
    },
    {
        "line": 6,
        "fullcodeline": "return JsonResponse({\"error\": \"Cannot parse request body\"}, status=400)"
    },
    {
        "line": 19,
        "fullcodeline": "return JsonResponse({\"success\": True})"
    },
    {
        "line": 21,
        "fullcodeline": "return JsonResponse({\"error\": response.text})"
    },
    {
        "line": 23,
        "fullcodeline": "return JsonResponse({\"error\": \"invalid webhook URL\"})"
    }
]