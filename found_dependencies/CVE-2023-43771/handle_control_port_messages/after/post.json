[
    {
        "line": 4,
        "fullcodeline": "if (recv_len != -1) {"
    },
    {
        "line": 5,
        "fullcodeline": "if ((buf != NULL) && (recv_len > 0)) {"
    },
    {
        "line": 140,
        "fullcodeline": "warn(\"Bad packet on the control port.\");"
    },
    {
        "line": 6,
        "fullcodeline": "buf[recv_len - 1] = 0; // we know it's not empty, so make sure there's a null in it."
    },
    {
        "line": 7,
        "fullcodeline": "debug(2, \"New control port message: \\\"%s\\\".\", buf);"
    },
    {
        "line": 9,
        "fullcodeline": "char *ip_list = buf;"
    },
    {
        "line": 10,
        "fullcodeline": "char *smi_name = strsep(&ip_list, \" \");"
    },
    {
        "line": 11,
        "fullcodeline": "char *command = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "if (smi_name != NULL) {"
    },
    {
        "line": 137,
        "fullcodeline": "warn(\"Missing or empty packet on the control port.\");"
    },
    {
        "line": 13,
        "fullcodeline": "if (ip_list != NULL)"
    },
    {
        "line": 23,
        "fullcodeline": "if (command != NULL) {"
    },
    {
        "line": 134,
        "fullcodeline": "warn(\"SMI Interface Name not found on the control port.\");"
    },
    {
        "line": 14,
        "fullcodeline": "command = strsep(&ip_list, \" \");"
    },
    {
        "line": 24,
        "fullcodeline": "if ((strcmp(command, \"B\") == 0) && (ip_list == NULL)) {"
    },
    {
        "line": 25,
        "fullcodeline": "debug(2, \"Play.\");"
    },
    {
        "line": 60,
        "fullcodeline": "clock_is_active = 1;"
    },
    {
        "line": 61,
        "fullcodeline": "clock_validity_expiration_time = 0;"
    },
    {
        "line": 31,
        "fullcodeline": "debug(2, \"clock is already active\");"
    },
    {
        "line": 62,
        "fullcodeline": "} else if ((strcmp(command, \"E\") == 0) && (ip_list == NULL)) {"
    },
    {
        "line": 37,
        "fullcodeline": "int will_ask_for_a_reset = 0;"
    },
    {
        "line": 63,
        "fullcodeline": "debug(2, \"Stop\");"
    },
    {
        "line": 38,
        "fullcodeline": "if (clock_validity_expiration_time == 0) {"
    },
    {
        "line": 55,
        "fullcodeline": "if (will_ask_for_a_reset != 0) {"
    },
    {
        "line": 39,
        "fullcodeline": "debug(1, \"no clock_validity_expiration_time.\");"
    },
    {
        "line": 40,
        "fullcodeline": "will_ask_for_a_reset = 1;"
    },
    {
        "line": 56,
        "fullcodeline": "debug(2, \"Reset clock smoothing\");"
    },
    {
        "line": 57,
        "fullcodeline": "reset_clock_smoothing = 1;"
    },
    {
        "line": 65,
        "fullcodeline": "debug(2, \"reset clock_validity_expiration_time to 2.25 seconds in the future.\");"
    },
    {
        "line": 66,
        "fullcodeline": "clock_validity_expiration_time ="
    },
    {
        "line": 68,
        "fullcodeline": "clock_is_active = 0;"
    },
    {
        "line": 72,
        "fullcodeline": "} else if ((strcmp(command, \"P\") == 0) && (ip_list == NULL)) {"
    },
    {
        "line": 42,
        "fullcodeline": "int64_t time_to_clock_expiration = clock_validity_expiration_time - reception_time;"
    },
    {
        "line": 67,
        "fullcodeline": "reception_time + 2250000000; // expiration time can be very soon after an \"E\""
    },
    {
        "line": 70,
        "fullcodeline": "debug(2, \"clock is already inactive.\");"
    },
    {
        "line": 73,
        "fullcodeline": "debug(2, \"Pause\");"
    },
    {
        "line": 50,
        "fullcodeline": "if (time_to_clock_expiration < 0) {"
    },
    {
        "line": 51,
        "fullcodeline": "debug(2, \"Clock validity may have expired, so ask for a reset.\");"
    },
    {
        "line": 52,
        "fullcodeline": "will_ask_for_a_reset = 1;"
    },
    {
        "line": 76,
        "fullcodeline": "} else if ((command == NULL) || ((strcmp(command, \"T\") == 0) && (ip_list == NULL))) {"
    },
    {
        "line": 77,
        "fullcodeline": "debug(2, \"Stop Timing\");"
    },
    {
        "line": 78,
        "fullcodeline": "clock_is_active = 0;"
    },
    {
        "line": 79,
        "fullcodeline": "debug(2, \"Clear timing peer group.\");"
    },
    {
        "line": 85,
        "fullcodeline": "update_master_clock_info(0, NULL, 0, 0, 0); // the SMI may have obsolete stuff in it"
    },
    {
        "line": 82,
        "fullcodeline": "for (gc = 0; gc < MAX_CLOCKS; gc++) {"
    },
    {
        "line": 87,
        "fullcodeline": "debug(2, \"Start Timing\");"
    },
    {
        "line": 93,
        "fullcodeline": "debug(2, \"get or create new record for \\\"%s\\\".\", smi_name);"
    },
    {
        "line": 83,
        "fullcodeline": "memset(&clock_private_info[gc], 0, sizeof(clock_source_private_data));"
    },
    {
        "line": 90,
        "fullcodeline": "for (gc = 0; gc < MAX_CLOCKS; gc++) {"
    },
    {
        "line": 96,
        "fullcodeline": "if (strcmp(command, \"T\") == 0) {"
    },
    {
        "line": 91,
        "fullcodeline": "memset(&clock_private_info[gc], 0, sizeof(clock_source_private_data));"
    },
    {
        "line": 121,
        "fullcodeline": "debug(2, \"reset clock_validity_expiration_time to 5.0 seconds in the future.\");"
    },
    {
        "line": 122,
        "fullcodeline": "clock_validity_expiration_time ="
    },
    {
        "line": 98,
        "fullcodeline": "for (i = 0; i < MAX_CLOCKS; i++) {"
    },
    {
        "line": 107,
        "fullcodeline": "if (ip_list != NULL) {"
    },
    {
        "line": 123,
        "fullcodeline": "reception_time + 5000000000L; // clock can stop as soon as 6 seconds after a \"T\""
    },
    {
        "line": 125,
        "fullcodeline": "warn(\"Unrecognised string on the control port.\");"
    },
    {
        "line": 99,
        "fullcodeline": "clock_private_info[i].announcements_without_followups ="
    },
    {
        "line": 102,
        "fullcodeline": "clock_private_info[i].follow_up_number = 0;"
    },
    {
        "line": 108,
        "fullcodeline": "char *new_ip = strsep(&ip_list, \" \");"
    },
    {
        "line": 110,
        "fullcodeline": "if ((new_ip != NULL) && (new_ip[0] != 0)) {"
    },
    {
        "line": 111,
        "fullcodeline": "int t = find_clock_source_record(new_ip, clock_private_info);"
    },
    {
        "line": 112,
        "fullcodeline": "if (t == -1)"
    },
    {
        "line": 114,
        "fullcodeline": "if (t != -1) { // if the clock table is not full, okay"
    },
    {
        "line": 113,
        "fullcodeline": "t = create_clock_source_record(new_ip, clock_private_info);"
    },
    {
        "line": 115,
        "fullcodeline": "debug(2, \"Monitor clock at %s.\", new_ip);"
    }
]