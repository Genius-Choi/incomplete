[
    {
        "line": 11,
        "fullcodeline": "char buffer[256];"
    },
    {
        "line": 13,
        "fullcodeline": "client->state = VNC_CLIENT_STATE_ERROR;"
    },
    {
        "line": 15,
        "fullcodeline": "uint32_t* result = (uint32_t*)buffer;"
    },
    {
        "line": 17,
        "fullcodeline": "struct rfb_error_reason* reason ="
    },
    {
        "line": 20,
        "fullcodeline": "*result = htonl(RFB_SECURITY_HANDSHAKE_FAILED);"
    },
    {
        "line": 21,
        "fullcodeline": "reason->length = htonl(strlen(reason_string));"
    },
    {
        "line": 22,
        "fullcodeline": "strcpy(reason->message, reason_string);"
    },
    {
        "line": 24,
        "fullcodeline": "size_t len = sizeof(*result) + sizeof(*reason) + strlen(reason_string);"
    },
    {
        "line": 25,
        "fullcodeline": "stream_write(client->net_stream, buffer, len, close_after_write,"
    },
    {
        "line": 18,
        "fullcodeline": "(struct rfb_error_reason*)(buffer + sizeof(*result));"
    },
    {
        "line": 5,
        "fullcodeline": "nvnc_log(NVNC_LOG_INFO, \"Security handshake failed for \\\"%s\\\": %s\","
    },
    {
        "line": 8,
        "fullcodeline": "nvnc_log(NVNC_LOG_INFO, \"Security handshake: %s\","
    }
]