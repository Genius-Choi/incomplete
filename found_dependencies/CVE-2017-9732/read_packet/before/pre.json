[
    {
        "line": 5,
        "fullcodeline": "static uint32_t\t\tlen = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "static char\t\tlen_buf[4];"
    },
    {
        "line": 7,
        "fullcodeline": "static int\t\tlen_buf_pos = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "static char *\t\ttmpbuf = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "static int\t\ttmpbuf_pos = 0;"
    },
    {
        "line": 49,
        "fullcodeline": "len = ntohl(*(uint32_t *)len_buf);"
    },
    {
        "line": 68,
        "fullcodeline": "ret = timed_read(fd, tmpbuf + tmpbuf_pos, len - tmpbuf_pos, timeout);"
    },
    {
        "line": 82,
        "fullcodeline": "tmpbuf_pos += ret;"
    },
    {
        "line": 16,
        "fullcodeline": "if (len_buf_pos < 4) {"
    },
    {
        "line": 56,
        "fullcodeline": "if (len > GSTD_MAXPACKETCONTENTS + 512) {"
    },
    {
        "line": 61,
        "fullcodeline": "if (!tmpbuf) {"
    },
    {
        "line": 69,
        "fullcodeline": "if (ret == -1) {"
    },
    {
        "line": 77,
        "fullcodeline": "if (ret == 0) {"
    },
    {
        "line": 84,
        "fullcodeline": "if (tmpbuf_pos == len) {"
    },
    {
        "line": 94,
        "fullcodeline": "return -2;"
    },
    {
        "line": 12,
        "fullcodeline": "len_buf_pos = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "ret = timed_read(fd, &len_buf[len_buf_pos], 4 - len_buf_pos,"
    },
    {
        "line": 41,
        "fullcodeline": "len_buf_pos += ret;"
    },
    {
        "line": 85,
        "fullcodeline": "buf->length = len;"
    },
    {
        "line": 90,
        "fullcodeline": "LOG(LOG_DEBUG, (\"read packet of length %d\", buf->length));"
    },
    {
        "line": 13,
        "fullcodeline": "return -2;"
    },
    {
        "line": 20,
        "fullcodeline": "if (ret == -1) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (ret == 0) {\t\t/* EOF */"
    },
    {
        "line": 46,
        "fullcodeline": "return -2;"
    },
    {
        "line": 57,
        "fullcodeline": "LOG(LOG_ERR, (\"ridiculous length, %ld\", len));"
    },
    {
        "line": 58,
        "fullcodeline": "return -1;"
    },
    {
        "line": 62,
        "fullcodeline": "if ((tmpbuf = malloc(len)) == NULL) {"
    },
    {
        "line": 73,
        "fullcodeline": "LOG(LOG_ERR, (\"%s\", strerror(errno)));"
    },
    {
        "line": 74,
        "fullcodeline": "return -1;"
    },
    {
        "line": 78,
        "fullcodeline": "LOG(LOG_ERR, (\"EOF while reading packet (len=%d)\", len));"
    },
    {
        "line": 79,
        "fullcodeline": "return -1;"
    },
    {
        "line": 87,
        "fullcodeline": "len = len_buf_pos = tmpbuf_pos = 0;"
    },
    {
        "line": 37,
        "fullcodeline": "LOG(LOG_INFO, (\"EOF reading packet len\"));"
    },
    {
        "line": 63,
        "fullcodeline": "LOG(LOG_CRIT, (\"malloc failure, %ld bytes\", len));"
    },
    {
        "line": 70,
        "fullcodeline": "if (errno == EINTR || errno == EAGAIN)"
    },
    {
        "line": 24,
        "fullcodeline": "LOG(LOG_ERR, (\"%s\", strerror(errno)));"
    },
    {
        "line": 25,
        "fullcodeline": "return -1;"
    },
    {
        "line": 38,
        "fullcodeline": "return -1;"
    },
    {
        "line": 64,
        "fullcodeline": "return -1;"
    },
    {
        "line": 71,
        "fullcodeline": "return -2;"
    },
    {
        "line": 21,
        "fullcodeline": "if (errno == EINTR || errno == EAGAIN)"
    },
    {
        "line": 22,
        "fullcodeline": "return -2;"
    }
]