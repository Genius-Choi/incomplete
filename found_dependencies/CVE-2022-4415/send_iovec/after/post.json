[
    {
        "line": 2,
        "fullcodeline": "_cleanup_close_ int fd = -EBADF;"
    },
    {
        "line": 5,
        "fullcodeline": "assert(iovw);"
    },
    {
        "line": 6,
        "fullcodeline": "assert(input_fd >= 0);"
    },
    {
        "line": 8,
        "fullcodeline": "fd = socket(AF_UNIX, SOCK_SEQPACKET|SOCK_CLOEXEC, 0);"
    },
    {
        "line": 12,
        "fullcodeline": "r = connect_unix_path(fd, AT_FDCWD, \"/run/systemd/coredump\");"
    },
    {
        "line": 54,
        "fullcodeline": "r = send_one_fd(fd, input_fd, 0);"
    },
    {
        "line": 9,
        "fullcodeline": "if (fd < 0)"
    },
    {
        "line": 13,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 16,
        "fullcodeline": "for (size_t i = 0; i < iovw->count; i++) {"
    },
    {
        "line": 55,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 17,
        "fullcodeline": "struct msghdr mh = {"
    },
    {
        "line": 21,
        "fullcodeline": "struct iovec copy[2];"
    },
    {
        "line": 10,
        "fullcodeline": "return log_error_errno(errno, \"Failed to create coredump socket: %m\");"
    },
    {
        "line": 14,
        "fullcodeline": "return log_error_errno(r, \"Failed to connect to coredump service: %m\");"
    },
    {
        "line": 56,
        "fullcodeline": "return log_error_errno(r, \"Failed to send coredump fd: %m\");"
    },
    {
        "line": 18,
        "fullcodeline": ".msg_iov = iovw->iovec + i,"
    },
    {
        "line": 19,
        "fullcodeline": ".msg_iovlen = 1,"
    },
    {
        "line": 24,
        "fullcodeline": "if (sendmsg(fd, &mh, MSG_NOSIGNAL) >= 0)"
    },
    {
        "line": 27,
        "fullcodeline": "if (errno == EMSGSIZE && mh.msg_iov[0].iov_len > 0) {"
    },
    {
        "line": 50,
        "fullcodeline": "return log_error_errno(errno, \"Failed to send coredump datagram: %m\");"
    },
    {
        "line": 46,
        "fullcodeline": "copy[0].iov_len /= 2; /* halve it, and try again */"
    },
    {
        "line": 33,
        "fullcodeline": "if (mh.msg_iov != copy) {"
    },
    {
        "line": 40,
        "fullcodeline": "copy[1] = IOVEC_MAKE(((char[]){'.', '.', '.'}), 3);"
    },
    {
        "line": 42,
        "fullcodeline": "mh.msg_iov = copy;"
    },
    {
        "line": 43,
        "fullcodeline": "mh.msg_iovlen = 2;"
    }
]