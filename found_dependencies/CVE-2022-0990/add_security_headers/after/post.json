[
    {
        "line": 2,
        "fullcodeline": "csp = \"default-src 'self'\""
    },
    {
        "line": 3,
        "fullcodeline": "csp += ''.join([' ' + host for host in config.config_trustedhosts.strip().split(',')])"
    },
    {
        "line": 4,
        "fullcodeline": "csp += \" 'unsafe-inline' 'unsafe-eval'; font-src 'self' data:; img-src 'self' data:\""
    },
    {
        "line": 5,
        "fullcodeline": "resp.headers['Content-Security-Policy'] = csp"
    },
    {
        "line": 10,
        "fullcodeline": "resp.headers['X-Content-Type-Options'] = 'nosniff'"
    },
    {
        "line": 11,
        "fullcodeline": "resp.headers['X-Frame-Options'] = 'SAMEORIGIN'"
    },
    {
        "line": 12,
        "fullcodeline": "resp.headers['X-XSS-Protection'] = '1; mode=block'"
    },
    {
        "line": 13,
        "fullcodeline": "resp.headers['Strict-Transport-Security'] = 'max-age=31536000;'"
    },
    {
        "line": 6,
        "fullcodeline": "if request.endpoint == \"edit-book.edit_book\" or config.config_use_google_drive:"
    },
    {
        "line": 7,
        "fullcodeline": "resp.headers['Content-Security-Policy'] += \" *\""
    },
    {
        "line": 8,
        "fullcodeline": "elif request.endpoint == \"web.read_book\":"
    },
    {
        "line": 9,
        "fullcodeline": "resp.headers['Content-Security-Policy'] += \" blob:;style-src-elem 'self' blob: 'unsafe-inline';\""
    }
]