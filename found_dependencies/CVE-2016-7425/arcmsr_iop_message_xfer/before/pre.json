[
    {
        "line": 6,
        "fullcodeline": "int retvalue = 0, transfer_len = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "uint32_t controlcode = (uint32_t)cmd->cmnd[5] << 24 |"
    },
    {
        "line": 15,
        "fullcodeline": "use_sg = scsi_sg_count(cmd);"
    },
    {
        "line": 16,
        "fullcodeline": "sg = scsi_sglist(cmd);"
    },
    {
        "line": 17,
        "fullcodeline": "buffer = kmap_atomic(sg_page(sg)) + sg->offset;"
    },
    {
        "line": 22,
        "fullcodeline": "transfer_len += sg->length;"
    },
    {
        "line": 28,
        "fullcodeline": "pcmdmessagefld = (struct CMD_MESSAGE_FIELD *)buffer;"
    },
    {
        "line": 18,
        "fullcodeline": "if (use_sg > 1) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (transfer_len > sizeof(struct CMD_MESSAGE_FIELD)) {"
    },
    {
        "line": 12,
        "fullcodeline": "(uint32_t)cmd->cmnd[8];"
    },
    {
        "line": 19,
        "fullcodeline": "retvalue = ARCMSR_MESSAGE_FAIL;"
    },
    {
        "line": 24,
        "fullcodeline": "retvalue = ARCMSR_MESSAGE_FAIL;"
    },
    {
        "line": 25,
        "fullcodeline": "pr_info(\"%s: ARCMSR_MESSAGE_FAIL!\\n\", __func__);"
    },
    {
        "line": 236,
        "fullcodeline": "retvalue = ARCMSR_MESSAGE_FAIL;"
    },
    {
        "line": 237,
        "fullcodeline": "pr_info(\"%s: unknown controlcode!\\n\", __func__);"
    },
    {
        "line": 241,
        "fullcodeline": "struct scatterlist *sg = scsi_sglist(cmd);"
    },
    {
        "line": 242,
        "fullcodeline": "kunmap_atomic(buffer - sg->offset);"
    },
    {
        "line": 11,
        "fullcodeline": "(uint32_t)cmd->cmnd[7] << 8 |"
    },
    {
        "line": 33,
        "fullcodeline": "uint32_t allxfer_len = 0;"
    },
    {
        "line": 34,
        "fullcodeline": "ver_addr = kmalloc(ARCMSR_API_DATA_BUFLEN, GFP_ATOMIC);"
    },
    {
        "line": 40,
        "fullcodeline": "ptmpQbuffer = ver_addr;"
    },
    {
        "line": 41,
        "fullcodeline": "spin_lock_irqsave(&acb->rqbuffer_lock, flags);"
    },
    {
        "line": 59,
        "fullcodeline": "memcpy(pcmdmessagefld->messagedatabuffer, ver_addr,"
    },
    {
        "line": 68,
        "fullcodeline": "spin_unlock_irqrestore(&acb->rqbuffer_lock, flags);"
    },
    {
        "line": 69,
        "fullcodeline": "kfree(ver_addr);"
    },
    {
        "line": 70,
        "fullcodeline": "pcmdmessagefld->cmdmessage.Length = allxfer_len;"
    },
    {
        "line": 83,
        "fullcodeline": "ver_addr = kmalloc(ARCMSR_API_DATA_BUFLEN, GFP_ATOMIC);"
    },
    {
        "line": 88,
        "fullcodeline": "ptmpuserbuffer = ver_addr;"
    },
    {
        "line": 89,
        "fullcodeline": "user_len = pcmdmessagefld->cmdmessage.Length;"
    },
    {
        "line": 90,
        "fullcodeline": "memcpy(ptmpuserbuffer,"
    },
    {
        "line": 92,
        "fullcodeline": "spin_lock_irqsave(&acb->wqbuffer_lock, flags);"
    },
    {
        "line": 123,
        "fullcodeline": "spin_unlock_irqrestore(&acb->wqbuffer_lock, flags);"
    },
    {
        "line": 124,
        "fullcodeline": "kfree(ver_addr);"
    },
    {
        "line": 134,
        "fullcodeline": "uint8_t *pQbuffer = acb->rqbuffer;"
    },
    {
        "line": 136,
        "fullcodeline": "arcmsr_clear_iop2drv_rqueue_buffer(acb);"
    },
    {
        "line": 137,
        "fullcodeline": "spin_lock_irqsave(&acb->rqbuffer_lock, flags);"
    },
    {
        "line": 138,
        "fullcodeline": "acb->acb_flags |= ACB_F_MESSAGE_RQBUFFER_CLEARED;"
    },
    {
        "line": 139,
        "fullcodeline": "acb->rqbuf_getIndex = 0;"
    },
    {
        "line": 140,
        "fullcodeline": "acb->rqbuf_putIndex = 0;"
    },
    {
        "line": 141,
        "fullcodeline": "memset(pQbuffer, 0, ARCMSR_MAX_QBUFFER);"
    },
    {
        "line": 142,
        "fullcodeline": "spin_unlock_irqrestore(&acb->rqbuffer_lock, flags);"
    },
    {
        "line": 152,
        "fullcodeline": "uint8_t *pQbuffer = acb->wqbuffer;"
    },
    {
        "line": 153,
        "fullcodeline": "spin_lock_irqsave(&acb->wqbuffer_lock, flags);"
    },
    {
        "line": 154,
        "fullcodeline": "acb->acb_flags |= (ACB_F_MESSAGE_WQBUFFER_CLEARED |"
    },
    {
        "line": 156,
        "fullcodeline": "acb->wqbuf_getIndex = 0;"
    },
    {
        "line": 157,
        "fullcodeline": "acb->wqbuf_putIndex = 0;"
    },
    {
        "line": 158,
        "fullcodeline": "memset(pQbuffer, 0, ARCMSR_MAX_QBUFFER);"
    },
    {
        "line": 159,
        "fullcodeline": "spin_unlock_irqrestore(&acb->wqbuffer_lock, flags);"
    },
    {
        "line": 170,
        "fullcodeline": "arcmsr_clear_iop2drv_rqueue_buffer(acb);"
    },
    {
        "line": 171,
        "fullcodeline": "spin_lock_irqsave(&acb->rqbuffer_lock, flags);"
    },
    {
        "line": 172,
        "fullcodeline": "acb->acb_flags |= ACB_F_MESSAGE_RQBUFFER_CLEARED;"
    },
    {
        "line": 173,
        "fullcodeline": "acb->rqbuf_getIndex = 0;"
    },
    {
        "line": 174,
        "fullcodeline": "acb->rqbuf_putIndex = 0;"
    },
    {
        "line": 175,
        "fullcodeline": "pQbuffer = acb->rqbuffer;"
    },
    {
        "line": 177,
        "fullcodeline": "spin_unlock_irqrestore(&acb->rqbuffer_lock, flags);"
    },
    {
        "line": 178,
        "fullcodeline": "spin_lock_irqsave(&acb->wqbuffer_lock, flags);"
    },
    {
        "line": 179,
        "fullcodeline": "acb->acb_flags |= (ACB_F_MESSAGE_WQBUFFER_CLEARED |"
    },
    {
        "line": 181,
        "fullcodeline": "acb->wqbuf_getIndex = 0;"
    },
    {
        "line": 182,
        "fullcodeline": "acb->wqbuf_putIndex = 0;"
    },
    {
        "line": 183,
        "fullcodeline": "pQbuffer = acb->wqbuffer;"
    },
    {
        "line": 184,
        "fullcodeline": "memset(pQbuffer, 0, sizeof(struct QBUFFER));"
    },
    {
        "line": 185,
        "fullcodeline": "spin_unlock_irqrestore(&acb->wqbuffer_lock, flags);"
    },
    {
        "line": 204,
        "fullcodeline": "int8_t *hello_string = \"Hello! I am ARCMSR\";"
    },
    {
        "line": 211,
        "fullcodeline": "memcpy(pcmdmessagefld->messagedatabuffer,"
    },
    {
        "line": 222,
        "fullcodeline": "arcmsr_iop_parking(acb);"
    },
    {
        "line": 232,
        "fullcodeline": "arcmsr_flush_adapter_cache(acb);"
    },
    {
        "line": 10,
        "fullcodeline": "(uint32_t)cmd->cmnd[6] << 16 |"
    },
    {
        "line": 35,
        "fullcodeline": "if (!ver_addr) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (acb->rqbuf_getIndex != acb->rqbuf_putIndex) {"
    },
    {
        "line": 61,
        "fullcodeline": "if (acb->acb_flags & ACB_F_IOPDATA_OVERFLOW) {"
    },
    {
        "line": 71,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 84,
        "fullcodeline": "if (!ver_addr) {"
    },
    {
        "line": 93,
        "fullcodeline": "if (acb->wqbuf_putIndex != acb->wqbuf_getIndex) {"
    },
    {
        "line": 125,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 143,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 160,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 186,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 195,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 205,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 212,
        "fullcodeline": "hello_string, (int16_t)strlen(hello_string));"
    },
    {
        "line": 216,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 226,
        "fullcodeline": "if (acb->fw_flag == FW_DEADLOCK)"
    },
    {
        "line": 36,
        "fullcodeline": "retvalue = ARCMSR_MESSAGE_FAIL;"
    },
    {
        "line": 37,
        "fullcodeline": "pr_info(\"%s: memory not enough!\\n\", __func__);"
    },
    {
        "line": 43,
        "fullcodeline": "unsigned int tail = acb->rqbuf_getIndex;"
    },
    {
        "line": 44,
        "fullcodeline": "unsigned int head = acb->rqbuf_putIndex;"
    },
    {
        "line": 45,
        "fullcodeline": "unsigned int cnt_to_end = CIRC_CNT_TO_END(head, tail, ARCMSR_MAX_QBUFFER);"
    },
    {
        "line": 47,
        "fullcodeline": "allxfer_len = CIRC_CNT(head, tail, ARCMSR_MAX_QBUFFER);"
    },
    {
        "line": 57,
        "fullcodeline": "acb->rqbuf_getIndex = (acb->rqbuf_getIndex + allxfer_len) % ARCMSR_MAX_QBUFFER;"
    },
    {
        "line": 63,
        "fullcodeline": "acb->acb_flags &= ~ACB_F_IOPDATA_OVERFLOW;"
    },
    {
        "line": 64,
        "fullcodeline": "prbuffer = arcmsr_get_iop_rqbuffer(acb);"
    },
    {
        "line": 72,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 85,
        "fullcodeline": "retvalue = ARCMSR_MESSAGE_FAIL;"
    },
    {
        "line": 94,
        "fullcodeline": "struct SENSE_DATA *sensebuffer ="
    },
    {
        "line": 96,
        "fullcodeline": "arcmsr_write_ioctldata2iop(acb);"
    },
    {
        "line": 98,
        "fullcodeline": "sensebuffer->ErrorCode = SCSI_SENSE_CURRENT_ERRORS;"
    },
    {
        "line": 99,
        "fullcodeline": "sensebuffer->SenseKey = ILLEGAL_REQUEST;"
    },
    {
        "line": 100,
        "fullcodeline": "sensebuffer->AdditionalSenseLength = 0x0A;"
    },
    {
        "line": 101,
        "fullcodeline": "sensebuffer->AdditionalSenseCode = 0x20;"
    },
    {
        "line": 102,
        "fullcodeline": "sensebuffer->Valid = 1;"
    },
    {
        "line": 103,
        "fullcodeline": "retvalue = ARCMSR_MESSAGE_FAIL;"
    },
    {
        "line": 126,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 144,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 161,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 187,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 196,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 206,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 217,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 227,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 48,
        "fullcodeline": "if (allxfer_len > ARCMSR_API_DATA_BUFLEN)"
    },
    {
        "line": 51,
        "fullcodeline": "if (allxfer_len <= cnt_to_end)"
    },
    {
        "line": 65,
        "fullcodeline": "if (arcmsr_Read_iop_rqbuffer_data(acb, prbuffer) == 0)"
    },
    {
        "line": 75,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 95,
        "fullcodeline": "(struct SENSE_DATA *)cmd->sense_buffer;"
    },
    {
        "line": 105,
        "fullcodeline": "pQbuffer = &acb->wqbuffer[acb->wqbuf_putIndex];"
    },
    {
        "line": 106,
        "fullcodeline": "cnt2end = ARCMSR_MAX_QBUFFER - acb->wqbuf_putIndex;"
    },
    {
        "line": 114,
        "fullcodeline": "memcpy(pQbuffer, ptmpuserbuffer, user_len);"
    },
    {
        "line": 115,
        "fullcodeline": "acb->wqbuf_putIndex += user_len;"
    },
    {
        "line": 116,
        "fullcodeline": "acb->wqbuf_putIndex %= ARCMSR_MAX_QBUFFER;"
    },
    {
        "line": 129,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 147,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 164,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 190,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 199,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 209,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 220,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 230,
        "fullcodeline": "pcmdmessagefld->cmdmessage.ReturnCode ="
    },
    {
        "line": 49,
        "fullcodeline": "allxfer_len = ARCMSR_API_DATA_BUFLEN;"
    },
    {
        "line": 52,
        "fullcodeline": "memcpy(ptmpQbuffer, acb->rqbuffer + tail, allxfer_len);"
    },
    {
        "line": 66,
        "fullcodeline": "acb->acb_flags |= ACB_F_IOPDATA_OVERFLOW;"
    },
    {
        "line": 107,
        "fullcodeline": "if (user_len > cnt2end) {"
    },
    {
        "line": 117,
        "fullcodeline": "if (acb->acb_flags & ACB_F_MESSAGE_WQBUFFER_CLEARED) {"
    },
    {
        "line": 54,
        "fullcodeline": "memcpy(ptmpQbuffer, acb->rqbuffer + tail, cnt_to_end);"
    },
    {
        "line": 55,
        "fullcodeline": "memcpy(ptmpQbuffer + cnt_to_end, acb->rqbuffer, allxfer_len - cnt_to_end);"
    },
    {
        "line": 108,
        "fullcodeline": "memcpy(pQbuffer, ptmpuserbuffer, cnt2end);"
    },
    {
        "line": 109,
        "fullcodeline": "ptmpuserbuffer += cnt2end;"
    },
    {
        "line": 110,
        "fullcodeline": "user_len -= cnt2end;"
    },
    {
        "line": 111,
        "fullcodeline": "acb->wqbuf_putIndex = 0;"
    },
    {
        "line": 112,
        "fullcodeline": "pQbuffer = acb->wqbuffer;"
    },
    {
        "line": 118,
        "fullcodeline": "acb->acb_flags &="
    },
    {
        "line": 120,
        "fullcodeline": "arcmsr_write_ioctldata2iop(acb);"
    },
    {
        "line": 119,
        "fullcodeline": "~ACB_F_MESSAGE_WQBUFFER_CLEARED;"
    }
]