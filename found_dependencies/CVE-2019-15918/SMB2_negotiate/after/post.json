[
    {
        "line": 6,
        "fullcodeline": "struct kvec iov[1];"
    },
    {
        "line": 8,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "struct TCP_Server_Info *server = ses->server;"
    },
    {
        "line": 13,
        "fullcodeline": "int flags = CIFS_NEG_OP;"
    },
    {
        "line": 16,
        "fullcodeline": "cifs_dbg(FYI, \"Negotiate protocol\\n\");"
    },
    {
        "line": 23,
        "fullcodeline": "rc = smb2_plain_req_init(SMB2_NEGOTIATE, NULL, (void **) &req, &total_len);"
    },
    {
        "line": 27,
        "fullcodeline": "req->sync_hdr.SessionId = 0;"
    },
    {
        "line": 29,
        "fullcodeline": "memset(server->preauth_sha_hash, 0, SMB2_PREAUTH_HASH_SIZE);"
    },
    {
        "line": 30,
        "fullcodeline": "memset(ses->preauth_sha_hash, 0, SMB2_PREAUTH_HASH_SIZE);"
    },
    {
        "line": 61,
        "fullcodeline": "req->Capabilities = cpu_to_le32(ses->server->vals->req_capabilities);"
    },
    {
        "line": 74,
        "fullcodeline": "iov[0].iov_base = (char *)req;"
    },
    {
        "line": 75,
        "fullcodeline": "iov[0].iov_len = total_len;"
    },
    {
        "line": 77,
        "fullcodeline": "memset(&rqst, 0, sizeof(struct smb_rqst));"
    },
    {
        "line": 78,
        "fullcodeline": "rqst.rq_iov = iov;"
    },
    {
        "line": 79,
        "fullcodeline": "rqst.rq_nvec = 1;"
    },
    {
        "line": 81,
        "fullcodeline": "rc = cifs_send_recv(xid, ses, &rqst, &resp_buftype, flags, &rsp_iov);"
    },
    {
        "line": 82,
        "fullcodeline": "cifs_small_buf_release(req);"
    },
    {
        "line": 83,
        "fullcodeline": "rsp = (struct smb2_negotiate_rsp *)rsp_iov.iov_base;"
    },
    {
        "line": 129,
        "fullcodeline": "cifs_dbg(FYI, \"mode 0x%x\\n\", rsp->SecurityMode);"
    },
    {
        "line": 147,
        "fullcodeline": "server->dialect = le16_to_cpu(rsp->DialectRevision);"
    },
    {
        "line": 154,
        "fullcodeline": "memcpy(server->preauth_sha_hash, ses->preauth_sha_hash,"
    },
    {
        "line": 158,
        "fullcodeline": "server->negflavor = CIFS_NEGFLAVOR_EXTENDED;"
    },
    {
        "line": 162,
        "fullcodeline": "server->max_read = le32_to_cpu(rsp->MaxReadSize);"
    },
    {
        "line": 163,
        "fullcodeline": "server->max_write = le32_to_cpu(rsp->MaxWriteSize);"
    },
    {
        "line": 164,
        "fullcodeline": "server->sec_mode = le16_to_cpu(rsp->SecurityMode);"
    },
    {
        "line": 168,
        "fullcodeline": "server->capabilities = le32_to_cpu(rsp->Capabilities);"
    },
    {
        "line": 170,
        "fullcodeline": "server->capabilities |= SMB2_NT_FIND | SMB2_LARGE_FILES;"
    },
    {
        "line": 172,
        "fullcodeline": "security_blob = smb2_get_data_area_len(&blob_offset, &blob_length,"
    },
    {
        "line": 186,
        "fullcodeline": "rc = cifs_enable_signing(server, ses->sign);"
    },
    {
        "line": 205,
        "fullcodeline": "free_rsp_buf(resp_buftype, rsp);"
    },
    {
        "line": 18,
        "fullcodeline": "if (!server) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (strcmp(ses->server->vals->version_string,"
    },
    {
        "line": 64,
        "fullcodeline": "if (ses->server->vals->protocol_id == SMB20_PROT_ID)"
    },
    {
        "line": 88,
        "fullcodeline": "if (rc == -EOPNOTSUPP) {"
    },
    {
        "line": 96,
        "fullcodeline": "if (strcmp(ses->server->vals->version_string,"
    },
    {
        "line": 131,
        "fullcodeline": "if (rsp->DialectRevision == cpu_to_le16(SMB20_PROT_ID))"
    },
    {
        "line": 165,
        "fullcodeline": "if ((server->sec_mode & SMB2_SEC_MODE_FLAGS_ALL) != server->sec_mode)"
    },
    {
        "line": 181,
        "fullcodeline": "if (blob_length == 0) {"
    },
    {
        "line": 197,
        "fullcodeline": "if (rsp->DialectRevision == cpu_to_le16(SMB311_PROT_ID)) {"
    },
    {
        "line": 19,
        "fullcodeline": "WARN(1, \"%s: server is NULL!\\n\", __func__);"
    },
    {
        "line": 34,
        "fullcodeline": "req->Dialects[0] = cpu_to_le16(SMB30_PROT_ID);"
    },
    {
        "line": 35,
        "fullcodeline": "req->Dialects[1] = cpu_to_le16(SMB302_PROT_ID);"
    },
    {
        "line": 36,
        "fullcodeline": "req->DialectCount = cpu_to_le16(2);"
    },
    {
        "line": 37,
        "fullcodeline": "total_len += 4;"
    },
    {
        "line": 55,
        "fullcodeline": "req->SecurityMode = cpu_to_le16(SMB2_NEGOTIATE_SIGNING_REQUIRED);"
    },
    {
        "line": 65,
        "fullcodeline": "memset(req->ClientGUID, 0, SMB2_CLIENT_GUID_SIZE);"
    },
    {
        "line": 89,
        "fullcodeline": "cifs_dbg(VFS, \"Dialect not supported by server. Consider \""
    },
    {
        "line": 132,
        "fullcodeline": "cifs_dbg(FYI, \"negotiated smb2.0 dialect\\n\");"
    },
    {
        "line": 166,
        "fullcodeline": "cifs_dbg(FYI, \"Server returned unexpected security mode 0x%x\\n\","
    },
    {
        "line": 173,
        "fullcodeline": "(struct smb2_sync_hdr *)rsp);"
    },
    {
        "line": 182,
        "fullcodeline": "cifs_dbg(FYI, \"missing security blob on negprot\\n\");"
    },
    {
        "line": 183,
        "fullcodeline": "server->sec_ntlmssp = true;"
    },
    {
        "line": 190,
        "fullcodeline": "rc = decode_negTokenInit(security_blob, blob_length, server);"
    },
    {
        "line": 20,
        "fullcodeline": "return -EIO;"
    },
    {
        "line": 67,
        "fullcodeline": "memcpy(req->ClientGUID, server->client_guid,"
    },
    {
        "line": 98,
        "fullcodeline": "if (rsp->DialectRevision == cpu_to_le16(SMB20_PROT_ID)) {"
    },
    {
        "line": 191,
        "fullcodeline": "if (rc == 1)"
    },
    {
        "line": 38,
        "fullcodeline": "} else if (strcmp(ses->server->vals->version_string,"
    },
    {
        "line": 56,
        "fullcodeline": "else if (global_secflags & CIFSSEC_MAY_SIGN)"
    },
    {
        "line": 69,
        "fullcodeline": "if ((ses->server->vals->protocol_id == SMB311_PROT_ID) ||"
    },
    {
        "line": 93,
        "fullcodeline": "} else if (rc != 0)"
    },
    {
        "line": 99,
        "fullcodeline": "cifs_dbg(VFS,"
    },
    {
        "line": 107,
        "fullcodeline": "} else if (strcmp(ses->server->vals->version_string,"
    },
    {
        "line": 133,
        "fullcodeline": "else if (rsp->DialectRevision == cpu_to_le16(SMB21_PROT_ID))"
    },
    {
        "line": 192,
        "fullcodeline": "rc = 0;"
    },
    {
        "line": 199,
        "fullcodeline": "rc = smb311_decode_neg_context(rsp, server,"
    },
    {
        "line": 40,
        "fullcodeline": "req->Dialects[0] = cpu_to_le16(SMB21_PROT_ID);"
    },
    {
        "line": 41,
        "fullcodeline": "req->Dialects[1] = cpu_to_le16(SMB30_PROT_ID);"
    },
    {
        "line": 42,
        "fullcodeline": "req->Dialects[2] = cpu_to_le16(SMB302_PROT_ID);"
    },
    {
        "line": 43,
        "fullcodeline": "req->Dialects[3] = cpu_to_le16(SMB311_PROT_ID);"
    },
    {
        "line": 44,
        "fullcodeline": "req->DialectCount = cpu_to_le16(4);"
    },
    {
        "line": 45,
        "fullcodeline": "total_len += 8;"
    },
    {
        "line": 57,
        "fullcodeline": "req->SecurityMode = cpu_to_le16(SMB2_NEGOTIATE_SIGNING_ENABLED);"
    },
    {
        "line": 70,
        "fullcodeline": "(strcmp(ses->server->vals->version_string,"
    },
    {
        "line": 72,
        "fullcodeline": "assemble_neg_contexts(req, &total_len);"
    },
    {
        "line": 101,
        "fullcodeline": "return -EIO;"
    },
    {
        "line": 134,
        "fullcodeline": "cifs_dbg(FYI, \"negotiated smb2.1 dialect\\n\");"
    },
    {
        "line": 202,
        "fullcodeline": "cifs_dbg(VFS, \"Missing expected negotiate contexts\\n\");"
    },
    {
        "line": 48,
        "fullcodeline": "req->Dialects[0] = cpu_to_le16(ses->server->vals->protocol_id);"
    },
    {
        "line": 49,
        "fullcodeline": "req->DialectCount = cpu_to_le16(1);"
    },
    {
        "line": 50,
        "fullcodeline": "total_len += 2;"
    },
    {
        "line": 59,
        "fullcodeline": "req->SecurityMode = 0;"
    },
    {
        "line": 102,
        "fullcodeline": "} else if (rsp->DialectRevision == cpu_to_le16(SMB21_PROT_ID)) {"
    },
    {
        "line": 109,
        "fullcodeline": "if (rsp->DialectRevision == cpu_to_le16(SMB20_PROT_ID)) {"
    },
    {
        "line": 193,
        "fullcodeline": "else if (rc == 0)"
    },
    {
        "line": 103,
        "fullcodeline": "cifs_dbg(VFS,"
    },
    {
        "line": 110,
        "fullcodeline": "cifs_dbg(VFS,"
    },
    {
        "line": 121,
        "fullcodeline": "} else if (le16_to_cpu(rsp->DialectRevision) !="
    },
    {
        "line": 135,
        "fullcodeline": "else if (rsp->DialectRevision == cpu_to_le16(SMB30_PROT_ID))"
    },
    {
        "line": 194,
        "fullcodeline": "rc = -EIO;"
    },
    {
        "line": 105,
        "fullcodeline": "return -EIO;"
    },
    {
        "line": 112,
        "fullcodeline": "return -EIO;"
    },
    {
        "line": 124,
        "fullcodeline": "cifs_dbg(VFS, \"Illegal 0x%x dialect returned: not requested\\n\","
    },
    {
        "line": 136,
        "fullcodeline": "cifs_dbg(FYI, \"negotiated smb3.0 dialect\\n\");"
    },
    {
        "line": 113,
        "fullcodeline": "} else if (rsp->DialectRevision == cpu_to_le16(SMB21_PROT_ID)) {"
    },
    {
        "line": 125,
        "fullcodeline": "le16_to_cpu(rsp->DialectRevision));"
    },
    {
        "line": 126,
        "fullcodeline": "return -EIO;"
    },
    {
        "line": 115,
        "fullcodeline": "ses->server->ops = &smb21_operations;"
    },
    {
        "line": 116,
        "fullcodeline": "ses->server->vals = &smb21_values;"
    },
    {
        "line": 137,
        "fullcodeline": "else if (rsp->DialectRevision == cpu_to_le16(SMB302_PROT_ID))"
    },
    {
        "line": 138,
        "fullcodeline": "cifs_dbg(FYI, \"negotiated smb3.02 dialect\\n\");"
    },
    {
        "line": 117,
        "fullcodeline": "} else if (rsp->DialectRevision == cpu_to_le16(SMB311_PROT_ID)) {"
    },
    {
        "line": 118,
        "fullcodeline": "ses->server->ops = &smb311_operations;"
    },
    {
        "line": 119,
        "fullcodeline": "ses->server->vals = &smb311_values;"
    },
    {
        "line": 139,
        "fullcodeline": "else if (rsp->DialectRevision == cpu_to_le16(SMB311_PROT_ID))"
    },
    {
        "line": 140,
        "fullcodeline": "cifs_dbg(FYI, \"negotiated smb3.1.1 dialect\\n\");"
    },
    {
        "line": 142,
        "fullcodeline": "cifs_dbg(VFS, \"Illegal dialect returned by server 0x%x\\n\","
    },
    {
        "line": 144,
        "fullcodeline": "rc = -EIO;"
    },
    {
        "line": 143,
        "fullcodeline": "le16_to_cpu(rsp->DialectRevision));"
    }
]