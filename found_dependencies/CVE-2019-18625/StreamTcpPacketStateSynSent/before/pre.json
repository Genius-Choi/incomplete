[
    {
        "line": 7,
        "fullcodeline": "SCLogDebug(\"ssn %p: pkt received: %s\", ssn, PKT_IS_TOCLIENT(p) ?"
    },
    {
        "line": 4,
        "fullcodeline": "if (ssn == NULL)"
    },
    {
        "line": 11,
        "fullcodeline": "if (p->tcph->th_flags & TH_RST) {"
    },
    {
        "line": 5,
        "fullcodeline": "return -1;"
    },
    {
        "line": 15,
        "fullcodeline": "if (PKT_IS_TOSERVER(p)) {"
    },
    {
        "line": 12,
        "fullcodeline": "if (!StreamTcpValidateRst(ssn, p))"
    },
    {
        "line": 36,
        "fullcodeline": "} else if (p->tcph->th_flags & TH_FIN) {"
    },
    {
        "line": 13,
        "fullcodeline": "return -1;"
    },
    {
        "line": 30,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_CLOSED);"
    },
    {
        "line": 16,
        "fullcodeline": "if (SEQ_EQ(TCP_GET_SEQ(p), ssn->client.isn) &&"
    },
    {
        "line": 18,
        "fullcodeline": "SEQ_EQ(TCP_GET_ACK(p), (ssn->client.isn + 1)))"
    },
    {
        "line": 23,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_CLOSED);"
    },
    {
        "line": 17,
        "fullcodeline": "SEQ_EQ(TCP_GET_WINDOW(p), 0) &&"
    },
    {
        "line": 40,
        "fullcodeline": "} else if ((p->tcph->th_flags & (TH_SYN|TH_ACK)) == (TH_SYN|TH_ACK)) {"
    },
    {
        "line": 135,
        "fullcodeline": "if (PKT_IS_TOSERVER(p)) {"
    },
    {
        "line": 41,
        "fullcodeline": "if ((ssn->flags & STREAMTCP_FLAG_4WHS) && PKT_IS_TOSERVER(p)) {"
    },
    {
        "line": 42,
        "fullcodeline": "SCLogDebug(\"ssn %p: SYN/ACK received on 4WHS session\", ssn);"
    },
    {
        "line": 68,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_SYN_RECV);"
    },
    {
        "line": 69,
        "fullcodeline": "SCLogDebug(\"ssn %p: =~ 4WHS ssn state is now TCP_SYN_RECV\", ssn);"
    },
    {
        "line": 72,
        "fullcodeline": "ssn->client.isn = TCP_GET_SEQ(p);"
    },
    {
        "line": 73,
        "fullcodeline": "STREAMTCP_SET_RA_BASE_SEQ(&ssn->client, ssn->client.isn);"
    },
    {
        "line": 76,
        "fullcodeline": "ssn->server.window = TCP_GET_WINDOW(p);"
    },
    {
        "line": 99,
        "fullcodeline": "ssn->server.last_ack = TCP_GET_ACK(p);"
    },
    {
        "line": 100,
        "fullcodeline": "ssn->client.last_ack = ssn->client.isn + 1;"
    },
    {
        "line": 136,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_3WHS_SYNACK_IN_WRONG_DIRECTION);"
    },
    {
        "line": 141,
        "fullcodeline": "if (!(TCP_HAS_TFO(p) || (ssn->flags & STREAMTCP_FLAG_TCP_FAST_OPEN))) {"
    },
    {
        "line": 168,
        "fullcodeline": "} else if (p->tcph->th_flags & TH_SYN) {"
    },
    {
        "line": 138,
        "fullcodeline": "return -1;"
    },
    {
        "line": 163,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_TCP_FAST_OPEN;"
    },
    {
        "line": 164,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_ESTABLISHED);"
    },
    {
        "line": 169,
        "fullcodeline": "SCLogDebug(\"ssn %p: SYN packet on state SYN_SENT... resent\", ssn);"
    },
    {
        "line": 46,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_ACK(p), ssn->server.isn + 1))) {"
    },
    {
        "line": 47,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_4WHS_SYNACK_WITH_WRONG_ACK);"
    },
    {
        "line": 57,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_SEQ(p), ssn->client.isn))) {"
    },
    {
        "line": 58,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_4WHS_SYNACK_WITH_WRONG_SYN);"
    },
    {
        "line": 82,
        "fullcodeline": "if ((TCP_HAS_TS(p)) &&"
    },
    {
        "line": 83,
        "fullcodeline": "(ssn->server.flags & STREAMTCP_STREAM_FLAG_TIMESTAMP))"
    },
    {
        "line": 85,
        "fullcodeline": "ssn->client.last_ts = TCP_GET_TSVAL(p);"
    },
    {
        "line": 89,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_TIMESTAMP;"
    },
    {
        "line": 104,
        "fullcodeline": "if ((ssn->flags & STREAMTCP_FLAG_SERVER_WSCALE) &&"
    },
    {
        "line": 105,
        "fullcodeline": "(TCP_HAS_WSCALE(p)))"
    },
    {
        "line": 112,
        "fullcodeline": "if ((ssn->flags & STREAMTCP_FLAG_CLIENT_SACKOK) &&"
    },
    {
        "line": 113,
        "fullcodeline": "TCP_GET_SACKOK(p) == 1) {"
    },
    {
        "line": 114,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_SACKOK;"
    },
    {
        "line": 144,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_ACK(p), ssn->client.isn + 1))) {"
    },
    {
        "line": 170,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_4WHS) {"
    },
    {
        "line": 175,
        "fullcodeline": "if (PKT_IS_TOCLIENT(p)) {"
    },
    {
        "line": 52,
        "fullcodeline": "return -1;"
    },
    {
        "line": 63,
        "fullcodeline": "return -1;"
    },
    {
        "line": 107,
        "fullcodeline": "ssn->server.wscale = TCP_GET_WSCALE(p);"
    },
    {
        "line": 149,
        "fullcodeline": "return -1;"
    },
    {
        "line": 152,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_ACK(p), ssn->client.next_seq))) {"
    },
    {
        "line": 171,
        "fullcodeline": "SCLogDebug(\"ssn %p: SYN packet on state SYN_SENT... resent of \""
    },
    {
        "line": 183,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_4WHS;"
    },
    {
        "line": 184,
        "fullcodeline": "SCLogDebug(\"ssn %p: STREAMTCP_FLAG_4WHS flag set\", ssn);"
    },
    {
        "line": 190,
        "fullcodeline": "ssn->server.isn = TCP_GET_SEQ(p);"
    },
    {
        "line": 191,
        "fullcodeline": "STREAMTCP_SET_RA_BASE_SEQ(&ssn->server, ssn->server.isn);"
    },
    {
        "line": 96,
        "fullcodeline": "ssn->server.flags &= ~STREAMTCP_STREAM_FLAG_ZERO_TIMESTAMP;"
    },
    {
        "line": 157,
        "fullcodeline": "return -1;"
    },
    {
        "line": 196,
        "fullcodeline": "if (TCP_HAS_TS(p)) {"
    },
    {
        "line": 206,
        "fullcodeline": "ssn->server.window = TCP_GET_WINDOW(p);"
    },
    {
        "line": 207,
        "fullcodeline": "if (TCP_HAS_WSCALE(p)) {"
    },
    {
        "line": 255,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_ASYNC;"
    },
    {
        "line": 256,
        "fullcodeline": "StreamTcpPacketSetState(p, ssn, TCP_ESTABLISHED);"
    },
    {
        "line": 257,
        "fullcodeline": "SCLogDebug(\"ssn %p: =~ ssn state is now TCP_ESTABLISHED\", ssn);"
    },
    {
        "line": 259,
        "fullcodeline": "ssn->client.window = TCP_GET_WINDOW(p);"
    },
    {
        "line": 260,
        "fullcodeline": "ssn->client.last_ack = TCP_GET_SEQ(p);"
    },
    {
        "line": 261,
        "fullcodeline": "ssn->client.next_win = ssn->client.last_ack + ssn->client.window;"
    },
    {
        "line": 264,
        "fullcodeline": "ssn->server.isn = TCP_GET_ACK(p) - 1;"
    },
    {
        "line": 265,
        "fullcodeline": "STREAMTCP_SET_RA_BASE_SEQ(&ssn->server, ssn->server.isn);"
    },
    {
        "line": 266,
        "fullcodeline": "ssn->server.next_seq = ssn->server.isn + 1;"
    },
    {
        "line": 267,
        "fullcodeline": "ssn->server.last_ack = ssn->server.next_seq;"
    },
    {
        "line": 197,
        "fullcodeline": "ssn->server.last_ts = TCP_GET_TSVAL(p);"
    },
    {
        "line": 198,
        "fullcodeline": "SCLogDebug(\"ssn %p: %02x\", ssn, ssn->server.last_ts);"
    },
    {
        "line": 208,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_SERVER_WSCALE;"
    },
    {
        "line": 215,
        "fullcodeline": "if (TCP_GET_SACKOK(p) == 1) {"
    },
    {
        "line": 239,
        "fullcodeline": "if (stream_config.async_oneside == FALSE)"
    },
    {
        "line": 278,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_SERVER_WSCALE) {"
    },
    {
        "line": 295,
        "fullcodeline": "if (ssn->flags & STREAMTCP_FLAG_CLIENT_SACKOK) {"
    },
    {
        "line": 209,
        "fullcodeline": "ssn->server.wscale = TCP_GET_WSCALE(p);"
    },
    {
        "line": 211,
        "fullcodeline": "ssn->flags &= ~STREAMTCP_FLAG_SERVER_WSCALE;"
    },
    {
        "line": 246,
        "fullcodeline": "if (!(SEQ_EQ(TCP_GET_SEQ(p), ssn->client.next_seq))) {"
    },
    {
        "line": 247,
        "fullcodeline": "StreamTcpSetEvent(p, STREAM_3WHS_ASYNC_WRONG_SEQ);"
    },
    {
        "line": 279,
        "fullcodeline": "ssn->client.wscale = TCP_WSCALE_MAX;"
    },
    {
        "line": 284,
        "fullcodeline": "if (TCP_HAS_TS(p) &&"
    },
    {
        "line": 285,
        "fullcodeline": "(ssn->client.flags & STREAMTCP_STREAM_FLAG_TIMESTAMP))"
    },
    {
        "line": 287,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_TIMESTAMP;"
    },
    {
        "line": 288,
        "fullcodeline": "ssn->client.flags &= ~STREAMTCP_STREAM_FLAG_TIMESTAMP;"
    },
    {
        "line": 289,
        "fullcodeline": "ssn->client.last_pkt_ts = p->ts.tv_sec;"
    },
    {
        "line": 296,
        "fullcodeline": "ssn->flags |= STREAMTCP_FLAG_SACKOK;"
    },
    {
        "line": 201,
        "fullcodeline": "ssn->server.flags |= STREAMTCP_STREAM_FLAG_ZERO_TIMESTAMP;"
    },
    {
        "line": 218,
        "fullcodeline": "ssn->flags &= ~STREAMTCP_FLAG_CLIENT_SACKOK;"
    },
    {
        "line": 252,
        "fullcodeline": "return -1;"
    },
    {
        "line": 291,
        "fullcodeline": "ssn->client.last_ts = 0;"
    },
    {
        "line": 292,
        "fullcodeline": "ssn->client.flags &= ~STREAMTCP_STREAM_FLAG_ZERO_TIMESTAMP;"
    }
]