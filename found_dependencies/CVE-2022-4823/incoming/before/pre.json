[
    {
        "line": 2,
        "fullcodeline": "account = Account.find_by_id_or_name(params[:account_name])"
    },
    {
        "line": 3,
        "fullcodeline": "channel = account.geopoll_channels.find_by_name(params[:channel_name])"
    },
    {
        "line": 4,
        "fullcodeline": "auth_token = channel.configuration[:auth_token].to_s.split(' ')[1]"
    },
    {
        "line": 5,
        "fullcodeline": "identifier = params[:Identifier]"
    },
    {
        "line": 6,
        "fullcodeline": "signature = Digest::MD5.hexdigest(auth_token + identifier)"
    },
    {
        "line": 12,
        "fullcodeline": "msg = AtMessage.new"
    },
    {
        "line": 13,
        "fullcodeline": "msg.from = \"sms://#{params[:SourceAddress]}\""
    },
    {
        "line": 14,
        "fullcodeline": "msg.to   = \"sms://#{channel.configuration[:from]}\""
    },
    {
        "line": 15,
        "fullcodeline": "msg.body = params[:MessageText]"
    },
    {
        "line": 16,
        "fullcodeline": "msg.channel_relative_id = params[:Identifier]"
    },
    {
        "line": 8,
        "fullcodeline": "if signature != params[:Signature]"
    },
    {
        "line": 19,
        "fullcodeline": "render text: \"Accepted\""
    },
    {
        "line": 9,
        "fullcodeline": "return render text: \"Error\", status: :unauthorized"
    }
]