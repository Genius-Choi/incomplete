[
    {
        "line": 6,
        "fullcodeline": "wStream* licenseStream = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "BOOL ret = FALSE;"
    },
    {
        "line": 8,
        "fullcodeline": "BYTE computedMac[16];"
    },
    {
        "line": 11,
        "fullcodeline": "DEBUG_LICENSE(\"Receiving Server New/Upgrade License Packet\");"
    },
    {
        "line": 13,
        "fullcodeline": "calBlob = license_new_binary_blob(BB_DATA_BLOB);"
    },
    {
        "line": 37,
        "fullcodeline": "licenseStream = Stream_New(calBlob->data, calBlob->length);"
    },
    {
        "line": 41,
        "fullcodeline": "Stream_Read_UINT16(licenseStream, os_minor);"
    },
    {
        "line": 42,
        "fullcodeline": "Stream_Read_UINT16(licenseStream, os_major);"
    },
    {
        "line": 45,
        "fullcodeline": "Stream_Read_UINT32(licenseStream, cbScope);"
    },
    {
        "line": 52,
        "fullcodeline": "Stream_Seek(licenseStream, cbScope);"
    },
    {
        "line": 55,
        "fullcodeline": "Stream_Read_UINT32(licenseStream, cbCompanyName);"
    },
    {
        "line": 62,
        "fullcodeline": "Stream_Seek(licenseStream, cbCompanyName);"
    },
    {
        "line": 65,
        "fullcodeline": "Stream_Read_UINT32(licenseStream, cbProductId);"
    },
    {
        "line": 72,
        "fullcodeline": "Stream_Seek(licenseStream, cbProductId);"
    },
    {
        "line": 75,
        "fullcodeline": "Stream_Read_UINT32(licenseStream, cbLicenseInfo);"
    },
    {
        "line": 79,
        "fullcodeline": "license->state = LICENSE_STATE_COMPLETED;"
    },
    {
        "line": 81,
        "fullcodeline": "ret = TRUE;"
    },
    {
        "line": 87,
        "fullcodeline": "Stream_Free(licenseStream, FALSE);"
    },
    {
        "line": 89,
        "fullcodeline": "license_free_binary_blob(calBlob);"
    },
    {
        "line": 14,
        "fullcodeline": "if (!calBlob)"
    },
    {
        "line": 18,
        "fullcodeline": "if (!license_read_encrypted_blob(license, s, calBlob))"
    },
    {
        "line": 22,
        "fullcodeline": "if (Stream_GetRemainingLength(s) < 16)"
    },
    {
        "line": 25,
        "fullcodeline": "if (!security_mac_data(license->MacSaltKey, calBlob->data, calBlob->length, computedMac))"
    },
    {
        "line": 28,
        "fullcodeline": "if (memcmp(computedMac, Stream_Pointer(s), sizeof(computedMac)) != 0)"
    },
    {
        "line": 34,
        "fullcodeline": "if (!Stream_SafeSeek(s, 16))"
    },
    {
        "line": 38,
        "fullcodeline": "if (!licenseStream)"
    },
    {
        "line": 46,
        "fullcodeline": "if (Stream_GetRemainingLength(licenseStream) < cbScope)"
    },
    {
        "line": 56,
        "fullcodeline": "if (Stream_GetRemainingLength(licenseStream) < cbCompanyName)"
    },
    {
        "line": 66,
        "fullcodeline": "if (Stream_GetRemainingLength(licenseStream) < cbProductId)"
    },
    {
        "line": 76,
        "fullcodeline": "if (Stream_GetRemainingLength(licenseStream) < cbLicenseInfo)"
    },
    {
        "line": 30,
        "fullcodeline": "WLog_ERR(TAG, \"new or upgrade license MAC mismatch\");"
    },
    {
        "line": 83,
        "fullcodeline": "ret = saveCal(license->rdp->settings, Stream_Pointer(licenseStream), cbLicenseInfo,"
    }
]