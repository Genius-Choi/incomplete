[
    {
        "line": 5,
        "fullcodeline": "const u_int8_t mcastaddr[] = SONMP_MULTICAST_ADDR;"
    },
    {
        "line": 11,
        "fullcodeline": "u_int8_t seg[3], rchassis;"
    },
    {
        "line": 14,
        "fullcodeline": "log_debug(\"sonmp\", \"decode SONMP PDU from %s\","
    },
    {
        "line": 21,
        "fullcodeline": "TAILQ_INIT(&chassis->c_mgmt);"
    },
    {
        "line": 31,
        "fullcodeline": "length = s;"
    },
    {
        "line": 32,
        "fullcodeline": "pos = (u_int8_t*)frame;"
    },
    {
        "line": 42,
        "fullcodeline": "PEEK_DISCARD(ETHER_ADDR_LEN); PEEK_DISCARD_UINT16;"
    },
    {
        "line": 43,
        "fullcodeline": "PEEK_DISCARD(6);"
    },
    {
        "line": 50,
        "fullcodeline": "chassis->c_id_subtype = LLDP_CHASSISID_SUBTYPE_ADDR;"
    },
    {
        "line": 56,
        "fullcodeline": "chassis->c_id_len = sizeof(struct in_addr) + 1;"
    },
    {
        "line": 57,
        "fullcodeline": "chassis->c_id[0] = 1;"
    },
    {
        "line": 58,
        "fullcodeline": "PEEK_BYTES(&address, sizeof(struct in_addr));"
    },
    {
        "line": 59,
        "fullcodeline": "memcpy(chassis->c_id + 1, &address, sizeof(struct in_addr));"
    },
    {
        "line": 65,
        "fullcodeline": "PEEK_BYTES(seg, sizeof(seg));"
    },
    {
        "line": 66,
        "fullcodeline": "rchassis = PEEK_UINT8;"
    },
    {
        "line": 77,
        "fullcodeline": "mgmt = lldpd_alloc_mgmt(LLDPD_AF_IPV4, &address, sizeof(struct in_addr), 0);"
    },
    {
        "line": 86,
        "fullcodeline": "TAILQ_INSERT_TAIL(&chassis->c_mgmt, mgmt, m_entries);"
    },
    {
        "line": 87,
        "fullcodeline": "port->p_ttl = cfg?(cfg->g_config.c_tx_interval * cfg->g_config.c_tx_hold):"
    },
    {
        "line": 89,
        "fullcodeline": "port->p_ttl = (port->p_ttl + 999) / 1000;"
    },
    {
        "line": 91,
        "fullcodeline": "port->p_id_subtype = LLDP_PORTID_SUBTYPE_LOCAL;"
    },
    {
        "line": 98,
        "fullcodeline": "port->p_id_len = strlen(port->p_id);"
    },
    {
        "line": 123,
        "fullcodeline": "*newchassis = chassis;"
    },
    {
        "line": 124,
        "fullcodeline": "*newport = port;"
    },
    {
        "line": 128,
        "fullcodeline": "lldpd_chassis_cleanup(chassis, 1);"
    },
    {
        "line": 129,
        "fullcodeline": "lldpd_port_cleanup(port, 1);"
    },
    {
        "line": 130,
        "fullcodeline": "free(port);"
    },
    {
        "line": 17,
        "fullcodeline": "if ((chassis = calloc(1, sizeof(struct lldpd_chassis))) == NULL) {"
    },
    {
        "line": 22,
        "fullcodeline": "if ((port = calloc(1, sizeof(struct lldpd_port))) == NULL) {"
    },
    {
        "line": 33,
        "fullcodeline": "if (length < SONMP_SIZE) {"
    },
    {
        "line": 37,
        "fullcodeline": "if (PEEK_CMP(mcastaddr, sizeof(mcastaddr)) != 0)"
    },
    {
        "line": 44,
        "fullcodeline": "if (PEEK_UINT16 != LLC_PID_SONMP_HELLO) {"
    },
    {
        "line": 51,
        "fullcodeline": "if ((chassis->c_id = calloc(1, sizeof(struct in_addr) + 1)) == NULL) {"
    },
    {
        "line": 60,
        "fullcodeline": "if (asprintf(&chassis->c_name, \"%s\", inet_ntoa(address)) == -1) {"
    },
    {
        "line": 67,
        "fullcodeline": "for (i=0; sonmp_chassis_types[i].type != 0; i++) {"
    },
    {
        "line": 71,
        "fullcodeline": "if (asprintf(&chassis->c_descr, \"%s\","
    },
    {
        "line": 78,
        "fullcodeline": "if (mgmt == NULL) {"
    },
    {
        "line": 92,
        "fullcodeline": "if (asprintf(&port->p_id, \"%02x-%02x-%02x\","
    },
    {
        "line": 101,
        "fullcodeline": "if ((seg[0] == 0) && (seg[1] == 0)) {"
    },
    {
        "line": 131,
        "fullcodeline": "return -1;"
    },
    {
        "line": 18,
        "fullcodeline": "log_warn(\"sonmp\", \"failed to allocate remote chassis\");"
    },
    {
        "line": 23,
        "fullcodeline": "log_warn(\"sonmp\", \"failed to allocate remote port\");"
    },
    {
        "line": 24,
        "fullcodeline": "free(chassis);"
    },
    {
        "line": 34,
        "fullcodeline": "log_warnx(\"sonmp\", \"too short SONMP frame received on %s\", hardware->h_ifname);"
    },
    {
        "line": 45,
        "fullcodeline": "log_debug(\"sonmp\", \"incorrect LLC protocol ID received for SONMP on %s\","
    },
    {
        "line": 52,
        "fullcodeline": "log_warn(\"sonmp\", \"unable to allocate memory for chassis id on %s\","
    },
    {
        "line": 61,
        "fullcodeline": "log_warnx(\"sonmp\", \"unable to write chassis name for %s\","
    },
    {
        "line": 72,
        "fullcodeline": "sonmp_chassis_types[i].description) == -1) {"
    },
    {
        "line": 73,
        "fullcodeline": "log_warnx(\"sonmp\", \"unable to write chassis description for %s\","
    },
    {
        "line": 93,
        "fullcodeline": "seg[0], seg[1], seg[2]) == -1) {"
    },
    {
        "line": 94,
        "fullcodeline": "log_warn(\"sonmp\", \"unable to allocate memory for port id on %s\","
    },
    {
        "line": 19,
        "fullcodeline": "return -1;"
    },
    {
        "line": 25,
        "fullcodeline": "return -1;"
    },
    {
        "line": 68,
        "fullcodeline": "if (sonmp_chassis_types[i].type == rchassis)"
    },
    {
        "line": 79,
        "fullcodeline": "if (errno == ENOMEM)"
    },
    {
        "line": 102,
        "fullcodeline": "if (asprintf(&port->p_descr, \"port %d\","
    },
    {
        "line": 80,
        "fullcodeline": "log_warn(\"sonmp\", \"unable to allocate memory for management address\");"
    },
    {
        "line": 103,
        "fullcodeline": "seg[2]) == -1) {"
    },
    {
        "line": 104,
        "fullcodeline": "log_warnx(\"sonmp\", \"unable to write port description for %s\","
    },
    {
        "line": 108,
        "fullcodeline": "} else if (seg[0] == 0) {"
    },
    {
        "line": 82,
        "fullcodeline": "log_warn(\"sonmp\", \"too large management address received on %s\","
    },
    {
        "line": 109,
        "fullcodeline": "if (asprintf(&port->p_descr, \"port %d/%d\","
    },
    {
        "line": 110,
        "fullcodeline": "seg[1], seg[2]) == -1) {"
    },
    {
        "line": 111,
        "fullcodeline": "log_warnx(\"sonmp\", \"unable to write port description for %s\","
    },
    {
        "line": 116,
        "fullcodeline": "if (asprintf(&port->p_descr, \"port %x:%x:%x\","
    },
    {
        "line": 117,
        "fullcodeline": "seg[0], seg[1], seg[2]) == -1) {"
    },
    {
        "line": 118,
        "fullcodeline": "log_warnx(\"sonmp\", \"unable to write port description for %s\","
    }
]