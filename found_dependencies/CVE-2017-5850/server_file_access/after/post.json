[
    {
        "line": 4,
        "fullcodeline": "struct http_descriptor\t*desc = clt->clt_descreq;"
    },
    {
        "line": 5,
        "fullcodeline": "struct server_config\t*srv_conf = clt->clt_srv_conf;"
    },
    {
        "line": 11,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 87,
        "fullcodeline": "key.kv_key = \"Range\";"
    },
    {
        "line": 88,
        "fullcodeline": "r = kv_find(&desc->http_headers, &key);"
    },
    {
        "line": 13,
        "fullcodeline": "if (access(path, R_OK) == -1) {"
    },
    {
        "line": 89,
        "fullcodeline": "if (r != NULL)"
    },
    {
        "line": 90,
        "fullcodeline": "return (server_partial_file_request(env, clt, path, &st,"
    },
    {
        "line": 15,
        "fullcodeline": "} else if (stat(path, &st) == -1) {"
    },
    {
        "line": 93,
        "fullcodeline": "return (server_file_request(env, clt, path, &st));"
    },
    {
        "line": 17,
        "fullcodeline": "} else if (S_ISDIR(st.st_mode)) {"
    },
    {
        "line": 53,
        "fullcodeline": "desc->http_path_alias = newpath;"
    },
    {
        "line": 65,
        "fullcodeline": "ret = server_file_access(env, clt, path, len);"
    },
    {
        "line": 19,
        "fullcodeline": "if (srv_conf->flags & SRVFLAG_NO_INDEX) {"
    },
    {
        "line": 24,
        "fullcodeline": "if (desc->http_path_alias != NULL) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (path[strlen(path) - 1] != '/') {"
    },
    {
        "line": 50,
        "fullcodeline": "if (asprintf(&newpath, \"%s%s\", desc->http_path,"
    },
    {
        "line": 54,
        "fullcodeline": "if (server_getlocation(clt, newpath) != srv_conf) {"
    },
    {
        "line": 60,
        "fullcodeline": "if (strlcat(path, srv_conf->index, len) >= len) {"
    },
    {
        "line": 66,
        "fullcodeline": "if (ret == 404) {"
    },
    {
        "line": 20,
        "fullcodeline": "errno = EACCES;"
    },
    {
        "line": 26,
        "fullcodeline": "errno = EINVAL;"
    },
    {
        "line": 40,
        "fullcodeline": "free(encodedpath);"
    },
    {
        "line": 43,
        "fullcodeline": "desc->http_path_alias = newpath;"
    },
    {
        "line": 51,
        "fullcodeline": "srv_conf->index) == -1)"
    },
    {
        "line": 61,
        "fullcodeline": "errno = EACCES;"
    },
    {
        "line": 81,
        "fullcodeline": "} else if (!S_ISREG(st.st_mode)) {"
    },
    {
        "line": 32,
        "fullcodeline": "if ((encodedpath = url_encode(desc->http_path)) == NULL)"
    },
    {
        "line": 34,
        "fullcodeline": "if (asprintf(&newpath, \"http%s://%s%s/\","
    },
    {
        "line": 56,
        "fullcodeline": "return (server_file(env, clt));"
    },
    {
        "line": 73,
        "fullcodeline": "if ((srv_conf->flags & SRVFLAG_AUTO_INDEX) == 0) {"
    },
    {
        "line": 78,
        "fullcodeline": "return (server_file_index(env, clt, &st));"
    },
    {
        "line": 83,
        "fullcodeline": "errno = EACCES;"
    },
    {
        "line": 36,
        "fullcodeline": "desc->http_host, encodedpath) == -1) {"
    },
    {
        "line": 37,
        "fullcodeline": "free(encodedpath);"
    },
    {
        "line": 74,
        "fullcodeline": "errno = EACCES;"
    },
    {
        "line": 35,
        "fullcodeline": "srv_conf->flags & SRVFLAG_TLS ? \"s\" : \"\","
    }
]