[
    {
        "line": 3,
        "fullcodeline": "char\t\t\t  path[PATH_MAX];"
    },
    {
        "line": 4,
        "fullcodeline": "char\t\t\t  tmstr[21];"
    },
    {
        "line": 5,
        "fullcodeline": "struct http_descriptor\t *desc = clt->clt_descreq;"
    },
    {
        "line": 6,
        "fullcodeline": "struct server_config\t *srv_conf = clt->clt_srv_conf;"
    },
    {
        "line": 8,
        "fullcodeline": "int\t\t\t  namesize, i, ret, fd = -1, namewidth, skip;"
    },
    {
        "line": 9,
        "fullcodeline": "int\t\t\t  code = 500;"
    },
    {
        "line": 10,
        "fullcodeline": "struct evbuffer\t\t *evb = NULL;"
    },
    {
        "line": 23,
        "fullcodeline": "stripped = server_root_strip(desc->http_path, srv_conf->strip);"
    },
    {
        "line": 33,
        "fullcodeline": "dir_mtime = MINIMUM(time(NULL), st->st_mtim.tv_sec);"
    },
    {
        "line": 42,
        "fullcodeline": "skip = 0;"
    },
    {
        "line": 48,
        "fullcodeline": "style = \"body { background-color: white; color: black; font-family: \""
    },
    {
        "line": 66,
        "fullcodeline": "free(escapedpath);"
    },
    {
        "line": 111,
        "fullcodeline": "free(namelist);"
    },
    {
        "line": 118,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 119,
        "fullcodeline": "fd = -1;"
    },
    {
        "line": 121,
        "fullcodeline": "media = media_find_config(env, srv_conf, \"index.html\");"
    },
    {
        "line": 122,
        "fullcodeline": "ret = server_response_http(clt, 200, media, EVBUFFER_LENGTH(evb),"
    },
    {
        "line": 137,
        "fullcodeline": "evbuffer_free(evb);"
    },
    {
        "line": 138,
        "fullcodeline": "evb = NULL;"
    },
    {
        "line": 140,
        "fullcodeline": "bufferevent_enable(clt->clt_bev, EV_READ|EV_WRITE);"
    },
    {
        "line": 145,
        "fullcodeline": "clt->clt_done = 0;"
    },
    {
        "line": 148,
        "fullcodeline": "server_reset_http(clt);"
    },
    {
        "line": 151,
        "fullcodeline": "bufferevent_disable(clt->clt_bev, EV_READ|EV_WRITE);"
    },
    {
        "line": 153,
        "fullcodeline": "clt->clt_bev = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "if ((ret = server_file_method(clt)) != 0) {"
    },
    {
        "line": 24,
        "fullcodeline": "if ((size_t)snprintf(path, sizeof(path), \"%s%s\","
    },
    {
        "line": 29,
        "fullcodeline": "if ((fd = open(path, O_RDONLY)) == -1)"
    },
    {
        "line": 35,
        "fullcodeline": "if ((evb = evbuffer_new()) == NULL)"
    },
    {
        "line": 38,
        "fullcodeline": "if ((namesize = scandir(path, &namelist, NULL, alphasort)) == -1)"
    },
    {
        "line": 44,
        "fullcodeline": "if ((escapedpath = escape_html(desc->http_path)) == NULL)"
    },
    {
        "line": 51,
        "fullcodeline": "if (evbuffer_add_printf(evb,"
    },
    {
        "line": 68,
        "fullcodeline": "for (i = 0; i < namesize; i++) {"
    },
    {
        "line": 113,
        "fullcodeline": "if (skip ||"
    },
    {
        "line": 135,
        "fullcodeline": "if (server_bufferevent_write_buffer(clt, evb) == -1)"
    },
    {
        "line": 155,
        "fullcodeline": "if (fd != -1)"
    },
    {
        "line": 157,
        "fullcodeline": "if (evb != NULL)"
    },
    {
        "line": 160,
        "fullcodeline": "return (-1);"
    },
    {
        "line": 18,
        "fullcodeline": "code = ret;"
    },
    {
        "line": 63,
        "fullcodeline": "escapedpath, style, escapedpath) == -1)"
    },
    {
        "line": 64,
        "fullcodeline": "skip = 1;"
    },
    {
        "line": 69,
        "fullcodeline": "dp = namelist[i];"
    },
    {
        "line": 77,
        "fullcodeline": "t = st->st_mtime;"
    },
    {
        "line": 78,
        "fullcodeline": "localtime_r(&t, &tm);"
    },
    {
        "line": 79,
        "fullcodeline": "strftime(tmstr, sizeof(tmstr), \"%d-%h-%Y %R\", &tm);"
    },
    {
        "line": 80,
        "fullcodeline": "namewidth = 51 - strlen(dp->d_name);"
    },
    {
        "line": 107,
        "fullcodeline": "free(escapeduri);"
    },
    {
        "line": 108,
        "fullcodeline": "free(escapedhtml);"
    },
    {
        "line": 109,
        "fullcodeline": "free(dp);"
    },
    {
        "line": 114,
        "fullcodeline": "evbuffer_add_printf(evb,"
    },
    {
        "line": 129,
        "fullcodeline": "evbuffer_free(evb);"
    },
    {
        "line": 142,
        "fullcodeline": "clt->clt_toread = TOREAD_HTTP_HEADER;"
    },
    {
        "line": 71,
        "fullcodeline": "if (skip ||"
    },
    {
        "line": 82,
        "fullcodeline": "if ((escapeduri = url_encode(dp->d_name)) == NULL)"
    },
    {
        "line": 84,
        "fullcodeline": "if ((escapedhtml = escape_html(dp->d_name)) == NULL)"
    },
    {
        "line": 87,
        "fullcodeline": "if (dp->d_name[0] == '.' &&"
    },
    {
        "line": 115,
        "fullcodeline": "\"</pre>\\n<hr>\\n</body>\\n</html>\\n\") == -1)"
    },
    {
        "line": 144,
        "fullcodeline": "clt->clt_toread = TOREAD_HTTP_NONE;"
    },
    {
        "line": 72,
        "fullcodeline": "fstatat(fd, dp->d_name, st, 0) == -1) {"
    },
    {
        "line": 73,
        "fullcodeline": "free(dp);"
    },
    {
        "line": 88,
        "fullcodeline": "!(dp->d_name[1] == '.' && dp->d_name[2] == '\\0')) {"
    },
    {
        "line": 90,
        "fullcodeline": "} else if (S_ISDIR(st->st_mode)) {"
    },
    {
        "line": 91,
        "fullcodeline": "namewidth -= 1; /* trailing slash */"
    },
    {
        "line": 92,
        "fullcodeline": "if (evbuffer_add_printf(evb,"
    },
    {
        "line": 96,
        "fullcodeline": "MAXIMUM(namewidth, 0), \" \", tmstr, \"-\") == -1)"
    },
    {
        "line": 97,
        "fullcodeline": "skip = 1;"
    },
    {
        "line": 98,
        "fullcodeline": "} else if (S_ISREG(st->st_mode)) {"
    },
    {
        "line": 94,
        "fullcodeline": "strchr(escapeduri, ':') != NULL ? \"./\" : \"\","
    },
    {
        "line": 99,
        "fullcodeline": "if (evbuffer_add_printf(evb,"
    },
    {
        "line": 104,
        "fullcodeline": "tmstr, st->st_size) == -1)"
    },
    {
        "line": 105,
        "fullcodeline": "skip = 1;"
    },
    {
        "line": 101,
        "fullcodeline": "strchr(escapeduri, ':') != NULL ? \"./\" : \"\","
    },
    {
        "line": 103,
        "fullcodeline": "MAXIMUM(namewidth, 0), \" \","
    }
]