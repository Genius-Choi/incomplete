[
    {
        "line": 5,
        "fullcodeline": "Test::Result result(\"PKCS10 extensions\");"
    },
    {
        "line": 9,
        "fullcodeline": "opts.dns = \"main.example.org\";"
    },
    {
        "line": 10,
        "fullcodeline": "opts.more_dns.push_back(\"more1.example.org\");"
    },
    {
        "line": 11,
        "fullcodeline": "opts.more_dns.push_back(\"more2.example.org\");"
    },
    {
        "line": 13,
        "fullcodeline": "opts.padding_scheme = sig_padding;"
    },
    {
        "line": 16,
        "fullcodeline": "alt_name.add_attribute(\"DNS\", \"bonus.example.org\");"
    },
    {
        "line": 19,
        "fullcodeline": "alt_dn.add_attribute(\"X520.CommonName\", \"alt_cn\");"
    },
    {
        "line": 20,
        "fullcodeline": "alt_dn.add_attribute(\"X520.Organization\", \"testing\");"
    },
    {
        "line": 21,
        "fullcodeline": "alt_name.add_dn(alt_dn);"
    },
    {
        "line": 23,
        "fullcodeline": "opts.extensions.add(std::make_unique<Botan::Cert_Extension::Subject_Alternative_Name>(alt_name));"
    },
    {
        "line": 25,
        "fullcodeline": "const auto req = Botan::X509::create_cert_req(opts, key, hash_fn, rng);"
    },
    {
        "line": 27,
        "fullcodeline": "const auto alt_dns_names = req.subject_alt_name().get_attribute(\"DNS\");"
    },
    {
        "line": 29,
        "fullcodeline": "result.test_eq(\"Expected number of DNS names\", alt_dns_names.size(), 4);"
    },
    {
        "line": 38,
        "fullcodeline": "result.test_eq(\"Expected number of alt DNs\", req.subject_alt_name().directory_names().size(), 1);"
    },
    {
        "line": 39,
        "fullcodeline": "result.confirm(\"Alt DN is correct\", *req.subject_alt_name().directory_names().begin() == alt_dn);"
    },
    {
        "line": 31,
        "fullcodeline": "if(alt_dns_names.size() == 4) {"
    },
    {
        "line": 32,
        "fullcodeline": "result.test_eq(\"Expected DNS name 1\", alt_dns_names.at(0), \"bonus.example.org\");"
    },
    {
        "line": 33,
        "fullcodeline": "result.test_eq(\"Expected DNS name 2\", alt_dns_names.at(1), \"main.example.org\");"
    },
    {
        "line": 34,
        "fullcodeline": "result.test_eq(\"Expected DNS name 3\", alt_dns_names.at(2), \"more1.example.org\");"
    },
    {
        "line": 35,
        "fullcodeline": "result.test_eq(\"Expected DNS name 3\", alt_dns_names.at(3), \"more2.example.org\");"
    }
]