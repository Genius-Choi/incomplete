[
    {
        "line": 3,
        "fullcodeline": "freerdp_peer* client = (freerdp_peer*) extra;"
    },
    {
        "line": 53,
        "fullcodeline": "rdp->state = CONNECTION_STATE_ESTABLISH_KEYS;"
    },
    {
        "line": 60,
        "fullcodeline": "IFCALL(client->Capabilities, client);"
    },
    {
        "line": 84,
        "fullcodeline": "fprintf(stderr, \"Invalid state %d\\n\", rdp->state);"
    },
    {
        "line": 9,
        "fullcodeline": "if (!rdp_server_accept_nego(rdp, s))"
    },
    {
        "line": 12,
        "fullcodeline": "if (rdp->nego->selected_protocol & PROTOCOL_NLA)"
    },
    {
        "line": 27,
        "fullcodeline": "if (!rdp_server_accept_mcs_connect_initial(rdp, s))"
    },
    {
        "line": 32,
        "fullcodeline": "if (!rdp_server_accept_mcs_erect_domain_request(rdp, s))"
    },
    {
        "line": 37,
        "fullcodeline": "if (!rdp_server_accept_mcs_attach_user_request(rdp, s))"
    },
    {
        "line": 42,
        "fullcodeline": "if (!rdp_server_accept_mcs_channel_join_request(rdp, s))"
    },
    {
        "line": 57,
        "fullcodeline": "if (!rdp_server_accept_client_info(rdp, s))"
    },
    {
        "line": 62,
        "fullcodeline": "if (!rdp_send_demand_active(rdp))"
    },
    {
        "line": 67,
        "fullcodeline": "if (!rdp_server_accept_confirm_active(rdp, s))"
    },
    {
        "line": 79,
        "fullcodeline": "if (peer_recv_pdu(client, s) < 0)"
    },
    {
        "line": 85,
        "fullcodeline": "return -1;"
    },
    {
        "line": 14,
        "fullcodeline": "sspi_CopyAuthIdentity(&client->identity, &(rdp->nego->transport->credssp->identity));"
    },
    {
        "line": 15,
        "fullcodeline": "IFCALLRET(client->Logon, client->authenticated, client, &client->identity, TRUE);"
    },
    {
        "line": 17,
        "fullcodeline": "rdp->nego->transport->credssp = NULL;"
    },
    {
        "line": 73,
        "fullcodeline": "Stream_SetPosition(s, 0);"
    },
    {
        "line": 10,
        "fullcodeline": "return -1;"
    },
    {
        "line": 21,
        "fullcodeline": "IFCALLRET(client->Logon, client->authenticated, client, &client->identity, FALSE);"
    },
    {
        "line": 28,
        "fullcodeline": "return -1;"
    },
    {
        "line": 33,
        "fullcodeline": "return -1;"
    },
    {
        "line": 38,
        "fullcodeline": "return -1;"
    },
    {
        "line": 43,
        "fullcodeline": "return -1;"
    },
    {
        "line": 49,
        "fullcodeline": "if (!rdp_server_accept_client_keys(rdp, s))"
    },
    {
        "line": 58,
        "fullcodeline": "return -1;"
    },
    {
        "line": 63,
        "fullcodeline": "return -1;"
    },
    {
        "line": 74,
        "fullcodeline": "return peer_recv_pdu(client, s);"
    },
    {
        "line": 80,
        "fullcodeline": "return -1;"
    },
    {
        "line": 50,
        "fullcodeline": "return -1;"
    }
]