[
    {
        "line": 4,
        "fullcodeline": "DWORD uSize = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "BYTE* pData = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "HRESULT hRet = S_OK;"
    },
    {
        "line": 8,
        "fullcodeline": "LPDATAOBJECT pDataObj = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "BOOL bIsStreamFile = TRUE;"
    },
    {
        "line": 11,
        "fullcodeline": "static LPSTREAM pStreamStc = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "static UINT32 uStreamIdStc = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "UINT rc = ERROR_INTERNAL_ERROR;"
    },
    {
        "line": 21,
        "fullcodeline": "clipboard = (wfClipboard*)context->custom;"
    },
    {
        "line": 26,
        "fullcodeline": "cbRequested = fileContentsRequest->cbRequested;"
    },
    {
        "line": 30,
        "fullcodeline": "pData = (BYTE*)calloc(1, cbRequested);"
    },
    {
        "line": 35,
        "fullcodeline": "hRet = OleGetClipboard(&pDataObj);"
    },
    {
        "line": 43,
        "fullcodeline": "ZeroMemory(&vFormatEtc, sizeof(FORMATETC));"
    },
    {
        "line": 44,
        "fullcodeline": "ZeroMemory(&vStgMedium, sizeof(STGMEDIUM));"
    },
    {
        "line": 45,
        "fullcodeline": "vFormatEtc.cfFormat = RegisterClipboardFormat(CFSTR_FILECONTENTS);"
    },
    {
        "line": 46,
        "fullcodeline": "vFormatEtc.tymed = TYMED_ISTREAM;"
    },
    {
        "line": 47,
        "fullcodeline": "vFormatEtc.dwAspect = 1;"
    },
    {
        "line": 48,
        "fullcodeline": "vFormatEtc.lindex = fileContentsRequest->listIndex;"
    },
    {
        "line": 49,
        "fullcodeline": "vFormatEtc.ptd = NULL;"
    },
    {
        "line": 150,
        "fullcodeline": "rc = CHANNEL_RC_OK;"
    },
    {
        "line": 162,
        "fullcodeline": "sRc ="
    },
    {
        "line": 164,
        "fullcodeline": "free(pData);"
    },
    {
        "line": 18,
        "fullcodeline": "if (!context || !fileContentsRequest)"
    },
    {
        "line": 23,
        "fullcodeline": "if (!clipboard)"
    },
    {
        "line": 27,
        "fullcodeline": "if (fileContentsRequest->dwFlags == FILECONTENTS_SIZE)"
    },
    {
        "line": 32,
        "fullcodeline": "if (!pData)"
    },
    {
        "line": 37,
        "fullcodeline": "if (FAILED(hRet))"
    },
    {
        "line": 51,
        "fullcodeline": "if ((uStreamIdStc != fileContentsRequest->streamId) || !pStreamStc)"
    },
    {
        "line": 92,
        "fullcodeline": "if (bIsStreamFile == TRUE)"
    },
    {
        "line": 156,
        "fullcodeline": "if (uSize == 0)"
    },
    {
        "line": 163,
        "fullcodeline": "cliprdr_send_response_filecontents(clipboard, fileContentsRequest->streamId, uSize, pData);"
    },
    {
        "line": 166,
        "fullcodeline": "if (sRc != CHANNEL_RC_OK)"
    },
    {
        "line": 39,
        "fullcodeline": "WLog_ERR(TAG, \"filecontents: get ole clipboard failed.\");"
    },
    {
        "line": 63,
        "fullcodeline": "bIsStreamFile = FALSE;"
    },
    {
        "line": 64,
        "fullcodeline": "hRet = IDataObject_EnumFormatEtc(pDataObj, DATADIR_GET, &pEnumFormatEtc);"
    },
    {
        "line": 154,
        "fullcodeline": "IDataObject_Release(pDataObj);"
    },
    {
        "line": 158,
        "fullcodeline": "free(pData);"
    },
    {
        "line": 159,
        "fullcodeline": "pData = NULL;"
    },
    {
        "line": 66,
        "fullcodeline": "if (hRet == S_OK)"
    },
    {
        "line": 94,
        "fullcodeline": "if (fileContentsRequest->dwFlags == FILECONTENTS_SIZE)"
    },
    {
        "line": 59,
        "fullcodeline": "IStream_Release(pStreamStc);"
    },
    {
        "line": 60,
        "fullcodeline": "pStreamStc = NULL;"
    },
    {
        "line": 97,
        "fullcodeline": "ZeroMemory(&vStatStg, sizeof(STATSTG));"
    },
    {
        "line": 98,
        "fullcodeline": "hRet = IStream_Stat(pStreamStc, &vStatStg, STATFLAG_NONAME);"
    },
    {
        "line": 121,
        "fullcodeline": "if (fileContentsRequest->dwFlags == FILECONTENTS_SIZE)"
    },
    {
        "line": 88,
        "fullcodeline": "} while (hRet == S_OK);"
    },
    {
        "line": 100,
        "fullcodeline": "if (hRet == S_OK)"
    },
    {
        "line": 129,
        "fullcodeline": "uSize = cbRequested;"
    },
    {
        "line": 70,
        "fullcodeline": "hRet = IEnumFORMATETC_Next(pEnumFormatEtc, 1, &vFormatEtc2, &CeltFetched);"
    },
    {
        "line": 104,
        "fullcodeline": "uSize = cbRequested;"
    },
    {
        "line": 107,
        "fullcodeline": "else if (fileContentsRequest->dwFlags == FILECONTENTS_RANGE)"
    },
    {
        "line": 123,
        "fullcodeline": "if (clipboard->nFiles <= fileContentsRequest->listIndex)"
    },
    {
        "line": 72,
        "fullcodeline": "if (hRet == S_OK)"
    },
    {
        "line": 111,
        "fullcodeline": "dlibMove.HighPart = fileContentsRequest->nPositionHigh;"
    },
    {
        "line": 112,
        "fullcodeline": "dlibMove.LowPart = fileContentsRequest->nPositionLow;"
    },
    {
        "line": 113,
        "fullcodeline": "hRet = IStream_Seek(pStreamStc, dlibMove, STREAM_SEEK_SET, &dlibNewPosition);"
    },
    {
        "line": 125,
        "fullcodeline": "*((UINT32*)&pData[0]) ="
    },
    {
        "line": 127,
        "fullcodeline": "*((UINT32*)&pData[4]) ="
    },
    {
        "line": 131,
        "fullcodeline": "else if (fileContentsRequest->dwFlags == FILECONTENTS_RANGE)"
    },
    {
        "line": 102,
        "fullcodeline": "*((UINT32*)&pData[0]) = vStatStg.cbSize.LowPart;"
    },
    {
        "line": 103,
        "fullcodeline": "*((UINT32*)&pData[4]) = vStatStg.cbSize.HighPart;"
    },
    {
        "line": 115,
        "fullcodeline": "if (SUCCEEDED(hRet))"
    },
    {
        "line": 136,
        "fullcodeline": "bRet = wf_cliprdr_get_file_contents("
    },
    {
        "line": 74,
        "fullcodeline": "if (vFormatEtc2.cfFormat == RegisterClipboardFormat(CFSTR_FILECONTENTS))"
    },
    {
        "line": 116,
        "fullcodeline": "hRet = IStream_Read(pStreamStc, pData, cbRequested, (PULONG)&uSize);"
    },
    {
        "line": 134,
        "fullcodeline": "if (clipboard->nFiles <= fileContentsRequest->listIndex)"
    },
    {
        "line": 141,
        "fullcodeline": "if (bRet == FALSE)"
    },
    {
        "line": 76,
        "fullcodeline": "hRet = IDataObject_GetData(pDataObj, &vFormatEtc, &vStgMedium);"
    },
    {
        "line": 143,
        "fullcodeline": "WLog_ERR(TAG, \"get file contents failed.\");"
    },
    {
        "line": 144,
        "fullcodeline": "uSize = 0;"
    },
    {
        "line": 78,
        "fullcodeline": "if (hRet == S_OK)"
    },
    {
        "line": 80,
        "fullcodeline": "pStreamStc = vStgMedium.pstm;"
    },
    {
        "line": 81,
        "fullcodeline": "uStreamIdStc = fileContentsRequest->streamId;"
    },
    {
        "line": 82,
        "fullcodeline": "bIsStreamFile = TRUE;"
    }
]