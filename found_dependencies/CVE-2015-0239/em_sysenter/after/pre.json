[
    {
        "line": 3,
        "fullcodeline": "const struct x86_emulate_ops *ops = ctxt->ops;"
    },
    {
        "line": 7,
        "fullcodeline": "u64 efer = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "ops->get_msr(ctxt, MSR_EFER, &efer);"
    },
    {
        "line": 26,
        "fullcodeline": "setup_syscalls_segments(ctxt, &cs, &ss);"
    },
    {
        "line": 28,
        "fullcodeline": "ops->get_msr(ctxt, MSR_IA32_SYSENTER_CS, &msr_data);"
    },
    {
        "line": 32,
        "fullcodeline": "ctxt->eflags &= ~(EFLG_VM | EFLG_IF);"
    },
    {
        "line": 33,
        "fullcodeline": "cs_sel = (u16)msr_data & ~SELECTOR_RPL_MASK;"
    },
    {
        "line": 34,
        "fullcodeline": "ss_sel = cs_sel + 8;"
    },
    {
        "line": 40,
        "fullcodeline": "ops->set_segment(ctxt, cs_sel, &cs, 0, VCPU_SREG_CS);"
    },
    {
        "line": 41,
        "fullcodeline": "ops->set_segment(ctxt, ss_sel, &ss, 0, VCPU_SREG_SS);"
    },
    {
        "line": 43,
        "fullcodeline": "ops->get_msr(ctxt, MSR_IA32_SYSENTER_EIP, &msr_data);"
    },
    {
        "line": 44,
        "fullcodeline": "ctxt->_eip = (efer & EFER_LMA) ? msr_data : (u32)msr_data;"
    },
    {
        "line": 46,
        "fullcodeline": "ops->get_msr(ctxt, MSR_IA32_SYSENTER_ESP, &msr_data);"
    },
    {
        "line": 11,
        "fullcodeline": "if (ctxt->mode == X86EMUL_MODE_REAL)"
    },
    {
        "line": 23,
        "fullcodeline": "if (ctxt->mode == X86EMUL_MODE_PROT64)"
    },
    {
        "line": 35,
        "fullcodeline": "if (efer & EFER_LMA) {"
    },
    {
        "line": 18,
        "fullcodeline": "if ((ctxt->mode != X86EMUL_MODE_PROT64) && (efer & EFER_LMA)"
    },
    {
        "line": 19,
        "fullcodeline": "&& !vendor_intel(ctxt))"
    },
    {
        "line": 29,
        "fullcodeline": "if ((msr_data & 0xfffc) == 0x0)"
    },
    {
        "line": 36,
        "fullcodeline": "cs.d = 0;"
    },
    {
        "line": 37,
        "fullcodeline": "cs.l = 1;"
    },
    {
        "line": 47,
        "fullcodeline": "*reg_write(ctxt, VCPU_REGS_RSP) = (efer & EFER_LMA) ? msr_data :"
    },
    {
        "line": 12,
        "fullcodeline": "return emulate_gp(ctxt, 0);"
    },
    {
        "line": 20,
        "fullcodeline": "return emulate_ud(ctxt);"
    },
    {
        "line": 30,
        "fullcodeline": "return emulate_gp(ctxt, 0);"
    }
]