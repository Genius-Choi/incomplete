[
    {
        "line": 17,
        "fullcodeline": "krb5_principal cp = NULL, sp = NULL, rsp = NULL, tp = NULL, dp = NULL;"
    },
    {
        "line": 18,
        "fullcodeline": "krb5_principal krbtgt_out_principal = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "char *spn = NULL, *cpn = NULL, *tpn = NULL, *dpn = NULL, *krbtgt_out_n = NULL;"
    },
    {
        "line": 20,
        "fullcodeline": "hdb_entry_ex *server = NULL, *client = NULL, *s4u2self_impersonated_client = NULL;"
    },
    {
        "line": 22,
        "fullcodeline": "krb5_realm ref_realm = NULL;"
    },
    {
        "line": 23,
        "fullcodeline": "EncTicketPart *tgt = &ticket->ticket;"
    },
    {
        "line": 24,
        "fullcodeline": "krb5_principals spp = NULL;"
    },
    {
        "line": 29,
        "fullcodeline": "const char *our_realm = /* Realm of this KDC */"
    },
    {
        "line": 31,
        "fullcodeline": "char **capath = NULL;"
    },
    {
        "line": 32,
        "fullcodeline": "size_t num_capath = 0;"
    },
    {
        "line": 34,
        "fullcodeline": "hdb_entry_ex *krbtgt_out = NULL;"
    },
    {
        "line": 41,
        "fullcodeline": "char opt_str[128];"
    },
    {
        "line": 42,
        "fullcodeline": "int signedpath = 0;"
    },
    {
        "line": 46,
        "fullcodeline": "int flags = HDB_F_FOR_TGS_REQ;"
    },
    {
        "line": 48,
        "fullcodeline": "memset(&sessionkey, 0, sizeof(sessionkey));"
    },
    {
        "line": 49,
        "fullcodeline": "memset(&adtkt, 0, sizeof(adtkt));"
    },
    {
        "line": 50,
        "fullcodeline": "krb5_data_zero(&rspac);"
    },
    {
        "line": 51,
        "fullcodeline": "memset(&enc_pa_data, 0, sizeof(enc_pa_data));"
    },
    {
        "line": 53,
        "fullcodeline": "s = b->sname;"
    },
    {
        "line": 54,
        "fullcodeline": "r = b->realm;"
    },
    {
        "line": 59,
        "fullcodeline": "flags |= HDB_F_CANON;"
    },
    {
        "line": 117,
        "fullcodeline": "_krb5_principalname2krb5_principal(context, &sp, *s, r);"
    },
    {
        "line": 118,
        "fullcodeline": "ret = krb5_unparse_name(context, sp, &spn);"
    },
    {
        "line": 121,
        "fullcodeline": "_krb5_principalname2krb5_principal(context, &cp, tgt->cname, tgt->crealm);"
    },
    {
        "line": 122,
        "fullcodeline": "ret = krb5_unparse_name(context, cp, &cpn);"
    },
    {
        "line": 125,
        "fullcodeline": "unparse_flags (KDCOptions2int(b->kdc_options),"
    },
    {
        "line": 141,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, sp, HDB_F_GET_SERVER | flags,"
    },
    {
        "line": 318,
        "fullcodeline": "ret = hdb_enctype2key(context, &krbtgt->entry, NULL, /* XXX use the right kvno! */"
    },
    {
        "line": 332,
        "fullcodeline": "ret = krb5_make_principal(context,"
    },
    {
        "line": 344,
        "fullcodeline": "ret = krb5_unparse_name(context, krbtgt_out_principal, &krbtgt_out_n);"
    },
    {
        "line": 352,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, krbtgt_out_principal,"
    },
    {
        "line": 386,
        "fullcodeline": "ret = _kdc_get_preferred_key(context, config, krbtgt_out, krbtgt_out_n,"
    },
    {
        "line": 393,
        "fullcodeline": "ret = hdb_enctype2key(context, &krbtgt_out->entry, NULL,"
    },
    {
        "line": 401,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, cp, HDB_F_GET_CLIENT | flags,"
    },
    {
        "line": 431,
        "fullcodeline": "ret = check_PAC(context, config, cp, NULL,"
    },
    {
        "line": 446,
        "fullcodeline": "ret = check_KRB5SignedPath(context,"
    },
    {
        "line": 467,
        "fullcodeline": "tp = cp;"
    },
    {
        "line": 468,
        "fullcodeline": "tpn = cpn;"
    },
    {
        "line": 757,
        "fullcodeline": "ret = kdc_check_flags(context, config,"
    },
    {
        "line": 818,
        "fullcodeline": "ret = tgs_make_reply(context,"
    },
    {
        "line": 845,
        "fullcodeline": "free(spn);"
    },
    {
        "line": 846,
        "fullcodeline": "free(cpn);"
    },
    {
        "line": 847,
        "fullcodeline": "free(dpn);"
    },
    {
        "line": 848,
        "fullcodeline": "free(krbtgt_out_n);"
    },
    {
        "line": 849,
        "fullcodeline": "_krb5_free_capath(context, capath);"
    },
    {
        "line": 851,
        "fullcodeline": "krb5_data_free(&rspac);"
    },
    {
        "line": 852,
        "fullcodeline": "krb5_free_keyblock_contents(context, &sessionkey);"
    },
    {
        "line": 864,
        "fullcodeline": "krb5_free_principal(context, cp);"
    },
    {
        "line": 865,
        "fullcodeline": "krb5_free_principal(context, dp);"
    },
    {
        "line": 866,
        "fullcodeline": "krb5_free_principal(context, sp);"
    },
    {
        "line": 867,
        "fullcodeline": "krb5_free_principal(context, krbtgt_out_principal);"
    },
    {
        "line": 868,
        "fullcodeline": "free(ref_realm);"
    },
    {
        "line": 869,
        "fullcodeline": "free_METHOD_DATA(&enc_pa_data);"
    },
    {
        "line": 871,
        "fullcodeline": "free_EncTicketPart(&adtkt);"
    },
    {
        "line": 30,
        "fullcodeline": "krb5_principal_get_comp_string(context, krbtgt->entry.principal, 1);"
    },
    {
        "line": 144,
        "fullcodeline": "if (ret == HDB_ERR_NOT_FOUND_HERE) {"
    },
    {
        "line": 303,
        "fullcodeline": "ret = krb5_generate_random_keyblock(context, etype, &sessionkey);"
    },
    {
        "line": 373,
        "fullcodeline": "if (strcmp(krb5_principal_get_realm(context, server->entry.principal),"
    },
    {
        "line": 403,
        "fullcodeline": "if(ret == HDB_ERR_NOT_FOUND_HERE) {"
    },
    {
        "line": 609,
        "fullcodeline": "if (client != NULL"
    },
    {
        "line": 764,
        "fullcodeline": "if((b->kdc_options.validate || b->kdc_options.renew) &&"
    },
    {
        "line": 774,
        "fullcodeline": "if(!_kdc_check_addresses(context, config, tgt->caddr, from_addr)) {"
    },
    {
        "line": 843,
        "fullcodeline": "if (tpn != cpn)"
    },
    {
        "line": 862,
        "fullcodeline": "if (tp && tp != cp)"
    },
    {
        "line": 66,
        "fullcodeline": "krb5uint32 second_kvno = 0;"
    },
    {
        "line": 67,
        "fullcodeline": "krb5uint32 *kvno_ptr = NULL;"
    },
    {
        "line": 83,
        "fullcodeline": "_krb5_principalname2krb5_principal(context, &p, t->sname, t->realm);"
    },
    {
        "line": 88,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, p,"
    },
    {
        "line": 91,
        "fullcodeline": "krb5_free_principal(context, p);"
    },
    {
        "line": 97,
        "fullcodeline": "ret = hdb_enctype2key(context, &uu->entry, NULL,"
    },
    {
        "line": 104,
        "fullcodeline": "ret = krb5_decrypt_ticket(context, t, &uukey->key, &adtkt, 0);"
    },
    {
        "line": 105,
        "fullcodeline": "_kdc_free_ent(context, uu);"
    },
    {
        "line": 109,
        "fullcodeline": "ret = verify_flags(context, config, &adtkt, spn);"
    },
    {
        "line": 113,
        "fullcodeline": "s = &adtkt.cname;"
    },
    {
        "line": 114,
        "fullcodeline": "r = adtkt.crealm;"
    },
    {
        "line": 129,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 145,
        "fullcodeline": "kdc_log(context, config, 5, \"target %s does not have secrets at this KDC, need to proxy\", sp);"
    },
    {
        "line": 251,
        "fullcodeline": "rsp = server->entry.principal;"
    },
    {
        "line": 321,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 339,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 346,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 355,
        "fullcodeline": "char *ktpn = NULL;"
    },
    {
        "line": 356,
        "fullcodeline": "ret = krb5_unparse_name(context, krbtgt->entry.principal, &ktpn);"
    },
    {
        "line": 357,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 361,
        "fullcodeline": "free(ktpn);"
    },
    {
        "line": 362,
        "fullcodeline": "ret = KRB5KRB_AP_ERR_NOT_US;"
    },
    {
        "line": 376,
        "fullcodeline": "ret = krb5_unparse_name(context, krbtgt_out->entry.principal, &ktpn);"
    },
    {
        "line": 377,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 382,
        "fullcodeline": "ret = KRB5KRB_AP_ERR_NOT_US;"
    },
    {
        "line": 389,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 396,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 437,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 438,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 441,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 454,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 455,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 458,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 472,
        "fullcodeline": "int i = 0;"
    },
    {
        "line": 474,
        "fullcodeline": "sdata = _kdc_find_padata(req, &i, KRB5_PADATA_FOR_USER);"
    },
    {
        "line": 612,
        "fullcodeline": "&& b->kdc_options.enc_tkt_in_skey == 0)"
    },
    {
        "line": 614,
        "fullcodeline": "int ad_signedpath = 0;"
    },
    {
        "line": 632,
        "fullcodeline": "ret = hdb_enctype2key(context, &client->entry,"
    },
    {
        "line": 641,
        "fullcodeline": "ret = krb5_decrypt_ticket(context, t, &clientkey->key, &adtkt, 0);"
    },
    {
        "line": 649,
        "fullcodeline": "ret = _krb5_principalname2krb5_principal(context,"
    },
    {
        "line": 656,
        "fullcodeline": "ret = krb5_unparse_name(context, tp, &tpn);"
    },
    {
        "line": 660,
        "fullcodeline": "ret = _krb5_principalname2krb5_principal(context,"
    },
    {
        "line": 667,
        "fullcodeline": "ret = krb5_unparse_name(context, dp, &dpn);"
    },
    {
        "line": 681,
        "fullcodeline": "ret = check_constrained_delegation(context, config, clientdb,"
    },
    {
        "line": 690,
        "fullcodeline": "ret = verify_flags(context, config, &adtkt, tpn);"
    },
    {
        "line": 695,
        "fullcodeline": "krb5_data_free(&rspac);"
    },
    {
        "line": 703,
        "fullcodeline": "ret = check_PAC(context, config, tp, dp,"
    },
    {
        "line": 721,
        "fullcodeline": "ret = check_KRB5SignedPath(context,"
    },
    {
        "line": 749,
        "fullcodeline": "kdc_log(context, config, 0, \"constrained delegation for %s \""
    },
    {
        "line": 765,
        "fullcodeline": "!krb5_principal_compare(context,"
    },
    {
        "line": 768,
        "fullcodeline": "kdc_log(context, config, 0, \"Inconsistent request.\");"
    },
    {
        "line": 769,
        "fullcodeline": "ret = KRB5KDC_ERR_SERVER_NOMATCH;"
    },
    {
        "line": 775,
        "fullcodeline": "ret = KRB5KRB_AP_ERR_BADADDR;"
    },
    {
        "line": 776,
        "fullcodeline": "kdc_log(context, config, 0, \"Request from wrong address\");"
    },
    {
        "line": 788,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 791,
        "fullcodeline": "ret = krb5_crypto_init(context, &sessionkey, 0, &crypto);"
    },
    {
        "line": 795,
        "fullcodeline": "ret = build_server_referral(context, config, crypto, ref_realm,"
    },
    {
        "line": 797,
        "fullcodeline": "krb5_crypto_destroy(context, crypto);"
    },
    {
        "line": 803,
        "fullcodeline": "pa.padata_type = KRB5_PADATA_SERVER_REFERRAL;"
    },
    {
        "line": 805,
        "fullcodeline": "ret = add_METHOD_DATA(&enc_pa_data, &pa);"
    },
    {
        "line": 806,
        "fullcodeline": "krb5_data_free(&pa.padata_value);"
    },
    {
        "line": 844,
        "fullcodeline": "free(tpn);"
    },
    {
        "line": 854,
        "fullcodeline": "_kdc_free_ent(context, krbtgt_out);"
    },
    {
        "line": 856,
        "fullcodeline": "_kdc_free_ent(context, server);"
    },
    {
        "line": 858,
        "fullcodeline": "_kdc_free_ent(context, client);"
    },
    {
        "line": 860,
        "fullcodeline": "_kdc_free_ent(context, s4u2self_impersonated_client);"
    },
    {
        "line": 863,
        "fullcodeline": "krb5_free_principal(context, tp);"
    },
    {
        "line": 69,
        "fullcodeline": "if(b->additional_tickets == NULL ||"
    },
    {
        "line": 77,
        "fullcodeline": "if(!get_krbtgt_realm(&t->sname)){"
    },
    {
        "line": 133,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 253,
        "fullcodeline": "rsp = sp;"
    },
    {
        "line": 265,
        "fullcodeline": "ekey = &adtkt.key;"
    },
    {
        "line": 276,
        "fullcodeline": "etype = b->etype.val[i];"
    },
    {
        "line": 277,
        "fullcodeline": "kvno = 0;"
    },
    {
        "line": 360,
        "fullcodeline": "krbtgt_out_n, spn, (ret == 0) ? ktpn : \"<unknown>\");"
    },
    {
        "line": 374,
        "fullcodeline": "krb5_principal_get_realm(context, krbtgt_out->entry.principal)) != 0) {"
    },
    {
        "line": 379,
        "fullcodeline": "(ret == 0) ? ktpn : \"<unknown>\");"
    },
    {
        "line": 380,
        "fullcodeline": "if(ret == 0)"
    },
    {
        "line": 611,
        "fullcodeline": "&& b->additional_tickets->len != 0"
    },
    {
        "line": 622,
        "fullcodeline": "if (!signedpath) {"
    },
    {
        "line": 672,
        "fullcodeline": "if (adtkt.flags.forwardable == 0) {"
    },
    {
        "line": 739,
        "fullcodeline": "if (!ad_signedpath) {"
    },
    {
        "line": 70,
        "fullcodeline": "b->additional_tickets->len == 0){"
    },
    {
        "line": 71,
        "fullcodeline": "ret = KRB5KDC_ERR_BADOPTION; /* ? */"
    },
    {
        "line": 72,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 78,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 80,
        "fullcodeline": "ret = KRB5KDC_ERR_POLICY;"
    },
    {
        "line": 86,
        "fullcodeline": "kvno_ptr = &second_kvno;"
    },
    {
        "line": 100,
        "fullcodeline": "_kdc_free_ent(context, uu);"
    },
    {
        "line": 101,
        "fullcodeline": "ret = KRB5KDC_ERR_ETYPE_NOSUPP; /* XXX */"
    },
    {
        "line": 147,
        "fullcodeline": "} else if (ret == HDB_ERR_WRONG_REALM) {"
    },
    {
        "line": 266,
        "fullcodeline": "for(i = 0; i < b->etype.len; i++)"
    },
    {
        "line": 269,
        "fullcodeline": "if(i == b->etype.len) {"
    },
    {
        "line": 281,
        "fullcodeline": "ret = _kdc_find_etype(context,"
    },
    {
        "line": 292,
        "fullcodeline": "ret = _kdc_get_preferred_key(context, config, server, spn,"
    },
    {
        "line": 299,
        "fullcodeline": "ekey = &skey->key;"
    },
    {
        "line": 381,
        "fullcodeline": "free(ktpn);"
    },
    {
        "line": 481,
        "fullcodeline": "ret = decode_PA_S4U2Self(sdata->padata_value.data,"
    },
    {
        "line": 489,
        "fullcodeline": "ret = _krb5_s4u2self_to_checksumdata(context, &self, &datack);"
    },
    {
        "line": 493,
        "fullcodeline": "ret = krb5_crypto_init(context, &tgt->key, 0, &crypto);"
    },
    {
        "line": 503,
        "fullcodeline": "ret = krb5_verify_checksum(context,"
    },
    {
        "line": 509,
        "fullcodeline": "krb5_data_free(&datack);"
    },
    {
        "line": 510,
        "fullcodeline": "krb5_crypto_destroy(context, crypto);"
    },
    {
        "line": 520,
        "fullcodeline": "ret = _krb5_principalname2krb5_principal(context,"
    },
    {
        "line": 524,
        "fullcodeline": "free_PA_S4U2Self(&self);"
    },
    {
        "line": 528,
        "fullcodeline": "ret = krb5_unparse_name(context, tp, &tpn);"
    },
    {
        "line": 580,
        "fullcodeline": "ret = check_s4u2self(context, config, clientdb, client, sp);"
    },
    {
        "line": 600,
        "fullcodeline": "kdc_log(context, config, 0, \"s4u2self %s impersonating %s to \""
    },
    {
        "line": 610,
        "fullcodeline": "&& b->additional_tickets != NULL"
    },
    {
        "line": 623,
        "fullcodeline": "ret = KRB5KDC_ERR_BADOPTION;"
    },
    {
        "line": 624,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 633,
        "fullcodeline": "hdb_kvno2keys(context, &client->entry,"
    },
    {
        "line": 637,
        "fullcodeline": "ret = KRB5KDC_ERR_ETYPE_NOSUPP; /* XXX */"
    },
    {
        "line": 643,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 673,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 677,
        "fullcodeline": "ret = KRB5KDC_ERR_BADOPTION;"
    },
    {
        "line": 684,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 709,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 710,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 714,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 729,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 730,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 735,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 740,
        "fullcodeline": "ret = KRB5KDC_ERR_BADOPTION;"
    },
    {
        "line": 741,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 799,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 808,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 93,
        "fullcodeline": "if (ret == HDB_ERR_NOENTRY)"
    },
    {
        "line": 148,
        "fullcodeline": "free(ref_realm);"
    },
    {
        "line": 149,
        "fullcodeline": "ref_realm = strdup(server->entry.principal->realm);"
    },
    {
        "line": 155,
        "fullcodeline": "kdc_log(context, config, 5,"
    },
    {
        "line": 159,
        "fullcodeline": "krb5_free_principal(context, sp);"
    },
    {
        "line": 160,
        "fullcodeline": "sp = NULL;"
    },
    {
        "line": 161,
        "fullcodeline": "ret = krb5_make_principal(context, &sp, r, KRB5_TGS_NAME,"
    },
    {
        "line": 165,
        "fullcodeline": "free(spn);"
    },
    {
        "line": 166,
        "fullcodeline": "spn = NULL;"
    },
    {
        "line": 167,
        "fullcodeline": "ret = krb5_unparse_name(context, sp, &spn);"
    },
    {
        "line": 270,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 272,
        "fullcodeline": "krb5_clear_error_message(context);"
    },
    {
        "line": 273,
        "fullcodeline": "ret = KRB5KDC_ERR_ETYPE_NOSUPP;"
    },
    {
        "line": 416,
        "fullcodeline": "krbtgt_realm = krb5_principal_get_realm(context, krbtgt_out->entry.principal);"
    },
    {
        "line": 426,
        "fullcodeline": "msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 427,
        "fullcodeline": "kdc_log(context, config, 1, \"Client not found in database: %s\", msg);"
    },
    {
        "line": 428,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 634,
        "fullcodeline": "t->enc_part.kvno ? * t->enc_part.kvno : 0),"
    },
    {
        "line": 94,
        "fullcodeline": "ret = KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 150,
        "fullcodeline": "if (ref_realm == NULL) {"
    },
    {
        "line": 282,
        "fullcodeline": "krb5_principal_is_krbtgt(context, sp) ?"
    },
    {
        "line": 288,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 295,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 418,
        "fullcodeline": "if(strcmp(krb5_principal_get_realm(context, cp), krbtgt_realm) == 0) {"
    },
    {
        "line": 485,
        "fullcodeline": "kdc_log(context, config, 0, \"Failed to decode PA-S4U2Self\");"
    },
    {
        "line": 495,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 496,
        "fullcodeline": "free_PA_S4U2Self(&self);"
    },
    {
        "line": 497,
        "fullcodeline": "krb5_data_free(&datack);"
    },
    {
        "line": 498,
        "fullcodeline": "kdc_log(context, config, 0, \"krb5_crypto_init failed: %s\", msg);"
    },
    {
        "line": 499,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 512,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 513,
        "fullcodeline": "free_PA_S4U2Self(&self);"
    },
    {
        "line": 514,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 516,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 534,
        "fullcodeline": "krb5_pac p = NULL;"
    },
    {
        "line": 535,
        "fullcodeline": "krb5_data_free(&rspac);"
    },
    {
        "line": 536,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, tp, HDB_F_GET_CLIENT | flags,"
    },
    {
        "line": 556,
        "fullcodeline": "ret = _kdc_pac_generate(context, s4u2self_impersonated_client, &p);"
    },
    {
        "line": 582,
        "fullcodeline": "kdc_log(context, config, 0, \"S4U2Self: %s is not allowed \""
    },
    {
        "line": 595,
        "fullcodeline": "str = \"[forwardable]\";"
    },
    {
        "line": 151,
        "fullcodeline": "ret = krb5_enomem(context);"
    },
    {
        "line": 421,
        "fullcodeline": "kdc_log(context, config, 1, \"Client no longer in database: %s\","
    },
    {
        "line": 562,
        "fullcodeline": "if (p != NULL) {"
    },
    {
        "line": 597,
        "fullcodeline": "b->kdc_options.forwardable = 0;"
    },
    {
        "line": 598,
        "fullcodeline": "str = \"\";"
    },
    {
        "line": 235,
        "fullcodeline": "msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 236,
        "fullcodeline": "kdc_log(context, config, 0,"
    },
    {
        "line": 238,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 419,
        "fullcodeline": "if (ret == HDB_ERR_NOENTRY)"
    },
    {
        "line": 549,
        "fullcodeline": "msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 550,
        "fullcodeline": "kdc_log(context, config, 1,"
    },
    {
        "line": 553,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 558,
        "fullcodeline": "kdc_log(context, config, 0, \"PAC generation failed for -- %s\","
    },
    {
        "line": 563,
        "fullcodeline": "ret = _krb5_pac_sign(context, p, ticket->ticket.authtime,"
    },
    {
        "line": 567,
        "fullcodeline": "krb5_pac_free(context, p);"
    },
    {
        "line": 177,
        "fullcodeline": "if ((req_rlm = get_krbtgt_realm(&sp->name)) != NULL) {"
    },
    {
        "line": 239,
        "fullcodeline": "if (ret == HDB_ERR_NOENTRY)"
    },
    {
        "line": 420,
        "fullcodeline": "ret = KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 547,
        "fullcodeline": "if (ret == HDB_ERR_NOENTRY)"
    },
    {
        "line": 185,
        "fullcodeline": "new_rlm = num_capath > 0 ? capath[--num_capath] : NULL;"
    },
    {
        "line": 240,
        "fullcodeline": "ret = KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 548,
        "fullcodeline": "ret = KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 569,
        "fullcodeline": "kdc_log(context, config, 0, \"PAC signing failed for -- %s\","
    },
    {
        "line": 178,
        "fullcodeline": "if (capath == NULL) {"
    },
    {
        "line": 180,
        "fullcodeline": "ret = _krb5_find_capath(context, tgt->crealm, our_realm,"
    },
    {
        "line": 187,
        "fullcodeline": "kdc_log(context, config, 5, \"krbtgt from %s via %s for \""
    },
    {
        "line": 191,
        "fullcodeline": "free(ref_realm);"
    },
    {
        "line": 192,
        "fullcodeline": "ref_realm = strdup(new_rlm);"
    },
    {
        "line": 198,
        "fullcodeline": "krb5_free_principal(context, sp);"
    },
    {
        "line": 199,
        "fullcodeline": "sp = NULL;"
    },
    {
        "line": 200,
        "fullcodeline": "krb5_make_principal(context, &sp, r,"
    },
    {
        "line": 202,
        "fullcodeline": "free(spn);"
    },
    {
        "line": 203,
        "fullcodeline": "spn = NULL;"
    },
    {
        "line": 204,
        "fullcodeline": "ret = krb5_unparse_name(context, sp, &spn);"
    },
    {
        "line": 209,
        "fullcodeline": "} else if (need_referral(context, config, &b->kdc_options, sp, &realms)) {"
    },
    {
        "line": 193,
        "fullcodeline": "if (ref_realm == NULL) {"
    },
    {
        "line": 233,
        "fullcodeline": "krb5_free_host_realm(context, realms);"
    },
    {
        "line": 194,
        "fullcodeline": "ret = krb5_enomem(context);"
    },
    {
        "line": 210,
        "fullcodeline": "if (strcmp(realms[0], sp->realm) != 0) {"
    },
    {
        "line": 211,
        "fullcodeline": "kdc_log(context, config, 5,"
    },
    {
        "line": 215,
        "fullcodeline": "krb5_free_principal(context, sp);"
    },
    {
        "line": 216,
        "fullcodeline": "sp = NULL;"
    },
    {
        "line": 217,
        "fullcodeline": "krb5_make_principal(context, &sp, r, KRB5_TGS_NAME,"
    },
    {
        "line": 219,
        "fullcodeline": "free(spn);"
    },
    {
        "line": 220,
        "fullcodeline": "spn = NULL;"
    },
    {
        "line": 221,
        "fullcodeline": "ret = krb5_unparse_name(context, sp, &spn);"
    },
    {
        "line": 227,
        "fullcodeline": "free(ref_realm);"
    },
    {
        "line": 228,
        "fullcodeline": "ref_realm = strdup(realms[0]);"
    },
    {
        "line": 230,
        "fullcodeline": "krb5_free_host_realm(context, realms);"
    },
    {
        "line": 223,
        "fullcodeline": "krb5_free_host_realm(context, realms);"
    }
]