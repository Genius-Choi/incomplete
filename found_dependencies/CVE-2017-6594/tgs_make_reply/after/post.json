[
    {
        "line": 29,
        "fullcodeline": "KDCOptions f = b->kdc_options;"
    },
    {
        "line": 31,
        "fullcodeline": "int is_weak = 0;"
    },
    {
        "line": 33,
        "fullcodeline": "memset(&rep, 0, sizeof(rep));"
    },
    {
        "line": 34,
        "fullcodeline": "memset(&et, 0, sizeof(et));"
    },
    {
        "line": 35,
        "fullcodeline": "memset(&ek, 0, sizeof(ek));"
    },
    {
        "line": 37,
        "fullcodeline": "rep.pvno = 5;"
    },
    {
        "line": 38,
        "fullcodeline": "rep.msg_type = krb_tgs_rep;"
    },
    {
        "line": 40,
        "fullcodeline": "et.authtime = tgt->authtime;"
    },
    {
        "line": 41,
        "fullcodeline": "_kdc_fix_time(&b->till);"
    },
    {
        "line": 42,
        "fullcodeline": "et.endtime = min(tgt->endtime, *b->till);"
    },
    {
        "line": 44,
        "fullcodeline": "*et.starttime = kdc_time;"
    },
    {
        "line": 46,
        "fullcodeline": "ret = check_tgs_flags(context, config, b, tgt, &et);"
    },
    {
        "line": 69,
        "fullcodeline": "ret = fix_transited_encoding(context, config,"
    },
    {
        "line": 83,
        "fullcodeline": "copy_Realm(&server_principal->realm, &rep.ticket.realm);"
    },
    {
        "line": 84,
        "fullcodeline": "_krb5_principal2principalname(&rep.ticket.sname, server_principal);"
    },
    {
        "line": 85,
        "fullcodeline": "copy_Realm(&tgt_name->realm, &rep.crealm);"
    },
    {
        "line": 91,
        "fullcodeline": "copy_PrincipalName(&tgt_name->name, &rep.cname);"
    },
    {
        "line": 92,
        "fullcodeline": "rep.ticket.tkt_vno = 5;"
    },
    {
        "line": 94,
        "fullcodeline": "ek.caddr = et.caddr;"
    },
    {
        "line": 129,
        "fullcodeline": "*et.starttime = min(*et.starttime, et.endtime);"
    },
    {
        "line": 193,
        "fullcodeline": "ret = krb5_copy_keyblock_contents(context, sessionkey, &et.key);"
    },
    {
        "line": 196,
        "fullcodeline": "et.crealm = tgt_name->realm;"
    },
    {
        "line": 197,
        "fullcodeline": "et.cname = tgt_name->name;"
    },
    {
        "line": 199,
        "fullcodeline": "ek.key = et.key;"
    },
    {
        "line": 201,
        "fullcodeline": "ek.last_req.val = calloc(1, sizeof(*ek.last_req.val));"
    },
    {
        "line": 206,
        "fullcodeline": "ek.last_req.len = 1; /* set after alloc to avoid null deref on cleanup */"
    },
    {
        "line": 207,
        "fullcodeline": "ek.nonce = b->nonce;"
    },
    {
        "line": 208,
        "fullcodeline": "ek.flags = et.flags;"
    },
    {
        "line": 209,
        "fullcodeline": "ek.authtime = et.authtime;"
    },
    {
        "line": 210,
        "fullcodeline": "ek.starttime = et.starttime;"
    },
    {
        "line": 211,
        "fullcodeline": "ek.endtime = et.endtime;"
    },
    {
        "line": 212,
        "fullcodeline": "ek.renew_till = et.renew_till;"
    },
    {
        "line": 213,
        "fullcodeline": "ek.srealm = rep.ticket.realm;"
    },
    {
        "line": 214,
        "fullcodeline": "ek.sname = rep.ticket.sname;"
    },
    {
        "line": 216,
        "fullcodeline": "_kdc_log_timestamp(context, config, \"TGS-REQ\", et.authtime, et.starttime,"
    },
    {
        "line": 266,
        "fullcodeline": "ret = _kdc_encode_reply(context, config, NULL, 0,"
    },
    {
        "line": 275,
        "fullcodeline": "free_TGS_REP(&rep);"
    },
    {
        "line": 276,
        "fullcodeline": "free_TransitedEncoding(&et.transited);"
    },
    {
        "line": 285,
        "fullcodeline": "free_LastReq(&ek.last_req);"
    },
    {
        "line": 286,
        "fullcodeline": "memset(et.key.keyvalue.data, 0, et.key.keyvalue.length);"
    },
    {
        "line": 287,
        "fullcodeline": "free_EncryptionKey(&et.key);"
    },
    {
        "line": 98,
        "fullcodeline": "life = et.endtime - *et.starttime;"
    },
    {
        "line": 103,
        "fullcodeline": "et.endtime = *et.starttime + life;"
    },
    {
        "line": 105,
        "fullcodeline": "if(f.renewable_ok && tgt->flags.renewable &&"
    },
    {
        "line": 131,
        "fullcodeline": "if(*et.starttime == et.endtime){"
    },
    {
        "line": 135,
        "fullcodeline": "if(et.renew_till && et.endtime == *et.renew_till){"
    },
    {
        "line": 202,
        "fullcodeline": "if (ek.last_req.val == NULL) {"
    },
    {
        "line": 221,
        "fullcodeline": "char *r = get_krbtgt_realm(&ek.sname);"
    },
    {
        "line": 248,
        "fullcodeline": "if (krb5_enctype_valid(context, serverkey->keytype) != 0"
    },
    {
        "line": 70,
        "fullcodeline": "!f.disable_transited_check ||"
    },
    {
        "line": 77,
        "fullcodeline": "krb5_principal_get_realm(context, client_principal),"
    },
    {
        "line": 78,
        "fullcodeline": "krb5_principal_get_realm(context, server->entry.principal),"
    },
    {
        "line": 99,
        "fullcodeline": "if(client && client->entry.max_life)"
    },
    {
        "line": 107,
        "fullcodeline": "tgt->renew_till != NULL)"
    },
    {
        "line": 109,
        "fullcodeline": "et.flags.renewable = 1;"
    },
    {
        "line": 110,
        "fullcodeline": "ALLOC(et.renew_till);"
    },
    {
        "line": 111,
        "fullcodeline": "*et.renew_till = *b->till;"
    },
    {
        "line": 115,
        "fullcodeline": "renew = *et.renew_till - *et.starttime;"
    },
    {
        "line": 120,
        "fullcodeline": "*et.renew_till = *et.starttime + renew;"
    },
    {
        "line": 124,
        "fullcodeline": "*et.renew_till = min(*et.renew_till, *tgt->renew_till);"
    },
    {
        "line": 125,
        "fullcodeline": "*et.starttime = min(*et.starttime, *et.renew_till);"
    },
    {
        "line": 126,
        "fullcodeline": "et.endtime = min(et.endtime, *et.renew_till);"
    },
    {
        "line": 132,
        "fullcodeline": "ret = KRB5KDC_ERR_NEVER_VALID;"
    },
    {
        "line": 136,
        "fullcodeline": "free(et.renew_till);"
    },
    {
        "line": 137,
        "fullcodeline": "et.renew_till = NULL;"
    },
    {
        "line": 138,
        "fullcodeline": "et.flags.renewable = 0;"
    },
    {
        "line": 151,
        "fullcodeline": "ret = _kdc_tkt_add_if_relevant_ad(context, &et,"
    },
    {
        "line": 158,
        "fullcodeline": "unsigned int i = 0;"
    },
    {
        "line": 179,
        "fullcodeline": "ret = find_KRB5SignedPath(context, et.authorization_data, NULL);"
    },
    {
        "line": 203,
        "fullcodeline": "ret = ENOMEM;"
    },
    {
        "line": 223,
        "fullcodeline": "if (r == NULL || strcmp(r, ek.srealm) == 0) {"
    },
    {
        "line": 238,
        "fullcodeline": "rep.padata = calloc(1, sizeof(*rep.padata));"
    },
    {
        "line": 243,
        "fullcodeline": "ret = copy_METHOD_DATA(enc_pa_data, rep.padata);"
    },
    {
        "line": 249,
        "fullcodeline": "&& _kdc_is_weak_exception(server->entry.principal, serverkey->keytype))"
    },
    {
        "line": 251,
        "fullcodeline": "krb5_enctype_enable(context, serverkey->keytype);"
    },
    {
        "line": 252,
        "fullcodeline": "is_weak = 1;"
    },
    {
        "line": 272,
        "fullcodeline": "krb5_enctype_disable(context, serverkey->keytype);"
    },
    {
        "line": 278,
        "fullcodeline": "free(et.starttime);"
    },
    {
        "line": 280,
        "fullcodeline": "free(et.renew_till);"
    },
    {
        "line": 282,
        "fullcodeline": "free_AuthorizationData(et.authorization_data);"
    },
    {
        "line": 283,
        "fullcodeline": "free(et.authorization_data);"
    },
    {
        "line": 73,
        "fullcodeline": "!((GLOBAL_ALLOW_PER_PRINCIPAL &&"
    },
    {
        "line": 100,
        "fullcodeline": "life = min(life, *client->entry.max_life);"
    },
    {
        "line": 102,
        "fullcodeline": "life = min(life, *server->entry.max_life);"
    },
    {
        "line": 106,
        "fullcodeline": "et.renew_till == NULL && et.endtime < *b->till &&"
    },
    {
        "line": 116,
        "fullcodeline": "if(client && client->entry.max_renew)"
    },
    {
        "line": 162,
        "fullcodeline": "if (et.authorization_data == NULL) {"
    },
    {
        "line": 170,
        "fullcodeline": "for(i = 0; i < auth_data->len ; i++) {"
    },
    {
        "line": 180,
        "fullcodeline": "if (ret == 0) {"
    },
    {
        "line": 224,
        "fullcodeline": "ret = _kdc_add_KRB5SignedPath(context,"
    },
    {
        "line": 239,
        "fullcodeline": "if (rep.padata == NULL) {"
    },
    {
        "line": 117,
        "fullcodeline": "renew = min(renew, *client->entry.max_renew);"
    },
    {
        "line": 119,
        "fullcodeline": "renew = min(renew, *server->entry.max_renew);"
    },
    {
        "line": 163,
        "fullcodeline": "et.authorization_data = calloc(1, sizeof(*et.authorization_data));"
    },
    {
        "line": 171,
        "fullcodeline": "ret = add_AuthorizationData(et.authorization_data, &auth_data->val[i]);"
    },
    {
        "line": 240,
        "fullcodeline": "ret = ENOMEM;"
    },
    {
        "line": 164,
        "fullcodeline": "if (et.authorization_data == NULL) {"
    },
    {
        "line": 181,
        "fullcodeline": "if (et.authorization_data->len == 1) {"
    },
    {
        "line": 165,
        "fullcodeline": "ret = ENOMEM;"
    },
    {
        "line": 166,
        "fullcodeline": "krb5_set_error_message(context, ret, \"malloc: out of memory\");"
    },
    {
        "line": 173,
        "fullcodeline": "krb5_set_error_message(context, ret, \"malloc: out of memory\");"
    },
    {
        "line": 182,
        "fullcodeline": "free_AuthorizationData(et.authorization_data);"
    },
    {
        "line": 183,
        "fullcodeline": "free(et.authorization_data);"
    },
    {
        "line": 184,
        "fullcodeline": "et.authorization_data = NULL;"
    },
    {
        "line": 71,
        "fullcodeline": "GLOBAL_FORCE_TRANSITED_CHECK ||"
    },
    {
        "line": 75,
        "fullcodeline": "GLOBAL_ALLOW_DISABLE_TRANSITED_CHECK),"
    },
    {
        "line": 186,
        "fullcodeline": "AuthorizationData *ad = et.authorization_data;"
    },
    {
        "line": 188,
        "fullcodeline": "ad->len--;"
    },
    {
        "line": 187,
        "fullcodeline": "free_AuthorizationDataElement(&ad->val[ad->len - 1]);"
    }
]