[
    {
        "line": 26,
        "fullcodeline": "log.info(\"User %s is locked. Sending them an email.\", user.username)"
    },
    {
        "line": 29,
        "fullcodeline": "password_policy = config.get(\"password_policy\", {})"
    },
    {
        "line": 30,
        "fullcodeline": "minutes_between_blocked_emails = password_policy.get("
    },
    {
        "line": 34,
        "fullcodeline": "email_sent_recently = user.last_email_failed_login_sent and ("
    },
    {
        "line": 43,
        "fullcodeline": "smtp_settings = config.get(\"smtp\", {})"
    },
    {
        "line": 44,
        "fullcodeline": "email_from = smtp_settings.get(\"email_from\", DEFAULT_EMAIL_FROM_ADDRESS)"
    },
    {
        "line": 45,
        "fullcodeline": "support_email = config.get(\"support_email\", DEFAULT_SUPPORT_EMAIL_ADDRESS)"
    },
    {
        "line": 47,
        "fullcodeline": "max_failed_attempts = password_policy.get("
    },
    {
        "line": 69,
        "fullcodeline": "user.last_email_failed_login_sent = dt.datetime.now()"
    },
    {
        "line": 59,
        "fullcodeline": "with app.app_context():"
    },
    {
        "line": 35,
        "fullcodeline": "dt.datetime.now()"
    },
    {
        "line": 50,
        "fullcodeline": "template_vars = {"
    },
    {
        "line": 36,
        "fullcodeline": "< user.last_email_failed_login_sent"
    },
    {
        "line": 37,
        "fullcodeline": "+ dt.timedelta(minutes=minutes_between_blocked_emails)"
    },
    {
        "line": 54,
        "fullcodeline": "\"time\": dt.datetime.now(dt.timezone.utc),"
    },
    {
        "line": 63,
        "fullcodeline": "recipients=[user.email],"
    },
    {
        "line": 64,
        "fullcodeline": "text_body=render_template(\"mail/blocked_account.txt\", **template_vars),"
    },
    {
        "line": 65,
        "fullcodeline": "html_body=render_template(\"mail/blocked_account.html\", **template_vars),"
    }
]