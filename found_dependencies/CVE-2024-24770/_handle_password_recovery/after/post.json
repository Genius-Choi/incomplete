[
    {
        "line": 26,
        "fullcodeline": "password_policy = config.get(\"password_policy\", {})"
    },
    {
        "line": 27,
        "fullcodeline": "minutes_between_password_reset_emails = password_policy.get("
    },
    {
        "line": 31,
        "fullcodeline": "smtp_settings = config.get(\"smtp\", {})"
    },
    {
        "line": 32,
        "fullcodeline": "minutes_token_valid = smtp_settings.get("
    },
    {
        "line": 35,
        "fullcodeline": "expires = dt.timedelta(minutes=minutes_token_valid)"
    },
    {
        "line": 36,
        "fullcodeline": "email_from = smtp_settings.get(\"email_from\", DEFAULT_EMAIL_FROM_ADDRESS)"
    },
    {
        "line": 37,
        "fullcodeline": "support_email = config.get(\"support_email\", DEFAULT_SUPPORT_EMAIL_ADDRESS)"
    },
    {
        "line": 49,
        "fullcodeline": "log.debug(\"Password reset requested for '%s'\", user.username)"
    },
    {
        "line": 52,
        "fullcodeline": "email_sent_recently = user.last_email_recover_password_sent and ("
    },
    {
        "line": 87,
        "fullcodeline": "user.last_email_recover_password_sent = dt.datetime.now()"
    },
    {
        "line": 88,
        "fullcodeline": "user.save()"
    },
    {
        "line": 61,
        "fullcodeline": "with app.app_context():"
    },
    {
        "line": 40,
        "fullcodeline": "user = User.get_by_username(username) if username else User.get_by_email(email)"
    },
    {
        "line": 53,
        "fullcodeline": "dt.datetime.now()"
    },
    {
        "line": 58,
        "fullcodeline": "log.info(\"Skipping sending password reset email to '%s'\", user.username)"
    },
    {
        "line": 54,
        "fullcodeline": "< user.last_email_recover_password_sent"
    },
    {
        "line": 63,
        "fullcodeline": "reset_token = create_access_token({\"id\": str(user.id)}, expires_delta=expires)"
    },
    {
        "line": 64,
        "fullcodeline": "log.info(\"Sending password reset email to '%s'\", user.email)"
    },
    {
        "line": 65,
        "fullcodeline": "mail.send_email("
    },
    {
        "line": 42,
        "fullcodeline": "account_name = username or email"
    },
    {
        "line": 43,
        "fullcodeline": "log.info("
    },
    {
        "line": 55,
        "fullcodeline": "+ dt.timedelta(minutes=minutes_between_password_reset_emails)"
    },
    {
        "line": 66,
        "fullcodeline": "f\"Password reset {APPNAME}\","
    },
    {
        "line": 68,
        "fullcodeline": "recipients=[user.email],"
    },
    {
        "line": 69,
        "fullcodeline": "text_body=render_template("
    },
    {
        "line": 76,
        "fullcodeline": "html_body=render_template("
    }
]