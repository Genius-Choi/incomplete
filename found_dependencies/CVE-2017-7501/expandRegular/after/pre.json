[
    {
        "line": 3,
        "fullcodeline": "FD_t wfd = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "mode_t old_umask = umask(0577);"
    },
    {
        "line": 9,
        "fullcodeline": "wfd = Fopen(dest, exclusive ? \"wx.ufdio\" : \"a.ufdio\");"
    },
    {
        "line": 10,
        "fullcodeline": "umask(old_umask);"
    },
    {
        "line": 18,
        "fullcodeline": "if (Ferror(wfd)) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (!nocontent)"
    },
    {
        "line": 13,
        "fullcodeline": "if (!exclusive && wfd != NULL && !linkSane(wfd, dest)) {"
    },
    {
        "line": 19,
        "fullcodeline": "rc = RPMERR_OPEN_FAILED;"
    },
    {
        "line": 24,
        "fullcodeline": "rc = rpmfiArchiveReadToFilePsm(fi, wfd, nodigest, psm);"
    },
    {
        "line": 27,
        "fullcodeline": "int myerrno = errno;"
    },
    {
        "line": 28,
        "fullcodeline": "Fclose(wfd);"
    },
    {
        "line": 29,
        "fullcodeline": "errno = myerrno;"
    },
    {
        "line": 14,
        "fullcodeline": "rc = RPMERR_OPEN_FAILED;"
    }
]