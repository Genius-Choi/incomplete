[
    {
        "line": 3,
        "fullcodeline": "filename = os.path.expanduser(config.get(\"rights\", \"file\"))"
    },
    {
        "line": 4,
        "fullcodeline": "rights_type = config.get(\"rights\", \"type\").lower()"
    },
    {
        "line": 6,
        "fullcodeline": "user_escaped = re.escape(user)"
    },
    {
        "line": 7,
        "fullcodeline": "collection_url_escaped = re.escape(collection_url)"
    },
    {
        "line": 8,
        "fullcodeline": "regex = ConfigParser({\"login\": user_escaped, \"path\": collection_url_escaped})"
    },
    {
        "line": 9,
        "fullcodeline": "if rights_type in DEFINED_RIGHTS:"
    },
    {
        "line": 21,
        "fullcodeline": "for section in regex.sections():"
    },
    {
        "line": 11,
        "fullcodeline": "regex.readfp(StringIO(DEFINED_RIGHTS[rights_type]))"
    },
    {
        "line": 10,
        "fullcodeline": "log.LOGGER.debug(\"Rights type '%s'\" % rights_type)"
    },
    {
        "line": 12,
        "fullcodeline": "elif rights_type == \"from_file\":"
    },
    {
        "line": 22,
        "fullcodeline": "re_user = regex.get(section, \"user\")"
    },
    {
        "line": 23,
        "fullcodeline": "re_collection = regex.get(section, \"collection\")"
    },
    {
        "line": 27,
        "fullcodeline": "user_match = re.match(re_user, user)"
    },
    {
        "line": 24,
        "fullcodeline": "log.LOGGER.debug("
    },
    {
        "line": 13,
        "fullcodeline": "log.LOGGER.debug(\"Reading rights from file %s\" % filename)"
    },
    {
        "line": 14,
        "fullcodeline": "if not regex.read(filename):"
    },
    {
        "line": 18,
        "fullcodeline": "log.LOGGER.error(\"Unknown rights type '%s'\" % rights_type)"
    },
    {
        "line": 25,
        "fullcodeline": "\"Test if '%s:%s' matches against '%s:%s' from section '%s'\" % ("
    },
    {
        "line": 29,
        "fullcodeline": "re_collection = re_collection.format(*user_match.groups())"
    },
    {
        "line": 30,
        "fullcodeline": "if re.match(re_collection, collection_url):"
    },
    {
        "line": 15,
        "fullcodeline": "log.LOGGER.error(\"File '%s' not found for rights\" % filename)"
    },
    {
        "line": 31,
        "fullcodeline": "log.LOGGER.debug(\"Section '%s' matches\" % section)"
    },
    {
        "line": 35,
        "fullcodeline": "log.LOGGER.debug(\"Section '%s' does not match\" % section)"
    },
    {
        "line": 32,
        "fullcodeline": "if permission in regex.get(section, \"permission\"):"
    }
]