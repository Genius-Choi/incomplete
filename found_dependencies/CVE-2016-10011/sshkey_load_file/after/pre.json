[
    {
        "line": 3,
        "fullcodeline": "u_char buf[1024];"
    },
    {
        "line": 6,
        "fullcodeline": "int r, dontmax = 0;"
    },
    {
        "line": 44,
        "fullcodeline": "r = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "if (fstat(fd, &st) < 0)"
    },
    {
        "line": 48,
        "fullcodeline": "if (r != 0)"
    },
    {
        "line": 10,
        "fullcodeline": "if ((st.st_mode & (S_IFSOCK|S_IFCHR|S_IFIFO)) == 0 &&"
    },
    {
        "line": 11,
        "fullcodeline": "st.st_size > MAX_KEY_FILE_SIZE)"
    },
    {
        "line": 18,
        "fullcodeline": "if ((st.st_mode & S_IFREG) == 0 || st.st_size <= 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "st.st_size = 64*1024; /* 64k should be enough for anyone :) */"
    },
    {
        "line": 20,
        "fullcodeline": "dontmax = 1;"
    },
    {
        "line": 22,
        "fullcodeline": "if ((r = sshbuf_allocate(blob, st.st_size)) != 0 ||"
    },
    {
        "line": 23,
        "fullcodeline": "(dontmax && (r = sshbuf_set_max_size(blob, st.st_size)) != 0))"
    },
    {
        "line": 39,
        "fullcodeline": "if ((st.st_mode & (S_IFSOCK|S_IFCHR|S_IFIFO)) == 0 &&"
    },
    {
        "line": 40,
        "fullcodeline": "st.st_size != (off_t)sshbuf_len(blob)) {"
    },
    {
        "line": 41,
        "fullcodeline": "r = SSH_ERR_FILE_CHANGED;"
    },
    {
        "line": 26,
        "fullcodeline": "if ((len = atomicio(read, fd, buf, sizeof(buf))) == 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "r = SSH_ERR_SYSTEM_ERROR;"
    },
    {
        "line": 32,
        "fullcodeline": "if ((r = sshbuf_put(blob, buf, len)) != 0)"
    },
    {
        "line": 34,
        "fullcodeline": "if (sshbuf_len(blob) > MAX_KEY_FILE_SIZE) {"
    },
    {
        "line": 35,
        "fullcodeline": "r = SSH_ERR_INVALID_FORMAT;"
    },
    {
        "line": 27,
        "fullcodeline": "if (errno == EPIPE)"
    }
]