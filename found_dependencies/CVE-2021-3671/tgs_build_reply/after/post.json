[
    {
        "line": 11,
        "fullcodeline": "krb5_context context = priv->context;"
    },
    {
        "line": 12,
        "fullcodeline": "krb5_kdc_configuration *config = priv->config;"
    },
    {
        "line": 13,
        "fullcodeline": "KDC_REQ *req = &priv->req;"
    },
    {
        "line": 15,
        "fullcodeline": "const char *from = priv->from;"
    },
    {
        "line": 17,
        "fullcodeline": "krb5_principal cp = NULL, sp = NULL, rsp = NULL, tp = NULL, dp = NULL;"
    },
    {
        "line": 18,
        "fullcodeline": "krb5_principal krbtgt_out_principal = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "char *spn = NULL, *cpn = NULL, *tpn = NULL, *dpn = NULL, *krbtgt_out_n = NULL;"
    },
    {
        "line": 20,
        "fullcodeline": "hdb_entry_ex *server = NULL, *client = NULL, *s4u2self_impersonated_client = NULL;"
    },
    {
        "line": 22,
        "fullcodeline": "krb5_realm ref_realm = NULL;"
    },
    {
        "line": 23,
        "fullcodeline": "EncTicketPart *tgt = &ticket->ticket;"
    },
    {
        "line": 24,
        "fullcodeline": "krb5_principals spp = NULL;"
    },
    {
        "line": 29,
        "fullcodeline": "const char *tgt_realm = /* Realm of TGT issuer */"
    },
    {
        "line": 31,
        "fullcodeline": "const char *our_realm = /* Realm of this KDC */"
    },
    {
        "line": 33,
        "fullcodeline": "char **capath = NULL;"
    },
    {
        "line": 34,
        "fullcodeline": "size_t num_capath = 0;"
    },
    {
        "line": 36,
        "fullcodeline": "hdb_entry_ex *krbtgt_out = NULL;"
    },
    {
        "line": 43,
        "fullcodeline": "char opt_str[128];"
    },
    {
        "line": 44,
        "fullcodeline": "int signedpath = 0;"
    },
    {
        "line": 48,
        "fullcodeline": "int flags = HDB_F_FOR_TGS_REQ;"
    },
    {
        "line": 50,
        "fullcodeline": "memset(&sessionkey, 0, sizeof(sessionkey));"
    },
    {
        "line": 51,
        "fullcodeline": "memset(&adtkt, 0, sizeof(adtkt));"
    },
    {
        "line": 52,
        "fullcodeline": "krb5_data_zero(&rspac);"
    },
    {
        "line": 53,
        "fullcodeline": "memset(&enc_pa_data, 0, sizeof(enc_pa_data));"
    },
    {
        "line": 55,
        "fullcodeline": "s = b->sname;"
    },
    {
        "line": 56,
        "fullcodeline": "r = b->realm;"
    },
    {
        "line": 144,
        "fullcodeline": "_krb5_principalname2krb5_principal(context, &sp, *s, r);"
    },
    {
        "line": 145,
        "fullcodeline": "ret = krb5_unparse_name(context, sp, &priv->sname);"
    },
    {
        "line": 148,
        "fullcodeline": "spn = priv->sname;"
    },
    {
        "line": 149,
        "fullcodeline": "_krb5_principalname2krb5_principal(context, &cp, tgt->cname, tgt->crealm);"
    },
    {
        "line": 150,
        "fullcodeline": "ret = krb5_unparse_name(context, cp, &priv->cname);"
    },
    {
        "line": 153,
        "fullcodeline": "cpn = priv->cname;"
    },
    {
        "line": 154,
        "fullcodeline": "unparse_flags (KDCOptions2int(b->kdc_options),"
    },
    {
        "line": 170,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, sp,"
    },
    {
        "line": 173,
        "fullcodeline": "priv->server = server;"
    },
    {
        "line": 362,
        "fullcodeline": "ret = hdb_enctype2key(context, &krbtgt->entry, NULL, /* XXX use the right kvno! */"
    },
    {
        "line": 378,
        "fullcodeline": "ret = krb5_make_principal(context,"
    },
    {
        "line": 390,
        "fullcodeline": "ret = krb5_unparse_name(context, krbtgt_out_principal, &krbtgt_out_n);"
    },
    {
        "line": 398,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, krbtgt_out_principal,"
    },
    {
        "line": 433,
        "fullcodeline": "ret = _kdc_get_preferred_key(context, config, krbtgt_out, krbtgt_out_n,"
    },
    {
        "line": 442,
        "fullcodeline": "ret = hdb_enctype2key(context, &krbtgt_out->entry, NULL,"
    },
    {
        "line": 471,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, cp, HDB_F_GET_CLIENT | flags,"
    },
    {
        "line": 473,
        "fullcodeline": "flags &= ~HDB_F_SYNTHETIC_OK;"
    },
    {
        "line": 474,
        "fullcodeline": "priv->client = client;"
    },
    {
        "line": 511,
        "fullcodeline": "ret = check_PAC(context, config, cp, NULL,"
    },
    {
        "line": 527,
        "fullcodeline": "ret = check_KRB5SignedPath(context,"
    },
    {
        "line": 549,
        "fullcodeline": "tp = cp;"
    },
    {
        "line": 550,
        "fullcodeline": "tpn = cpn;"
    },
    {
        "line": 919,
        "fullcodeline": "ret = kdc_check_flags(priv, FALSE);"
    },
    {
        "line": 992,
        "fullcodeline": "ret = tgs_make_reply(priv,"
    },
    {
        "line": 1015,
        "fullcodeline": "free(dpn);"
    },
    {
        "line": 1016,
        "fullcodeline": "free(krbtgt_out_n);"
    },
    {
        "line": 1017,
        "fullcodeline": "_krb5_free_capath(context, capath);"
    },
    {
        "line": 1019,
        "fullcodeline": "krb5_data_free(&rspac);"
    },
    {
        "line": 1020,
        "fullcodeline": "krb5_free_keyblock_contents(context, &sessionkey);"
    },
    {
        "line": 1032,
        "fullcodeline": "krb5_free_principal(context, cp);"
    },
    {
        "line": 1033,
        "fullcodeline": "krb5_free_principal(context, dp);"
    },
    {
        "line": 1034,
        "fullcodeline": "krb5_free_principal(context, sp);"
    },
    {
        "line": 1035,
        "fullcodeline": "krb5_free_principal(context, krbtgt_out_principal);"
    },
    {
        "line": 1036,
        "fullcodeline": "free(ref_realm);"
    },
    {
        "line": 1037,
        "fullcodeline": "free_METHOD_DATA(&enc_pa_data);"
    },
    {
        "line": 1039,
        "fullcodeline": "free_EncTicketPart(&adtkt);"
    },
    {
        "line": 30,
        "fullcodeline": "krb5_principal_get_realm(context, krbtgt->entry.principal);"
    },
    {
        "line": 32,
        "fullcodeline": "krb5_principal_get_comp_string(context, krbtgt->entry.principal, 1);"
    },
    {
        "line": 174,
        "fullcodeline": "if (ret == HDB_ERR_NOT_FOUND_HERE) {"
    },
    {
        "line": 347,
        "fullcodeline": "ret = krb5_generate_random_keyblock(context, etype, &sessionkey);"
    },
    {
        "line": 419,
        "fullcodeline": "if (strcmp(krb5_principal_get_realm(context, server->entry.principal),"
    },
    {
        "line": 463,
        "fullcodeline": "ret = krb5_ticket_get_authorization_data_type(context, ticket,"
    },
    {
        "line": 475,
        "fullcodeline": "if(ret == HDB_ERR_NOT_FOUND_HERE) {"
    },
    {
        "line": 753,
        "fullcodeline": "if (client != NULL"
    },
    {
        "line": 923,
        "fullcodeline": "if((b->kdc_options.validate || b->kdc_options.renew) &&"
    },
    {
        "line": 934,
        "fullcodeline": "if (!_kdc_check_addresses(priv, tgt->caddr, from_addr)) {"
    },
    {
        "line": 947,
        "fullcodeline": "if (is_anon_tgs_request_p(b, tgt)) {"
    },
    {
        "line": 1013,
        "fullcodeline": "if (tpn != cpn)"
    },
    {
        "line": 1030,
        "fullcodeline": "if (tp && tp != cp)"
    },
    {
        "line": 65,
        "fullcodeline": "flags |= HDB_F_CANON;"
    },
    {
        "line": 72,
        "fullcodeline": "krb5uint32 second_kvno = 0;"
    },
    {
        "line": 73,
        "fullcodeline": "krb5uint32 *kvno_ptr = NULL;"
    },
    {
        "line": 93,
        "fullcodeline": "_krb5_principalname2krb5_principal(context, &p, t->sname, t->realm);"
    },
    {
        "line": 94,
        "fullcodeline": "ret = krb5_unparse_name(context, p, &tpn);"
    },
    {
        "line": 101,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, p,"
    },
    {
        "line": 104,
        "fullcodeline": "krb5_free_principal(context, p);"
    },
    {
        "line": 112,
        "fullcodeline": "ret = hdb_enctype2key(context, &uu->entry, NULL,"
    },
    {
        "line": 121,
        "fullcodeline": "ret = krb5_decrypt_ticket(context, t, &uukey->key, &adtkt, 0);"
    },
    {
        "line": 122,
        "fullcodeline": "_kdc_free_ent(context, uu);"
    },
    {
        "line": 129,
        "fullcodeline": "ret = verify_flags(context, config, &adtkt, tpn);"
    },
    {
        "line": 136,
        "fullcodeline": "s = &adtkt.cname;"
    },
    {
        "line": 137,
        "fullcodeline": "r = adtkt.crealm;"
    },
    {
        "line": 158,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 171,
        "fullcodeline": "HDB_F_GET_SERVER | HDB_F_DELAY_NEW_KEYS | flags,"
    },
    {
        "line": 175,
        "fullcodeline": "kdc_log(context, config, 5, \"target %s does not have secrets at this KDC, need to proxy\", spn);"
    },
    {
        "line": 176,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"Target not found here\");"
    },
    {
        "line": 292,
        "fullcodeline": "rsp = server->entry.principal;"
    },
    {
        "line": 365,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 367,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 385,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 392,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 401,
        "fullcodeline": "char *ktpn = NULL;"
    },
    {
        "line": 402,
        "fullcodeline": "ret = krb5_unparse_name(context, krbtgt->entry.principal, &ktpn);"
    },
    {
        "line": 403,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 407,
        "fullcodeline": "free(ktpn);"
    },
    {
        "line": 408,
        "fullcodeline": "ret = KRB5KRB_AP_ERR_NOT_US;"
    },
    {
        "line": 422,
        "fullcodeline": "ret = krb5_unparse_name(context, krbtgt_out->entry.principal, &ktpn);"
    },
    {
        "line": 423,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 428,
        "fullcodeline": "ret = KRB5KRB_AP_ERR_NOT_US;"
    },
    {
        "line": 429,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"Request with wrong TGT\");"
    },
    {
        "line": 436,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 438,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 445,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 447,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 466,
        "fullcodeline": "if (ret == 0) {"
    },
    {
        "line": 517,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 518,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"PAC check failed\");"
    },
    {
        "line": 519,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 522,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 535,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 536,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"KRB5SignedPath check failed\");"
    },
    {
        "line": 537,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 540,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 554,
        "fullcodeline": "int i = 0;"
    },
    {
        "line": 556,
        "fullcodeline": "sdata = _kdc_find_padata(req, &i, KRB5_PADATA_FOR_USER);"
    },
    {
        "line": 757,
        "fullcodeline": "&& b->kdc_options.enc_tkt_in_skey == 0)"
    },
    {
        "line": 759,
        "fullcodeline": "int ad_signedpath = 0;"
    },
    {
        "line": 778,
        "fullcodeline": "ret = hdb_enctype2key(context, &client->entry,"
    },
    {
        "line": 787,
        "fullcodeline": "ret = krb5_decrypt_ticket(context, t, &clientkey->key, &adtkt, 0);"
    },
    {
        "line": 797,
        "fullcodeline": "ret = _krb5_principalname2krb5_principal(context,"
    },
    {
        "line": 804,
        "fullcodeline": "ret = krb5_unparse_name(context, tp, &tpn);"
    },
    {
        "line": 808,
        "fullcodeline": "_kdc_audit_addkv((kdc_request_t)priv, 0, \"impersonatee\", \"%s\", tpn);"
    },
    {
        "line": 810,
        "fullcodeline": "ret = _krb5_principalname2krb5_principal(context,"
    },
    {
        "line": 817,
        "fullcodeline": "ret = krb5_unparse_name(context, dp, &dpn);"
    },
    {
        "line": 833,
        "fullcodeline": "ret = check_constrained_delegation(context, config, clientdb,"
    },
    {
        "line": 844,
        "fullcodeline": "ret = verify_flags(context, config, &adtkt, tpn);"
    },
    {
        "line": 851,
        "fullcodeline": "krb5_data_free(&rspac);"
    },
    {
        "line": 859,
        "fullcodeline": "ret = check_PAC(context, config, tp, dp,"
    },
    {
        "line": 879,
        "fullcodeline": "ret = check_KRB5SignedPath(context,"
    },
    {
        "line": 911,
        "fullcodeline": "kdc_log(context, config, 4, \"constrained delegation for %s \""
    },
    {
        "line": 924,
        "fullcodeline": "!krb5_principal_compare(context,"
    },
    {
        "line": 927,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"Inconsistent request\");"
    },
    {
        "line": 928,
        "fullcodeline": "kdc_log(context, config, 4, \"Inconsistent request.\");"
    },
    {
        "line": 929,
        "fullcodeline": "ret = KRB5KDC_ERR_SERVER_NOMATCH;"
    },
    {
        "line": 948,
        "fullcodeline": "ret = _kdc_check_anon_policy(priv);"
    },
    {
        "line": 961,
        "fullcodeline": "kdc_log(context, config, 3,"
    },
    {
        "line": 964,
        "fullcodeline": "ret = krb5_crypto_init(context, &sessionkey, 0, &crypto);"
    },
    {
        "line": 968,
        "fullcodeline": "ret = build_server_referral(context, config, crypto, ref_realm,"
    },
    {
        "line": 970,
        "fullcodeline": "krb5_crypto_destroy(context, crypto);"
    },
    {
        "line": 977,
        "fullcodeline": "pa.padata_type = KRB5_PADATA_SERVER_REFERRAL;"
    },
    {
        "line": 979,
        "fullcodeline": "ret = add_METHOD_DATA(&enc_pa_data, &pa);"
    },
    {
        "line": 980,
        "fullcodeline": "krb5_data_free(&pa.padata_value);"
    },
    {
        "line": 1014,
        "fullcodeline": "free(tpn);"
    },
    {
        "line": 1022,
        "fullcodeline": "_kdc_free_ent(context, krbtgt_out);"
    },
    {
        "line": 1024,
        "fullcodeline": "_kdc_free_ent(context, server);"
    },
    {
        "line": 1026,
        "fullcodeline": "_kdc_free_ent(context, client);"
    },
    {
        "line": 1028,
        "fullcodeline": "_kdc_free_ent(context, s4u2self_impersonated_client);"
    },
    {
        "line": 1031,
        "fullcodeline": "krb5_free_principal(context, tp);"
    },
    {
        "line": 75,
        "fullcodeline": "if(b->additional_tickets == NULL ||"
    },
    {
        "line": 85,
        "fullcodeline": "if(!get_krbtgt_realm(&t->sname)){"
    },
    {
        "line": 162,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 294,
        "fullcodeline": "rsp = sp;"
    },
    {
        "line": 305,
        "fullcodeline": "ekey = &adtkt.key;"
    },
    {
        "line": 318,
        "fullcodeline": "etype = b->etype.val[i];"
    },
    {
        "line": 319,
        "fullcodeline": "kvno = 0;"
    },
    {
        "line": 406,
        "fullcodeline": "krbtgt_out_n, spn, (ret == 0) ? ktpn : \"<unknown>\");"
    },
    {
        "line": 420,
        "fullcodeline": "krb5_principal_get_realm(context, krbtgt_out->entry.principal)) != 0) {"
    },
    {
        "line": 425,
        "fullcodeline": "(ret == 0) ? ktpn : \"<unknown>\");"
    },
    {
        "line": 426,
        "fullcodeline": "if(ret == 0)"
    },
    {
        "line": 467,
        "fullcodeline": "krb5_data_free(&verified_cas);"
    },
    {
        "line": 468,
        "fullcodeline": "flags |= HDB_F_SYNTHETIC_OK;"
    },
    {
        "line": 767,
        "fullcodeline": "if (!signedpath) {"
    },
    {
        "line": 822,
        "fullcodeline": "if (adtkt.flags.forwardable == 0) {"
    },
    {
        "line": 899,
        "fullcodeline": "if (!ad_signedpath) {"
    },
    {
        "line": 76,
        "fullcodeline": "b->additional_tickets->len == 0){"
    },
    {
        "line": 77,
        "fullcodeline": "ret = KRB5KDC_ERR_BADOPTION; /* ? */"
    },
    {
        "line": 78,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 80,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 86,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 88,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 90,
        "fullcodeline": "ret = KRB5KDC_ERR_POLICY;"
    },
    {
        "line": 99,
        "fullcodeline": "kvno_ptr = &second_kvno;"
    },
    {
        "line": 108,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 115,
        "fullcodeline": "_kdc_free_ent(context, uu);"
    },
    {
        "line": 116,
        "fullcodeline": "ret = KRB5KDC_ERR_ETYPE_NOSUPP; /* XXX */"
    },
    {
        "line": 117,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 124,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 131,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 138,
        "fullcodeline": "} else if (s == NULL) {"
    },
    {
        "line": 178,
        "fullcodeline": "} else if (ret == HDB_ERR_WRONG_REALM) {"
    },
    {
        "line": 306,
        "fullcodeline": "for(i = 0; i < b->etype.len; i++)"
    },
    {
        "line": 309,
        "fullcodeline": "if(i == b->etype.len) {"
    },
    {
        "line": 323,
        "fullcodeline": "ret = _kdc_find_etype(priv, krb5_principal_is_krbtgt(context, sp)"
    },
    {
        "line": 334,
        "fullcodeline": "ret = _kdc_get_preferred_key(context, config, server, spn,"
    },
    {
        "line": 343,
        "fullcodeline": "ekey = &skey->key;"
    },
    {
        "line": 427,
        "fullcodeline": "free(ktpn);"
    },
    {
        "line": 564,
        "fullcodeline": "ret = decode_PA_S4U2Self(sdata->padata_value.data,"
    },
    {
        "line": 583,
        "fullcodeline": "ret = _krb5_s4u2self_to_checksumdata(context, &self, &datack);"
    },
    {
        "line": 587,
        "fullcodeline": "ret = krb5_crypto_init(context, &tgt->key, 0, &crypto);"
    },
    {
        "line": 625,
        "fullcodeline": "krb5_data_free(&datack);"
    },
    {
        "line": 626,
        "fullcodeline": "krb5_crypto_destroy(context, crypto);"
    },
    {
        "line": 638,
        "fullcodeline": "ret = _krb5_principalname2krb5_principal(context,"
    },
    {
        "line": 642,
        "fullcodeline": "free_PA_S4U2Self(&self);"
    },
    {
        "line": 646,
        "fullcodeline": "ret = krb5_unparse_name(context, tp, &tpn);"
    },
    {
        "line": 654,
        "fullcodeline": "ret = _kdc_db_fetch(context, config, tp, HDB_F_GET_CLIENT | flags,"
    },
    {
        "line": 680,
        "fullcodeline": "s4u2self_impersonated_client->entry.flags.require_pwchange = FALSE;"
    },
    {
        "line": 682,
        "fullcodeline": "s4u2self_impersonated_client->entry.pw_end = NULL;"
    },
    {
        "line": 685,
        "fullcodeline": "imp_req.client = s4u2self_impersonated_client;"
    },
    {
        "line": 686,
        "fullcodeline": "imp_req.client_princ = tp;"
    },
    {
        "line": 688,
        "fullcodeline": "ret = kdc_check_flags(&imp_req, FALSE);"
    },
    {
        "line": 722,
        "fullcodeline": "ret = check_s4u2self(context, config, clientdb, client, sp);"
    },
    {
        "line": 744,
        "fullcodeline": "kdc_log(context, config, 4, \"s4u2self %s impersonating %s to \""
    },
    {
        "line": 755,
        "fullcodeline": "&& b->additional_tickets->len != 0"
    },
    {
        "line": 768,
        "fullcodeline": "ret = KRB5KDC_ERR_BADOPTION;"
    },
    {
        "line": 769,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"KRB5SignedPath missing\");"
    },
    {
        "line": 770,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 779,
        "fullcodeline": "hdb_kvno2keys(context, &client->entry,"
    },
    {
        "line": 783,
        "fullcodeline": "ret = KRB5KDC_ERR_ETYPE_NOSUPP; /* XXX */"
    },
    {
        "line": 789,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 791,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 823,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 825,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 829,
        "fullcodeline": "ret = KRB5KDC_ERR_BADOPTION;"
    },
    {
        "line": 836,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 838,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 846,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 865,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 866,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 868,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 872,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 887,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 888,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 893,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 894,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 900,
        "fullcodeline": "ret = KRB5KDC_ERR_BADOPTION;"
    },
    {
        "line": 901,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 906,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 936,
        "fullcodeline": "ret = KRB5KRB_AP_ERR_BADADDR;"
    },
    {
        "line": 937,
        "fullcodeline": "_kdc_audit_addkv((kdc_request_t)priv, 0, \"wrongaddr\", \"yes\");"
    },
    {
        "line": 938,
        "fullcodeline": "kdc_log(context, config, 4, \"Request from wrong address\");"
    },
    {
        "line": 939,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"Request from wrong address\");"
    },
    {
        "line": 972,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"Referral build failed\");"
    },
    {
        "line": 973,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 982,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 106,
        "fullcodeline": "if (ret == HDB_ERR_NOENTRY)"
    },
    {
        "line": 139,
        "fullcodeline": "ret = KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 140,
        "fullcodeline": "_kdc_set_e_text(r, \"No server in request\");"
    },
    {
        "line": 179,
        "fullcodeline": "free(ref_realm);"
    },
    {
        "line": 180,
        "fullcodeline": "ref_realm = strdup(server->entry.principal->realm);"
    },
    {
        "line": 186,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 190,
        "fullcodeline": "krb5_free_principal(context, sp);"
    },
    {
        "line": 191,
        "fullcodeline": "sp = NULL;"
    },
    {
        "line": 192,
        "fullcodeline": "ret = krb5_make_principal(context, &sp, r, KRB5_TGS_NAME,"
    },
    {
        "line": 196,
        "fullcodeline": "free(priv->sname);"
    },
    {
        "line": 197,
        "fullcodeline": "priv->sname = NULL;"
    },
    {
        "line": 198,
        "fullcodeline": "ret = krb5_unparse_name(context, sp, &priv->sname);"
    },
    {
        "line": 201,
        "fullcodeline": "spn = priv->sname;"
    },
    {
        "line": 310,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 312,
        "fullcodeline": "krb5_clear_error_message(context);"
    },
    {
        "line": 313,
        "fullcodeline": "ret = KRB5KDC_ERR_ETYPE_NOSUPP;"
    },
    {
        "line": 314,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 488,
        "fullcodeline": "krbtgt_realm = krb5_principal_get_realm(context, krbtgt_out->entry.principal);"
    },
    {
        "line": 499,
        "fullcodeline": "msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 500,
        "fullcodeline": "kdc_log(context, config, 4, \"Client not found in database: %s\", msg);"
    },
    {
        "line": 501,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"Client does not exist\");"
    },
    {
        "line": 502,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 574,
        "fullcodeline": "if (!krb5_checksum_is_keyed(context, self.cksum.cksumtype)) {"
    },
    {
        "line": 598,
        "fullcodeline": "if (self.cksum.cksumtype == CKSUMTYPE_HMAC_MD5) {"
    },
    {
        "line": 754,
        "fullcodeline": "&& b->additional_tickets != NULL"
    },
    {
        "line": 780,
        "fullcodeline": "t->enc_part.kvno ? * t->enc_part.kvno : 0),"
    },
    {
        "line": 107,
        "fullcodeline": "ret = KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 181,
        "fullcodeline": "if (ref_realm == NULL) {"
    },
    {
        "line": 328,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 330,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 337,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 339,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 490,
        "fullcodeline": "if(strcmp(krb5_principal_get_realm(context, cp), krbtgt_realm) == 0) {"
    },
    {
        "line": 568,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 570,
        "fullcodeline": "kdc_log(context, config, 4, \"Failed to decode PA-S4U2Self\");"
    },
    {
        "line": 575,
        "fullcodeline": "free_PA_S4U2Self(&self);"
    },
    {
        "line": 576,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 578,
        "fullcodeline": "kdc_log(context, config, 4, \"Reject PA-S4U2Self with unkeyed checksum\");"
    },
    {
        "line": 579,
        "fullcodeline": "ret = KRB5KRB_AP_ERR_INAPP_CKSUM;"
    },
    {
        "line": 589,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 590,
        "fullcodeline": "free_PA_S4U2Self(&self);"
    },
    {
        "line": 591,
        "fullcodeline": "krb5_data_free(&datack);"
    },
    {
        "line": 592,
        "fullcodeline": "kdc_log(context, config, 4, \"krb5_crypto_init failed: %s\", msg);"
    },
    {
        "line": 593,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 600,
        "fullcodeline": "unsigned char csdata[16];"
    },
    {
        "line": 604,
        "fullcodeline": "cs.checksum.data = &csdata;"
    },
    {
        "line": 606,
        "fullcodeline": "iov.data.data = datack.data;"
    },
    {
        "line": 607,
        "fullcodeline": "iov.data.length = datack.length;"
    },
    {
        "line": 608,
        "fullcodeline": "iov.flags = KRB5_CRYPTO_TYPE_DATA;"
    },
    {
        "line": 610,
        "fullcodeline": "ret = _krb5_HMAC_MD5_checksum(context, NULL, &crypto->key,"
    },
    {
        "line": 628,
        "fullcodeline": "const char *msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 629,
        "fullcodeline": "free_PA_S4U2Self(&self);"
    },
    {
        "line": 630,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 632,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 634,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 668,
        "fullcodeline": "msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 669,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 671,
        "fullcodeline": "kdc_log(context, config, 2,"
    },
    {
        "line": 674,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 694,
        "fullcodeline": "krb5_pac p = NULL;"
    },
    {
        "line": 695,
        "fullcodeline": "krb5_data_free(&rspac);"
    },
    {
        "line": 696,
        "fullcodeline": "ret = _kdc_pac_generate(context, s4u2self_impersonated_client, &p);"
    },
    {
        "line": 724,
        "fullcodeline": "kdc_log(context, config, 4, \"S4U2Self: %s is not allowed \""
    },
    {
        "line": 739,
        "fullcodeline": "str = \"[forwardable]\";"
    },
    {
        "line": 182,
        "fullcodeline": "ret = krb5_enomem(context);"
    },
    {
        "line": 493,
        "fullcodeline": "kdc_log(context, config, 4, \"Client no longer in database: %s\","
    },
    {
        "line": 495,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"Client no longer in HDB\");"
    },
    {
        "line": 503,
        "fullcodeline": "} else if (ret == 0 &&"
    },
    {
        "line": 613,
        "fullcodeline": "if (ret == 0 &&"
    },
    {
        "line": 618,
        "fullcodeline": "ret = krb5_verify_checksum(context,"
    },
    {
        "line": 666,
        "fullcodeline": "if (ret == HDB_ERR_NOENTRY)"
    },
    {
        "line": 704,
        "fullcodeline": "if (p != NULL) {"
    },
    {
        "line": 741,
        "fullcodeline": "b->kdc_options.forwardable = 0;"
    },
    {
        "line": 742,
        "fullcodeline": "str = \"\";"
    },
    {
        "line": 942,
        "fullcodeline": "_kdc_audit_addkv((kdc_request_t)priv, 0, \"wrongaddr\", \"yes\");"
    },
    {
        "line": 273,
        "fullcodeline": "msg = krb5_get_error_message(context, ret);"
    },
    {
        "line": 274,
        "fullcodeline": "kdc_log(context, config, 3,"
    },
    {
        "line": 276,
        "fullcodeline": "krb5_free_error_message(context, msg);"
    },
    {
        "line": 279,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 491,
        "fullcodeline": "if (ret == HDB_ERR_NOENTRY)"
    },
    {
        "line": 504,
        "fullcodeline": "(client->entry.flags.invalid || !client->entry.flags.client)) {"
    },
    {
        "line": 505,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv, \"Client has invalid bit set\");"
    },
    {
        "line": 506,
        "fullcodeline": "kdc_log(context, config, 4, \"Client has invalid bit set\");"
    },
    {
        "line": 507,
        "fullcodeline": "ret = KRB5KDC_ERR_POLICY;"
    },
    {
        "line": 614,
        "fullcodeline": "krb5_data_ct_cmp(&cs.checksum, &self.cksum.checksum) != 0)"
    },
    {
        "line": 615,
        "fullcodeline": "ret = KRB5KRB_AP_ERR_BAD_INTEGRITY;"
    },
    {
        "line": 667,
        "fullcodeline": "ret = KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 698,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 700,
        "fullcodeline": "kdc_log(context, config, 4, \"PAC generation failed for -- %s\","
    },
    {
        "line": 705,
        "fullcodeline": "ret = _krb5_pac_sign(context, p, ticket->ticket.authtime,"
    },
    {
        "line": 709,
        "fullcodeline": "krb5_pac_free(context, p);"
    },
    {
        "line": 209,
        "fullcodeline": "if ((req_rlm = get_krbtgt_realm(&sp->name)) != NULL) {"
    },
    {
        "line": 277,
        "fullcodeline": "if (ret == HDB_ERR_NOENTRY)"
    },
    {
        "line": 492,
        "fullcodeline": "ret = KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 221,
        "fullcodeline": "new_rlm = num_capath > 0 ? capath[--num_capath] : NULL;"
    },
    {
        "line": 278,
        "fullcodeline": "ret = KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN;"
    },
    {
        "line": 711,
        "fullcodeline": "kdc_log(context, config, 4, \"PAC signing failed for -- %s\","
    },
    {
        "line": 210,
        "fullcodeline": "if (capath == NULL) {"
    },
    {
        "line": 212,
        "fullcodeline": "ret2 = _krb5_find_capath(context, tgt->crealm, our_realm,"
    },
    {
        "line": 223,
        "fullcodeline": "kdc_log(context, config, 5, \"krbtgt from %s via %s for \""
    },
    {
        "line": 227,
        "fullcodeline": "free(ref_realm);"
    },
    {
        "line": 228,
        "fullcodeline": "ref_realm = strdup(new_rlm);"
    },
    {
        "line": 234,
        "fullcodeline": "krb5_free_principal(context, sp);"
    },
    {
        "line": 235,
        "fullcodeline": "sp = NULL;"
    },
    {
        "line": 236,
        "fullcodeline": "krb5_make_principal(context, &sp, r,"
    },
    {
        "line": 238,
        "fullcodeline": "free(priv->sname);"
    },
    {
        "line": 239,
        "fullcodeline": "priv->sname = NULL;"
    },
    {
        "line": 240,
        "fullcodeline": "ret = krb5_unparse_name(context, sp, &priv->sname);"
    },
    {
        "line": 243,
        "fullcodeline": "spn = priv->sname;"
    },
    {
        "line": 246,
        "fullcodeline": "} else if (need_referral(context, config, &b->kdc_options, sp, &realms)) {"
    },
    {
        "line": 229,
        "fullcodeline": "if (ref_realm == NULL) {"
    },
    {
        "line": 271,
        "fullcodeline": "krb5_free_host_realm(context, realms);"
    },
    {
        "line": 215,
        "fullcodeline": "ret = ret2;"
    },
    {
        "line": 216,
        "fullcodeline": "_kdc_audit_addreason((kdc_request_t)priv,"
    },
    {
        "line": 230,
        "fullcodeline": "ret = krb5_enomem(context);"
    },
    {
        "line": 247,
        "fullcodeline": "if (strcmp(realms[0], sp->realm) != 0) {"
    },
    {
        "line": 248,
        "fullcodeline": "kdc_log(context, config, 4,"
    },
    {
        "line": 252,
        "fullcodeline": "krb5_free_principal(context, sp);"
    },
    {
        "line": 253,
        "fullcodeline": "sp = NULL;"
    },
    {
        "line": 254,
        "fullcodeline": "krb5_make_principal(context, &sp, r, KRB5_TGS_NAME,"
    },
    {
        "line": 256,
        "fullcodeline": "free(priv->sname);"
    },
    {
        "line": 257,
        "fullcodeline": "priv->sname = NULL;"
    },
    {
        "line": 258,
        "fullcodeline": "ret = krb5_unparse_name(context, sp, &priv->sname);"
    },
    {
        "line": 263,
        "fullcodeline": "spn = priv->sname;"
    },
    {
        "line": 265,
        "fullcodeline": "free(ref_realm);"
    },
    {
        "line": 266,
        "fullcodeline": "ref_realm = strdup(realms[0]);"
    },
    {
        "line": 268,
        "fullcodeline": "krb5_free_host_realm(context, realms);"
    },
    {
        "line": 260,
        "fullcodeline": "krb5_free_host_realm(context, realms);"
    }
]