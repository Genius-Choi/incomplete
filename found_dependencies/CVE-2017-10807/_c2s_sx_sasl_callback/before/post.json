[
    {
        "line": 2,
        "fullcodeline": "c2s_t c2s = (c2s_t) cbarg;"
    },
    {
        "line": 5,
        "fullcodeline": "static char buf[3072];"
    },
    {
        "line": 6,
        "fullcodeline": "char mechbuf[256];"
    },
    {
        "line": 11,
        "fullcodeline": "char skey[44];"
    },
    {
        "line": 15,
        "fullcodeline": "jid_static(&jid,&jid_buf);"
    },
    {
        "line": 18,
        "fullcodeline": "assert(s != NULL);"
    },
    {
        "line": 19,
        "fullcodeline": "sprintf(skey, \"%d\", s->tag);"
    },
    {
        "line": 25,
        "fullcodeline": "sess = xhash_get(c2s->sessions, skey);"
    },
    {
        "line": 47,
        "fullcodeline": "strncpy(buf, my_realm, 256);"
    },
    {
        "line": 48,
        "fullcodeline": "*res = (void *)buf;"
    },
    {
        "line": 50,
        "fullcodeline": "log_debug(ZONE, \"sx sasl callback: get realm: realm is '%s'\", buf);"
    },
    {
        "line": 55,
        "fullcodeline": "assert(sess != NULL);"
    },
    {
        "line": 56,
        "fullcodeline": "creds = (sx_sasl_creds_t) arg;"
    },
    {
        "line": 58,
        "fullcodeline": "log_debug(ZONE, \"sx sasl callback: get pass (authnid=%s, realm=%s)\", creds->authnid, creds->realm);"
    },
    {
        "line": 69,
        "fullcodeline": "assert(sess != NULL);"
    },
    {
        "line": 70,
        "fullcodeline": "creds = (sx_sasl_creds_t) arg;"
    },
    {
        "line": 72,
        "fullcodeline": "log_debug(ZONE, \"sx sasl callback: check pass (authnid=%s, realm=%s)\", creds->authnid, creds->realm);"
    },
    {
        "line": 94,
        "fullcodeline": "assert(sess != NULL);"
    },
    {
        "line": 95,
        "fullcodeline": "creds = (sx_sasl_creds_t) arg;"
    },
    {
        "line": 127,
        "fullcodeline": "jid_reset(&jid, s->req_to, -1);"
    },
    {
        "line": 130,
        "fullcodeline": "jid_random_part(&jid, jid_NODE);"
    },
    {
        "line": 132,
        "fullcodeline": "strcpy(buf, jid.node);"
    },
    {
        "line": 134,
        "fullcodeline": "*res = (void *)buf;"
    },
    {
        "line": 140,
        "fullcodeline": "mech = (char *)arg;"
    },
    {
        "line": 142,
        "fullcodeline": "strncpy(mechbuf, mech, sizeof(mechbuf));"
    },
    {
        "line": 143,
        "fullcodeline": "mechbuf[sizeof(mechbuf)-1]='\\0';"
    },
    {
        "line": 147,
        "fullcodeline": "host = xhash_get(c2s->hosts, s->req_to);"
    },
    {
        "line": 177,
        "fullcodeline": "r = snprintf(buf, sizeof(buf), \"authreg.mechanisms.sasl.%s\",mechbuf);"
    },
    {
        "line": 30,
        "fullcodeline": "if(s->req_to == NULL)   /* this shouldn't happen */"
    },
    {
        "line": 60,
        "fullcodeline": "if(sess->host->ar->get_password && (sess->host->ar->get_password)("
    },
    {
        "line": 74,
        "fullcodeline": "if(sess->host->ar->check_password != NULL) {"
    },
    {
        "line": 82,
        "fullcodeline": "if(sess->host->ar->get_password != NULL) {"
    },
    {
        "line": 98,
        "fullcodeline": "if(creds->authzid == NULL || creds->authzid[0] == '\\0')"
    },
    {
        "line": 102,
        "fullcodeline": "if(jid_reset(&jid, creds->authzid, -1) == NULL)"
    },
    {
        "line": 106,
        "fullcodeline": "if(!s->req_to || (strcmp(jid.domain, s->req_to) != 0))"
    },
    {
        "line": 110,
        "fullcodeline": "if(jid.resource[0] != '\\0')"
    },
    {
        "line": 144,
        "fullcodeline": "for(i = 0; mechbuf[i]; i++) mechbuf[i] = tolower(mechbuf[i]);"
    },
    {
        "line": 148,
        "fullcodeline": "if(host == NULL) {"
    },
    {
        "line": 155,
        "fullcodeline": "if (strcmp(mechbuf, \"digest-md5\") == 0) {"
    },
    {
        "line": 169,
        "fullcodeline": "if (s->ssf>0) {"
    },
    {
        "line": 178,
        "fullcodeline": "if (r < -1 || r > sizeof(buf))"
    },
    {
        "line": 182,
        "fullcodeline": "if(config_get(c2s->config,buf) != NULL)"
    },
    {
        "line": 31,
        "fullcodeline": "my_realm = \"\";"
    },
    {
        "line": 62,
        "fullcodeline": "*res = buf;"
    },
    {
        "line": 149,
        "fullcodeline": "log_write(c2s->log, LOG_WARNING, \"SASL callback for non-existing host: %s\", s->req_to);"
    },
    {
        "line": 170,
        "fullcodeline": "r = snprintf(buf, sizeof(buf), \"authreg.ssl-mechanisms.sasl.%s\",mechbuf);"
    },
    {
        "line": 35,
        "fullcodeline": "host = xhash_get(c2s->hosts, s->req_to);"
    },
    {
        "line": 42,
        "fullcodeline": "my_realm = host->realm;"
    },
    {
        "line": 75,
        "fullcodeline": "if ((sess->host->ar->check_password)("
    },
    {
        "line": 83,
        "fullcodeline": "if ((sess->host->ar->get_password)(sess->host->ar, sess, (char *)creds->authnid, (creds->realm != NULL) ? (char *)creds->realm : \"\", buf) != 0)"
    },
    {
        "line": 86,
        "fullcodeline": "if (strcmp(creds->pass, buf)==0)"
    },
    {
        "line": 115,
        "fullcodeline": "if (sess->host->ar->user_authz_allowed(sess->host->ar, sess, (char *)creds->authnid, (char *)creds->realm, (char *)creds->authzid))"
    },
    {
        "line": 157,
        "fullcodeline": "if (host->ar->get_password == NULL)"
    },
    {
        "line": 171,
        "fullcodeline": "if (r < -1 || r > sizeof(buf))"
    },
    {
        "line": 173,
        "fullcodeline": "if(config_get(c2s->config,buf) != NULL)"
    },
    {
        "line": 36,
        "fullcodeline": "if(host == NULL) {"
    },
    {
        "line": 43,
        "fullcodeline": "if(my_realm == NULL)"
    },
    {
        "line": 61,
        "fullcodeline": "sess->host->ar, sess, (char *)creds->authnid, (creds->realm != NULL) ? (char *)creds->realm: \"\", buf) == 0) {"
    },
    {
        "line": 118,
        "fullcodeline": "if (strcmp(creds->authnid, jid.node) == 0 &&"
    },
    {
        "line": 159,
        "fullcodeline": "} else if (strcmp(mechbuf, \"plain\") == 0) {"
    },
    {
        "line": 37,
        "fullcodeline": "log_write(c2s->log, LOG_ERR, \"SASL callback for non-existing host: %s\", s->req_to);"
    },
    {
        "line": 38,
        "fullcodeline": "*res = (void *)NULL;"
    },
    {
        "line": 44,
        "fullcodeline": "my_realm = s->req_to;"
    },
    {
        "line": 76,
        "fullcodeline": "sess->host->ar, sess, (char *)creds->authnid, (creds->realm != NULL) ? (char *)creds->realm : \"\", (char *)creds->pass) == 0)"
    },
    {
        "line": 119,
        "fullcodeline": "(sess->host->ar->user_exists)(sess->host->ar, sess, jid.node, jid.domain))"
    },
    {
        "line": 161,
        "fullcodeline": "if (host->ar->get_password == NULL && host->ar->check_password == NULL)"
    }
]