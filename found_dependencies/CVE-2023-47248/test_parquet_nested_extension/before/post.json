[
    {
        "line": 3,
        "fullcodeline": "import pyarrow.parquet as pq"
    },
    {
        "line": 5,
        "fullcodeline": "ext_type = IntegerType()"
    },
    {
        "line": 6,
        "fullcodeline": "storage = pa.array([4, 5, 6, 7], type=pa.int64())"
    },
    {
        "line": 7,
        "fullcodeline": "ext_array = pa.ExtensionArray.from_storage(ext_type, storage)"
    },
    {
        "line": 10,
        "fullcodeline": "struct_array = pa.StructArray.from_arrays("
    },
    {
        "line": 14,
        "fullcodeline": "orig_table = pa.table({'structs': struct_array})"
    },
    {
        "line": 15,
        "fullcodeline": "filename = tmpdir / 'struct_of_ext.parquet'"
    },
    {
        "line": 16,
        "fullcodeline": "pq.write_table(orig_table, filename)"
    },
    {
        "line": 18,
        "fullcodeline": "table = pq.read_table(filename)"
    },
    {
        "line": 19,
        "fullcodeline": "assert table.column(0).type == struct_array.type"
    },
    {
        "line": 20,
        "fullcodeline": "assert table == orig_table"
    },
    {
        "line": 23,
        "fullcodeline": "list_array = pa.ListArray.from_arrays([0, 1, None, 3], ext_array)"
    },
    {
        "line": 25,
        "fullcodeline": "orig_table = pa.table({'lists': list_array})"
    },
    {
        "line": 26,
        "fullcodeline": "filename = tmpdir / 'list_of_ext.parquet'"
    },
    {
        "line": 27,
        "fullcodeline": "pq.write_table(orig_table, filename)"
    },
    {
        "line": 29,
        "fullcodeline": "table = pq.read_table(filename)"
    },
    {
        "line": 30,
        "fullcodeline": "assert table.column(0).type == list_array.type"
    },
    {
        "line": 31,
        "fullcodeline": "assert table == orig_table"
    },
    {
        "line": 34,
        "fullcodeline": "list_array = pa.LargeListArray.from_arrays([0, 1, None, 3], ext_array)"
    },
    {
        "line": 36,
        "fullcodeline": "orig_table = pa.table({'lists': list_array})"
    },
    {
        "line": 37,
        "fullcodeline": "filename = tmpdir / 'list_of_ext.parquet'"
    },
    {
        "line": 38,
        "fullcodeline": "pq.write_table(orig_table, filename)"
    },
    {
        "line": 40,
        "fullcodeline": "table = pq.read_table(filename)"
    },
    {
        "line": 41,
        "fullcodeline": "assert table.column(0).type == list_array.type"
    },
    {
        "line": 42,
        "fullcodeline": "assert table == orig_table"
    },
    {
        "line": 11,
        "fullcodeline": "[storage, ext_array],"
    },
    {
        "line": 12,
        "fullcodeline": "names=['ints', 'exts'])"
    }
]