[
    {
        "line": 3,
        "fullcodeline": "struct user_namespace *user_ns = ns;"
    },
    {
        "line": 19,
        "fullcodeline": "cred = prepare_creds();"
    },
    {
        "line": 23,
        "fullcodeline": "put_user_ns(cred->user_ns);"
    },
    {
        "line": 24,
        "fullcodeline": "set_cred_user_ns(cred, get_user_ns(user_ns));"
    },
    {
        "line": 9,
        "fullcodeline": "if (user_ns == current_user_ns())"
    },
    {
        "line": 20,
        "fullcodeline": "if (!cred)"
    },
    {
        "line": 26,
        "fullcodeline": "return commit_creds(cred);"
    },
    {
        "line": 13,
        "fullcodeline": "if (atomic_read(&current->mm->mm_users) > 1)"
    },
    {
        "line": 16,
        "fullcodeline": "if (!ns_capable(user_ns, CAP_SYS_ADMIN))"
    },
    {
        "line": 10,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 14,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 17,
        "fullcodeline": "return -EPERM;"
    },
    {
        "line": 21,
        "fullcodeline": "return -ENOMEM;"
    }
]