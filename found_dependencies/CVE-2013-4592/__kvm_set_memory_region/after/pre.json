[
    {
        "line": 12,
        "fullcodeline": "r = check_memory_region_flags(mem);"
    },
    {
        "line": 16,
        "fullcodeline": "r = -EINVAL;"
    },
    {
        "line": 34,
        "fullcodeline": "memslot = id_to_memslot(kvm->memslots, mem->slot);"
    },
    {
        "line": 35,
        "fullcodeline": "base_gfn = mem->guest_phys_addr >> PAGE_SHIFT;"
    },
    {
        "line": 36,
        "fullcodeline": "npages = mem->memory_size >> PAGE_SHIFT;"
    },
    {
        "line": 38,
        "fullcodeline": "r = -EINVAL;"
    },
    {
        "line": 45,
        "fullcodeline": "new = old = *memslot;"
    },
    {
        "line": 47,
        "fullcodeline": "new.id = mem->slot;"
    },
    {
        "line": 48,
        "fullcodeline": "new.base_gfn = base_gfn;"
    },
    {
        "line": 49,
        "fullcodeline": "new.npages = npages;"
    },
    {
        "line": 50,
        "fullcodeline": "new.flags = mem->flags;"
    },
    {
        "line": 56,
        "fullcodeline": "r = -EINVAL;"
    },
    {
        "line": 63,
        "fullcodeline": "r = -EEXIST;"
    },
    {
        "line": 64,
        "fullcodeline": "kvm_for_each_memslot(slot, kvm->memslots) {"
    },
    {
        "line": 76,
        "fullcodeline": "r = -ENOMEM;"
    },
    {
        "line": 129,
        "fullcodeline": "r = kvm_arch_prepare_memory_region(kvm, &new, old, mem, user_alloc);"
    },
    {
        "line": 133,
        "fullcodeline": "r = -ENOMEM;"
    },
    {
        "line": 134,
        "fullcodeline": "slots = kmemdup(kvm->memslots, sizeof(struct kvm_memslots),"
    },
    {
        "line": 152,
        "fullcodeline": "update_memslots(slots, &new);"
    },
    {
        "line": 153,
        "fullcodeline": "old_memslots = kvm->memslots;"
    },
    {
        "line": 154,
        "fullcodeline": "rcu_assign_pointer(kvm->memslots, slots);"
    },
    {
        "line": 155,
        "fullcodeline": "synchronize_srcu_expedited(&kvm->srcu);"
    },
    {
        "line": 157,
        "fullcodeline": "kvm_arch_commit_memory_region(kvm, mem, old, user_alloc);"
    },
    {
        "line": 159,
        "fullcodeline": "kvm_free_physmem_slot(&old, &new);"
    },
    {
        "line": 160,
        "fullcodeline": "kfree(old_memslots);"
    },
    {
        "line": 18,
        "fullcodeline": "if (mem->memory_size & (PAGE_SIZE - 1))"
    },
    {
        "line": 20,
        "fullcodeline": "if (mem->guest_phys_addr & (PAGE_SIZE - 1))"
    },
    {
        "line": 29,
        "fullcodeline": "if (mem->slot >= KVM_MEM_SLOTS_NUM)"
    },
    {
        "line": 31,
        "fullcodeline": "if (mem->guest_phys_addr + mem->memory_size < mem->guest_phys_addr)"
    },
    {
        "line": 39,
        "fullcodeline": "if (npages > KVM_MEM_MAX_NR_PAGES)"
    },
    {
        "line": 42,
        "fullcodeline": "if (!npages)"
    },
    {
        "line": 57,
        "fullcodeline": "if (npages && old.npages && npages != old.npages)"
    },
    {
        "line": 59,
        "fullcodeline": "if (!npages && !old.npages)"
    },
    {
        "line": 73,
        "fullcodeline": "if (!(new.flags & KVM_MEM_LOG_DIRTY_PAGES))"
    },
    {
        "line": 82,
        "fullcodeline": "if (!old.npages) {"
    },
    {
        "line": 94,
        "fullcodeline": "if ((new.flags & KVM_MEM_LOG_DIRTY_PAGES) && !new.dirty_bitmap) {"
    },
    {
        "line": 100,
        "fullcodeline": "if (!npages || base_gfn != old.base_gfn) {"
    },
    {
        "line": 136,
        "fullcodeline": "if (!slots)"
    },
    {
        "line": 147,
        "fullcodeline": "if (!npages) {"
    },
    {
        "line": 43,
        "fullcodeline": "mem->flags &= ~KVM_MEM_LOG_DIRTY_PAGES;"
    },
    {
        "line": 65,
        "fullcodeline": "if (slot->id >= KVM_MEMORY_SLOTS || slot == memslot)"
    },
    {
        "line": 67,
        "fullcodeline": "if (!((base_gfn + npages <= slot->base_gfn) ||"
    },
    {
        "line": 74,
        "fullcodeline": "new.dirty_bitmap = NULL;"
    },
    {
        "line": 83,
        "fullcodeline": "new.user_alloc = user_alloc;"
    },
    {
        "line": 84,
        "fullcodeline": "new.userspace_addr = mem->userspace_addr;"
    },
    {
        "line": 103,
        "fullcodeline": "r = -ENOMEM;"
    },
    {
        "line": 104,
        "fullcodeline": "slots = kmemdup(kvm->memslots, sizeof(struct kvm_memslots),"
    },
    {
        "line": 108,
        "fullcodeline": "slot = id_to_memslot(slots, mem->slot);"
    },
    {
        "line": 109,
        "fullcodeline": "slot->flags |= KVM_MEMSLOT_INVALID;"
    },
    {
        "line": 111,
        "fullcodeline": "update_memslots(slots, NULL);"
    },
    {
        "line": 113,
        "fullcodeline": "old_memslots = kvm->memslots;"
    },
    {
        "line": 114,
        "fullcodeline": "rcu_assign_pointer(kvm->memslots, slots);"
    },
    {
        "line": 115,
        "fullcodeline": "synchronize_srcu_expedited(&kvm->srcu);"
    },
    {
        "line": 117,
        "fullcodeline": "kvm_iommu_unmap_pages(kvm, &old);"
    },
    {
        "line": 125,
        "fullcodeline": "kvm_arch_flush_shadow_memslot(kvm, slot);"
    },
    {
        "line": 141,
        "fullcodeline": "r = kvm_iommu_map_pages(kvm, &new);"
    },
    {
        "line": 148,
        "fullcodeline": "new.dirty_bitmap = NULL;"
    },
    {
        "line": 149,
        "fullcodeline": "memset(&new.arch, 0, sizeof(new.arch));"
    },
    {
        "line": 86,
        "fullcodeline": "if (kvm_arch_create_memslot(&new, npages))"
    },
    {
        "line": 95,
        "fullcodeline": "if (kvm_create_dirty_bitmap(&new) < 0)"
    },
    {
        "line": 106,
        "fullcodeline": "if (!slots)"
    },
    {
        "line": 68,
        "fullcodeline": "(base_gfn >= slot->base_gfn + slot->npages)))"
    },
    {
        "line": 88,
        "fullcodeline": "} else if (npages && mem->userspace_addr != old.userspace_addr) {"
    },
    {
        "line": 89,
        "fullcodeline": "r = -EINVAL;"
    }
]