[
    {
        "line": 4,
        "fullcodeline": "struct module_state *state = GETSTATE(self);"
    },
    {
        "line": 491,
        "fullcodeline": "error = _error(\"InvalidBSON\");"
    },
    {
        "line": 492,
        "fullcodeline": "PyErr_SetNone(error);"
    },
    {
        "line": 493,
        "fullcodeline": "Py_DECREF(error);"
    },
    {
        "line": 469,
        "fullcodeline": "case -1:"
    },
    {
        "line": 15,
        "fullcodeline": "memcpy(&d, buffer + *position, 8);"
    },
    {
        "line": 16,
        "fullcodeline": "value = PyFloat_FromDouble(d);"
    },
    {
        "line": 20,
        "fullcodeline": "*position += 8;"
    },
    {
        "line": 26,
        "fullcodeline": "int value_length = ((int*)(buffer + *position))[0] - 1;"
    },
    {
        "line": 30,
        "fullcodeline": "*position += 4;"
    },
    {
        "line": 31,
        "fullcodeline": "value = PyUnicode_DecodeUTF8(buffer + *position, value_length, \"strict\");"
    },
    {
        "line": 35,
        "fullcodeline": "*position += value_length + 1;"
    },
    {
        "line": 41,
        "fullcodeline": "memcpy(&size, buffer + *position, 4);"
    },
    {
        "line": 45,
        "fullcodeline": "value = elements_to_dict(self, buffer + *position + 4,"
    },
    {
        "line": 89,
        "fullcodeline": "*position += size;"
    },
    {
        "line": 97,
        "fullcodeline": "memcpy(&size, buffer + *position, 4);"
    },
    {
        "line": 101,
        "fullcodeline": "end = *position + size - 1;"
    },
    {
        "line": 102,
        "fullcodeline": "*position += 4;"
    },
    {
        "line": 104,
        "fullcodeline": "value = PyList_New(0);"
    },
    {
        "line": 123,
        "fullcodeline": "(*position)++;"
    },
    {
        "line": 132,
        "fullcodeline": "memcpy(&length, buffer + *position, 4);"
    },
    {
        "line": 136,
        "fullcodeline": "subtype = (unsigned char)buffer[*position + 4];"
    },
    {
        "line": 210,
        "fullcodeline": "st = PyInt_FromLong(subtype);"
    },
    {
        "line": 216,
        "fullcodeline": "value = PyObject_CallFunctionObjArgs(state->Binary, data, st, NULL);"
    },
    {
        "line": 217,
        "fullcodeline": "Py_DECREF(st);"
    },
    {
        "line": 218,
        "fullcodeline": "Py_DECREF(data);"
    },
    {
        "line": 222,
        "fullcodeline": "*position += length + 5;"
    },
    {
        "line": 228,
        "fullcodeline": "value = Py_None;"
    },
    {
        "line": 229,
        "fullcodeline": "Py_INCREF(value);"
    },
    {
        "line": 240,
        "fullcodeline": "value = PyObject_CallFunction(state->ObjectId, \"s#\", buffer + *position, 12);"
    },
    {
        "line": 245,
        "fullcodeline": "*position += 12;"
    },
    {
        "line": 250,
        "fullcodeline": "value = buffer[(*position)++] ? Py_True : Py_False;"
    },
    {
        "line": 251,
        "fullcodeline": "Py_INCREF(value);"
    },
    {
        "line": 263,
        "fullcodeline": "naive = datetime_from_millis(*(long long*)(buffer + *position));"
    },
    {
        "line": 264,
        "fullcodeline": "*position += 8;"
    },
    {
        "line": 273,
        "fullcodeline": "replace = PyObject_GetAttrString(naive, \"replace\");"
    },
    {
        "line": 274,
        "fullcodeline": "Py_DECREF(naive);"
    },
    {
        "line": 278,
        "fullcodeline": "args = PyTuple_New(0);"
    },
    {
        "line": 283,
        "fullcodeline": "kwargs = PyDict_New();"
    },
    {
        "line": 295,
        "fullcodeline": "value = PyObject_Call(replace, args, kwargs);"
    },
    {
        "line": 296,
        "fullcodeline": "Py_DECREF(replace);"
    },
    {
        "line": 297,
        "fullcodeline": "Py_DECREF(args);"
    },
    {
        "line": 298,
        "fullcodeline": "Py_DECREF(kwargs);"
    },
    {
        "line": 307,
        "fullcodeline": "int pattern_length = strlen(buffer + *position);"
    },
    {
        "line": 311,
        "fullcodeline": "pattern = PyUnicode_DecodeUTF8(buffer + *position, pattern_length, \"strict\");"
    },
    {
        "line": 315,
        "fullcodeline": "*position += pattern_length + 1;"
    },
    {
        "line": 316,
        "fullcodeline": "flags_length = strlen(buffer + *position);"
    },
    {
        "line": 321,
        "fullcodeline": "flags = 0;"
    },
    {
        "line": 337,
        "fullcodeline": "*position += flags_length + 1;"
    },
    {
        "line": 338,
        "fullcodeline": "value = PyObject_CallFunction(state->RECompile, \"Oi\", pattern, flags);"
    },
    {
        "line": 339,
        "fullcodeline": "Py_DECREF(pattern);"
    },
    {
        "line": 348,
        "fullcodeline": "*position += 4;"
    },
    {
        "line": 349,
        "fullcodeline": "collection_length = strlen(buffer + *position);"
    },
    {
        "line": 353,
        "fullcodeline": "collection = PyUnicode_DecodeUTF8(buffer + *position, collection_length, \"strict\");"
    },
    {
        "line": 357,
        "fullcodeline": "*position += collection_length + 1;"
    },
    {
        "line": 362,
        "fullcodeline": "id = PyObject_CallFunction(state->ObjectId, \"s#\", buffer + *position, 12);"
    },
    {
        "line": 367,
        "fullcodeline": "*position += 12;"
    },
    {
        "line": 368,
        "fullcodeline": "value = PyObject_CallFunctionObjArgs(state->DBRef, collection, id, NULL);"
    },
    {
        "line": 369,
        "fullcodeline": "Py_DECREF(collection);"
    },
    {
        "line": 370,
        "fullcodeline": "Py_DECREF(id);"
    },
    {
        "line": 376,
        "fullcodeline": "int value_length = ((int*)(buffer + *position))[0] - 1;"
    },
    {
        "line": 380,
        "fullcodeline": "*position += 4;"
    },
    {
        "line": 381,
        "fullcodeline": "code = PyUnicode_DecodeUTF8(buffer + *position, value_length, \"strict\");"
    },
    {
        "line": 385,
        "fullcodeline": "*position += value_length + 1;"
    },
    {
        "line": 386,
        "fullcodeline": "value = PyObject_CallFunctionObjArgs(state->Code, code, NULL, NULL);"
    },
    {
        "line": 387,
        "fullcodeline": "Py_DECREF(code);"
    },
    {
        "line": 397,
        "fullcodeline": "*position += 8;"
    },
    {
        "line": 398,
        "fullcodeline": "code_length = strlen(buffer + *position);"
    },
    {
        "line": 402,
        "fullcodeline": "code = PyUnicode_DecodeUTF8(buffer + *position, code_length, \"strict\");"
    },
    {
        "line": 406,
        "fullcodeline": "*position += code_length + 1;"
    },
    {
        "line": 408,
        "fullcodeline": "memcpy(&scope_size, buffer + *position, 4);"
    },
    {
        "line": 409,
        "fullcodeline": "scope = elements_to_dict(self, buffer + *position + 4, scope_size - 5,"
    },
    {
        "line": 415,
        "fullcodeline": "*position += scope_size;"
    },
    {
        "line": 417,
        "fullcodeline": "value = PyObject_CallFunctionObjArgs(state->Code, code, scope, NULL);"
    },
    {
        "line": 418,
        "fullcodeline": "Py_DECREF(code);"
    },
    {
        "line": 419,
        "fullcodeline": "Py_DECREF(scope);"
    },
    {
        "line": 428,
        "fullcodeline": "memcpy(&i, buffer + *position, 4);"
    },
    {
        "line": 432,
        "fullcodeline": "value = PyInt_FromLong(i);"
    },
    {
        "line": 437,
        "fullcodeline": "*position += 4;"
    },
    {
        "line": 446,
        "fullcodeline": "memcpy(&inc, buffer + *position, 4);"
    },
    {
        "line": 447,
        "fullcodeline": "memcpy(&time, buffer + *position + 4, 4);"
    },
    {
        "line": 448,
        "fullcodeline": "value = PyObject_CallFunction(state->Timestamp, \"II\", time, inc);"
    },
    {
        "line": 452,
        "fullcodeline": "*position += 8;"
    },
    {
        "line": 461,
        "fullcodeline": "memcpy(&ll, buffer + *position, 8);"
    },
    {
        "line": 462,
        "fullcodeline": "value = PyLong_FromLongLong(ll);"
    },
    {
        "line": 466,
        "fullcodeline": "*position += 8;"
    },
    {
        "line": 471,
        "fullcodeline": "value = PyObject_CallFunctionObjArgs(state->MinKey, NULL);"
    },
    {
        "line": 476,
        "fullcodeline": "value = PyObject_CallFunctionObjArgs(state->MaxKey, NULL);"
    },
    {
        "line": 481,
        "fullcodeline": "PyObject* InvalidDocument = _error(\"InvalidDocument\");"
    },
    {
        "line": 482,
        "fullcodeline": "PyErr_SetString(InvalidDocument, \"no c decoder for this type yet\");"
    },
    {
        "line": 483,
        "fullcodeline": "Py_DECREF(InvalidDocument);"
    },
    {
        "line": 12,
        "fullcodeline": "if (max < 8) {"
    },
    {
        "line": 17,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (max < value_length) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (max < size) {"
    },
    {
        "line": 47,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 52,
        "fullcodeline": "if (strcmp(buffer + *position + 5, \"$ref\") == 0) { /* DBRef */"
    },
    {
        "line": 98,
        "fullcodeline": "if (max < size) {"
    },
    {
        "line": 105,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 108,
        "fullcodeline": "while (*position < end) {"
    },
    {
        "line": 133,
        "fullcodeline": "if (max < length) {"
    },
    {
        "line": 150,
        "fullcodeline": "if (subtype == 2) {"
    },
    {
        "line": 156,
        "fullcodeline": "if (!data) {"
    },
    {
        "line": 159,
        "fullcodeline": "if ((subtype == 3 || subtype == 4) && state->UUID) { // Encode as UUID, not Binary"
    },
    {
        "line": 212,
        "fullcodeline": "if (!st) {"
    },
    {
        "line": 219,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 234,
        "fullcodeline": "if (max < 12) {"
    },
    {
        "line": 242,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 260,
        "fullcodeline": "if (max < 8) {"
    },
    {
        "line": 265,
        "fullcodeline": "if (!tz_aware) { /* In the naive case, we're done here. */"
    },
    {
        "line": 270,
        "fullcodeline": "if (!naive) {"
    },
    {
        "line": 275,
        "fullcodeline": "if (!replace) {"
    },
    {
        "line": 279,
        "fullcodeline": "if (!args) {"
    },
    {
        "line": 284,
        "fullcodeline": "if (!kwargs) {"
    },
    {
        "line": 289,
        "fullcodeline": "if (PyDict_SetItemString(kwargs, \"tzinfo\", state->UTC) == -1) {"
    },
    {
        "line": 308,
        "fullcodeline": "if (max < pattern_length) {"
    },
    {
        "line": 312,
        "fullcodeline": "if (!pattern) {"
    },
    {
        "line": 317,
        "fullcodeline": "if (max < pattern_length + flags_length) {"
    },
    {
        "line": 322,
        "fullcodeline": "for (i = 0; i < flags_length; i++) {"
    },
    {
        "line": 350,
        "fullcodeline": "if (max < collection_length) {"
    },
    {
        "line": 354,
        "fullcodeline": "if (!collection) {"
    },
    {
        "line": 358,
        "fullcodeline": "if (max < collection_length + 12) {"
    },
    {
        "line": 363,
        "fullcodeline": "if (!id) {"
    },
    {
        "line": 377,
        "fullcodeline": "if (max < value_length) {"
    },
    {
        "line": 382,
        "fullcodeline": "if (!code) {"
    },
    {
        "line": 399,
        "fullcodeline": "if (max < 8 + code_length) {"
    },
    {
        "line": 403,
        "fullcodeline": "if (!code) {"
    },
    {
        "line": 411,
        "fullcodeline": "if (!scope) {"
    },
    {
        "line": 425,
        "fullcodeline": "if (max < 4) {"
    },
    {
        "line": 434,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 443,
        "fullcodeline": "if (max < 8) {"
    },
    {
        "line": 449,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 458,
        "fullcodeline": "if (max < 8) {"
    },
    {
        "line": 463,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 46,
        "fullcodeline": "size - 5, as_class, tz_aware, uuid_subtype);"
    },
    {
        "line": 54,
        "fullcodeline": "PyObject* collection = PyDict_GetItemString(value, \"$ref\");"
    },
    {
        "line": 55,
        "fullcodeline": "PyObject* id = PyDict_GetItemString(value, \"$id\");"
    },
    {
        "line": 56,
        "fullcodeline": "PyObject* database = PyDict_GetItemString(value, \"$db\");"
    },
    {
        "line": 58,
        "fullcodeline": "Py_INCREF(collection);"
    },
    {
        "line": 59,
        "fullcodeline": "PyDict_DelItemString(value, \"$ref\");"
    },
    {
        "line": 77,
        "fullcodeline": "dbref = PyObject_CallFunctionObjArgs(state->DBRef, collection, id, database, value, NULL);"
    },
    {
        "line": 78,
        "fullcodeline": "Py_DECREF(value);"
    },
    {
        "line": 79,
        "fullcodeline": "value = dbref;"
    },
    {
        "line": 81,
        "fullcodeline": "Py_DECREF(id);"
    },
    {
        "line": 82,
        "fullcodeline": "Py_DECREF(collection);"
    },
    {
        "line": 83,
        "fullcodeline": "Py_DECREF(database);"
    },
    {
        "line": 111,
        "fullcodeline": "int type = (int)buffer[(*position)++];"
    },
    {
        "line": 112,
        "fullcodeline": "int key_size = strlen(buffer + *position);"
    },
    {
        "line": 113,
        "fullcodeline": "*position += key_size + 1; /* just skip the key, they're in order. */"
    },
    {
        "line": 114,
        "fullcodeline": "to_append = get_value(self, buffer, position, type,"
    },
    {
        "line": 120,
        "fullcodeline": "PyList_Append(value, to_append);"
    },
    {
        "line": 121,
        "fullcodeline": "Py_DECREF(to_append);"
    },
    {
        "line": 151,
        "fullcodeline": "data = PyString_FromStringAndSize(buffer + *position + 9, length - 4);"
    },
    {
        "line": 161,
        "fullcodeline": "PyObject* args = PyTuple_New(0);"
    },
    {
        "line": 166,
        "fullcodeline": "kwargs = PyDict_New();"
    },
    {
        "line": 173,
        "fullcodeline": "assert(length == 16); // UUID should always be 16 bytes"
    },
    {
        "line": 194,
        "fullcodeline": "value = PyObject_Call(state->UUID, args, kwargs);"
    },
    {
        "line": 196,
        "fullcodeline": "Py_DECREF(args);"
    },
    {
        "line": 197,
        "fullcodeline": "Py_DECREF(kwargs);"
    },
    {
        "line": 198,
        "fullcodeline": "Py_DECREF(data);"
    },
    {
        "line": 203,
        "fullcodeline": "*position += length + 5;"
    },
    {
        "line": 213,
        "fullcodeline": "Py_DECREF(data);"
    },
    {
        "line": 266,
        "fullcodeline": "value = naive;"
    },
    {
        "line": 280,
        "fullcodeline": "Py_DECREF(replace);"
    },
    {
        "line": 285,
        "fullcodeline": "Py_DECREF(replace);"
    },
    {
        "line": 286,
        "fullcodeline": "Py_DECREF(args);"
    },
    {
        "line": 290,
        "fullcodeline": "Py_DECREF(replace);"
    },
    {
        "line": 291,
        "fullcodeline": "Py_DECREF(args);"
    },
    {
        "line": 292,
        "fullcodeline": "Py_DECREF(kwargs);"
    },
    {
        "line": 318,
        "fullcodeline": "Py_DECREF(pattern);"
    },
    {
        "line": 359,
        "fullcodeline": "Py_DECREF(collection);"
    },
    {
        "line": 364,
        "fullcodeline": "Py_DECREF(collection);"
    },
    {
        "line": 410,
        "fullcodeline": "(PyObject*)&PyDict_Type, tz_aware, uuid_subtype);"
    },
    {
        "line": 412,
        "fullcodeline": "Py_DECREF(code);"
    },
    {
        "line": 61,
        "fullcodeline": "if (id == NULL) {"
    },
    {
        "line": 69,
        "fullcodeline": "if (database == NULL) {"
    },
    {
        "line": 84,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 116,
        "fullcodeline": "if (!to_append) {"
    },
    {
        "line": 153,
        "fullcodeline": "data = PyString_FromStringAndSize(buffer + *position + 5, length);"
    },
    {
        "line": 162,
        "fullcodeline": "if (!args) {"
    },
    {
        "line": 167,
        "fullcodeline": "if (!kwargs) {"
    },
    {
        "line": 175,
        "fullcodeline": "if (uuid_subtype == CSHARP_LEGACY) {"
    },
    {
        "line": 199,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 323,
        "fullcodeline": "if (buffer[*position + i] == 'i') {"
    },
    {
        "line": 62,
        "fullcodeline": "id = Py_None;"
    },
    {
        "line": 63,
        "fullcodeline": "Py_INCREF(id);"
    },
    {
        "line": 70,
        "fullcodeline": "database = Py_None;"
    },
    {
        "line": 71,
        "fullcodeline": "Py_INCREF(database);"
    },
    {
        "line": 115,
        "fullcodeline": "max - key_size, as_class, tz_aware, uuid_subtype);"
    },
    {
        "line": 117,
        "fullcodeline": "Py_DECREF(value);"
    },
    {
        "line": 163,
        "fullcodeline": "Py_DECREF(data);"
    },
    {
        "line": 168,
        "fullcodeline": "Py_DECREF(data);"
    },
    {
        "line": 169,
        "fullcodeline": "Py_DECREF(args);"
    },
    {
        "line": 177,
        "fullcodeline": "PyDict_SetItemString(kwargs, \"bytes_le\", data);"
    },
    {
        "line": 324,
        "fullcodeline": "flags |= 2;"
    },
    {
        "line": 65,
        "fullcodeline": "Py_INCREF(id);"
    },
    {
        "line": 66,
        "fullcodeline": "PyDict_DelItemString(value, \"$id\");"
    },
    {
        "line": 73,
        "fullcodeline": "Py_INCREF(database);"
    },
    {
        "line": 74,
        "fullcodeline": "PyDict_DelItemString(value, \"$db\");"
    },
    {
        "line": 192,
        "fullcodeline": "PyDict_SetItemString(kwargs, \"bytes\", data);"
    },
    {
        "line": 180,
        "fullcodeline": "if (uuid_subtype == JAVA_LEGACY) {"
    },
    {
        "line": 325,
        "fullcodeline": "} else if (buffer[*position + i] == 'l') {"
    },
    {
        "line": 182,
        "fullcodeline": "char big_endian[16];"
    },
    {
        "line": 183,
        "fullcodeline": "_fix_java(buffer + *position + 5, big_endian);"
    },
    {
        "line": 185,
        "fullcodeline": "Py_DECREF(data);"
    },
    {
        "line": 189,
        "fullcodeline": "data = PyString_FromStringAndSize(big_endian, length);"
    },
    {
        "line": 326,
        "fullcodeline": "flags |= 4;"
    },
    {
        "line": 327,
        "fullcodeline": "} else if (buffer[*position + i] == 'm') {"
    },
    {
        "line": 328,
        "fullcodeline": "flags |= 8;"
    },
    {
        "line": 329,
        "fullcodeline": "} else if (buffer[*position + i] == 's') {"
    },
    {
        "line": 330,
        "fullcodeline": "flags |= 16;"
    },
    {
        "line": 331,
        "fullcodeline": "} else if (buffer[*position + i] == 'u') {"
    },
    {
        "line": 332,
        "fullcodeline": "flags |= 32;"
    },
    {
        "line": 333,
        "fullcodeline": "} else if (buffer[*position + i] == 'x') {"
    },
    {
        "line": 334,
        "fullcodeline": "flags |= 64;"
    }
]