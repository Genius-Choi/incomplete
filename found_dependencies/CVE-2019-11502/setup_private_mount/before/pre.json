[
    {
        "line": 3,
        "fullcodeline": "uid_t uid = getuid();"
    },
    {
        "line": 4,
        "fullcodeline": "gid_t gid = getgid();"
    },
    {
        "line": 5,
        "fullcodeline": "char tmpdir[MAX_BUF] = { 0 };"
    },
    {
        "line": 12,
        "fullcodeline": "sc_must_snprintf(tmpdir, sizeof(tmpdir), \"/tmp/snap.%s_XXXXXX\", snap_name);"
    },
    {
        "line": 17,
        "fullcodeline": "mode_t old_mask = umask(0);"
    },
    {
        "line": 18,
        "fullcodeline": "char *d = sc_strdup(tmpdir);"
    },
    {
        "line": 19,
        "fullcodeline": "sc_must_snprintf(tmpdir, sizeof(tmpdir), \"%s/tmp\", d);"
    },
    {
        "line": 20,
        "fullcodeline": "free(d);"
    },
    {
        "line": 25,
        "fullcodeline": "umask(old_mask);"
    },
    {
        "line": 28,
        "fullcodeline": "char *pwd = get_current_dir_name();"
    },
    {
        "line": 35,
        "fullcodeline": "sc_do_mount(tmpdir, \"/tmp\", NULL, MS_BIND, NULL);"
    },
    {
        "line": 37,
        "fullcodeline": "sc_do_mount(\"none\", \"/tmp\", NULL, MS_PRIVATE, NULL);"
    },
    {
        "line": 45,
        "fullcodeline": "free(pwd);"
    },
    {
        "line": 13,
        "fullcodeline": "if (mkdtemp(tmpdir) == NULL) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (mkdir(tmpdir, 01777) != 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (pwd == NULL)"
    },
    {
        "line": 31,
        "fullcodeline": "if (chdir(\"/\") != 0)"
    },
    {
        "line": 39,
        "fullcodeline": "if (chown(\"/tmp/\", uid, gid) < 0) {"
    },
    {
        "line": 43,
        "fullcodeline": "if (chdir(pwd) != 0)"
    },
    {
        "line": 14,
        "fullcodeline": "die(\"cannot create temporary directory essential for private /tmp\");"
    },
    {
        "line": 23,
        "fullcodeline": "die(\"cannot create temporary directory for private /tmp\");"
    },
    {
        "line": 30,
        "fullcodeline": "die(\"cannot get current working directory\");"
    },
    {
        "line": 32,
        "fullcodeline": "die(\"cannot change directory to '/'\");"
    },
    {
        "line": 40,
        "fullcodeline": "die(\"cannot change ownership of /tmp\");"
    },
    {
        "line": 44,
        "fullcodeline": "die(\"cannot change current working directory to the original directory\");"
    }
]