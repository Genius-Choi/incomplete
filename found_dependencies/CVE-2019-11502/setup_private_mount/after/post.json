[
    {
        "line": 3,
        "fullcodeline": "char tmpdir[MAX_BUF] = { 0 };"
    },
    {
        "line": 10,
        "fullcodeline": "sc_must_snprintf(tmpdir, sizeof(tmpdir), \"/tmp/snap.%s_XXXXXX\", snap_name);"
    },
    {
        "line": 15,
        "fullcodeline": "mode_t old_mask = umask(0);"
    },
    {
        "line": 16,
        "fullcodeline": "char *d = sc_strdup(tmpdir);"
    },
    {
        "line": 17,
        "fullcodeline": "sc_must_snprintf(tmpdir, sizeof(tmpdir), \"%s/tmp\", d);"
    },
    {
        "line": 18,
        "fullcodeline": "free(d);"
    },
    {
        "line": 23,
        "fullcodeline": "umask(old_mask);"
    },
    {
        "line": 26,
        "fullcodeline": "char *pwd = get_current_dir_name();"
    },
    {
        "line": 33,
        "fullcodeline": "sc_do_mount(tmpdir, \"/tmp\", NULL, MS_BIND, NULL);"
    },
    {
        "line": 35,
        "fullcodeline": "sc_do_mount(\"none\", \"/tmp\", NULL, MS_PRIVATE, NULL);"
    },
    {
        "line": 43,
        "fullcodeline": "free(pwd);"
    },
    {
        "line": 11,
        "fullcodeline": "if (mkdtemp(tmpdir) == NULL) {"
    },
    {
        "line": 20,
        "fullcodeline": "if (mkdir(tmpdir, 01777) != 0) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (pwd == NULL)"
    },
    {
        "line": 29,
        "fullcodeline": "if (chdir(\"/\") != 0)"
    },
    {
        "line": 37,
        "fullcodeline": "if (chown(\"/tmp/\", 0, 0) < 0) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (chdir(pwd) != 0)"
    },
    {
        "line": 12,
        "fullcodeline": "die(\"cannot create temporary directory essential for private /tmp\");"
    },
    {
        "line": 21,
        "fullcodeline": "die(\"cannot create temporary directory for private /tmp\");"
    },
    {
        "line": 28,
        "fullcodeline": "die(\"cannot get current working directory\");"
    },
    {
        "line": 30,
        "fullcodeline": "die(\"cannot change directory to '/'\");"
    },
    {
        "line": 38,
        "fullcodeline": "die(\"cannot change ownership of /tmp\");"
    },
    {
        "line": 42,
        "fullcodeline": "die(\"cannot change current working directory to the original directory\");"
    }
]