[
    {
        "line": 9,
        "fullcodeline": "struct keyring_index_key index_key = {"
    },
    {
        "line": 14,
        "fullcodeline": "const struct cred *cred = current_cred();"
    },
    {
        "line": 15,
        "fullcodeline": "struct key *keyring, *key = NULL;"
    },
    {
        "line": 21,
        "fullcodeline": "index_key.type = key_type_lookup(type);"
    },
    {
        "line": 27,
        "fullcodeline": "key_ref = ERR_PTR(-EINVAL);"
    },
    {
        "line": 32,
        "fullcodeline": "keyring = key_ref_to_ptr(keyring_ref);"
    },
    {
        "line": 34,
        "fullcodeline": "key_check(keyring);"
    },
    {
        "line": 36,
        "fullcodeline": "key_ref = ERR_PTR(-ENOTDIR);"
    },
    {
        "line": 40,
        "fullcodeline": "memset(&prep, 0, sizeof(prep));"
    },
    {
        "line": 41,
        "fullcodeline": "prep.data = payload;"
    },
    {
        "line": 42,
        "fullcodeline": "prep.datalen = plen;"
    },
    {
        "line": 44,
        "fullcodeline": "prep.trusted = flags & KEY_ALLOC_TRUSTED;"
    },
    {
        "line": 45,
        "fullcodeline": "prep.expiry = TIME_T_MAX;"
    },
    {
        "line": 58,
        "fullcodeline": "index_key.desc_len = strlen(index_key.description);"
    },
    {
        "line": 60,
        "fullcodeline": "key_ref = ERR_PTR(-EPERM);"
    },
    {
        "line": 63,
        "fullcodeline": "flags |= prep.trusted ? KEY_ALLOC_TRUSTED : 0;"
    },
    {
        "line": 65,
        "fullcodeline": "ret = __key_link_begin(keyring, &index_key, &edit);"
    },
    {
        "line": 73,
        "fullcodeline": "ret = key_permission(keyring_ref, KEY_NEED_WRITE);"
    },
    {
        "line": 103,
        "fullcodeline": "key = key_alloc(index_key.type, index_key.description,"
    },
    {
        "line": 111,
        "fullcodeline": "ret = __key_instantiate_and_link(key, &prep, keyring, NULL, &edit);"
    },
    {
        "line": 118,
        "fullcodeline": "key_ref = make_key_ref(key, is_key_possessed(keyring_ref));"
    },
    {
        "line": 121,
        "fullcodeline": "__key_link_end(keyring, &index_key, edit);"
    },
    {
        "line": 126,
        "fullcodeline": "key_type_put(index_key.type);"
    },
    {
        "line": 134,
        "fullcodeline": "__key_link_end(keyring, &index_key, edit);"
    },
    {
        "line": 136,
        "fullcodeline": "key_ref = __key_update(key_ref, &prep);"
    },
    {
        "line": 22,
        "fullcodeline": "if (IS_ERR(index_key.type)) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (!index_key.type->match || !index_key.type->instantiate ||"
    },
    {
        "line": 37,
        "fullcodeline": "if (keyring->type != &key_type_keyring)"
    },
    {
        "line": 61,
        "fullcodeline": "if (!prep.trusted && test_bit(KEY_FLAG_TRUSTED_ONLY, &keyring->flags))"
    },
    {
        "line": 66,
        "fullcodeline": "if (ret < 0) {"
    },
    {
        "line": 74,
        "fullcodeline": "if (ret < 0) {"
    },
    {
        "line": 90,
        "fullcodeline": "if (perm == KEY_PERM_UNDEF) {"
    },
    {
        "line": 105,
        "fullcodeline": "if (IS_ERR(key)) {"
    },
    {
        "line": 112,
        "fullcodeline": "if (ret < 0) {"
    },
    {
        "line": 23,
        "fullcodeline": "key_ref = ERR_PTR(-ENODEV);"
    },
    {
        "line": 29,
        "fullcodeline": "(!index_key.description && !index_key.type->preparse))"
    },
    {
        "line": 47,
        "fullcodeline": "ret = index_key.type->preparse(&prep);"
    },
    {
        "line": 54,
        "fullcodeline": "key_ref = ERR_PTR(-EINVAL);"
    },
    {
        "line": 67,
        "fullcodeline": "key_ref = ERR_PTR(ret);"
    },
    {
        "line": 75,
        "fullcodeline": "key_ref = ERR_PTR(ret);"
    },
    {
        "line": 84,
        "fullcodeline": "key_ref = find_key_to_update(keyring_ref, &index_key);"
    },
    {
        "line": 91,
        "fullcodeline": "perm = KEY_POS_VIEW | KEY_POS_SEARCH | KEY_POS_LINK | KEY_POS_SETATTR;"
    },
    {
        "line": 92,
        "fullcodeline": "perm |= KEY_USR_VIEW;"
    },
    {
        "line": 106,
        "fullcodeline": "key_ref = ERR_CAST(key);"
    },
    {
        "line": 113,
        "fullcodeline": "key_put(key);"
    },
    {
        "line": 114,
        "fullcodeline": "key_ref = ERR_PTR(ret);"
    },
    {
        "line": 124,
        "fullcodeline": "index_key.type->free_preparse(&prep);"
    },
    {
        "line": 10,
        "fullcodeline": ".description\t= description,"
    },
    {
        "line": 48,
        "fullcodeline": "if (ret < 0) {"
    },
    {
        "line": 52,
        "fullcodeline": "if (!index_key.description)"
    },
    {
        "line": 55,
        "fullcodeline": "if (!index_key.description)"
    },
    {
        "line": 97,
        "fullcodeline": "if (index_key.type == &key_type_keyring ||"
    },
    {
        "line": 49,
        "fullcodeline": "key_ref = ERR_PTR(ret);"
    },
    {
        "line": 53,
        "fullcodeline": "index_key.description = prep.description;"
    },
    {
        "line": 95,
        "fullcodeline": "perm |= KEY_POS_READ;"
    },
    {
        "line": 99,
        "fullcodeline": "perm |= KEY_POS_WRITE;"
    }
]