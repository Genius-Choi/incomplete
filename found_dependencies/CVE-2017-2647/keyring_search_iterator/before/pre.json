[
    {
        "line": 3,
        "fullcodeline": "struct keyring_search_context *ctx = iterator_data;"
    },
    {
        "line": 4,
        "fullcodeline": "const struct key *key = keyring_ptr_to_key(object);"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned long kflags = key->flags;"
    },
    {
        "line": 7,
        "fullcodeline": "kenter(\"{%d}\", key->serial);"
    },
    {
        "line": 10,
        "fullcodeline": "if (key->type != ctx->index_key.type) {"
    },
    {
        "line": 16,
        "fullcodeline": "if (ctx->flags & KEYRING_SEARCH_DO_STATE_CHECK) {"
    },
    {
        "line": 57,
        "fullcodeline": "ctx->result = make_key_ref(key, ctx->possessed);"
    },
    {
        "line": 11,
        "fullcodeline": "kleave(\" = 0 [!type]\");"
    },
    {
        "line": 32,
        "fullcodeline": "if (!ctx->match_data.cmp(key, &ctx->match_data)) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (!(ctx->flags & KEYRING_SEARCH_NO_CHECK_PERM) &&"
    },
    {
        "line": 39,
        "fullcodeline": "key_task_permission(make_key_ref(key, ctx->possessed),"
    },
    {
        "line": 17,
        "fullcodeline": "if (kflags & ((1 << KEY_FLAG_INVALIDATED) |"
    },
    {
        "line": 24,
        "fullcodeline": "if (key->expiry && ctx->now.tv_sec >= key->expiry) {"
    },
    {
        "line": 41,
        "fullcodeline": "ctx->result = ERR_PTR(-EACCES);"
    },
    {
        "line": 48,
        "fullcodeline": "if (kflags & (1 << KEY_FLAG_NEGATIVE)) {"
    },
    {
        "line": 18,
        "fullcodeline": "(1 << KEY_FLAG_REVOKED))) {"
    },
    {
        "line": 19,
        "fullcodeline": "ctx->result = ERR_PTR(-EKEYREVOKED);"
    },
    {
        "line": 25,
        "fullcodeline": "ctx->result = ERR_PTR(-EKEYEXPIRED);"
    },
    {
        "line": 50,
        "fullcodeline": "ctx->result = ERR_PTR(key->type_data.reject_error);"
    }
]