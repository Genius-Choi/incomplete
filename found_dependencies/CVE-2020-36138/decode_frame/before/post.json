[
    {
        "line": 4,
        "fullcodeline": "TiffContext *const s = avctx->priv_data;"
    },
    {
        "line": 5,
        "fullcodeline": "AVFrame *const p = data;"
    },
    {
        "line": 6,
        "fullcodeline": "ThreadFrame frame = { .f = data };"
    },
    {
        "line": 18,
        "fullcodeline": "bytestream2_init(&s->gb, avpkt->data, avpkt->size);"
    },
    {
        "line": 28,
        "fullcodeline": "s->le          = le;"
    },
    {
        "line": 31,
        "fullcodeline": "s->tiff_type   = TIFF_TYPE_TIFF;"
    },
    {
        "line": 33,
        "fullcodeline": "s->is_thumbnail = 0;"
    },
    {
        "line": 34,
        "fullcodeline": "s->bppcount    = s->bpp = 1;"
    },
    {
        "line": 35,
        "fullcodeline": "s->photometric = TIFF_PHOTOMETRIC_NONE;"
    },
    {
        "line": 36,
        "fullcodeline": "s->compr       = TIFF_RAW;"
    },
    {
        "line": 37,
        "fullcodeline": "s->fill_order  = 0;"
    },
    {
        "line": 38,
        "fullcodeline": "s->white_level = 0;"
    },
    {
        "line": 39,
        "fullcodeline": "s->is_bayer    = 0;"
    },
    {
        "line": 40,
        "fullcodeline": "s->is_tiled    = 0;"
    },
    {
        "line": 41,
        "fullcodeline": "s->is_jpeg     = 0;"
    },
    {
        "line": 42,
        "fullcodeline": "s->cur_page    = 0;"
    },
    {
        "line": 43,
        "fullcodeline": "s->last_tag    = 0;"
    },
    {
        "line": 48,
        "fullcodeline": "free_geotags(s);"
    },
    {
        "line": 51,
        "fullcodeline": "s->stripsizesoff = s->strippos = 0;"
    },
    {
        "line": 53,
        "fullcodeline": "bytestream2_seek(&s->gb, off, SEEK_SET);"
    },
    {
        "line": 54,
        "fullcodeline": "entries = ff_tget_short(&s->gb, le);"
    },
    {
        "line": 68,
        "fullcodeline": "retry_for_subifd = s->sub_ifd && (s->get_subimage || (!s->get_thumbnail && s->is_thumbnail));"
    },
    {
        "line": 70,
        "fullcodeline": "retry_for_page = s->get_page && s->cur_page + 1 < s->get_page;  // get_page is 1-indexed"
    },
    {
        "line": 72,
        "fullcodeline": "last_off = off;"
    },
    {
        "line": 100,
        "fullcodeline": "is_dng = (s->tiff_type == TIFF_TYPE_DNG || s->tiff_type == TIFF_TYPE_CINEMADNG);"
    },
    {
        "line": 146,
        "fullcodeline": "has_tile_bits  = s->is_tiled || s->tile_byte_counts_offset || s->tile_offsets_offset || s->tile_width || s->tile_length || s->tile_count;"
    },
    {
        "line": 147,
        "fullcodeline": "has_strip_bits = s->strippos || s->strips || s->stripoff || s->rps || s->sot || s->sstype || s->stripsize || s->stripsizesoff;"
    },
    {
        "line": 207,
        "fullcodeline": "planes = s->planar ? s->bppcount : 1;"
    },
    {
        "line": 358,
        "fullcodeline": "*got_frame = 1;"
    },
    {
        "line": 21,
        "fullcodeline": "if ((ret = ff_tdecode_header(&s->gb, &le, &off))) {"
    },
    {
        "line": 45,
        "fullcodeline": "for (i = 0; i < 65536; i++)"
    },
    {
        "line": 46,
        "fullcodeline": "s->dng_lut[i] = i;"
    },
    {
        "line": 55,
        "fullcodeline": "if (bytestream2_get_bytes_left(&s->gb) < entries * 12)"
    },
    {
        "line": 57,
        "fullcodeline": "for (i = 0; i < entries; i++) {"
    },
    {
        "line": 62,
        "fullcodeline": "if (s->get_thumbnail && !s->is_thumbnail) {"
    },
    {
        "line": 81,
        "fullcodeline": "if (retry_for_subifd || retry_for_page) {"
    },
    {
        "line": 102,
        "fullcodeline": "for (i = 0; i<s->geotag_count; i++) {"
    },
    {
        "line": 141,
        "fullcodeline": "if (!s->is_tiled && !s->strippos && !s->stripoff) {"
    },
    {
        "line": 149,
        "fullcodeline": "if (has_tile_bits && has_strip_bits) {"
    },
    {
        "line": 154,
        "fullcodeline": "if ((ret = init_image(s, &frame)) < 0)"
    },
    {
        "line": 157,
        "fullcodeline": "if (!s->is_tiled) {"
    },
    {
        "line": 182,
        "fullcodeline": "if (s->photometric == TIFF_PHOTOMETRIC_LINEAR_RAW ||"
    },
    {
        "line": 191,
        "fullcodeline": "if (is_dng && s->is_tiled) {"
    },
    {
        "line": 208,
        "fullcodeline": "for (plane = 0; plane < planes; plane++) {"
    },
    {
        "line": 342,
        "fullcodeline": "if (s->planar && s->bppcount > 2) {"
    },
    {
        "line": 349,
        "fullcodeline": "if (s->is_bayer && s->white_level && s->bpp == 16 && !is_dng) {"
    },
    {
        "line": 22,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"Invalid TIFF header\\n\");"
    },
    {
        "line": 63,
        "fullcodeline": "av_log(avctx, AV_LOG_INFO, \"No embedded thumbnail present\\n\");"
    },
    {
        "line": 75,
        "fullcodeline": "off = ff_tget_long(&s->gb, le);"
    },
    {
        "line": 94,
        "fullcodeline": "s->sub_ifd = 0;"
    },
    {
        "line": 103,
        "fullcodeline": "const char *keyname = get_geokey_name(s->geotags[i].key);"
    },
    {
        "line": 112,
        "fullcodeline": "ret = av_dict_set(&p->metadata, keyname, s->geotags[i].val, 0);"
    },
    {
        "line": 124,
        "fullcodeline": "bps = s->bpp / s->bppcount;"
    },
    {
        "line": 142,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"Image data is missing\\n\");"
    },
    {
        "line": 150,
        "fullcodeline": "av_log(avctx, AV_LOG_WARNING, \"Tiled TIFF is not allowed to strip\\n\");"
    },
    {
        "line": 183,
        "fullcodeline": "s->photometric == TIFF_PHOTOMETRIC_CFA) {"
    },
    {
        "line": 184,
        "fullcodeline": "p->color_trc = AVCOL_TRC_LINEAR;"
    },
    {
        "line": 209,
        "fullcodeline": "uint8_t *five_planes = NULL;"
    },
    {
        "line": 210,
        "fullcodeline": "int remaining = avpkt->size;"
    },
    {
        "line": 250,
        "fullcodeline": "decoded_height = FFMIN(i, s->height);"
    },
    {
        "line": 58,
        "fullcodeline": "if ((ret = tiff_decode_tag(s, p)) < 0)"
    },
    {
        "line": 82,
        "fullcodeline": "if (!off) {"
    },
    {
        "line": 86,
        "fullcodeline": "if (off <= last_off) {"
    },
    {
        "line": 90,
        "fullcodeline": "if (off >= UINT_MAX - 14 || avpkt->size < off + 14) {"
    },
    {
        "line": 104,
        "fullcodeline": "if (!keyname) {"
    },
    {
        "line": 108,
        "fullcodeline": "if (get_geokey_type(s->geotags[i].key) != s->geotags[i].type) {"
    },
    {
        "line": 113,
        "fullcodeline": "if (ret<0) {"
    },
    {
        "line": 122,
        "fullcodeline": "if (s->bpp % s->bppcount)"
    },
    {
        "line": 125,
        "fullcodeline": "if (bps < 8 || bps > 32)"
    },
    {
        "line": 128,
        "fullcodeline": "if (s->white_level == 0)"
    },
    {
        "line": 131,
        "fullcodeline": "if (s->white_level <= s->black_level) {"
    },
    {
        "line": 158,
        "fullcodeline": "if (s->strips == 1 && !s->stripsize) {"
    },
    {
        "line": 176,
        "fullcodeline": "if (s->rps <= 0 || s->rps % s->subsampling[1]) {"
    },
    {
        "line": 192,
        "fullcodeline": "if (!s->is_jpeg) {"
    },
    {
        "line": 214,
        "fullcodeline": "if (s->photometric == TIFF_PHOTOMETRIC_SEPARATED &&"
    },
    {
        "line": 222,
        "fullcodeline": "for (i = 0; i < s->height; i += s->rps) {"
    },
    {
        "line": 252,
        "fullcodeline": "if (s->predictor == 2) {"
    },
    {
        "line": 293,
        "fullcodeline": "if (s->photometric == TIFF_PHOTOMETRIC_WHITE_IS_ZERO) {"
    },
    {
        "line": 303,
        "fullcodeline": "if (s->photometric == TIFF_PHOTOMETRIC_SEPARATED &&"
    },
    {
        "line": 351,
        "fullcodeline": "for (i = 0; i < s->height; i++) {"
    },
    {
        "line": 24,
        "fullcodeline": "} else if (off >= UINT_MAX - 14 || avpkt->size < off + 14) {"
    },
    {
        "line": 83,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"Requested entry not found\\n\");"
    },
    {
        "line": 87,
        "fullcodeline": "avpriv_request_sample(s->avctx, \"non increasing IFD offset\");"
    },
    {
        "line": 91,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"IFD offset is greater than image size\\n\");"
    },
    {
        "line": 105,
        "fullcodeline": "av_log(avctx, AV_LOG_WARNING, \"Unknown or unsupported GeoTIFF key %d\\n\", s->geotags[i].key);"
    },
    {
        "line": 109,
        "fullcodeline": "av_log(avctx, AV_LOG_WARNING, \"Type of GeoTIFF key %d is wrong\\n\", s->geotags[i].key);"
    },
    {
        "line": 114,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"Writing metadata with key '%s' failed\\n\", keyname);"
    },
    {
        "line": 129,
        "fullcodeline": "s->white_level = (1LL << bps) - 1; /* Default value as per the spec */"
    },
    {
        "line": 159,
        "fullcodeline": "av_log(avctx, AV_LOG_WARNING, \"Image data size missing\\n\");"
    },
    {
        "line": 160,
        "fullcodeline": "s->stripsize = avpkt->size - s->stripoff;"
    },
    {
        "line": 166,
        "fullcodeline": "bytestream2_init(&stripsizes, avpkt->data + s->stripsizesoff,"
    },
    {
        "line": 172,
        "fullcodeline": "bytestream2_init(&stripdata, avpkt->data + s->strippos,"
    },
    {
        "line": 177,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"rps %d invalid\\n\", s->rps);"
    },
    {
        "line": 185,
        "fullcodeline": "} else if (s->photometric == TIFF_PHOTOMETRIC_BLACK_IS_ZERO) {"
    },
    {
        "line": 193,
        "fullcodeline": "avpriv_report_missing_feature(avctx, \"DNG uncompressed tiled images\");"
    },
    {
        "line": 215,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_RGBA) {"
    },
    {
        "line": 216,
        "fullcodeline": "stride = stride * 5 / 4;"
    },
    {
        "line": 217,
        "fullcodeline": "five_planes ="
    },
    {
        "line": 240,
        "fullcodeline": "remaining -= ssize;"
    },
    {
        "line": 257,
        "fullcodeline": "dst   = five_planes ? five_planes : p->data[plane];"
    },
    {
        "line": 258,
        "fullcodeline": "soff  = s->bpp >> 3;"
    },
    {
        "line": 261,
        "fullcodeline": "ssize = s->width * soff;"
    },
    {
        "line": 294,
        "fullcodeline": "int c = (s->avctx->pix_fmt == AV_PIX_FMT_PAL8 ? (1<<s->bpp) - 1 : 255);"
    },
    {
        "line": 304,
        "fullcodeline": "(s->avctx->pix_fmt == AV_PIX_FMT_RGB0 || s->avctx->pix_fmt == AV_PIX_FMT_RGBA)) {"
    },
    {
        "line": 305,
        "fullcodeline": "int x = s->avctx->pix_fmt == AV_PIX_FMT_RGB0 ? 4 : 5;"
    },
    {
        "line": 306,
        "fullcodeline": "uint8_t *src = five_planes ? five_planes : p->data[plane];"
    },
    {
        "line": 322,
        "fullcodeline": "av_freep(&five_planes);"
    },
    {
        "line": 354,
        "fullcodeline": "dst += stride / 2;"
    },
    {
        "line": 25,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"IFD offset is greater than image size\\n\");"
    },
    {
        "line": 78,
        "fullcodeline": "off = s->sub_ifd;"
    },
    {
        "line": 164,
        "fullcodeline": "if (s->stripsizesoff >= (unsigned)avpkt->size)"
    },
    {
        "line": 167,
        "fullcodeline": "avpkt->size - s->stripsizesoff);"
    },
    {
        "line": 170,
        "fullcodeline": "if (s->strippos >= (unsigned)avpkt->size)"
    },
    {
        "line": 173,
        "fullcodeline": "avpkt->size - s->strippos);"
    },
    {
        "line": 186,
        "fullcodeline": "p->color_trc = AVCOL_TRC_GAMMA22;"
    },
    {
        "line": 218,
        "fullcodeline": "dst = av_malloc(stride * s->height);"
    },
    {
        "line": 219,
        "fullcodeline": "if (!dst)"
    },
    {
        "line": 235,
        "fullcodeline": "if (soff > avpkt->size || ssize > avpkt->size - soff || ssize > remaining) {"
    },
    {
        "line": 241,
        "fullcodeline": "if ((ret = tiff_unpack_strip(s, p, dst, stride, avpkt->data + soff, ssize, i,"
    },
    {
        "line": 253,
        "fullcodeline": "if (s->photometric == TIFF_PHOTOMETRIC_YCBCR) {"
    },
    {
        "line": 262,
        "fullcodeline": "if (s->avctx->pix_fmt == AV_PIX_FMT_RGB48LE ||"
    },
    {
        "line": 296,
        "fullcodeline": "for (i = 0; i < s->height; i++) {"
    },
    {
        "line": 308,
        "fullcodeline": "for (i = 0; i < s->height; i++) {"
    },
    {
        "line": 352,
        "fullcodeline": "for (j = 0; j < s->width; j++)"
    },
    {
        "line": 353,
        "fullcodeline": "dst[j] = FFMIN((dst[j] / (float)s->white_level) * 65535, 65535);"
    },
    {
        "line": 195,
        "fullcodeline": "} else if (!s->is_bayer) {"
    },
    {
        "line": 224,
        "fullcodeline": "dst += s->rps * stride;"
    },
    {
        "line": 226,
        "fullcodeline": "ssize = ff_tget(&stripsizes, s->sstype, le);"
    },
    {
        "line": 231,
        "fullcodeline": "soff = ff_tget(&stripdata, s->sot, le);"
    },
    {
        "line": 236,
        "fullcodeline": "av_log(avctx, AV_LOG_ERROR, \"Invalid strip size/offset\\n\");"
    },
    {
        "line": 237,
        "fullcodeline": "av_freep(&five_planes);"
    },
    {
        "line": 254,
        "fullcodeline": "av_log(s->avctx, AV_LOG_ERROR, \"predictor == 2 with YUV is unsupported\");"
    },
    {
        "line": 260,
        "fullcodeline": "soff  = FFMAX(soff / s->bppcount, 1);"
    },
    {
        "line": 267,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_GBRAP16LE) {"
    },
    {
        "line": 299,
        "fullcodeline": "dst += stride;"
    },
    {
        "line": 319,
        "fullcodeline": "src += stride;"
    },
    {
        "line": 320,
        "fullcodeline": "dst += p->linesize[plane];"
    },
    {
        "line": 323,
        "fullcodeline": "} else if (s->photometric == TIFF_PHOTOMETRIC_SEPARATED &&"
    },
    {
        "line": 196,
        "fullcodeline": "avpriv_report_missing_feature(avctx, \"DNG JPG-compressed tiled non-bayer-encoded images\");"
    },
    {
        "line": 220,
        "fullcodeline": "return AVERROR(ENOMEM);"
    },
    {
        "line": 228,
        "fullcodeline": "ssize = s->stripsize;"
    },
    {
        "line": 233,
        "fullcodeline": "soff = s->stripoff;"
    },
    {
        "line": 243,
        "fullcodeline": "if (avctx->err_recognition & AV_EF_EXPLODE) {"
    },
    {
        "line": 266,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_GBRP16LE ||"
    },
    {
        "line": 268,
        "fullcodeline": "for (i = 0; i < decoded_height; i++) {"
    },
    {
        "line": 297,
        "fullcodeline": "for (j = 0; j < stride; j++)"
    },
    {
        "line": 298,
        "fullcodeline": "dst[j] = c - dst[j];"
    },
    {
        "line": 309,
        "fullcodeline": "for (j = 0; j < s->width; j++) {"
    },
    {
        "line": 324,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_RGBA64BE) {"
    },
    {
        "line": 242,
        "fullcodeline": "FFMIN(s->rps, s->height - i))) < 0) {"
    },
    {
        "line": 244,
        "fullcodeline": "av_freep(&five_planes);"
    },
    {
        "line": 265,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_YA16LE ||"
    },
    {
        "line": 271,
        "fullcodeline": "dst += stride;"
    },
    {
        "line": 273,
        "fullcodeline": "} else if (s->avctx->pix_fmt == AV_PIX_FMT_RGB48BE ||"
    },
    {
        "line": 310,
        "fullcodeline": "int k =  255 - src[x * j + 3];"
    },
    {
        "line": 311,
        "fullcodeline": "int r = (255 - src[x * j    ]) * k;"
    },
    {
        "line": 312,
        "fullcodeline": "int g = (255 - src[x * j + 1]) * k;"
    },
    {
        "line": 313,
        "fullcodeline": "int b = (255 - src[x * j + 2]) * k;"
    },
    {
        "line": 314,
        "fullcodeline": "dst[4 * j    ] = r * 257 >> 16;"
    },
    {
        "line": 315,
        "fullcodeline": "dst[4 * j + 1] = g * 257 >> 16;"
    },
    {
        "line": 316,
        "fullcodeline": "dst[4 * j + 2] = b * 257 >> 16;"
    },
    {
        "line": 317,
        "fullcodeline": "dst[4 * j + 3] = s->avctx->pix_fmt == AV_PIX_FMT_RGBA ? src[x * j + 4] : 255;"
    },
    {
        "line": 326,
        "fullcodeline": "for (i = 0; i < s->height; i++) {"
    },
    {
        "line": 199,
        "fullcodeline": "if ((ret = dng_decode_tiles(avctx, (AVFrame*)data, avpkt)) > 0)"
    },
    {
        "line": 264,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_GRAY16LE ||"
    },
    {
        "line": 269,
        "fullcodeline": "for (j = soff; j < ssize; j += 2)"
    },
    {
        "line": 270,
        "fullcodeline": "AV_WL16(dst + j, AV_RL16(dst + j) + AV_RL16(dst + j - soff));"
    },
    {
        "line": 278,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_GBRAP16BE) {"
    },
    {
        "line": 337,
        "fullcodeline": "dst += p->linesize[plane];"
    },
    {
        "line": 200,
        "fullcodeline": "*got_frame = 1;"
    },
    {
        "line": 263,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_RGBA64LE ||"
    },
    {
        "line": 277,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_GBRP16BE ||"
    },
    {
        "line": 279,
        "fullcodeline": "for (i = 0; i < decoded_height; i++) {"
    },
    {
        "line": 327,
        "fullcodeline": "for (j = 0; j < s->width; j++) {"
    },
    {
        "line": 276,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_YA16BE ||"
    },
    {
        "line": 282,
        "fullcodeline": "dst += stride;"
    },
    {
        "line": 285,
        "fullcodeline": "for (i = 0; i < decoded_height; i++) {"
    },
    {
        "line": 328,
        "fullcodeline": "uint64_t k =  65535 - AV_RB16(dst + 8 * j + 6);"
    },
    {
        "line": 329,
        "fullcodeline": "uint64_t r = (65535 - AV_RB16(dst + 8 * j    )) * k;"
    },
    {
        "line": 330,
        "fullcodeline": "uint64_t g = (65535 - AV_RB16(dst + 8 * j + 2)) * k;"
    },
    {
        "line": 331,
        "fullcodeline": "uint64_t b = (65535 - AV_RB16(dst + 8 * j + 4)) * k;"
    },
    {
        "line": 332,
        "fullcodeline": "AV_WB16(dst + 8 * j    , r * 65537 >> 32);"
    },
    {
        "line": 333,
        "fullcodeline": "AV_WB16(dst + 8 * j + 2, g * 65537 >> 32);"
    },
    {
        "line": 334,
        "fullcodeline": "AV_WB16(dst + 8 * j + 4, b * 65537 >> 32);"
    },
    {
        "line": 335,
        "fullcodeline": "AV_WB16(dst + 8 * j + 6, 65535);"
    },
    {
        "line": 275,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_GRAY16BE ||"
    },
    {
        "line": 280,
        "fullcodeline": "for (j = soff; j < ssize; j += 2)"
    },
    {
        "line": 281,
        "fullcodeline": "AV_WB16(dst + j, AV_RB16(dst + j) + AV_RB16(dst + j - soff));"
    },
    {
        "line": 288,
        "fullcodeline": "dst += stride;"
    },
    {
        "line": 274,
        "fullcodeline": "s->avctx->pix_fmt == AV_PIX_FMT_RGBA64BE ||"
    },
    {
        "line": 286,
        "fullcodeline": "for (j = soff; j < ssize; j++)"
    },
    {
        "line": 287,
        "fullcodeline": "dst[j] += dst[j - soff];"
    }
]