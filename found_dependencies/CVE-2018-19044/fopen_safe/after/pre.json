[
    {
        "line": 5,
        "fullcodeline": "int flags = O_NOFOLLOW | O_CREAT;"
    },
    {
        "line": 27,
        "fullcodeline": "fd = open(path, flags, S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP | S_IROTH | S_IWOTH);"
    },
    {
        "line": 31,
        "fullcodeline": "file = fdopen (fd, \"w\");"
    },
    {
        "line": 7,
        "fullcodeline": "if (mode[0] == 'r')"
    },
    {
        "line": 28,
        "fullcodeline": "if (fd == -1)"
    },
    {
        "line": 32,
        "fullcodeline": "if (!file) {"
    },
    {
        "line": 10,
        "fullcodeline": "if (mode[0] != 'a' && mode[0] != 'w')"
    },
    {
        "line": 14,
        "fullcodeline": "(mode[1] != '+' || mode[2]))"
    },
    {
        "line": 18,
        "fullcodeline": "flags |= O_TRUNC;"
    },
    {
        "line": 23,
        "fullcodeline": "flags |= O_RDWR;"
    },
    {
        "line": 8,
        "fullcodeline": "return fopen(path, mode);"
    },
    {
        "line": 20,
        "fullcodeline": "flags |= O_APPEND;"
    },
    {
        "line": 25,
        "fullcodeline": "flags |= O_WRONLY;"
    }
]