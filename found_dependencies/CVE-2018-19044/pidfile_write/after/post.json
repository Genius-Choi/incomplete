[
    {
        "line": 3,
        "fullcodeline": "FILE *pidfile = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "int pidfd = open(pid_file, O_NOFOLLOW | O_CREAT | O_WRONLY | O_TRUNC, S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH);"
    },
    {
        "line": 13,
        "fullcodeline": "fprintf(pidfile, \"%d\\n\", pid);"
    },
    {
        "line": 14,
        "fullcodeline": "fclose(pidfile);"
    },
    {
        "line": 6,
        "fullcodeline": "if (pidfd != -1) pidfile = fdopen(pidfd, \"w\");"
    },
    {
        "line": 8,
        "fullcodeline": "if (!pidfile) {"
    },
    {
        "line": 9,
        "fullcodeline": "log_message(LOG_INFO, \"pidfile_write : Cannot open %s pidfile\","
    }
]