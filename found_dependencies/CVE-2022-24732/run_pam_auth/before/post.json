[
    {
        "line": 11,
        "fullcodeline": "reply->resp = password;"
    },
    {
        "line": 12,
        "fullcodeline": "reply->resp_retcode = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "const struct pam_conv local_conv = { conv_func, reply };"
    },
    {
        "line": 15,
        "fullcodeline": "pam_handle_t *local_auth = NULL;"
    },
    {
        "line": 16,
        "fullcodeline": "int status = pam_start(\"maddy\", username, &local_conv, &local_auth);"
    },
    {
        "line": 25,
        "fullcodeline": "status = pam_authenticate(local_auth, PAM_SILENT|PAM_DISALLOW_NULL_AUTHTOK);"
    },
    {
        "line": 38,
        "fullcodeline": "status = pam_end(local_auth, status);"
    },
    {
        "line": 48,
        "fullcodeline": "ret_val.status = 0;"
    },
    {
        "line": 49,
        "fullcodeline": "ret_val.func_name = NULL;"
    },
    {
        "line": 50,
        "fullcodeline": "ret_val.error_msg = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "if (reply == NULL) {"
    },
    {
        "line": 17,
        "fullcodeline": "if (status != PAM_SUCCESS) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (status != PAM_SUCCESS) {"
    },
    {
        "line": 39,
        "fullcodeline": "if (status != PAM_SUCCESS) {"
    },
    {
        "line": 6,
        "fullcodeline": "ret_val.status = 2;"
    },
    {
        "line": 7,
        "fullcodeline": "ret_val.func_name = \"malloc\";"
    },
    {
        "line": 8,
        "fullcodeline": "ret_val.error_msg = \"Out of memory\";"
    },
    {
        "line": 19,
        "fullcodeline": "ret_val.status = 2;"
    },
    {
        "line": 20,
        "fullcodeline": "ret_val.func_name = \"pam_start\";"
    },
    {
        "line": 21,
        "fullcodeline": "ret_val.error_msg = pam_strerror(local_auth, status);"
    },
    {
        "line": 33,
        "fullcodeline": "ret_val.func_name = \"pam_authenticate\";"
    },
    {
        "line": 34,
        "fullcodeline": "ret_val.error_msg = pam_strerror(local_auth, status);"
    },
    {
        "line": 41,
        "fullcodeline": "ret_val.status = 2;"
    },
    {
        "line": 42,
        "fullcodeline": "ret_val.func_name = \"pam_end\";"
    },
    {
        "line": 43,
        "fullcodeline": "ret_val.error_msg = pam_strerror(local_auth, status);"
    },
    {
        "line": 28,
        "fullcodeline": "if (status == PAM_AUTH_ERR || status == PAM_USER_UNKNOWN) {"
    },
    {
        "line": 29,
        "fullcodeline": "ret_val.status = 1;"
    },
    {
        "line": 31,
        "fullcodeline": "ret_val.status = 2;"
    }
]