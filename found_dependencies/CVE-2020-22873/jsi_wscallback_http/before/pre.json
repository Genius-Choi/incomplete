[
    {
        "line": 5,
        "fullcodeline": "struct lws_context *context = lws_get_context(wsi);"
    },
    {
        "line": 6,
        "fullcodeline": "const char *inPtr = (char*)in;"
    },
    {
        "line": 7,
        "fullcodeline": "char client_name[128], client_ip[128];"
    },
    {
        "line": 8,
        "fullcodeline": "const char *res = \"\";"
    },
    {
        "line": 13,
        "fullcodeline": "jsi_wsCmdObj *cmdPtr = (jsi_wsCmdObj *)lws_context_user(context);"
    },
    {
        "line": 18,
        "fullcodeline": "jsi_wsPss *pss = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "Jsi_Interp *interp = cmdPtr->interp;"
    },
    {
        "line": 21,
        "fullcodeline": "int rc = 0, deflt = 0;"
    },
    {
        "line": 23,
        "fullcodeline": "WSSIGASSERT(cmdPtr, OBJ);"
    },
    {
        "line": 14,
        "fullcodeline": "if (!cmdPtr) {"
    },
    {
        "line": 24,
        "fullcodeline": "if (Jsi_InterpGone(interp))"
    },
    {
        "line": 27,
        "fullcodeline": "if (cmdPtr->debug>=128)"
    },
    {
        "line": 15,
        "fullcodeline": "fprintf(stderr, \"bad ws context\\n\");"
    },
    {
        "line": 25,
        "fullcodeline": "cmdPtr->deleted = 1;"
    },
    {
        "line": 28,
        "fullcodeline": "fprintf(stderr, \"HTTP CALLBACK: len=%d, %p %d:%s\\n\", (int)len, user, reason, jsw_getReasonStr(reason));"
    },
    {
        "line": 71,
        "fullcodeline": "deflt = 1;"
    },
    {
        "line": 76,
        "fullcodeline": "if (deflt && cmdPtr->debug>16 && cmdPtr->debug<128) {"
    },
    {
        "line": 77,
        "fullcodeline": "fprintf(stderr, \"HTTP CALLBACK: len=%d, %p %d:%s\\n\", (int)len, user, reason, jsw_getReasonStr(reason));"
    },
    {
        "line": 167,
        "fullcodeline": "pss = jsi_wsgetPss(cmdPtr, wsi, user, 1, 1);"
    },
    {
        "line": 169,
        "fullcodeline": "jsi_wsgetUriArgValue(interp, wsi, &pss->query, &pss->queryObj);"
    },
    {
        "line": 176,
        "fullcodeline": "Jsi_DSSetLength(&pss->dHdrs, 0);"
    },
    {
        "line": 177,
        "fullcodeline": "pss->hdrNum = jsi_wsGetHeaders(pss, wsi, &pss->dHdrs, pss->hdrSz, sizeof(pss->hdrSz)/sizeof(int));"
    },
    {
        "line": 210,
        "fullcodeline": "client_name[0] = 0;"
    },
    {
        "line": 211,
        "fullcodeline": "client_ip[0] = 0;"
    },
    {
        "line": 212,
        "fullcodeline": "lws_get_peer_addresses(wsi, lws_get_socket_fd(wsi), client_name,"
    },
    {
        "line": 412,
        "fullcodeline": "rc = -1;"
    },
    {
        "line": 419,
        "fullcodeline": "fprintf(stderr, \"<---HTTP RET = %d\\n\", rc);"
    },
    {
        "line": 16,
        "fullcodeline": "return -1;"
    },
    {
        "line": 151,
        "fullcodeline": "if (cmdPtr->debug>2)"
    },
    {
        "line": 153,
        "fullcodeline": "if (!pss)"
    },
    {
        "line": 165,
        "fullcodeline": "if (cmdPtr->debug>1)"
    },
    {
        "line": 179,
        "fullcodeline": "if (cmdPtr->onFilter && !cmdPtr->deleted) {"
    },
    {
        "line": 219,
        "fullcodeline": "if (cmdPtr->clientName || cmdPtr->clientIP) {"
    },
    {
        "line": 246,
        "fullcodeline": "Jsi_DSInit(&dStr);"
    },
    {
        "line": 249,
        "fullcodeline": "rc = jsi_wsHttp(interp, cmdPtr, wsi, user, context, inPtr, &dStr, pss);"
    },
    {
        "line": 353,
        "fullcodeline": "int sent = 0;"
    },
    {
        "line": 400,
        "fullcodeline": "rc = -1;"
    },
    {
        "line": 414,
        "fullcodeline": "rc = 0;"
    },
    {
        "line": 152,
        "fullcodeline": "fprintf(stderr, \"CLOSED\\n\");"
    },
    {
        "line": 154,
        "fullcodeline": "pss = jsi_wsgetPss(cmdPtr, wsi, user, 0, 1);"
    },
    {
        "line": 166,
        "fullcodeline": "fprintf(stderr, \"FILTER CONNECTION: %s\\n\", inPtr);"
    },
    {
        "line": 171,
        "fullcodeline": "if (cmdPtr->instCtx == context && (cmdPtr->clientName[0] || cmdPtr->clientIP[0])) {"
    },
    {
        "line": 172,
        "fullcodeline": "pss->clientName = cmdPtr->clientName;"
    },
    {
        "line": 173,
        "fullcodeline": "pss->clientIP = cmdPtr->clientIP;"
    },
    {
        "line": 181,
        "fullcodeline": "int killcon = 0, n = 0;"
    },
    {
        "line": 183,
        "fullcodeline": "Jsi_Value *vpargs, *vargs[10], *ret = Jsi_ValueNew1(interp);"
    },
    {
        "line": 187,
        "fullcodeline": "vargs[n++] = Jsi_ValueNewBoolean(interp, 1);"
    },
    {
        "line": 188,
        "fullcodeline": "vpargs = Jsi_ValueMakeObject(interp, NULL, oarg1 = Jsi_ObjNewArray(interp, vargs, n, 0));"
    },
    {
        "line": 189,
        "fullcodeline": "Jsi_IncrRefCount(interp, vpargs);"
    },
    {
        "line": 190,
        "fullcodeline": "Jsi_ValueMakeUndef(interp, &ret);"
    },
    {
        "line": 191,
        "fullcodeline": "rc = Jsi_FunctionInvoke(interp, cmdPtr->onFilter, vpargs, &ret, NULL);"
    },
    {
        "line": 198,
        "fullcodeline": "Jsi_DecrRefCount(interp, vpargs);"
    },
    {
        "line": 215,
        "fullcodeline": "cmdPtr->clientName = Jsi_KeyAdd(interp, client_name);"
    },
    {
        "line": 217,
        "fullcodeline": "cmdPtr->clientIP = Jsi_KeyAdd(interp, client_ip);"
    },
    {
        "line": 220,
        "fullcodeline": "const char *loname = cmdPtr->localhostName;"
    },
    {
        "line": 235,
        "fullcodeline": "if (cmdPtr->maxConnects && cmdPtr->stats.connectCnt>=cmdPtr->maxConnects) {"
    },
    {
        "line": 238,
        "fullcodeline": "rc = -1;"
    },
    {
        "line": 251,
        "fullcodeline": "if (rc<0)"
    },
    {
        "line": 253,
        "fullcodeline": "if (rc==1) {"
    },
    {
        "line": 344,
        "fullcodeline": "if (!pss)"
    },
    {
        "line": 354,
        "fullcodeline": "unsigned char buffer[JSI_BUFSIZ*10 + LWS_PRE];"
    },
    {
        "line": 184,
        "fullcodeline": "vargs[n++] = Jsi_ValueNewObj(interp, cmdPtr->fobj);"
    },
    {
        "line": 185,
        "fullcodeline": "vargs[n++] = Jsi_ValueNewNumber(interp, (Jsi_Number)(pss->wid));"
    },
    {
        "line": 186,
        "fullcodeline": "vargs[n++] = Jsi_ValueNewBlob(interp, (uchar*)in, len);"
    },
    {
        "line": 200,
        "fullcodeline": "if (rc != JSI_OK) {"
    },
    {
        "line": 221,
        "fullcodeline": "if (!loname) loname = \"localhost\";"
    },
    {
        "line": 223,
        "fullcodeline": "if (cmdPtr->debug>1)"
    },
    {
        "line": 236,
        "fullcodeline": "if (cmdPtr->debug>1)"
    },
    {
        "line": 248,
        "fullcodeline": "fprintf(stderr, \"HTTP GET: %s\\n\", inPtr);"
    },
    {
        "line": 345,
        "fullcodeline": "pss = jsi_wsgetPss(cmdPtr, wsi, user, 0, 1);"
    },
    {
        "line": 347,
        "fullcodeline": "if (!pss || !pss->fop_fd)"
    },
    {
        "line": 356,
        "fullcodeline": "int n = sizeof(buffer) - LWS_PRE;"
    },
    {
        "line": 357,
        "fullcodeline": "int m = lws_get_peer_write_allowance(wsi);"
    },
    {
        "line": 364,
        "fullcodeline": "lws_filepos_t amount = 0;"
    },
    {
        "line": 365,
        "fullcodeline": "n = lws_vfs_file_read(pss->fop_fd, &amount, buffer + LWS_PRE, n);"
    },
    {
        "line": 370,
        "fullcodeline": "n = (int)amount;"
    },
    {
        "line": 380,
        "fullcodeline": "m = jsi_wswrite(pss, wsi, buffer + LWS_PRE, n, LWS_WRITE_HTTP);"
    },
    {
        "line": 388,
        "fullcodeline": "sent += m;"
    },
    {
        "line": 390,
        "fullcodeline": "} while (!lws_send_pipe_choked(wsi) && (sent < 500 * 1024 * 1024));"
    },
    {
        "line": 192,
        "fullcodeline": "if (rc == JSI_OK && Jsi_ValueIsFalse(interp, ret)) {"
    },
    {
        "line": 224,
        "fullcodeline": "fprintf(stderr,  \"Received network connect from %s (%s)\\n\","
    },
    {
        "line": 227,
        "fullcodeline": "if (cmdPtr->local && (cmdPtr->clientName && Jsi_Strcmp(cmdPtr->clientName, loname))) {"
    },
    {
        "line": 237,
        "fullcodeline": "fprintf(stderr, \"maxConnects exceeded: rejecting connection <%p>\\n\", user);"
    },
    {
        "line": 252,
        "fullcodeline": "return -1;"
    },
    {
        "line": 358,
        "fullcodeline": "if (m == 0)"
    },
    {
        "line": 371,
        "fullcodeline": "if (n == 0)"
    },
    {
        "line": 381,
        "fullcodeline": "if (m < 0) {"
    },
    {
        "line": 193,
        "fullcodeline": "if (cmdPtr->debug>1)"
    },
    {
        "line": 361,
        "fullcodeline": "if (m != -1 && m < n)"
    },
    {
        "line": 362,
        "fullcodeline": "n = m;"
    },
    {
        "line": 387,
        "fullcodeline": "lws_set_timeout(wsi, PENDING_TIMEOUT_HTTP_CONTENT, 5);"
    },
    {
        "line": 194,
        "fullcodeline": "fprintf(stderr, \"WS:KILLING CONNECTION: %p\\n\", pss);"
    }
]