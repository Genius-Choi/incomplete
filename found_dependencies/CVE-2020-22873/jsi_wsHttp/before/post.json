[
    {
        "line": 4,
        "fullcodeline": "const char *ext = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned char buffer[JSI_BUFSIZ];"
    },
    {
        "line": 6,
        "fullcodeline": "const char *mime = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "time_t now = time(NULL);"
    },
    {
        "line": 8,
        "fullcodeline": "char buf[JSI_BUFSIZ];"
    },
    {
        "line": 9,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "buf[0] = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "uchar *p = buffer, *end = &buffer[sizeof(buffer)-1];"
    },
    {
        "line": 13,
        "fullcodeline": "Jsi_Value* fname = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "bool isJsiWeb = 0, isSSI = 0;"
    },
    {
        "line": 15,
        "fullcodeline": "cmdPtr->stats.httpLast = now;"
    },
    {
        "line": 23,
        "fullcodeline": "int uplen=(cmdPtr->urlPrefix?Jsi_Strlen(cmdPtr->urlPrefix):0);"
    },
    {
        "line": 127,
        "fullcodeline": "ext = Jsi_Strrchr(inPtr, '.');"
    },
    {
        "line": 129,
        "fullcodeline": "Jsi_Value *rdir = (pss->rootdir?pss->rootdir:cmdPtr->rootdir);"
    },
    {
        "line": 130,
        "fullcodeline": "cmdPtr->curRoot = (rdir?Jsi_ValueString(cmdPtr->interp, rdir, NULL):\"./\");"
    },
    {
        "line": 132,
        "fullcodeline": "Jsi_DSInit(&sStr);"
    },
    {
        "line": 133,
        "fullcodeline": "jsi_wsPathAlias(interp, cmdPtr, &inPtr, &sStr);"
    },
    {
        "line": 135,
        "fullcodeline": "snprintf(buf, sizeof(buf), \"%s/%s\", cmdPtr->curRoot, inPtr);"
    },
    {
        "line": 136,
        "fullcodeline": "Jsi_DSFree(&sStr);"
    },
    {
        "line": 139,
        "fullcodeline": "char extBuf[100], *cpde = Jsi_Strrchr(buf, '/');"
    },
    {
        "line": 140,
        "fullcodeline": "isJsiWeb = (cpde && cmdPtr->jsiFnPattern && Jsi_GlobMatch(cmdPtr->jsiFnPattern, cpde+1, 0));"
    },
    {
        "line": 141,
        "fullcodeline": "bool isgzip = 0;"
    },
    {
        "line": 293,
        "fullcodeline": "fname = Jsi_ValueNewStringDup(interp, buf);"
    },
    {
        "line": 294,
        "fullcodeline": "Jsi_IncrRefCount(interp, fname);"
    },
    {
        "line": 296,
        "fullcodeline": "Jsi_DString hStr = {};"
    },
    {
        "line": 298,
        "fullcodeline": "bool native = Jsi_FSNative(interp, fname);"
    },
    {
        "line": 344,
        "fullcodeline": "n = 0;"
    },
    {
        "line": 360,
        "fullcodeline": "static const char stsStr[] = \"max-age=15768000 ; includeSubDomains\";"
    },
    {
        "line": 366,
        "fullcodeline": "n = p - buffer;"
    },
    {
        "line": 369,
        "fullcodeline": "p = buffer;"
    },
    {
        "line": 382,
        "fullcodeline": "n = Jsi_DSLength(&hStr);"
    },
    {
        "line": 433,
        "fullcodeline": "Jsi_DSFree(&hStr);"
    },
    {
        "line": 437,
        "fullcodeline": "rc = 1;"
    },
    {
        "line": 18,
        "fullcodeline": "if (lws_hdr_total_length(wsi, WSI_TOKEN_POST_URI))"
    },
    {
        "line": 20,
        "fullcodeline": "if (!pss)"
    },
    {
        "line": 25,
        "fullcodeline": "if (inPtr && cmdPtr->urlPrefix && !Jsi_Strncmp(inPtr, cmdPtr->urlPrefix, uplen))"
    },
    {
        "line": 35,
        "fullcodeline": "if ((cmdPtr->urlRedirect && (inPtr == 0 || *inPtr == 0 || !Jsi_Strcmp(inPtr, \"/\")) && !cmdPtr->redirDisable)"
    },
    {
        "line": 46,
        "fullcodeline": "if (!inPtr || !*inPtr)"
    },
    {
        "line": 49,
        "fullcodeline": "if (cmdPtr->useridPass || cmdPtr->onAuth) {"
    },
    {
        "line": 104,
        "fullcodeline": "if (cmdPtr->onGet || pss->onGet) {"
    },
    {
        "line": 137,
        "fullcodeline": "if (cmdPtr->debug>1)"
    },
    {
        "line": 142,
        "fullcodeline": "if (!ext || !ext[1])"
    },
    {
        "line": 288,
        "fullcodeline": "if (!buf[0]) {"
    },
    {
        "line": 299,
        "fullcodeline": "if ((native && Jsi_InterpSafe(interp) && Jsi_InterpAccess(interp, fname, JSI_INTACCESS_READ) != JSI_OK) ||"
    },
    {
        "line": 333,
        "fullcodeline": "if (!ext || isSSI)"
    },
    {
        "line": 335,
        "fullcodeline": "if (S_ISDIR(jsb.st_mode)) {"
    },
    {
        "line": 361,
        "fullcodeline": "if (lws_is_ssl(wsi) && lws_add_http_header_by_name(wsi,"
    },
    {
        "line": 367,
        "fullcodeline": "if (n>0)"
    },
    {
        "line": 376,
        "fullcodeline": "if (cmdPtr->headers && !jsi_wsAddHeader(interp, cmdPtr, wsi, cmdPtr->headers, &hStr))"
    },
    {
        "line": 379,
        "fullcodeline": "if (pss->headers && !jsi_wsAddHeader(interp, cmdPtr, wsi, pss->headers, &hStr))"
    },
    {
        "line": 384,
        "fullcodeline": "if (native && !isSSI && !isJsiWeb) {"
    },
    {
        "line": 21,
        "fullcodeline": "pss = jsi_wsgetPss(cmdPtr, wsi, user, 1, 1);"
    },
    {
        "line": 26,
        "fullcodeline": "inPtr += uplen;"
    },
    {
        "line": 42,
        "fullcodeline": "cmdPtr->stats.redirLast = now;"
    },
    {
        "line": 43,
        "fullcodeline": "rc = lws_http_redirect(wsi, 301, (uchar*)inPtr, Jsi_Strlen(inPtr), &p, end);"
    },
    {
        "line": 47,
        "fullcodeline": "inPtr = \"/\";"
    },
    {
        "line": 50,
        "fullcodeline": "int ok = 0;"
    },
    {
        "line": 52,
        "fullcodeline": "const char *auth = jsi_wsHeader(pss, \"authorization\", &alen);"
    },
    {
        "line": 106,
        "fullcodeline": "int rrv = 1;"
    },
    {
        "line": 138,
        "fullcodeline": "fprintf(stderr, \"FILE: %s in %s | %s\\n\", buf, cmdPtr->curRoot, Jsi_ValueString(interp, cmdPtr->rootdir, NULL));"
    },
    {
        "line": 143,
        "fullcodeline": "mime = \"text/html\";"
    },
    {
        "line": 300,
        "fullcodeline": "(Jsi_Stat(interp, fname, &jsb) || jsb.st_size<=0)) {"
    },
    {
        "line": 330,
        "fullcodeline": "Jsi_DecrRefCount(interp, fname);"
    },
    {
        "line": 338,
        "fullcodeline": "rc = jsi_wsServeString(pss, wsi, \"<b style='color:red'>ERROR: can not serve directory!</b>\", 404, NULL, NULL);"
    },
    {
        "line": 339,
        "fullcodeline": "Jsi_DecrRefCount(interp, fname);"
    },
    {
        "line": 368,
        "fullcodeline": "Jsi_DSAppendLen(&hStr, (char*)buffer, n);"
    },
    {
        "line": 390,
        "fullcodeline": "int hrc = lws_serve_http_file(wsi, buf, mime, Jsi_DSValue(&hStr), Jsi_DSLength(&hStr));"
    },
    {
        "line": 393,
        "fullcodeline": "Jsi_DecrRefCount(interp, fname);"
    },
    {
        "line": 29,
        "fullcodeline": "if (difftime(now, cmdPtr->stats.redirLast)>=600)"
    },
    {
        "line": 36,
        "fullcodeline": "&& (inPtr = cmdPtr->urlRedirect) && inPtr[0]) {"
    },
    {
        "line": 39,
        "fullcodeline": "if (cmdPtr->redirMax>0 && !cmdPtr->redirDisable && cmdPtr->redirMax>0 && cmdPtr->stats.redirLast"
    },
    {
        "line": 44,
        "fullcodeline": "return (rc == 100 ? 0 : 1);"
    },
    {
        "line": 53,
        "fullcodeline": "if (auth && !Jsi_Strncasecmp(auth, \"basic \", 6) && !cmdPtr->deleted) {"
    },
    {
        "line": 92,
        "fullcodeline": "if (!ok) {"
    },
    {
        "line": 145,
        "fullcodeline": "const char *eext = ext+1;"
    },
    {
        "line": 146,
        "fullcodeline": "uint elen = Jsi_Strlen(ext);"
    },
    {
        "line": 185,
        "fullcodeline": "isSSI = jsi_wsIsSSIExt(interp, cmdPtr, pss, eext);"
    },
    {
        "line": 291,
        "fullcodeline": "return -1;"
    },
    {
        "line": 302,
        "fullcodeline": "if (cmdPtr->onUnknown || pss->onUnknown) {"
    },
    {
        "line": 311,
        "fullcodeline": "if (0 && Jsi_Strstr(buf, \"favicon.ico\"))"
    },
    {
        "line": 336,
        "fullcodeline": "if (cmdPtr->noWarn==0)"
    },
    {
        "line": 362,
        "fullcodeline": "(uchar *) \"Strict-Transport-Security:\","
    },
    {
        "line": 363,
        "fullcodeline": "(uchar *) stsStr,"
    },
    {
        "line": 364,
        "fullcodeline": "sizeof(stsStr)-1, &p, (uchar *)buffer + sizeof(buffer)))"
    },
    {
        "line": 372,
        "fullcodeline": "if (lws_add_http_header_by_token(wsi, WSI_TOKEN_HTTP_CONTENT_ENCODING,"
    },
    {
        "line": 386,
        "fullcodeline": "if (!jsi_wsAddStdHeader(interp, cmdPtr, wsi, &hStr)) {"
    },
    {
        "line": 391,
        "fullcodeline": "if (hrc >= 0 && cmdPtr->onModify)"
    },
    {
        "line": 394,
        "fullcodeline": "if (hrc<0) {"
    },
    {
        "line": 402,
        "fullcodeline": "Jsi_DString dStr = {}, fStr = {};"
    },
    {
        "line": 414,
        "fullcodeline": "int hrc = jsi_wsServeHeader(pss, wsi, (int)Jsi_DSLength(&fStr), 200, Jsi_DSValue(&hStr), mime, &dStr);"
    },
    {
        "line": 421,
        "fullcodeline": "Jsi_DecrRefCount(interp, fname);"
    },
    {
        "line": 422,
        "fullcodeline": "Jsi_DSFree(&dStr);"
    },
    {
        "line": 423,
        "fullcodeline": "Jsi_DSFree(&fStr);"
    },
    {
        "line": 30,
        "fullcodeline": "cmdPtr->redirDisable = 0;"
    },
    {
        "line": 40,
        "fullcodeline": "&& difftime(now, cmdPtr->stats.redirLast)<600 && ++cmdPtr->redirAllCnt>cmdPtr->redirMax)"
    },
    {
        "line": 41,
        "fullcodeline": "cmdPtr->redirDisable = 100;"
    },
    {
        "line": 54,
        "fullcodeline": "auth += 6;"
    },
    {
        "line": 55,
        "fullcodeline": "Jsi_DString eStr = {}, bStr = {};"
    },
    {
        "line": 56,
        "fullcodeline": "Jsi_DSAppendLen(&eStr, auth, alen - 6);"
    },
    {
        "line": 57,
        "fullcodeline": "Jsi_Base64(Jsi_DSValue(&eStr), -1, &bStr, 1);"
    },
    {
        "line": 58,
        "fullcodeline": "const char *bp = Jsi_DSValue(&bStr);"
    },
    {
        "line": 89,
        "fullcodeline": "Jsi_DSFree(&eStr);"
    },
    {
        "line": 90,
        "fullcodeline": "Jsi_DSFree(&bStr);"
    },
    {
        "line": 93,
        "fullcodeline": "const char *realm = (cmdPtr->realm?cmdPtr->realm:\"jsish\");"
    },
    {
        "line": 94,
        "fullcodeline": "int n = snprintf(buf, sizeof(buf), \"Basic realm=\\\"%s\\\"\", realm);"
    },
    {
        "line": 108,
        "fullcodeline": "rrv = 0;"
    },
    {
        "line": 109,
        "fullcodeline": "jrc = Jsi_RegExpMatch(interp, cmdPtr->getRegexp, inPtr, &rrv, NULL);"
    },
    {
        "line": 114,
        "fullcodeline": "jrc = jsi_wsGetCmd(interp, cmdPtr, pss, wsi, inPtr, pss->onGet?pss->onGet:cmdPtr->onGet, tStr);"
    },
    {
        "line": 147,
        "fullcodeline": "if (elen>3 && elen<(sizeof(extBuf)-10) && !Jsi_Strcmp(ext+elen-3,\".gz\")) {"
    },
    {
        "line": 164,
        "fullcodeline": "if (!mime) {"
    },
    {
        "line": 187,
        "fullcodeline": "if ((hPtr = Jsi_HashEntryFind(cmdPtr->handlers, ext)) && !cmdPtr->deleted) {"
    },
    {
        "line": 290,
        "fullcodeline": "fprintf(stderr, \"empty file: %s\\n\", inPtr);"
    },
    {
        "line": 303,
        "fullcodeline": "Jsi_Value *uk = (pss->onUnknown?pss->onUnknown:cmdPtr->onUnknown);"
    },
    {
        "line": 304,
        "fullcodeline": "Jsi_RC jrc = jsi_wsGetCmd(interp, cmdPtr, pss, wsi, inPtr, uk, NULL);"
    },
    {
        "line": 312,
        "fullcodeline": "rc = jsi_wsServeString(pss, wsi, \"data:;base64,iVBORw0KGgo=\", 200, NULL, \"image/icon\");"
    },
    {
        "line": 337,
        "fullcodeline": "fprintf(stderr, \"can not serve directory: %s\\n\", buf);"
    },
    {
        "line": 373,
        "fullcodeline": "(unsigned char *)\"gzip\", n, &p, end))"
    },
    {
        "line": 387,
        "fullcodeline": "Jsi_DecrRefCount(interp, fname);"
    },
    {
        "line": 392,
        "fullcodeline": "jsi_wsFileAdd(interp, cmdPtr, fname);"
    },
    {
        "line": 410,
        "fullcodeline": "if (rc != JSI_OK) {"
    },
    {
        "line": 415,
        "fullcodeline": "if (hrc>=0) {"
    },
    {
        "line": 424,
        "fullcodeline": "if (hrc<0) {"
    },
    {
        "line": 32,
        "fullcodeline": "cmdPtr->redirDisable--;"
    },
    {
        "line": 59,
        "fullcodeline": "if (bp && bp[0]) {"
    },
    {
        "line": 95,
        "fullcodeline": "if (lws_add_http_header_by_token(wsi, WSI_TOKEN_HTTP_WWW_AUTHENTICATE,"
    },
    {
        "line": 98,
        "fullcodeline": "if (jsi_wsServeString(pss, wsi, \"Password is required to access this page\", 401, (char*)buffer, NULL)<0)"
    },
    {
        "line": 100,
        "fullcodeline": "return lws_http_transaction_completed(wsi);"
    },
    {
        "line": 110,
        "fullcodeline": "if (jrc != JSI_OK)"
    },
    {
        "line": 148,
        "fullcodeline": "Jsi_Strcpy(extBuf, ext);"
    },
    {
        "line": 149,
        "fullcodeline": "extBuf[elen-3] = 0;"
    },
    {
        "line": 150,
        "fullcodeline": "char *ext2 = Jsi_Strrchr(extBuf, '.');"
    },
    {
        "line": 160,
        "fullcodeline": "Jsi_Value *mVal = Jsi_ValueObjLookup(interp, cmdPtr->mimeTypes, ext+1, 1);"
    },
    {
        "line": 165,
        "fullcodeline": "static const char* mtypes[] = {"
    },
    {
        "line": 176,
        "fullcodeline": "mime = \"text/html\";"
    },
    {
        "line": 189,
        "fullcodeline": "Jsi_DString jStr = {};"
    },
    {
        "line": 190,
        "fullcodeline": "Jsi_Value *vrc = NULL;"
    },
    {
        "line": 191,
        "fullcodeline": "int hrc = 0, strLen, evrc, isalloc=0;"
    },
    {
        "line": 192,
        "fullcodeline": "char *vStr, *hstr = NULL;"
    },
    {
        "line": 193,
        "fullcodeline": "jsi_wsHander *hdlPtr = (jsi_wsHander*)Jsi_HashValueGet(hPtr);"
    },
    {
        "line": 194,
        "fullcodeline": "Jsi_Value *hv = hdlPtr->val;"
    },
    {
        "line": 200,
        "fullcodeline": "cmdPtr->handlersPkg=1;"
    },
    {
        "line": 280,
        "fullcodeline": "Jsi_DSFree(&jStr);"
    },
    {
        "line": 305,
        "fullcodeline": "if (jrc == JSI_ERROR)"
    },
    {
        "line": 307,
        "fullcodeline": "if (jrc == JSI_OK)"
    },
    {
        "line": 314,
        "fullcodeline": "const char *cp = Jsi_Strrchr(buf,'/');"
    },
    {
        "line": 328,
        "fullcodeline": "rc = jsi_wsServeString(pss, wsi, \"<b style='color:red'>ERROR: can not serve file!</b>\", 404, NULL, NULL);"
    },
    {
        "line": 395,
        "fullcodeline": "if (cmdPtr->noWarn==0)"
    },
    {
        "line": 404,
        "fullcodeline": "rc = jsi_wsEvalSSI(interp, cmdPtr, fname, &fStr, 1, pss);"
    },
    {
        "line": 411,
        "fullcodeline": "Jsi_DSFree(&fStr);"
    },
    {
        "line": 416,
        "fullcodeline": "Jsi_DSAppendLen(&dStr, Jsi_DSValue(&fStr), Jsi_DSLength(&fStr));"
    },
    {
        "line": 417,
        "fullcodeline": "char *strVal = Jsi_DSValue(&dStr);"
    },
    {
        "line": 418,
        "fullcodeline": "int strLen = Jsi_DSLength(&dStr);"
    },
    {
        "line": 419,
        "fullcodeline": "hrc = jsi_wswrite(pss, wsi, (unsigned char*)strVal, strLen, LWS_WRITE_HTTP);"
    },
    {
        "line": 96,
        "fullcodeline": "(unsigned char *)buf, n, &p, end))"
    },
    {
        "line": 121,
        "fullcodeline": "inPtr = Jsi_DSValue(tStr); break;"
    },
    {
        "line": 178,
        "fullcodeline": "for (i=0; mtypes[i]; i+=2)"
    },
    {
        "line": 196,
        "fullcodeline": "if (Jsi_Strchr(buf, '\\'') || Jsi_Strchr(buf, '\\\"')) {"
    },
    {
        "line": 203,
        "fullcodeline": "if ((hdlPtr->flags&1) && cmdPtr->handlersPkg && Jsi_ValueIsString(interp, hv)"
    },
    {
        "line": 225,
        "fullcodeline": "if ((hdlPtr->flags&2) && !hdlPtr->triedLoad && !hdlPtr->objVar && Jsi_ValueIsFunction(interp, hv)) {"
    },
    {
        "line": 272,
        "fullcodeline": "if (evrc != JSI_OK) {"
    },
    {
        "line": 283,
        "fullcodeline": "if (hrc<=0)"
    },
    {
        "line": 315,
        "fullcodeline": "if (cp && cp[1]) {"
    },
    {
        "line": 326,
        "fullcodeline": "if (cmdPtr->noWarn==0 && !Jsi_Strstr(buf, \"favicon.ico\"))"
    },
    {
        "line": 396,
        "fullcodeline": "fprintf(stderr, \"can not serve file (%d): %s\\n\", hrc, buf);"
    },
    {
        "line": 398,
        "fullcodeline": "} else if (hrc > 0 && lws_http_transaction_completed(wsi))"
    },
    {
        "line": 406,
        "fullcodeline": "rc = jsi_wsFileRead(interp, fname, &fStr, cmdPtr, pss);"
    },
    {
        "line": 425,
        "fullcodeline": "if (cmdPtr->noWarn==0)"
    },
    {
        "line": 60,
        "fullcodeline": "if (!cmdPtr->onAuth)"
    },
    {
        "line": 97,
        "fullcodeline": "return -1;"
    },
    {
        "line": 99,
        "fullcodeline": "return -1;"
    },
    {
        "line": 111,
        "fullcodeline": "return -1; // Error in regexp."
    },
    {
        "line": 116,
        "fullcodeline": "case JSI_ERROR: return -1;"
    },
    {
        "line": 119,
        "fullcodeline": "return jsi_ws_http_redirect(wsi, 302, tStr, &p, end);"
    },
    {
        "line": 152,
        "fullcodeline": "isgzip = 1;"
    },
    {
        "line": 153,
        "fullcodeline": "ext = ext2;"
    },
    {
        "line": 162,
        "fullcodeline": "mime = Jsi_ValueString(interp, mVal, NULL);"
    },
    {
        "line": 179,
        "fullcodeline": "if (tolower(*eext) == mtypes[i][0] && !Jsi_Strncasecmp(eext, mtypes[i], -1)) {"
    },
    {
        "line": 197,
        "fullcodeline": "jsi_wsServeString(pss, wsi, \"Can not handle quotes in url\", 404, NULL, NULL);"
    },
    {
        "line": 204,
        "fullcodeline": "&& ((hstr = Jsi_ValueString(interp, hv, NULL)))) {"
    },
    {
        "line": 205,
        "fullcodeline": "vrc = Jsi_NameLookup(interp, hstr);"
    },
    {
        "line": 220,
        "fullcodeline": "hdlPtr->val = vrc;"
    },
    {
        "line": 221,
        "fullcodeline": "Jsi_IncrRefCount(interp, vrc);"
    },
    {
        "line": 222,
        "fullcodeline": "hv = vrc;"
    },
    {
        "line": 227,
        "fullcodeline": "hdlPtr->triedLoad = 1;"
    },
    {
        "line": 228,
        "fullcodeline": "Jsi_DSAppend(&jStr, \"[null]\", NULL);"
    },
    {
        "line": 229,
        "fullcodeline": "Jsi_DSAppend(&jStr, \"]\", NULL);"
    },
    {
        "line": 230,
        "fullcodeline": "vrc = Jsi_ValueNew1(interp);"
    },
    {
        "line": 231,
        "fullcodeline": "evrc = Jsi_FunctionInvokeJSON(interp, hv, Jsi_DSValue(&jStr), &vrc);"
    },
    {
        "line": 239,
        "fullcodeline": "Jsi_Value *fvrc = Jsi_ValueObjLookup(interp, vrc, \"parse\", 0);"
    },
    {
        "line": 245,
        "fullcodeline": "hdlPtr->objVar = fvrc;"
    },
    {
        "line": 246,
        "fullcodeline": "Jsi_IncrRefCount(interp, fvrc);"
    },
    {
        "line": 247,
        "fullcodeline": "hv = vrc;"
    },
    {
        "line": 252,
        "fullcodeline": "Jsi_DSAppend(&jStr, \"[\\\"\", buf, \"\\\"]\", NULL); // TODO: JSON encode."
    },
    {
        "line": 253,
        "fullcodeline": "vrc = Jsi_ValueNew1(interp);"
    },
    {
        "line": 254,
        "fullcodeline": "evrc = Jsi_FunctionInvokeJSON(interp, hdlPtr->objVar, Jsi_DSValue(&jStr), &vrc);"
    },
    {
        "line": 255,
        "fullcodeline": "isalloc = 1;"
    },
    {
        "line": 273,
        "fullcodeline": "Jsi_LogError(\"failure in websocket handler\");"
    },
    {
        "line": 282,
        "fullcodeline": "Jsi_DecrRefCount(interp, vrc);"
    },
    {
        "line": 316,
        "fullcodeline": "char statPath[PATH_MAX];"
    },
    {
        "line": 317,
        "fullcodeline": "snprintf(statPath, sizeof(statPath), \"/zvfs/lib/web%s\", cp);"
    },
    {
        "line": 318,
        "fullcodeline": "Jsi_DecrRefCount(interp, fname);"
    },
    {
        "line": 319,
        "fullcodeline": "fname = Jsi_ValueNewStringDup(interp, statPath);"
    },
    {
        "line": 320,
        "fullcodeline": "Jsi_IncrRefCount(interp, fname);"
    },
    {
        "line": 327,
        "fullcodeline": "fprintf(stderr, \"failed open file for read: %s\\n\", buf);"
    },
    {
        "line": 426,
        "fullcodeline": "fprintf(stderr, \"can not serve data (%d): %s\\n\", hrc, buf);"
    },
    {
        "line": 428,
        "fullcodeline": "} else if (hrc > 0 && lws_http_transaction_completed(wsi))"
    },
    {
        "line": 61,
        "fullcodeline": "ok = (!Jsi_Strcmp(cmdPtr->useridPass, bp));"
    },
    {
        "line": 180,
        "fullcodeline": "mime = mtypes[i+1];"
    },
    {
        "line": 198,
        "fullcodeline": "return -1;"
    },
    {
        "line": 206,
        "fullcodeline": "if (!vrc) {"
    },
    {
        "line": 211,
        "fullcodeline": "if (!vrc || !Jsi_ValueIsFunction(interp, vrc)) {"
    },
    {
        "line": 232,
        "fullcodeline": "if (Jsi_InterpGone(interp))"
    },
    {
        "line": 234,
        "fullcodeline": "if (evrc != JSI_OK || !vrc || !Jsi_ValueIsObjType(interp, vrc, JSI_OT_OBJECT)) {"
    },
    {
        "line": 240,
        "fullcodeline": "if (!fvrc || !Jsi_ValueIsFunction(interp, fvrc)) {"
    },
    {
        "line": 284,
        "fullcodeline": "return -1;"
    },
    {
        "line": 321,
        "fullcodeline": "if (!Jsi_Stat(interp, fname, &jsb) && jsb.st_size>0) {"
    },
    {
        "line": 408,
        "fullcodeline": "Jsi_DSAppend(&fStr, \"\\nwindow.jsiWebSocket=true;\", NULL);"
    },
    {
        "line": 65,
        "fullcodeline": "Jsi_Value *vpargs, *vargs[10];"
    },
    {
        "line": 66,
        "fullcodeline": "int n = 0;"
    },
    {
        "line": 67,
        "fullcodeline": "vargs[n++] = Jsi_ValueNewObj(interp, cmdPtr->fobj);"
    },
    {
        "line": 68,
        "fullcodeline": "vargs[n++] = Jsi_ValueNewNumber(interp, (Jsi_Number)(pss->wid));"
    },
    {
        "line": 69,
        "fullcodeline": "vargs[n++] = Jsi_ValueNewStringDup(interp, inPtr);"
    },
    {
        "line": 70,
        "fullcodeline": "vargs[n++] = Jsi_ValueNewStringDup(interp, bp);"
    },
    {
        "line": 71,
        "fullcodeline": "vpargs = Jsi_ValueMakeObject(interp, NULL, oarg1 = Jsi_ObjNewArray(interp, vargs, n, 0));"
    },
    {
        "line": 72,
        "fullcodeline": "Jsi_IncrRefCount(interp, vpargs);"
    },
    {
        "line": 73,
        "fullcodeline": "Jsi_Value *ret = Jsi_ValueNew1(interp);"
    },
    {
        "line": 74,
        "fullcodeline": "bool rb = 0;"
    },
    {
        "line": 75,
        "fullcodeline": "rc = Jsi_FunctionInvoke(interp, cmdPtr->onAuth, vpargs, &ret, NULL);"
    },
    {
        "line": 79,
        "fullcodeline": "Jsi_DecrRefCount(interp, vpargs);"
    },
    {
        "line": 80,
        "fullcodeline": "Jsi_DecrRefCount(interp, ret);"
    },
    {
        "line": 86,
        "fullcodeline": "ok = rb;"
    },
    {
        "line": 207,
        "fullcodeline": "Jsi_Number pver = Jsi_PkgRequire(interp, hstr, 0);"
    },
    {
        "line": 214,
        "fullcodeline": "Jsi_LogError(\"Failed to autoload handle: %s\", hstr);"
    },
    {
        "line": 215,
        "fullcodeline": "jsi_wsServeString(pss, wsi, \"Failed to autoload handler\", 404, NULL, NULL);"
    },
    {
        "line": 219,
        "fullcodeline": "Jsi_DecrRefCount(interp, hdlPtr->val);"
    },
    {
        "line": 235,
        "fullcodeline": "Jsi_LogError(\"Failed to load obj: %s\", hstr);"
    },
    {
        "line": 236,
        "fullcodeline": "jsi_wsServeString(pss, wsi, \"Failed to load obj\", 404, NULL, NULL);"
    },
    {
        "line": 241,
        "fullcodeline": "Jsi_LogError(\"Failed to find parse: %s\", hstr);"
    },
    {
        "line": 242,
        "fullcodeline": "jsi_wsServeString(pss, wsi, \"Failed to find parse\", 404, NULL, NULL);"
    },
    {
        "line": 257,
        "fullcodeline": "else if (Jsi_ValueIsFunction(interp, hv)) {"
    },
    {
        "line": 274,
        "fullcodeline": "} else if ((!vrc) ||"
    },
    {
        "line": 322,
        "fullcodeline": "native = 0;"
    },
    {
        "line": 76,
        "fullcodeline": "if (rc == JSI_OK)"
    },
    {
        "line": 82,
        "fullcodeline": "if (rc != JSI_OK) {"
    },
    {
        "line": 208,
        "fullcodeline": "if (pver >= 0)"
    },
    {
        "line": 216,
        "fullcodeline": "return -1;"
    },
    {
        "line": 233,
        "fullcodeline": "return -1;"
    },
    {
        "line": 237,
        "fullcodeline": "return -1;"
    },
    {
        "line": 243,
        "fullcodeline": "return -1;"
    },
    {
        "line": 259,
        "fullcodeline": "Jsi_DSAppend(&jStr, \"[\\\"\", buf, \"\\\", {wsName:\\\"\", Jsi_DSValue(&cmdPtr->cName), \"\\\"\", \"}]\", NULL); // TODO: JSON encode."
    },
    {
        "line": 260,
        "fullcodeline": "vrc = Jsi_ValueNew1(interp);"
    },
    {
        "line": 261,
        "fullcodeline": "evrc = Jsi_FunctionInvokeJSON(interp, hv, Jsi_DSValue(&jStr), &vrc);"
    },
    {
        "line": 262,
        "fullcodeline": "isalloc = 1;"
    },
    {
        "line": 275,
        "fullcodeline": "(!(vStr = Jsi_ValueString(interp, vrc, &strLen)))) {"
    },
    {
        "line": 276,
        "fullcodeline": "Jsi_LogError(\"failed to get result\");"
    },
    {
        "line": 77,
        "fullcodeline": "rb = !Jsi_ValueIsFalse(interp, ret);"
    },
    {
        "line": 83,
        "fullcodeline": "Jsi_LogError(\"websock bad rcv eval\");"
    },
    {
        "line": 209,
        "fullcodeline": "vrc = Jsi_NameLookup(interp, hstr);"
    },
    {
        "line": 213,
        "fullcodeline": "Jsi_DecrRefCount(interp, vrc);"
    },
    {
        "line": 265,
        "fullcodeline": "hstr = Jsi_ValueString(interp, hv, NULL);"
    },
    {
        "line": 266,
        "fullcodeline": "Jsi_DSAppend(&jStr, hstr, \"('\", buf, \"');\", NULL);"
    },
    {
        "line": 267,
        "fullcodeline": "evrc = Jsi_EvalString(interp, Jsi_DSValue(&jStr), JSI_EVAL_RETURN);"
    },
    {
        "line": 278,
        "fullcodeline": "hrc = jsi_wsServeString(pss, wsi, vStr, 0, NULL, mime);"
    },
    {
        "line": 84,
        "fullcodeline": "return -1;"
    },
    {
        "line": 268,
        "fullcodeline": "if (evrc == JSI_OK)"
    },
    {
        "line": 269,
        "fullcodeline": "vrc = Jsi_InterpResult(interp);"
    }
]