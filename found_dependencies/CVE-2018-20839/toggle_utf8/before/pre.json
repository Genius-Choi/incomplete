[
    {
        "line": 3,
        "fullcodeline": "struct termios tc = {};"
    },
    {
        "line": 5,
        "fullcodeline": "assert(name);"
    },
    {
        "line": 7,
        "fullcodeline": "r = ioctl(fd, KDSKBMODE, utf8 ? K_UNICODE : K_XLATE);"
    },
    {
        "line": 11,
        "fullcodeline": "r = loop_write(fd, utf8 ? \"\\033%G\" : \"\\033%@\", 3, false);"
    },
    {
        "line": 15,
        "fullcodeline": "r = tcgetattr(fd, &tc);"
    },
    {
        "line": 8,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 12,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 16,
        "fullcodeline": "if (r >= 0) {"
    },
    {
        "line": 23,
        "fullcodeline": "log_debug(\"UTF-8 kbdmode %sd on %s\", enable_disable(utf8), name);"
    },
    {
        "line": 17,
        "fullcodeline": "SET_FLAG(tc.c_iflag, IUTF8, utf8);"
    },
    {
        "line": 18,
        "fullcodeline": "r = tcsetattr(fd, TCSANOW, &tc);"
    },
    {
        "line": 9,
        "fullcodeline": "return log_warning_errno(errno, \"Failed to %s UTF-8 kbdmode on %s: %m\", enable_disable(utf8), name);"
    },
    {
        "line": 13,
        "fullcodeline": "return log_warning_errno(r, \"Failed to %s UTF-8 term processing on %s: %m\", enable_disable(utf8), name);"
    },
    {
        "line": 21,
        "fullcodeline": "return log_warning_errno(errno, \"Failed to %s iutf8 flag on %s: %m\", enable_disable(utf8), name);"
    }
]