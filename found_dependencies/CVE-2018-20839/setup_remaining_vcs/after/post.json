[
    {
        "line": 2,
        "fullcodeline": "struct console_font_op cfo = {"
    },
    {
        "line": 7,
        "fullcodeline": "struct unimapinit adv = {};"
    },
    {
        "line": 9,
        "fullcodeline": "_cleanup_free_ struct unipair* unipairs = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "_cleanup_free_ void *fontbuf = NULL;"
    },
    {
        "line": 21,
        "fullcodeline": "r = ioctl(src_fd, KDFONTOP, &cfo);"
    },
    {
        "line": 15,
        "fullcodeline": "if (!unipairs) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 58,
        "fullcodeline": "if (cfo.op != KD_FONT_OP_SET)"
    },
    {
        "line": 61,
        "fullcodeline": "for (i = 1; i <= 63; i++) {"
    },
    {
        "line": 16,
        "fullcodeline": "log_oom();"
    },
    {
        "line": 23,
        "fullcodeline": "log_warning_errno(errno, \"KD_FONT_OP_GET failed while trying to get the font metadata: %m\");"
    },
    {
        "line": 59,
        "fullcodeline": "log_warning(\"Fonts will not be copied to remaining consoles\");"
    },
    {
        "line": 63,
        "fullcodeline": "_cleanup_close_ int fd_d = -1;"
    },
    {
        "line": 69,
        "fullcodeline": "xsprintf(ttyname, \"/dev/tty%u\", i);"
    },
    {
        "line": 70,
        "fullcodeline": "fd_d = open_terminal(ttyname, O_RDWR|O_CLOEXEC|O_NOCTTY);"
    },
    {
        "line": 79,
        "fullcodeline": "toggle_utf8(ttyname, fd_d, utf8);"
    },
    {
        "line": 84,
        "fullcodeline": "r = ioctl(fd_d, KDFONTOP, &cfo);"
    },
    {
        "line": 109,
        "fullcodeline": "r = ioctl(fd_d, PIO_UNIMAPCLR, &adv);"
    },
    {
        "line": 115,
        "fullcodeline": "r = ioctl(fd_d, PIO_UNIMAP, &unimapd);"
    },
    {
        "line": 121,
        "fullcodeline": "log_debug(\"Font and unimap successfully copied to %s\", ttyname);"
    },
    {
        "line": 3,
        "fullcodeline": ".op = KD_FONT_OP_GET,"
    },
    {
        "line": 4,
        "fullcodeline": ".width = UINT_MAX, .height = UINT_MAX,"
    },
    {
        "line": 5,
        "fullcodeline": ".charcount = UINT_MAX,"
    },
    {
        "line": 65,
        "fullcodeline": "if (i == src_idx || verify_vc_allocation(i) < 0)"
    },
    {
        "line": 71,
        "fullcodeline": "if (fd_d < 0) {"
    },
    {
        "line": 76,
        "fullcodeline": "if (vt_verify_kbmode(fd_d) < 0)"
    },
    {
        "line": 81,
        "fullcodeline": "if (cfo.op != KD_FONT_OP_SET)"
    },
    {
        "line": 85,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 110,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 116,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (cfo.width > 32 || cfo.height > 32 || cfo.charcount > 512)"
    },
    {
        "line": 72,
        "fullcodeline": "log_warning_errno(fd_d, \"Unable to open tty%u, fonts will not be copied: %m\", i);"
    },
    {
        "line": 96,
        "fullcodeline": "last_errno = errno;"
    },
    {
        "line": 111,
        "fullcodeline": "log_warning_errno(errno, \"PIO_UNIMAPCLR failed, unimaps might be incorrect for tty%u: %m\", i);"
    },
    {
        "line": 117,
        "fullcodeline": "log_warning_errno(errno, \"PIO_UNIMAP failed, unimaps might be incorrect for tty%u: %m\", i);"
    },
    {
        "line": 27,
        "fullcodeline": "log_warning(\"Invalid font metadata - width: %u (max 32), height: %u (max 32), count: %u (max 512)\","
    },
    {
        "line": 97,
        "fullcodeline": "if (ioctl(fd_d, KDGETMODE, &mode) >= 0 && mode != KD_TEXT)"
    },
    {
        "line": 36,
        "fullcodeline": "fontbuf = malloc_multiply((cfo.width + 7) / 8 * 32, cfo.charcount);"
    },
    {
        "line": 42,
        "fullcodeline": "cfo.data = fontbuf;"
    },
    {
        "line": 43,
        "fullcodeline": "r = ioctl(src_fd, KDFONTOP, &cfo);"
    },
    {
        "line": 98,
        "fullcodeline": "log_debug(\"KD_FONT_OP_SET skipped: tty%u is not in text mode\", i);"
    },
    {
        "line": 37,
        "fullcodeline": "if (!fontbuf) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 100,
        "fullcodeline": "log_warning_errno(last_errno, \"KD_FONT_OP_SET failed, fonts will not be copied to tty%u: %m\", i);"
    },
    {
        "line": 38,
        "fullcodeline": "log_oom();"
    },
    {
        "line": 45,
        "fullcodeline": "log_warning_errno(errno, \"KD_FONT_OP_GET failed while trying to read the font data: %m\");"
    },
    {
        "line": 47,
        "fullcodeline": "unimapd.entries  = unipairs;"
    },
    {
        "line": 48,
        "fullcodeline": "unimapd.entry_ct = USHRT_MAX;"
    },
    {
        "line": 49,
        "fullcodeline": "r = ioctl(src_fd, GIO_UNIMAP, &unimapd);"
    },
    {
        "line": 50,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 51,
        "fullcodeline": "log_warning_errno(errno, \"GIO_UNIMAP failed while trying to read unicode mappings: %m\");"
    },
    {
        "line": 53,
        "fullcodeline": "cfo.op = KD_FONT_OP_SET;"
    }
]