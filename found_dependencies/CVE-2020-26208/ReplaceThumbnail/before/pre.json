[
    {
        "line": 49,
        "fullcodeline": "ExifSection = FindSection(M_EXIF);"
    },
    {
        "line": 51,
        "fullcodeline": "NewExifSize = ImageInfo.ThumbnailOffset+8+ThumbLen;"
    },
    {
        "line": 52,
        "fullcodeline": "ExifSection->Data = (uchar *)realloc(ExifSection->Data, NewExifSize);"
    },
    {
        "line": 54,
        "fullcodeline": "ThumbnailPointer = ExifSection->Data+ImageInfo.ThumbnailOffset+8;"
    },
    {
        "line": 8,
        "fullcodeline": "if (ImageInfo.ThumbnailOffset == 0 || ImageInfo.ThumbnailAtEnd == FALSE){"
    },
    {
        "line": 67,
        "fullcodeline": "ExifSection->Data[0] = (uchar)(NewExifSize >> 8);"
    },
    {
        "line": 17,
        "fullcodeline": "fprintf(stderr,\"Image contains no thumbnail to replace - add is not possible\\n\");"
    },
    {
        "line": 22,
        "fullcodeline": "ThumbnailFile = fopen(ThumbFileName,\"rb\");"
    },
    {
        "line": 31,
        "fullcodeline": "fseek(ThumbnailFile, 0, SEEK_END);"
    },
    {
        "line": 33,
        "fullcodeline": "ThumbLen = ftell(ThumbnailFile);"
    },
    {
        "line": 34,
        "fullcodeline": "fseek(ThumbnailFile, 0, SEEK_SET);"
    },
    {
        "line": 9,
        "fullcodeline": "if (ThumbFileName == NULL){"
    },
    {
        "line": 24,
        "fullcodeline": "if (ThumbnailFile == NULL){"
    },
    {
        "line": 44,
        "fullcodeline": "ThumbLen = 0;"
    },
    {
        "line": 46,
        "fullcodeline": "ThumbnailFile = NULL;"
    },
    {
        "line": 57,
        "fullcodeline": "if (fread(ThumbnailPointer, 1, ThumbLen, ThumbnailFile) != ThumbLen){"
    },
    {
        "line": 36,
        "fullcodeline": "if (ThumbLen + ImageInfo.ThumbnailOffset > 0x10000-20){"
    }
]