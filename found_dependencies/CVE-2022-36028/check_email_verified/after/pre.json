[
    {
        "line": 3,
        "fullcodeline": "if user.has_role? :super_admin"
    },
    {
        "line": 4,
        "fullcodeline": "redirect_to admins_path"
    },
    {
        "line": 7,
        "fullcodeline": "dont_redirect_to = [root_url, signin_url, ldap_signin_url, ldap_callback_url, signup_url, unauthorized_url,"
    },
    {
        "line": 14,
        "fullcodeline": "valid_url = cookies[:return_to] && URI.parse(cookies[:return_to]).host == URI.parse(request.original_url).host"
    },
    {
        "line": 27,
        "fullcodeline": "redirect_to url"
    },
    {
        "line": 31,
        "fullcodeline": "redirect_to account_activation_path(digest: user.activation_digest)"
    },
    {
        "line": 11,
        "fullcodeline": "dont_redirect_to.push(File.join(ENV['OAUTH2_REDIRECT'], \"auth\", \"openid_connect\", \"callback\"))"
    },
    {
        "line": 16,
        "fullcodeline": "url = if cookies[:return_to] && valid_url && !dont_redirect_to.include?(cookies[:return_to])"
    },
    {
        "line": 17,
        "fullcodeline": "cookies[:return_to]"
    },
    {
        "line": 18,
        "fullcodeline": "elsif user.role.get_permission(\"can_create_rooms\")"
    },
    {
        "line": 19,
        "fullcodeline": "user.main_room"
    },
    {
        "line": 20,
        "fullcodeline": "else"
    },
    {
        "line": 25,
        "fullcodeline": "cookies.delete :return_to if cookies[:return_to]"
    }
]