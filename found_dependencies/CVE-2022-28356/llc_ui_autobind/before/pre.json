[
    {
        "line": 3,
        "fullcodeline": "struct sock *sk = sock->sk;"
    },
    {
        "line": 4,
        "fullcodeline": "struct llc_sock *llc = llc_sk(sk);"
    },
    {
        "line": 6,
        "fullcodeline": "int rc = -EINVAL;"
    },
    {
        "line": 14,
        "fullcodeline": "rc = -ENODEV;"
    },
    {
        "line": 25,
        "fullcodeline": "netdev_tracker_alloc(llc->dev, &llc->dev_tracker, GFP_KERNEL);"
    },
    {
        "line": 26,
        "fullcodeline": "rc = -EUSERS;"
    },
    {
        "line": 27,
        "fullcodeline": "llc->laddr.lsap = llc_ui_autoport();"
    },
    {
        "line": 30,
        "fullcodeline": "rc = -EBUSY; /* some other network layer is using the sap */"
    },
    {
        "line": 31,
        "fullcodeline": "sap = llc_sap_open(llc->laddr.lsap, NULL);"
    },
    {
        "line": 34,
        "fullcodeline": "memcpy(llc->laddr.mac, llc->dev->dev_addr, IFHWADDRLEN);"
    },
    {
        "line": 35,
        "fullcodeline": "memcpy(&llc->addr, addr, sizeof(llc->addr));"
    },
    {
        "line": 37,
        "fullcodeline": "llc_sap_add_socket(sap, sk);"
    },
    {
        "line": 38,
        "fullcodeline": "sock_reset_flag(sk, SOCK_ZAPPED);"
    },
    {
        "line": 39,
        "fullcodeline": "rc = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "if (!sock_flag(sk, SOCK_ZAPPED))"
    },
    {
        "line": 10,
        "fullcodeline": "if (!addr->sllc_arphrd)"
    },
    {
        "line": 12,
        "fullcodeline": "if (addr->sllc_arphrd != ARPHRD_ETHER)"
    },
    {
        "line": 23,
        "fullcodeline": "if (!llc->dev)"
    },
    {
        "line": 28,
        "fullcodeline": "if (!llc->laddr.lsap)"
    },
    {
        "line": 32,
        "fullcodeline": "if (!sap)"
    },
    {
        "line": 11,
        "fullcodeline": "addr->sllc_arphrd = ARPHRD_ETHER;"
    },
    {
        "line": 16,
        "fullcodeline": "llc->dev = dev_get_by_index(&init_net, sk->sk_bound_dev_if);"
    },
    {
        "line": 17,
        "fullcodeline": "if (llc->dev && addr->sllc_arphrd != llc->dev->type) {"
    },
    {
        "line": 22,
        "fullcodeline": "llc->dev = dev_getfirstbyhwtype(&init_net, addr->sllc_arphrd);"
    },
    {
        "line": 18,
        "fullcodeline": "dev_put(llc->dev);"
    },
    {
        "line": 19,
        "fullcodeline": "llc->dev = NULL;"
    }
]