[
    {
        "line": 2,
        "fullcodeline": "from flask_login import current_user"
    },
    {
        "line": 4,
        "fullcodeline": "redirect_url = request.args.get(\"redirect\", request.script_root + url_for(\"index\"))"
    },
    {
        "line": 5,
        "fullcodeline": "permissions = sorted("
    },
    {
        "line": 18,
        "fullcodeline": "user_id = request.args.get(\"user_id\", \"\")"
    },
    {
        "line": 25,
        "fullcodeline": "render_kwargs = {"
    },
    {
        "line": 15,
        "fullcodeline": "if not permissions:"
    },
    {
        "line": 20,
        "fullcodeline": "if (not user_id or current_user.get_id() == user_id) and has_permissions("
    },
    {
        "line": 44,
        "fullcodeline": "return render_template(\"login.jinja2\", **render_kwargs)"
    },
    {
        "line": 6,
        "fullcodeline": "filter("
    },
    {
        "line": 16,
        "fullcodeline": "permissions = [Permissions.STATUS, Permissions.SETTINGS_READ]"
    },
    {
        "line": 34,
        "fullcodeline": "additional_assets = _add_additional_assets(\"octoprint.theming.login\")"
    },
    {
        "line": 37,
        "fullcodeline": "additional_assets += _add_additional_assets(\"octoprint.plugin.forcelogin.theming\")"
    },
    {
        "line": 38,
        "fullcodeline": "additional_assets += _add_additional_assets(\"octoprint.plugin.loginui.theming\")"
    },
    {
        "line": 40,
        "fullcodeline": "render_kwargs.update({\"theming\": additional_assets})"
    },
    {
        "line": 8,
        "fullcodeline": "map("
    },
    {
        "line": 21,
        "fullcodeline": "*permissions"
    },
    {
        "line": 23,
        "fullcodeline": "return redirect(redirect_url)"
    },
    {
        "line": 28,
        "fullcodeline": "\"permission_names\": map(lambda x: x.get_name(), permissions),"
    },
    {
        "line": 30,
        "fullcodeline": "\"logged_in\": not current_user.is_anonymous,"
    },
    {
        "line": 42,
        "fullcodeline": "_logger.exception(\"Error processing theming CSS, ignoring\")"
    },
    {
        "line": 10,
        "fullcodeline": "request.args.get(\"permissions\", \"\").split(\",\"),"
    }
]