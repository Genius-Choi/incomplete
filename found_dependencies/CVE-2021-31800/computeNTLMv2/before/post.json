[
    {
        "line": 5,
        "fullcodeline": "responseKeyNT = ntlm.NTOWFv2(identity, '', authenticateMessage['domain_name'].decode('utf-16le'), nthash)"
    },
    {
        "line": 6,
        "fullcodeline": "responseKeyLM = ntlm.LMOWFv2(identity, '', authenticateMessage['domain_name'].decode('utf-16le'), lmhash)"
    },
    {
        "line": 8,
        "fullcodeline": "ntProofStr = authenticateMessage['ntlm'][:16]"
    },
    {
        "line": 9,
        "fullcodeline": "temp = authenticateMessage['ntlm'][16:]"
    },
    {
        "line": 10,
        "fullcodeline": "ntProofStr2 = ntlm.hmac_md5(responseKeyNT, serverChallenge + temp)"
    },
    {
        "line": 11,
        "fullcodeline": "lmChallengeResponse = authenticateMessage['lanman']"
    },
    {
        "line": 12,
        "fullcodeline": "sessionBaseKey = ntlm.hmac_md5(responseKeyNT, ntProofStr)"
    },
    {
        "line": 14,
        "fullcodeline": "responseFlags = type1['flags']"
    },
    {
        "line": 36,
        "fullcodeline": "keyExchangeKey = ntlm.KXKEY(ntlmChallenge['flags'], sessionBaseKey, lmChallengeResponse,"
    },
    {
        "line": 17,
        "fullcodeline": "if (ntlmChallenge['flags'] & ntlm.NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY) == 0:"
    },
    {
        "line": 20,
        "fullcodeline": "if (ntlmChallenge['flags'] & ntlm.NTLMSSP_NEGOTIATE_128) == 0:"
    },
    {
        "line": 23,
        "fullcodeline": "if (ntlmChallenge['flags'] & ntlm.NTLMSSP_NEGOTIATE_KEY_EXCH) == 0:"
    },
    {
        "line": 26,
        "fullcodeline": "if (ntlmChallenge['flags'] & ntlm.NTLMSSP_NEGOTIATE_SEAL) == 0:"
    },
    {
        "line": 29,
        "fullcodeline": "if (ntlmChallenge['flags'] & ntlm.NTLMSSP_NEGOTIATE_SIGN) == 0:"
    },
    {
        "line": 32,
        "fullcodeline": "if (ntlmChallenge['flags'] & ntlm.NTLMSSP_NEGOTIATE_ALWAYS_SIGN) == 0:"
    },
    {
        "line": 41,
        "fullcodeline": "if ntlmChallenge['flags'] & ntlm.NTLMSSP_NEGOTIATE_KEY_EXCH:"
    },
    {
        "line": 50,
        "fullcodeline": "if ntProofStr == ntProofStr2:"
    },
    {
        "line": 19,
        "fullcodeline": "responseFlags &= 0xffffffff ^ ntlm.NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY"
    },
    {
        "line": 22,
        "fullcodeline": "responseFlags &= 0xffffffff ^ ntlm.NTLMSSP_NEGOTIATE_128"
    },
    {
        "line": 25,
        "fullcodeline": "responseFlags &= 0xffffffff ^ ntlm.NTLMSSP_NEGOTIATE_KEY_EXCH"
    },
    {
        "line": 28,
        "fullcodeline": "responseFlags &= 0xffffffff ^ ntlm.NTLMSSP_NEGOTIATE_SEAL"
    },
    {
        "line": 31,
        "fullcodeline": "responseFlags &= 0xffffffff ^ ntlm.NTLMSSP_NEGOTIATE_SIGN"
    },
    {
        "line": 34,
        "fullcodeline": "responseFlags &= 0xffffffff ^ ntlm.NTLMSSP_NEGOTIATE_ALWAYS_SIGN"
    },
    {
        "line": 42,
        "fullcodeline": "exportedSessionKey = authenticateMessage['session_key']"
    },
    {
        "line": 43,
        "fullcodeline": "exportedSessionKey = ntlm.generateEncryptedSessionKey(keyExchangeKey, exportedSessionKey)"
    },
    {
        "line": 45,
        "fullcodeline": "encryptedRandomSessionKey = None"
    },
    {
        "line": 47,
        "fullcodeline": "exportedSessionKey = keyExchangeKey"
    },
    {
        "line": 52,
        "fullcodeline": "return STATUS_SUCCESS, exportedSessionKey"
    },
    {
        "line": 54,
        "fullcodeline": "return STATUS_LOGON_FAILURE, exportedSessionKey"
    }
]