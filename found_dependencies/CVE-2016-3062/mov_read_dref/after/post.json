[
    {
        "line": 10,
        "fullcodeline": "sc = st->priv_data;"
    },
    {
        "line": 12,
        "fullcodeline": "avio_rb32(pb); // version + flags"
    },
    {
        "line": 13,
        "fullcodeline": "entries = avio_rb32(pb);"
    },
    {
        "line": 16,
        "fullcodeline": "av_free(sc->drefs);"
    },
    {
        "line": 17,
        "fullcodeline": "sc->drefs_count = 0;"
    },
    {
        "line": 18,
        "fullcodeline": "sc->drefs = av_mallocz(entries * sizeof(*sc->drefs));"
    },
    {
        "line": 21,
        "fullcodeline": "sc->drefs_count = entries;"
    },
    {
        "line": 7,
        "fullcodeline": "if (c->fc->nb_streams < 1)"
    },
    {
        "line": 14,
        "fullcodeline": "if (entries >= UINT_MAX / sizeof(*sc->drefs))"
    },
    {
        "line": 19,
        "fullcodeline": "if (!sc->drefs)"
    },
    {
        "line": 23,
        "fullcodeline": "for (i = 0; i < sc->drefs_count; i++) {"
    },
    {
        "line": 9,
        "fullcodeline": "st = c->fc->streams[c->fc->nb_streams-1];"
    },
    {
        "line": 24,
        "fullcodeline": "MOVDref *dref = &sc->drefs[i];"
    },
    {
        "line": 25,
        "fullcodeline": "uint32_t size = avio_rb32(pb);"
    },
    {
        "line": 26,
        "fullcodeline": "int64_t next = avio_tell(pb) + size - 4;"
    },
    {
        "line": 31,
        "fullcodeline": "dref->type = avio_rl32(pb);"
    },
    {
        "line": 32,
        "fullcodeline": "avio_rb32(pb); // version + flags"
    },
    {
        "line": 33,
        "fullcodeline": "av_dlog(c->fc, \"type %.4s size %d\\n\", (char*)&dref->type, size);"
    },
    {
        "line": 104,
        "fullcodeline": "avio_seek(pb, next, SEEK_SET);"
    },
    {
        "line": 20,
        "fullcodeline": "return AVERROR(ENOMEM);"
    },
    {
        "line": 28,
        "fullcodeline": "if (size < 12)"
    },
    {
        "line": 35,
        "fullcodeline": "if (dref->type == MKTAG('a','l','i','s') && size > 150) {"
    },
    {
        "line": 40,
        "fullcodeline": "avio_skip(pb, 10);"
    },
    {
        "line": 42,
        "fullcodeline": "volume_len = avio_r8(pb);"
    },
    {
        "line": 43,
        "fullcodeline": "volume_len = FFMIN(volume_len, 27);"
    },
    {
        "line": 44,
        "fullcodeline": "avio_read(pb, dref->volume, 27);"
    },
    {
        "line": 45,
        "fullcodeline": "dref->volume[volume_len] = 0;"
    },
    {
        "line": 46,
        "fullcodeline": "av_log(c->fc, AV_LOG_DEBUG, \"volume %s, len %d\\n\", dref->volume, volume_len);"
    },
    {
        "line": 48,
        "fullcodeline": "avio_skip(pb, 12);"
    },
    {
        "line": 50,
        "fullcodeline": "len = avio_r8(pb);"
    },
    {
        "line": 51,
        "fullcodeline": "len = FFMIN(len, 63);"
    },
    {
        "line": 52,
        "fullcodeline": "avio_read(pb, dref->filename, 63);"
    },
    {
        "line": 53,
        "fullcodeline": "dref->filename[len] = 0;"
    },
    {
        "line": 54,
        "fullcodeline": "av_log(c->fc, AV_LOG_DEBUG, \"filename %s, len %d\\n\", dref->filename, len);"
    },
    {
        "line": 56,
        "fullcodeline": "avio_skip(pb, 16);"
    },
    {
        "line": 59,
        "fullcodeline": "dref->nlvl_from = avio_rb16(pb);"
    },
    {
        "line": 60,
        "fullcodeline": "dref->nlvl_to   = avio_rb16(pb);"
    },
    {
        "line": 61,
        "fullcodeline": "av_log(c->fc, AV_LOG_DEBUG, \"nlvl from %d, nlvl to %d\\n\","
    },
    {
        "line": 64,
        "fullcodeline": "avio_skip(pb, 16);"
    },
    {
        "line": 66,
        "fullcodeline": "for (type = 0; type != -1 && avio_tell(pb) < next; ) {"
    },
    {
        "line": 69,
        "fullcodeline": "type = avio_rb16(pb);"
    },
    {
        "line": 70,
        "fullcodeline": "len = avio_rb16(pb);"
    },
    {
        "line": 71,
        "fullcodeline": "av_log(c->fc, AV_LOG_DEBUG, \"type %d, len %d\\n\", type, len);"
    },
    {
        "line": 67,
        "fullcodeline": "if(url_feof(pb))"
    },
    {
        "line": 72,
        "fullcodeline": "if (len&1)"
    },
    {
        "line": 74,
        "fullcodeline": "if (type == 2) { // absolute path"
    },
    {
        "line": 73,
        "fullcodeline": "len += 1;"
    },
    {
        "line": 75,
        "fullcodeline": "av_free(dref->path);"
    },
    {
        "line": 76,
        "fullcodeline": "dref->path = av_mallocz(len+1);"
    },
    {
        "line": 79,
        "fullcodeline": "avio_read(pb, dref->path, len);"
    },
    {
        "line": 88,
        "fullcodeline": "av_log(c->fc, AV_LOG_DEBUG, \"path %s\\n\", dref->path);"
    },
    {
        "line": 77,
        "fullcodeline": "if (!dref->path)"
    },
    {
        "line": 80,
        "fullcodeline": "if (len > volume_len && !strncmp(dref->path, dref->volume, volume_len)) {"
    },
    {
        "line": 85,
        "fullcodeline": "for (j = 0; j < len; j++)"
    },
    {
        "line": 81,
        "fullcodeline": "len -= volume_len;"
    },
    {
        "line": 82,
        "fullcodeline": "memmove(dref->path, dref->path+volume_len, len);"
    },
    {
        "line": 83,
        "fullcodeline": "dref->path[len] = 0;"
    },
    {
        "line": 86,
        "fullcodeline": "if (dref->path[j] == ':')"
    },
    {
        "line": 89,
        "fullcodeline": "} else if (type == 0) { // directory name"
    },
    {
        "line": 78,
        "fullcodeline": "return AVERROR(ENOMEM);"
    },
    {
        "line": 87,
        "fullcodeline": "dref->path[j] = '/';"
    },
    {
        "line": 90,
        "fullcodeline": "av_free(dref->dir);"
    },
    {
        "line": 91,
        "fullcodeline": "dref->dir = av_malloc(len+1);"
    },
    {
        "line": 94,
        "fullcodeline": "avio_read(pb, dref->dir, len);"
    },
    {
        "line": 95,
        "fullcodeline": "dref->dir[len] = 0;"
    },
    {
        "line": 99,
        "fullcodeline": "av_log(c->fc, AV_LOG_DEBUG, \"dir %s\\n\", dref->dir);"
    },
    {
        "line": 92,
        "fullcodeline": "if (!dref->dir)"
    },
    {
        "line": 96,
        "fullcodeline": "for (j = 0; j < len; j++)"
    },
    {
        "line": 101,
        "fullcodeline": "avio_skip(pb, len);"
    },
    {
        "line": 97,
        "fullcodeline": "if (dref->dir[j] == ':')"
    },
    {
        "line": 93,
        "fullcodeline": "return AVERROR(ENOMEM);"
    },
    {
        "line": 98,
        "fullcodeline": "dref->dir[j] = '/';"
    }
]