[
    {
        "line": 5,
        "fullcodeline": "struct vfsmount *rootmnt = NULL, *pwdmnt = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "BUG_ON(!ns);"
    },
    {
        "line": 18,
        "fullcodeline": "old = ns->root;"
    },
    {
        "line": 20,
        "fullcodeline": "new_ns = alloc_mnt_ns(user_ns);"
    },
    {
        "line": 26,
        "fullcodeline": "copy_flags = CL_COPY_UNBINDABLE | CL_EXPIRE;"
    },
    {
        "line": 29,
        "fullcodeline": "new = copy_tree(old, old->mnt.mnt_root, copy_flags);"
    },
    {
        "line": 35,
        "fullcodeline": "new_ns->root = new;"
    },
    {
        "line": 43,
        "fullcodeline": "p = old;"
    },
    {
        "line": 44,
        "fullcodeline": "q = new;"
    },
    {
        "line": 13,
        "fullcodeline": "if (likely(!(flags & CLONE_NEWNS))) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (IS_ERR(new_ns))"
    },
    {
        "line": 30,
        "fullcodeline": "if (IS_ERR(new)) {"
    },
    {
        "line": 14,
        "fullcodeline": "get_mnt_ns(ns);"
    },
    {
        "line": 28,
        "fullcodeline": "copy_flags |= CL_SHARED_TO_SLAVE | CL_UNPRIVILEGED;"
    },
    {
        "line": 46,
        "fullcodeline": "q->mnt_ns = new_ns;"
    },
    {
        "line": 57,
        "fullcodeline": "p = next_mnt(p, old);"
    },
    {
        "line": 58,
        "fullcodeline": "q = next_mnt(q, new);"
    },
    {
        "line": 33,
        "fullcodeline": "return ERR_CAST(new);"
    },
    {
        "line": 59,
        "fullcodeline": "if (!q)"
    },
    {
        "line": 61,
        "fullcodeline": "while (p->mnt.mnt_root != q->mnt.mnt_root)"
    },
    {
        "line": 62,
        "fullcodeline": "p = next_mnt(p, old);"
    },
    {
        "line": 48,
        "fullcodeline": "if (&p->mnt == new_fs->root.mnt) {"
    },
    {
        "line": 52,
        "fullcodeline": "if (&p->mnt == new_fs->pwd.mnt) {"
    },
    {
        "line": 49,
        "fullcodeline": "new_fs->root.mnt = mntget(&q->mnt);"
    },
    {
        "line": 50,
        "fullcodeline": "rootmnt = &p->mnt;"
    },
    {
        "line": 53,
        "fullcodeline": "new_fs->pwd.mnt = mntget(&q->mnt);"
    },
    {
        "line": 54,
        "fullcodeline": "pwdmnt = &p->mnt;"
    }
]