[
    {
        "line": 5,
        "fullcodeline": "struct vfsmount *rootmnt = NULL, *pwdmnt = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "BUG_ON(!ns);"
    },
    {
        "line": 18,
        "fullcodeline": "old = ns->root;"
    },
    {
        "line": 20,
        "fullcodeline": "new_ns = alloc_mnt_ns(user_ns);"
    },
    {
        "line": 24,
        "fullcodeline": "namespace_lock();"
    },
    {
        "line": 26,
        "fullcodeline": "copy_flags = CL_COPY_UNBINDABLE | CL_EXPIRE;"
    },
    {
        "line": 29,
        "fullcodeline": "new = copy_tree(old, old->mnt.mnt_root, copy_flags);"
    },
    {
        "line": 35,
        "fullcodeline": "new_ns->root = new;"
    },
    {
        "line": 36,
        "fullcodeline": "list_add_tail(&new_ns->list, &new->mnt_list);"
    },
    {
        "line": 43,
        "fullcodeline": "p = old;"
    },
    {
        "line": 44,
        "fullcodeline": "q = new;"
    },
    {
        "line": 65,
        "fullcodeline": "namespace_unlock();"
    },
    {
        "line": 13,
        "fullcodeline": "if (likely(!(flags & CLONE_NEWNS))) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (IS_ERR(new_ns))"
    },
    {
        "line": 27,
        "fullcodeline": "if (user_ns != ns->user_ns)"
    },
    {
        "line": 30,
        "fullcodeline": "if (IS_ERR(new)) {"
    },
    {
        "line": 14,
        "fullcodeline": "get_mnt_ns(ns);"
    },
    {
        "line": 28,
        "fullcodeline": "copy_flags |= CL_SHARED_TO_SLAVE | CL_UNPRIVILEGED;"
    },
    {
        "line": 31,
        "fullcodeline": "namespace_unlock();"
    },
    {
        "line": 32,
        "fullcodeline": "free_mnt_ns(new_ns);"
    },
    {
        "line": 46,
        "fullcodeline": "q->mnt_ns = new_ns;"
    },
    {
        "line": 47,
        "fullcodeline": "new_ns->mounts++;"
    },
    {
        "line": 58,
        "fullcodeline": "p = next_mnt(p, old);"
    },
    {
        "line": 59,
        "fullcodeline": "q = next_mnt(q, new);"
    },
    {
        "line": 68,
        "fullcodeline": "mntput(rootmnt);"
    },
    {
        "line": 70,
        "fullcodeline": "mntput(pwdmnt);"
    },
    {
        "line": 33,
        "fullcodeline": "return ERR_CAST(new);"
    },
    {
        "line": 60,
        "fullcodeline": "if (!q)"
    },
    {
        "line": 63,
        "fullcodeline": "p = next_mnt(p, old);"
    },
    {
        "line": 49,
        "fullcodeline": "if (&p->mnt == new_fs->root.mnt) {"
    },
    {
        "line": 53,
        "fullcodeline": "if (&p->mnt == new_fs->pwd.mnt) {"
    },
    {
        "line": 50,
        "fullcodeline": "new_fs->root.mnt = mntget(&q->mnt);"
    },
    {
        "line": 51,
        "fullcodeline": "rootmnt = &p->mnt;"
    },
    {
        "line": 54,
        "fullcodeline": "new_fs->pwd.mnt = mntget(&q->mnt);"
    },
    {
        "line": 55,
        "fullcodeline": "pwdmnt = &p->mnt;"
    }
]