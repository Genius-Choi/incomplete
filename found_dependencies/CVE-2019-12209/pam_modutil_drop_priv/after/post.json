[
    {
        "line": 2,
        "fullcodeline": "privs->saved_euid = geteuid();"
    },
    {
        "line": 3,
        "fullcodeline": "privs->saved_egid = getegid();"
    },
    {
        "line": 10,
        "fullcodeline": "privs->saved_groups_length = getgroups(0, NULL);"
    },
    {
        "line": 5,
        "fullcodeline": "if ((privs->saved_euid == pw->pw_uid) && (privs->saved_egid == pw->pw_gid)) {"
    },
    {
        "line": 11,
        "fullcodeline": "if (privs->saved_groups_length < 0) {"
    },
    {
        "line": 16,
        "fullcodeline": "if (privs->saved_groups_length > SAVED_GROUPS_MAX_LEN) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (privs->saved_groups_length > 0) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (initgroups(pw->pw_name, pw->pw_gid) < 0) {"
    },
    {
        "line": 33,
        "fullcodeline": "if (setegid(pw->pw_gid) < 0) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (seteuid(pw->pw_uid) < 0) {"
    },
    {
        "line": 45,
        "fullcodeline": "return -1;"
    },
    {
        "line": 6,
        "fullcodeline": "D (privs->debug_file, \"Privilges already dropped, pretend it is all right\");"
    },
    {
        "line": 12,
        "fullcodeline": "D (privs->debug_file, \"getgroups: %s\", strerror(errno));"
    },
    {
        "line": 17,
        "fullcodeline": "D (privs->debug_file, \"too many groups, limiting.\");"
    },
    {
        "line": 18,
        "fullcodeline": "privs->saved_groups_length = SAVED_GROUPS_MAX_LEN;"
    },
    {
        "line": 29,
        "fullcodeline": "D (privs->debug_file, \"initgroups: %s\", strerror(errno));"
    },
    {
        "line": 34,
        "fullcodeline": "D (privs->debug_file, \"setegid: %s\", strerror(errno));"
    },
    {
        "line": 39,
        "fullcodeline": "D (privs->debug_file, \"seteuid: %s\", strerror(errno));"
    },
    {
        "line": 13,
        "fullcodeline": "return -1;"
    },
    {
        "line": 22,
        "fullcodeline": "if (getgroups(privs->saved_groups_length, privs->saved_groups) < 0) {"
    },
    {
        "line": 23,
        "fullcodeline": "D (privs->debug_file, \"getgroups: %s\", strerror(errno));"
    }
]