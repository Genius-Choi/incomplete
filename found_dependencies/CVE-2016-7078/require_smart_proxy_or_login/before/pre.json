[
    {
        "line": 3,
        "fullcodeline": "allowed_smart_proxies = features.blank? ? SmartProxy.all : SmartProxy.with_features(*features)"
    },
    {
        "line": 1,
        "fullcodeline": "def require_smart_proxy_or_login(features = nil)"
    },
    {
        "line": 2,
        "fullcodeline": "features = features.call if features.respond_to?(:call)"
    },
    {
        "line": 5,
        "fullcodeline": "if !Setting[:restrict_registered_smart_proxies] || auth_smart_proxy(allowed_smart_proxies, Setting[:require_ssl_smart_proxies])"
    },
    {
        "line": 12,
        "fullcodeline": "render_error 'access_denied', :status => :forbidden unless performed? && api_request?"
    }
]