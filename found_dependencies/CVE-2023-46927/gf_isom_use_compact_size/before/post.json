[
    {
        "line": 8,
        "fullcodeline": "e = CanAccessMovie(movie, GF_ISOM_OPEN_WRITE);"
    },
    {
        "line": 11,
        "fullcodeline": "trak = gf_isom_get_track_from_file(movie, trackNumber);"
    },
    {
        "line": 18,
        "fullcodeline": "stsz = trak->Media->information->sampleTable->SampleSize;"
    },
    {
        "line": 58,
        "fullcodeline": "stsz->sampleSize = 0;"
    },
    {
        "line": 59,
        "fullcodeline": "stsz->type = GF_ISOM_BOX_TYPE_STZ2;"
    },
    {
        "line": 12,
        "fullcodeline": "if (!trak) return GF_BAD_PARAM;"
    },
    {
        "line": 14,
        "fullcodeline": "if (!trak->Media || !trak->Media->information"
    },
    {
        "line": 21,
        "fullcodeline": "if (!CompactionOn) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (stsz->type == GF_ISOM_BOX_TYPE_STZ2) return GF_OK;"
    },
    {
        "line": 23,
        "fullcodeline": "stsz->type = GF_ISOM_BOX_TYPE_STSZ;"
    },
    {
        "line": 25,
        "fullcodeline": "stsz->sampleSize = 0;"
    },
    {
        "line": 53,
        "fullcodeline": "stsz->sizes = (u32*) gf_malloc(sizeof(u32)*stsz->sampleCount);"
    },
    {
        "line": 55,
        "fullcodeline": "memset(stsz->sizes, stsz->sampleSize, sizeof(u32));"
    },
    {
        "line": 22,
        "fullcodeline": "if (stsz->type == GF_ISOM_BOX_TYPE_STSZ) return GF_OK;"
    },
    {
        "line": 26,
        "fullcodeline": "if (!stsz->sampleCount) return GF_OK;"
    },
    {
        "line": 28,
        "fullcodeline": "if (!stsz->sizes) return GF_OK;"
    },
    {
        "line": 31,
        "fullcodeline": "for (i=1; i<stsz->sampleCount; i++) {"
    },
    {
        "line": 54,
        "fullcodeline": "if (!stsz->sizes) return GF_OUT_OF_MEM;"
    },
    {
        "line": 38,
        "fullcodeline": "gf_free(stsz->sizes);"
    },
    {
        "line": 39,
        "fullcodeline": "stsz->sizes = NULL;"
    },
    {
        "line": 40,
        "fullcodeline": "stsz->sampleSize = size;"
    },
    {
        "line": 52,
        "fullcodeline": "if (stsz->sizes) gf_free(stsz->sizes);"
    },
    {
        "line": 32,
        "fullcodeline": "if (size != stsz->sizes[i]) {"
    },
    {
        "line": 33,
        "fullcodeline": "size = 0;"
    }
]