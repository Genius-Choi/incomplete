[
    {
        "line": 4,
        "fullcodeline": "cac_private_data_t * priv = CAC_DATA(card);"
    },
    {
        "line": 5,
        "fullcodeline": "int r = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "u8 *val = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "size_t val_len = 0;"
    },
    {
        "line": 12,
        "fullcodeline": "SC_FUNC_CALLED(card->ctx, SC_LOG_DEBUG_VERBOSE);"
    },
    {
        "line": 31,
        "fullcodeline": "priv->cache_buf = NULL;"
    },
    {
        "line": 32,
        "fullcodeline": "priv->cache_buf_len = 0;"
    },
    {
        "line": 34,
        "fullcodeline": "r = cac_cac1_get_certificate(card, &val, &val_len);"
    },
    {
        "line": 42,
        "fullcodeline": "cert_type = val[0];"
    },
    {
        "line": 43,
        "fullcodeline": "cert_ptr = val + 1;"
    },
    {
        "line": 44,
        "fullcodeline": "cert_len = val_len - 1;"
    },
    {
        "line": 68,
        "fullcodeline": "priv->cached = 1;"
    },
    {
        "line": 69,
        "fullcodeline": "len = MIN(count, priv->cache_buf_len-idx);"
    },
    {
        "line": 72,
        "fullcodeline": "r = len;"
    },
    {
        "line": 76,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, r);"
    },
    {
        "line": 35,
        "fullcodeline": "if (r < 0)"
    },
    {
        "line": 37,
        "fullcodeline": "if (val_len < 1) {"
    },
    {
        "line": 47,
        "fullcodeline": "if ((cert_type & 0x3) == 1) {"
    },
    {
        "line": 70,
        "fullcodeline": "if (len && priv->cache_buf)"
    },
    {
        "line": 22,
        "fullcodeline": "len = MIN(count, priv->cache_buf_len-idx);"
    },
    {
        "line": 23,
        "fullcodeline": "memcpy(buf, &priv->cache_buf[idx], len);"
    },
    {
        "line": 24,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, len);"
    },
    {
        "line": 38,
        "fullcodeline": "r = SC_ERROR_INVALID_DATA;"
    },
    {
        "line": 52,
        "fullcodeline": "sc_log(card->ctx, \"CAC compression not supported, no zlib\");"
    },
    {
        "line": 53,
        "fullcodeline": "r = SC_ERROR_NOT_SUPPORTED;"
    },
    {
        "line": 71,
        "fullcodeline": "memcpy(buf, &priv->cache_buf[idx], len);"
    },
    {
        "line": 75,
        "fullcodeline": "free(val);"
    },
    {
        "line": 19,
        "fullcodeline": "if (idx > priv->cache_buf_len) {"
    },
    {
        "line": 20,
        "fullcodeline": "LOG_FUNC_RETURN(card->ctx, SC_ERROR_FILE_END_REACHED);"
    },
    {
        "line": 57,
        "fullcodeline": "} else if (cert_len > 0) {"
    },
    {
        "line": 58,
        "fullcodeline": "priv->cache_buf = malloc(cert_len);"
    },
    {
        "line": 63,
        "fullcodeline": "priv->cache_buf_len = cert_len;"
    },
    {
        "line": 64,
        "fullcodeline": "memcpy(priv->cache_buf, cert_ptr, cert_len);"
    },
    {
        "line": 59,
        "fullcodeline": "if (priv->cache_buf == NULL) {"
    },
    {
        "line": 60,
        "fullcodeline": "r = SC_ERROR_OUT_OF_MEMORY;"
    }
]