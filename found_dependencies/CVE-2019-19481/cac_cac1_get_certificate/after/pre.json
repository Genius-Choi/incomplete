[
    {
        "line": 3,
        "fullcodeline": "u8 buf[CAC_MAX_SIZE];"
    },
    {
        "line": 5,
        "fullcodeline": "size_t size = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "size_t left = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "int r = SC_SUCCESS;"
    },
    {
        "line": 10,
        "fullcodeline": "SC_FUNC_CALLED(card->ctx, SC_LOG_DEBUG_VERBOSE);"
    },
    {
        "line": 12,
        "fullcodeline": "size = left = *out_buf ? *out_len : sizeof(buf);"
    },
    {
        "line": 13,
        "fullcodeline": "out_ptr = *out_buf ? *out_buf : buf;"
    },
    {
        "line": 14,
        "fullcodeline": "sc_format_apdu(card, &apdu, SC_APDU_CASE_2_SHORT, CAC_INS_GET_CERTIFICATE, 0, 0 );"
    },
    {
        "line": 15,
        "fullcodeline": "len = MIN(left, 100);"
    },
    {
        "line": 43,
        "fullcodeline": "r = size - left;"
    },
    {
        "line": 52,
        "fullcodeline": "*out_len = r;"
    },
    {
        "line": 53,
        "fullcodeline": "SC_FUNC_RETURN(card->ctx, SC_LOG_DEBUG_VERBOSE, r);"
    },
    {
        "line": 16,
        "fullcodeline": "for (; left > 0;) { /* Increments for readability in the end of the function */"
    },
    {
        "line": 40,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 44,
        "fullcodeline": "if (*out_buf == NULL) {"
    },
    {
        "line": 17,
        "fullcodeline": "apdu.resp = out_ptr;"
    },
    {
        "line": 18,
        "fullcodeline": "apdu.le = len;"
    },
    {
        "line": 19,
        "fullcodeline": "apdu.resplen = left;"
    },
    {
        "line": 20,
        "fullcodeline": "r = sc_transmit_apdu(card, &apdu);"
    },
    {
        "line": 36,
        "fullcodeline": "left -= len;"
    },
    {
        "line": 37,
        "fullcodeline": "out_ptr += len;"
    },
    {
        "line": 38,
        "fullcodeline": "len = MIN(left, apdu.sw2);"
    },
    {
        "line": 41,
        "fullcodeline": "SC_FUNC_RETURN(card->ctx, SC_LOG_DEBUG_VERBOSE, r);"
    },
    {
        "line": 45,
        "fullcodeline": "*out_buf = malloc(r);"
    },
    {
        "line": 50,
        "fullcodeline": "memcpy(*out_buf, buf, r);"
    },
    {
        "line": 21,
        "fullcodeline": "if (r < 0) {"
    },
    {
        "line": 24,
        "fullcodeline": "if (apdu.resplen == 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (apdu.sw1 != 0x63 || apdu.sw2 < 1)  {"
    },
    {
        "line": 46,
        "fullcodeline": "if (*out_buf == NULL) {"
    },
    {
        "line": 25,
        "fullcodeline": "r = SC_ERROR_INTERNAL;"
    },
    {
        "line": 31,
        "fullcodeline": "r = sc_check_sw(card, apdu.sw1, apdu.sw2);"
    },
    {
        "line": 32,
        "fullcodeline": "left -= len;"
    },
    {
        "line": 47,
        "fullcodeline": "SC_FUNC_RETURN(card->ctx, SC_LOG_DEBUG_VERBOSE,"
    }
]