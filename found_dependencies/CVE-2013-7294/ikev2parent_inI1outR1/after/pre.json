[
    {
        "line": 3,
        "fullcodeline": "struct state *st = md->st;"
    },
    {
        "line": 4,
        "fullcodeline": "lset_t policy = POLICY_IKEV2_ALLOW;"
    },
    {
        "line": 5,
        "fullcodeline": "struct connection *c = find_host_connection(&md->iface->ip_addr,"
    },
    {
        "line": 29,
        "fullcodeline": "if (c == NULL) {"
    },
    {
        "line": 113,
        "fullcodeline": "if (!st) {"
    },
    {
        "line": 135,
        "fullcodeline": "if (force_busy == TRUE) {"
    },
    {
        "line": 199,
        "fullcodeline": "char fromname[ADDRTOT_BUF];"
    },
    {
        "line": 200,
        "fullcodeline": "addrtot(&md->sender, 0, fromname, ADDRTOT_BUF);"
    },
    {
        "line": 215,
        "fullcodeline": "ke = &md->chain[ISAKMP_NEXT_v2KE]->payload.v2ke;"
    },
    {
        "line": 217,
        "fullcodeline": "st->st_oakley.group = lookup_group(ke->isak_group);"
    },
    {
        "line": 234,
        "fullcodeline": "ke->md = md;"
    },
    {
        "line": 235,
        "fullcodeline": "set_suspended(st, ke->md);"
    },
    {
        "line": 92,
        "fullcodeline": "c = rw_instantiate(c, &md->sender, NULL, NULL);"
    },
    {
        "line": 114,
        "fullcodeline": "st = new_state();"
    },
    {
        "line": 116,
        "fullcodeline": "memcpy(st->st_icookie, md->hdr.isa_icookie, COOKIE_SIZE);"
    },
    {
        "line": 118,
        "fullcodeline": "get_cookie(FALSE, st->st_rcookie, COOKIE_SIZE, &md->sender);"
    },
    {
        "line": 119,
        "fullcodeline": "initialize_new_state(st, c, policy, 0, NULL_FD,"
    },
    {
        "line": 121,
        "fullcodeline": "st->st_ikev2 = TRUE;"
    },
    {
        "line": 122,
        "fullcodeline": "change_state(st, STATE_PARENT_R1);"
    },
    {
        "line": 123,
        "fullcodeline": "st->st_msgid_lastack = INVALID_MSGID;"
    },
    {
        "line": 124,
        "fullcodeline": "st->st_msgid_nextuse = 0;"
    },
    {
        "line": 126,
        "fullcodeline": "md->st = st;"
    },
    {
        "line": 127,
        "fullcodeline": "md->from_state = STATE_IKEv2_BASE;"
    },
    {
        "line": 136,
        "fullcodeline": "u_char dcookie[SHA1_DIGEST_SIZE];"
    },
    {
        "line": 138,
        "fullcodeline": "ikev2_get_dcookie( dcookie, st->st_ni, &md->sender,"
    },
    {
        "line": 140,
        "fullcodeline": "dc.ptr = dcookie;"
    },
    {
        "line": 141,
        "fullcodeline": "dc.len = SHA1_DIGEST_SIZE;"
    },
    {
        "line": 218,
        "fullcodeline": "if (st->st_oakley.group == NULL) {"
    },
    {
        "line": 237,
        "fullcodeline": "if (!st->st_sec_in_use) {"
    },
    {
        "line": 43,
        "fullcodeline": "d = find_host_connection(&md->iface->ip_addr,"
    },
    {
        "line": 72,
        "fullcodeline": "if (c == NULL) {"
    },
    {
        "line": 84,
        "fullcodeline": "if (c->kind != CK_TEMPLATE) {"
    },
    {
        "line": 238,
        "fullcodeline": "pcrc_init(&ke->ke_pcrc);"
    },
    {
        "line": 239,
        "fullcodeline": "ke->ke_pcrc.pcrc_func ="
    },
    {
        "line": 241,
        "fullcodeline": "e = build_ke(&ke->ke_pcrc, st, st->st_oakley.group,"
    },
    {
        "line": 48,
        "fullcodeline": "for (; d != NULL; d = d->hp_next) {"
    },
    {
        "line": 73,
        "fullcodeline": "loglog(RC_LOG_SERIOUS, \"initial parent SA message received on %s:%u\""
    },
    {
        "line": 144,
        "fullcodeline": "if ( md->chain[ISAKMP_NEXT_v2KE] &&"
    },
    {
        "line": 146,
        "fullcodeline": "(md->chain[ISAKMP_NEXT_v2N]->payload.v2n.isan_type =="
    },
    {
        "line": 151,
        "fullcodeline": "DBG(DBG_CONTROLMORE,"
    },
    {
        "line": 154,
        "fullcodeline": "spisize ="
    },
    {
        "line": 157,
        "fullcodeline": "dc_pbs = &md->chain[ISAKMP_NEXT_v2N]->pbs;"
    },
    {
        "line": 158,
        "fullcodeline": "blob.ptr = dc_pbs->cur + spisize;"
    },
    {
        "line": 163,
        "fullcodeline": "DBG_dump(\"dcookie computed\", dcookie,"
    },
    {
        "line": 185,
        "fullcodeline": "DBG_log(\"will not send/process a dcookie\"));"
    },
    {
        "line": 213,
        "fullcodeline": "return STF_FAIL + v2N_INVALID_KE_PAYLOAD;"
    },
    {
        "line": 223,
        "fullcodeline": "return STF_FAIL + v2N_INVALID_KE_PAYLOAD;"
    },
    {
        "line": 248,
        "fullcodeline": "e ="
    },
    {
        "line": 75,
        "fullcodeline": "ip_str("
    },
    {
        "line": 77,
        "fullcodeline": "ntohs(portof(&md->iface->ip_addr)),"
    },
    {
        "line": 78,
        "fullcodeline": "(policy != LEMPTY) ? \" with policy=\" : \"\","
    },
    {
        "line": 79,
        "fullcodeline": "(policy !="
    },
    {
        "line": 82,
        "fullcodeline": "return STF_FAIL + v2N_NO_PROPOSAL_CHOSEN;"
    },
    {
        "line": 87,
        "fullcodeline": "ip_str("
    },
    {
        "line": 90,
        "fullcodeline": "return STF_FAIL + v2N_NO_PROPOSAL_CHOSEN;"
    },
    {
        "line": 97,
        "fullcodeline": "if ((c->kind == CK_TEMPLATE) && c->spd.that.virt) {"
    },
    {
        "line": 101,
        "fullcodeline": "c = rw_instantiate(c, &md->sender, NULL, NULL);"
    },
    {
        "line": 152,
        "fullcodeline": "DBG_log(\"received a DOS cookie in I1 verify it\"));"
    },
    {
        "line": 159,
        "fullcodeline": "blob.len = pbs_left(dc_pbs) - spisize;"
    },
    {
        "line": 173,
        "fullcodeline": "DBG_log(\"dcookie received match with computed one\"));"
    },
    {
        "line": 243,
        "fullcodeline": "if (e != STF_SUSPEND && e != STF_INLINE) {"
    },
    {
        "line": 244,
        "fullcodeline": "loglog(RC_CRYPTOFAILED, \"system too busy\");"
    },
    {
        "line": 249,
        "fullcodeline": "ikev2_parent_inI1outR1_tail((struct"
    },
    {
        "line": 49,
        "fullcodeline": "if (d->kind == CK_GROUP) {"
    },
    {
        "line": 80,
        "fullcodeline": "LEMPTY) ? bitnamesof(sa_policy_bit_names,"
    },
    {
        "line": 99,
        "fullcodeline": "DBG_log("
    },
    {
        "line": 166,
        "fullcodeline": "if (memcmp(blob.ptr, dcookie, SHA1_DIGEST_SIZE) != 0) {"
    },
    {
        "line": 207,
        "fullcodeline": "enum_name(&ikev2_notify_names,"
    },
    {
        "line": 170,
        "fullcodeline": "return STF_FAIL + v2N_INVALID_IKE_SPI;"
    },
    {
        "line": 102,
        "fullcodeline": "} else if ((c->kind == CK_TEMPLATE) &&"
    },
    {
        "line": 103,
        "fullcodeline": "(c->policy & POLICY_IKEV2_ALLOW_NARROWING)) {"
    },
    {
        "line": 107,
        "fullcodeline": "c = rw_instantiate(c, &md->sender, NULL, NULL);"
    },
    {
        "line": 52,
        "fullcodeline": "if (d->kind == CK_TEMPLATE &&"
    },
    {
        "line": 60,
        "fullcodeline": "if (addrinsubnet(&md->sender,"
    },
    {
        "line": 105,
        "fullcodeline": "DBG_log("
    },
    {
        "line": 53,
        "fullcodeline": "!(d->policy & POLICY_OPPO)) {"
    },
    {
        "line": 55,
        "fullcodeline": "c = d;"
    },
    {
        "line": 63,
        "fullcodeline": "(c == NULL ||"
    },
    {
        "line": 68,
        "fullcodeline": "c = d;"
    },
    {
        "line": 64,
        "fullcodeline": "!subnetinsubnet(&c->spd.that."
    }
]