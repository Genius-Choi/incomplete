[
    {
        "line": 2,
        "fullcodeline": "_, headers, _ = response = @app.call(env)"
    },
    {
        "line": 6,
        "fullcodeline": "request = ActionDispatch::Request.new(env)"
    },
    {
        "line": 4,
        "fullcodeline": "return response if policy_present?(headers)"
    },
    {
        "line": 8,
        "fullcodeline": "if policy = request.permissions_policy"
    },
    {
        "line": 12,
        "fullcodeline": "if policy_empty?(policy)"
    },
    {
        "line": 9,
        "fullcodeline": "headers[ActionDispatch::Constants::FEATURE_POLICY] = policy.build(request.controller_instance)"
    },
    {
        "line": 13,
        "fullcodeline": "headers.delete(ActionDispatch::Constants::FEATURE_POLICY)"
    }
]