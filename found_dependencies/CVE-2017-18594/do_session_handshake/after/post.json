[
    {
        "line": 3,
        "fullcodeline": "struct ssh_userdata *sshu = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "assert(lua_gettop(L) == 4);"
    },
    {
        "line": 6,
        "fullcodeline": "sshu = (struct ssh_userdata *) nseU_checkudata(L, 3, SSH2_UDATA, \"ssh2\");"
    },
    {
        "line": 23,
        "fullcodeline": "lua_settop(L, 3);"
    },
    {
        "line": 8,
        "fullcodeline": "while ((rc = libssh2_session_handshake(sshu->session, sshu->sp[0])) == LIBSSH2_ERROR_EAGAIN) {"
    },
    {
        "line": 9,
        "fullcodeline": "luaL_getmetafield(L, 3, \"filter\");"
    },
    {
        "line": 10,
        "fullcodeline": "lua_pushvalue(L, 3);"
    },
    {
        "line": 12,
        "fullcodeline": "assert(lua_status(L) == LUA_OK);"
    },
    {
        "line": 13,
        "fullcodeline": "lua_callk(L, 1, 0, 0, do_session_handshake);"
    },
    {
        "line": 17,
        "fullcodeline": "libssh2_session_free(sshu->session);"
    },
    {
        "line": 18,
        "fullcodeline": "sshu->session = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "return luaL_error(L, \"Unable to complete libssh2 handshake.\");"
    }
]