[
    {
        "line": 8,
        "fullcodeline": "new = prepare_creds();"
    },
    {
        "line": 11,
        "fullcodeline": "old = current_cred();"
    },
    {
        "line": 27,
        "fullcodeline": "mutex_lock(&key_session_mutex);"
    },
    {
        "line": 30,
        "fullcodeline": "keyring = find_keyring_by_name(name, false);"
    },
    {
        "line": 50,
        "fullcodeline": "ret = install_session_keyring_to_cred(new, keyring);"
    },
    {
        "line": 54,
        "fullcodeline": "commit_creds(new);"
    },
    {
        "line": 55,
        "fullcodeline": "mutex_unlock(&key_session_mutex);"
    },
    {
        "line": 57,
        "fullcodeline": "ret = keyring->serial;"
    },
    {
        "line": 58,
        "fullcodeline": "key_put(keyring);"
    },
    {
        "line": 63,
        "fullcodeline": "mutex_unlock(&key_session_mutex);"
    },
    {
        "line": 65,
        "fullcodeline": "abort_creds(new);"
    },
    {
        "line": 9,
        "fullcodeline": "if (!new)"
    },
    {
        "line": 14,
        "fullcodeline": "if (!name) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (PTR_ERR(keyring) == -ENOKEY) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 15,
        "fullcodeline": "ret = install_session_keyring_to_cred(new, NULL);"
    },
    {
        "line": 20,
        "fullcodeline": "ret = commit_creds(new);"
    },
    {
        "line": 33,
        "fullcodeline": "keyring = keyring_alloc("
    },
    {
        "line": 10,
        "fullcodeline": "return -ENOMEM;"
    },
    {
        "line": 16,
        "fullcodeline": "if (ret < 0)"
    },
    {
        "line": 21,
        "fullcodeline": "if (ret == 0)"
    },
    {
        "line": 37,
        "fullcodeline": "if (IS_ERR(keyring)) {"
    },
    {
        "line": 22,
        "fullcodeline": "ret = serial;"
    },
    {
        "line": 35,
        "fullcodeline": "KEY_POS_ALL | KEY_USR_VIEW | KEY_USR_READ | KEY_USR_LINK,"
    },
    {
        "line": 38,
        "fullcodeline": "ret = PTR_ERR(keyring);"
    },
    {
        "line": 41,
        "fullcodeline": "} else if (IS_ERR(keyring)) {"
    },
    {
        "line": 42,
        "fullcodeline": "ret = PTR_ERR(keyring);"
    },
    {
        "line": 44,
        "fullcodeline": "} else if (keyring == new->session_keyring) {"
    },
    {
        "line": 45,
        "fullcodeline": "ret = 0;"
    }
]