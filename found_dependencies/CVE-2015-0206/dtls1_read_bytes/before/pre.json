[
    {
        "line": 49,
        "fullcodeline": "s->rwstate=SSL_NOTHING;"
    },
    {
        "line": 57,
        "fullcodeline": "rr = &(s->s3->rrec);"
    },
    {
        "line": 636,
        "fullcodeline": "ssl3_send_alert(s,SSL3_AL_FATAL,al);"
    },
    {
        "line": 8,
        "fullcodeline": "if (s->s3->rbuf.buf == NULL) /* Not initialized yet */"
    },
    {
        "line": 21,
        "fullcodeline": "if ( (ret = have_handshake_fragment(s, type, buf, len, peek)))"
    },
    {
        "line": 90,
        "fullcodeline": "if ((rr->length == 0) || (s->rstate == SSL_ST_READ_BODY))"
    },
    {
        "line": 104,
        "fullcodeline": "if (s->d1->listen && rr->type != SSL3_RT_HANDSHAKE)"
    },
    {
        "line": 112,
        "fullcodeline": "if (s->s3->change_cipher_spec /* set when we receive ChangeCipherSpec,"
    },
    {
        "line": 128,
        "fullcodeline": "if (s->shutdown & SSL_RECEIVED_SHUTDOWN)"
    },
    {
        "line": 136,
        "fullcodeline": "if (type == rr->type) /* SSL3_RT_APPLICATION_DATA or SSL3_RT_HANDSHAKE */"
    },
    {
        "line": 202,
        "fullcodeline": "unsigned int k, dest_maxlen = 0;"
    },
    {
        "line": 350,
        "fullcodeline": "if (s->d1->alert_fragment_len >= DTLS1_AL_HEADER_LENGTH)"
    },
    {
        "line": 444,
        "fullcodeline": "if (s->shutdown & SSL_SENT_SHUTDOWN) /* but we have not received a shutdown */"
    },
    {
        "line": 451,
        "fullcodeline": "if (rr->type == SSL3_RT_CHANGE_CIPHER_SPEC)"
    },
    {
        "line": 511,
        "fullcodeline": "if ((s->d1->handshake_fragment_len >= DTLS1_HM_HEADER_LENGTH) &&"
    },
    {
        "line": 638,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 12,
        "fullcodeline": "if ((type && (type != SSL3_RT_APPLICATION_DATA) &&"
    },
    {
        "line": 14,
        "fullcodeline": "(peek && (type != SSL3_RT_APPLICATION_DATA)))"
    },
    {
        "line": 30,
        "fullcodeline": "if ((!s->in_handshake && SSL_in_init(s)) ||"
    },
    {
        "line": 31,
        "fullcodeline": "(BIO_dgram_is_sctp(SSL_get_rbio(s)) &&"
    },
    {
        "line": 39,
        "fullcodeline": "i=s->handshake_func(s);"
    },
    {
        "line": 63,
        "fullcodeline": "if (s->state == SSL_ST_OK && rr->length == 0)"
    },
    {
        "line": 66,
        "fullcodeline": "item = pqueue_pop(s->d1->buffered_app_data.q);"
    },
    {
        "line": 86,
        "fullcodeline": "if (dtls1_handle_timeout(s) > 0)"
    },
    {
        "line": 92,
        "fullcodeline": "ret=dtls1_get_record(s);"
    },
    {
        "line": 106,
        "fullcodeline": "rr->length = 0;"
    },
    {
        "line": 114,
        "fullcodeline": "&& (rr->type != SSL3_RT_HANDSHAKE))"
    },
    {
        "line": 121,
        "fullcodeline": "dtls1_buffer_record(s, &(s->d1->buffered_app_data), rr->seq_num);"
    },
    {
        "line": 122,
        "fullcodeline": "rr->length = 0;"
    },
    {
        "line": 155,
        "fullcodeline": "memcpy(buf,&(rr->data[rr->off]),n);"
    },
    {
        "line": 206,
        "fullcodeline": "if (rr->type == SSL3_RT_HANDSHAKE)"
    },
    {
        "line": 254,
        "fullcodeline": "if (dest_maxlen > 0)"
    },
    {
        "line": 288,
        "fullcodeline": "if ((!s->server) &&"
    },
    {
        "line": 291,
        "fullcodeline": "(s->session != NULL) && (s->session->cipher != NULL))"
    },
    {
        "line": 293,
        "fullcodeline": "s->d1->handshake_fragment_len = 0;"
    },
    {
        "line": 352,
        "fullcodeline": "int alert_level = s->d1->alert_fragment[0];"
    },
    {
        "line": 353,
        "fullcodeline": "int alert_descr = s->d1->alert_fragment[1];"
    },
    {
        "line": 355,
        "fullcodeline": "s->d1->alert_fragment_len = 0;"
    },
    {
        "line": 454,
        "fullcodeline": "unsigned int ccs_hdr_len = DTLS1_CCS_HEADER_LENGTH;"
    },
    {
        "line": 456,
        "fullcodeline": "dtls1_get_ccs_header(rr->data, &ccs_hdr);"
    },
    {
        "line": 472,
        "fullcodeline": "rr->length=0;"
    },
    {
        "line": 486,
        "fullcodeline": "s->d1->change_cipher_spec_ok = 0;"
    },
    {
        "line": 488,
        "fullcodeline": "s->s3->change_cipher_spec=1;"
    },
    {
        "line": 493,
        "fullcodeline": "dtls1_reset_seq_numbers(s, SSL3_CC_READ);"
    },
    {
        "line": 504,
        "fullcodeline": "BIO_ctrl(SSL_get_wbio(s), BIO_CTRL_DGRAM_SCTP_AUTH_CCS_RCVD, 1, NULL);"
    },
    {
        "line": 512,
        "fullcodeline": "!s->in_handshake)"
    },
    {
        "line": 517,
        "fullcodeline": "dtls1_get_message_header(rr->data, &msg_hdr);"
    },
    {
        "line": 552,
        "fullcodeline": "i=s->handshake_func(s);"
    },
    {
        "line": 590,
        "fullcodeline": "al=SSL_AD_UNEXPECTED_MESSAGE;"
    },
    {
        "line": 599,
        "fullcodeline": "al=SSL_AD_UNEXPECTED_MESSAGE;"
    },
    {
        "line": 9,
        "fullcodeline": "if (!ssl3_setup_buffers(s))"
    },
    {
        "line": 13,
        "fullcodeline": "(type != SSL3_RT_HANDSHAKE)) ||"
    },
    {
        "line": 17,
        "fullcodeline": "return -1;"
    },
    {
        "line": 33,
        "fullcodeline": "s->s3->in_read_app_data != 2))"
    },
    {
        "line": 40,
        "fullcodeline": "if (i < 0) return(i);"
    },
    {
        "line": 93,
        "fullcodeline": "if (ret <= 0)"
    },
    {
        "line": 148,
        "fullcodeline": "if (len <= 0) return(len);"
    },
    {
        "line": 150,
        "fullcodeline": "if ((unsigned int)len > rr->length)"
    },
    {
        "line": 208,
        "fullcodeline": "dest_maxlen = sizeof s->d1->handshake_fragment;"
    },
    {
        "line": 361,
        "fullcodeline": "if (s->info_callback != NULL)"
    },
    {
        "line": 366,
        "fullcodeline": "if (cb != NULL)"
    },
    {
        "line": 372,
        "fullcodeline": "if (alert_level == 1) /* warning */"
    },
    {
        "line": 458,
        "fullcodeline": "if (s->version == DTLS1_BAD_VER)"
    },
    {
        "line": 495,
        "fullcodeline": "if (s->version == DTLS1_BAD_VER)"
    },
    {
        "line": 527,
        "fullcodeline": "if (msg_hdr.type == SSL3_MT_FINISHED)"
    },
    {
        "line": 537,
        "fullcodeline": "if (((s->state&SSL_ST_MASK) == SSL_ST_OK) &&"
    },
    {
        "line": 553,
        "fullcodeline": "if (i < 0) return(i);"
    },
    {
        "line": 584,
        "fullcodeline": "if (s->version == TLS1_VERSION)"
    },
    {
        "line": 32,
        "fullcodeline": "(s->state == DTLS1_SCTP_ST_SR_READ_SOCK || s->state == DTLS1_SCTP_ST_CR_READ_SOCK) &&"
    },
    {
        "line": 78,
        "fullcodeline": "dtls1_copy_record(s, item);"
    },
    {
        "line": 80,
        "fullcodeline": "OPENSSL_free(item->data);"
    },
    {
        "line": 95,
        "fullcodeline": "ret = dtls1_read_failed(s, ret);"
    },
    {
        "line": 140,
        "fullcodeline": "if (SSL_in_init(s) && (type == SSL3_RT_APPLICATION_DATA) &&"
    },
    {
        "line": 141,
        "fullcodeline": "(s->enc_read_ctx == NULL))"
    },
    {
        "line": 143,
        "fullcodeline": "al=SSL_AD_UNEXPECTED_MESSAGE;"
    },
    {
        "line": 144,
        "fullcodeline": "SSLerr(SSL_F_DTLS1_READ_BYTES,SSL_R_APP_DATA_IN_HANDSHAKE);"
    },
    {
        "line": 151,
        "fullcodeline": "n = rr->length;"
    },
    {
        "line": 158,
        "fullcodeline": "rr->length-=n;"
    },
    {
        "line": 171,
        "fullcodeline": "if (BIO_dgram_is_sctp(SSL_get_rbio(s)) &&"
    },
    {
        "line": 173,
        "fullcodeline": "(s->state == DTLS1_SCTP_ST_SR_READ_SOCK || s->state == DTLS1_SCTP_ST_CR_READ_SOCK))"
    },
    {
        "line": 175,
        "fullcodeline": "s->rwstate=SSL_READING;"
    },
    {
        "line": 184,
        "fullcodeline": "if (BIO_dgram_is_sctp(SSL_get_rbio(s)) &&"
    },
    {
        "line": 185,
        "fullcodeline": "s->d1->shutdown_received && !BIO_dgram_sctp_msg_waiting(SSL_get_rbio(s)))"
    },
    {
        "line": 258,
        "fullcodeline": "if ( rr->length < dest_maxlen)"
    },
    {
        "line": 274,
        "fullcodeline": "for ( k = 0; k < dest_maxlen; k++)"
    },
    {
        "line": 290,
        "fullcodeline": "(s->d1->handshake_fragment[0] == SSL3_MT_HELLO_REQUEST) &&"
    },
    {
        "line": 295,
        "fullcodeline": "if ((s->d1->handshake_fragment[1] != 0) ||"
    },
    {
        "line": 297,
        "fullcodeline": "(s->d1->handshake_fragment[3] != 0))"
    },
    {
        "line": 299,
        "fullcodeline": "al=SSL_AD_DECODE_ERROR;"
    },
    {
        "line": 300,
        "fullcodeline": "SSLerr(SSL_F_DTLS1_READ_BYTES,SSL_R_BAD_HELLO_REQUEST);"
    },
    {
        "line": 307,
        "fullcodeline": "s->msg_callback(0, s->version, SSL3_RT_HANDSHAKE,"
    },
    {
        "line": 310,
        "fullcodeline": "if (SSL_is_init_finished(s) &&"
    },
    {
        "line": 312,
        "fullcodeline": "!s->s3->renegotiate)"
    },
    {
        "line": 314,
        "fullcodeline": "s->d1->handshake_read_seq++;"
    },
    {
        "line": 315,
        "fullcodeline": "s->new_session = 1;"
    },
    {
        "line": 316,
        "fullcodeline": "ssl3_renegotiate(s);"
    },
    {
        "line": 358,
        "fullcodeline": "s->msg_callback(0, s->version, SSL3_RT_ALERT,"
    },
    {
        "line": 362,
        "fullcodeline": "cb=s->info_callback;"
    },
    {
        "line": 368,
        "fullcodeline": "j = (alert_level << 8) | alert_descr;"
    },
    {
        "line": 369,
        "fullcodeline": "cb(s, SSL_CB_READ_ALERT, j);"
    },
    {
        "line": 459,
        "fullcodeline": "ccs_hdr_len = 3;"
    },
    {
        "line": 464,
        "fullcodeline": "if (\t(rr->length != ccs_hdr_len) ||"
    },
    {
        "line": 465,
        "fullcodeline": "(rr->off != 0) || (rr->data[0] != SSL3_MT_CCS))"
    },
    {
        "line": 468,
        "fullcodeline": "SSLerr(SSL_F_DTLS1_READ_BYTES,SSL_R_BAD_CHANGE_CIPHER_SPEC);"
    },
    {
        "line": 475,
        "fullcodeline": "s->msg_callback(0, s->version, SSL3_RT_CHANGE_CIPHER_SPEC,"
    },
    {
        "line": 489,
        "fullcodeline": "if (!ssl3_do_change_cipher_spec(s))"
    },
    {
        "line": 496,
        "fullcodeline": "s->d1->handshake_read_seq++;"
    },
    {
        "line": 520,
        "fullcodeline": "rr->length = 0;"
    },
    {
        "line": 532,
        "fullcodeline": "dtls1_retransmit_buffered_messages(s);"
    },
    {
        "line": 533,
        "fullcodeline": "rr->length = 0;"
    },
    {
        "line": 538,
        "fullcodeline": "!(s->s3->flags & SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS))"
    },
    {
        "line": 547,
        "fullcodeline": "s->state = s->server ? SSL_ST_ACCEPT : SSL_ST_CONNECT;"
    },
    {
        "line": 549,
        "fullcodeline": "s->renegotiate=1;"
    },
    {
        "line": 550,
        "fullcodeline": "s->new_session=1;"
    },
    {
        "line": 560,
        "fullcodeline": "if (!(s->mode & SSL_MODE_AUTO_RETRY))"
    },
    {
        "line": 586,
        "fullcodeline": "rr->length = 0;"
    },
    {
        "line": 610,
        "fullcodeline": "if (s->s3->in_read_app_data &&"
    },
    {
        "line": 612,
        "fullcodeline": "(("
    },
    {
        "line": 10,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 44,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 97,
        "fullcodeline": "if (ret <= 0)"
    },
    {
        "line": 153,
        "fullcodeline": "n = (unsigned int)len;"
    },
    {
        "line": 172,
        "fullcodeline": "rr->type == SSL3_RT_APPLICATION_DATA &&"
    },
    {
        "line": 176,
        "fullcodeline": "BIO_clear_retry_flags(SSL_get_rbio(s));"
    },
    {
        "line": 177,
        "fullcodeline": "BIO_set_retry_read(SSL_get_rbio(s));"
    },
    {
        "line": 212,
        "fullcodeline": "else if (rr->type == SSL3_RT_ALERT)"
    },
    {
        "line": 268,
        "fullcodeline": "s->rstate=SSL_ST_READ_HEADER;"
    },
    {
        "line": 269,
        "fullcodeline": "rr->length = 0;"
    },
    {
        "line": 277,
        "fullcodeline": "rr->length--;"
    },
    {
        "line": 289,
        "fullcodeline": "(s->d1->handshake_fragment_len >= DTLS1_HM_HEADER_LENGTH) &&"
    },
    {
        "line": 296,
        "fullcodeline": "(s->d1->handshake_fragment[2] != 0) ||"
    },
    {
        "line": 311,
        "fullcodeline": "!(s->s3->flags & SSL3_FLAGS_NO_RENEGOTIATE_CIPHERS) &&"
    },
    {
        "line": 317,
        "fullcodeline": "if (ssl3_renegotiate_check(s))"
    },
    {
        "line": 375,
        "fullcodeline": "if (alert_descr == SSL_AD_CLOSE_NOTIFY)"
    },
    {
        "line": 557,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 611,
        "fullcodeline": "(s->s3->total_renegotiations != 0) &&"
    },
    {
        "line": 613,
        "fullcodeline": "(s->state & SSL_ST_CONNECT) &&"
    },
    {
        "line": 617,
        "fullcodeline": "(s->state & SSL_ST_ACCEPT) &&"
    },
    {
        "line": 624,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 628,
        "fullcodeline": "al=SSL_AD_UNEXPECTED_MESSAGE;"
    },
    {
        "line": 71,
        "fullcodeline": "if (BIO_dgram_is_sctp(SSL_get_rbio(s)))"
    },
    {
        "line": 73,
        "fullcodeline": "DTLS1_RECORD_DATA *rdata = (DTLS1_RECORD_DATA *) item->data;"
    },
    {
        "line": 74,
        "fullcodeline": "BIO_ctrl(SSL_get_rbio(s), BIO_CTRL_DGRAM_SCTP_SET_RCVINFO, sizeof(rdata->recordinfo), &rdata->recordinfo);"
    },
    {
        "line": 162,
        "fullcodeline": "s->rstate=SSL_ST_READ_HEADER;"
    },
    {
        "line": 214,
        "fullcodeline": "dest_maxlen = sizeof(s->d1->alert_fragment);"
    },
    {
        "line": 319,
        "fullcodeline": "i=s->handshake_func(s);"
    },
    {
        "line": 363,
        "fullcodeline": "else if (s->ctx->info_callback != NULL)"
    },
    {
        "line": 529,
        "fullcodeline": "if (dtls1_check_timeout_num(s) < 0)"
    },
    {
        "line": 569,
        "fullcodeline": "s->rwstate=SSL_READING;"
    },
    {
        "line": 570,
        "fullcodeline": "bio=SSL_get_rbio(s);"
    },
    {
        "line": 571,
        "fullcodeline": "BIO_clear_retry_flags(bio);"
    },
    {
        "line": 615,
        "fullcodeline": "(s->state <= SSL3_ST_CR_SRVR_HELLO_A)"
    },
    {
        "line": 619,
        "fullcodeline": "(s->state >= SSL3_ST_SR_CLNT_HELLO_A)"
    },
    {
        "line": 276,
        "fullcodeline": "dest[k] = rr->data[rr->off++];"
    },
    {
        "line": 320,
        "fullcodeline": "if (i < 0) return(i);"
    },
    {
        "line": 364,
        "fullcodeline": "cb=s->ctx->info_callback;"
    },
    {
        "line": 428,
        "fullcodeline": "BIO_snprintf(tmp,sizeof tmp,\"%d\",alert_descr);"
    },
    {
        "line": 530,
        "fullcodeline": "return -1;"
    },
    {
        "line": 573,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 614,
        "fullcodeline": "(s->state >= SSL3_ST_CW_CLNT_HELLO_A) &&"
    },
    {
        "line": 618,
        "fullcodeline": "(s->state <= SSL3_ST_SW_HELLO_REQ_A) &&"
    },
    {
        "line": 219,
        "fullcodeline": "else if (rr->type == TLS1_RT_HEARTBEAT)"
    },
    {
        "line": 327,
        "fullcodeline": "if (!(s->mode & SSL_MODE_AUTO_RETRY))"
    },
    {
        "line": 382,
        "fullcodeline": "if (BIO_dgram_is_sctp(SSL_get_rbio(s)) &&"
    },
    {
        "line": 383,
        "fullcodeline": "BIO_dgram_sctp_msg_waiting(SSL_get_rbio(s)))"
    },
    {
        "line": 386,
        "fullcodeline": "s->rwstate=SSL_READING;"
    },
    {
        "line": 423,
        "fullcodeline": "char tmp[16];"
    },
    {
        "line": 427,
        "fullcodeline": "SSLerr(SSL_F_DTLS1_READ_BYTES, SSL_AD_REASON_OFFSET + alert_descr);"
    },
    {
        "line": 436,
        "fullcodeline": "al=SSL_AD_ILLEGAL_PARAMETER;"
    },
    {
        "line": 437,
        "fullcodeline": "SSLerr(SSL_F_DTLS1_READ_BYTES,SSL_R_UNKNOWN_ALERT_TYPE);"
    },
    {
        "line": 221,
        "fullcodeline": "dtls1_process_heartbeat(s);"
    },
    {
        "line": 225,
        "fullcodeline": "s->rwstate=SSL_READING;"
    },
    {
        "line": 324,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 387,
        "fullcodeline": "BIO_clear_retry_flags(SSL_get_rbio(s));"
    },
    {
        "line": 388,
        "fullcodeline": "BIO_set_retry_read(SSL_get_rbio(s));"
    },
    {
        "line": 389,
        "fullcodeline": "return -1;"
    },
    {
        "line": 226,
        "fullcodeline": "BIO_clear_retry_flags(SSL_get_rbio(s));"
    },
    {
        "line": 227,
        "fullcodeline": "BIO_set_retry_read(SSL_get_rbio(s));"
    },
    {
        "line": 228,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 336,
        "fullcodeline": "s->rwstate=SSL_READING;"
    },
    {
        "line": 337,
        "fullcodeline": "bio=SSL_get_rbio(s);"
    },
    {
        "line": 338,
        "fullcodeline": "BIO_clear_retry_flags(bio);"
    },
    {
        "line": 232,
        "fullcodeline": "else if (rr->type != SSL3_RT_CHANGE_CIPHER_SPEC)"
    },
    {
        "line": 340,
        "fullcodeline": "return(-1);"
    },
    {
        "line": 249,
        "fullcodeline": "al=SSL_AD_UNEXPECTED_MESSAGE;"
    },
    {
        "line": 241,
        "fullcodeline": "bio=SSL_get_rbio(s);"
    },
    {
        "line": 243,
        "fullcodeline": "BIO_clear_retry_flags(bio);"
    },
    {
        "line": 245,
        "fullcodeline": "return(-1);"
    }
]