[
    {
        "line": 8,
        "fullcodeline": "SCEnter();"
    },
    {
        "line": 11,
        "fullcodeline": "det_ctx->inspection_recursion_counter++;"
    },
    {
        "line": 479,
        "fullcodeline": "KEYWORD_PROFILING_END(det_ctx, smd->type, 0);"
    },
    {
        "line": 480,
        "fullcodeline": "SCReturnInt(0);"
    },
    {
        "line": 492,
        "fullcodeline": "KEYWORD_PROFILING_END(det_ctx, smd->type, 1);"
    },
    {
        "line": 493,
        "fullcodeline": "SCReturnInt(1);"
    },
    {
        "line": 13,
        "fullcodeline": "if (det_ctx->inspection_recursion_counter == de_ctx->inspection_recursion_limit) {"
    },
    {
        "line": 19,
        "fullcodeline": "if (smd == NULL || buffer_len == 0) {"
    },
    {
        "line": 25,
        "fullcodeline": "if (smd->type == DETECT_CONTENT) {"
    },
    {
        "line": 485,
        "fullcodeline": "if (!smd->is_last) {"
    },
    {
        "line": 14,
        "fullcodeline": "det_ctx->discontinue_matching = 1;"
    },
    {
        "line": 15,
        "fullcodeline": "KEYWORD_PROFILING_END(det_ctx, smd->type, 0);"
    },
    {
        "line": 16,
        "fullcodeline": "SCReturnInt(0);"
    },
    {
        "line": 20,
        "fullcodeline": "KEYWORD_PROFILING_END(det_ctx, smd->type, 0);"
    },
    {
        "line": 21,
        "fullcodeline": "SCReturnInt(0);"
    },
    {
        "line": 27,
        "fullcodeline": "DetectContentData *cd = (DetectContentData *)smd->ctx;"
    },
    {
        "line": 44,
        "fullcodeline": "uint8_t *found = NULL;"
    },
    {
        "line": 45,
        "fullcodeline": "uint32_t offset = 0;"
    },
    {
        "line": 46,
        "fullcodeline": "uint32_t depth = buffer_len;"
    },
    {
        "line": 47,
        "fullcodeline": "uint32_t prev_offset = 0; /**< used in recursive searching */"
    },
    {
        "line": 48,
        "fullcodeline": "uint32_t prev_buffer_offset = det_ctx->buffer_offset;"
    },
    {
        "line": 486,
        "fullcodeline": "KEYWORD_PROFILING_END(det_ctx, smd->type, 1);"
    },
    {
        "line": 487,
        "fullcodeline": "int r = DetectEngineContentInspection(de_ctx, det_ctx, s, smd+1,"
    },
    {
        "line": 489,
        "fullcodeline": "SCReturnInt(r);"
    },
    {
        "line": 169,
        "fullcodeline": "uint8_t *sbuffer = buffer + offset;"
    },
    {
        "line": 170,
        "fullcodeline": "uint32_t sbuffer_len = depth - offset;"
    },
    {
        "line": 171,
        "fullcodeline": "uint32_t match_offset = 0;"
    },
    {
        "line": 181,
        "fullcodeline": "found = SpmScan(cd->spm_ctx, det_ctx->spm_thread_ctx, sbuffer,"
    },
    {
        "line": 186,
        "fullcodeline": "SCLogDebug(\"found %p cd negated %s\", found, cd->flags & DETECT_CONTENT_NEGATED ? \"true\" : \"false\");"
    },
    {
        "line": 258,
        "fullcodeline": "} else if (smd->type == DETECT_ISDATAAT) {"
    },
    {
        "line": 51,
        "fullcodeline": "if ((cd->flags & DETECT_CONTENT_DISTANCE) ||"
    },
    {
        "line": 151,
        "fullcodeline": "if (prev_offset != 0)"
    },
    {
        "line": 156,
        "fullcodeline": "if (depth > buffer_len)"
    },
    {
        "line": 161,
        "fullcodeline": "if (offset > depth || depth == 0) {"
    },
    {
        "line": 188,
        "fullcodeline": "if (found == NULL && !(cd->flags & DETECT_CONTENT_NEGATED)) {"
    },
    {
        "line": 259,
        "fullcodeline": "SCLogDebug(\"inspecting isdataat\");"
    },
    {
        "line": 261,
        "fullcodeline": "DetectIsdataatData *id = (DetectIsdataatData *)smd->ctx;"
    },
    {
        "line": 52,
        "fullcodeline": "(cd->flags & DETECT_CONTENT_WITHIN)) {"
    },
    {
        "line": 55,
        "fullcodeline": "offset = prev_buffer_offset;"
    },
    {
        "line": 56,
        "fullcodeline": "depth = buffer_len;"
    },
    {
        "line": 58,
        "fullcodeline": "int distance = cd->distance;"
    },
    {
        "line": 152,
        "fullcodeline": "offset = prev_offset;"
    },
    {
        "line": 157,
        "fullcodeline": "depth = buffer_len;"
    },
    {
        "line": 262,
        "fullcodeline": "if (id->flags & ISDATAAT_RELATIVE) {"
    },
    {
        "line": 59,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_DISTANCE) {"
    },
    {
        "line": 72,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_WITHIN) {"
    },
    {
        "line": 97,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_DEPTH_BE) {"
    },
    {
        "line": 111,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_OFFSET_BE) {"
    },
    {
        "line": 145,
        "fullcodeline": "prev_buffer_offset = 0;"
    },
    {
        "line": 162,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_NEGATED) {"
    },
    {
        "line": 189,
        "fullcodeline": "if ((cd->flags & (DETECT_CONTENT_DISTANCE|DETECT_CONTENT_WITHIN)) == 0) {"
    },
    {
        "line": 288,
        "fullcodeline": "} else if (smd->type == DETECT_PCRE) {"
    },
    {
        "line": 122,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_DEPTH_BE) {"
    },
    {
        "line": 130,
        "fullcodeline": "if (stream_start_offset != 0 && cd->flags & DETECT_CONTENT_DEPTH) {"
    },
    {
        "line": 141,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_OFFSET_BE)"
    },
    {
        "line": 191,
        "fullcodeline": "det_ctx->discontinue_matching = 1;"
    },
    {
        "line": 195,
        "fullcodeline": "} else if (found == NULL && (cd->flags & DETECT_CONTENT_NEGATED)) {"
    },
    {
        "line": 263,
        "fullcodeline": "if (det_ctx->buffer_offset + id->dataat > buffer_len) {"
    },
    {
        "line": 289,
        "fullcodeline": "SCLogDebug(\"inspecting pcre\");"
    },
    {
        "line": 290,
        "fullcodeline": "DetectPcreData *pe = (DetectPcreData *)smd->ctx;"
    },
    {
        "line": 291,
        "fullcodeline": "uint32_t prev_buffer_offset = det_ctx->buffer_offset;"
    },
    {
        "line": 292,
        "fullcodeline": "uint32_t prev_offset = 0;"
    },
    {
        "line": 293,
        "fullcodeline": "int r = 0;"
    },
    {
        "line": 295,
        "fullcodeline": "det_ctx->pcre_match_start_offset = 0;"
    },
    {
        "line": 60,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_DISTANCE_BE) {"
    },
    {
        "line": 63,
        "fullcodeline": "if (distance < 0 && (uint32_t)(abs(distance)) > offset)"
    },
    {
        "line": 73,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_WITHIN_BE) {"
    },
    {
        "line": 86,
        "fullcodeline": "if (stream_start_offset != 0 && prev_buffer_offset == 0) {"
    },
    {
        "line": 98,
        "fullcodeline": "if ((det_ctx->bj_values[cd->depth] + prev_buffer_offset) < depth) {"
    },
    {
        "line": 112,
        "fullcodeline": "if (det_ctx->bj_values[cd->offset] > offset)"
    },
    {
        "line": 123,
        "fullcodeline": "depth = det_ctx->bj_values[cd->depth];"
    },
    {
        "line": 142,
        "fullcodeline": "offset = det_ctx->bj_values[cd->offset];"
    },
    {
        "line": 275,
        "fullcodeline": "if (id->dataat < buffer_len) {"
    },
    {
        "line": 61,
        "fullcodeline": "distance = det_ctx->bj_values[cd->distance];"
    },
    {
        "line": 64,
        "fullcodeline": "offset = 0;"
    },
    {
        "line": 99,
        "fullcodeline": "depth = prev_buffer_offset + det_ctx->bj_values[cd->depth];"
    },
    {
        "line": 102,
        "fullcodeline": "if (cd->depth != 0) {"
    },
    {
        "line": 113,
        "fullcodeline": "offset = det_ctx->bj_values[cd->offset];"
    },
    {
        "line": 115,
        "fullcodeline": "if (cd->offset > offset) {"
    },
    {
        "line": 131,
        "fullcodeline": "if (depth <= stream_start_offset) {"
    },
    {
        "line": 144,
        "fullcodeline": "offset = cd->offset;"
    },
    {
        "line": 265,
        "fullcodeline": "if (id->flags & ISDATAAT_NEGATED)"
    },
    {
        "line": 269,
        "fullcodeline": "SCLogDebug(\"relative isdataat match\");"
    },
    {
        "line": 276,
        "fullcodeline": "SCLogDebug(\"absolute isdataat match\");"
    },
    {
        "line": 297,
        "fullcodeline": "Packet *p = NULL;"
    },
    {
        "line": 300,
        "fullcodeline": "r = DetectPcrePayloadMatch(det_ctx, s, smd, p, f,"
    },
    {
        "line": 310,
        "fullcodeline": "KEYWORD_PROFILING_END(det_ctx, smd->type, 1);"
    },
    {
        "line": 313,
        "fullcodeline": "prev_offset = det_ctx->pcre_match_start_offset;"
    },
    {
        "line": 318,
        "fullcodeline": "r = DetectEngineContentInspection(de_ctx, det_ctx, s, smd+1,"
    },
    {
        "line": 327,
        "fullcodeline": "det_ctx->buffer_offset = prev_buffer_offset;"
    },
    {
        "line": 328,
        "fullcodeline": "det_ctx->pcre_match_start_offset = prev_offset;"
    },
    {
        "line": 331,
        "fullcodeline": "} else if (smd->type == DETECT_BYTETEST) {"
    },
    {
        "line": 66,
        "fullcodeline": "offset += distance;"
    },
    {
        "line": 74,
        "fullcodeline": "if ((int32_t)depth > (int32_t)(prev_buffer_offset + det_ctx->bj_values[cd->within] + distance)) {"
    },
    {
        "line": 87,
        "fullcodeline": "if (depth <= stream_start_offset) {"
    },
    {
        "line": 116,
        "fullcodeline": "offset = cd->offset;"
    },
    {
        "line": 125,
        "fullcodeline": "if (cd->depth != 0) {"
    },
    {
        "line": 197,
        "fullcodeline": "} else if (found != NULL && (cd->flags & DETECT_CONTENT_NEGATED)) {"
    },
    {
        "line": 270,
        "fullcodeline": "if (id->flags & ISDATAAT_NEGATED)"
    },
    {
        "line": 277,
        "fullcodeline": "if (id->flags & ISDATAAT_NEGATED)"
    },
    {
        "line": 298,
        "fullcodeline": "if (inspection_mode == DETECT_ENGINE_CONTENT_INSPECTION_MODE_PAYLOAD)"
    },
    {
        "line": 302,
        "fullcodeline": "if (r == 0) {"
    },
    {
        "line": 306,
        "fullcodeline": "if (!(pe->flags & DETECT_PCRE_RELATIVE_NEXT)) {"
    },
    {
        "line": 320,
        "fullcodeline": "if (r == 1) {"
    },
    {
        "line": 332,
        "fullcodeline": "DetectBytetestData *btd = (DetectBytetestData *)smd->ctx;"
    },
    {
        "line": 333,
        "fullcodeline": "uint8_t flags = btd->flags;"
    },
    {
        "line": 334,
        "fullcodeline": "int32_t offset = btd->offset;"
    },
    {
        "line": 335,
        "fullcodeline": "uint64_t value = btd->value;"
    },
    {
        "line": 75,
        "fullcodeline": "depth = prev_buffer_offset + det_ctx->bj_values[cd->within] + distance;"
    },
    {
        "line": 78,
        "fullcodeline": "if ((int32_t)depth > (int32_t)(prev_buffer_offset + cd->within + distance)) {"
    },
    {
        "line": 103,
        "fullcodeline": "if ((cd->depth + prev_buffer_offset) < depth) {"
    },
    {
        "line": 126,
        "fullcodeline": "depth = cd->depth;"
    },
    {
        "line": 282,
        "fullcodeline": "if (id->flags & ISDATAAT_NEGATED)"
    },
    {
        "line": 299,
        "fullcodeline": "p = (Packet *)data;"
    },
    {
        "line": 307,
        "fullcodeline": "SCLogDebug(\"no relative match coming up, so this is a match\");"
    },
    {
        "line": 336,
        "fullcodeline": "if (flags & DETECT_BYTETEST_OFFSET_BE) {"
    },
    {
        "line": 339,
        "fullcodeline": "if (flags & DETECT_BYTETEST_VALUE_BE) {"
    },
    {
        "line": 345,
        "fullcodeline": "if (flags & DETECT_BYTETEST_DCE && data != NULL) {"
    },
    {
        "line": 353,
        "fullcodeline": "if (DetectBytetestDoMatch(det_ctx, s, smd->ctx, buffer, buffer_len, flags,"
    },
    {
        "line": 79,
        "fullcodeline": "depth = prev_buffer_offset + cd->within + distance;"
    },
    {
        "line": 104,
        "fullcodeline": "depth = prev_buffer_offset + cd->depth;"
    },
    {
        "line": 133,
        "fullcodeline": "} else if (depth >= (stream_start_offset + buffer_len)) {"
    },
    {
        "line": 201,
        "fullcodeline": "if (DETECT_CONTENT_IS_SINGLE(cd))"
    },
    {
        "line": 205,
        "fullcodeline": "match_offset = (uint32_t)((found - buffer) + cd->content_len);"
    },
    {
        "line": 207,
        "fullcodeline": "det_ctx->buffer_offset = match_offset;"
    },
    {
        "line": 225,
        "fullcodeline": "KEYWORD_PROFILING_END(det_ctx, smd->type, 1);"
    },
    {
        "line": 230,
        "fullcodeline": "int r = DetectEngineContentInspection(de_ctx, det_ctx, s, smd+1,"
    },
    {
        "line": 235,
        "fullcodeline": "SCLogDebug(\"no match for 'next sm'\");"
    },
    {
        "line": 249,
        "fullcodeline": "SCLogDebug(\"'next sm' depends on me %p, lets see what we can do (flags %u)\", cd, cd->flags);"
    },
    {
        "line": 252,
        "fullcodeline": "prev_offset = (match_offset - (cd->content_len - 1));"
    },
    {
        "line": 337,
        "fullcodeline": "offset = det_ctx->bj_values[offset];"
    },
    {
        "line": 340,
        "fullcodeline": "value = det_ctx->bj_values[value];"
    },
    {
        "line": 346,
        "fullcodeline": "DCERPCState *dcerpc_state = (DCERPCState *)data;"
    },
    {
        "line": 349,
        "fullcodeline": "flags |= ((dcerpc_state->dcerpc.dcerpchdr.packed_drep[0] & 0x10) ?"
    },
    {
        "line": 360,
        "fullcodeline": "} else if (smd->type == DETECT_BYTEJUMP) {"
    },
    {
        "line": 89,
        "fullcodeline": "} else if (depth >= (stream_start_offset + buffer_len)) {"
    },
    {
        "line": 202,
        "fullcodeline": "det_ctx->discontinue_matching = 1;"
    },
    {
        "line": 210,
        "fullcodeline": "if (cd->flags & DETECT_CONTENT_REPLACE) {"
    },
    {
        "line": 232,
        "fullcodeline": "if (r == 1) {"
    },
    {
        "line": 243,
        "fullcodeline": "if ((cd->flags & DETECT_CONTENT_RELATIVE_NEXT) == 0) {"
    },
    {
        "line": 361,
        "fullcodeline": "DetectBytejumpData *bjd = (DetectBytejumpData *)smd->ctx;"
    },
    {
        "line": 362,
        "fullcodeline": "uint8_t flags = bjd->flags;"
    },
    {
        "line": 363,
        "fullcodeline": "int32_t offset = bjd->offset;"
    },
    {
        "line": 136,
        "fullcodeline": "depth = depth - stream_start_offset;"
    },
    {
        "line": 238,
        "fullcodeline": "SCLogDebug(\"'next sm' said to discontinue this right now\");"
    },
    {
        "line": 244,
        "fullcodeline": "SCLogDebug(\"'next sm' does not depend on me, so we can give up\");"
    },
    {
        "line": 245,
        "fullcodeline": "det_ctx->discontinue_matching = 1;"
    },
    {
        "line": 365,
        "fullcodeline": "if (flags & DETECT_BYTEJUMP_OFFSET_BE) {"
    },
    {
        "line": 371,
        "fullcodeline": "if (flags & DETECT_BYTEJUMP_DCE && data != NULL) {"
    },
    {
        "line": 379,
        "fullcodeline": "if (DetectBytejumpDoMatch(det_ctx, s, smd->ctx, buffer, buffer_len,"
    },
    {
        "line": 92,
        "fullcodeline": "depth = depth - stream_start_offset;"
    },
    {
        "line": 211,
        "fullcodeline": "if (inspection_mode == DETECT_ENGINE_CONTENT_INSPECTION_MODE_PAYLOAD) {"
    },
    {
        "line": 366,
        "fullcodeline": "offset = det_ctx->bj_values[offset];"
    },
    {
        "line": 372,
        "fullcodeline": "DCERPCState *dcerpc_state = (DCERPCState *)data;"
    },
    {
        "line": 375,
        "fullcodeline": "flags |= ((dcerpc_state->dcerpc.dcerpchdr.packed_drep[0] & 0x10) ?"
    },
    {
        "line": 386,
        "fullcodeline": "} else if (smd->type == DETECT_BYTE_EXTRACT) {"
    },
    {
        "line": 213,
        "fullcodeline": "det_ctx->replist = DetectReplaceAddToList(det_ctx->replist, found, cd);"
    },
    {
        "line": 388,
        "fullcodeline": "DetectByteExtractData *bed = (DetectByteExtractData *)smd->ctx;"
    },
    {
        "line": 389,
        "fullcodeline": "uint8_t endian = bed->endian;"
    },
    {
        "line": 215,
        "fullcodeline": "SCLogWarning(SC_ERR_INVALID_VALUE, \"Can't modify payload without packet\");"
    },
    {
        "line": 393,
        "fullcodeline": "if ((bed->flags & DETECT_BYTE_EXTRACT_FLAG_ENDIAN) &&"
    },
    {
        "line": 403,
        "fullcodeline": "if (DetectByteExtractDoMatch(det_ctx, smd, s, buffer,"
    },
    {
        "line": 394,
        "fullcodeline": "endian == DETECT_BYTE_EXTRACT_ENDIAN_DCE && data != NULL) {"
    },
    {
        "line": 396,
        "fullcodeline": "DCERPCState *dcerpc_state = (DCERPCState *)data;"
    },
    {
        "line": 399,
        "fullcodeline": "endian |= ((dcerpc_state->dcerpc.dcerpchdr.packed_drep[0] == 0x10) ?"
    },
    {
        "line": 413,
        "fullcodeline": "} else if (smd->type == DETECT_AL_URILEN) {"
    },
    {
        "line": 414,
        "fullcodeline": "SCLogDebug(\"inspecting uri len\");"
    },
    {
        "line": 416,
        "fullcodeline": "int r = 0;"
    },
    {
        "line": 417,
        "fullcodeline": "DetectUrilenData *urilend = (DetectUrilenData *) smd->ctx;"
    },
    {
        "line": 444,
        "fullcodeline": "det_ctx->discontinue_matching = 0;"
    },
    {
        "line": 440,
        "fullcodeline": "if (r == 1) {"
    },
    {
        "line": 461,
        "fullcodeline": "} else if (smd->type == DETECT_BASE64_DECODE) {"
    },
    {
        "line": 421,
        "fullcodeline": "if (buffer_len == urilend->urilen1)"
    },
    {
        "line": 425,
        "fullcodeline": "if (buffer_len < urilend->urilen1)"
    },
    {
        "line": 429,
        "fullcodeline": "if (buffer_len > urilend->urilen1)"
    },
    {
        "line": 433,
        "fullcodeline": "if (buffer_len > urilend->urilen1 &&"
    },
    {
        "line": 422,
        "fullcodeline": "r = 1;"
    },
    {
        "line": 426,
        "fullcodeline": "r = 1;"
    },
    {
        "line": 430,
        "fullcodeline": "r = 1;"
    },
    {
        "line": 434,
        "fullcodeline": "buffer_len < urilend->urilen2) {"
    },
    {
        "line": 435,
        "fullcodeline": "r = 1;"
    },
    {
        "line": 462,
        "fullcodeline": "if (DetectBase64DecodeDoMatch(det_ctx, s, smd, buffer, buffer_len)) {"
    },
    {
        "line": 472,
        "fullcodeline": "SCLogDebug(\"sm->type %u\", smd->type);"
    },
    {
        "line": 463,
        "fullcodeline": "if (s->sm_arrays[DETECT_SM_LIST_BASE64_DATA] != NULL) {"
    },
    {
        "line": 464,
        "fullcodeline": "KEYWORD_PROFILING_END(det_ctx, smd->type, 1);"
    },
    {
        "line": 465,
        "fullcodeline": "if (DetectBase64DataDoMatch(de_ctx, det_ctx, s, f)) {"
    }
]