[
    {
        "line": 3,
        "fullcodeline": "struct ndpi_packet_struct *packet = &flow->packet;"
    },
    {
        "line": 11,
        "fullcodeline": "packet->packet_lines_parsed_complete = 1;"
    },
    {
        "line": 12,
        "fullcodeline": "ndpi_reset_packet_line_info(packet);"
    },
    {
        "line": 14,
        "fullcodeline": "packet->line[packet->parsed_lines].ptr = packet->payload;"
    },
    {
        "line": 15,
        "fullcodeline": "packet->line[packet->parsed_lines].len = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "if((packet->payload_packet_len < 3) || (packet->payload == NULL))"
    },
    {
        "line": 8,
        "fullcodeline": "if(packet->packet_lines_parsed_complete != 0)"
    },
    {
        "line": 17,
        "fullcodeline": "for (a = 0; (a < packet->payload_packet_len) && (packet->parsed_lines < NDPI_MAX_PARSE_LINES_PER_PACKET); a++) {"
    },
    {
        "line": 259,
        "fullcodeline": "if(packet->parsed_lines >= 1) {"
    },
    {
        "line": 260,
        "fullcodeline": "packet->line[packet->parsed_lines].len ="
    },
    {
        "line": 263,
        "fullcodeline": "packet->parsed_lines++;"
    },
    {
        "line": 18,
        "fullcodeline": "if((a + 1) >= packet->payload_packet_len)"
    },
    {
        "line": 21,
        "fullcodeline": "if(get_u_int16_t(packet->payload, a) == ntohs(0x0d0a)) {"
    },
    {
        "line": 261,
        "fullcodeline": "(u_int16_t)(((unsigned long) &packet->payload[packet->payload_packet_len]) -"
    },
    {
        "line": 38,
        "fullcodeline": "packet->line[packet->parsed_lines].len ="
    },
    {
        "line": 251,
        "fullcodeline": "packet->parsed_lines++;"
    },
    {
        "line": 252,
        "fullcodeline": "packet->line[packet->parsed_lines].ptr = &packet->payload[a + 2];"
    },
    {
        "line": 253,
        "fullcodeline": "packet->line[packet->parsed_lines].len = 0;"
    },
    {
        "line": 255,
        "fullcodeline": "a++; /* next char in the payload */"
    },
    {
        "line": 24,
        "fullcodeline": "if(((a + 3) <= packet->payload_packet_len)"
    },
    {
        "line": 39,
        "fullcodeline": "(u_int16_t)(((unsigned long) &packet->payload[a]) - ((unsigned long) packet->line[packet->parsed_lines].ptr));"
    },
    {
        "line": 42,
        "fullcodeline": "if(packet->parsed_lines == 0 && packet->line[0].len >= NDPI_STATICSTRING_LEN(\"HTTP/1.X 200 \") &&"
    },
    {
        "line": 66,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > NDPI_STATICSTRING_LEN(\"Server:\") + 1 &&"
    },
    {
        "line": 82,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 6 &&"
    },
    {
        "line": 95,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 17 &&"
    },
    {
        "line": 108,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 14 &&"
    },
    {
        "line": 120,
        "fullcodeline": "if((packet->content_line.len == 0) && (packet->line[packet->parsed_lines].len > 13) &&"
    },
    {
        "line": 127,
        "fullcodeline": "if(packet->content_line.len > 0) {"
    },
    {
        "line": 141,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 8 &&"
    },
    {
        "line": 148,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 9 &&"
    },
    {
        "line": 155,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 12 &&"
    },
    {
        "line": 163,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 18 &&"
    },
    {
        "line": 170,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 19 &&"
    },
    {
        "line": 177,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 16 &&"
    },
    {
        "line": 185,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 21 &&"
    },
    {
        "line": 192,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 8 &&"
    },
    {
        "line": 199,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 8 &&"
    },
    {
        "line": 206,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len > 16 &&"
    },
    {
        "line": 218,
        "fullcodeline": "if((packet->line[packet->parsed_lines].len > 6 &&"
    },
    {
        "line": 243,
        "fullcodeline": "if(packet->line[packet->parsed_lines].len == 0) {"
    },
    {
        "line": 248,
        "fullcodeline": "if(packet->parsed_lines >= (NDPI_MAX_PARSE_LINES_PER_PACKET - 1))"
    },
    {
        "line": 262,
        "fullcodeline": "((unsigned long) packet->line[packet->parsed_lines].ptr));"
    },
    {
        "line": 25,
        "fullcodeline": "&& (get_u_int16_t(packet->payload, a+2) == ntohs(0x0d0a))) {"
    },
    {
        "line": 28,
        "fullcodeline": "u_int32_t a1 = a + 4;"
    },
    {
        "line": 30,
        "fullcodeline": "diff = ndpi_min(packet->payload_packet_len-a1, sizeof(flow->initial_binary_bytes));"
    },
    {
        "line": 45,
        "fullcodeline": "packet->line[0].ptr[NDPI_STATICSTRING_LEN(\"HTTP/1.X \")] < '6') {"
    },
    {
        "line": 46,
        "fullcodeline": "packet->http_response.ptr = &packet->line[0].ptr[NDPI_STATICSTRING_LEN(\"HTTP/1.1 \")];"
    },
    {
        "line": 47,
        "fullcodeline": "packet->http_response.len = packet->line[0].len - NDPI_STATICSTRING_LEN(\"HTTP/1.1 \");"
    },
    {
        "line": 48,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 67,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr,"
    },
    {
        "line": 79,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 83,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Host:\", 5) == 0) {"
    },
    {
        "line": 92,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 96,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"X-Forwarded-For:\", 16) == 0) {"
    },
    {
        "line": 105,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 109,
        "fullcodeline": "(strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Content-Type: \", 14) == 0 ||"
    },
    {
        "line": 112,
        "fullcodeline": "packet->content_line.len = packet->line[packet->parsed_lines].len - 14;"
    },
    {
        "line": 117,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 121,
        "fullcodeline": "(strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Content-type:\", 13) == 0)) {"
    },
    {
        "line": 123,
        "fullcodeline": "packet->content_line.len = packet->line[packet->parsed_lines].len - 13;"
    },
    {
        "line": 124,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 129,
        "fullcodeline": "char separator[] = {';', '\\r', '\\0'};"
    },
    {
        "line": 142,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Accept: \", 8) == 0) {"
    },
    {
        "line": 144,
        "fullcodeline": "packet->accept_line.len = packet->line[packet->parsed_lines].len - 8;"
    },
    {
        "line": 145,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 149,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Referer: \", 9) == 0) {"
    },
    {
        "line": 151,
        "fullcodeline": "packet->referer_line.len = packet->line[packet->parsed_lines].len - 9;"
    },
    {
        "line": 152,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 156,
        "fullcodeline": "(strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"User-Agent: \", 12) == 0 ||"
    },
    {
        "line": 159,
        "fullcodeline": "packet->user_agent_line.len = packet->line[packet->parsed_lines].len - 12;"
    },
    {
        "line": 160,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 164,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Content-Encoding: \", 18) == 0) {"
    },
    {
        "line": 166,
        "fullcodeline": "packet->http_encoding.len = packet->line[packet->parsed_lines].len - 18;"
    },
    {
        "line": 167,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 171,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Transfer-Encoding: \", 19) == 0) {"
    },
    {
        "line": 173,
        "fullcodeline": "packet->http_transfer_encoding.len = packet->line[packet->parsed_lines].len - 19;"
    },
    {
        "line": 174,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 178,
        "fullcodeline": "((strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Content-Length: \", 16) == 0) ||"
    },
    {
        "line": 180,
        "fullcodeline": "packet->http_contentlen.ptr = &packet->line[packet->parsed_lines].ptr[16];"
    },
    {
        "line": 181,
        "fullcodeline": "packet->http_contentlen.len = packet->line[packet->parsed_lines].len - 16;"
    },
    {
        "line": 182,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 186,
        "fullcodeline": "((strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Content-Disposition: \", 21) == 0))) {"
    },
    {
        "line": 188,
        "fullcodeline": "packet->content_disposition_line.len = packet->line[packet->parsed_lines].len - 21;"
    },
    {
        "line": 189,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 193,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Cookie: \", 8) == 0) {"
    },
    {
        "line": 195,
        "fullcodeline": "packet->http_cookie.len = packet->line[packet->parsed_lines].len - 8;"
    },
    {
        "line": 196,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 200,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Origin: \", 8) == 0) {"
    },
    {
        "line": 202,
        "fullcodeline": "packet->http_origin.len = packet->line[packet->parsed_lines].len - 8;"
    },
    {
        "line": 203,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 207,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"X-Session-Type: \", 16) == 0) {"
    },
    {
        "line": 209,
        "fullcodeline": "packet->http_x_session_type.len = packet->line[packet->parsed_lines].len - 16;"
    },
    {
        "line": 210,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 236,
        "fullcodeline": "(packet->line[packet->parsed_lines].len > 27 &&"
    },
    {
        "line": 240,
        "fullcodeline": "packet->http_num_headers++;"
    },
    {
        "line": 244,
        "fullcodeline": "packet->empty_line_position = a;"
    },
    {
        "line": 245,
        "fullcodeline": "packet->empty_line_position_set = 1;"
    },
    {
        "line": 32,
        "fullcodeline": "if(diff > 0) {"
    },
    {
        "line": 44,
        "fullcodeline": "packet->line[0].ptr[NDPI_STATICSTRING_LEN(\"HTTP/1.X \")] > '0' && /* response code between 000 and 699 */"
    },
    {
        "line": 51,
        "fullcodeline": "if(packet->payload_packet_len >= 12) {"
    },
    {
        "line": 70,
        "fullcodeline": "if(packet->line[packet->parsed_lines].ptr[NDPI_STATICSTRING_LEN(\"Server:\")] == ' ') {"
    },
    {
        "line": 85,
        "fullcodeline": "if(packet->line[packet->parsed_lines].ptr[5] == ' ') {"
    },
    {
        "line": 98,
        "fullcodeline": "if(packet->line[packet->parsed_lines].ptr[16] == ' ') {"
    },
    {
        "line": 110,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Content-type: \", 14) == 0)) {"
    },
    {
        "line": 114,
        "fullcodeline": "while ((packet->content_line.len > 0) && (packet->content_line.ptr[0] == ' '))"
    },
    {
        "line": 115,
        "fullcodeline": "packet->content_line.len--, packet->content_line.ptr++;"
    },
    {
        "line": 132,
        "fullcodeline": "for (i = 0; separator[i] != '\\0'; i++) {"
    },
    {
        "line": 157,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"User-agent: \", 12) == 0)) {"
    },
    {
        "line": 179,
        "fullcodeline": "(strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"content-length: \", 16) == 0))) {"
    },
    {
        "line": 233,
        "fullcodeline": "(packet->line[packet->parsed_lines].len > 17 &&"
    },
    {
        "line": 237,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr,"
    },
    {
        "line": 33,
        "fullcodeline": "memcpy(&flow->initial_binary_bytes, &packet->payload[a1], diff);"
    },
    {
        "line": 34,
        "fullcodeline": "flow->initial_binary_bytes_len = diff;"
    },
    {
        "line": 43,
        "fullcodeline": "strncasecmp((const char *) packet->line[0].ptr, \"HTTP/1.\", NDPI_STATICSTRING_LEN(\"HTTP/1.\")) == 0 &&"
    },
    {
        "line": 52,
        "fullcodeline": "char buf[4];"
    },
    {
        "line": 55,
        "fullcodeline": "strncpy(buf, (char *) &packet->payload[9], 3);"
    },
    {
        "line": 56,
        "fullcodeline": "buf[3] = '\\0';"
    },
    {
        "line": 58,
        "fullcodeline": "flow->http.response_status_code = atoi(buf);"
    },
    {
        "line": 68,
        "fullcodeline": "\"Server:\", NDPI_STATICSTRING_LEN(\"Server:\")) == 0) {"
    },
    {
        "line": 73,
        "fullcodeline": "packet->server_line.len ="
    },
    {
        "line": 87,
        "fullcodeline": "packet->host_line.len = packet->line[packet->parsed_lines].len - 6;"
    },
    {
        "line": 100,
        "fullcodeline": "packet->forwarded_line.len = packet->line[packet->parsed_lines].len - 17;"
    },
    {
        "line": 133,
        "fullcodeline": "char *c = memchr((char *) packet->content_line.ptr, separator[i], packet->content_line.len);"
    },
    {
        "line": 230,
        "fullcodeline": "(packet->line[packet->parsed_lines].len > 15 &&"
    },
    {
        "line": 234,
        "fullcodeline": "(strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Accept-Language: \", 17) == 0 ||"
    },
    {
        "line": 60,
        "fullcodeline": "if((flow->http.response_status_code < 100) || (flow->http.response_status_code > 509))"
    },
    {
        "line": 74,
        "fullcodeline": "packet->line[packet->parsed_lines].len - (NDPI_STATICSTRING_LEN(\"Server:\") + 1);"
    },
    {
        "line": 77,
        "fullcodeline": "packet->server_line.len = packet->line[packet->parsed_lines].len - NDPI_STATICSTRING_LEN(\"Server:\");"
    },
    {
        "line": 90,
        "fullcodeline": "packet->host_line.len = packet->line[packet->parsed_lines].len - 5;"
    },
    {
        "line": 103,
        "fullcodeline": "packet->forwarded_line.len = packet->line[packet->parsed_lines].len - 16;"
    },
    {
        "line": 135,
        "fullcodeline": "if(c != NULL)"
    },
    {
        "line": 226,
        "fullcodeline": "(packet->line[packet->parsed_lines].len > 12 &&"
    },
    {
        "line": 231,
        "fullcodeline": "(strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Last-Modified: \", 15) == 0 ||"
    },
    {
        "line": 235,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Accept-Encoding: \", 17) == 0)) ||"
    },
    {
        "line": 61,
        "fullcodeline": "flow->http.response_status_code = 0; /* Out of range */"
    },
    {
        "line": 136,
        "fullcodeline": "packet->content_line.len = c - (char *) packet->content_line.ptr;"
    },
    {
        "line": 224,
        "fullcodeline": "(packet->line[packet->parsed_lines].len > 9 &&"
    },
    {
        "line": 227,
        "fullcodeline": "(strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Set-Cookie: \", 12) == 0 ||"
    },
    {
        "line": 232,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Accept-Ranges: \", 15) == 0)) ||"
    },
    {
        "line": 72,
        "fullcodeline": "&packet->line[packet->parsed_lines].ptr[NDPI_STATICSTRING_LEN(\"Server:\") + 1];"
    },
    {
        "line": 222,
        "fullcodeline": "(packet->line[packet->parsed_lines].len > 8 &&"
    },
    {
        "line": 225,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Expires: \", 9) == 0) ||"
    },
    {
        "line": 229,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Connection: \", 12) == 0)) ||"
    },
    {
        "line": 76,
        "fullcodeline": "packet->server_line.ptr = &packet->line[packet->parsed_lines].ptr[NDPI_STATICSTRING_LEN(\"Server:\")];"
    },
    {
        "line": 219,
        "fullcodeline": "(strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Date: \", 6) == 0 ||"
    },
    {
        "line": 223,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Pragma: \", 8) == 0) ||"
    },
    {
        "line": 228,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Keep-Alive: \", 12) == 0 ||"
    },
    {
        "line": 221,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"ETag: \", 6) == 0)) ||"
    },
    {
        "line": 220,
        "fullcodeline": "strncasecmp((const char *) packet->line[packet->parsed_lines].ptr, \"Vary: \", 6) == 0 ||"
    }
]