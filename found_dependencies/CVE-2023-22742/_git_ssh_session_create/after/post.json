[
    {
        "line": 8,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "git_socket_stream *socket = GIT_CONTAINER_OF(io, git_socket_stream, parent);"
    },
    {
        "line": 12,
        "fullcodeline": "const char *keytype = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "GIT_ASSERT_ARG(session);"
    },
    {
        "line": 15,
        "fullcodeline": "GIT_ASSERT_ARG(hosts);"
    },
    {
        "line": 17,
        "fullcodeline": "s = libssh2_session_init();"
    },
    {
        "line": 49,
        "fullcodeline": "libssh2_session_set_blocking(s, 1);"
    },
    {
        "line": 51,
        "fullcodeline": "*session = s;"
    },
    {
        "line": 52,
        "fullcodeline": "*hosts = known_hosts;"
    },
    {
        "line": 57,
        "fullcodeline": "libssh2_knownhost_free(known_hosts);"
    },
    {
        "line": 58,
        "fullcodeline": "libssh2_session_free(s);"
    },
    {
        "line": 18,
        "fullcodeline": "if (!s) {"
    },
    {
        "line": 23,
        "fullcodeline": "if ((rc = load_known_hosts(&known_hosts, s)) < 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "if ((keytype = find_hostkey_preference(known_hosts, hostname, port)) != NULL) {"
    },
    {
        "line": 42,
        "fullcodeline": "} while (LIBSSH2_ERROR_EAGAIN == rc || LIBSSH2_ERROR_TIMEOUT == rc);"
    },
    {
        "line": 44,
        "fullcodeline": "if (rc != LIBSSH2_ERROR_NONE) {"
    },
    {
        "line": 59,
        "fullcodeline": "return -1;"
    },
    {
        "line": 19,
        "fullcodeline": "git_error_set(GIT_ERROR_NET, \"failed to initialize SSH session\");"
    },
    {
        "line": 24,
        "fullcodeline": "ssh_error(s, \"error loading known_hosts\");"
    },
    {
        "line": 25,
        "fullcodeline": "libssh2_session_free(s);"
    },
    {
        "line": 41,
        "fullcodeline": "rc = libssh2_session_handshake(s, socket->s);"
    },
    {
        "line": 45,
        "fullcodeline": "ssh_error(s, \"failed to start SSH session\");"
    },
    {
        "line": 20,
        "fullcodeline": "return -1;"
    },
    {
        "line": 26,
        "fullcodeline": "return -1;"
    },
    {
        "line": 32,
        "fullcodeline": "} while (LIBSSH2_ERROR_EAGAIN == rc || LIBSSH2_ERROR_TIMEOUT == rc);"
    },
    {
        "line": 33,
        "fullcodeline": "if (rc != LIBSSH2_ERROR_NONE) {"
    },
    {
        "line": 31,
        "fullcodeline": "rc = libssh2_session_method_pref(s, LIBSSH2_METHOD_HOSTKEY, keytype);"
    },
    {
        "line": 34,
        "fullcodeline": "ssh_error(s, \"failed to set hostkey preference\");"
    }
]