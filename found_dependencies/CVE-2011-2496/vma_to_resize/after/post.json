[
    {
        "line": 5,
        "fullcodeline": "struct vm_area_struct *vma = find_vma(mm, addr);"
    },
    {
        "line": 7,
        "fullcodeline": "if (!vma || vma->vm_start > addr)"
    },
    {
        "line": 10,
        "fullcodeline": "if (is_vm_hugetlb_page(vma))"
    },
    {
        "line": 14,
        "fullcodeline": "if (old_len > vma->vm_end - addr)"
    },
    {
        "line": 18,
        "fullcodeline": "if (new_len > old_len) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (vma->vm_flags & VM_LOCKED) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (!may_expand_vm(mm, (new_len - old_len) >> PAGE_SHIFT))"
    },
    {
        "line": 41,
        "fullcodeline": "if (vma->vm_flags & VM_ACCOUNT) {"
    },
    {
        "line": 51,
        "fullcodeline": "return ERR_PTR(-EFAULT);"
    },
    {
        "line": 53,
        "fullcodeline": "return ERR_PTR(-EINVAL);"
    },
    {
        "line": 55,
        "fullcodeline": "return ERR_PTR(-ENOMEM);"
    },
    {
        "line": 57,
        "fullcodeline": "return ERR_PTR(-EAGAIN);"
    },
    {
        "line": 23,
        "fullcodeline": "pgoff = (addr - vma->vm_start) >> PAGE_SHIFT;"
    },
    {
        "line": 24,
        "fullcodeline": "pgoff += vma->vm_pgoff;"
    },
    {
        "line": 31,
        "fullcodeline": "locked = mm->locked_vm << PAGE_SHIFT;"
    },
    {
        "line": 32,
        "fullcodeline": "lock_limit = rlimit(RLIMIT_MEMLOCK);"
    },
    {
        "line": 33,
        "fullcodeline": "locked += new_len - old_len;"
    },
    {
        "line": 42,
        "fullcodeline": "unsigned long charged = (new_len - old_len) >> PAGE_SHIFT;"
    },
    {
        "line": 45,
        "fullcodeline": "*p = charged;"
    },
    {
        "line": 21,
        "fullcodeline": "if (vma->vm_flags & (VM_DONTEXPAND | VM_PFNMAP))"
    },
    {
        "line": 25,
        "fullcodeline": "if (pgoff + (new_len >> PAGE_SHIFT) < pgoff)"
    },
    {
        "line": 34,
        "fullcodeline": "if (locked > lock_limit && !capable(CAP_IPC_LOCK))"
    },
    {
        "line": 43,
        "fullcodeline": "if (security_vm_enough_memory(charged))"
    }
]