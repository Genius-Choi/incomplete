[
    {
        "line": 3,
        "fullcodeline": "char *d = strdupa(path), *f, *tmpname;"
    },
    {
        "line": 5,
        "fullcodeline": "f = basename(d);"
    },
    {
        "line": 6,
        "fullcodeline": "d = dirname(d);"
    },
    {
        "line": 7,
        "fullcodeline": "fd = open(d, O_RDONLY);"
    },
    {
        "line": 13,
        "fullcodeline": "fd2 = openat(fd, f, O_RDONLY);"
    },
    {
        "line": 18,
        "fullcodeline": "size_t len = strlen(path) + strlen(\"/cgroup.procs\") + 1;"
    },
    {
        "line": 19,
        "fullcodeline": "tmpname = alloca(len);"
    },
    {
        "line": 20,
        "fullcodeline": "snprintf(tmpname, len, \"%s/cgroup.procs\", f);"
    },
    {
        "line": 21,
        "fullcodeline": "fd2 = openat(fd, tmpname, O_RDONLY);"
    },
    {
        "line": 26,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 8,
        "fullcodeline": "if (fd < 0) {"
    },
    {
        "line": 14,
        "fullcodeline": "if (fd2 >= 0 || errno != ENOENT) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (fd2 >= 0 || errno != ENOENT) {"
    },
    {
        "line": 9,
        "fullcodeline": "fprintf(stderr, \"Error in openat test: could not open parent dir\\n\");"
    },
    {
        "line": 10,
        "fullcodeline": "fprintf(stderr, \"(this is expected on the second run)\\n\");"
    },
    {
        "line": 15,
        "fullcodeline": "fprintf(stderr, \"leak at openat of %s\\n\", f);"
    },
    {
        "line": 16,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 23,
        "fullcodeline": "fprintf(stderr, \"leak at openat of %s\\n\", tmpname);"
    },
    {
        "line": 24,
        "fullcodeline": "exit(1);"
    }
]