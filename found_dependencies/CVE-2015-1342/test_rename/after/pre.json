[
    {
        "line": 3,
        "fullcodeline": "char *d = strdupa(path), *tmpname;"
    },
    {
        "line": 4,
        "fullcodeline": "d = dirname(d);"
    },
    {
        "line": 5,
        "fullcodeline": "size_t len = strlen(path) + 30;"
    },
    {
        "line": 7,
        "fullcodeline": "tmpname = alloca(len);"
    },
    {
        "line": 8,
        "fullcodeline": "snprintf(tmpname, len, \"%s/%d\", d, (int)getpid());"
    },
    {
        "line": 9,
        "fullcodeline": "if (rename(path, tmpname) == 0 || errno != ENOENT) {"
    },
    {
        "line": 10,
        "fullcodeline": "fprintf(stderr, \"leak at rename of %s\\n\", path);"
    }
]