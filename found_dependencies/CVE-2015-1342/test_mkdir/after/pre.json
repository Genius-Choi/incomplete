[
    {
        "line": 3,
        "fullcodeline": "size_t len = strlen(path) + 30;"
    },
    {
        "line": 4,
        "fullcodeline": "char *tmpname = alloca(len);"
    },
    {
        "line": 5,
        "fullcodeline": "snprintf(tmpname, len, \"%s/%d\", path, (int)getpid());"
    },
    {
        "line": 7,
        "fullcodeline": "if (mkdir(path, 0755) == 0) {"
    },
    {
        "line": 11,
        "fullcodeline": "if (errno != ENOENT) {"
    },
    {
        "line": 15,
        "fullcodeline": "if (mkdir(tmpname, 0755) == 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "if (errno != ENOENT) {"
    },
    {
        "line": 8,
        "fullcodeline": "fprintf(stderr, \"leak at mkdir of %s\\n\", path);"
    },
    {
        "line": 12,
        "fullcodeline": "fprintf(stderr, \"leak at mkdir of %s, errno was %s\\n\", path, strerror(errno));"
    },
    {
        "line": 16,
        "fullcodeline": "fprintf(stderr, \"leak at mkdir of %s\\n\", tmpname);"
    },
    {
        "line": 20,
        "fullcodeline": "fprintf(stderr, \"leak at mkdir of %s, errno was %s\\n\", path, strerror(errno));"
    }
]