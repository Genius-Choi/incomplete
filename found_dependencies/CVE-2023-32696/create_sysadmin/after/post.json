[
    {
        "line": 3,
        "fullcodeline": "name = os.environ.get(\"CKAN_SYSADMIN_NAME\")"
    },
    {
        "line": 4,
        "fullcodeline": "password = os.environ.get(\"CKAN_SYSADMIN_PASSWORD\")"
    },
    {
        "line": 5,
        "fullcodeline": "email = os.environ.get(\"CKAN_SYSADMIN_EMAIL\")"
    },
    {
        "line": 7,
        "fullcodeline": "if name and password and email:"
    },
    {
        "line": 10,
        "fullcodeline": "command = [\"ckan\", \"-c\", ckan_ini, \"user\", \"show\", name]"
    },
    {
        "line": 12,
        "fullcodeline": "out = subprocess.check_output(command)"
    },
    {
        "line": 18,
        "fullcodeline": "command = ["
    },
    {
        "line": 29,
        "fullcodeline": "subprocess.call(command)"
    },
    {
        "line": 30,
        "fullcodeline": "print(\"[prerun] Created user {0}\".format(name))"
    },
    {
        "line": 33,
        "fullcodeline": "command = [\"ckan\", \"-c\", ckan_ini, \"sysadmin\", \"add\", name]"
    },
    {
        "line": 35,
        "fullcodeline": "subprocess.call(command)"
    },
    {
        "line": 36,
        "fullcodeline": "print(\"[prerun] Made user {0} a sysadmin\".format(name))"
    },
    {
        "line": 40,
        "fullcodeline": "data_dir = \"%s/storage\" % os.environ['CKAN_STORAGE_PATH']"
    },
    {
        "line": 42,
        "fullcodeline": "command = [\"chown\", \"-R\", \"ckan:ckan\", data_dir]"
    },
    {
        "line": 43,
        "fullcodeline": "subprocess.call(command)"
    },
    {
        "line": 44,
        "fullcodeline": "print(\"[prerun] Ensured storage directory is owned by ckan\")"
    },
    {
        "line": 13,
        "fullcodeline": "if b\"User:None\" not in re.sub(b\"\\s\", b\"\", out):"
    },
    {
        "line": 14,
        "fullcodeline": "print(\"[prerun] Sysadmin user exists, skipping creation\")"
    },
    {
        "line": 25,
        "fullcodeline": "\"password=\" + password,"
    },
    {
        "line": 26,
        "fullcodeline": "\"email=\" + email,"
    }
]