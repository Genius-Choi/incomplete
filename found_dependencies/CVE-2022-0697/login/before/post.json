[
    {
        "line": 2,
        "fullcodeline": "form = forms.UserForm()"
    },
    {
        "line": 3,
        "fullcodeline": "if form.validate_on_submit():"
    },
    {
        "line": 19,
        "fullcodeline": "return render_template(\"users/login.html\", form=form, title=\"Login\")"
    },
    {
        "line": 4,
        "fullcodeline": "db = get_db()"
    },
    {
        "line": 5,
        "fullcodeline": "user = db.search("
    },
    {
        "line": 17,
        "fullcodeline": "flash(\"Invalid credentials\", \"error\")"
    },
    {
        "line": 9,
        "fullcodeline": "if user and check_password_hash(user[0][\"hashed_password\"], form.password.data):"
    },
    {
        "line": 18,
        "fullcodeline": "return redirect(\"/login\")"
    },
    {
        "line": 6,
        "fullcodeline": "(Query().username == form.username.data) & (Query().type == \"user\")"
    },
    {
        "line": 10,
        "fullcodeline": "user = User.from_db(user[0])"
    },
    {
        "line": 11,
        "fullcodeline": "login_user(user, remember=True)"
    },
    {
        "line": 12,
        "fullcodeline": "flash(\"Login successful!\", \"success\")"
    },
    {
        "line": 14,
        "fullcodeline": "next_url = request.args.get(\"next\")"
    },
    {
        "line": 15,
        "fullcodeline": "return redirect(next_url or \"/\")"
    }
]