[
    {
        "line": 4,
        "fullcodeline": "assert(uri);"
    },
    {
        "line": 7,
        "fullcodeline": "char *authority_end = _strchrb(uri, uri_end, '/');"
    },
    {
        "line": 11,
        "fullcodeline": "result->host = uri;"
    },
    {
        "line": 12,
        "fullcodeline": "result->host_len = authority_end - uri;"
    },
    {
        "line": 15,
        "fullcodeline": "_consume_userinfo(result, uri, authority_end);"
    },
    {
        "line": 17,
        "fullcodeline": "char *ipv6_end = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "if (!authority_end) {"
    },
    {
        "line": 19,
        "fullcodeline": "if (result->host[0] == '[') {"
    },
    {
        "line": 9,
        "fullcodeline": "authority_end = uri_end;"
    },
    {
        "line": 20,
        "fullcodeline": "ipv6_end = _strchrb(result->host, uri_end, ']');"
    },
    {
        "line": 26,
        "fullcodeline": "char *zoneid_start = _strchrb(result->host, ipv6_end, '%');"
    },
    {
        "line": 39,
        "fullcodeline": "result->ipv6addr = result->host + 1;"
    },
    {
        "line": 40,
        "fullcodeline": "result->ipv6addr_len = ipv6_end - result->ipv6addr;"
    },
    {
        "line": 47,
        "fullcodeline": "if (!_consume_port(result, ipv6_end, authority_end)) {"
    },
    {
        "line": 52,
        "fullcodeline": "if ((result->host_len == 0) &&"
    },
    {
        "line": 53,
        "fullcodeline": "(result->userinfo || result->port)) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (ipv6_end >= authority_end) {"
    },
    {
        "line": 29,
        "fullcodeline": "result->zoneid = zoneid_start + 1;"
    },
    {
        "line": 30,
        "fullcodeline": "result->zoneid_len = ipv6_end - result->zoneid;"
    },
    {
        "line": 42,
        "fullcodeline": "result->ipv6addr_len -= result->zoneid_len + 1;"
    },
    {
        "line": 33,
        "fullcodeline": "if (result->zoneid_len == 0) {"
    }
]