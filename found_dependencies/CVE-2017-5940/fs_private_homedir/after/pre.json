[
    {
        "line": 2,
        "fullcodeline": "char *homedir = cfg.homedir;"
    },
    {
        "line": 3,
        "fullcodeline": "char *private_homedir = cfg.home_private;"
    },
    {
        "line": 4,
        "fullcodeline": "assert(homedir);"
    },
    {
        "line": 5,
        "fullcodeline": "assert(private_homedir);"
    },
    {
        "line": 7,
        "fullcodeline": "int xflag = store_xauthority();"
    },
    {
        "line": 8,
        "fullcodeline": "int aflag = store_asoundrc();"
    },
    {
        "line": 10,
        "fullcodeline": "uid_t u = getuid();"
    },
    {
        "line": 11,
        "fullcodeline": "gid_t g = getgid();"
    },
    {
        "line": 24,
        "fullcodeline": "fs_logger3(\"mount-bind\", private_homedir, cfg.homedir);"
    },
    {
        "line": 25,
        "fullcodeline": "fs_logger2(\"whitelist\", cfg.homedir);"
    },
    {
        "line": 50,
        "fullcodeline": "skel(homedir, u, g);"
    },
    {
        "line": 13,
        "fullcodeline": "if (stat(homedir, &s) == -1) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (mount(private_homedir, homedir, NULL, MS_NOSUID | MS_NODEV | MS_BIND | MS_REC, NULL) < 0)"
    },
    {
        "line": 32,
        "fullcodeline": "if (u != 0) {"
    },
    {
        "line": 14,
        "fullcodeline": "fprintf(stderr, \"Error: cannot find user home directory\\n\");"
    },
    {
        "line": 21,
        "fullcodeline": "printf(\"Mount-bind %s on top of %s\\n\", private_homedir, homedir);"
    },
    {
        "line": 23,
        "fullcodeline": "errExit(\"mount bind\");"
    },
    {
        "line": 38,
        "fullcodeline": "fs_logger(\"tmpfs /root\");"
    },
    {
        "line": 52,
        "fullcodeline": "copy_xauthority();"
    },
    {
        "line": 54,
        "fullcodeline": "copy_asoundrc();"
    },
    {
        "line": 36,
        "fullcodeline": "if (mount(\"tmpfs\", \"/root\", \"tmpfs\", MS_NOSUID | MS_NODEV | MS_NOEXEC | MS_STRICTATIME | MS_REC,  \"mode=700,gid=0\") < 0)"
    },
    {
        "line": 46,
        "fullcodeline": "fs_logger(\"tmpfs /home\");"
    },
    {
        "line": 35,
        "fullcodeline": "printf(\"Mounting a new /root directory\\n\");"
    },
    {
        "line": 37,
        "fullcodeline": "errExit(\"mounting home directory\");"
    },
    {
        "line": 44,
        "fullcodeline": "if (mount(\"tmpfs\", \"/home\", \"tmpfs\", MS_NOSUID | MS_NODEV | MS_NOEXEC | MS_STRICTATIME | MS_REC,  \"mode=755,gid=0\") < 0)"
    },
    {
        "line": 43,
        "fullcodeline": "printf(\"Mounting a new /home directory\\n\");"
    },
    {
        "line": 45,
        "fullcodeline": "errExit(\"mounting home directory\");"
    }
]