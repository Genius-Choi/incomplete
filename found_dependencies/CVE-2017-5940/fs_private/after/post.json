[
    {
        "line": 3,
        "fullcodeline": "assert(homedir);"
    },
    {
        "line": 4,
        "fullcodeline": "uid_t u = getuid();"
    },
    {
        "line": 5,
        "fullcodeline": "gid_t g = getgid();"
    },
    {
        "line": 7,
        "fullcodeline": "int xflag = store_xauthority();"
    },
    {
        "line": 8,
        "fullcodeline": "int aflag = store_asoundrc();"
    },
    {
        "line": 15,
        "fullcodeline": "fs_logger(\"tmpfs /home\");"
    },
    {
        "line": 22,
        "fullcodeline": "fs_logger(\"tmpfs /root\");"
    },
    {
        "line": 39,
        "fullcodeline": "skel(homedir, u, g);"
    },
    {
        "line": 13,
        "fullcodeline": "if (mount(\"tmpfs\", \"/home\", \"tmpfs\", MS_NOSUID | MS_NODEV | MS_NOEXEC | MS_STRICTATIME | MS_REC,  \"mode=755,gid=0\") < 0)"
    },
    {
        "line": 20,
        "fullcodeline": "if (mount(\"tmpfs\", \"/root\", \"tmpfs\", MS_NOSUID | MS_NODEV | MS_NOEXEC | MS_STRICTATIME | MS_REC,  \"mode=700,gid=0\") < 0)"
    },
    {
        "line": 24,
        "fullcodeline": "if (u != 0) {"
    },
    {
        "line": 12,
        "fullcodeline": "printf(\"Mounting a new /home directory\\n\");"
    },
    {
        "line": 14,
        "fullcodeline": "errExit(\"mounting home directory\");"
    },
    {
        "line": 19,
        "fullcodeline": "printf(\"Mounting a new /root directory\\n\");"
    },
    {
        "line": 21,
        "fullcodeline": "errExit(\"mounting root directory\");"
    },
    {
        "line": 36,
        "fullcodeline": "fs_logger2(\"mkdir\", homedir);"
    },
    {
        "line": 41,
        "fullcodeline": "copy_xauthority();"
    },
    {
        "line": 43,
        "fullcodeline": "copy_asoundrc();"
    },
    {
        "line": 28,
        "fullcodeline": "if (mkdir(homedir, S_IRWXU) == -1) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (chown(homedir, u, g) < 0)"
    },
    {
        "line": 27,
        "fullcodeline": "printf(\"Create a new user directory\\n\");"
    },
    {
        "line": 35,
        "fullcodeline": "errExit(\"chown\");"
    },
    {
        "line": 29,
        "fullcodeline": "if (mkpath_as_root(homedir) == -1)"
    },
    {
        "line": 31,
        "fullcodeline": "if (mkdir(homedir, S_IRWXU) == -1)"
    },
    {
        "line": 30,
        "fullcodeline": "errExit(\"mkpath\");"
    },
    {
        "line": 32,
        "fullcodeline": "errExit(\"mkdir\");"
    }
]