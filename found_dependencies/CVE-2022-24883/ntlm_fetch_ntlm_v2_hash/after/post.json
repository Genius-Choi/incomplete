[
    {
        "line": 3,
        "fullcodeline": "BOOL rc = FALSE;"
    },
    {
        "line": 4,
        "fullcodeline": "WINPR_SAM* sam = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "WINPR_SAM_ENTRY* entry = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "WINPR_ASSERT(context);"
    },
    {
        "line": 9,
        "fullcodeline": "WINPR_ASSERT(hash);"
    },
    {
        "line": 11,
        "fullcodeline": "credentials = context->credentials;"
    },
    {
        "line": 12,
        "fullcodeline": "sam = SamOpen(context->SamFile, TRUE);"
    },
    {
        "line": 17,
        "fullcodeline": "entry = SamLookupUserW("
    },
    {
        "line": 34,
        "fullcodeline": "NTOWFv2FromHashW(entry->NtHash, (LPWSTR)credentials->identity.User,"
    },
    {
        "line": 39,
        "fullcodeline": "rc = TRUE;"
    },
    {
        "line": 42,
        "fullcodeline": "SamFreeEntry(sam, entry);"
    },
    {
        "line": 43,
        "fullcodeline": "SamClose(sam);"
    },
    {
        "line": 14,
        "fullcodeline": "if (!sam)"
    },
    {
        "line": 21,
        "fullcodeline": "if (!entry)"
    },
    {
        "line": 27,
        "fullcodeline": "if (!entry)"
    },
    {
        "line": 35,
        "fullcodeline": "credentials->identity.UserLength * sizeof(WCHAR),"
    },
    {
        "line": 37,
        "fullcodeline": "credentials->identity.DomainLength * sizeof(WCHAR), (BYTE*)hash);"
    },
    {
        "line": 44,
        "fullcodeline": "if (!rc)"
    },
    {
        "line": 23,
        "fullcodeline": "entry = SamLookupUserW(sam, (LPWSTR)credentials->identity.User,"
    },
    {
        "line": 45,
        "fullcodeline": "WLog_ERR(TAG, \"Error: Could not find user in SAM database\");"
    },
    {
        "line": 24,
        "fullcodeline": "credentials->identity.UserLength * sizeof(WCHAR), NULL, 0);"
    }
]