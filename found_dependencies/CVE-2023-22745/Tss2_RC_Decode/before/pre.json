[
    {
        "line": 3,
        "fullcodeline": "static __thread char buf[TSS2_ERR_LAYER_NAME_MAX + TSS2_ERR_LAYER_ERROR_STR_MAX + 1];"
    },
    {
        "line": 5,
        "fullcodeline": "clearbuf(buf);"
    },
    {
        "line": 7,
        "fullcodeline": "UINT8 layer = tss2_rc_layer_number_get(rc);"
    },
    {
        "line": 9,
        "fullcodeline": "TSS2_RC_HANDLER handler = layer_handler[layer].handler;"
    },
    {
        "line": 10,
        "fullcodeline": "const char *lname = layer_handler[layer].name;"
    },
    {
        "line": 18,
        "fullcodeline": "handler = !handler ? unknown_layer_handler : handler;"
    },
    {
        "line": 25,
        "fullcodeline": "UINT16 err_bits = tpm2_error_get(rc);"
    },
    {
        "line": 26,
        "fullcodeline": "const char *e = err_bits ? handler(err_bits) : \"success\";"
    },
    {
        "line": 13,
        "fullcodeline": "catbuf(buf, \"%s:\", lname);"
    },
    {
        "line": 28,
        "fullcodeline": "catbuf(buf, \"%s\", e);"
    },
    {
        "line": 15,
        "fullcodeline": "catbuf(buf, \"%u:\", layer);"
    },
    {
        "line": 30,
        "fullcodeline": "catbuf(buf, \"0x%X\", err_bits);"
    }
]