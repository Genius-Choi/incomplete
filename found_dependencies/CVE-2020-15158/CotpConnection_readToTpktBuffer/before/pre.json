[
    {
        "line": 3,
        "fullcodeline": "uint8_t* buffer = self->readBuffer->buffer;"
    },
    {
        "line": 4,
        "fullcodeline": "int bufferSize = self->readBuffer->maxSize;"
    },
    {
        "line": 5,
        "fullcodeline": "int bufPos = self->readBuffer->size;"
    },
    {
        "line": 7,
        "fullcodeline": "assert (bufferSize > 4);"
    },
    {
        "line": 46,
        "fullcodeline": "readBytes = readFromSocket(self, buffer + bufPos, self->packetSize - bufPos);"
    },
    {
        "line": 51,
        "fullcodeline": "bufPos += readBytes;"
    },
    {
        "line": 58,
        "fullcodeline": "self->readBuffer->size = bufPos;"
    },
    {
        "line": 11,
        "fullcodeline": "if (bufPos < 4) {"
    },
    {
        "line": 48,
        "fullcodeline": "if (readBytes < 0)"
    },
    {
        "line": 53,
        "fullcodeline": "if (bufPos < self->packetSize)"
    },
    {
        "line": 13,
        "fullcodeline": "readBytes = readFromSocket(self, buffer + bufPos, 4 - bufPos);"
    },
    {
        "line": 23,
        "fullcodeline": "bufPos += readBytes;"
    },
    {
        "line": 56,
        "fullcodeline": "if (DEBUG_COTP) printf(\"TPKT: message complete (size = %i)\\n\", self->packetSize);"
    },
    {
        "line": 15,
        "fullcodeline": "if (readBytes < 0)"
    },
    {
        "line": 25,
        "fullcodeline": "if (bufPos == 4) {"
    },
    {
        "line": 72,
        "fullcodeline": "if (bufPos != 0)"
    },
    {
        "line": 73,
        "fullcodeline": "printf(\"TPKT: waiting (read %i of %i)\\n\", bufPos, self->packetSize);"
    },
    {
        "line": 19,
        "fullcodeline": "if (readBytes > 0)"
    },
    {
        "line": 26,
        "fullcodeline": "if ((buffer[0] == 3) && (buffer[1] == 0)) {"
    },
    {
        "line": 20,
        "fullcodeline": "printf(\"TPKT: read %i bytes from socket\\n\", readBytes);"
    },
    {
        "line": 27,
        "fullcodeline": "self->packetSize = (buffer[2] * 0x100) + buffer[3];"
    },
    {
        "line": 32,
        "fullcodeline": "if (self->packetSize > bufferSize) {"
    },
    {
        "line": 30,
        "fullcodeline": "printf(\"TPKT: header complete (msg size = %i)\\n\", self->packetSize);"
    }
]