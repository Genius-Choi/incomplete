[
    {
        "line": 6,
        "fullcodeline": "char buf[MAX_PKT_SIZE];"
    },
    {
        "line": 8,
        "fullcodeline": "memset(buf, 0, sizeof(buf));"
    },
    {
        "line": 9,
        "fullcodeline": "len = recvfrom(sd, buf, sizeof(buf), MSG_DONTWAIT, &sa, &salen);"
    },
    {
        "line": 10,
        "fullcodeline": "if (len > 0) {"
    },
    {
        "line": 11,
        "fullcodeline": "buf[len] = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "if (sa.sa_family != AF_INET)"
    },
    {
        "line": 16,
        "fullcodeline": "if (strstr(buf, \"M-SEARCH *\")) {"
    },
    {
        "line": 20,
        "fullcodeline": "struct sockaddr_in *sin = (struct sockaddr_in *)&sa;"
    },
    {
        "line": 22,
        "fullcodeline": "ifs = find_outbound(&sa);"
    },
    {
        "line": 27,
        "fullcodeline": "logit(LOG_DEBUG, \"Matching socket for client %s\", inet_ntoa(sin->sin_addr));"
    },
    {
        "line": 29,
        "fullcodeline": "type = strcasestr(buf, \"\\r\\nST:\");"
    },
    {
        "line": 37,
        "fullcodeline": "type = strchr(type, ':');"
    },
    {
        "line": 40,
        "fullcodeline": "type++;"
    },
    {
        "line": 44,
        "fullcodeline": "ptr = strstr(type, \"\\r\\n\");"
    },
    {
        "line": 47,
        "fullcodeline": "*ptr = 0;"
    },
    {
        "line": 58,
        "fullcodeline": "logit(LOG_DEBUG, \"M-SEARCH * for unsupported ST: %s from %s\", type,"
    },
    {
        "line": 23,
        "fullcodeline": "if (!ifs) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (!type) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (!type)"
    },
    {
        "line": 42,
        "fullcodeline": "type++;"
    },
    {
        "line": 45,
        "fullcodeline": "if (!ptr)"
    },
    {
        "line": 49,
        "fullcodeline": "for (i = 0; supported_types[i]; i++) {"
    },
    {
        "line": 59,
        "fullcodeline": "inet_ntoa(sin->sin_addr));"
    },
    {
        "line": 24,
        "fullcodeline": "logit(LOG_DEBUG, \"No matching socket for client %s\", inet_ntoa(sin->sin_addr));"
    },
    {
        "line": 32,
        "fullcodeline": "type = SSDP_ST_ALL;"
    },
    {
        "line": 33,
        "fullcodeline": "send_message(ifs, type, &sa);"
    },
    {
        "line": 50,
        "fullcodeline": "if (!strcmp(supported_types[i], type)) {"
    },
    {
        "line": 51,
        "fullcodeline": "logit(LOG_DEBUG, \"M-SEARCH * ST: %s from %s port %d\", type,"
    },
    {
        "line": 53,
        "fullcodeline": "send_message(ifs, type, &sa);"
    },
    {
        "line": 52,
        "fullcodeline": "inet_ntoa(sin->sin_addr), ntohs(sin->sin_port));"
    }
]