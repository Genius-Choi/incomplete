[
    {
        "line": 5,
        "fullcodeline": "struct qfq_sched *q = qdisc_priv(sch);"
    },
    {
        "line": 6,
        "fullcodeline": "struct qfq_class *cl = (struct qfq_class *)*arg;"
    },
    {
        "line": 7,
        "fullcodeline": "bool existing = false;"
    },
    {
        "line": 8,
        "fullcodeline": "struct nlattr *tb[TCA_QFQ_MAX + 1];"
    },
    {
        "line": 9,
        "fullcodeline": "struct qfq_aggregate *new_agg = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "err = nla_parse_nested_deprecated(tb, TCA_QFQ_MAX, tca[TCA_OPTIONS],"
    },
    {
        "line": 42,
        "fullcodeline": "inv_w = ONE_FP / weight;"
    },
    {
        "line": 43,
        "fullcodeline": "weight = ONE_FP / inv_w;"
    },
    {
        "line": 50,
        "fullcodeline": "delta_w = weight - (cl ? cl->agg->class_weight : 0);"
    },
    {
        "line": 73,
        "fullcodeline": "cl = kzalloc(sizeof(struct qfq_class), GFP_KERNEL);"
    },
    {
        "line": 77,
        "fullcodeline": "gnet_stats_basic_sync_init(&cl->bstats);"
    },
    {
        "line": 78,
        "fullcodeline": "cl->common.classid = classid;"
    },
    {
        "line": 79,
        "fullcodeline": "cl->deficit = lmax;"
    },
    {
        "line": 81,
        "fullcodeline": "cl->qdisc = qdisc_create_dflt(sch->dev_queue, &pfifo_qdisc_ops,"
    },
    {
        "line": 100,
        "fullcodeline": "sch_tree_lock(sch);"
    },
    {
        "line": 101,
        "fullcodeline": "new_agg = qfq_find_agg(q, lmax, weight);"
    },
    {
        "line": 117,
        "fullcodeline": "qfq_add_to_agg(q, new_agg, cl);"
    },
    {
        "line": 118,
        "fullcodeline": "sch_tree_unlock(sch);"
    },
    {
        "line": 125,
        "fullcodeline": "qdisc_put(cl->qdisc);"
    },
    {
        "line": 14,
        "fullcodeline": "if (tca[TCA_OPTIONS] == NULL) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (err < 0)"
    },
    {
        "line": 52,
        "fullcodeline": "if (q->wsum + delta_w > QFQ_MAX_WSUM) {"
    },
    {
        "line": 58,
        "fullcodeline": "if (cl != NULL) { /* modify existing class */"
    },
    {
        "line": 74,
        "fullcodeline": "if (cl == NULL)"
    },
    {
        "line": 83,
        "fullcodeline": "if (cl->qdisc == NULL)"
    },
    {
        "line": 96,
        "fullcodeline": "if (cl->qdisc != &noop_qdisc)"
    },
    {
        "line": 102,
        "fullcodeline": "if (new_agg == NULL) { /* create new aggregate */"
    },
    {
        "line": 15,
        "fullcodeline": "pr_notice(\"qfq: no options\\n\");"
    },
    {
        "line": 25,
        "fullcodeline": "weight = nla_get_u32(tb[TCA_QFQ_WEIGHT]);"
    },
    {
        "line": 34,
        "fullcodeline": "lmax = nla_get_u32(tb[TCA_QFQ_LMAX]);"
    },
    {
        "line": 45,
        "fullcodeline": "if (cl != NULL &&"
    },
    {
        "line": 47,
        "fullcodeline": "weight == cl->agg->class_weight)"
    },
    {
        "line": 84,
        "fullcodeline": "cl->qdisc = &noop_qdisc;"
    },
    {
        "line": 87,
        "fullcodeline": "err = gen_new_estimator(&cl->bstats, NULL,"
    },
    {
        "line": 97,
        "fullcodeline": "qdisc_hash_add(cl->qdisc, true);"
    },
    {
        "line": 103,
        "fullcodeline": "sch_tree_unlock(sch);"
    },
    {
        "line": 104,
        "fullcodeline": "new_agg = kzalloc(sizeof(*new_agg), GFP_KERNEL);"
    },
    {
        "line": 110,
        "fullcodeline": "sch_tree_lock(sch);"
    },
    {
        "line": 111,
        "fullcodeline": "qfq_init_agg(q, new_agg, lmax, weight);"
    },
    {
        "line": 114,
        "fullcodeline": "qfq_deact_rm_from_agg(q, cl);"
    },
    {
        "line": 16,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 31,
        "fullcodeline": "weight = 1;"
    },
    {
        "line": 40,
        "fullcodeline": "lmax = psched_mtu(qdisc_dev(sch));"
    },
    {
        "line": 46,
        "fullcodeline": "lmax == cl->agg->lmax &&"
    },
    {
        "line": 55,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 75,
        "fullcodeline": "return -ENOBUFS;"
    },
    {
        "line": 105,
        "fullcodeline": "if (new_agg == NULL) {"
    },
    {
        "line": 116,
        "fullcodeline": "qdisc_class_hash_insert(&q->clhash, &cl->common);"
    },
    {
        "line": 26,
        "fullcodeline": "if (!weight || weight > (1UL << QFQ_MAX_WSHIFT)) {"
    },
    {
        "line": 35,
        "fullcodeline": "if (lmax < QFQ_MIN_LMAX || lmax > (1UL << QFQ_MTU_SHIFT)) {"
    },
    {
        "line": 60,
        "fullcodeline": "err = gen_replace_estimator(&cl->bstats, NULL,"
    },
    {
        "line": 106,
        "fullcodeline": "err = -ENOBUFS;"
    },
    {
        "line": 28,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 37,
        "fullcodeline": "return -EINVAL;"
    }
]