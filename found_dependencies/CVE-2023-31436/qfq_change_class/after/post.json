[
    {
        "line": 5,
        "fullcodeline": "struct qfq_sched *q = qdisc_priv(sch);"
    },
    {
        "line": 7,
        "fullcodeline": "bool existing = false;"
    },
    {
        "line": 8,
        "fullcodeline": "struct nlattr *tb[TCA_QFQ_MAX + 1];"
    },
    {
        "line": 9,
        "fullcodeline": "struct qfq_aggregate *new_agg = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "err = nla_parse_nested_deprecated(tb, TCA_QFQ_MAX, tca[TCA_OPTIONS],"
    },
    {
        "line": 43,
        "fullcodeline": "inv_w = ONE_FP / weight;"
    },
    {
        "line": 44,
        "fullcodeline": "weight = ONE_FP / inv_w;"
    },
    {
        "line": 51,
        "fullcodeline": "delta_w = weight - (cl ? cl->agg->class_weight : 0);"
    },
    {
        "line": 74,
        "fullcodeline": "cl = kzalloc(sizeof(struct qfq_class), GFP_KERNEL);"
    },
    {
        "line": 78,
        "fullcodeline": "gnet_stats_basic_sync_init(&cl->bstats);"
    },
    {
        "line": 79,
        "fullcodeline": "cl->common.classid = classid;"
    },
    {
        "line": 80,
        "fullcodeline": "cl->deficit = lmax;"
    },
    {
        "line": 82,
        "fullcodeline": "cl->qdisc = qdisc_create_dflt(sch->dev_queue, &pfifo_qdisc_ops,"
    },
    {
        "line": 101,
        "fullcodeline": "sch_tree_lock(sch);"
    },
    {
        "line": 102,
        "fullcodeline": "new_agg = qfq_find_agg(q, lmax, weight);"
    },
    {
        "line": 118,
        "fullcodeline": "qfq_add_to_agg(q, new_agg, cl);"
    },
    {
        "line": 119,
        "fullcodeline": "sch_tree_unlock(sch);"
    },
    {
        "line": 120,
        "fullcodeline": "qdisc_class_hash_grow(sch, &q->clhash);"
    },
    {
        "line": 122,
        "fullcodeline": "*arg = (unsigned long)cl;"
    },
    {
        "line": 126,
        "fullcodeline": "qdisc_put(cl->qdisc);"
    },
    {
        "line": 127,
        "fullcodeline": "kfree(cl);"
    },
    {
        "line": 14,
        "fullcodeline": "if (tca[TCA_OPTIONS] == NULL) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (err < 0)"
    },
    {
        "line": 38,
        "fullcodeline": "if (lmax < QFQ_MIN_LMAX || lmax > (1UL << QFQ_MTU_SHIFT)) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (cl != NULL &&"
    },
    {
        "line": 53,
        "fullcodeline": "if (q->wsum + delta_w > QFQ_MAX_WSUM) {"
    },
    {
        "line": 59,
        "fullcodeline": "if (cl != NULL) { /* modify existing class */"
    },
    {
        "line": 75,
        "fullcodeline": "if (cl == NULL)"
    },
    {
        "line": 84,
        "fullcodeline": "if (cl->qdisc == NULL)"
    },
    {
        "line": 97,
        "fullcodeline": "if (cl->qdisc != &noop_qdisc)"
    },
    {
        "line": 103,
        "fullcodeline": "if (new_agg == NULL) { /* create new aggregate */"
    },
    {
        "line": 15,
        "fullcodeline": "pr_notice(\"qfq: no options\\n\");"
    },
    {
        "line": 25,
        "fullcodeline": "weight = nla_get_u32(tb[TCA_QFQ_WEIGHT]);"
    },
    {
        "line": 34,
        "fullcodeline": "lmax = nla_get_u32(tb[TCA_QFQ_LMAX]);"
    },
    {
        "line": 39,
        "fullcodeline": "pr_notice(\"qfq: invalid max length %u\\n\", lmax);"
    },
    {
        "line": 48,
        "fullcodeline": "weight == cl->agg->class_weight)"
    },
    {
        "line": 54,
        "fullcodeline": "pr_notice(\"qfq: total weight out of range (%d + %u)\\n\","
    },
    {
        "line": 69,
        "fullcodeline": "existing = true;"
    },
    {
        "line": 85,
        "fullcodeline": "cl->qdisc = &noop_qdisc;"
    },
    {
        "line": 88,
        "fullcodeline": "err = gen_new_estimator(&cl->bstats, NULL,"
    },
    {
        "line": 98,
        "fullcodeline": "qdisc_hash_add(cl->qdisc, true);"
    },
    {
        "line": 104,
        "fullcodeline": "sch_tree_unlock(sch);"
    },
    {
        "line": 105,
        "fullcodeline": "new_agg = kzalloc(sizeof(*new_agg), GFP_KERNEL);"
    },
    {
        "line": 111,
        "fullcodeline": "sch_tree_lock(sch);"
    },
    {
        "line": 112,
        "fullcodeline": "qfq_init_agg(q, new_agg, lmax, weight);"
    },
    {
        "line": 115,
        "fullcodeline": "qfq_deact_rm_from_agg(q, cl);"
    },
    {
        "line": 16,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 26,
        "fullcodeline": "if (!weight || weight > (1UL << QFQ_MAX_WSHIFT)) {"
    },
    {
        "line": 31,
        "fullcodeline": "weight = 1;"
    },
    {
        "line": 36,
        "fullcodeline": "lmax = psched_mtu(qdisc_dev(sch));"
    },
    {
        "line": 40,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 47,
        "fullcodeline": "lmax == cl->agg->lmax &&"
    },
    {
        "line": 56,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 76,
        "fullcodeline": "return -ENOBUFS;"
    },
    {
        "line": 106,
        "fullcodeline": "if (new_agg == NULL) {"
    },
    {
        "line": 117,
        "fullcodeline": "qdisc_class_hash_insert(&q->clhash, &cl->common);"
    },
    {
        "line": 27,
        "fullcodeline": "pr_notice(\"qfq: invalid weight %u\\n\", weight);"
    },
    {
        "line": 61,
        "fullcodeline": "err = gen_replace_estimator(&cl->bstats, NULL,"
    },
    {
        "line": 107,
        "fullcodeline": "err = -ENOBUFS;"
    },
    {
        "line": 108,
        "fullcodeline": "gen_kill_estimator(&cl->rate_est);"
    },
    {
        "line": 28,
        "fullcodeline": "return -EINVAL;"
    }
]