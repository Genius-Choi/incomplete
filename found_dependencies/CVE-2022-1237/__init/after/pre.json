[
    {
        "line": 2,
        "fullcodeline": "bin->header_offset = r_buf_read_le16_at (buf, 0x3c);"
    },
    {
        "line": 3,
        "fullcodeline": "bin->ne_header = R_NEW0 (NE_image_header);"
    },
    {
        "line": 7,
        "fullcodeline": "bin->buf = buf;"
    },
    {
        "line": 9,
        "fullcodeline": "r_buf_read_at (buf, bin->header_offset, (ut8 *)bin->ne_header, sizeof (NE_image_header));"
    },
    {
        "line": 16,
        "fullcodeline": "bin->alignment = 1 << bin->ne_header->FileAlnSzShftCnt;"
    },
    {
        "line": 20,
        "fullcodeline": "bin->os = __get_target_os (bin);"
    },
    {
        "line": 22,
        "fullcodeline": "ut16 offset = bin->ne_header->SegTableOffset + bin->header_offset;"
    },
    {
        "line": 23,
        "fullcodeline": "size_t size = bin->ne_header->SegCount * sizeof (NE_image_segment_entry);"
    },
    {
        "line": 27,
        "fullcodeline": "size_t remaining = r_buf_size (bin->buf) - offset;"
    },
    {
        "line": 28,
        "fullcodeline": "size = R_MIN (remaining, size);"
    },
    {
        "line": 29,
        "fullcodeline": "bin->segment_entries = calloc (1, size);"
    },
    {
        "line": 36,
        "fullcodeline": "r_buf_read_at (buf, offset, (ut8 *)bin->segment_entries, size);"
    },
    {
        "line": 37,
        "fullcodeline": "bin->entry_table = calloc (1, bin->ne_header->EntryTableLength);"
    },
    {
        "line": 38,
        "fullcodeline": "r_buf_read_at (buf, (ut64)bin->header_offset + bin->ne_header->EntryTableOffset, bin->entry_table, bin->ne_header->EntryTableLength);"
    },
    {
        "line": 39,
        "fullcodeline": "bin->imports = r_bin_ne_get_imports (bin);"
    },
    {
        "line": 4,
        "fullcodeline": "if (!bin->ne_header) {"
    },
    {
        "line": 10,
        "fullcodeline": "if (bin->ne_header->FileAlnSzShftCnt > 8) {"
    },
    {
        "line": 17,
        "fullcodeline": "if (!bin->alignment) {"
    },
    {
        "line": 24,
        "fullcodeline": "if (offset >= r_buf_size (bin->buf)) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (size >= remaining) {"
    },
    {
        "line": 33,
        "fullcodeline": "if (!bin->segment_entries) {"
    },
    {
        "line": 11,
        "fullcodeline": "bin->ne_header->FileAlnSzShftCnt = 8;"
    },
    {
        "line": 13,
        "fullcodeline": "if (bin->ne_header->ModRefs * sizeof (ut16) >= r_buf_size (bin->buf)) {"
    },
    {
        "line": 18,
        "fullcodeline": "bin->alignment = 1 << 9;"
    },
    {
        "line": 14,
        "fullcodeline": "bin->ne_header->ModRefs = r_buf_size (bin->buf) / sizeof (ut16);"
    },
    {
        "line": 31,
        "fullcodeline": "bin->ne_header->SegCount = size / sizeof (NE_image_segment_entry);"
    }
]