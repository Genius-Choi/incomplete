[
    {
        "line": 3,
        "fullcodeline": "char ibuf[LONG_STRING * 2], obuf[LONG_STRING];"
    },
    {
        "line": 4,
        "fullcodeline": "unsigned char hmac_response[MD5_DIGEST_LEN];"
    },
    {
        "line": 11,
        "fullcodeline": "mutt_message(_(\"Authenticating (CRAM-MD5)...\"));"
    },
    {
        "line": 19,
        "fullcodeline": "imap_cmd_start(idata, \"AUTHENTICATE CRAM-MD5\");"
    },
    {
        "line": 37,
        "fullcodeline": "len = mutt_b64_decode(obuf, idata->buf + 2);"
    },
    {
        "line": 44,
        "fullcodeline": "obuf[len] = '\\0';"
    },
    {
        "line": 45,
        "fullcodeline": "mutt_debug(2, \"CRAM challenge: %s\\n\", obuf);"
    },
    {
        "line": 58,
        "fullcodeline": "hmac_md5(idata->conn->account.pass, obuf, hmac_response);"
    },
    {
        "line": 60,
        "fullcodeline": "int off = snprintf(obuf, sizeof(obuf), \"%s \", idata->conn->account.user);"
    },
    {
        "line": 61,
        "fullcodeline": "mutt_md5_toascii(hmac_response, obuf + off);"
    },
    {
        "line": 62,
        "fullcodeline": "mutt_debug(2, \"CRAM response: %s\\n\", obuf);"
    },
    {
        "line": 66,
        "fullcodeline": "mutt_b64_encode(ibuf, obuf, strlen(obuf), sizeof(ibuf) - 2);"
    },
    {
        "line": 67,
        "fullcodeline": "mutt_str_strcat(ibuf, sizeof(ibuf), \"\\r\\n\");"
    },
    {
        "line": 68,
        "fullcodeline": "mutt_socket_send(idata->conn, ibuf);"
    },
    {
        "line": 84,
        "fullcodeline": "mutt_error(_(\"CRAM-MD5 authentication failed.\"));"
    },
    {
        "line": 8,
        "fullcodeline": "if (!mutt_bit_isset(idata->capabilities, ACRAM_MD5))"
    },
    {
        "line": 14,
        "fullcodeline": "if (mutt_account_getlogin(&idata->conn->account) < 0)"
    },
    {
        "line": 16,
        "fullcodeline": "if (mutt_account_getpass(&idata->conn->account) < 0)"
    },
    {
        "line": 28,
        "fullcodeline": "rc = imap_cmd_step(idata);"
    },
    {
        "line": 29,
        "fullcodeline": "while (rc == IMAP_CMD_CONTINUE);"
    },
    {
        "line": 31,
        "fullcodeline": "if (rc != IMAP_CMD_RESPOND)"
    },
    {
        "line": 38,
        "fullcodeline": "if (len == -1)"
    },
    {
        "line": 71,
        "fullcodeline": "rc = imap_cmd_step(idata);"
    },
    {
        "line": 72,
        "fullcodeline": "while (rc == IMAP_CMD_CONTINUE);"
    },
    {
        "line": 74,
        "fullcodeline": "if (rc != IMAP_CMD_OK)"
    },
    {
        "line": 80,
        "fullcodeline": "if (imap_code(idata->buf))"
    },
    {
        "line": 33,
        "fullcodeline": "mutt_debug(1, \"Invalid response from server: %s\\n\", ibuf);"
    },
    {
        "line": 40,
        "fullcodeline": "mutt_debug(1, \"Error decoding base64 response.\\n\");"
    },
    {
        "line": 76,
        "fullcodeline": "mutt_debug(1, \"Error receiving server response.\\n\");"
    }
]