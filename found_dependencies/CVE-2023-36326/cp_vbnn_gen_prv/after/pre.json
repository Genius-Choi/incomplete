[
    {
        "line": 3,
        "fullcodeline": "uint8_t hash[RLC_MD_LEN];"
    },
    {
        "line": 5,
        "fullcodeline": "uint8_t *buf = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "int result = RLC_OK;"
    },
    {
        "line": 10,
        "fullcodeline": "bn_null(n);"
    },
    {
        "line": 11,
        "fullcodeline": "bn_null(r);"
    },
    {
        "line": 15,
        "fullcodeline": "bn_new(n);"
    },
    {
        "line": 16,
        "fullcodeline": "bn_new(r);"
    },
    {
        "line": 19,
        "fullcodeline": "ec_curve_get_ord(n);"
    },
    {
        "line": 22,
        "fullcodeline": "bn_rand_mod(r, n);"
    },
    {
        "line": 25,
        "fullcodeline": "ec_mul_gen(pk, r);"
    },
    {
        "line": 28,
        "fullcodeline": "len = id_len + ec_size_bin(pk, 1);"
    },
    {
        "line": 29,
        "fullcodeline": "buf = RLC_ALLOCA(uint8_t, len);"
    },
    {
        "line": 33,
        "fullcodeline": "memcpy(buf, id, id_len);"
    },
    {
        "line": 34,
        "fullcodeline": "ec_write_bin(buf + id_len, ec_size_bin(pk, 1), pk, 1);"
    },
    {
        "line": 36,
        "fullcodeline": "md_map(hash, buf, len);"
    },
    {
        "line": 37,
        "fullcodeline": "bn_read_bin(sk, hash, RLC_MD_LEN);"
    },
    {
        "line": 38,
        "fullcodeline": "bn_mod(sk, sk, n);"
    },
    {
        "line": 39,
        "fullcodeline": "bn_mul(sk, sk, msk);"
    },
    {
        "line": 40,
        "fullcodeline": "bn_add(sk, sk, r);"
    },
    {
        "line": 41,
        "fullcodeline": "bn_mod(sk, sk, n);"
    },
    {
        "line": 44,
        "fullcodeline": "result = RLC_ERR;"
    },
    {
        "line": 48,
        "fullcodeline": "bn_free(n);"
    },
    {
        "line": 49,
        "fullcodeline": "bn_free(r);"
    },
    {
        "line": 50,
        "fullcodeline": "RLC_FREE(buf);"
    },
    {
        "line": 30,
        "fullcodeline": "if (buf == NULL) {"
    },
    {
        "line": 31,
        "fullcodeline": "RLC_THROW(ERR_NO_MEMORY);"
    }
]