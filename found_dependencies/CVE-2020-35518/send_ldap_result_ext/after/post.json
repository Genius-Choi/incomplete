[
    {
        "line": 11,
        "fullcodeline": "passwdPolicy *pwpolicy = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "Connection *conn = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "Slapi_DN *sdn = NULL;"
    },
    {
        "line": 14,
        "fullcodeline": "const char *dn = NULL;"
    },
    {
        "line": 16,
        "fullcodeline": "int flush_ber_element = 1;"
    },
    {
        "line": 17,
        "fullcodeline": "ber_tag_t bind_method = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "int i, rc, logit = 0;"
    },
    {
        "line": 22,
        "fullcodeline": "slapi_pblock_get(pb, SLAPI_BIND_METHOD, &bind_method);"
    },
    {
        "line": 23,
        "fullcodeline": "slapi_pblock_get(pb, SLAPI_OPERATION, &operation);"
    },
    {
        "line": 24,
        "fullcodeline": "slapi_pblock_get(pb, SLAPI_CONNECTION, &conn);"
    },
    {
        "line": 60,
        "fullcodeline": "slapi_log_err(SLAPI_LOG_TRACE, \"send_ldap_result_ext\", \"=> %d:%s:%s\\n\", err,"
    },
    {
        "line": 88,
        "fullcodeline": "internal_op = operation_is_flag_set(operation, OP_FLAG_INTERNAL);"
    },
    {
        "line": 284,
        "fullcodeline": "operation->o_status = SLAPI_OP_STATUS_RESULT_SENT; /* in case this has not yet been set */"
    },
    {
        "line": 291,
        "fullcodeline": "slapi_log_err(SLAPI_LOG_TRACE, \"send_ldap_result_ext\", \"<= %d\\n\", err);"
    },
    {
        "line": 32,
        "fullcodeline": "if (operation == NULL) {"
    },
    {
        "line": 37,
        "fullcodeline": "if (operation->o_status == SLAPI_OP_STATUS_RESULT_SENT) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (ber != NULL) {"
    },
    {
        "line": 45,
        "fullcodeline": "if (err != LDAP_SUCCESS) {"
    },
    {
        "line": 61,
        "fullcodeline": "matched ? matched : \"\", text ? text : \"\");"
    },
    {
        "line": 89,
        "fullcodeline": "if ((conn == NULL) || (internal_op)) {"
    },
    {
        "line": 100,
        "fullcodeline": "if ((err == LDAP_INVALID_CREDENTIALS) && (bind_method != LDAP_AUTH_SASL)) {"
    },
    {
        "line": 117,
        "fullcodeline": "if (ber == NULL) {"
    },
    {
        "line": 125,
        "fullcodeline": "if (err == LDAP_ADMINLIMIT_EXCEEDED &&"
    },
    {
        "line": 130,
        "fullcodeline": "if (conn->c_ldapversion < LDAP_VERSION3 || urls == NULL) {"
    },
    {
        "line": 246,
        "fullcodeline": "if (err == LDAP_SUCCESS) {"
    },
    {
        "line": 259,
        "fullcodeline": "if (operation->o_results.result_controls != NULL && conn->c_ldapversion >= LDAP_VERSION3 && write_controls(ber, operation->o_results.result_controls) != 0) {"
    },
    {
        "line": 263,
        "fullcodeline": "if (rc != LBER_ERROR) { /* end the LDAPMessage sequence */"
    },
    {
        "line": 267,
        "fullcodeline": "if (rc == LBER_ERROR) {"
    },
    {
        "line": 286,
        "fullcodeline": "if (logit && (operation_is_flag_set(operation, OP_FLAG_ACTION_LOG_ACCESS) ||"
    },
    {
        "line": 27,
        "fullcodeline": "pbtext = text;"
    },
    {
        "line": 33,
        "fullcodeline": "slapi_log_err(SLAPI_LOG_ERR, \"send_ldap_result_ext\", \"No operation found: slapi_search_internal_set_pb was incomplete (invalid 'base' ?)\\n\");"
    },
    {
        "line": 42,
        "fullcodeline": "flush_ber_element = 0;"
    },
    {
        "line": 65,
        "fullcodeline": "tag = LBER_SEQUENCE;"
    },
    {
        "line": 69,
        "fullcodeline": "tag = LDAP_RES_SEARCH_RESULT;"
    },
    {
        "line": 73,
        "fullcodeline": "tag = LDAP_RES_DELETE;"
    },
    {
        "line": 84,
        "fullcodeline": "tag = operation->o_tag + 1;"
    },
    {
        "line": 101,
        "fullcodeline": "slapi_pblock_get(pb, SLAPI_TARGET_SDN, &sdn);"
    },
    {
        "line": 102,
        "fullcodeline": "dn = slapi_sdn_get_dn(sdn);"
    },
    {
        "line": 103,
        "fullcodeline": "pwpolicy = new_passwdPolicy(pb, dn);"
    },
    {
        "line": 126,
        "fullcodeline": "conn->c_ldapversion < LDAP_VERSION3) {"
    },
    {
        "line": 127,
        "fullcodeline": "err = LDAP_SIZELIMIT_EXCEEDED;"
    },
    {
        "line": 131,
        "fullcodeline": "char *save, *buf = NULL;"
    },
    {
        "line": 177,
        "fullcodeline": "rc = ber_printf(ber, \"{it{ess\", operation->o_msgid, tag, err,"
    },
    {
        "line": 260,
        "fullcodeline": "rc = (int)LBER_ERROR;"
    },
    {
        "line": 264,
        "fullcodeline": "rc = ber_put_seq(ber);"
    },
    {
        "line": 268,
        "fullcodeline": "slapi_log_err(SLAPI_LOG_ERR, \"send_ldap_result_ext\", \"ber_printf failed 1\\n\");"
    },
    {
        "line": 288,
        "fullcodeline": "log_result(pb, operation, err, tag, nentries);"
    },
    {
        "line": 29,
        "fullcodeline": "slapi_pblock_get(pb, SLAPI_RESULT_TEXT, &pbtext);"
    },
    {
        "line": 48,
        "fullcodeline": "if (err == LDAP_INVALID_CREDENTIALS || err == LDAP_INAPPROPRIATE_AUTH || err == LDAP_AUTH_METHOD_NOT_SUPPORTED || err == LDAP_STRONG_AUTH_NOT_SUPPORTED || err == LDAP_STRONG_AUTH_REQUIRED || err == LDAP_CONFIDENTIALITY_REQUIRED || err == LDAP_INSUFFICIENT_ACCESS || err == LDAP_AUTH_UNKNOWN) {"
    },
    {
        "line": 77,
        "fullcodeline": "if (conn && conn->c_ldapversion > LDAP_VERSION2) {"
    },
    {
        "line": 90,
        "fullcodeline": "if (operation->o_result_handler != NULL) {"
    },
    {
        "line": 104,
        "fullcodeline": "if (pwpolicy && (pwpolicy->pw_lockout == 1)) {"
    },
    {
        "line": 118,
        "fullcodeline": "if ((ber = der_alloc()) == NULL) {"
    },
    {
        "line": 137,
        "fullcodeline": "if (urls != NULL) {"
    },
    {
        "line": 172,
        "fullcodeline": "if ((conn->c_ldapversion < LDAP_VERSION3 &&"
    },
    {
        "line": 185,
        "fullcodeline": "if (rc != LBER_ERROR) {"
    },
    {
        "line": 194,
        "fullcodeline": "if (rc != LBER_ERROR) {"
    },
    {
        "line": 199,
        "fullcodeline": "if (rc != LBER_ERROR) {"
    },
    {
        "line": 203,
        "fullcodeline": "if (buf != NULL) {"
    },
    {
        "line": 214,
        "fullcodeline": "rc = ber_printf(ber, \"{it{esst{s\", operation->o_msgid, tag, err,"
    },
    {
        "line": 250,
        "fullcodeline": "if (process_read_entry_controls(pb, LDAP_CONTROL_PRE_READ_ENTRY)) {"
    },
    {
        "line": 254,
        "fullcodeline": "if (process_read_entry_controls(pb, LDAP_CONTROL_POST_READ_ENTRY)) {"
    },
    {
        "line": 269,
        "fullcodeline": "if (flush_ber_element == 1) {"
    },
    {
        "line": 278,
        "fullcodeline": "if (flush_ber(pb, conn, operation, ber, _LDAP_SEND_RESULT) == 0) {"
    },
    {
        "line": 287,
        "fullcodeline": "(internal_op && config_get_plugin_logging()))) {"
    },
    {
        "line": 78,
        "fullcodeline": "tag = LDAP_TAG_REFERRAL;"
    },
    {
        "line": 91,
        "fullcodeline": "operation->o_result_handler(conn, operation, err,"
    },
    {
        "line": 93,
        "fullcodeline": "logit = 1;"
    },
    {
        "line": 119,
        "fullcodeline": "slapi_log_err(SLAPI_LOG_ERR, \"send_ldap_result_ext\", \"ber_alloc failed\\n\");"
    },
    {
        "line": 146,
        "fullcodeline": "len = 10; /* strlen(\"Referral:\") + NULL */"
    },
    {
        "line": 157,
        "fullcodeline": "buf = slapi_ch_malloc(len);"
    },
    {
        "line": 158,
        "fullcodeline": "*buf = '\\0';"
    },
    {
        "line": 163,
        "fullcodeline": "strcat(buf, \"Referral:\");"
    },
    {
        "line": 168,
        "fullcodeline": "save = text;"
    },
    {
        "line": 169,
        "fullcodeline": "text = buf;"
    },
    {
        "line": 174,
        "fullcodeline": "urls != NULL) {"
    },
    {
        "line": 175,
        "fullcodeline": "err = LDAP_PARTIAL_RESULTS;"
    },
    {
        "line": 178,
        "fullcodeline": "matched ? matched : \"\", pbtext ? pbtext : \"\");"
    },
    {
        "line": 186,
        "fullcodeline": "rc = check_and_send_extended_result(pb, tag, ber);"
    },
    {
        "line": 195,
        "fullcodeline": "rc = check_and_send_SASL_response(pb, tag, ber, conn);"
    },
    {
        "line": 200,
        "fullcodeline": "rc = ber_printf(ber, \"}\"); /* one more } to come */"
    },
    {
        "line": 204,
        "fullcodeline": "text = save;"
    },
    {
        "line": 205,
        "fullcodeline": "slapi_ch_free((void **)&buf);"
    },
    {
        "line": 212,
        "fullcodeline": "if (!config_check_referral_mode())"
    },
    {
        "line": 217,
        "fullcodeline": "for (i = 1; urls[i] != NULL && rc != LBER_ERROR; i++) {"
    },
    {
        "line": 220,
        "fullcodeline": "if (rc != LBER_ERROR) {"
    },
    {
        "line": 229,
        "fullcodeline": "if (rc != LBER_ERROR) {"
    },
    {
        "line": 238,
        "fullcodeline": "if (rc != LBER_ERROR) {"
    },
    {
        "line": 242,
        "fullcodeline": "if (rc != LBER_ERROR) {"
    },
    {
        "line": 251,
        "fullcodeline": "err = LDAP_UNAVAILABLE_CRITICAL_EXTENSION;"
    },
    {
        "line": 255,
        "fullcodeline": "err = LDAP_UNAVAILABLE_CRITICAL_EXTENSION;"
    },
    {
        "line": 271,
        "fullcodeline": "ber_free(ber, 1 /* freebuf */);"
    },
    {
        "line": 279,
        "fullcodeline": "logit = 1;"
    },
    {
        "line": 105,
        "fullcodeline": "if (update_pw_retry(pb) == LDAP_CONSTRAINT_VIOLATION && !pwpolicy->pw_is_legacy) {"
    },
    {
        "line": 147,
        "fullcodeline": "for (i = 0; urls[i] != NULL; i++) {"
    },
    {
        "line": 150,
        "fullcodeline": "if (text != NULL) {"
    },
    {
        "line": 159,
        "fullcodeline": "if (text != NULL) {"
    },
    {
        "line": 164,
        "fullcodeline": "for (i = 0; urls[i] != NULL; i++) {"
    },
    {
        "line": 173,
        "fullcodeline": "err == LDAP_REFERRAL) ||"
    },
    {
        "line": 215,
        "fullcodeline": "matched ? matched : \"\", text ? text : \"\", LDAP_TAG_REFERRAL,"
    },
    {
        "line": 218,
        "fullcodeline": "rc = ber_printf(ber, \"s\", urls[i]->bv_val);"
    },
    {
        "line": 221,
        "fullcodeline": "rc = ber_printf(ber, \"}\"); /* two more } to come */"
    },
    {
        "line": 230,
        "fullcodeline": "rc = check_and_send_extended_result(pb, tag, ber);"
    },
    {
        "line": 239,
        "fullcodeline": "rc = check_and_send_SASL_response(pb, tag, ber, conn);"
    },
    {
        "line": 243,
        "fullcodeline": "rc = ber_printf(ber, \"}\"); /* one more } to come */"
    },
    {
        "line": 50,
        "fullcodeline": "} else if (err != LDAP_REFERRAL && err != LDAP_OPT_REFERRALS && err != LDAP_PARTIAL_RESULTS) {"
    },
    {
        "line": 111,
        "fullcodeline": "err = LDAP_CONSTRAINT_VIOLATION;"
    },
    {
        "line": 112,
        "fullcodeline": "text = \"Invalid credentials, you now have exceeded the password retry limit.\";"
    },
    {
        "line": 148,
        "fullcodeline": "len += urls[i]->bv_len + 1; /* newline + ref */"
    },
    {
        "line": 151,
        "fullcodeline": "len += strlen(text) + 1; /* text + newline */"
    },
    {
        "line": 160,
        "fullcodeline": "strcpy(buf, text);"
    },
    {
        "line": 161,
        "fullcodeline": "strcat(buf, \"\\n\");"
    },
    {
        "line": 165,
        "fullcodeline": "strcat(buf, \"\\n\");"
    },
    {
        "line": 166,
        "fullcodeline": "strcat(buf, urls[i]->bv_val);"
    }
]