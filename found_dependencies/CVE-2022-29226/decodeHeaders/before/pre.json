[
    {
        "line": 5,
        "fullcodeline": "const Http::HeaderEntry* host_header = headers.Host();"
    },
    {
        "line": 6,
        "fullcodeline": "ASSERT(host_header != nullptr);"
    },
    {
        "line": 7,
        "fullcodeline": "host_ = host_header->value().getStringView();"
    },
    {
        "line": 9,
        "fullcodeline": "const Http::HeaderEntry* path_header = headers.Path();"
    },
    {
        "line": 10,
        "fullcodeline": "ASSERT(path_header != nullptr);"
    },
    {
        "line": 11,
        "fullcodeline": "const absl::string_view path_str = path_header->value().getStringView();"
    },
    {
        "line": 59,
        "fullcodeline": "access_token_ = extractAccessToken(headers);"
    },
    {
        "line": 111,
        "fullcodeline": "const auto query_parameters = Http::Utility::parseQueryString(path_str);"
    },
    {
        "line": 124,
        "fullcodeline": "auth_code_ = query_parameters.at(queryParamsCode());"
    },
    {
        "line": 125,
        "fullcodeline": "state_ = Http::Utility::PercentEncoding::decode(query_parameters.at(queryParamsState()));"
    },
    {
        "line": 134,
        "fullcodeline": "const auto redirect_uri = formatter.format(headers, *Http::ResponseHeaderMapImpl::create(),"
    },
    {
        "line": 137,
        "fullcodeline": "oauth_client_->asyncGetAccessToken(auth_code_, config_->clientId(), config_->clientSecret(),"
    },
    {
        "line": 14,
        "fullcodeline": "if (config_->signoutPath().match(path_header->value().getStringView())) {"
    },
    {
        "line": 18,
        "fullcodeline": "if (canSkipOAuth(headers)) {"
    },
    {
        "line": 52,
        "fullcodeline": "if (config_->forwardBearerToken()) {"
    },
    {
        "line": 133,
        "fullcodeline": "Formatter::FormatterImpl formatter(config_->redirectUri());"
    },
    {
        "line": 53,
        "fullcodeline": "request_headers_ = &headers;"
    },
    {
        "line": 60,
        "fullcodeline": "if (!access_token_.empty()) {"
    },
    {
        "line": 61,
        "fullcodeline": "found_bearer_token_ = true;"
    },
    {
        "line": 70,
        "fullcodeline": "if (!config_->redirectPathMatcher().match(path_str)) {"
    },
    {
        "line": 71,
        "fullcodeline": "Http::ResponseHeaderMapPtr response_headers{Http::createHeaderMap<Http::ResponseHeaderMapImpl>("
    },
    {
        "line": 77,
        "fullcodeline": "auto scheme = Http::Headers::get().SchemeValues.Https;"
    },
    {
        "line": 79,
        "fullcodeline": "const auto* scheme_header = headers.Scheme();"
    },
    {
        "line": 85,
        "fullcodeline": "const std::string base_path = absl::StrCat(scheme, \"://\", host_);"
    },
    {
        "line": 86,
        "fullcodeline": "const std::string state_path = absl::StrCat(base_path, headers.Path()->value().getStringView());"
    },
    {
        "line": 87,
        "fullcodeline": "const std::string escaped_state = Http::Utility::PercentEncoding::encode(state_path, \":/=&?\");"
    },
    {
        "line": 90,
        "fullcodeline": "const auto redirect_uri = formatter.format(headers, *Http::ResponseHeaderMapImpl::create(),"
    },
    {
        "line": 93,
        "fullcodeline": "const std::string escaped_redirect_uri ="
    },
    {
        "line": 96,
        "fullcodeline": "const std::string new_url = fmt::format("
    },
    {
        "line": 100,
        "fullcodeline": "response_headers->setLocation(new_url + config_->encodedResourceQueryParams());"
    },
    {
        "line": 101,
        "fullcodeline": "decoder_callbacks_->encodeHeaders(std::move(response_headers), true, REDIRECT_FOR_CREDENTIALS);"
    },
    {
        "line": 112,
        "fullcodeline": "if (query_parameters.find(queryParamsError()) != query_parameters.end()) {"
    },
    {
        "line": 118,
        "fullcodeline": "if (query_parameters.find(queryParamsCode()) == query_parameters.end() ||"
    },
    {
        "line": 119,
        "fullcodeline": "query_parameters.find(queryParamsState()) == query_parameters.end()) {"
    },
    {
        "line": 128,
        "fullcodeline": "if (!state_url.initialize(state_, false)) {"
    },
    {
        "line": 136,
        "fullcodeline": "decoder_callbacks_->streamInfo(), \"\");"
    },
    {
        "line": 15,
        "fullcodeline": "return signOutUser(headers);"
    },
    {
        "line": 25,
        "fullcodeline": "if (config_->redirectPathMatcher().match(path_str)) {"
    },
    {
        "line": 89,
        "fullcodeline": "Formatter::FormatterImpl formatter(config_->redirectUri());"
    },
    {
        "line": 94,
        "fullcodeline": "Http::Utility::PercentEncoding::encode(redirect_uri, \":/=&?\");"
    },
    {
        "line": 26,
        "fullcodeline": "Http::Utility::QueryParams query_parameters = Http::Utility::parseQueryString(path_str);"
    },
    {
        "line": 28,
        "fullcodeline": "const auto state ="
    },
    {
        "line": 40,
        "fullcodeline": "Http::ResponseHeaderMapPtr response_headers{"
    },
    {
        "line": 44,
        "fullcodeline": "decoder_callbacks_->encodeHeaders(std::move(response_headers), true, REDIRECT_RACE);"
    },
    {
        "line": 80,
        "fullcodeline": "if ((scheme_header != nullptr &&"
    },
    {
        "line": 81,
        "fullcodeline": "scheme_header->value().getStringView() == Http::Headers::get().SchemeValues.Http)) {"
    },
    {
        "line": 82,
        "fullcodeline": "scheme = Http::Headers::get().SchemeValues.Http;"
    },
    {
        "line": 92,
        "fullcodeline": "decoder_callbacks_->streamInfo(), \"\");"
    },
    {
        "line": 97,
        "fullcodeline": "AuthorizationEndpointFormat, config_->authorizationEndpoint(), config_->clientId(),"
    },
    {
        "line": 98,
        "fullcodeline": "config_->encodedAuthScopes(), escaped_redirect_uri, escaped_state);"
    },
    {
        "line": 29,
        "fullcodeline": "Http::Utility::PercentEncoding::decode(query_parameters.at(queryParamsState()));"
    },
    {
        "line": 31,
        "fullcodeline": "if (!state_url.initialize(state, false)) {"
    },
    {
        "line": 36,
        "fullcodeline": "if (config_->redirectPathMatcher().match(state_url.pathAndQueryParams())) {"
    },
    {
        "line": 41,
        "fullcodeline": "Http::createHeaderMap<Http::ResponseHeaderMapImpl>("
    },
    {
        "line": 72,
        "fullcodeline": "{{Http::Headers::get().Status, std::to_string(enumToInt(Http::Code::Found))}})};"
    },
    {
        "line": 42,
        "fullcodeline": "{{Http::Headers::get().Status, std::to_string(enumToInt(Http::Code::Found))},"
    }
]