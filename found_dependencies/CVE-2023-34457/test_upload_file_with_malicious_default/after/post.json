[
    {
        "line": 6,
        "fullcodeline": "browser = mechanicalsoup.StatefulBrowser()"
    },
    {
        "line": 10,
        "fullcodeline": "url = httpbin + \"/post\""
    },
    {
        "line": 11,
        "fullcodeline": "malicious_html = f\"\"\""
    },
    {
        "line": 16,
        "fullcodeline": "browser.open_fake_page(malicious_html)"
    },
    {
        "line": 17,
        "fullcodeline": "browser.select_form()"
    },
    {
        "line": 18,
        "fullcodeline": "response = browser.submit_selected()"
    },
    {
        "line": 19,
        "fullcodeline": "assert response.json()[\"files\"] == {\"malicious\": \"\"}"
    },
    {
        "line": 8,
        "fullcodeline": "with open(sensitive_path, \"w\") as fd:"
    },
    {
        "line": 7,
        "fullcodeline": "sensitive_path = tempfile.mkstemp()[1]"
    },
    {
        "line": 12,
        "fullcodeline": "<form method=\"post\" action=\"{url}\" enctype=\"multipart/form-data\">"
    },
    {
        "line": 13,
        "fullcodeline": "<input type=\"file\" name=\"malicious\" value=\"{sensitive_path}\" />"
    },
    {
        "line": 9,
        "fullcodeline": "fd.write(\"Some sensitive information\")"
    }
]