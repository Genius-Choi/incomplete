[
    {
        "line": 3,
        "fullcodeline": "X509* x = CHECK_OBJECT(1, X509, \"openssl.x509\");"
    },
    {
        "line": 4,
        "fullcodeline": "if (lua_isnone(L, 2))"
    },
    {
        "line": 6,
        "fullcodeline": "unsigned char *out = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "int len = i2d_re_X509_tbs(x, &out);"
    },
    {
        "line": 8,
        "fullcodeline": "if (len > 0)"
    },
    {
        "line": 33,
        "fullcodeline": "return openssl_pushresult(L, len);"
    },
    {
        "line": 37,
        "fullcodeline": "EVP_PKEY *pkey = CHECK_OBJECT(2, EVP_PKEY, \"openssl.evp_pkey\");"
    },
    {
        "line": 38,
        "fullcodeline": "int ret = X509_verify(x, pkey);"
    },
    {
        "line": 10,
        "fullcodeline": "CONSTIFY_X509_get0 ASN1_BIT_STRING *psig = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "CONSTIFY_X509_get0 X509_ALGOR *palg = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "lua_pushlstring(L, (const char *)out, len);"
    },
    {
        "line": 14,
        "fullcodeline": "OPENSSL_free(out);"
    },
    {
        "line": 16,
        "fullcodeline": "X509_get0_signature(&psig, &palg, x);"
    },
    {
        "line": 39,
        "fullcodeline": "return openssl_pushresult(L, ret);"
    },
    {
        "line": 17,
        "fullcodeline": "if (psig != NULL)"
    },
    {
        "line": 19,
        "fullcodeline": "lua_pushlstring(L, (const char *)psig->data, psig->length);"
    },
    {
        "line": 26,
        "fullcodeline": "X509_ALGOR *alg = X509_ALGOR_dup((X509_ALGOR *)palg);"
    },
    {
        "line": 27,
        "fullcodeline": "PUSH_OBJECT(alg, \"openssl.x509_algor\");"
    },
    {
        "line": 22,
        "fullcodeline": "lua_pushnil(L);"
    },
    {
        "line": 30,
        "fullcodeline": "lua_pushnil(L);"
    }
]