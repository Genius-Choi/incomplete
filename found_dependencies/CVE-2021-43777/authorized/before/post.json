[
    {
        "line": 2,
        "fullcodeline": "resp = google_remote_app().authorized_response()"
    },
    {
        "line": 3,
        "fullcodeline": "access_token = resp[\"access_token\"]"
    },
    {
        "line": 10,
        "fullcodeline": "profile = get_user_profile(access_token)"
    },
    {
        "line": 29,
        "fullcodeline": "picture_url = \"%s?sz=40\" % profile[\"picture\"]"
    },
    {
        "line": 30,
        "fullcodeline": "user = create_and_login_user(org, profile[\"name\"], profile[\"email\"], picture_url)"
    },
    {
        "line": 34,
        "fullcodeline": "unsafe_next_path = request.args.get(\"state\") or url_for("
    },
    {
        "line": 37,
        "fullcodeline": "next_path = get_next_path(unsafe_next_path)"
    },
    {
        "line": 5,
        "fullcodeline": "if access_token is None:"
    },
    {
        "line": 11,
        "fullcodeline": "if profile is None:"
    },
    {
        "line": 15,
        "fullcodeline": "if \"org_slug\" in session:"
    },
    {
        "line": 20,
        "fullcodeline": "if not verify_profile(org, profile):"
    },
    {
        "line": 31,
        "fullcodeline": "if user is None:"
    },
    {
        "line": 39,
        "fullcodeline": "return redirect(next_path)"
    },
    {
        "line": 6,
        "fullcodeline": "logger.warning(\"Access token missing in call back request.\")"
    },
    {
        "line": 7,
        "fullcodeline": "flash(\"Validation error. Please retry.\")"
    },
    {
        "line": 12,
        "fullcodeline": "flash(\"Validation error. Please retry.\")"
    },
    {
        "line": 16,
        "fullcodeline": "org = models.Organization.get_by_slug(session.pop(\"org_slug\"))"
    },
    {
        "line": 18,
        "fullcodeline": "org = current_org"
    },
    {
        "line": 21,
        "fullcodeline": "logger.warning("
    },
    {
        "line": 26,
        "fullcodeline": "flash(\"Your Google Apps account ({}) isn't allowed.\".format(profile[\"email\"]))"
    },
    {
        "line": 8,
        "fullcodeline": "return redirect(url_for(\"redash.login\"))"
    },
    {
        "line": 13,
        "fullcodeline": "return redirect(url_for(\"redash.login\"))"
    },
    {
        "line": 27,
        "fullcodeline": "return redirect(url_for(\"redash.login\", org_slug=org.slug))"
    },
    {
        "line": 32,
        "fullcodeline": "return logout_and_redirect_to_index()"
    }
]