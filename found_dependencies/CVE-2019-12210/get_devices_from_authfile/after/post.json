[
    {
        "line": 5,
        "fullcodeline": "char *buf = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "int retval = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "int fd = -1;"
    },
    {
        "line": 10,
        "fullcodeline": "struct passwd *pw = NULL, pw_s;"
    },
    {
        "line": 11,
        "fullcodeline": "char buffer[BUFSIZE];"
    },
    {
        "line": 13,
        "fullcodeline": "FILE *opwfile = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "*n_devs = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "fd = open(authfile, O_RDONLY | O_CLOEXEC | O_NOCTTY);"
    },
    {
        "line": 44,
        "fullcodeline": "gpu_ret = getpwuid_r(st.st_uid, &pw_s, buffer, sizeof(buffer), &pw);"
    },
    {
        "line": 61,
        "fullcodeline": "opwfile = fdopen(fd, \"r\");"
    },
    {
        "line": 70,
        "fullcodeline": "buf = malloc(sizeof(char) * (DEVSIZE * max_devs));"
    },
    {
        "line": 77,
        "fullcodeline": "retval = -2;"
    },
    {
        "line": 175,
        "fullcodeline": "retval = 1;"
    },
    {
        "line": 186,
        "fullcodeline": "*n_devs = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "if (fd < 0) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (fstat(fd, &st) < 0) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (!S_ISREG(st.st_mode)) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (st.st_size == 0) {"
    },
    {
        "line": 45,
        "fullcodeline": "if (gpu_ret != 0 || pw == NULL) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (strcmp(pw->pw_name, username) != 0 && strcmp(pw->pw_name, \"root\") != 0) {"
    },
    {
        "line": 62,
        "fullcodeline": "if (opwfile == NULL) {"
    },
    {
        "line": 71,
        "fullcodeline": "if (!buf) {"
    },
    {
        "line": 78,
        "fullcodeline": "while (fgets(buf, (int)(DEVSIZE * (max_devs - 1)), opwfile)) {"
    },
    {
        "line": 179,
        "fullcodeline": "for (i = 0; i < *n_devs; i++) {"
    },
    {
        "line": 197,
        "fullcodeline": "if (fd != -1)"
    },
    {
        "line": 46,
        "fullcodeline": "D(debug_file, \"Unable to retrieve credentials for uid %u, (%s)\", st.st_uid,"
    },
    {
        "line": 79,
        "fullcodeline": "char *saveptr = NULL;"
    },
    {
        "line": 86,
        "fullcodeline": "s_user = strtok_r(buf, \":\", &saveptr);"
    },
    {
        "line": 173,
        "fullcodeline": "D(debug_file, \"Found %d device(s) for user %s\", *n_devs, username);"
    },
    {
        "line": 181,
        "fullcodeline": "free(devices[i].publicKey);"
    },
    {
        "line": 182,
        "fullcodeline": "devices[i].keyHandle = NULL;"
    },
    {
        "line": 183,
        "fullcodeline": "devices[i].publicKey = NULL;"
    },
    {
        "line": 190,
        "fullcodeline": "free(buf);"
    },
    {
        "line": 191,
        "fullcodeline": "buf = NULL;"
    },
    {
        "line": 195,
        "fullcodeline": "fclose(opwfile);"
    },
    {
        "line": 198,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 47,
        "fullcodeline": "strerror(errno));"
    },
    {
        "line": 52,
        "fullcodeline": "if (strcmp(username, \"root\") != 0) {"
    },
    {
        "line": 67,
        "fullcodeline": "fd = -1; /* fd belongs to opwfile */"
    },
    {
        "line": 80,
        "fullcodeline": "if (buf[strlen(buf) - 1] == '\\n')"
    },
    {
        "line": 87,
        "fullcodeline": "if (s_user && strcmp(username, s_user) == 0) {"
    },
    {
        "line": 22,
        "fullcodeline": "D(debug_file, \"Cannot open file: %s (%s)\", authfile, strerror(errno));"
    },
    {
        "line": 28,
        "fullcodeline": "D(debug_file, \"Cannot stat file: %s (%s)\", authfile, strerror(errno));"
    },
    {
        "line": 34,
        "fullcodeline": "D(debug_file, \"%s is not a regular file\", authfile);"
    },
    {
        "line": 40,
        "fullcodeline": "D(debug_file, \"File %s is empty\", authfile);"
    },
    {
        "line": 53,
        "fullcodeline": "D(debug_file, \"The owner of the authentication file is neither %s nor root\","
    },
    {
        "line": 64,
        "fullcodeline": "D(debug_file, \"fdopen: %s\", strerror(errno));"
    },
    {
        "line": 73,
        "fullcodeline": "D(debug_file, \"Unable to allocate memory\");"
    },
    {
        "line": 81,
        "fullcodeline": "buf[strlen(buf) - 1] = '\\0';"
    },
    {
        "line": 84,
        "fullcodeline": "D(debug_file, \"Authorization line: %s\", buf);"
    },
    {
        "line": 91,
        "fullcodeline": "retval = -1; // We found at least one line for the user"
    },
    {
        "line": 100,
        "fullcodeline": "*n_devs = 0;"
    },
    {
        "line": 102,
        "fullcodeline": "i = 0;"
    },
    {
        "line": 56,
        "fullcodeline": "D(debug_file, \"The owner of the authentication file is not root\");"
    },
    {
        "line": 94,
        "fullcodeline": "for (i = 0; i < *n_devs; i++) {"
    },
    {
        "line": 103,
        "fullcodeline": "while ((s_token = strtok_r(NULL, \",\", &saveptr))) {"
    },
    {
        "line": 89,
        "fullcodeline": "D(debug_file, \"Matched user: %s\", s_user);"
    },
    {
        "line": 96,
        "fullcodeline": "free(devices[i].publicKey);"
    },
    {
        "line": 97,
        "fullcodeline": "devices[i].keyHandle = NULL;"
    },
    {
        "line": 98,
        "fullcodeline": "devices[i].publicKey = NULL;"
    },
    {
        "line": 104,
        "fullcodeline": "devices[i].keyHandle = NULL;"
    },
    {
        "line": 105,
        "fullcodeline": "devices[i].publicKey = NULL;"
    },
    {
        "line": 118,
        "fullcodeline": "devices[i].keyHandle = strdup(s_token);"
    },
    {
        "line": 126,
        "fullcodeline": "s_token = strtok_r(NULL, \":\", &saveptr);"
    },
    {
        "line": 143,
        "fullcodeline": "devices[i].key_len = strlen(s_token) / 2;"
    },
    {
        "line": 148,
        "fullcodeline": "devices[i].publicKey ="
    },
    {
        "line": 167,
        "fullcodeline": "i++;"
    },
    {
        "line": 107,
        "fullcodeline": "if ((*n_devs)++ > MAX_DEVS - 1) {"
    },
    {
        "line": 120,
        "fullcodeline": "if (!devices[i].keyHandle) {"
    },
    {
        "line": 128,
        "fullcodeline": "if (!s_token) {"
    },
    {
        "line": 137,
        "fullcodeline": "if (strlen(s_token) % 2 != 0) {"
    },
    {
        "line": 149,
        "fullcodeline": "malloc((sizeof(unsigned char) * devices[i].key_len));"
    },
    {
        "line": 151,
        "fullcodeline": "if (!devices[i].publicKey) {"
    },
    {
        "line": 157,
        "fullcodeline": "for (j = 0; j < devices[i].key_len; j++) {"
    },
    {
        "line": 108,
        "fullcodeline": "*n_devs = MAX_DEVS;"
    },
    {
        "line": 116,
        "fullcodeline": "D(debug_file, \"KeyHandle for device number %d: %s\", i + 1, s_token);"
    },
    {
        "line": 135,
        "fullcodeline": "D(debug_file, \"publicKey for device number %d: %s\", i + 1, s_token);"
    },
    {
        "line": 146,
        "fullcodeline": "D(debug_file, \"Length of key number %d is %zu\", i + 1, devices[i].key_len);"
    },
    {
        "line": 164,
        "fullcodeline": "devices[i].publicKey[j] = (unsigned char)x;"
    },
    {
        "line": 159,
        "fullcodeline": "if (sscanf(&s_token[2 * j], \"%2x\", &x) != 1) {"
    },
    {
        "line": 110,
        "fullcodeline": "D(debug_file, \"Found more than %d devices, ignoring the remaining ones\","
    },
    {
        "line": 122,
        "fullcodeline": "D(debug_file, \"Unable to allocate memory for keyHandle number %d\", i);"
    },
    {
        "line": 130,
        "fullcodeline": "D(debug_file, \"Unable to retrieve publicKey number %d\", i + 1);"
    },
    {
        "line": 139,
        "fullcodeline": "D(debug_file, \"Length of key number %d not even\", i + 1);"
    },
    {
        "line": 153,
        "fullcodeline": "D(debug_file, \"Unable to allocate memory for publicKey number %d\", i);"
    },
    {
        "line": 161,
        "fullcodeline": "D(debug_file, \"Invalid hex number in key\");"
    }
]