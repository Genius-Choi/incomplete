[
    {
        "line": 3,
        "fullcodeline": "SSLDirConfigRec *dc         = myDirConfig(r);"
    },
    {
        "line": 4,
        "fullcodeline": "SSLSrvConfigRec *sc         = mySrvConfig(r->server);"
    },
    {
        "line": 5,
        "fullcodeline": "SSLConnRec *sslconn         = myConnConfig(r->connection);"
    },
    {
        "line": 6,
        "fullcodeline": "SSL *ssl                    = sslconn ? sslconn->ssl : NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "server_rec *handshakeserver = sslconn ? sslconn->server : NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "SSLSrvConfigRec *hssc       = handshakeserver? mySrvConfig(handshakeserver) : NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "SSL_CTX *ctx = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "BOOL renegotiate = FALSE, renegotiate_quick = FALSE;"
    },
    {
        "line": 16,
        "fullcodeline": "X509_STORE *cert_store = NULL;"
    },
    {
        "line": 18,
        "fullcodeline": "STACK_OF(SSL_CIPHER) *cipher_list_old = NULL, *cipher_list = NULL;"
    },
    {
        "line": 19,
        "fullcodeline": "const SSL_CIPHER *cipher = NULL;"
    },
    {
        "line": 20,
        "fullcodeline": "int depth, verify_old, verify, n, is_slave = 0;"
    },
    {
        "line": 135,
        "fullcodeline": "ncipher_suite = (dc->szCipherSuite?"
    },
    {
        "line": 689,
        "fullcodeline": "requires = dc->aRequirement;"
    },
    {
        "line": 690,
        "fullcodeline": "ssl_requires = (ssl_require_t *)requires->elts;"
    },
    {
        "line": 25,
        "fullcodeline": "if (!(sslconn && ssl) && r->connection->master) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (dc->bSSLRequired && !ssl) {"
    },
    {
        "line": 76,
        "fullcodeline": "if (sc->enabled == SSL_ENABLED_FALSE || !ssl) {"
    },
    {
        "line": 139,
        "fullcodeline": "if (ncipher_suite && (!sslconn->cipher_suite"
    },
    {
        "line": 267,
        "fullcodeline": "if ((dc->nVerifyClient != SSL_CVERIFY_UNSET) ||"
    },
    {
        "line": 411,
        "fullcodeline": "if (renegotiate && !renegotiate_quick"
    },
    {
        "line": 676,
        "fullcodeline": "if ((dc->nOptions & SSL_OPT_FAKEBASICAUTH) == 0 && dc->szUserName) {"
    },
    {
        "line": 692,
        "fullcodeline": "for (i = 0; i < requires->nelts; i++) {"
    },
    {
        "line": 26,
        "fullcodeline": "sslconn         = myConnConfig(r->connection->master);"
    },
    {
        "line": 27,
        "fullcodeline": "ssl             = sslconn ? sslconn->ssl : NULL;"
    },
    {
        "line": 28,
        "fullcodeline": "handshakeserver = sslconn ? sslconn->server : NULL;"
    },
    {
        "line": 29,
        "fullcodeline": "hssc            = handshakeserver? mySrvConfig(handshakeserver) : NULL;"
    },
    {
        "line": 30,
        "fullcodeline": "is_slave        = 1;"
    },
    {
        "line": 44,
        "fullcodeline": "ctx = SSL_get_SSL_CTX(ssl);"
    },
    {
        "line": 66,
        "fullcodeline": "apr_table_setn(r->notes, \"ssl-access-forbidden\", \"1\");"
    },
    {
        "line": 136,
        "fullcodeline": "dc->szCipherSuite : (r->server != handshakeserver)?"
    },
    {
        "line": 268,
        "fullcodeline": "(sc->server->auth.verify_mode != SSL_CVERIFY_UNSET)) {"
    },
    {
        "line": 271,
        "fullcodeline": "verify_old = SSL_get_verify_mode(ssl);"
    },
    {
        "line": 273,
        "fullcodeline": "verify = SSL_VERIFY_NONE;"
    },
    {
        "line": 291,
        "fullcodeline": "SSL_set_verify(ssl, verify, ssl_callback_SSLVerify);"
    },
    {
        "line": 292,
        "fullcodeline": "SSL_set_verify_result(ssl, X509_V_OK);"
    },
    {
        "line": 415,
        "fullcodeline": "&& !r->expecting_100) {"
    },
    {
        "line": 419,
        "fullcodeline": "rsize = dc->nRenegBufferSize == UNSET ? DEFAULT_RENEG_BUFFER_SIZE :"
    },
    {
        "line": 677,
        "fullcodeline": "char *val = ssl_var_lookup(r->pool, r->server, r->connection,"
    },
    {
        "line": 693,
        "fullcodeline": "ssl_require_t *req = &ssl_requires[i];"
    },
    {
        "line": 695,
        "fullcodeline": "ok = ap_expr_exec(r, req->mpExpr, &errstring);"
    },
    {
        "line": 41,
        "fullcodeline": "if (!SSL_is_init_finished(ssl)) {"
    },
    {
        "line": 51,
        "fullcodeline": "if ((sc->enabled == SSL_ENABLED_OPTIONAL) && !is_slave) {"
    },
    {
        "line": 140,
        "fullcodeline": "|| strcmp(ncipher_suite, sslconn->cipher_suite))) {"
    },
    {
        "line": 143,
        "fullcodeline": "if (dc->nOptions & SSL_OPT_OPTRENEGOTIATE) {"
    },
    {
        "line": 166,
        "fullcodeline": "if (!SSL_set_cipher_list(ssl, ncipher_suite)) {"
    },
    {
        "line": 182,
        "fullcodeline": "if (dc->nOptions & SSL_OPT_OPTRENEGOTIATE) {"
    },
    {
        "line": 275,
        "fullcodeline": "if ((dc->nVerifyClient == SSL_CVERIFY_REQUIRE) ||"
    },
    {
        "line": 280,
        "fullcodeline": "if ((dc->nVerifyClient == SSL_CVERIFY_OPTIONAL) ||"
    },
    {
        "line": 295,
        "fullcodeline": "if (!renegotiate && verify != verify_old) {"
    },
    {
        "line": 369,
        "fullcodeline": "if ((r->server != handshakeserver)"
    },
    {
        "line": 412,
        "fullcodeline": "&& (apr_table_get(r->headers_in, \"transfer-encoding\")"
    },
    {
        "line": 421,
        "fullcodeline": "if (rsize > 0) {"
    },
    {
        "line": 612,
        "fullcodeline": "if ((cert = SSL_get_peer_certificate(ssl))) {"
    },
    {
        "line": 623,
        "fullcodeline": "if ((dc->nVerifyClient != SSL_CVERIFY_NONE) ||"
    },
    {
        "line": 697,
        "fullcodeline": "if (ok < 0) {"
    },
    {
        "line": 709,
        "fullcodeline": "if (ok != 1) {"
    },
    {
        "line": 55,
        "fullcodeline": "apr_table_setn(r->err_headers_out, \"Upgrade\", \"TLS/1.0, HTTP/1.1\");"
    },
    {
        "line": 56,
        "fullcodeline": "apr_table_setn(r->err_headers_out, \"Connection\", \"Upgrade\");"
    },
    {
        "line": 144,
        "fullcodeline": "cipher = SSL_get_current_cipher(ssl);"
    },
    {
        "line": 162,
        "fullcodeline": "apr_table_setn(r->notes, \"ssl-renegotiate-forbidden\", \"cipher-suite\");"
    },
    {
        "line": 170,
        "fullcodeline": "ssl_log_ssl_error(SSLLOG_MARK, APLOG_ERR, r->server);"
    },
    {
        "line": 229,
        "fullcodeline": "sk_SSL_CIPHER_free(cipher_list_old);"
    },
    {
        "line": 276,
        "fullcodeline": "(sc->server->auth.verify_mode == SSL_CVERIFY_REQUIRE)) {"
    },
    {
        "line": 277,
        "fullcodeline": "verify |= SSL_VERIFY_PEER_STRICT;"
    },
    {
        "line": 283,
        "fullcodeline": "(sc->server->auth.verify_mode == SSL_CVERIFY_OPTIONAL_NO_CA))"
    },
    {
        "line": 285,
        "fullcodeline": "verify |= SSL_VERIFY_PEER;"
    },
    {
        "line": 371,
        "fullcodeline": "&& ((verify & SSL_VERIFY_PEER) ||"
    },
    {
        "line": 413,
        "fullcodeline": "|| (apr_table_get(r->headers_in, \"content-length\")"
    },
    {
        "line": 423,
        "fullcodeline": "rv = ssl_io_buffer_fill(r, rsize);"
    },
    {
        "line": 457,
        "fullcodeline": "STACK_OF(X509) *cert_stack;"
    },
    {
        "line": 466,
        "fullcodeline": "cert = SSL_get_peer_certificate(ssl);"
    },
    {
        "line": 498,
        "fullcodeline": "cert_store_ctx = X509_STORE_CTX_new();"
    },
    {
        "line": 499,
        "fullcodeline": "X509_STORE_CTX_init(cert_store_ctx, cert_store, cert, cert_stack);"
    },
    {
        "line": 500,
        "fullcodeline": "depth = SSL_get_verify_depth(ssl);"
    },
    {
        "line": 506,
        "fullcodeline": "X509_STORE_CTX_set_ex_data(cert_store_ctx,"
    },
    {
        "line": 516,
        "fullcodeline": "SSL_set_verify_result(ssl, X509_STORE_CTX_get_error(cert_store_ctx));"
    },
    {
        "line": 517,
        "fullcodeline": "X509_STORE_CTX_cleanup(cert_store_ctx);"
    },
    {
        "line": 518,
        "fullcodeline": "X509_STORE_CTX_free(cert_store_ctx);"
    },
    {
        "line": 616,
        "fullcodeline": "sslconn->client_cert = cert;"
    },
    {
        "line": 617,
        "fullcodeline": "sslconn->client_dn = NULL;"
    },
    {
        "line": 624,
        "fullcodeline": "(sc->server->auth.verify_mode != SSL_CVERIFY_NONE)) {"
    },
    {
        "line": 625,
        "fullcodeline": "BOOL do_verify = ((dc->nVerifyClient == SSL_CVERIFY_REQUIRE) ||"
    },
    {
        "line": 653,
        "fullcodeline": "cipher = SSL_get_current_cipher(ssl);"
    },
    {
        "line": 665,
        "fullcodeline": "sslconn->cipher_suite = ncipher_suite;"
    },
    {
        "line": 678,
        "fullcodeline": "r, (char *)dc->szUserName);"
    },
    {
        "line": 704,
        "fullcodeline": "apr_table_setn(r->notes, \"ssl-access-forbidden\", \"1\");"
    },
    {
        "line": 724,
        "fullcodeline": "apr_table_setn(r->notes, \"ssl-access-forbidden\", \"1\");"
    },
    {
        "line": 184,
        "fullcodeline": "if ((!cipher && cipher_list) ||"
    },
    {
        "line": 282,
        "fullcodeline": "(sc->server->auth.verify_mode == SSL_CVERIFY_OPTIONAL) ||"
    },
    {
        "line": 296,
        "fullcodeline": "if (((verify_old == SSL_VERIFY_NONE) &&"
    },
    {
        "line": 372,
        "fullcodeline": "(verify & SSL_VERIFY_FAIL_IF_NO_PEER_CERT))) {"
    },
    {
        "line": 378,
        "fullcodeline": "if (MODSSL_CFG_CA_NE(ca_cert_file, sc, hssc) ||"
    },
    {
        "line": 414,
        "fullcodeline": "&& strcmp(apr_table_get(r->headers_in, \"content-length\"), \"0\")))"
    },
    {
        "line": 427,
        "fullcodeline": "rv = HTTP_REQUEST_ENTITY_TOO_LARGE;"
    },
    {
        "line": 468,
        "fullcodeline": "if (!cert_stack && cert) {"
    },
    {
        "line": 478,
        "fullcodeline": "if (!cert_stack || (sk_X509_num(cert_stack) == 0)) {"
    },
    {
        "line": 485,
        "fullcodeline": "if (!(cert_store ||"
    },
    {
        "line": 494,
        "fullcodeline": "if (!cert) {"
    },
    {
        "line": 502,
        "fullcodeline": "if (depth >= 0) {"
    },
    {
        "line": 508,
        "fullcodeline": "(char *)ssl);"
    },
    {
        "line": 510,
        "fullcodeline": "if (!X509_verify_cert(cert_store_ctx)) {"
    },
    {
        "line": 520,
        "fullcodeline": "if (cert_stack != SSL_get_peer_cert_chain(ssl)) {"
    },
    {
        "line": 526,
        "fullcodeline": "char peekbuf[1];"
    },
    {
        "line": 528,
        "fullcodeline": "request_rec *id = r->main ? r->main : r;"
    },
    {
        "line": 551,
        "fullcodeline": "reneg_support = \"server does not\";"
    },
    {
        "line": 559,
        "fullcodeline": "SSL_set_session_id_context(ssl,"
    },
    {
        "line": 565,
        "fullcodeline": "sslconn->reneg_state = RENEG_ALLOW;"
    },
    {
        "line": 567,
        "fullcodeline": "SSL_renegotiate(ssl);"
    },
    {
        "line": 568,
        "fullcodeline": "SSL_do_handshake(ssl);"
    },
    {
        "line": 590,
        "fullcodeline": "SSL_peek(ssl, peekbuf, 0);"
    },
    {
        "line": 592,
        "fullcodeline": "sslconn->reneg_state = RENEG_REJECT;"
    },
    {
        "line": 606,
        "fullcodeline": "sslconn->server = r->server;"
    },
    {
        "line": 628,
        "fullcodeline": "if (do_verify && (SSL_get_verify_result(ssl) != X509_V_OK)) {"
    },
    {
        "line": 654,
        "fullcodeline": "if (sk_SSL_CIPHER_find(cipher_list, cipher) < 0) {"
    },
    {
        "line": 173,
        "fullcodeline": "sk_SSL_CIPHER_free(cipher_list_old);"
    },
    {
        "line": 185,
        "fullcodeline": "(cipher && !cipher_list))"
    },
    {
        "line": 187,
        "fullcodeline": "renegotiate = TRUE;"
    },
    {
        "line": 197,
        "fullcodeline": "if ((!cipher_list_old && cipher_list) ||"
    },
    {
        "line": 238,
        "fullcodeline": "apr_table_setn(r->notes, \"ssl-renegotiate-forbidden\", \"cipher-suite\");"
    },
    {
        "line": 281,
        "fullcodeline": "(dc->nVerifyClient == SSL_CVERIFY_OPTIONAL_NO_CA) ||"
    },
    {
        "line": 302,
        "fullcodeline": "(!(verify_old & SSL_VERIFY_FAIL_IF_NO_PEER_CERT) &&"
    },
    {
        "line": 305,
        "fullcodeline": "renegotiate = TRUE;"
    },
    {
        "line": 379,
        "fullcodeline": "MODSSL_CFG_CA_NE(ca_cert_path, sc, hssc)) {"
    },
    {
        "line": 474,
        "fullcodeline": "cert_stack = sk_X509_new_null();"
    },
    {
        "line": 475,
        "fullcodeline": "sk_X509_push(cert_stack, cert);"
    },
    {
        "line": 495,
        "fullcodeline": "cert = sk_X509_value(cert_stack, 0);"
    },
    {
        "line": 503,
        "fullcodeline": "X509_STORE_CTX_set_depth(cert_store_ctx, depth);"
    },
    {
        "line": 513,
        "fullcodeline": "ssl_log_ssl_error(SSLLOG_MARK, APLOG_ERR, r->server);"
    },
    {
        "line": 522,
        "fullcodeline": "sk_X509_pop_free(cert_stack, X509_free);"
    },
    {
        "line": 539,
        "fullcodeline": "if (has_buffered_data(r)) {"
    },
    {
        "line": 560,
        "fullcodeline": "(unsigned char *)&id,"
    },
    {
        "line": 570,
        "fullcodeline": "if (!SSL_is_init_finished(ssl)) {"
    },
    {
        "line": 594,
        "fullcodeline": "if (!SSL_is_init_finished(ssl)) {"
    },
    {
        "line": 614,
        "fullcodeline": "X509_free(sslconn->client_cert);"
    },
    {
        "line": 626,
        "fullcodeline": "(sc->server->auth.verify_mode == SSL_CVERIFY_REQUIRE));"
    },
    {
        "line": 645,
        "fullcodeline": "X509_free(peercert);"
    },
    {
        "line": 150,
        "fullcodeline": "cipher_list_old = sk_SSL_CIPHER_dup(cipher_list_old);"
    },
    {
        "line": 198,
        "fullcodeline": "(cipher_list_old && !cipher_list))"
    },
    {
        "line": 200,
        "fullcodeline": "renegotiate = TRUE;"
    },
    {
        "line": 299,
        "fullcodeline": "(!(verify_old & SSL_VERIFY_PEER) &&"
    },
    {
        "line": 303,
        "fullcodeline": "(verify     & SSL_VERIFY_FAIL_IF_NO_PEER_CERT)))"
    },
    {
        "line": 316,
        "fullcodeline": "if ((dc->nOptions & SSL_OPT_OPTRENEGOTIATE) &&"
    },
    {
        "line": 380,
        "fullcodeline": "if (verify & SSL_VERIFY_FAIL_IF_NO_PEER_CERT) {"
    },
    {
        "line": 486,
        "fullcodeline": "(cert_store = SSL_CTX_get_cert_store(ctx))))"
    },
    {
        "line": 544,
        "fullcodeline": "r->connection->keepalive = AP_CONN_CLOSE;"
    },
    {
        "line": 573,
        "fullcodeline": "ssl_log_ssl_error(SSLLOG_MARK, APLOG_ERR, r->server);"
    },
    {
        "line": 575,
        "fullcodeline": "r->connection->keepalive = AP_CONN_CLOSE;"
    },
    {
        "line": 597,
        "fullcodeline": "ssl_log_ssl_error(SSLLOG_MARK, APLOG_ERR, r->server);"
    },
    {
        "line": 599,
        "fullcodeline": "r->connection->keepalive = AP_CONN_CLOSE;"
    },
    {
        "line": 637,
        "fullcodeline": "if ((peercert = SSL_get_peer_certificate(ssl)) == NULL) {"
    },
    {
        "line": 189,
        "fullcodeline": "else if (cipher && cipher_list &&"
    },
    {
        "line": 297,
        "fullcodeline": "(verify     != SSL_VERIFY_NONE)) ||"
    },
    {
        "line": 300,
        "fullcodeline": "(verify     & SSL_VERIFY_PEER)) ||"
    },
    {
        "line": 311,
        "fullcodeline": "apr_table_setn(r->notes, \"ssl-renegotiate-forbidden\", \"verify-client\");"
    },
    {
        "line": 318,
        "fullcodeline": "((peercert = SSL_get_peer_certificate(ssl)) != NULL))"
    },
    {
        "line": 320,
        "fullcodeline": "renegotiate_quick = TRUE;"
    },
    {
        "line": 321,
        "fullcodeline": "X509_free(peercert);"
    },
    {
        "line": 329,
        "fullcodeline": "else if (verify != SSL_VERIFY_NONE) {"
    },
    {
        "line": 386,
        "fullcodeline": "SSL_set_verify(ssl, verify_old, NULL);"
    },
    {
        "line": 190,
        "fullcodeline": "(sk_SSL_CIPHER_find(cipher_list, cipher) < 0))"
    },
    {
        "line": 192,
        "fullcodeline": "renegotiate = TRUE;"
    },
    {
        "line": 202,
        "fullcodeline": "else if (cipher_list_old && cipher_list) {"
    },
    {
        "line": 317,
        "fullcodeline": "(verify_old == SSL_VERIFY_NONE) &&"
    },
    {
        "line": 344,
        "fullcodeline": "n = (sslconn->verify_depth != UNSET)"
    },
    {
        "line": 348,
        "fullcodeline": "sslconn->verify_depth = (dc->nVerifyDepth != UNSET)"
    },
    {
        "line": 393,
        "fullcodeline": "sslconn->verify_info = \"GENEROUS\";"
    },
    {
        "line": 351,
        "fullcodeline": "if (sslconn->verify_depth < n) {"
    },
    {
        "line": 204,
        "fullcodeline": "!renegotiate && (n < sk_SSL_CIPHER_num(cipher_list));"
    },
    {
        "line": 205,
        "fullcodeline": "n++)"
    },
    {
        "line": 215,
        "fullcodeline": "!renegotiate && (n < sk_SSL_CIPHER_num(cipher_list_old));"
    },
    {
        "line": 216,
        "fullcodeline": "n++)"
    },
    {
        "line": 352,
        "fullcodeline": "renegotiate = TRUE;"
    },
    {
        "line": 203,
        "fullcodeline": "for (n = 0;"
    },
    {
        "line": 207,
        "fullcodeline": "const SSL_CIPHER *value = sk_SSL_CIPHER_value(cipher_list, n);"
    },
    {
        "line": 214,
        "fullcodeline": "for (n = 0;"
    },
    {
        "line": 218,
        "fullcodeline": "const SSL_CIPHER *value = sk_SSL_CIPHER_value(cipher_list_old, n);"
    },
    {
        "line": 209,
        "fullcodeline": "if (sk_SSL_CIPHER_find(cipher_list_old, value) < 0) {"
    },
    {
        "line": 220,
        "fullcodeline": "if (sk_SSL_CIPHER_find(cipher_list, value) < 0) {"
    },
    {
        "line": 210,
        "fullcodeline": "renegotiate = TRUE;"
    },
    {
        "line": 221,
        "fullcodeline": "renegotiate = TRUE;"
    }
]