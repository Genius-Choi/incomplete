[
    {
        "line": 5,
        "fullcodeline": "*cert_chain_pem = h2o_iovec_init(NULL, 0);"
    },
    {
        "line": 6,
        "fullcodeline": "*raw_pubkey = (ptls_iovec_t){};"
    },
    {
        "line": 10,
        "fullcodeline": "if (ptls_load_pem_objects((*parsed->certificate_file)->data.scalar, \"PUBLIC KEY\", raw_pubkey, 1, &raw_pubkey_count) != 0 ||"
    },
    {
        "line": 54,
        "fullcodeline": "if (client_ca_file != NULL) {"
    },
    {
        "line": 11,
        "fullcodeline": "raw_pubkey_count == 0) {"
    },
    {
        "line": 29,
        "fullcodeline": "char errbuf[NEVERBLEED_ERRBUF_SIZE];"
    },
    {
        "line": 55,
        "fullcodeline": "SSL_CTX_set_verify(ssl_ctx, SSL_VERIFY_PEER | SSL_VERIFY_FAIL_IF_NO_PEER_CERT, NULL);"
    },
    {
        "line": 63,
        "fullcodeline": "X509_VERIFY_PARAM *vpm = X509_STORE_get0_param(SSL_CTX_get_cert_store(ssl_ctx));"
    },
    {
        "line": 64,
        "fullcodeline": "int ret = X509_VERIFY_PARAM_set_flags(vpm, X509_V_FLAG_PARTIAL_CHAIN);"
    },
    {
        "line": 13,
        "fullcodeline": "if (SSL_CTX_use_certificate_chain_file(ssl_ctx, (*parsed->certificate_file)->data.scalar) != 1) {"
    },
    {
        "line": 19,
        "fullcodeline": "if ((*cert_chain_pem = h2o_file_read((*parsed->certificate_file)->data.scalar)).base == NULL) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (neverbleed == NULL) {"
    },
    {
        "line": 65,
        "fullcodeline": "assert(ret == 1);"
    },
    {
        "line": 14,
        "fullcodeline": "h2o_configurator_errprintf(cmd, *parsed->certificate_file, \"failed to load certificate file:%s\\n\","
    },
    {
        "line": 16,
        "fullcodeline": "ERR_print_errors_cb(on_openssl_print_errors, stderr);"
    },
    {
        "line": 31,
        "fullcodeline": "neverbleed_post_fork_cb = on_neverbleed_fork;"
    },
    {
        "line": 32,
        "fullcodeline": "neverbleed = h2o_mem_alloc(sizeof(*neverbleed));"
    },
    {
        "line": 37,
        "fullcodeline": "neverbleed_transaction_cb = async_nb_transaction;"
    },
    {
        "line": 39,
        "fullcodeline": "if (neverbleed_load_private_key_file(neverbleed, ssl_ctx, (*parsed->key_file)->data.scalar, errbuf) != 1) {"
    },
    {
        "line": 56,
        "fullcodeline": "if (SSL_CTX_load_verify_locations(ssl_ctx, (*client_ca_file)->data.scalar, NULL) != 1) {"
    },
    {
        "line": 17,
        "fullcodeline": "return -1;"
    },
    {
        "line": 21,
        "fullcodeline": "(*parsed->certificate_file)->data.scalar, strerror(errno));"
    },
    {
        "line": 22,
        "fullcodeline": "return -1;"
    },
    {
        "line": 42,
        "fullcodeline": "return -1;"
    },
    {
        "line": 45,
        "fullcodeline": "if (SSL_CTX_use_PrivateKey_file(ssl_ctx, (*parsed->key_file)->data.scalar, SSL_FILETYPE_PEM) != 1) {"
    },
    {
        "line": 59,
        "fullcodeline": "return -1;"
    },
    {
        "line": 33,
        "fullcodeline": "if (neverbleed_init(neverbleed, errbuf) != 0) {"
    },
    {
        "line": 34,
        "fullcodeline": "fprintf(stderr, \"%s\\n\", errbuf);"
    },
    {
        "line": 49,
        "fullcodeline": "return -1;"
    }
]