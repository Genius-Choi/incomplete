[
    {
        "line": 15,
        "fullcodeline": "len = strlen(\"/lock/lxc/\") + strlen(n) + strlen(p) + 3;"
    },
    {
        "line": 16,
        "fullcodeline": "rundir = get_rundir();"
    },
    {
        "line": 19,
        "fullcodeline": "len += strlen(rundir);"
    },
    {
        "line": 26,
        "fullcodeline": "ret = snprintf(dest, len, \"%s/lock/lxc/%s\", rundir, p);"
    },
    {
        "line": 32,
        "fullcodeline": "ret = mkdir_p(dest, 0755);"
    },
    {
        "line": 17,
        "fullcodeline": "if (!rundir)"
    },
    {
        "line": 21,
        "fullcodeline": "if ((dest = malloc(len)) == NULL) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (ret < 0 || ret >= len) {"
    },
    {
        "line": 38,
        "fullcodeline": "int l2 = 22 + strlen(n) + strlen(p);"
    },
    {
        "line": 50,
        "fullcodeline": "ret = snprintf(dest, len, \"/tmp/%d/lxc%s\", geteuid(), p);"
    },
    {
        "line": 56,
        "fullcodeline": "ret = mkdir_p(dest, 0755);"
    },
    {
        "line": 62,
        "fullcodeline": "ret = snprintf(dest, len, \"/tmp/%d/lxc%s/.%s\", geteuid(), p, n);"
    },
    {
        "line": 68,
        "fullcodeline": "if (ret < 0 || ret >= len) {"
    },
    {
        "line": 39,
        "fullcodeline": "if (l2 > len) {"
    },
    {
        "line": 51,
        "fullcodeline": "if (ret < 0 || ret >= len) {"
    },
    {
        "line": 64,
        "fullcodeline": "ret = snprintf(dest, len, \"%s/lock/lxc/%s/.%s\", rundir, p, n);"
    },
    {
        "line": 41,
        "fullcodeline": "d = realloc(dest, l2);"
    },
    {
        "line": 47,
        "fullcodeline": "len = l2;"
    },
    {
        "line": 48,
        "fullcodeline": "dest = d;"
    },
    {
        "line": 42,
        "fullcodeline": "if (!d) {"
    }
]