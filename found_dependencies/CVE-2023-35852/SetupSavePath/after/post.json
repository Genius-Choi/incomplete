[
    {
        "line": 4,
        "fullcodeline": "SCLogDebug(\"save %s\", save);"
    },
    {
        "line": 6,
        "fullcodeline": "int allow_absolute = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "(void)ConfGetBool(\"datasets.rules.allow-absolute-filenames\", &allow_absolute);"
    },
    {
        "line": 23,
        "fullcodeline": "const char *dir = ConfigGetDataDirectory();"
    },
    {
        "line": 24,
        "fullcodeline": "BUG_ON(dir == NULL); // should not be able to fail"
    },
    {
        "line": 25,
        "fullcodeline": "char path[PATH_MAX];"
    },
    {
        "line": 31,
        "fullcodeline": "strlcpy(save, path, save_size);"
    },
    {
        "line": 26,
        "fullcodeline": "if (snprintf(path, sizeof(path), \"%s/%s\", dir, save) >= (int)sizeof(path)) // TODO windows path"
    },
    {
        "line": 9,
        "fullcodeline": "SCLogNotice(\"Allowing absolute filename for dataset rule: %s\", save);"
    },
    {
        "line": 27,
        "fullcodeline": "return -1;"
    },
    {
        "line": 11,
        "fullcodeline": "if (PathIsAbsolute(save)) {"
    },
    {
        "line": 16,
        "fullcodeline": "if (SCPathContainsTraversal(save)) {"
    },
    {
        "line": 12,
        "fullcodeline": "SCLogError(SC_ERR_INVALID_ARGUMENT, \"Absolute paths not allowed: %s\", save);"
    },
    {
        "line": 17,
        "fullcodeline": "SCLogError(SC_ERR_INVALID_ARGUMENT, \"Directory traversals not allowed: %s\", save);"
    },
    {
        "line": 13,
        "fullcodeline": "return -1;"
    },
    {
        "line": 18,
        "fullcodeline": "return -1;"
    }
]