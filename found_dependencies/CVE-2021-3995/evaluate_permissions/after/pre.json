[
    {
        "line": 4,
        "fullcodeline": "unsigned long u_flags = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "int rc = 0, ok = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "assert(cxt);"
    },
    {
        "line": 10,
        "fullcodeline": "assert(cxt->fs);"
    },
    {
        "line": 11,
        "fullcodeline": "assert((cxt->flags & MNT_FL_MOUNTFLAGS_MERGED));"
    },
    {
        "line": 16,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt, \"umount: evaluating permissions\"));"
    },
    {
        "line": 48,
        "fullcodeline": "rc = mnt_context_get_fstab(cxt, &fstab);"
    },
    {
        "line": 52,
        "fullcodeline": "tgt = mnt_fs_get_target(cxt->fs);"
    },
    {
        "line": 53,
        "fullcodeline": "src = mnt_fs_get_source(cxt->fs);"
    },
    {
        "line": 67,
        "fullcodeline": "fs = mnt_table_find_pair(fstab, src, tgt, MNT_ITER_FORWARD);"
    },
    {
        "line": 101,
        "fullcodeline": "optstr = mnt_fs_get_user_options(fs);\t/* FSTAB mount options! */"
    },
    {
        "line": 13,
        "fullcodeline": "if (!mnt_context_is_restricted(cxt))"
    },
    {
        "line": 25,
        "fullcodeline": "if (cxt->user_mountflags & MNT_MS_UHELPER) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (is_fuse_usermount(cxt, &rc)) {"
    },
    {
        "line": 55,
        "fullcodeline": "if (mnt_fs_get_bindsrc(cxt->fs)) {"
    },
    {
        "line": 68,
        "fullcodeline": "if (!fs) {"
    },
    {
        "line": 102,
        "fullcodeline": "if (!optstr)"
    },
    {
        "line": 105,
        "fullcodeline": "if (mnt_optstr_get_flags(optstr, &u_flags,"
    },
    {
        "line": 109,
        "fullcodeline": "if (u_flags & MNT_MS_USERS) {"
    },
    {
        "line": 158,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt, \"umount is not allowed for you\"));"
    },
    {
        "line": 159,
        "fullcodeline": "return -EPERM;"
    },
    {
        "line": 18,
        "fullcodeline": "if (!mnt_context_tab_applied(cxt)) {"
    },
    {
        "line": 19,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt,"
    },
    {
        "line": 27,
        "fullcodeline": "rc = prepare_helper_from_options(cxt, \"uhelper\");"
    },
    {
        "line": 56,
        "fullcodeline": "src = mnt_fs_get_bindsrc(cxt->fs);"
    },
    {
        "line": 57,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt,"
    },
    {
        "line": 74,
        "fullcodeline": "fs = mnt_table_find_target(fstab, tgt, MNT_ITER_FORWARD);"
    },
    {
        "line": 106,
        "fullcodeline": "mnt_get_builtin_optmap(MNT_USERSPACE_MAP)))"
    },
    {
        "line": 118,
        "fullcodeline": "if (u_flags & (MNT_MS_USER | MNT_MS_OWNER | MNT_MS_GROUP)) {"
    },
    {
        "line": 121,
        "fullcodeline": "char *mtab_user = NULL;"
    },
    {
        "line": 125,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt,"
    },
    {
        "line": 128,
        "fullcodeline": "ns_old = mnt_context_switch_origin_ns(cxt);"
    },
    {
        "line": 132,
        "fullcodeline": "curr_user = mnt_get_username(getuid());"
    },
    {
        "line": 145,
        "fullcodeline": "optstr = mnt_fs_get_user_options(cxt->fs);"
    },
    {
        "line": 39,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt, \"fuse user mount, umount is allowed\"));"
    },
    {
        "line": 83,
        "fullcodeline": "if (!fs) {"
    },
    {
        "line": 110,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt,"
    },
    {
        "line": 129,
        "fullcodeline": "if (!ns_old)"
    },
    {
        "line": 138,
        "fullcodeline": "if (!curr_user) {"
    },
    {
        "line": 146,
        "fullcodeline": "if (optstr && !mnt_optstr_get_option(optstr,"
    },
    {
        "line": 154,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt, \"umount %s is allowed\", tgt));"
    },
    {
        "line": 21,
        "fullcodeline": "mnt_fs_get_target(cxt->fs)));"
    },
    {
        "line": 76,
        "fullcodeline": "struct libmnt_cache *cache = mnt_context_get_cache(cxt);"
    },
    {
        "line": 77,
        "fullcodeline": "const char *sp = mnt_fs_get_srcpath(cxt->fs);\t\t/* devname from mtab */"
    },
    {
        "line": 78,
        "fullcodeline": "const char *dev = sp && cache ? mnt_resolve_path(sp, cache) : sp;"
    },
    {
        "line": 84,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt,"
    },
    {
        "line": 134,
        "fullcodeline": "if (!mnt_context_switch_ns(cxt, ns_old)) {"
    },
    {
        "line": 139,
        "fullcodeline": "DBG(CXT, ul_debugobj(cxt, \"umount %s: cannot \""
    },
    {
        "line": 130,
        "fullcodeline": "return -MNT_ERR_NAMESPACE;"
    },
    {
        "line": 136,
        "fullcodeline": "return -MNT_ERR_NAMESPACE;"
    },
    {
        "line": 148,
        "fullcodeline": "ok = !strncmp(curr_user, mtab_user, sz);"
    },
    {
        "line": 80,
        "fullcodeline": "if (!dev || !is_associated_fs(dev, fs))"
    },
    {
        "line": 81,
        "fullcodeline": "fs = NULL;"
    }
]