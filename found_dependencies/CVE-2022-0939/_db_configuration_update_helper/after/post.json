[
    {
        "line": 2,
        "fullcodeline": "db_change = False"
    },
    {
        "line": 3,
        "fullcodeline": "to_save = request.form.to_dict()"
    },
    {
        "line": 4,
        "fullcodeline": "gdrive_error = None"
    },
    {
        "line": 6,
        "fullcodeline": "to_save['config_calibre_dir'] = re.sub(r'[\\\\/]metadata\\.db$',"
    },
    {
        "line": 10,
        "fullcodeline": "db_valid = False"
    },
    {
        "line": 50,
        "fullcodeline": "config.save()"
    },
    {
        "line": 28,
        "fullcodeline": "if db_change or not db_valid or not config.db_configured \\"
    },
    {
        "line": 51,
        "fullcodeline": "return _db_configuration_result(None, gdrive_error)"
    },
    {
        "line": 15,
        "fullcodeline": "gdrive_error = _configuration_gdrive_helper(to_save)"
    },
    {
        "line": 21,
        "fullcodeline": "metadata_db = os.path.join(to_save['config_calibre_dir'], \"metadata.db\")"
    },
    {
        "line": 33,
        "fullcodeline": "config.store_calibre_uuid(calibre_db, db.LibraryId)"
    },
    {
        "line": 46,
        "fullcodeline": "_config_string(to_save, \"config_calibre_dir\")"
    },
    {
        "line": 47,
        "fullcodeline": "calibre_db.update_config(config)"
    },
    {
        "line": 12,
        "fullcodeline": "db_change, db_valid = _db_simulate_change()"
    },
    {
        "line": 22,
        "fullcodeline": "if config.config_use_google_drive and is_gdrive_ready() and not os.path.exists(metadata_db):"
    },
    {
        "line": 30,
        "fullcodeline": "if not calibre_db.setup_db(to_save['config_calibre_dir'], ub.app_DB_path):"
    },
    {
        "line": 48,
        "fullcodeline": "if not os.access(os.path.join(config.config_calibre_dir, \"metadata.db\"), os.W_OK):"
    },
    {
        "line": 18,
        "fullcodeline": "log.error_or_exception(\"Settings Database error: {}\".format(e))"
    },
    {
        "line": 19,
        "fullcodeline": "_db_configuration_result(_(u\"Database error: %(error)s.\", error=e.orig), gdrive_error)"
    },
    {
        "line": 23,
        "fullcodeline": "gdriveutils.downloadFile(None, \"metadata.db\", metadata_db)"
    },
    {
        "line": 24,
        "fullcodeline": "db_change = True"
    },
    {
        "line": 36,
        "fullcodeline": "log.info(\"Calibre Database changed, delete all Calibre-Web info related to old Database\")"
    },
    {
        "line": 45,
        "fullcodeline": "ub.session_commit()"
    },
    {
        "line": 49,
        "fullcodeline": "flash(_(u\"DB is not Writeable\"), category=\"warning\")"
    },
    {
        "line": 17,
        "fullcodeline": "ub.session.rollback()"
    },
    {
        "line": 26,
        "fullcodeline": "return _db_configuration_result('{}'.format(ex), gdrive_error)"
    },
    {
        "line": 31,
        "fullcodeline": "return _db_configuration_result(_('DB Location is not Valid, Please Enter Correct Path'),"
    },
    {
        "line": 37,
        "fullcodeline": "ub.session.query(ub.Downloads).delete()"
    },
    {
        "line": 38,
        "fullcodeline": "ub.session.query(ub.ArchivedBook).delete()"
    },
    {
        "line": 39,
        "fullcodeline": "ub.session.query(ub.ReadBook).delete()"
    },
    {
        "line": 40,
        "fullcodeline": "ub.session.query(ub.BookShelf).delete()"
    },
    {
        "line": 41,
        "fullcodeline": "ub.session.query(ub.Bookmark).delete()"
    },
    {
        "line": 42,
        "fullcodeline": "ub.session.query(ub.KoboReadingState).delete()"
    },
    {
        "line": 43,
        "fullcodeline": "ub.session.query(ub.KoboStatistics).delete()"
    },
    {
        "line": 44,
        "fullcodeline": "ub.session.query(ub.KoboSyncedBooks).delete()"
    }
]