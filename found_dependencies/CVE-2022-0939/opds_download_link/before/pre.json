[
    {
        "line": 5,
        "fullcodeline": "user = load_user_from_request(request) or current_user"
    },
    {
        "line": 6,
        "fullcodeline": "if not user.role_download():"
    },
    {
        "line": 12,
        "fullcodeline": "return get_download_link(book_id, book_format.lower(), client)"
    },
    {
        "line": 9,
        "fullcodeline": "client = \"kobo\""
    },
    {
        "line": 11,
        "fullcodeline": "client = \"\""
    },
    {
        "line": 7,
        "fullcodeline": "return abort(403)"
    },
    {
        "line": 8,
        "fullcodeline": "if \"Kobo\" in request.headers.get('User-Agent'):"
    }
]