[
    {
        "line": 62,
        "fullcodeline": "next_url = request.args.get('next', default=url_for(\"web.index\"), type=str)"
    },
    {
        "line": 2,
        "fullcodeline": "if current_user is not None and current_user.is_authenticated:"
    },
    {
        "line": 4,
        "fullcodeline": "if config.config_login_type == constants.LOGIN_LDAP and not services.ldap:"
    },
    {
        "line": 7,
        "fullcodeline": "if request.method == \"POST\":"
    },
    {
        "line": 63,
        "fullcodeline": "if url_for(\"web.logout\") == next_url:"
    },
    {
        "line": 65,
        "fullcodeline": "return render_title_template('login.html',"
    },
    {
        "line": 5,
        "fullcodeline": "log.error(u\"Cannot activate LDAP authentication\")"
    },
    {
        "line": 6,
        "fullcodeline": "flash(_(u\"Cannot activate LDAP authentication\"), category=\"error\")"
    },
    {
        "line": 8,
        "fullcodeline": "form = request.form.to_dict()"
    },
    {
        "line": 9,
        "fullcodeline": "user = ub.session.query(ub.User).filter(func.lower(ub.User.name) == form['username'].strip().lower()) \\"
    },
    {
        "line": 64,
        "fullcodeline": "next_url = url_for(\"web.index\")"
    },
    {
        "line": 66,
        "fullcodeline": "title=_(u\"Login\"),"
    },
    {
        "line": 70,
        "fullcodeline": "mail=config.get_mail_server_configured(), page=\"login\")"
    },
    {
        "line": 3,
        "fullcodeline": "return redirect(url_for('web.index'))"
    },
    {
        "line": 11,
        "fullcodeline": "if config.config_login_type == constants.LOGIN_LDAP and services.ldap and user and form['password'] != \"\":"
    },
    {
        "line": 37,
        "fullcodeline": "ip_Address = request.headers.get('X-Forwarded-For', request.remote_addr)"
    },
    {
        "line": 12,
        "fullcodeline": "login_result, error = services.ldap.bind_user(form['username'], form['password'])"
    },
    {
        "line": 38,
        "fullcodeline": "if 'forgot' in form and form['forgot'] == 'forgot':"
    },
    {
        "line": 14,
        "fullcodeline": "login_user(user, remember=bool(form.get('remember_me')))"
    },
    {
        "line": 15,
        "fullcodeline": "ub.store_user_session()"
    },
    {
        "line": 16,
        "fullcodeline": "log.debug(u\"You are now logged in as: '%s'\", user.name)"
    },
    {
        "line": 17,
        "fullcodeline": "flash(_(u\"you are now logged in as: '%(nickname)s'\", nickname=user.name),"
    },
    {
        "line": 19,
        "fullcodeline": "return redirect_back(url_for(\"web.index\"))"
    },
    {
        "line": 20,
        "fullcodeline": "elif login_result is None and user and check_password_hash(str(user.password), form['password']) \\"
    },
    {
        "line": 39,
        "fullcodeline": "if user is not None and user.name != \"Guest\":"
    },
    {
        "line": 51,
        "fullcodeline": "if user and check_password_hash(str(user.password), form['password']) and user.name != \"Guest\":"
    },
    {
        "line": 22,
        "fullcodeline": "login_user(user, remember=bool(form.get('remember_me')))"
    },
    {
        "line": 23,
        "fullcodeline": "ub.store_user_session()"
    },
    {
        "line": 24,
        "fullcodeline": "log.info(\"Local Fallback Login as: '%s'\", user.name)"
    },
    {
        "line": 25,
        "fullcodeline": "flash(_(u\"Fallback Login as: '%(nickname)s', LDAP Server not reachable, or user not known\","
    },
    {
        "line": 48,
        "fullcodeline": "flash(_(u\"Please enter valid username to reset password\"), category=\"error\")"
    },
    {
        "line": 49,
        "fullcodeline": "log.warning('Username missing for password reset IP-address: %s', ip_Address)"
    },
    {
        "line": 52,
        "fullcodeline": "login_user(user, remember=bool(form.get('remember_me')))"
    },
    {
        "line": 53,
        "fullcodeline": "ub.store_user_session()"
    },
    {
        "line": 54,
        "fullcodeline": "log.debug(u\"You are now logged in as: '%s'\", user.name)"
    },
    {
        "line": 55,
        "fullcodeline": "flash(_(u\"You are now logged in as: '%(nickname)s'\", nickname=user.name), category=\"success\")"
    },
    {
        "line": 56,
        "fullcodeline": "config.config_is_initial = False"
    },
    {
        "line": 59,
        "fullcodeline": "log.warning('Login failed for user \"%s\" IP-address: %s', form['username'], ip_Address)"
    },
    {
        "line": 60,
        "fullcodeline": "flash(_(u\"Wrong Username or Password\"), category=\"error\")"
    },
    {
        "line": 28,
        "fullcodeline": "return redirect_back(url_for(\"web.index\"))"
    },
    {
        "line": 29,
        "fullcodeline": "elif login_result is None:"
    },
    {
        "line": 40,
        "fullcodeline": "ret, __ = reset_password(user.id)"
    },
    {
        "line": 41,
        "fullcodeline": "if ret == 1:"
    },
    {
        "line": 57,
        "fullcodeline": "return redirect_back(url_for(\"web.index\"))"
    },
    {
        "line": 30,
        "fullcodeline": "log.info(error)"
    },
    {
        "line": 31,
        "fullcodeline": "flash(_(u\"Could not login: %(message)s\", message=error), category=\"error\")"
    },
    {
        "line": 33,
        "fullcodeline": "ip_Address = request.headers.get('X-Forwarded-For', request.remote_addr)"
    },
    {
        "line": 34,
        "fullcodeline": "log.warning('LDAP Login failed for user \"%s\" IP-address: %s', form['username'], ip_Address)"
    },
    {
        "line": 35,
        "fullcodeline": "flash(_(u\"Wrong Username or Password\"), category=\"error\")"
    },
    {
        "line": 42,
        "fullcodeline": "flash(_(u\"New Password was send to your email address\"), category=\"info\")"
    },
    {
        "line": 43,
        "fullcodeline": "log.info('Password reset for user \"%s\" IP-address: %s', form['username'], ip_Address)"
    },
    {
        "line": 45,
        "fullcodeline": "log.error(u\"An unknown error occurred. Please try again later\")"
    },
    {
        "line": 46,
        "fullcodeline": "flash(_(u\"An unknown error occurred. Please try again later.\"), category=\"error\")"
    }
]