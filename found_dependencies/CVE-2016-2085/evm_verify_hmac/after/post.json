[
    {
        "line": 7,
        "fullcodeline": "struct evm_ima_xattr_data *xattr_data = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "enum integrity_status evm_status = INTEGRITY_PASS;"
    },
    {
        "line": 18,
        "fullcodeline": "rc = vfs_getxattr_alloc(dentry, XATTR_NAME_EVM, (char **)&xattr_data, 0,"
    },
    {
        "line": 34,
        "fullcodeline": "xattr_len = rc;"
    },
    {
        "line": 78,
        "fullcodeline": "kfree(xattr_data);"
    },
    {
        "line": 12,
        "fullcodeline": "if (iint && iint->evm_status == INTEGRITY_PASS)"
    },
    {
        "line": 20,
        "fullcodeline": "if (rc <= 0) {"
    },
    {
        "line": 21,
        "fullcodeline": "evm_status = INTEGRITY_FAIL;"
    },
    {
        "line": 39,
        "fullcodeline": "rc = evm_calc_hmac(dentry, xattr_name, xattr_value,"
    },
    {
        "line": 43,
        "fullcodeline": "rc = crypto_memneq(xattr_data->digest, calc.digest,"
    },
    {
        "line": 49,
        "fullcodeline": "rc = evm_calc_hash(dentry, xattr_name, xattr_value,"
    },
    {
        "line": 53,
        "fullcodeline": "rc = integrity_digsig_verify(INTEGRITY_KEYRING_EVM,"
    },
    {
        "line": 68,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 73,
        "fullcodeline": "evm_status = (rc == -ENODATA) ?"
    },
    {
        "line": 77,
        "fullcodeline": "iint->evm_status = evm_status;"
    },
    {
        "line": 22,
        "fullcodeline": "if (rc == -ENODATA) {"
    },
    {
        "line": 56,
        "fullcodeline": "if (!rc) {"
    },
    {
        "line": 23,
        "fullcodeline": "rc = evm_find_protected_xattrs(dentry);"
    },
    {
        "line": 46,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 54,
        "fullcodeline": "(const char *)xattr_data, xattr_len,"
    },
    {
        "line": 24,
        "fullcodeline": "if (rc > 0)"
    },
    {
        "line": 60,
        "fullcodeline": "if (!IS_RDONLY(d_backing_inode(dentry)) &&"
    },
    {
        "line": 25,
        "fullcodeline": "evm_status = INTEGRITY_NOLABEL;"
    },
    {
        "line": 28,
        "fullcodeline": "} else if (rc == -EOPNOTSUPP) {"
    },
    {
        "line": 61,
        "fullcodeline": "!IS_IMMUTABLE(d_backing_inode(dentry)))"
    },
    {
        "line": 62,
        "fullcodeline": "evm_update_evmxattr(dentry, xattr_name,"
    },
    {
        "line": 29,
        "fullcodeline": "evm_status = INTEGRITY_UNKNOWN;"
    },
    {
        "line": 26,
        "fullcodeline": "else if (rc == 0)"
    },
    {
        "line": 27,
        "fullcodeline": "evm_status = INTEGRITY_NOXATTRS; /* new file */"
    }
]