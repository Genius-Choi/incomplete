[
    {
        "line": 7,
        "fullcodeline": "char *s=nullptr, *start_arr=nullptr;"
    },
    {
        "line": 9,
        "fullcodeline": "char *lbuf=nullptr;"
    },
    {
        "line": 10,
        "fullcodeline": "int total_bytes=0, cancel_upload=0, is_arr_upload=0, array_len=0;"
    },
    {
        "line": 11,
        "fullcodeline": "int max_file_size=0, skip_upload=0, anonindex=0, is_anonymous;"
    },
    {
        "line": 12,
        "fullcodeline": "std::set<std::string> &uploaded_files = s_rfc1867_data->rfc1867UploadedFiles;"
    },
    {
        "line": 14,
        "fullcodeline": "int fd=-1;"
    },
    {
        "line": 15,
        "fullcodeline": "void *event_extra_data = nullptr;"
    },
    {
        "line": 16,
        "fullcodeline": "unsigned int llen = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "int upload_count = RuntimeOption::MaxFileUploads;"
    },
    {
        "line": 27,
        "fullcodeline": "s_rfc1867_data->rfc1867ProtectedVariables.clear();"
    },
    {
        "line": 20,
        "fullcodeline": "if (!(mbuff = multipart_buffer_new(transport,"
    },
    {
        "line": 35,
        "fullcodeline": "if (php_rfc1867_callback != nullptr) {"
    },
    {
        "line": 22,
        "fullcodeline": "Logger::Warning(\"Unable to initialize the input buffer\");"
    },
    {
        "line": 38,
        "fullcodeline": "event_start.content_length = content_length;"
    },
    {
        "line": 46,
        "fullcodeline": "while (!multipart_buffer_eof(mbuff)) {"
    },
    {
        "line": 48,
        "fullcodeline": "char buff[FILLUNIT];"
    },
    {
        "line": 49,
        "fullcodeline": "char *cd=nullptr,*param=nullptr,*filename=nullptr, *tmp=nullptr;"
    },
    {
        "line": 50,
        "fullcodeline": "size_t blen=0, wlen=0;"
    },
    {
        "line": 499,
        "fullcodeline": "event_end.post_bytes_processed = mbuff->read_post_bytes;"
    },
    {
        "line": 500,
        "fullcodeline": "php_rfc1867_callback(&s_rfc1867_data->rfc1867ApcData,"
    },
    {
        "line": 505,
        "fullcodeline": "if (mbuff->boundary_next) free(mbuff->boundary_next);"
    },
    {
        "line": 506,
        "fullcodeline": "if (mbuff->boundary) free(mbuff->boundary);"
    },
    {
        "line": 507,
        "fullcodeline": "if (mbuff->buffer) free(mbuff->buffer);"
    },
    {
        "line": 39,
        "fullcodeline": "if (php_rfc1867_callback(&s_rfc1867_data->rfc1867ApcData,"
    },
    {
        "line": 58,
        "fullcodeline": "if ((cd = php_mime_get_hdr_value(header, \"Content-Disposition\"))) {"
    },
    {
        "line": 21,
        "fullcodeline": "(const char *)data, size, boundary))) {"
    },
    {
        "line": 54,
        "fullcodeline": "if (!multipart_buffer_headers(mbuff, header)) {"
    },
    {
        "line": 59,
        "fullcodeline": "char *pair=nullptr;"
    },
    {
        "line": 182,
        "fullcodeline": "total_bytes = cancel_upload = 0;"
    },
    {
        "line": 237,
        "fullcodeline": "offset = 0;"
    },
    {
        "line": 238,
        "fullcodeline": "end = 0;"
    },
    {
        "line": 359,
        "fullcodeline": "s = strrchr(filename, '\\\\');"
    },
    {
        "line": 364,
        "fullcodeline": "Array globals = php_globals_as_array();"
    },
    {
        "line": 390,
        "fullcodeline": "s = nullptr;"
    },
    {
        "line": 423,
        "fullcodeline": "String val(cd, strlen(cd), CopyString);"
    },
    {
        "line": 424,
        "fullcodeline": "safe_php_register_variable(lbuf, val, files, 0);"
    },
    {
        "line": 433,
        "fullcodeline": "add_protected_variable(param);"
    },
    {
        "line": 435,
        "fullcodeline": "Variant tempFileName(temp_filename);"
    },
    {
        "line": 449,
        "fullcodeline": "add_protected_variable(lbuf);"
    },
    {
        "line": 450,
        "fullcodeline": "safe_php_register_variable(lbuf, tempFileName, files, 1);"
    },
    {
        "line": 454,
        "fullcodeline": "error_type = cancel_upload;"
    },
    {
        "line": 469,
        "fullcodeline": "safe_php_register_variable(lbuf, error_type, files, 0);"
    },
    {
        "line": 489,
        "fullcodeline": "safe_php_register_variable(lbuf, file_size, files, 0);"
    },
    {
        "line": 62,
        "fullcodeline": "while (isspace(*cd)) {"
    },
    {
        "line": 66,
        "fullcodeline": "while (*cd && (pair = php_ap_getword(&cd, ';')))"
    },
    {
        "line": 94,
        "fullcodeline": "if (!filename && param) {"
    },
    {
        "line": 151,
        "fullcodeline": "if (!param) {"
    },
    {
        "line": 160,
        "fullcodeline": "if (!skip_upload) {"
    },
    {
        "line": 184,
        "fullcodeline": "if (!skip_upload) {"
    },
    {
        "line": 286,
        "fullcodeline": "if (fd!=-1) { /* may not be initialized if file could not be created */"
    },
    {
        "line": 289,
        "fullcodeline": "if (!cancel_upload && !end) {"
    },
    {
        "line": 300,
        "fullcodeline": "if (php_rfc1867_callback != nullptr) {"
    },
    {
        "line": 314,
        "fullcodeline": "if (cancel_upload && cancel_upload != UPLOAD_ERROR_C) {"
    },
    {
        "line": 329,
        "fullcodeline": "is_arr_upload = (start_arr = strchr(param,'[')) &&"
    },
    {
        "line": 338,
        "fullcodeline": "if (llen < strlen(param) + MAX_SIZE_OF_INDEX + 1) {"
    },
    {
        "line": 360,
        "fullcodeline": "if ((tmp = strrchr(filename, '/')) > s) {"
    },
    {
        "line": 365,
        "fullcodeline": "if (!is_anonymous) {"
    },
    {
        "line": 411,
        "fullcodeline": "if (!is_anonymous) {"
    },
    {
        "line": 438,
        "fullcodeline": "if (!is_anonymous) {"
    },
    {
        "line": 63,
        "fullcodeline": "++cd;"
    },
    {
        "line": 68,
        "fullcodeline": "char *key=nullptr, *word = pair;"
    },
    {
        "line": 96,
        "fullcodeline": "char *value = multipart_buffer_read_body(mbuff, &value_len);"
    },
    {
        "line": 103,
        "fullcodeline": "new_val_len = value_len;"
    },
    {
        "line": 123,
        "fullcodeline": "String val(value, new_val_len, CopyString);"
    },
    {
        "line": 124,
        "fullcodeline": "safe_php_register_variable(param, val, post, 0);"
    },
    {
        "line": 137,
        "fullcodeline": "skip_upload = 1;"
    },
    {
        "line": 146,
        "fullcodeline": "if (!param && !filename) {"
    },
    {
        "line": 152,
        "fullcodeline": "is_anonymous = 1;"
    },
    {
        "line": 153,
        "fullcodeline": "param = (char*)malloc(MAX_SIZE_ANONNAME);"
    },
    {
        "line": 154,
        "fullcodeline": "snprintf(param, MAX_SIZE_ANONNAME, \"%u\", anonindex++);"
    },
    {
        "line": 161,
        "fullcodeline": "tmp = param;"
    },
    {
        "line": 162,
        "fullcodeline": "long c = 0;"
    },
    {
        "line": 189,
        "fullcodeline": "snprintf(path, sizeof(path), \"%s/XXXXXX\","
    },
    {
        "line": 191,
        "fullcodeline": "fd = mkstemp(path);"
    },
    {
        "line": 192,
        "fullcodeline": "upload_count--;"
    },
    {
        "line": 199,
        "fullcodeline": "temp_filename = path;"
    },
    {
        "line": 202,
        "fullcodeline": "if (!skip_upload && php_rfc1867_callback != nullptr) {"
    },
    {
        "line": 205,
        "fullcodeline": "event_file_start.post_bytes_processed = mbuff->read_post_bytes;"
    },
    {
        "line": 206,
        "fullcodeline": "event_file_start.name = param;"
    },
    {
        "line": 207,
        "fullcodeline": "event_file_start.filename = &filename;"
    },
    {
        "line": 232,
        "fullcodeline": "if (strlen(filename) == 0) {"
    },
    {
        "line": 234,
        "fullcodeline": "cancel_upload = UPLOAD_ERROR_D;"
    },
    {
        "line": 239,
        "fullcodeline": "while (!cancel_upload &&"
    },
    {
        "line": 240,
        "fullcodeline": "(blen = multipart_buffer_read(mbuff, buff, sizeof(buff), &end)))"
    },
    {
        "line": 287,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 292,
        "fullcodeline": "cancel_upload = UPLOAD_ERROR_C;"
    },
    {
        "line": 294,
        "fullcodeline": "if (strlen(filename) > 0 && total_bytes == 0 && !cancel_upload) {"
    },
    {
        "line": 295,
        "fullcodeline": "Logger::Verbose(\"Uploaded file size 0 - file [%s=%s] not saved\","
    },
    {
        "line": 297,
        "fullcodeline": "cancel_upload = 5;"
    },
    {
        "line": 303,
        "fullcodeline": "event_file_end.post_bytes_processed = mbuff->read_post_bytes;"
    },
    {
        "line": 304,
        "fullcodeline": "event_file_end.temp_filename = temp_filename.c_str();"
    },
    {
        "line": 305,
        "fullcodeline": "event_file_end.cancel_upload = cancel_upload;"
    },
    {
        "line": 320,
        "fullcodeline": "temp_filename=\"\";"
    },
    {
        "line": 330,
        "fullcodeline": "(param[strlen(param)-1] == ']');"
    },
    {
        "line": 333,
        "fullcodeline": "array_len = strlen(start_arr);"
    },
    {
        "line": 334,
        "fullcodeline": "array_index = std::string(start_arr+1, array_len-2);"
    },
    {
        "line": 339,
        "fullcodeline": "llen = strlen(param);"
    },
    {
        "line": 340,
        "fullcodeline": "lbuf = (char *) realloc(lbuf, llen + MAX_SIZE_OF_INDEX + 1);"
    },
    {
        "line": 341,
        "fullcodeline": "llen += MAX_SIZE_OF_INDEX + 1;"
    },
    {
        "line": 345,
        "fullcodeline": "abuf = std::string(param, strlen(param)-array_len);"
    },
    {
        "line": 346,
        "fullcodeline": "snprintf(lbuf, llen, \"%s_name[%s]\","
    },
    {
        "line": 361,
        "fullcodeline": "s = tmp;"
    },
    {
        "line": 377,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[name][%s]\","
    },
    {
        "line": 383,
        "fullcodeline": "String val(s+1, strlen(s+1), CopyString);"
    },
    {
        "line": 384,
        "fullcodeline": "safe_php_register_variable(lbuf, val, files, 0);"
    },
    {
        "line": 393,
        "fullcodeline": "if ((cancel_upload && cancel_upload != UPLOAD_ERROR_C) ||"
    },
    {
        "line": 394,
        "fullcodeline": "!(cd = php_mime_get_hdr_value(header, \"Content-Type\"))) {"
    },
    {
        "line": 395,
        "fullcodeline": "cd = \"\";"
    },
    {
        "line": 406,
        "fullcodeline": "snprintf(lbuf, llen, \"%s_type[%s]\","
    },
    {
        "line": 412,
        "fullcodeline": "String val(cd, strlen(cd), CopyString);"
    },
    {
        "line": 413,
        "fullcodeline": "safe_php_register_variable(lbuf, val, globals, 0);"
    },
    {
        "line": 418,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[type][%s]\","
    },
    {
        "line": 428,
        "fullcodeline": "*s = ';';"
    },
    {
        "line": 439,
        "fullcodeline": "safe_php_register_variable(param, tempFileName, globals, 1);"
    },
    {
        "line": 444,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[tmp_name][%s]\","
    },
    {
        "line": 458,
        "fullcodeline": "file_size = 0;"
    },
    {
        "line": 464,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[error][%s]\","
    },
    {
        "line": 473,
        "fullcodeline": "snprintf(lbuf, llen, \"%s_size[%s]\","
    },
    {
        "line": 479,
        "fullcodeline": "safe_php_register_variable(lbuf, file_size, globals, 0);"
    },
    {
        "line": 484,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[size][%s]\","
    },
    {
        "line": 70,
        "fullcodeline": "while (isspace(*cd)) {"
    },
    {
        "line": 74,
        "fullcodeline": "if (strchr(pair, '=')) {"
    },
    {
        "line": 99,
        "fullcodeline": "if (!value) {"
    },
    {
        "line": 104,
        "fullcodeline": "if (php_rfc1867_callback != nullptr) {"
    },
    {
        "line": 156,
        "fullcodeline": "is_anonymous = 0;"
    },
    {
        "line": 186,
        "fullcodeline": "char path[PATH_MAX];"
    },
    {
        "line": 190,
        "fullcodeline": "RuntimeOption::UploadTmpDir.c_str());"
    },
    {
        "line": 193,
        "fullcodeline": "if (fd == -1) {"
    },
    {
        "line": 208,
        "fullcodeline": "if (php_rfc1867_callback(&s_rfc1867_data->rfc1867ApcData,"
    },
    {
        "line": 242,
        "fullcodeline": "if (php_rfc1867_callback != nullptr) {"
    },
    {
        "line": 306,
        "fullcodeline": "if (php_rfc1867_callback(&s_rfc1867_data->rfc1867ApcData,"
    },
    {
        "line": 322,
        "fullcodeline": "s_rfc1867_data->rfc1867UploadedFiles.insert(temp_filename);"
    },
    {
        "line": 347,
        "fullcodeline": "abuf.c_str(), array_index.c_str());"
    },
    {
        "line": 349,
        "fullcodeline": "snprintf(lbuf, llen, \"%s_name\", param);"
    },
    {
        "line": 378,
        "fullcodeline": "abuf.c_str(), array_index.c_str());"
    },
    {
        "line": 380,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[name]\", param);"
    },
    {
        "line": 386,
        "fullcodeline": "String val(filename, strlen(filename), CopyString);"
    },
    {
        "line": 387,
        "fullcodeline": "safe_php_register_variable(lbuf, val, files, 0);"
    },
    {
        "line": 398,
        "fullcodeline": "s = strchr(cd, ';');"
    },
    {
        "line": 407,
        "fullcodeline": "abuf.c_str(), array_index.c_str());"
    },
    {
        "line": 409,
        "fullcodeline": "snprintf(lbuf, llen, \"%s_type\", param);"
    },
    {
        "line": 419,
        "fullcodeline": "abuf.c_str(), array_index.c_str());"
    },
    {
        "line": 421,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[type]\", param);"
    },
    {
        "line": 445,
        "fullcodeline": "abuf.c_str(), array_index.c_str());"
    },
    {
        "line": 447,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[tmp_name]\", param);"
    },
    {
        "line": 460,
        "fullcodeline": "file_size = total_bytes;"
    },
    {
        "line": 465,
        "fullcodeline": "abuf.c_str(), array_index.c_str());"
    },
    {
        "line": 467,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[error]\", param);"
    },
    {
        "line": 474,
        "fullcodeline": "abuf.c_str(), array_index.c_str());"
    },
    {
        "line": 476,
        "fullcodeline": "snprintf(lbuf, llen, \"%s_size\", param);"
    },
    {
        "line": 485,
        "fullcodeline": "abuf.c_str(), array_index.c_str());"
    },
    {
        "line": 487,
        "fullcodeline": "snprintf(lbuf, llen, \"%s[size]\", param);"
    },
    {
        "line": 71,
        "fullcodeline": "++cd;"
    },
    {
        "line": 75,
        "fullcodeline": "key = php_ap_getword(&pair, '=');"
    },
    {
        "line": 100,
        "fullcodeline": "value = strdup(\"\");"
    },
    {
        "line": 106,
        "fullcodeline": "size_t newlength = new_val_len;"
    },
    {
        "line": 108,
        "fullcodeline": "event_formdata.post_bytes_processed = mbuff->read_post_bytes;"
    },
    {
        "line": 109,
        "fullcodeline": "event_formdata.name = param;"
    },
    {
        "line": 110,
        "fullcodeline": "event_formdata.value = &value;"
    },
    {
        "line": 111,
        "fullcodeline": "event_formdata.length = new_val_len;"
    },
    {
        "line": 112,
        "fullcodeline": "event_formdata.newlength = &newlength;"
    },
    {
        "line": 120,
        "fullcodeline": "new_val_len = newlength;"
    },
    {
        "line": 126,
        "fullcodeline": "if (!strcasecmp(param, \"MAX_FILE_SIZE\")) {"
    },
    {
        "line": 127,
        "fullcodeline": "max_file_size = atol(value);"
    },
    {
        "line": 138,
        "fullcodeline": "} else if (upload_count <= 0) {"
    },
    {
        "line": 178,
        "fullcodeline": "tmp++;"
    },
    {
        "line": 197,
        "fullcodeline": "cancel_upload = UPLOAD_ERROR_E;"
    },
    {
        "line": 218,
        "fullcodeline": "temp_filename=\"\";"
    },
    {
        "line": 245,
        "fullcodeline": "event_file_data.post_bytes_processed = mbuff->read_post_bytes;"
    },
    {
        "line": 246,
        "fullcodeline": "event_file_data.offset = offset;"
    },
    {
        "line": 247,
        "fullcodeline": "event_file_data.data = buff;"
    },
    {
        "line": 248,
        "fullcodeline": "event_file_data.length = blen;"
    },
    {
        "line": 249,
        "fullcodeline": "event_file_data.newlength = &blen;"
    },
    {
        "line": 260,
        "fullcodeline": "if (VirtualHost::GetUploadMaxFileSize() > 0 &&"
    },
    {
        "line": 261,
        "fullcodeline": "total_bytes > VirtualHost::GetUploadMaxFileSize()) {"
    },
    {
        "line": 266,
        "fullcodeline": "cancel_upload = UPLOAD_ERROR_A;"
    },
    {
        "line": 310,
        "fullcodeline": "cancel_upload = UPLOAD_ERROR_X;"
    },
    {
        "line": 315,
        "fullcodeline": "if (!temp_filename.empty()) {"
    },
    {
        "line": 367,
        "fullcodeline": "String val(s+1, strlen(s+1), CopyString);"
    },
    {
        "line": 368,
        "fullcodeline": "safe_php_register_variable(lbuf, val, globals, 0);"
    },
    {
        "line": 399,
        "fullcodeline": "if (s != nullptr) {"
    },
    {
        "line": 113,
        "fullcodeline": "if (php_rfc1867_callback(&s_rfc1867_data->rfc1867ApcData,"
    },
    {
        "line": 142,
        "fullcodeline": "skip_upload = 1;"
    },
    {
        "line": 165,
        "fullcodeline": "if (*tmp == '[') {"
    },
    {
        "line": 174,
        "fullcodeline": "if (c < 0) {"
    },
    {
        "line": 250,
        "fullcodeline": "if (php_rfc1867_callback(&s_rfc1867_data->rfc1867ApcData,"
    },
    {
        "line": 291,
        "fullcodeline": "\"file %s\", strlen(filename) > 0 ? filename : \"\");"
    },
    {
        "line": 316,
        "fullcodeline": "if (cancel_upload != UPLOAD_ERROR_E) { /* file creation failed */"
    },
    {
        "line": 370,
        "fullcodeline": "String val(filename, strlen(filename), CopyString);"
    },
    {
        "line": 371,
        "fullcodeline": "safe_php_register_variable(lbuf, val, globals, 0);"
    },
    {
        "line": 400,
        "fullcodeline": "*s = '\\0';"
    },
    {
        "line": 77,
        "fullcodeline": "if (!strcasecmp(key, \"name\")) {"
    },
    {
        "line": 81,
        "fullcodeline": "param = php_ap_getword_conf(&pair);"
    },
    {
        "line": 166,
        "fullcodeline": "c++;"
    },
    {
        "line": 175,
        "fullcodeline": "skip_upload = 1;"
    },
    {
        "line": 212,
        "fullcodeline": "if (!temp_filename.empty()) {"
    },
    {
        "line": 254,
        "fullcodeline": "cancel_upload = UPLOAD_ERROR_X;"
    },
    {
        "line": 267,
        "fullcodeline": "} else if (max_file_size && (total_bytes > max_file_size)) {"
    },
    {
        "line": 213,
        "fullcodeline": "if (cancel_upload != UPLOAD_ERROR_E) { /* file creation failed */"
    },
    {
        "line": 268,
        "fullcodeline": "Logger::Verbose(\"MAX_FILE_SIZE of %d bytes exceeded - \""
    },
    {
        "line": 271,
        "fullcodeline": "cancel_upload = UPLOAD_ERROR_B;"
    },
    {
        "line": 317,
        "fullcodeline": "unlink(temp_filename.c_str());"
    },
    {
        "line": 167,
        "fullcodeline": "} else if (*tmp == ']') {"
    },
    {
        "line": 214,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 82,
        "fullcodeline": "} else if (!strcasecmp(key, \"filename\")) {"
    },
    {
        "line": 86,
        "fullcodeline": "filename = php_ap_getword_conf(&pair);"
    },
    {
        "line": 168,
        "fullcodeline": "c--;"
    },
    {
        "line": 215,
        "fullcodeline": "unlink(temp_filename.c_str());"
    },
    {
        "line": 272,
        "fullcodeline": "} else if (blen > 0) {"
    },
    {
        "line": 169,
        "fullcodeline": "if (tmp[1] && tmp[1] != '[') {"
    },
    {
        "line": 274,
        "fullcodeline": "wlen = folly::writeFull(fd, buff, blen);"
    },
    {
        "line": 283,
        "fullcodeline": "offset += wlen;"
    },
    {
        "line": 170,
        "fullcodeline": "skip_upload = 1;"
    },
    {
        "line": 275,
        "fullcodeline": "if (wlen < blen) {"
    },
    {
        "line": 276,
        "fullcodeline": "Logger::Verbose(\"Only %zd bytes were written, expected to \""
    },
    {
        "line": 278,
        "fullcodeline": "cancel_upload = UPLOAD_ERROR_F;"
    },
    {
        "line": 280,
        "fullcodeline": "total_bytes += wlen;"
    }
]