[
    {
        "line": 5,
        "fullcodeline": "struct drm_clip_rect *clips = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "struct drm_mode_fb_dirty_cmd *r = data;"
    },
    {
        "line": 11,
        "fullcodeline": "int ret = 0;"
    },
    {
        "line": 16,
        "fullcodeline": "mutex_lock(&dev->mode_config.mutex);"
    },
    {
        "line": 17,
        "fullcodeline": "obj = drm_mode_object_find(dev, r->fb_id, DRM_MODE_OBJECT_FB);"
    },
    {
        "line": 23,
        "fullcodeline": "fb = obj_to_fb(obj);"
    },
    {
        "line": 25,
        "fullcodeline": "num_clips = r->num_clips;"
    },
    {
        "line": 26,
        "fullcodeline": "clips_ptr = (struct drm_clip_rect *)(unsigned long)r->clips_ptr;"
    },
    {
        "line": 33,
        "fullcodeline": "flags = DRM_MODE_FB_DIRTY_FLAGS & r->flags;"
    },
    {
        "line": 13,
        "fullcodeline": "if (!drm_core_check_feature(dev, DRIVER_MODESET))"
    },
    {
        "line": 18,
        "fullcodeline": "if (!obj) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (num_clips && clips_ptr) {"
    },
    {
        "line": 20,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 28,
        "fullcodeline": "if (!num_clips != !clips_ptr) {"
    },
    {
        "line": 29,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 36,
        "fullcodeline": "if (flags & DRM_MODE_FB_DIRTY_ANNOTATE_COPY && (num_clips % 2)) {"
    },
    {
        "line": 37,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 42,
        "fullcodeline": "clips = kzalloc(num_clips * sizeof(*clips), GFP_KERNEL);"
    },
    {
        "line": 57,
        "fullcodeline": "ret = fb->funcs->dirty(fb, file_priv, flags, r->color,"
    },
    {
        "line": 14,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 43,
        "fullcodeline": "if (!clips) {"
    },
    {
        "line": 48,
        "fullcodeline": "ret = copy_from_user(clips, clips_ptr,"
    },
    {
        "line": 60,
        "fullcodeline": "ret = -ENOSYS;"
    },
    {
        "line": 44,
        "fullcodeline": "ret = -ENOMEM;"
    },
    {
        "line": 49,
        "fullcodeline": "num_clips * sizeof(*clips));"
    },
    {
        "line": 51,
        "fullcodeline": "ret = -EFAULT;"
    }
]