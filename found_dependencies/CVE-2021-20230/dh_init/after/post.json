[
    {
        "line": 2,
        "fullcodeline": "DH *dh=NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "char description[128];"
    },
    {
        "line": 5,
        "fullcodeline": "STACK_OF(SSL_CIPHER) *ciphers;"
    },
    {
        "line": 7,
        "fullcodeline": "section->option.dh_temp_params=0; /* disable by default */"
    },
    {
        "line": 14,
        "fullcodeline": "ciphers=SSL_CTX_get_ciphers(section->ctx);"
    },
    {
        "line": 17,
        "fullcodeline": "n=sk_SSL_CIPHER_num(ciphers);"
    },
    {
        "line": 34,
        "fullcodeline": "s_log(LOG_DEBUG, \"DH initialization\");"
    },
    {
        "line": 46,
        "fullcodeline": "SSL_CTX_set_tmp_dh(section->ctx, dh_params);"
    },
    {
        "line": 47,
        "fullcodeline": "CRYPTO_THREAD_unlock(stunnel_locks[LOCK_DH]);"
    },
    {
        "line": 48,
        "fullcodeline": "dh_temp_params=1; /* generate temporary DH parameters in cron */"
    },
    {
        "line": 49,
        "fullcodeline": "section->option.dh_temp_params=1; /* update this section in cron */"
    },
    {
        "line": 50,
        "fullcodeline": "s_log(LOG_INFO, \"Using dynamic DH parameters\");"
    },
    {
        "line": 15,
        "fullcodeline": "if(!ciphers)"
    },
    {
        "line": 18,
        "fullcodeline": "for(i=0; i<n; ++i) {"
    },
    {
        "line": 29,
        "fullcodeline": "if(i==n) { /* no DH ciphers found */"
    },
    {
        "line": 36,
        "fullcodeline": "if(!section->engine) /* cert is a file and not an identifier */"
    },
    {
        "line": 11,
        "fullcodeline": "s_log(LOG_INFO, \"DH initialization skipped: client section\");"
    },
    {
        "line": 19,
        "fullcodeline": "*description='\\0';"
    },
    {
        "line": 20,
        "fullcodeline": "SSL_CIPHER_description(sk_SSL_CIPHER_value(ciphers, i),"
    },
    {
        "line": 30,
        "fullcodeline": "s_log(LOG_INFO, \"DH initialization skipped: no DH ciphersuites\");"
    },
    {
        "line": 38,
        "fullcodeline": "dh=dh_read(section->cert);"
    },
    {
        "line": 40,
        "fullcodeline": "SSL_CTX_set_tmp_dh(section->ctx, dh);"
    },
    {
        "line": 41,
        "fullcodeline": "s_log(LOG_INFO, \"%d-bit DH parameters loaded\", 8*DH_size(dh));"
    },
    {
        "line": 42,
        "fullcodeline": "DH_free(dh);"
    },
    {
        "line": 23,
        "fullcodeline": "if(strstr(description, \" Kx=DH\")) {"
    },
    {
        "line": 24,
        "fullcodeline": "s_log(LOG_INFO, \"DH initialization needed for %s\","
    },
    {
        "line": 25,
        "fullcodeline": "SSL_CIPHER_get_name(sk_SSL_CIPHER_value(ciphers, i)));"
    }
]