[
    {
        "line": 7,
        "fullcodeline": "int watchdog=0; /* a counter to detect an infinite loop */"
    },
    {
        "line": 11,
        "fullcodeline": "int sock_open_rd=1, sock_open_wr=1;"
    },
    {
        "line": 13,
        "fullcodeline": "int shutdown_wants_read=0, shutdown_wants_write=0;"
    },
    {
        "line": 14,
        "fullcodeline": "int read_wants_read=0, read_wants_write=0;"
    },
    {
        "line": 15,
        "fullcodeline": "int write_wants_read=0, write_wants_write=0;"
    },
    {
        "line": 24,
        "fullcodeline": "c->sock_ptr=c->ssl_ptr=0;"
    },
    {
        "line": 486,
        "fullcodeline": "} while(sock_open_wr || !(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN) ||"
    },
    {
        "line": 28,
        "fullcodeline": "read_wants_read|=!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN)"
    },
    {
        "line": 30,
        "fullcodeline": "write_wants_write|=!(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN)"
    },
    {
        "line": 34,
        "fullcodeline": "s_poll_init(c->fds, 0); /* initialize the structure */"
    },
    {
        "line": 51,
        "fullcodeline": "pending=SSL_pending(c->ssl);"
    },
    {
        "line": 68,
        "fullcodeline": "err=s_poll_wait(c->fds, timeout, 0);"
    },
    {
        "line": 92,
        "fullcodeline": "sock_can_rd=s_poll_canread(c->fds, c->sock_rfd->fd);"
    },
    {
        "line": 93,
        "fullcodeline": "sock_can_wr=s_poll_canwrite(c->fds, c->sock_wfd->fd);"
    },
    {
        "line": 94,
        "fullcodeline": "ssl_can_rd=s_poll_canread(c->fds, c->ssl_rfd->fd);"
    },
    {
        "line": 95,
        "fullcodeline": "ssl_can_wr=s_poll_canwrite(c->fds, c->ssl_wfd->fd);"
    },
    {
        "line": 253,
        "fullcodeline": "read_wants_read|=!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN)"
    },
    {
        "line": 255,
        "fullcodeline": "write_wants_write|=!(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN)"
    },
    {
        "line": 42,
        "fullcodeline": "if(SSL_get_shutdown(c->ssl)!="
    },
    {
        "line": 58,
        "fullcodeline": "if(read_wants_read && pending) {"
    },
    {
        "line": 98,
        "fullcodeline": "if(c->sock_rfd->fd==c->sock_wfd->fd) {"
    },
    {
        "line": 117,
        "fullcodeline": "if(c->ssl_rfd->fd==c->ssl_wfd->fd) {"
    },
    {
        "line": 139,
        "fullcodeline": "if(!(sock_can_rd || sock_can_wr || ssl_can_rd || ssl_can_wr)) {"
    },
    {
        "line": 164,
        "fullcodeline": "if(c->reneg_state==RENEG_DETECTED && !c->opt->option.renegotiation) {"
    },
    {
        "line": 170,
        "fullcodeline": "if(shutdown_wants_read || shutdown_wants_write) {"
    },
    {
        "line": 211,
        "fullcodeline": "if(sock_open_wr && sock_can_wr) {"
    },
    {
        "line": 232,
        "fullcodeline": "if(sock_open_rd && sock_can_rd) {"
    },
    {
        "line": 259,
        "fullcodeline": "if((write_wants_read && ssl_can_rd) ||"
    },
    {
        "line": 318,
        "fullcodeline": "if((read_wants_read && (ssl_can_rd || pending)) ||"
    },
    {
        "line": 381,
        "fullcodeline": "if(sock_open_rd && s_poll_rdhup(c->fds, c->sock_rfd->fd) &&"
    },
    {
        "line": 386,
        "fullcodeline": "if(sock_open_wr && s_poll_hup(c->fds, c->sock_wfd->fd)) {"
    },
    {
        "line": 397,
        "fullcodeline": "if(!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN) &&"
    },
    {
        "line": 406,
        "fullcodeline": "if(!(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN) &&"
    },
    {
        "line": 420,
        "fullcodeline": "if(sock_open_wr && SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN &&"
    },
    {
        "line": 433,
        "fullcodeline": "if(!(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN) && !sock_open_rd &&"
    },
    {
        "line": 450,
        "fullcodeline": "if(++watchdog>100) { /* loop executes without transferring any data */"
    },
    {
        "line": 29,
        "fullcodeline": "&& c->ssl_ptr<BUFFSIZE && !read_wants_write;"
    },
    {
        "line": 31,
        "fullcodeline": "&& c->sock_ptr && !write_wants_read;"
    },
    {
        "line": 38,
        "fullcodeline": "s_poll_add(c->fds, c->sock_rfd->fd, c->sock_ptr<BUFFSIZE, 0);"
    },
    {
        "line": 40,
        "fullcodeline": "s_poll_add(c->fds, c->sock_wfd->fd, 0, c->ssl_ptr>0);"
    },
    {
        "line": 43,
        "fullcodeline": "(SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN)) {"
    },
    {
        "line": 44,
        "fullcodeline": "s_poll_add(c->fds, c->ssl_rfd->fd,"
    },
    {
        "line": 46,
        "fullcodeline": "s_poll_add(c->fds, c->ssl_wfd->fd, 0,"
    },
    {
        "line": 59,
        "fullcodeline": "timeout=0; /* process any buffered data without delay */"
    },
    {
        "line": 70,
        "fullcodeline": "case -1:"
    },
    {
        "line": 71,
        "fullcodeline": "sockerror(\"transfer: s_poll_wait\");"
    },
    {
        "line": 72,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 85,
        "fullcodeline": "s_log(LOG_ERR, \"transfer: s_poll_wait:\""
    },
    {
        "line": 87,
        "fullcodeline": "s_poll_dump(c->fds, LOG_DEBUG);"
    },
    {
        "line": 165,
        "fullcodeline": "s_log(LOG_ERR, \"Aborting due to renegotiation request\");"
    },
    {
        "line": 166,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 171,
        "fullcodeline": "num=SSL_shutdown(c->ssl); /* send close_notify alert */"
    },
    {
        "line": 212,
        "fullcodeline": "num=writesocket(c->sock_wfd->fd, c->ssl_buff, c->ssl_ptr);"
    },
    {
        "line": 233,
        "fullcodeline": "num=readsocket(c->sock_rfd->fd,"
    },
    {
        "line": 254,
        "fullcodeline": "&& c->ssl_ptr<BUFFSIZE && !read_wants_write;"
    },
    {
        "line": 256,
        "fullcodeline": "&& c->sock_ptr && !write_wants_read;"
    },
    {
        "line": 260,
        "fullcodeline": "(write_wants_write && ssl_can_wr)) {"
    },
    {
        "line": 261,
        "fullcodeline": "write_wants_read=0;"
    },
    {
        "line": 262,
        "fullcodeline": "write_wants_write=0;"
    },
    {
        "line": 263,
        "fullcodeline": "num=SSL_write(c->ssl, c->sock_buff, (int)(c->sock_ptr));"
    },
    {
        "line": 321,
        "fullcodeline": "(read_wants_write && ssl_can_wr)) {"
    },
    {
        "line": 322,
        "fullcodeline": "read_wants_read=0;"
    },
    {
        "line": 323,
        "fullcodeline": "read_wants_write=0;"
    },
    {
        "line": 324,
        "fullcodeline": "num=SSL_read(c->ssl, c->ssl_buff+c->ssl_ptr, (int)(BUFFSIZE-c->ssl_ptr));"
    },
    {
        "line": 382,
        "fullcodeline": "(ioctlsocket(c->sock_rfd->fd, FIONREAD, &bytes) || !bytes)) {"
    },
    {
        "line": 383,
        "fullcodeline": "s_log(LOG_INFO, \"Read socket closed (read hangup)\");"
    },
    {
        "line": 384,
        "fullcodeline": "sock_open_rd=0;"
    },
    {
        "line": 393,
        "fullcodeline": "s_log(LOG_INFO, \"Write socket closed (write hangup)\");"
    },
    {
        "line": 394,
        "fullcodeline": "sock_open_wr=0;"
    },
    {
        "line": 399,
        "fullcodeline": "(ioctlsocket(c->ssl_rfd->fd, FIONREAD, &bytes) || !bytes)) {"
    },
    {
        "line": 402,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (read hangup)\");"
    },
    {
        "line": 403,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 407,
        "fullcodeline": "s_poll_hup(c->fds, c->ssl_wfd->fd)) {"
    },
    {
        "line": 414,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (write hangup)\");"
    },
    {
        "line": 415,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 421,
        "fullcodeline": "!c->ssl_ptr) {"
    },
    {
        "line": 422,
        "fullcodeline": "sock_open_wr=0; /* no further write allowed */"
    },
    {
        "line": 434,
        "fullcodeline": "!c->sock_ptr && !write_wants_write) {"
    },
    {
        "line": 451,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 453,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 455,
        "fullcodeline": "stunnel_info(LOG_ERR);"
    },
    {
        "line": 461,
        "fullcodeline": "s_log(LOG_ERR, \"protocol=%s, SSL_pending=%d\","
    },
    {
        "line": 464,
        "fullcodeline": "s_log(LOG_ERR, \"sock_open_rd=%s, sock_open_wr=%s\","
    },
    {
        "line": 466,
        "fullcodeline": "s_log(LOG_ERR, \"SSL_RECEIVED_SHUTDOWN=%s, SSL_SENT_SHUTDOWN=%s\","
    },
    {
        "line": 469,
        "fullcodeline": "s_log(LOG_ERR, \"sock_can_rd=%s, sock_can_wr=%s\","
    },
    {
        "line": 471,
        "fullcodeline": "s_log(LOG_ERR, \"ssl_can_rd=%s, ssl_can_wr=%s\","
    },
    {
        "line": 473,
        "fullcodeline": "s_log(LOG_ERR, \"read_wants_read=%s, read_wants_write=%s\","
    },
    {
        "line": 475,
        "fullcodeline": "s_log(LOG_ERR, \"write_wants_read=%s, write_wants_write=%s\","
    },
    {
        "line": 477,
        "fullcodeline": "s_log(LOG_ERR, \"shutdown_wants_read=%s, shutdown_wants_write=%s\","
    },
    {
        "line": 480,
        "fullcodeline": "s_log(LOG_ERR, \"socket input buffer: %ld byte(s), \""
    },
    {
        "line": 483,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 45,
        "fullcodeline": "read_wants_read || write_wants_read || shutdown_wants_read, 0);"
    },
    {
        "line": 47,
        "fullcodeline": "read_wants_write || write_wants_write || shutdown_wants_write);"
    },
    {
        "line": 74,
        "fullcodeline": "if(read_wants_read && pending)"
    },
    {
        "line": 76,
        "fullcodeline": "if((sock_open_rd &&"
    },
    {
        "line": 99,
        "fullcodeline": "if((sock_can_rd || sock_can_wr) &&"
    },
    {
        "line": 118,
        "fullcodeline": "if((ssl_can_rd || ssl_can_wr) &&"
    },
    {
        "line": 140,
        "fullcodeline": "if(s_poll_hup(c->fds, c->sock_rfd->fd) ||"
    },
    {
        "line": 172,
        "fullcodeline": "if(num<0) /* -1 - not completed */"
    },
    {
        "line": 264,
        "fullcodeline": "switch(err=SSL_get_error(c->ssl, (int)num)) {"
    },
    {
        "line": 325,
        "fullcodeline": "switch(err=SSL_get_error(c->ssl, (int)num)) {"
    },
    {
        "line": 398,
        "fullcodeline": "s_poll_rdhup(c->fds, c->ssl_rfd->fd) &&"
    },
    {
        "line": 404,
        "fullcodeline": "SSL_get_shutdown(c->ssl)|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 408,
        "fullcodeline": "if(c->sock_ptr || write_wants_write) {"
    },
    {
        "line": 416,
        "fullcodeline": "SSL_get_shutdown(c->ssl)|SSL_SENT_SHUTDOWN);"
    },
    {
        "line": 435,
        "fullcodeline": "if(SSL_version(c->ssl)!=SSL2_VERSION) {"
    },
    {
        "line": 462,
        "fullcodeline": "SSL_get_version(c->ssl), SSL_pending(c->ssl));"
    },
    {
        "line": 465,
        "fullcodeline": "sock_open_rd ? \"Y\" : \"n\", sock_open_wr ? \"Y\" : \"n\");"
    },
    {
        "line": 467,
        "fullcodeline": "(SSL_get_shutdown(c->ssl) & SSL_RECEIVED_SHUTDOWN) ? \"Y\" : \"n\","
    },
    {
        "line": 468,
        "fullcodeline": "(SSL_get_shutdown(c->ssl) & SSL_SENT_SHUTDOWN) ? \"Y\" : \"n\");"
    },
    {
        "line": 470,
        "fullcodeline": "sock_can_rd ? \"Y\" : \"n\", sock_can_wr ? \"Y\" : \"n\");"
    },
    {
        "line": 472,
        "fullcodeline": "ssl_can_rd ? \"Y\" : \"n\", ssl_can_wr ? \"Y\" : \"n\");"
    },
    {
        "line": 474,
        "fullcodeline": "read_wants_read ? \"Y\" : \"n\", read_wants_write ? \"Y\" : \"n\");"
    },
    {
        "line": 476,
        "fullcodeline": "write_wants_read ? \"Y\" : \"n\", write_wants_write ? \"Y\" : \"n\");"
    },
    {
        "line": 478,
        "fullcodeline": "shutdown_wants_read ? \"Y\" : \"n\","
    },
    {
        "line": 479,
        "fullcodeline": "shutdown_wants_write ? \"Y\" : \"n\");"
    },
    {
        "line": 482,
        "fullcodeline": "(long)c->sock_ptr, (long)c->ssl_ptr);"
    },
    {
        "line": 60,
        "fullcodeline": "} else if((sock_open_rd && /* both peers open */"
    },
    {
        "line": 79,
        "fullcodeline": "s_log(LOG_INFO, \"transfer: s_poll_wait:\""
    },
    {
        "line": 81,
        "fullcodeline": "s_poll_dump(c->fds, LOG_DEBUG);"
    },
    {
        "line": 82,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 100,
        "fullcodeline": "s_poll_err(c->fds, c->sock_rfd->fd)) {"
    },
    {
        "line": 101,
        "fullcodeline": "err=get_socket_error(c->sock_rfd->fd);"
    },
    {
        "line": 106,
        "fullcodeline": "if(sock_can_rd && s_poll_err(c->fds, c->sock_rfd->fd)) {"
    },
    {
        "line": 111,
        "fullcodeline": "if(sock_can_wr && s_poll_err(c->fds, c->sock_wfd->fd)) {"
    },
    {
        "line": 119,
        "fullcodeline": "s_poll_err(c->fds, c->ssl_rfd->fd)) {"
    },
    {
        "line": 120,
        "fullcodeline": "err=get_socket_error(c->ssl_rfd->fd);"
    },
    {
        "line": 125,
        "fullcodeline": "if(ssl_can_rd && s_poll_err(c->fds, c->ssl_rfd->fd)) {"
    },
    {
        "line": 130,
        "fullcodeline": "if(c->ssl_rfd->fd!=c->ssl_wfd->fd &&"
    },
    {
        "line": 141,
        "fullcodeline": "s_poll_hup(c->fds, c->sock_wfd->fd)) {"
    },
    {
        "line": 148,
        "fullcodeline": "s_log(LOG_INFO, \"Socket closed (HUP)\");"
    },
    {
        "line": 149,
        "fullcodeline": "sock_open_rd=sock_open_wr=0;"
    },
    {
        "line": 173,
        "fullcodeline": "err=SSL_get_error(c->ssl, (int)num);"
    },
    {
        "line": 178,
        "fullcodeline": "s_log(LOG_INFO, \"SSL_shutdown successfully sent close_notify alert\");"
    },
    {
        "line": 179,
        "fullcodeline": "shutdown_wants_read=shutdown_wants_write=0;"
    },
    {
        "line": 184,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 185,
        "fullcodeline": "shutdown_wants_read=shutdown_wants_write=0;"
    },
    {
        "line": 188,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 189,
        "fullcodeline": "shutdown_wants_read=shutdown_wants_write=0;"
    },
    {
        "line": 192,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_shutdown returned WANT_WRITE: retrying\");"
    },
    {
        "line": 193,
        "fullcodeline": "shutdown_wants_read=0;"
    },
    {
        "line": 194,
        "fullcodeline": "shutdown_wants_write=1;"
    },
    {
        "line": 197,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_shutdown returned WANT_READ: retrying\");"
    },
    {
        "line": 198,
        "fullcodeline": "shutdown_wants_read=1;"
    },
    {
        "line": 199,
        "fullcodeline": "shutdown_wants_write=0;"
    },
    {
        "line": 202,
        "fullcodeline": "sslerror(\"SSL_shutdown\");"
    },
    {
        "line": 203,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 205,
        "fullcodeline": "s_log(LOG_ERR, \"SSL_shutdown/SSL_get_error returned %d\", err);"
    },
    {
        "line": 206,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 214,
        "fullcodeline": "case -1: /* error */"
    },
    {
        "line": 217,
        "fullcodeline": "sock_open_rd=sock_open_wr=0;"
    },
    {
        "line": 220,
        "fullcodeline": "s_log(LOG_DEBUG, \"writesocket returned 0\");"
    },
    {
        "line": 223,
        "fullcodeline": "memmove(c->ssl_buff, c->ssl_buff+num, c->ssl_ptr-(size_t)num);"
    },
    {
        "line": 224,
        "fullcodeline": "c->ssl_ptr-=(size_t)num;"
    },
    {
        "line": 225,
        "fullcodeline": "memset(c->ssl_buff+c->ssl_ptr, 0, (size_t)num); /* paranoia */"
    },
    {
        "line": 226,
        "fullcodeline": "c->sock_bytes+=(size_t)num;"
    },
    {
        "line": 227,
        "fullcodeline": "watchdog=0; /* reset the watchdog */"
    },
    {
        "line": 234,
        "fullcodeline": "c->sock_buff+c->sock_ptr, BUFFSIZE-c->sock_ptr);"
    },
    {
        "line": 236,
        "fullcodeline": "case -1:"
    },
    {
        "line": 239,
        "fullcodeline": "sock_open_rd=sock_open_wr=0;"
    },
    {
        "line": 242,
        "fullcodeline": "s_log(LOG_INFO, \"Read socket closed (readsocket)\");"
    },
    {
        "line": 243,
        "fullcodeline": "sock_open_rd=0;"
    },
    {
        "line": 246,
        "fullcodeline": "c->sock_ptr+=(size_t)num;"
    },
    {
        "line": 247,
        "fullcodeline": "watchdog=0; /* reset the watchdog */"
    },
    {
        "line": 270,
        "fullcodeline": "memmove(c->sock_buff, c->sock_buff+num,"
    },
    {
        "line": 272,
        "fullcodeline": "c->sock_ptr-=(size_t)num;"
    },
    {
        "line": 273,
        "fullcodeline": "memset(c->sock_buff+c->sock_ptr, 0, (size_t)num); /* paranoia */"
    },
    {
        "line": 274,
        "fullcodeline": "c->ssl_bytes+=(size_t)num;"
    },
    {
        "line": 275,
        "fullcodeline": "watchdog=0; /* reset the watchdog */"
    },
    {
        "line": 278,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_write returned WANT_WRITE: retrying\");"
    },
    {
        "line": 279,
        "fullcodeline": "write_wants_write=1;"
    },
    {
        "line": 282,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_write returned WANT_READ: retrying\");"
    },
    {
        "line": 283,
        "fullcodeline": "write_wants_read=1;"
    },
    {
        "line": 286,
        "fullcodeline": "s_log(LOG_DEBUG,"
    },
    {
        "line": 300,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (SSL_write)\");"
    },
    {
        "line": 301,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 304,
        "fullcodeline": "s_log(LOG_INFO, \"TLS closed (SSL_write)\");"
    },
    {
        "line": 309,
        "fullcodeline": "sslerror(\"SSL_write\");"
    },
    {
        "line": 310,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 312,
        "fullcodeline": "s_log(LOG_ERR, \"SSL_write/SSL_get_error returned %d\", err);"
    },
    {
        "line": 313,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 331,
        "fullcodeline": "c->ssl_ptr+=(size_t)num;"
    },
    {
        "line": 332,
        "fullcodeline": "watchdog=0; /* reset the watchdog */"
    },
    {
        "line": 335,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_read returned WANT_WRITE: retrying\");"
    },
    {
        "line": 336,
        "fullcodeline": "read_wants_write=1;"
    },
    {
        "line": 342,
        "fullcodeline": "read_wants_read=1;"
    },
    {
        "line": 345,
        "fullcodeline": "s_log(LOG_DEBUG,"
    },
    {
        "line": 359,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (SSL_read)\");"
    },
    {
        "line": 360,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 364,
        "fullcodeline": "s_log(LOG_INFO, \"TLS closed (SSL_read)\");"
    },
    {
        "line": 370,
        "fullcodeline": "sslerror(\"SSL_read\");"
    },
    {
        "line": 371,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 373,
        "fullcodeline": "s_log(LOG_ERR, \"SSL_read/SSL_get_error returned %d\", err);"
    },
    {
        "line": 374,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 388,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 391,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 409,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 412,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 424,
        "fullcodeline": "s_log(LOG_DEBUG, \"Closing the file descriptor\");"
    },
    {
        "line": 425,
        "fullcodeline": "sock_open_rd=0; /* file descriptor is ready to be closed */"
    },
    {
        "line": 436,
        "fullcodeline": "s_log(LOG_DEBUG, \"Sending close_notify alert\");"
    },
    {
        "line": 437,
        "fullcodeline": "shutdown_wants_write=1;"
    },
    {
        "line": 107,
        "fullcodeline": "err=get_socket_error(c->sock_rfd->fd);"
    },
    {
        "line": 112,
        "fullcodeline": "err=get_socket_error(c->sock_wfd->fd);"
    },
    {
        "line": 126,
        "fullcodeline": "err=get_socket_error(c->ssl_rfd->fd);"
    },
    {
        "line": 131,
        "fullcodeline": "ssl_can_wr && s_poll_err(c->fds, c->ssl_wfd->fd)) {"
    },
    {
        "line": 132,
        "fullcodeline": "err=get_socket_error(c->ssl_wfd->fd);"
    },
    {
        "line": 175,
        "fullcodeline": "err=SSL_ERROR_NONE;"
    },
    {
        "line": 182,
        "fullcodeline": "if(parse_socket_error(c, \"SSL_shutdown\"))"
    },
    {
        "line": 215,
        "fullcodeline": "if(parse_socket_error(c, \"writesocket\"))"
    },
    {
        "line": 237,
        "fullcodeline": "if(parse_socket_error(c, \"readsocket\"))"
    },
    {
        "line": 266,
        "fullcodeline": "if(num==0) { /* nothing was written: ignore */"
    },
    {
        "line": 271,
        "fullcodeline": "c->sock_ptr-(size_t)num);"
    },
    {
        "line": 290,
        "fullcodeline": "if(num && parse_socket_error(c, \"SSL_write\"))"
    },
    {
        "line": 305,
        "fullcodeline": "if(SSL_version(c->ssl)==SSL2_VERSION)"
    },
    {
        "line": 327,
        "fullcodeline": "if(num==0) { /* nothing was read: ignore */"
    },
    {
        "line": 349,
        "fullcodeline": "if(num && parse_socket_error(c, \"SSL_read\"))"
    },
    {
        "line": 353,
        "fullcodeline": "if(c->sock_ptr || write_wants_write) {"
    },
    {
        "line": 361,
        "fullcodeline": "SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 365,
        "fullcodeline": "if(SSL_version(c->ssl)==SSL2_VERSION)"
    },
    {
        "line": 390,
        "fullcodeline": "(long)c->ssl_ptr);"
    },
    {
        "line": 411,
        "fullcodeline": "(long)c->sock_ptr);"
    },
    {
        "line": 439,
        "fullcodeline": "s_log(LOG_DEBUG, \"Closing SSLv2 socket\");"
    },
    {
        "line": 445,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 77,
        "fullcodeline": "!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN)) ||"
    },
    {
        "line": 103,
        "fullcodeline": "log_error(LOG_INFO, err, \"socket fd\");"
    },
    {
        "line": 122,
        "fullcodeline": "log_error(LOG_INFO, err, \"TLS fd\");"
    },
    {
        "line": 143,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 146,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 150,
        "fullcodeline": "} else if(s_poll_hup(c->fds, c->ssl_rfd->fd) ||"
    },
    {
        "line": 267,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_write returned 0\");"
    },
    {
        "line": 295,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 298,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 306,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 328,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_read returned 0\");"
    },
    {
        "line": 354,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 357,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 366,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 426,
        "fullcodeline": "} else if(!shutdown(c->sock_wfd->fd, SHUT_WR)) { /* send TCP FIN */"
    },
    {
        "line": 61,
        "fullcodeline": "!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN)) ||"
    },
    {
        "line": 109,
        "fullcodeline": "log_error(LOG_INFO, err, \"socket rfd\");"
    },
    {
        "line": 114,
        "fullcodeline": "log_error(LOG_INFO, err, \"socket wfd\");"
    },
    {
        "line": 128,
        "fullcodeline": "log_error(LOG_INFO, err, \"TLS rfd\");"
    },
    {
        "line": 134,
        "fullcodeline": "log_error(LOG_INFO, err, \"TLS wfd\");"
    },
    {
        "line": 145,
        "fullcodeline": "(long)c->ssl_ptr);"
    },
    {
        "line": 151,
        "fullcodeline": "s_poll_hup(c->fds, c->ssl_wfd->fd)) {"
    },
    {
        "line": 158,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (HUP)\");"
    },
    {
        "line": 159,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 297,
        "fullcodeline": "(long)c->sock_ptr);"
    },
    {
        "line": 356,
        "fullcodeline": "(long)c->sock_ptr);"
    },
    {
        "line": 367,
        "fullcodeline": "SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 427,
        "fullcodeline": "s_log(LOG_DEBUG, \"Sent socket write shutdown\");"
    },
    {
        "line": 441,
        "fullcodeline": "shutdown(c->ssl_rfd->fd, SHUT_RD); /* notify the kernel */"
    },
    {
        "line": 443,
        "fullcodeline": "shutdown(c->ssl_wfd->fd, SHUT_WR); /* send TCP FIN */"
    },
    {
        "line": 160,
        "fullcodeline": "SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 429,
        "fullcodeline": "s_log(LOG_DEBUG, \"Failed to send socket write shutdown\");"
    },
    {
        "line": 430,
        "fullcodeline": "sock_open_rd=0; /* file descriptor is ready to be closed */"
    },
    {
        "line": 153,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 156,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 155,
        "fullcodeline": "(long)c->sock_ptr);"
    }
]