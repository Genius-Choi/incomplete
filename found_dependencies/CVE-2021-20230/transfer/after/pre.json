[
    {
        "line": 7,
        "fullcodeline": "int watchdog=0; /* a counter to detect an infinite loop */"
    },
    {
        "line": 10,
        "fullcodeline": "int sock_open_rd=1, sock_open_wr=1;"
    },
    {
        "line": 12,
        "fullcodeline": "int shutdown_wants_read=0, shutdown_wants_write=0;"
    },
    {
        "line": 13,
        "fullcodeline": "int read_wants_read=0, read_wants_write=0;"
    },
    {
        "line": 14,
        "fullcodeline": "int write_wants_read=0, write_wants_write=0;"
    },
    {
        "line": 23,
        "fullcodeline": "c->sock_ptr=c->ssl_ptr=0;"
    },
    {
        "line": 482,
        "fullcodeline": "} while(sock_open_wr || !(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN) ||"
    },
    {
        "line": 27,
        "fullcodeline": "read_wants_read|=!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN)"
    },
    {
        "line": 29,
        "fullcodeline": "write_wants_write|=!(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN)"
    },
    {
        "line": 33,
        "fullcodeline": "s_poll_init(c->fds, 0); /* initialize the structure */"
    },
    {
        "line": 50,
        "fullcodeline": "pending=SSL_pending(c->ssl);"
    },
    {
        "line": 67,
        "fullcodeline": "err=s_poll_wait(c->fds, timeout, 0);"
    },
    {
        "line": 91,
        "fullcodeline": "sock_can_rd=s_poll_canread(c->fds, c->sock_rfd->fd);"
    },
    {
        "line": 92,
        "fullcodeline": "sock_can_wr=s_poll_canwrite(c->fds, c->sock_wfd->fd);"
    },
    {
        "line": 93,
        "fullcodeline": "ssl_can_rd=s_poll_canread(c->fds, c->ssl_rfd->fd);"
    },
    {
        "line": 94,
        "fullcodeline": "ssl_can_wr=s_poll_canwrite(c->fds, c->ssl_wfd->fd);"
    },
    {
        "line": 252,
        "fullcodeline": "read_wants_read|=!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN)"
    },
    {
        "line": 254,
        "fullcodeline": "write_wants_write|=!(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN)"
    },
    {
        "line": 41,
        "fullcodeline": "if(SSL_get_shutdown(c->ssl)!="
    },
    {
        "line": 57,
        "fullcodeline": "if(read_wants_read && pending) {"
    },
    {
        "line": 97,
        "fullcodeline": "if(c->sock_rfd->fd==c->sock_wfd->fd) {"
    },
    {
        "line": 116,
        "fullcodeline": "if(c->ssl_rfd->fd==c->ssl_wfd->fd) {"
    },
    {
        "line": 138,
        "fullcodeline": "if(!(sock_can_rd || sock_can_wr || ssl_can_rd || ssl_can_wr)) {"
    },
    {
        "line": 163,
        "fullcodeline": "if(c->reneg_state==RENEG_DETECTED && !c->opt->option.renegotiation) {"
    },
    {
        "line": 169,
        "fullcodeline": "if(shutdown_wants_read || shutdown_wants_write) {"
    },
    {
        "line": 210,
        "fullcodeline": "if(sock_open_wr && sock_can_wr) {"
    },
    {
        "line": 231,
        "fullcodeline": "if(sock_open_rd && sock_can_rd) {"
    },
    {
        "line": 258,
        "fullcodeline": "if((write_wants_read && ssl_can_rd) ||"
    },
    {
        "line": 314,
        "fullcodeline": "if((read_wants_read && (ssl_can_rd || pending)) ||"
    },
    {
        "line": 377,
        "fullcodeline": "if(sock_open_rd && s_poll_rdhup(c->fds, c->sock_rfd->fd) &&"
    },
    {
        "line": 382,
        "fullcodeline": "if(sock_open_wr && s_poll_hup(c->fds, c->sock_wfd->fd)) {"
    },
    {
        "line": 393,
        "fullcodeline": "if(!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN) &&"
    },
    {
        "line": 402,
        "fullcodeline": "if(!(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN) &&"
    },
    {
        "line": 416,
        "fullcodeline": "if(sock_open_wr && SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN &&"
    },
    {
        "line": 429,
        "fullcodeline": "if(!(SSL_get_shutdown(c->ssl)&SSL_SENT_SHUTDOWN) && !sock_open_rd &&"
    },
    {
        "line": 446,
        "fullcodeline": "if(++watchdog>100) { /* loop executes without transferring any data */"
    },
    {
        "line": 28,
        "fullcodeline": "&& c->ssl_ptr<BUFFSIZE && !read_wants_write;"
    },
    {
        "line": 30,
        "fullcodeline": "&& c->sock_ptr && !write_wants_read;"
    },
    {
        "line": 37,
        "fullcodeline": "s_poll_add(c->fds, c->sock_rfd->fd, c->sock_ptr<BUFFSIZE, 0);"
    },
    {
        "line": 39,
        "fullcodeline": "s_poll_add(c->fds, c->sock_wfd->fd, 0, c->ssl_ptr>0);"
    },
    {
        "line": 42,
        "fullcodeline": "(SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN)) {"
    },
    {
        "line": 43,
        "fullcodeline": "s_poll_add(c->fds, c->ssl_rfd->fd,"
    },
    {
        "line": 45,
        "fullcodeline": "s_poll_add(c->fds, c->ssl_wfd->fd, 0,"
    },
    {
        "line": 58,
        "fullcodeline": "timeout=0; /* process any buffered data without delay */"
    },
    {
        "line": 69,
        "fullcodeline": "case -1:"
    },
    {
        "line": 70,
        "fullcodeline": "sockerror(\"transfer: s_poll_wait\");"
    },
    {
        "line": 71,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 84,
        "fullcodeline": "s_log(LOG_ERR, \"transfer: s_poll_wait:\""
    },
    {
        "line": 86,
        "fullcodeline": "s_poll_dump(c->fds, LOG_DEBUG);"
    },
    {
        "line": 164,
        "fullcodeline": "s_log(LOG_ERR, \"Aborting due to renegotiation request\");"
    },
    {
        "line": 165,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 170,
        "fullcodeline": "int num=SSL_shutdown(c->ssl); /* send close_notify alert */"
    },
    {
        "line": 211,
        "fullcodeline": "ssize_t num=writesocket(c->sock_wfd->fd, c->ssl_buff, c->ssl_ptr);"
    },
    {
        "line": 232,
        "fullcodeline": "ssize_t num=readsocket(c->sock_rfd->fd,"
    },
    {
        "line": 253,
        "fullcodeline": "&& c->ssl_ptr<BUFFSIZE && !read_wants_write;"
    },
    {
        "line": 255,
        "fullcodeline": "&& c->sock_ptr && !write_wants_read;"
    },
    {
        "line": 259,
        "fullcodeline": "(write_wants_write && ssl_can_wr)) {"
    },
    {
        "line": 260,
        "fullcodeline": "int num=SSL_write(c->ssl, c->sock_buff, (int)(c->sock_ptr));"
    },
    {
        "line": 261,
        "fullcodeline": "write_wants_read=0;"
    },
    {
        "line": 262,
        "fullcodeline": "write_wants_write=0;"
    },
    {
        "line": 317,
        "fullcodeline": "(read_wants_write && ssl_can_wr)) {"
    },
    {
        "line": 318,
        "fullcodeline": "int num=SSL_read(c->ssl, c->ssl_buff+c->ssl_ptr, (int)(BUFFSIZE-c->ssl_ptr));"
    },
    {
        "line": 319,
        "fullcodeline": "read_wants_read=0;"
    },
    {
        "line": 320,
        "fullcodeline": "read_wants_write=0;"
    },
    {
        "line": 378,
        "fullcodeline": "(ioctlsocket(c->sock_rfd->fd, FIONREAD, &bytes) || !bytes)) {"
    },
    {
        "line": 379,
        "fullcodeline": "s_log(LOG_INFO, \"Read socket closed (read hangup)\");"
    },
    {
        "line": 380,
        "fullcodeline": "sock_open_rd=0;"
    },
    {
        "line": 389,
        "fullcodeline": "s_log(LOG_INFO, \"Write socket closed (write hangup)\");"
    },
    {
        "line": 390,
        "fullcodeline": "sock_open_wr=0;"
    },
    {
        "line": 395,
        "fullcodeline": "(ioctlsocket(c->ssl_rfd->fd, FIONREAD, &bytes) || !bytes)) {"
    },
    {
        "line": 398,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (read hangup)\");"
    },
    {
        "line": 399,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 403,
        "fullcodeline": "s_poll_hup(c->fds, c->ssl_wfd->fd)) {"
    },
    {
        "line": 410,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (write hangup)\");"
    },
    {
        "line": 411,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 417,
        "fullcodeline": "!c->ssl_ptr) {"
    },
    {
        "line": 418,
        "fullcodeline": "sock_open_wr=0; /* no further write allowed */"
    },
    {
        "line": 430,
        "fullcodeline": "!c->sock_ptr && !write_wants_write) {"
    },
    {
        "line": 447,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 449,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 451,
        "fullcodeline": "stunnel_info(LOG_ERR);"
    },
    {
        "line": 457,
        "fullcodeline": "s_log(LOG_ERR, \"protocol=%s, SSL_pending=%d\","
    },
    {
        "line": 460,
        "fullcodeline": "s_log(LOG_ERR, \"sock_open_rd=%s, sock_open_wr=%s\","
    },
    {
        "line": 462,
        "fullcodeline": "s_log(LOG_ERR, \"SSL_RECEIVED_SHUTDOWN=%s, SSL_SENT_SHUTDOWN=%s\","
    },
    {
        "line": 465,
        "fullcodeline": "s_log(LOG_ERR, \"sock_can_rd=%s, sock_can_wr=%s\","
    },
    {
        "line": 467,
        "fullcodeline": "s_log(LOG_ERR, \"ssl_can_rd=%s, ssl_can_wr=%s\","
    },
    {
        "line": 469,
        "fullcodeline": "s_log(LOG_ERR, \"read_wants_read=%s, read_wants_write=%s\","
    },
    {
        "line": 471,
        "fullcodeline": "s_log(LOG_ERR, \"write_wants_read=%s, write_wants_write=%s\","
    },
    {
        "line": 473,
        "fullcodeline": "s_log(LOG_ERR, \"shutdown_wants_read=%s, shutdown_wants_write=%s\","
    },
    {
        "line": 476,
        "fullcodeline": "s_log(LOG_ERR, \"socket input buffer: %ld byte(s), \""
    },
    {
        "line": 479,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 44,
        "fullcodeline": "read_wants_read || write_wants_read || shutdown_wants_read, 0);"
    },
    {
        "line": 46,
        "fullcodeline": "read_wants_write || write_wants_write || shutdown_wants_write);"
    },
    {
        "line": 73,
        "fullcodeline": "if(read_wants_read && pending)"
    },
    {
        "line": 75,
        "fullcodeline": "if((sock_open_rd &&"
    },
    {
        "line": 98,
        "fullcodeline": "if((sock_can_rd || sock_can_wr) &&"
    },
    {
        "line": 117,
        "fullcodeline": "if((ssl_can_rd || ssl_can_wr) &&"
    },
    {
        "line": 139,
        "fullcodeline": "if(s_poll_hup(c->fds, c->sock_rfd->fd) ||"
    },
    {
        "line": 171,
        "fullcodeline": "if(num<0) /* -1 - not completed */"
    },
    {
        "line": 263,
        "fullcodeline": "switch(err=SSL_get_error(c->ssl, num)) {"
    },
    {
        "line": 321,
        "fullcodeline": "switch(err=SSL_get_error(c->ssl, num)) {"
    },
    {
        "line": 394,
        "fullcodeline": "s_poll_rdhup(c->fds, c->ssl_rfd->fd) &&"
    },
    {
        "line": 400,
        "fullcodeline": "SSL_get_shutdown(c->ssl)|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 404,
        "fullcodeline": "if(c->sock_ptr || write_wants_write) {"
    },
    {
        "line": 412,
        "fullcodeline": "SSL_get_shutdown(c->ssl)|SSL_SENT_SHUTDOWN);"
    },
    {
        "line": 419,
        "fullcodeline": "if(!c->sock_wfd->is_socket) {"
    },
    {
        "line": 431,
        "fullcodeline": "if(SSL_version(c->ssl)!=SSL2_VERSION) {"
    },
    {
        "line": 458,
        "fullcodeline": "SSL_get_version(c->ssl), SSL_pending(c->ssl));"
    },
    {
        "line": 463,
        "fullcodeline": "(SSL_get_shutdown(c->ssl) & SSL_RECEIVED_SHUTDOWN) ? \"Y\" : \"n\","
    },
    {
        "line": 464,
        "fullcodeline": "(SSL_get_shutdown(c->ssl) & SSL_SENT_SHUTDOWN) ? \"Y\" : \"n\");"
    },
    {
        "line": 466,
        "fullcodeline": "sock_can_rd ? \"Y\" : \"n\", sock_can_wr ? \"Y\" : \"n\");"
    },
    {
        "line": 468,
        "fullcodeline": "ssl_can_rd ? \"Y\" : \"n\", ssl_can_wr ? \"Y\" : \"n\");"
    },
    {
        "line": 470,
        "fullcodeline": "read_wants_read ? \"Y\" : \"n\", read_wants_write ? \"Y\" : \"n\");"
    },
    {
        "line": 472,
        "fullcodeline": "write_wants_read ? \"Y\" : \"n\", write_wants_write ? \"Y\" : \"n\");"
    },
    {
        "line": 59,
        "fullcodeline": "} else if((sock_open_rd && /* both peers open */"
    },
    {
        "line": 78,
        "fullcodeline": "s_log(LOG_INFO, \"transfer: s_poll_wait:\""
    },
    {
        "line": 80,
        "fullcodeline": "s_poll_dump(c->fds, LOG_DEBUG);"
    },
    {
        "line": 81,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 99,
        "fullcodeline": "s_poll_err(c->fds, c->sock_rfd->fd)) {"
    },
    {
        "line": 100,
        "fullcodeline": "err=get_socket_error(c->sock_rfd->fd);"
    },
    {
        "line": 105,
        "fullcodeline": "if(sock_can_rd && s_poll_err(c->fds, c->sock_rfd->fd)) {"
    },
    {
        "line": 110,
        "fullcodeline": "if(sock_can_wr && s_poll_err(c->fds, c->sock_wfd->fd)) {"
    },
    {
        "line": 118,
        "fullcodeline": "s_poll_err(c->fds, c->ssl_rfd->fd)) {"
    },
    {
        "line": 119,
        "fullcodeline": "err=get_socket_error(c->ssl_rfd->fd);"
    },
    {
        "line": 124,
        "fullcodeline": "if(ssl_can_rd && s_poll_err(c->fds, c->ssl_rfd->fd)) {"
    },
    {
        "line": 129,
        "fullcodeline": "if(c->ssl_rfd->fd!=c->ssl_wfd->fd &&"
    },
    {
        "line": 140,
        "fullcodeline": "s_poll_hup(c->fds, c->sock_wfd->fd)) {"
    },
    {
        "line": 147,
        "fullcodeline": "s_log(LOG_INFO, \"Socket closed (HUP)\");"
    },
    {
        "line": 148,
        "fullcodeline": "sock_open_rd=sock_open_wr=0;"
    },
    {
        "line": 172,
        "fullcodeline": "err=SSL_get_error(c->ssl, num);"
    },
    {
        "line": 177,
        "fullcodeline": "s_log(LOG_INFO, \"SSL_shutdown successfully sent close_notify alert\");"
    },
    {
        "line": 178,
        "fullcodeline": "shutdown_wants_read=shutdown_wants_write=0;"
    },
    {
        "line": 181,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_shutdown returned WANT_WRITE: retrying\");"
    },
    {
        "line": 182,
        "fullcodeline": "shutdown_wants_read=0;"
    },
    {
        "line": 183,
        "fullcodeline": "shutdown_wants_write=1;"
    },
    {
        "line": 186,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_shutdown returned WANT_READ: retrying\");"
    },
    {
        "line": 187,
        "fullcodeline": "shutdown_wants_read=1;"
    },
    {
        "line": 188,
        "fullcodeline": "shutdown_wants_write=0;"
    },
    {
        "line": 191,
        "fullcodeline": "sslerror(\"SSL_shutdown\");"
    },
    {
        "line": 192,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 194,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 195,
        "fullcodeline": "shutdown_wants_read=shutdown_wants_write=0;"
    },
    {
        "line": 200,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 201,
        "fullcodeline": "shutdown_wants_read=shutdown_wants_write=0;"
    },
    {
        "line": 204,
        "fullcodeline": "s_log(LOG_ERR, \"SSL_shutdown/SSL_get_error returned %d\", err);"
    },
    {
        "line": 205,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 213,
        "fullcodeline": "case -1: /* error */"
    },
    {
        "line": 216,
        "fullcodeline": "sock_open_rd=sock_open_wr=0;"
    },
    {
        "line": 219,
        "fullcodeline": "s_log(LOG_DEBUG, \"writesocket returned 0\");"
    },
    {
        "line": 222,
        "fullcodeline": "memmove(c->ssl_buff, c->ssl_buff+num, c->ssl_ptr-(size_t)num);"
    },
    {
        "line": 223,
        "fullcodeline": "c->ssl_ptr-=(size_t)num;"
    },
    {
        "line": 224,
        "fullcodeline": "memset(c->ssl_buff+c->ssl_ptr, 0, (size_t)num); /* paranoia */"
    },
    {
        "line": 225,
        "fullcodeline": "c->sock_bytes+=(size_t)num;"
    },
    {
        "line": 226,
        "fullcodeline": "watchdog=0; /* reset the watchdog */"
    },
    {
        "line": 233,
        "fullcodeline": "c->sock_buff+c->sock_ptr, BUFFSIZE-c->sock_ptr);"
    },
    {
        "line": 235,
        "fullcodeline": "case -1:"
    },
    {
        "line": 238,
        "fullcodeline": "sock_open_rd=sock_open_wr=0;"
    },
    {
        "line": 241,
        "fullcodeline": "s_log(LOG_INFO, \"Read socket closed (readsocket)\");"
    },
    {
        "line": 242,
        "fullcodeline": "sock_open_rd=0;"
    },
    {
        "line": 245,
        "fullcodeline": "c->sock_ptr+=(size_t)num;"
    },
    {
        "line": 246,
        "fullcodeline": "watchdog=0; /* reset the watchdog */"
    },
    {
        "line": 269,
        "fullcodeline": "memmove(c->sock_buff, c->sock_buff+num,"
    },
    {
        "line": 271,
        "fullcodeline": "c->sock_ptr-=(size_t)num;"
    },
    {
        "line": 272,
        "fullcodeline": "memset(c->sock_buff+c->sock_ptr, 0, (size_t)num); /* paranoia */"
    },
    {
        "line": 273,
        "fullcodeline": "c->ssl_bytes+=(size_t)num;"
    },
    {
        "line": 274,
        "fullcodeline": "watchdog=0; /* reset the watchdog */"
    },
    {
        "line": 277,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_write returned WANT_WRITE: retrying\");"
    },
    {
        "line": 278,
        "fullcodeline": "write_wants_write=1;"
    },
    {
        "line": 281,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_write returned WANT_READ: retrying\");"
    },
    {
        "line": 282,
        "fullcodeline": "write_wants_read=1;"
    },
    {
        "line": 285,
        "fullcodeline": "s_log(LOG_DEBUG,"
    },
    {
        "line": 289,
        "fullcodeline": "sslerror(\"SSL_write\");"
    },
    {
        "line": 290,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 304,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (SSL_write)\");"
    },
    {
        "line": 305,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 308,
        "fullcodeline": "s_log(LOG_ERR, \"SSL_write/SSL_get_error returned %d\", err);"
    },
    {
        "line": 309,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 327,
        "fullcodeline": "c->ssl_ptr+=(size_t)num;"
    },
    {
        "line": 328,
        "fullcodeline": "watchdog=0; /* reset the watchdog */"
    },
    {
        "line": 331,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_read returned WANT_WRITE: retrying\");"
    },
    {
        "line": 332,
        "fullcodeline": "read_wants_write=1;"
    },
    {
        "line": 338,
        "fullcodeline": "read_wants_read=1;"
    },
    {
        "line": 341,
        "fullcodeline": "s_log(LOG_DEBUG,"
    },
    {
        "line": 345,
        "fullcodeline": "sslerror(\"SSL_read\");"
    },
    {
        "line": 346,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 348,
        "fullcodeline": "s_log(LOG_INFO, \"TLS closed (SSL_read)\");"
    },
    {
        "line": 364,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (SSL_read)\");"
    },
    {
        "line": 365,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 369,
        "fullcodeline": "s_log(LOG_ERR, \"SSL_read/SSL_get_error returned %d\", err);"
    },
    {
        "line": 370,
        "fullcodeline": "throw_exception(c, 1);"
    },
    {
        "line": 384,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 387,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 405,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 408,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 420,
        "fullcodeline": "s_log(LOG_DEBUG, \"Closing the file descriptor\");"
    },
    {
        "line": 421,
        "fullcodeline": "sock_open_rd=0; /* file descriptor is ready to be closed */"
    },
    {
        "line": 432,
        "fullcodeline": "s_log(LOG_DEBUG, \"Sending close_notify alert\");"
    },
    {
        "line": 433,
        "fullcodeline": "shutdown_wants_write=1;"
    },
    {
        "line": 63,
        "fullcodeline": "timeout=c->opt->timeout_idle;"
    },
    {
        "line": 106,
        "fullcodeline": "err=get_socket_error(c->sock_rfd->fd);"
    },
    {
        "line": 111,
        "fullcodeline": "err=get_socket_error(c->sock_wfd->fd);"
    },
    {
        "line": 125,
        "fullcodeline": "err=get_socket_error(c->ssl_rfd->fd);"
    },
    {
        "line": 130,
        "fullcodeline": "ssl_can_wr && s_poll_err(c->fds, c->ssl_wfd->fd)) {"
    },
    {
        "line": 131,
        "fullcodeline": "err=get_socket_error(c->ssl_wfd->fd);"
    },
    {
        "line": 174,
        "fullcodeline": "err=SSL_ERROR_NONE;"
    },
    {
        "line": 198,
        "fullcodeline": "if(parse_socket_error(c, \"SSL_shutdown\"))"
    },
    {
        "line": 214,
        "fullcodeline": "if(parse_socket_error(c, \"writesocket\"))"
    },
    {
        "line": 236,
        "fullcodeline": "if(parse_socket_error(c, \"readsocket\"))"
    },
    {
        "line": 265,
        "fullcodeline": "if(num==0) { /* nothing was written: ignore */"
    },
    {
        "line": 270,
        "fullcodeline": "c->sock_ptr-(size_t)num);"
    },
    {
        "line": 294,
        "fullcodeline": "if(parse_socket_error(c, \"SSL_write\") && num) /* always log the error */"
    },
    {
        "line": 323,
        "fullcodeline": "if(num==0) { /* nothing was read: ignore */"
    },
    {
        "line": 349,
        "fullcodeline": "if(SSL_version(c->ssl)==SSL2_VERSION)"
    },
    {
        "line": 354,
        "fullcodeline": "if(parse_socket_error(c, \"SSL_read\") && num) /* always log the error */"
    },
    {
        "line": 358,
        "fullcodeline": "if(c->sock_ptr || write_wants_write) {"
    },
    {
        "line": 366,
        "fullcodeline": "SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 435,
        "fullcodeline": "s_log(LOG_DEBUG, \"Closing SSLv2 socket\");"
    },
    {
        "line": 441,
        "fullcodeline": "SSL_set_shutdown(c->ssl, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 65,
        "fullcodeline": "timeout=c->opt->timeout_close;"
    },
    {
        "line": 76,
        "fullcodeline": "!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN)) ||"
    },
    {
        "line": 102,
        "fullcodeline": "log_error(LOG_INFO, err, \"socket fd\");"
    },
    {
        "line": 121,
        "fullcodeline": "log_error(LOG_INFO, err, \"TLS fd\");"
    },
    {
        "line": 142,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 145,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 149,
        "fullcodeline": "} else if(s_poll_hup(c->fds, c->ssl_rfd->fd) ||"
    },
    {
        "line": 266,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_write returned 0\");"
    },
    {
        "line": 299,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 302,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 324,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSL_read returned 0\");"
    },
    {
        "line": 350,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 359,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 362,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    },
    {
        "line": 422,
        "fullcodeline": "} else if(!shutdown(c->sock_wfd->fd, SHUT_WR)) { /* send TCP FIN */"
    },
    {
        "line": 60,
        "fullcodeline": "!(SSL_get_shutdown(c->ssl)&SSL_RECEIVED_SHUTDOWN)) ||"
    },
    {
        "line": 108,
        "fullcodeline": "log_error(LOG_INFO, err, \"socket rfd\");"
    },
    {
        "line": 113,
        "fullcodeline": "log_error(LOG_INFO, err, \"socket wfd\");"
    },
    {
        "line": 127,
        "fullcodeline": "log_error(LOG_INFO, err, \"TLS rfd\");"
    },
    {
        "line": 133,
        "fullcodeline": "log_error(LOG_INFO, err, \"TLS wfd\");"
    },
    {
        "line": 150,
        "fullcodeline": "s_poll_hup(c->fds, c->ssl_wfd->fd)) {"
    },
    {
        "line": 157,
        "fullcodeline": "s_log(LOG_INFO, \"TLS socket closed (HUP)\");"
    },
    {
        "line": 158,
        "fullcodeline": "SSL_set_shutdown(c->ssl,"
    },
    {
        "line": 351,
        "fullcodeline": "SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 423,
        "fullcodeline": "s_log(LOG_DEBUG, \"Sent socket write shutdown\");"
    },
    {
        "line": 437,
        "fullcodeline": "shutdown(c->ssl_rfd->fd, SHUT_RD); /* notify the kernel */"
    },
    {
        "line": 439,
        "fullcodeline": "shutdown(c->ssl_wfd->fd, SHUT_WR); /* send TCP FIN */"
    },
    {
        "line": 159,
        "fullcodeline": "SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);"
    },
    {
        "line": 425,
        "fullcodeline": "s_log(LOG_DEBUG, \"Failed to send socket write shutdown\");"
    },
    {
        "line": 426,
        "fullcodeline": "sock_open_rd=0; /* file descriptor is ready to be closed */"
    },
    {
        "line": 152,
        "fullcodeline": "s_log(LOG_ERR,"
    },
    {
        "line": 155,
        "fullcodeline": "throw_exception(c, 1); /* reset the sockets */"
    }
]