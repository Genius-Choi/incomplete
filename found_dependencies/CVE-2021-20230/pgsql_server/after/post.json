[
    {
        "line": 2,
        "fullcodeline": "uint8_t buffer[8], ssl_ok[1]={'S'};"
    },
    {
        "line": 4,
        "fullcodeline": "static const uint8_t gss_request[8]={0, 0, 0, 8, 0x04, 0xd2, 0x16, 0x30};"
    },
    {
        "line": 5,
        "fullcodeline": "static const uint8_t gss_response[62]="
    },
    {
        "line": 11,
        "fullcodeline": "(void)opt; /* squash the unused parameter warning */"
    },
    {
        "line": 14,
        "fullcodeline": "s_log(LOG_DEBUG, \"Started server-side psql protcol negotiation\");"
    },
    {
        "line": 15,
        "fullcodeline": "memset(buffer, 0, sizeof buffer);"
    },
    {
        "line": 16,
        "fullcodeline": "s_read(c, c->local_rfd.fd, buffer, sizeof buffer);"
    },
    {
        "line": 27,
        "fullcodeline": "s_log(LOG_DEBUG, \"SSLRequest received\");"
    },
    {
        "line": 28,
        "fullcodeline": "s_write(c, c->local_wfd.fd, ssl_ok, sizeof ssl_ok);"
    },
    {
        "line": 6,
        "fullcodeline": "{'E', 0, 0, 0, 61, 'S', 'E', 'R', 'R', 'O', 'R', 0, 'C', 'X', 'X', '0',"
    },
    {
        "line": 12,
        "fullcodeline": "if(phase!=PROTOCOL_EARLY)"
    },
    {
        "line": 17,
        "fullcodeline": "if(!safe_memcmp(buffer, gss_request, sizeof gss_request)) {"
    },
    {
        "line": 22,
        "fullcodeline": "if(safe_memcmp(buffer, ssl_request, sizeof ssl_request)) {"
    },
    {
        "line": 18,
        "fullcodeline": "s_log(LOG_INFO, \"GSSAPI encryption requested, rejecting gracefully\");"
    },
    {
        "line": 19,
        "fullcodeline": "s_write(c, c->local_wfd.fd, gss_response, sizeof gss_response);"
    },
    {
        "line": 20,
        "fullcodeline": "throw_exception(c, 2); /* don't reset */"
    },
    {
        "line": 23,
        "fullcodeline": "s_log(LOG_ERR, \"PostgreSQL client did not request TLS, rejecting\");"
    },
    {
        "line": 25,
        "fullcodeline": "throw_exception(c, 1);"
    }
]