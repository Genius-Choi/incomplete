[
    {
        "line": 2,
        "fullcodeline": "ext = opts[:ext] || self.ext"
    },
    {
        "line": 3,
        "fullcodeline": "should_escape = opts[:escape] != false"
    },
    {
        "line": 4,
        "fullcodeline": "tempfile = Utils.new_tempfile(ext)"
    },
    {
        "line": 5,
        "fullcodeline": "old_path = should_escape ? shell.escape(path) : path"
    },
    {
        "line": 6,
        "fullcodeline": "new_path = should_escape ? shell.escape(tempfile.path) : tempfile.path"
    },
    {
        "line": 7,
        "fullcodeline": "command = yield(old_path, new_path)"
    },
    {
        "line": 8,
        "fullcodeline": "run(command, :escape => should_escape)"
    },
    {
        "line": 1,
        "fullcodeline": "def shell_update(opts={})"
    },
    {
        "line": 9,
        "fullcodeline": "update(tempfile)"
    }
]