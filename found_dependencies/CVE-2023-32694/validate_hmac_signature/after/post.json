[
    {
        "line": 15,
        "fullcodeline": "hmac_key = gateway_config.connection_params.get(\"webhook_hmac\")"
    },
    {
        "line": 19,
        "fullcodeline": "hmac_signature = notification.get(\"additionalData\", {}).get(\"hmacSignature\")"
    },
    {
        "line": 23,
        "fullcodeline": "success = \"true\" if notification.get(\"success\", \"\") else \"false\""
    },
    {
        "line": 27,
        "fullcodeline": "payload_list = ["
    },
    {
        "line": 37,
        "fullcodeline": "payload = \":\".join(payload_list)"
    },
    {
        "line": 39,
        "fullcodeline": "hm = hmac.new(hmac_key, payload.encode(\"utf-8\"), hashlib.sha256)"
    },
    {
        "line": 40,
        "fullcodeline": "expected_merchant_sign = base64.b64encode(hm.digest())"
    },
    {
        "line": 16,
        "fullcodeline": "if not hmac_key:"
    },
    {
        "line": 20,
        "fullcodeline": "if not hmac_signature and hmac_key:"
    },
    {
        "line": 24,
        "fullcodeline": "if notification.get(\"success\", None) is None:"
    },
    {
        "line": 41,
        "fullcodeline": "return hmac_signature == expected_merchant_sign.decode(\"utf-8\")"
    },
    {
        "line": 25,
        "fullcodeline": "success = \"\""
    },
    {
        "line": 28,
        "fullcodeline": "notification.get(\"pspReference\", \"\"),"
    },
    {
        "line": 29,
        "fullcodeline": "notification.get(\"originalReference\", \"\"),"
    },
    {
        "line": 30,
        "fullcodeline": "notification.get(\"merchantAccountCode\", \"\"),"
    },
    {
        "line": 31,
        "fullcodeline": "notification.get(\"merchantReference\", \"\"),"
    },
    {
        "line": 32,
        "fullcodeline": "notification.get(\"value\", \"\"),"
    },
    {
        "line": 33,
        "fullcodeline": "notification.get(\"currency\", \"\"),"
    },
    {
        "line": 34,
        "fullcodeline": "notification.get(\"eventCode\", \"\"),"
    }
]