[
    {
        "line": 7,
        "fullcodeline": "msg = safe_calloc(SMALL_BUF * 2);"
    },
    {
        "line": 15,
        "fullcodeline": "safe_asprintf(&msg, \"%s\", json);"
    },
    {
        "line": 17,
        "fullcodeline": "debug(LOG_DEBUG, \"json string [%s],  buffer [%s]\", json, msg);"
    },
    {
        "line": 19,
        "fullcodeline": "response = MHD_create_response_from_buffer(strlen(msg), (char *)msg, MHD_RESPMEM_MUST_FREE);"
    },
    {
        "line": 27,
        "fullcodeline": "MHD_add_response_header(response, \"Cache-Control\", \"private\");"
    },
    {
        "line": 28,
        "fullcodeline": "MHD_add_response_header(response, \"Content-Type\", \"application/captive+json\");"
    },
    {
        "line": 29,
        "fullcodeline": "ret = MHD_queue_response(connection, MHD_HTTP_OK, response);"
    },
    {
        "line": 9,
        "fullcodeline": "if (!msg) {"
    },
    {
        "line": 21,
        "fullcodeline": "if (!response) {"
    },
    {
        "line": 10,
        "fullcodeline": "ret = send_error(connection, 503);"
    },
    {
        "line": 11,
        "fullcodeline": "free(msg);"
    },
    {
        "line": 23,
        "fullcodeline": "ret = send_error(connection, 503);"
    }
]