[
    {
        "line": 3,
        "fullcodeline": "lwp_read(afdt_fd, uname);"
    },
    {
        "line": 6,
        "fullcodeline": "StructuredLogEntry* log = nullptr;"
    },
    {
        "line": 7,
        "fullcodeline": "int err = 0;"
    },
    {
        "line": 16,
        "fullcodeline": "auto buf = PasswdBuffer{};"
    },
    {
        "line": 4,
        "fullcodeline": "if (!uname.length()) return;"
    },
    {
        "line": 18,
        "fullcodeline": "if (getpwnam_r(uname.c_str(), &buf.ent, buf.data.get(), buf.size, &pw)) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (!pw) {"
    },
    {
        "line": 19,
        "fullcodeline": "err = errno;"
    },
    {
        "line": 20,
        "fullcodeline": "log = new StructuredLogEntry();"
    },
    {
        "line": 21,
        "fullcodeline": "log->setStr(\"function\", \"getpwnam_r\");"
    },
    {
        "line": 28,
        "fullcodeline": "log = new StructuredLogEntry();"
    },
    {
        "line": 29,
        "fullcodeline": "log->setStr(\"function\", \"getpwnam_r\");"
    },
    {
        "line": 36,
        "fullcodeline": "if (initgroups(pw->pw_name, pw->pw_gid)) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (setgid(pw->pw_gid)) {"
    },
    {
        "line": 53,
        "fullcodeline": "if (setuid(pw->pw_uid)) {"
    },
    {
        "line": 37,
        "fullcodeline": "err = errno;"
    },
    {
        "line": 38,
        "fullcodeline": "log = new StructuredLogEntry();"
    },
    {
        "line": 39,
        "fullcodeline": "log->setStr(\"function\", \"initgroups\");"
    },
    {
        "line": 23,
        "fullcodeline": "throw std::runtime_error{\"getpwnam_r(): \" + folly::errnoStr(err)};"
    },
    {
        "line": 31,
        "fullcodeline": "throw std::runtime_error{\"getpwnam_r(): not found\"};"
    },
    {
        "line": 42,
        "fullcodeline": "if (!log) {"
    },
    {
        "line": 54,
        "fullcodeline": "if (!log) {"
    },
    {
        "line": 43,
        "fullcodeline": "err = errno;"
    },
    {
        "line": 44,
        "fullcodeline": "log = new StructuredLogEntry();"
    },
    {
        "line": 45,
        "fullcodeline": "log->setStr(\"function\", \"setgid\");"
    },
    {
        "line": 55,
        "fullcodeline": "err = errno;"
    },
    {
        "line": 56,
        "fullcodeline": "log = new StructuredLogEntry();"
    },
    {
        "line": 57,
        "fullcodeline": "log->setStr(\"function\", \"setuid\");"
    },
    {
        "line": 47,
        "fullcodeline": "throw std::runtime_error{\"setgid():\" + folly::errnoStr(err)};"
    },
    {
        "line": 59,
        "fullcodeline": "throw std::runtime_error{\"setuid():\" + folly::errnoStr(err)};"
    }
]