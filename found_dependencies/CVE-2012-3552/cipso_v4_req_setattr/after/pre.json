[
    {
        "line": 5,
        "fullcodeline": "int ret_val = -EPERM;"
    },
    {
        "line": 6,
        "fullcodeline": "unsigned char *buf = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "struct ip_options_rcu *opt = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "buf_len = CIPSO_V4_OPT_LEN_MAX;"
    },
    {
        "line": 16,
        "fullcodeline": "buf = kmalloc(buf_len, GFP_ATOMIC);"
    },
    {
        "line": 22,
        "fullcodeline": "ret_val = cipso_v4_genopt(buf, buf_len, doi_def, secattr);"
    },
    {
        "line": 25,
        "fullcodeline": "buf_len = ret_val;"
    },
    {
        "line": 31,
        "fullcodeline": "opt_len = (buf_len + 3) & ~3;"
    },
    {
        "line": 32,
        "fullcodeline": "opt = kzalloc(sizeof(*opt) + opt_len, GFP_ATOMIC);"
    },
    {
        "line": 37,
        "fullcodeline": "memcpy(opt->opt.__data, buf, buf_len);"
    },
    {
        "line": 38,
        "fullcodeline": "opt->opt.optlen = opt_len;"
    },
    {
        "line": 39,
        "fullcodeline": "opt->opt.cipso = sizeof(struct iphdr);"
    },
    {
        "line": 40,
        "fullcodeline": "kfree(buf);"
    },
    {
        "line": 41,
        "fullcodeline": "buf = NULL;"
    },
    {
        "line": 43,
        "fullcodeline": "req_inet = inet_rsk(req);"
    },
    {
        "line": 44,
        "fullcodeline": "opt = xchg(&req_inet->opt, opt);"
    },
    {
        "line": 17,
        "fullcodeline": "if (buf == NULL) {"
    },
    {
        "line": 23,
        "fullcodeline": "if (ret_val < 0)"
    },
    {
        "line": 33,
        "fullcodeline": "if (opt == NULL) {"
    },
    {
        "line": 18,
        "fullcodeline": "ret_val = -ENOMEM;"
    },
    {
        "line": 34,
        "fullcodeline": "ret_val = -ENOMEM;"
    },
    {
        "line": 46,
        "fullcodeline": "call_rcu(&opt->rcu, opt_kfree_rcu);"
    }
]