[
    {
        "line": 5,
        "fullcodeline": "int ret_val = -EPERM;"
    },
    {
        "line": 6,
        "fullcodeline": "unsigned char *buf = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "struct ip_options *opt = NULL;"
    },
    {
        "line": 23,
        "fullcodeline": "buf_len = CIPSO_V4_OPT_LEN_MAX;"
    },
    {
        "line": 24,
        "fullcodeline": "buf = kmalloc(buf_len, GFP_ATOMIC);"
    },
    {
        "line": 30,
        "fullcodeline": "ret_val = cipso_v4_genopt(buf, buf_len, doi_def, secattr);"
    },
    {
        "line": 33,
        "fullcodeline": "buf_len = ret_val;"
    },
    {
        "line": 39,
        "fullcodeline": "opt_len = (buf_len + 3) & ~3;"
    },
    {
        "line": 40,
        "fullcodeline": "opt = kzalloc(sizeof(*opt) + opt_len, GFP_ATOMIC);"
    },
    {
        "line": 45,
        "fullcodeline": "memcpy(opt->__data, buf, buf_len);"
    },
    {
        "line": 46,
        "fullcodeline": "opt->optlen = opt_len;"
    },
    {
        "line": 48,
        "fullcodeline": "kfree(buf);"
    },
    {
        "line": 49,
        "fullcodeline": "buf = NULL;"
    },
    {
        "line": 51,
        "fullcodeline": "sk_inet = inet_sk(sk);"
    },
    {
        "line": 59,
        "fullcodeline": "opt = xchg(&sk_inet->opt, opt);"
    },
    {
        "line": 60,
        "fullcodeline": "kfree(opt);"
    },
    {
        "line": 65,
        "fullcodeline": "kfree(buf);"
    },
    {
        "line": 66,
        "fullcodeline": "kfree(opt);"
    },
    {
        "line": 17,
        "fullcodeline": "if (sk == NULL)"
    },
    {
        "line": 25,
        "fullcodeline": "if (buf == NULL) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (ret_val < 0)"
    },
    {
        "line": 41,
        "fullcodeline": "if (opt == NULL) {"
    },
    {
        "line": 26,
        "fullcodeline": "ret_val = -ENOMEM;"
    },
    {
        "line": 42,
        "fullcodeline": "ret_val = -ENOMEM;"
    },
    {
        "line": 53,
        "fullcodeline": "sk_conn = inet_csk(sk);"
    },
    {
        "line": 56,
        "fullcodeline": "sk_conn->icsk_ext_hdr_len += opt->optlen;"
    },
    {
        "line": 57,
        "fullcodeline": "sk_conn->icsk_sync_mss(sk, sk_conn->icsk_pmtu_cookie);"
    },
    {
        "line": 55,
        "fullcodeline": "sk_conn->icsk_ext_hdr_len -= sk_inet->opt->optlen;"
    }
]