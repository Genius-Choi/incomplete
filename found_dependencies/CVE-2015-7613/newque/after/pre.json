[
    {
        "line": 5,
        "fullcodeline": "key_t key = params->key;"
    },
    {
        "line": 6,
        "fullcodeline": "int msgflg = params->flg;"
    },
    {
        "line": 8,
        "fullcodeline": "msq = ipc_rcu_alloc(sizeof(*msq));"
    },
    {
        "line": 15,
        "fullcodeline": "msq->q_perm.security = NULL;"
    },
    {
        "line": 16,
        "fullcodeline": "retval = security_msg_queue_alloc(msq);"
    },
    {
        "line": 22,
        "fullcodeline": "msq->q_stime = msq->q_rtime = 0;"
    },
    {
        "line": 23,
        "fullcodeline": "msq->q_ctime = get_seconds();"
    },
    {
        "line": 24,
        "fullcodeline": "msq->q_cbytes = msq->q_qnum = 0;"
    },
    {
        "line": 25,
        "fullcodeline": "msq->q_qbytes = ns->msg_ctlmnb;"
    },
    {
        "line": 26,
        "fullcodeline": "msq->q_lspid = msq->q_lrpid = 0;"
    },
    {
        "line": 32,
        "fullcodeline": "id = ipc_addid(&msg_ids(ns), &msq->q_perm, ns->msg_ctlmni);"
    },
    {
        "line": 9,
        "fullcodeline": "if (!msq)"
    },
    {
        "line": 12,
        "fullcodeline": "msq->q_perm.mode = msgflg & S_IRWXUGO;"
    },
    {
        "line": 33,
        "fullcodeline": "if (id < 0) {"
    },
    {
        "line": 18,
        "fullcodeline": "ipc_rcu_putref(msq, ipc_rcu_free);"
    },
    {
        "line": 34,
        "fullcodeline": "ipc_rcu_putref(msq, msg_rcu_free);"
    },
    {
        "line": 10,
        "fullcodeline": "return -ENOMEM;"
    }
]