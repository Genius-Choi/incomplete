[
    {
        "line": 3,
        "fullcodeline": "struct stream *s = BGP_INPUT (peer);"
    },
    {
        "line": 5,
        "fullcodeline": "int restart_bit = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "size_t end = stream_get_getp (s) + caphdr->length;"
    },
    {
        "line": 8,
        "fullcodeline": "SET_FLAG (peer->cap, PEER_CAP_RESTART_RCV);"
    },
    {
        "line": 9,
        "fullcodeline": "restart_flag_time = stream_getw(s);"
    },
    {
        "line": 12,
        "fullcodeline": "UNSET_FLAG (restart_flag_time, 0xF000);"
    },
    {
        "line": 13,
        "fullcodeline": "peer->v_gr_restart = restart_flag_time;"
    },
    {
        "line": 10,
        "fullcodeline": "if (CHECK_FLAG (restart_flag_time, RESTART_R_BIT))"
    },
    {
        "line": 15,
        "fullcodeline": "if (BGP_DEBUG (normal, NORMAL))"
    },
    {
        "line": 23,
        "fullcodeline": "while (stream_get_getp (s) + 4 < end)"
    },
    {
        "line": 11,
        "fullcodeline": "restart_bit = 1;"
    },
    {
        "line": 17,
        "fullcodeline": "zlog_debug (\"%s OPEN has Graceful Restart capability\", peer->host);"
    },
    {
        "line": 18,
        "fullcodeline": "zlog_debug (\"%s Peer has%srestarted. Restart Time : %d\","
    },
    {
        "line": 25,
        "fullcodeline": "afi_t afi = stream_getw (s);"
    },
    {
        "line": 26,
        "fullcodeline": "safi_t safi = stream_getc (s);"
    },
    {
        "line": 27,
        "fullcodeline": "u_char flag = stream_getc (s);"
    },
    {
        "line": 19,
        "fullcodeline": "peer->host, restart_bit ? \" \" : \" not \","
    },
    {
        "line": 29,
        "fullcodeline": "if (!bgp_afi_safi_valid_indices (afi, &safi))"
    },
    {
        "line": 31,
        "fullcodeline": "if (BGP_DEBUG (normal, NORMAL))"
    },
    {
        "line": 32,
        "fullcodeline": "zlog_debug (\"%s Addr-family %d/%d(afi/safi) not supported.\""
    },
    {
        "line": 38,
        "fullcodeline": "if (BGP_DEBUG (normal, NORMAL))"
    },
    {
        "line": 52,
        "fullcodeline": "SET_FLAG (peer->af_cap[afi][safi], PEER_CAP_RESTART_AF_RCV);"
    },
    {
        "line": 39,
        "fullcodeline": "zlog_debug (\"%s Addr-family %d/%d(afi/safi) not enabled.\""
    },
    {
        "line": 45,
        "fullcodeline": "if (BGP_DEBUG (normal, NORMAL))"
    },
    {
        "line": 53,
        "fullcodeline": "if (CHECK_FLAG (flag, RESTART_F_BIT))"
    },
    {
        "line": 46,
        "fullcodeline": "zlog_debug (\"%s Address family %s is%spreserved\", peer->host,"
    },
    {
        "line": 54,
        "fullcodeline": "SET_FLAG (peer->af_cap[afi][safi], PEER_CAP_RESTART_AF_PRESERVE_RCV);"
    },
    {
        "line": 47,
        "fullcodeline": "afi_safi_print (afi, safi),"
    },
    {
        "line": 48,
        "fullcodeline": "CHECK_FLAG (peer->af_cap[afi][safi],"
    }
]