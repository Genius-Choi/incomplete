[
    {
        "line": 9,
        "fullcodeline": "int number_of_orfs = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "stream_putc (s, BGP_OPEN_OPT_CAP);"
    },
    {
        "line": 15,
        "fullcodeline": "capp = stream_get_endp (s);           /* Set Capability Len Pointer */"
    },
    {
        "line": 16,
        "fullcodeline": "stream_putc (s, 0);                   /* Capability Length */"
    },
    {
        "line": 17,
        "fullcodeline": "stream_putc (s, code);                /* Capability Code */"
    },
    {
        "line": 18,
        "fullcodeline": "orfp = stream_get_endp (s);           /* Set ORF Len Pointer */"
    },
    {
        "line": 19,
        "fullcodeline": "stream_putc (s, 0);                   /* ORF Length */"
    },
    {
        "line": 20,
        "fullcodeline": "stream_putw (s, afi);"
    },
    {
        "line": 21,
        "fullcodeline": "stream_putc (s, 0);"
    },
    {
        "line": 22,
        "fullcodeline": "stream_putc (s, safi);"
    },
    {
        "line": 23,
        "fullcodeline": "numberp = stream_get_endp (s);        /* Set Number Pointer */"
    },
    {
        "line": 24,
        "fullcodeline": "stream_putc (s, 0);                   /* Number of ORFs */"
    },
    {
        "line": 54,
        "fullcodeline": "stream_putc_at (s, numberp, number_of_orfs);"
    },
    {
        "line": 57,
        "fullcodeline": "orf_len = stream_get_endp (s) - orfp - 1;"
    },
    {
        "line": 58,
        "fullcodeline": "stream_putc_at (s, orfp, orf_len);"
    },
    {
        "line": 61,
        "fullcodeline": "cap_len = stream_get_endp (s) - capp - 1;"
    },
    {
        "line": 62,
        "fullcodeline": "stream_putc_at (s, capp, cap_len);"
    },
    {
        "line": 11,
        "fullcodeline": "if (safi == SAFI_MPLS_VPN)"
    },
    {
        "line": 27,
        "fullcodeline": "if (CHECK_FLAG (peer->af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM)"
    },
    {
        "line": 12,
        "fullcodeline": "safi = BGP_SAFI_VPNV4;"
    },
    {
        "line": 28,
        "fullcodeline": "|| CHECK_FLAG (peer->af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_RM))"
    },
    {
        "line": 30,
        "fullcodeline": "stream_putc (s, (code == CAPABILITY_CODE_ORF ?"
    },
    {
        "line": 50,
        "fullcodeline": "number_of_orfs++;"
    },
    {
        "line": 33,
        "fullcodeline": "if (CHECK_FLAG (peer->af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM)"
    },
    {
        "line": 34,
        "fullcodeline": "&& CHECK_FLAG (peer->af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_RM))"
    },
    {
        "line": 36,
        "fullcodeline": "SET_FLAG (peer->af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_ADV);"
    },
    {
        "line": 37,
        "fullcodeline": "SET_FLAG (peer->af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_ADV);"
    },
    {
        "line": 38,
        "fullcodeline": "stream_putc (s, ORF_MODE_BOTH);"
    },
    {
        "line": 40,
        "fullcodeline": "else if (CHECK_FLAG (peer->af_flags[afi][safi], PEER_FLAG_ORF_PREFIX_SM))"
    },
    {
        "line": 42,
        "fullcodeline": "SET_FLAG (peer->af_cap[afi][safi], PEER_CAP_ORF_PREFIX_SM_ADV);"
    },
    {
        "line": 43,
        "fullcodeline": "stream_putc (s, ORF_MODE_SEND);"
    },
    {
        "line": 47,
        "fullcodeline": "SET_FLAG (peer->af_cap[afi][safi], PEER_CAP_ORF_PREFIX_RM_ADV);"
    },
    {
        "line": 48,
        "fullcodeline": "stream_putc (s, ORF_MODE_RECEIVE);"
    }
]