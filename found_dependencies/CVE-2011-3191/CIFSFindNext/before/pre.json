[
    {
        "line": 4,
        "fullcodeline": "TRANSACTION2_FNEXT_REQ *pSMB = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "TRANSACTION2_FNEXT_RSP *pSMBr = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 12,
        "fullcodeline": "cFYI(1, \"In FindNext\");"
    },
    {
        "line": 17,
        "fullcodeline": "rc = smb_init(SMB_COM_TRANSACTION2, 15, tcon, (void **) &pSMB,"
    },
    {
        "line": 22,
        "fullcodeline": "params = 14; /* includes 2 bytes of null string, converted to LE below*/"
    },
    {
        "line": 23,
        "fullcodeline": "byte_count = 0;"
    },
    {
        "line": 24,
        "fullcodeline": "pSMB->TotalDataCount = 0;       /* no EAs */"
    },
    {
        "line": 25,
        "fullcodeline": "pSMB->MaxParameterCount = cpu_to_le16(8);"
    },
    {
        "line": 26,
        "fullcodeline": "pSMB->MaxDataCount ="
    },
    {
        "line": 29,
        "fullcodeline": "pSMB->MaxSetupCount = 0;"
    },
    {
        "line": 30,
        "fullcodeline": "pSMB->Reserved = 0;"
    },
    {
        "line": 31,
        "fullcodeline": "pSMB->Flags = 0;"
    },
    {
        "line": 32,
        "fullcodeline": "pSMB->Timeout = 0;"
    },
    {
        "line": 33,
        "fullcodeline": "pSMB->Reserved2 = 0;"
    },
    {
        "line": 36,
        "fullcodeline": "pSMB->DataCount = 0;"
    },
    {
        "line": 37,
        "fullcodeline": "pSMB->DataOffset = 0;"
    },
    {
        "line": 38,
        "fullcodeline": "pSMB->SetupCount = 1;"
    },
    {
        "line": 39,
        "fullcodeline": "pSMB->Reserved3 = 0;"
    },
    {
        "line": 40,
        "fullcodeline": "pSMB->SubCommand = cpu_to_le16(TRANS2_FIND_NEXT);"
    },
    {
        "line": 41,
        "fullcodeline": "pSMB->SearchHandle = searchHandle;      /* always kept as le */"
    },
    {
        "line": 42,
        "fullcodeline": "pSMB->SearchCount ="
    },
    {
        "line": 44,
        "fullcodeline": "pSMB->InformationLevel = cpu_to_le16(psrch_inf->info_level);"
    },
    {
        "line": 45,
        "fullcodeline": "pSMB->ResumeKey = psrch_inf->resume_key;"
    },
    {
        "line": 46,
        "fullcodeline": "pSMB->SearchFlags ="
    },
    {
        "line": 49,
        "fullcodeline": "name_len = psrch_inf->resume_name_len;"
    },
    {
        "line": 50,
        "fullcodeline": "params += name_len;"
    },
    {
        "line": 61,
        "fullcodeline": "byte_count = params + 1 /* pad */ ;"
    },
    {
        "line": 62,
        "fullcodeline": "pSMB->TotalParameterCount = cpu_to_le16(params);"
    },
    {
        "line": 63,
        "fullcodeline": "pSMB->ParameterCount = pSMB->TotalParameterCount;"
    },
    {
        "line": 64,
        "fullcodeline": "inc_rfc1001_len(pSMB, byte_count);"
    },
    {
        "line": 65,
        "fullcodeline": "pSMB->ByteCount = cpu_to_le16(byte_count);"
    },
    {
        "line": 67,
        "fullcodeline": "rc = SendReceive(xid, tcon->ses, (struct smb_hdr *) pSMB,"
    },
    {
        "line": 27,
        "fullcodeline": "cpu_to_le16((tcon->ses->server->maxBuf - MAX_CIFS_HDR_SIZE) &"
    },
    {
        "line": 43,
        "fullcodeline": "cpu_to_le16(CIFSMaxBufSize / sizeof(FILE_UNIX_INFO));"
    },
    {
        "line": 47,
        "fullcodeline": "cpu_to_le16(CIFS_SEARCH_CLOSE_AT_END | CIFS_SEARCH_RETURN_RESUME);"
    },
    {
        "line": 51,
        "fullcodeline": "if (name_len < PATH_MAX) {"
    },
    {
        "line": 133,
        "fullcodeline": "if (rc != 0)"
    },
    {
        "line": 52,
        "fullcodeline": "memcpy(pSMB->ResumeFileName, psrch_inf->presume_name, name_len);"
    },
    {
        "line": 15,
        "fullcodeline": "return -ENOENT;"
    },
    {
        "line": 58,
        "fullcodeline": "rc = -EINVAL;"
    },
    {
        "line": 71,
        "fullcodeline": "if (rc == -EBADF) {"
    },
    {
        "line": 78,
        "fullcodeline": "rc = validate_t2((struct smb_t2_rsp *)pSMBr);"
    },
    {
        "line": 73,
        "fullcodeline": "cifs_buf_release(pSMB);"
    },
    {
        "line": 74,
        "fullcodeline": "rc = 0; /* search probably was closed at end of search*/"
    },
    {
        "line": 80,
        "fullcodeline": "if (rc == 0) {"
    },
    {
        "line": 76,
        "fullcodeline": "cFYI(1, \"FindNext returned = %d\", rc);"
    },
    {
        "line": 88,
        "fullcodeline": "response_data = (char *) &pSMBr->hdr.Protocol +"
    },
    {
        "line": 90,
        "fullcodeline": "parms = (T2_FNEXT_RSP_PARMS *)response_data;"
    },
    {
        "line": 91,
        "fullcodeline": "response_data = (char *)&pSMBr->hdr.Protocol +"
    },
    {
        "line": 98,
        "fullcodeline": "psrch_inf->srch_entries_start = response_data;"
    },
    {
        "line": 105,
        "fullcodeline": "psrch_inf->entries_in_buffer ="
    },
    {
        "line": 109,
        "fullcodeline": "lnoff = le16_to_cpu(parms->LastNameOffset);"
    },
    {
        "line": 84,
        "fullcodeline": "if (pSMBr->hdr.Flags2 & SMBFLG2_UNICODE)"
    },
    {
        "line": 106,
        "fullcodeline": "le16_to_cpu(parms->SearchCount);"
    },
    {
        "line": 110,
        "fullcodeline": "if (tcon->ses->server->maxBuf - MAX_CIFS_HDR_SIZE <"
    },
    {
        "line": 89,
        "fullcodeline": "le16_to_cpu(pSMBr->t2.ParameterOffset);"
    },
    {
        "line": 92,
        "fullcodeline": "le16_to_cpu(pSMBr->t2.DataOffset);"
    }
]