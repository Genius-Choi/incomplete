[
    {
        "line": 2,
        "fullcodeline": "LOG.debug('Creating a random mon key...')"
    },
    {
        "line": 3,
        "fullcodeline": "mon_keyring = '[mon.]\\nkey = %s\\ncaps mon = allow *\\n' % generate_auth_key()"
    },
    {
        "line": 5,
        "fullcodeline": "keypath = '{name}.mon.keyring'.format("
    },
    {
        "line": 8,
        "fullcodeline": "oldmask = os.umask(077)"
    },
    {
        "line": 9,
        "fullcodeline": "LOG.debug('Writing monitor keyring to %s...', keypath)"
    },
    {
        "line": 11,
        "fullcodeline": "tmp = '%s.tmp' % keypath"
    },
    {
        "line": 12,
        "fullcodeline": "with open(tmp, 'w', 0600) as f:"
    },
    {
        "line": 22,
        "fullcodeline": "os.umask(oldmask)"
    },
    {
        "line": 15,
        "fullcodeline": "os.rename(tmp, keypath)"
    },
    {
        "line": 13,
        "fullcodeline": "f.write(mon_keyring)"
    },
    {
        "line": 18,
        "fullcodeline": "raise exc.ClusterExistsError(keypath)"
    },
    {
        "line": 20,
        "fullcodeline": "raise"
    }
]