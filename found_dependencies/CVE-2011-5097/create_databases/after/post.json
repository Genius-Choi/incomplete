[
    {
        "line": 2,
        "fullcodeline": "Chef::Log.info(\"Creating bootstrap databases\")"
    },
    {
        "line": 3,
        "fullcodeline": "cdb = Chef::CouchDB.new(Chef::Config[:couchdb_url], \"chef_integration\")"
    },
    {
        "line": 15,
        "fullcodeline": "db_created = nil"
    },
    {
        "line": 16,
        "fullcodeline": "max_tries = 10"
    },
    {
        "line": 17,
        "fullcodeline": "num_tries = 1"
    },
    {
        "line": 51,
        "fullcodeline": "Chef::Certificate.gen_validation_key(Chef::Config[:web_ui_client_name], Chef::Config[:web_ui_key])"
    },
    {
        "line": 53,
        "fullcodeline": "system(\"cp #{File.join(Dir.tmpdir, \"chef_integration\", \"validation.pem\")} #{Dir.tmpdir}\")"
    },
    {
        "line": 54,
        "fullcodeline": "system(\"cp #{File.join(Dir.tmpdir, \"chef_integration\", \"webui.pem\")} #{Dir.tmpdir}\")"
    },
    {
        "line": 55,
        "fullcodeline": "c = Chef::ApiClient.cdb_load(Chef::Config[:web_ui_client_name])"
    },
    {
        "line": 56,
        "fullcodeline": "c.admin(true)"
    },
    {
        "line": 59,
        "fullcodeline": "cmd = [KNIFE_CMD, \"cookbook\", \"upload\", \"-a\", \"-o\", INTEGRATION_COOKBOOKS, \"-u\", Chef::Config[:web_ui_client_name], \"-k\", File.join(Dir.tmpdir, \"webui.pem\"), \"-c\", KNIFE_CONFIG]"
    },
    {
        "line": 60,
        "fullcodeline": "Chef::Log.info(\"Uploading fixture cookbooks with #{cmd.join(' ')}\")"
    },
    {
        "line": 61,
        "fullcodeline": "cmd << {:timeout => 120}"
    },
    {
        "line": 18,
        "fullcodeline": "while !db_created && num_tries <= max_tries"
    },
    {
        "line": 62,
        "fullcodeline": "shell_out!(*cmd)"
    },
    {
        "line": 35,
        "fullcodeline": "num_tries += 1"
    },
    {
        "line": 21,
        "fullcodeline": "db_created = true"
    },
    {
        "line": 23,
        "fullcodeline": "unless e.response.code.to_i == 412"
    },
    {
        "line": 28,
        "fullcodeline": "if num_tries <= max_tries"
    },
    {
        "line": 25,
        "fullcodeline": "raise"
    },
    {
        "line": 29,
        "fullcodeline": "Chef::Log.debug(\"In creating chef_integration try #{num_tries}/#{max_tries}, got #{e}; try again\")"
    },
    {
        "line": 30,
        "fullcodeline": "sleep 0.25"
    },
    {
        "line": 32,
        "fullcodeline": "Chef::Log.error(\"In creating chef_integration, tried #{max_tries} times: got #{e}; giving up\")"
    }
]