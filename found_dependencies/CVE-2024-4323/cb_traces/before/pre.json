[
    {
        "line": 7,
        "fullcodeline": "char *buf = NULL;"
    },
    {
        "line": 9,
        "fullcodeline": "int root_type = MSGPACK_OBJECT_ARRAY;"
    },
    {
        "line": 11,
        "fullcodeline": "flb_sds_t error_msg = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "int response = 200;"
    },
    {
        "line": 14,
        "fullcodeline": "msgpack_object_array *inputs = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "size_t off = 0;"
    },
    {
        "line": 20,
        "fullcodeline": "msgpack_sbuffer_init(&mp_sbuf);"
    },
    {
        "line": 21,
        "fullcodeline": "msgpack_packer_init(&mp_pck, &mp_sbuf, msgpack_sbuffer_write);"
    },
    {
        "line": 23,
        "fullcodeline": "msgpack_unpacked_init(&result);"
    },
    {
        "line": 24,
        "fullcodeline": "ret = flb_pack_json(request->data.data, request->data.len, &buf, &buf_size,"
    },
    {
        "line": 30,
        "fullcodeline": "ret = msgpack_unpack_next(&result, buf, buf_size, &off);"
    },
    {
        "line": 65,
        "fullcodeline": "msgpack_pack_map(&mp_pck, 2);"
    },
    {
        "line": 67,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"inputs\", strlen(\"inputs\"));"
    },
    {
        "line": 68,
        "fullcodeline": "msgpack_pack_map(&mp_pck, inputs->size);"
    },
    {
        "line": 108,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"result\", strlen(\"result\"));"
    },
    {
        "line": 113,
        "fullcodeline": "msgpack_unpacked_destroy(&result);"
    },
    {
        "line": 139,
        "fullcodeline": "out_buf = flb_msgpack_raw_to_json_sds(mp_sbuf.data, mp_sbuf.size);"
    },
    {
        "line": 143,
        "fullcodeline": "msgpack_sbuffer_destroy(&mp_sbuf);"
    },
    {
        "line": 145,
        "fullcodeline": "mk_http_status(request, response);"
    },
    {
        "line": 146,
        "fullcodeline": "mk_http_send(request,"
    },
    {
        "line": 148,
        "fullcodeline": "mk_http_done(request);"
    },
    {
        "line": 150,
        "fullcodeline": "flb_sds_destroy(out_buf);"
    },
    {
        "line": 26,
        "fullcodeline": "if (ret == -1) {"
    },
    {
        "line": 31,
        "fullcodeline": "if (ret != MSGPACK_UNPACK_SUCCESS) {"
    },
    {
        "line": 37,
        "fullcodeline": "if (result.data.type != MSGPACK_OBJECT_MAP) {"
    },
    {
        "line": 43,
        "fullcodeline": "for (i = 0; i < result.data.via.map.size; i++) {"
    },
    {
        "line": 59,
        "fullcodeline": "if (inputs == NULL) {"
    },
    {
        "line": 70,
        "fullcodeline": "for (i = 0; i < inputs->size; i++) {"
    },
    {
        "line": 110,
        "fullcodeline": "if (buf != NULL) {"
    },
    {
        "line": 114,
        "fullcodeline": "if (response == 404) {"
    },
    {
        "line": 140,
        "fullcodeline": "if (out_buf == NULL) {"
    },
    {
        "line": 147,
        "fullcodeline": "out_buf, flb_sds_len(out_buf), NULL);"
    },
    {
        "line": 32,
        "fullcodeline": "ret = -1;"
    },
    {
        "line": 33,
        "fullcodeline": "error_msg = flb_sds_create(\"unfinished input\");"
    },
    {
        "line": 38,
        "fullcodeline": "response = 503;"
    },
    {
        "line": 39,
        "fullcodeline": "error_msg = flb_sds_create(\"input is not an object\");"
    },
    {
        "line": 56,
        "fullcodeline": "inputs = &result.data.via.map.ptr[i].val.via.array;"
    },
    {
        "line": 60,
        "fullcodeline": "response = 503;"
    },
    {
        "line": 61,
        "fullcodeline": "error_msg = flb_sds_create(\"inputs not found\");"
    },
    {
        "line": 71,
        "fullcodeline": "input_name = flb_sds_create_len(inputs->ptr[i].via.str.ptr, inputs->ptr[i].via.str.size);"
    },
    {
        "line": 72,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, input_name, flb_sds_len(input_name));"
    },
    {
        "line": 111,
        "fullcodeline": "flb_free(buf);"
    },
    {
        "line": 115,
        "fullcodeline": "msgpack_pack_map(&mp_pck, 1);"
    },
    {
        "line": 116,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"status\", strlen(\"status\"));"
    },
    {
        "line": 117,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"not found\", strlen(\"not found\"));"
    },
    {
        "line": 141,
        "fullcodeline": "out_buf = flb_sds_create(\"serialization error\");"
    },
    {
        "line": 44,
        "fullcodeline": "if (result.data.via.map.ptr[i].val.type != MSGPACK_OBJECT_ARRAY) {"
    },
    {
        "line": 47,
        "fullcodeline": "if (result.data.via.map.ptr[i].key.type != MSGPACK_OBJECT_STR) {"
    },
    {
        "line": 50,
        "fullcodeline": "if (result.data.via.map.ptr[i].key.via.str.size < strlen(\"inputs\")) {"
    },
    {
        "line": 53,
        "fullcodeline": "if (strncmp(result.data.via.map.ptr[i].key.via.str.ptr, \"inputs\", strlen(\"inputs\"))) {"
    },
    {
        "line": 74,
        "fullcodeline": "if (inputs->ptr[i].type != MSGPACK_OBJECT_STR) {"
    },
    {
        "line": 75,
        "fullcodeline": "msgpack_pack_map(&mp_pck, 1);"
    },
    {
        "line": 76,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"status\", strlen(\"status\"));"
    },
    {
        "line": 77,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"error\", strlen(\"error\"));"
    },
    {
        "line": 119,
        "fullcodeline": "else if (response == 503) {"
    },
    {
        "line": 120,
        "fullcodeline": "msgpack_pack_map(&mp_pck, 2);"
    },
    {
        "line": 121,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"status\", strlen(\"status\"));"
    },
    {
        "line": 122,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"error\", strlen(\"error\"));"
    },
    {
        "line": 123,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"message\", strlen(\"message\"));"
    },
    {
        "line": 80,
        "fullcodeline": "if (request->method == MK_METHOD_POST || request->method == MK_METHOD_GET) {"
    },
    {
        "line": 133,
        "fullcodeline": "msgpack_pack_map(&mp_pck, 1);"
    },
    {
        "line": 134,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"status\", strlen(\"status\"));"
    },
    {
        "line": 135,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"ok\", strlen(\"ok\"));"
    },
    {
        "line": 81,
        "fullcodeline": "ret = msgpack_params_enable_trace((struct flb_hs *)data, &result, input_name);"
    },
    {
        "line": 125,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, error_msg, flb_sds_len(error_msg));"
    },
    {
        "line": 126,
        "fullcodeline": "flb_sds_destroy(error_msg);"
    },
    {
        "line": 82,
        "fullcodeline": "if (ret != 0) {"
    },
    {
        "line": 129,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"unknown error\", strlen(\"unknown error\"));"
    },
    {
        "line": 83,
        "fullcodeline": "msgpack_pack_map(&mp_pck, 2);"
    },
    {
        "line": 84,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"status\", strlen(\"status\"));"
    },
    {
        "line": 85,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"error\", strlen(\"error\"));"
    },
    {
        "line": 86,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"returncode\", strlen(\"returncode\"));"
    },
    {
        "line": 87,
        "fullcodeline": "msgpack_pack_int64(&mp_pck, ret);"
    },
    {
        "line": 95,
        "fullcodeline": "else if (request->method == MK_METHOD_DELETE) {"
    },
    {
        "line": 90,
        "fullcodeline": "msgpack_pack_map(&mp_pck, 1);"
    },
    {
        "line": 91,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"status\", strlen(\"status\"));"
    },
    {
        "line": 92,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"ok\", strlen(\"ok\"));"
    },
    {
        "line": 96,
        "fullcodeline": "disable_trace_input((struct flb_hs *)data, input_name);"
    },
    {
        "line": 99,
        "fullcodeline": "msgpack_pack_map(&mp_pck, 2);"
    },
    {
        "line": 100,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"status\", strlen(\"status\"));"
    },
    {
        "line": 101,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"error\", strlen(\"error\"));"
    },
    {
        "line": 102,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"message\", strlen(\"message\"));"
    },
    {
        "line": 103,
        "fullcodeline": "msgpack_pack_str_with_body(&mp_pck, \"method not allowed\", strlen(\"method not allowed\"));"
    }
]