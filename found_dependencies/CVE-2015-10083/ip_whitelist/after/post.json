[
    {
        "line": 2,
        "fullcodeline": "allowed_ips = ENV.fetch(\"DYNOSAUR_IP_WHITELIST\", DEFAULT_IP_WHITELIST).split(\",\")"
    },
    {
        "line": 3,
        "fullcodeline": "ip = request.headers.fetch(\"X-Forwarded-For\", request.ip)"
    },
    {
        "line": 4,
        "fullcodeline": "if !allowed_ips.include?(ip)"
    },
    {
        "line": 5,
        "fullcodeline": "puts \"ERROR: Failed IP check for #{ip}\""
    },
    {
        "line": 6,
        "fullcodeline": "unless ENV.has_key?(\"DYNOSAUR_IP_WHITELIST\")"
    },
    {
        "line": 9,
        "fullcodeline": "render :file => \"public/401.html\", :status => :unauthorized, layout: false"
    },
    {
        "line": 7,
        "fullcodeline": "puts \"You probably need to set DYNOSAUR_IP_WHITELIST env variable\""
    }
]