[
    {
        "line": 4,
        "fullcodeline": "struct mm_struct *mm = ctx->mm;"
    },
    {
        "line": 16,
        "fullcodeline": "ret = -EFAULT;"
    },
    {
        "line": 21,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 27,
        "fullcodeline": "vm_flags = 0;"
    },
    {
        "line": 40,
        "fullcodeline": "ret = validate_range(mm, uffdio_register.range.start,"
    },
    {
        "line": 45,
        "fullcodeline": "start = uffdio_register.range.start;"
    },
    {
        "line": 46,
        "fullcodeline": "end = start + uffdio_register.range.len;"
    },
    {
        "line": 48,
        "fullcodeline": "ret = -ENOMEM;"
    },
    {
        "line": 52,
        "fullcodeline": "down_write(&mm->mmap_sem);"
    },
    {
        "line": 53,
        "fullcodeline": "vma = find_vma_prev(mm, start, &prev);"
    },
    {
        "line": 58,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 76,
        "fullcodeline": "found = false;"
    },
    {
        "line": 77,
        "fullcodeline": "basic_ioctls = false;"
    },
    {
        "line": 134,
        "fullcodeline": "BUG_ON(!found);"
    },
    {
        "line": 139,
        "fullcodeline": "ret = 0;"
    },
    {
        "line": 194,
        "fullcodeline": "up_write(&mm->mmap_sem);"
    },
    {
        "line": 195,
        "fullcodeline": "mmput(mm);"
    },
    {
        "line": 17,
        "fullcodeline": "if (copy_from_user(&uffdio_register, user_uffdio_register,"
    },
    {
        "line": 22,
        "fullcodeline": "if (!uffdio_register.mode)"
    },
    {
        "line": 24,
        "fullcodeline": "if (uffdio_register.mode & ~(UFFDIO_REGISTER_MODE_MISSING|"
    },
    {
        "line": 28,
        "fullcodeline": "if (uffdio_register.mode & UFFDIO_REGISTER_MODE_MISSING)"
    },
    {
        "line": 30,
        "fullcodeline": "if (uffdio_register.mode & UFFDIO_REGISTER_MODE_WP) {"
    },
    {
        "line": 49,
        "fullcodeline": "if (!mmget_not_zero(mm))"
    },
    {
        "line": 54,
        "fullcodeline": "if (!vma)"
    },
    {
        "line": 59,
        "fullcodeline": "if (vma->vm_start >= end)"
    },
    {
        "line": 66,
        "fullcodeline": "if (is_vm_hugetlb_page(vma)) {"
    },
    {
        "line": 78,
        "fullcodeline": "for (cur = vma; cur && cur->vm_start < end; cur = cur->vm_next) {"
    },
    {
        "line": 136,
        "fullcodeline": "if (vma->vm_start < start)"
    },
    {
        "line": 192,
        "fullcodeline": "} while (vma && vma->vm_start < end);"
    },
    {
        "line": 196,
        "fullcodeline": "if (!ret) {"
    },
    {
        "line": 29,
        "fullcodeline": "vm_flags |= VM_UFFD_MISSING;"
    },
    {
        "line": 31,
        "fullcodeline": "vm_flags |= VM_UFFD_WP;"
    },
    {
        "line": 36,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 67,
        "fullcodeline": "unsigned long vma_hpagesize = vma_kernel_pagesize(vma);"
    },
    {
        "line": 79,
        "fullcodeline": "cond_resched();"
    },
    {
        "line": 81,
        "fullcodeline": "BUG_ON(!!cur->vm_userfaultfd_ctx.ctx ^"
    },
    {
        "line": 85,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 97,
        "fullcodeline": "ret = -EPERM;"
    },
    {
        "line": 121,
        "fullcodeline": "ret = -EBUSY;"
    },
    {
        "line": 132,
        "fullcodeline": "found = true;"
    },
    {
        "line": 137,
        "fullcodeline": "prev = vma;"
    },
    {
        "line": 141,
        "fullcodeline": "cond_resched();"
    },
    {
        "line": 143,
        "fullcodeline": "BUG_ON(!vma_can_userfault(vma));"
    },
    {
        "line": 144,
        "fullcodeline": "BUG_ON(vma->vm_userfaultfd_ctx.ctx &&"
    },
    {
        "line": 146,
        "fullcodeline": "WARN_ON(!(vma->vm_flags & VM_MAYWRITE));"
    },
    {
        "line": 158,
        "fullcodeline": "vma_end = min(end, vma->vm_end);"
    },
    {
        "line": 160,
        "fullcodeline": "new_flags = (vma->vm_flags & ~vm_flags) | vm_flags;"
    },
    {
        "line": 161,
        "fullcodeline": "prev = vma_merge(mm, prev, start, vma_end, new_flags,"
    },
    {
        "line": 185,
        "fullcodeline": "vma->vm_flags = new_flags;"
    },
    {
        "line": 186,
        "fullcodeline": "vma->vm_userfaultfd_ctx.ctx = ctx;"
    },
    {
        "line": 189,
        "fullcodeline": "prev = vma;"
    },
    {
        "line": 190,
        "fullcodeline": "start = vma->vm_end;"
    },
    {
        "line": 191,
        "fullcodeline": "vma = vma->vm_next;"
    },
    {
        "line": 18,
        "fullcodeline": "sizeof(uffdio_register)-sizeof(__u64)))"
    },
    {
        "line": 69,
        "fullcodeline": "if (start & (vma_hpagesize - 1))"
    },
    {
        "line": 86,
        "fullcodeline": "if (!vma_can_userfault(cur))"
    },
    {
        "line": 98,
        "fullcodeline": "if (unlikely(!(cur->vm_flags & VM_MAYWRITE)))"
    },
    {
        "line": 105,
        "fullcodeline": "if (is_vm_hugetlb_page(cur) && end <= cur->vm_end &&"
    },
    {
        "line": 122,
        "fullcodeline": "if (cur->vm_userfaultfd_ctx.ctx &&"
    },
    {
        "line": 129,
        "fullcodeline": "if (is_vm_hugetlb_page(cur))"
    },
    {
        "line": 152,
        "fullcodeline": "if (vma->vm_userfaultfd_ctx.ctx == ctx &&"
    },
    {
        "line": 156,
        "fullcodeline": "if (vma->vm_start > start)"
    },
    {
        "line": 169,
        "fullcodeline": "if (vma->vm_start < start) {"
    },
    {
        "line": 174,
        "fullcodeline": "if (vma->vm_end > end) {"
    },
    {
        "line": 202,
        "fullcodeline": "if (put_user(basic_ioctls ? UFFD_API_RANGE_IOCTLS_BASIC :"
    },
    {
        "line": 82,
        "fullcodeline": "!!(cur->vm_flags & (VM_UFFD_MISSING | VM_UFFD_WP)));"
    },
    {
        "line": 106,
        "fullcodeline": "end > cur->vm_start) {"
    },
    {
        "line": 107,
        "fullcodeline": "unsigned long vma_hpagesize = vma_kernel_pagesize(cur);"
    },
    {
        "line": 109,
        "fullcodeline": "ret = -EINVAL;"
    },
    {
        "line": 123,
        "fullcodeline": "cur->vm_userfaultfd_ctx.ctx != ctx)"
    },
    {
        "line": 130,
        "fullcodeline": "basic_ioctls = true;"
    },
    {
        "line": 145,
        "fullcodeline": "vma->vm_userfaultfd_ctx.ctx != ctx);"
    },
    {
        "line": 153,
        "fullcodeline": "(vma->vm_flags & vm_flags) == vm_flags)"
    },
    {
        "line": 157,
        "fullcodeline": "start = vma->vm_start;"
    },
    {
        "line": 163,
        "fullcodeline": "vma_policy(vma),"
    },
    {
        "line": 164,
        "fullcodeline": "((struct vm_userfaultfd_ctx){ ctx }));"
    },
    {
        "line": 166,
        "fullcodeline": "vma = prev;"
    },
    {
        "line": 170,
        "fullcodeline": "ret = split_vma(mm, vma, start, 1);"
    },
    {
        "line": 175,
        "fullcodeline": "ret = split_vma(mm, vma, end, 0);"
    },
    {
        "line": 205,
        "fullcodeline": "ret = -EFAULT;"
    },
    {
        "line": 111,
        "fullcodeline": "if (end & (vma_hpagesize - 1))"
    }
]