[
    {
        "line": 3,
        "fullcodeline": "STACK_OF(PKCS7) *asafes = NULL, *newsafes = NULL;"
    },
    {
        "line": 4,
        "fullcodeline": "STACK_OF(PKCS12_SAFEBAG) *bags = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "int i, bagnid, pbe_nid = 0, pbe_iter = 0, pbe_saltlen = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "ASN1_OCTET_STRING *p12_data_tmp = NULL, *macoct = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "unsigned char mac[EVP_MAX_MD_SIZE];"
    },
    {
        "line": 10,
        "fullcodeline": "int rv = 0;"
    },
    {
        "line": 56,
        "fullcodeline": "X509_SIG_getm(p12->mac->dinfo, NULL, &macoct);"
    },
    {
        "line": 60,
        "fullcodeline": "rv = 1;"
    },
    {
        "line": 70,
        "fullcodeline": "sk_PKCS12_SAFEBAG_pop_free(bags, PKCS12_SAFEBAG_free);"
    },
    {
        "line": 71,
        "fullcodeline": "sk_PKCS7_pop_free(asafes, PKCS7_free);"
    },
    {
        "line": 72,
        "fullcodeline": "sk_PKCS7_pop_free(newsafes, PKCS7_free);"
    },
    {
        "line": 12,
        "fullcodeline": "if ((asafes = PKCS12_unpack_authsafes(p12)) == NULL)"
    },
    {
        "line": 14,
        "fullcodeline": "if ((newsafes = sk_PKCS7_new_null()) == NULL)"
    },
    {
        "line": 16,
        "fullcodeline": "for (i = 0; i < sk_PKCS7_num(asafes); i++) {"
    },
    {
        "line": 49,
        "fullcodeline": "if ((p12->authsafes->d.data = ASN1_OCTET_STRING_new()) == NULL)"
    },
    {
        "line": 51,
        "fullcodeline": "if (!PKCS12_pack_authsafes(p12, newsafes))"
    },
    {
        "line": 54,
        "fullcodeline": "if (!PKCS12_gen_mac(p12, newpass, -1, mac, &maclen))"
    },
    {
        "line": 57,
        "fullcodeline": "if (!ASN1_OCTET_STRING_set(macoct, mac, maclen))"
    },
    {
        "line": 64,
        "fullcodeline": "if (rv == 1) {"
    },
    {
        "line": 17,
        "fullcodeline": "p7 = sk_PKCS7_value(asafes, i);"
    },
    {
        "line": 18,
        "fullcodeline": "bagnid = OBJ_obj2nid(p7->type);"
    },
    {
        "line": 42,
        "fullcodeline": "sk_PKCS12_SAFEBAG_pop_free(bags, PKCS12_SAFEBAG_free);"
    },
    {
        "line": 43,
        "fullcodeline": "bags = NULL;"
    },
    {
        "line": 65,
        "fullcodeline": "ASN1_OCTET_STRING_free(p12_data_tmp);"
    },
    {
        "line": 19,
        "fullcodeline": "if (bagnid == NID_pkcs7_data) {"
    },
    {
        "line": 30,
        "fullcodeline": "if (bags == NULL)"
    },
    {
        "line": 32,
        "fullcodeline": "if (!newpass_bags(bags, oldpass, newpass))"
    },
    {
        "line": 35,
        "fullcodeline": "if (bagnid == NID_pkcs7_data)"
    },
    {
        "line": 40,
        "fullcodeline": "if (p7new == NULL || !sk_PKCS7_push(newsafes, p7new))"
    },
    {
        "line": 20,
        "fullcodeline": "bags = PKCS12_unpack_p7data(p7);"
    },
    {
        "line": 36,
        "fullcodeline": "p7new = PKCS12_pack_p7data(bags);"
    },
    {
        "line": 66,
        "fullcodeline": "} else if (p12_data_tmp != NULL) {"
    },
    {
        "line": 38,
        "fullcodeline": "p7new = PKCS12_pack_p7encdata(pbe_nid, newpass, -1, NULL,"
    },
    {
        "line": 67,
        "fullcodeline": "ASN1_OCTET_STRING_free(p12->authsafes->d.data);"
    },
    {
        "line": 68,
        "fullcodeline": "p12->authsafes->d.data = p12_data_tmp;"
    },
    {
        "line": 21,
        "fullcodeline": "} else if (bagnid == NID_pkcs7_encrypted) {"
    },
    {
        "line": 22,
        "fullcodeline": "bags = PKCS12_unpack_p7encdata(p7, oldpass, -1);"
    },
    {
        "line": 23,
        "fullcodeline": "if (p7->d.encrypted == NULL"
    },
    {
        "line": 24,
        "fullcodeline": "|| !alg_get(p7->d.encrypted->enc_data->algorithm,"
    }
]