[
    {
        "line": 6,
        "fullcodeline": "guint16 key_bytes_len = 0; /* Length of the total key data field */"
    },
    {
        "line": 15,
        "fullcodeline": "key_version = AIRPDCAP_EAP_KEY_DESCR_VER(pEAPKey->key_information[1]);"
    },
    {
        "line": 36,
        "fullcodeline": "key_data = (guint8 *)pEAPKey + sizeof(EAPOL_RSN_KEY);"
    },
    {
        "line": 37,
        "fullcodeline": "szEncryptedKey = (guint8 *)g_memdup(key_data, key_bytes_len);"
    },
    {
        "line": 39,
        "fullcodeline": "DEBUG_DUMP(\"Encrypted Broadcast key:\", szEncryptedKey, key_bytes_len);"
    },
    {
        "line": 40,
        "fullcodeline": "DEBUG_DUMP(\"KeyIV:\", pEAPKey->key_iv, 16);"
    },
    {
        "line": 41,
        "fullcodeline": "DEBUG_DUMP(\"decryption_key:\", decryption_key, 16);"
    },
    {
        "line": 45,
        "fullcodeline": "memcpy(tmp_sa, sa, sizeof(AIRPDCAP_SEC_ASSOCIATION));"
    },
    {
        "line": 46,
        "fullcodeline": "sa->next=tmp_sa;"
    },
    {
        "line": 144,
        "fullcodeline": "key_len = (sa->wpa.key_ver==AIRPDCAP_WPA_KEY_VER_NOT_CCMP)?TKIP_GROUP_KEY_LEN:CCMP_GROUP_KEY_LEN;"
    },
    {
        "line": 152,
        "fullcodeline": "DEBUG_DUMP(\"Broadcast key:\", szEncryptedKey, key_len);"
    },
    {
        "line": 155,
        "fullcodeline": "sa->key = &dummy_key;  /* we just need key to be not null because it is checked in AirPDcapRsnaMng().  The WPA key materials are actually in the .wpa structure */"
    },
    {
        "line": 156,
        "fullcodeline": "sa->validKey = TRUE;"
    },
    {
        "line": 160,
        "fullcodeline": "memset(sa->wpa.ptk, 0, sizeof(sa->wpa.ptk));"
    },
    {
        "line": 161,
        "fullcodeline": "memcpy(sa->wpa.ptk+32, szEncryptedKey, key_len);"
    },
    {
        "line": 162,
        "fullcodeline": "g_free(szEncryptedKey);"
    },
    {
        "line": 16,
        "fullcodeline": "if (key_version == AIRPDCAP_WPA_KEY_VER_NOT_CCMP){"
    },
    {
        "line": 29,
        "fullcodeline": "if ((key_bytes_len < GROUP_KEY_MIN_LEN) ||"
    },
    {
        "line": 55,
        "fullcodeline": "if (key_version == AIRPDCAP_WPA_KEY_VER_NOT_CCMP){"
    },
    {
        "line": 145,
        "fullcodeline": "if (key_len > key_bytes_len) {"
    },
    {
        "line": 18,
        "fullcodeline": "key_bytes_len = pntoh16(pEAPKey->key_length);"
    },
    {
        "line": 31,
        "fullcodeline": "(key_bytes_len > eapol_len - sizeof(EAPOL_RSN_KEY))) {"
    },
    {
        "line": 56,
        "fullcodeline": "guint8 new_key[32];"
    },
    {
        "line": 57,
        "fullcodeline": "guint8 dummy[256];"
    },
    {
        "line": 66,
        "fullcodeline": "sa->wpa.key_ver = (key_bytes_len >=TKIP_GROUP_KEY_LEN)?AIRPDCAP_WPA_KEY_VER_NOT_CCMP:AIRPDCAP_WPA_KEY_VER_AES_CCMP;"
    },
    {
        "line": 69,
        "fullcodeline": "memcpy(new_key, pEAPKey->key_iv, 16);"
    },
    {
        "line": 70,
        "fullcodeline": "memcpy(new_key+16, decryption_key, 16);"
    },
    {
        "line": 71,
        "fullcodeline": "DEBUG_DUMP(\"FullDecrKey:\", new_key, 32);"
    },
    {
        "line": 73,
        "fullcodeline": "crypt_rc4_init(&rc4_state, new_key, sizeof(new_key));"
    },
    {
        "line": 76,
        "fullcodeline": "crypt_rc4(&rc4_state, dummy, 256);"
    },
    {
        "line": 77,
        "fullcodeline": "crypt_rc4(&rc4_state, szEncryptedKey, key_bytes_len);"
    },
    {
        "line": 147,
        "fullcodeline": "g_free(szEncryptedKey);"
    },
    {
        "line": 30,
        "fullcodeline": "(eapol_len < sizeof(EAPOL_RSN_KEY)) ||"
    },
    {
        "line": 19,
        "fullcodeline": "}else if (key_version == AIRPDCAP_WPA_KEY_VER_AES_CCMP){"
    },
    {
        "line": 79,
        "fullcodeline": "} else if (key_version == AIRPDCAP_WPA_KEY_VER_AES_CCMP){"
    },
    {
        "line": 21,
        "fullcodeline": "key_bytes_len = pntoh16(pEAPKey->key_data_len);"
    },
    {
        "line": 88,
        "fullcodeline": "decrypted_data = AES_unwrap(decryption_key, 16, szEncryptedKey,  key_bytes_len);"
    },
    {
        "line": 95,
        "fullcodeline": "key_found = FALSE;"
    },
    {
        "line": 96,
        "fullcodeline": "key_index = 0;"
    },
    {
        "line": 141,
        "fullcodeline": "g_free(decrypted_data);"
    },
    {
        "line": 24,
        "fullcodeline": "if (key_bytes_len < 16) {"
    },
    {
        "line": 100,
        "fullcodeline": "while(key_index < (key_bytes_len - 6) && !key_found){"
    },
    {
        "line": 136,
        "fullcodeline": "if (key_length == TKIP_GROUP_KEY_LEN)"
    },
    {
        "line": 105,
        "fullcodeline": "rsn_id = decrypted_data[key_index];"
    },
    {
        "line": 106,
        "fullcodeline": "type = ((decrypted_data[key_index + 2] << 24) +"
    },
    {
        "line": 119,
        "fullcodeline": "key_length = decrypted_data[key_index+1] - 6;"
    },
    {
        "line": 129,
        "fullcodeline": "memcpy(szEncryptedKey, decrypted_data+key_index+8, key_length);"
    },
    {
        "line": 137,
        "fullcodeline": "sa->wpa.key_ver = AIRPDCAP_WPA_KEY_VER_NOT_CCMP;"
    },
    {
        "line": 111,
        "fullcodeline": "if (rsn_id == 0xdd && type == 0x000fac01) {"
    },
    {
        "line": 121,
        "fullcodeline": "if (key_index+8 >= key_bytes_len ||"
    },
    {
        "line": 131,
        "fullcodeline": "g_free(decrypted_data);"
    },
    {
        "line": 132,
        "fullcodeline": "g_free(szEncryptedKey);"
    },
    {
        "line": 139,
        "fullcodeline": "sa->wpa.key_ver = AIRPDCAP_WPA_KEY_VER_AES_CCMP;"
    },
    {
        "line": 112,
        "fullcodeline": "key_found = TRUE;"
    },
    {
        "line": 122,
        "fullcodeline": "key_length > key_bytes_len - key_index - 8) {"
    },
    {
        "line": 123,
        "fullcodeline": "g_free(decrypted_data);"
    },
    {
        "line": 124,
        "fullcodeline": "g_free(szEncryptedKey);"
    },
    {
        "line": 108,
        "fullcodeline": "(decrypted_data[key_index + 4] << 8) +"
    },
    {
        "line": 109,
        "fullcodeline": "(decrypted_data[key_index + 5]));"
    },
    {
        "line": 114,
        "fullcodeline": "key_index += decrypted_data[key_index+1]+2;"
    },
    {
        "line": 107,
        "fullcodeline": "(decrypted_data[key_index + 3] << 16) +"
    }
]