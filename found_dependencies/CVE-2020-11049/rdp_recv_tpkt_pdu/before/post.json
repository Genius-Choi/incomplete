[
    {
        "line": 3,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "UINT16 channelId = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "UINT16 securityFlags = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "if (!rdp_read_header(rdp, s, &length, &channelId))"
    },
    {
        "line": 17,
        "fullcodeline": "if (freerdp_shall_disconnect(rdp->instance))"
    },
    {
        "line": 56,
        "fullcodeline": "if (channelId == MCS_GLOBAL_CHANNEL_ID)"
    },
    {
        "line": 147,
        "fullcodeline": "if (!tpkt_ensure_stream_consumed(s, length))"
    },
    {
        "line": 13,
        "fullcodeline": "WLog_ERR(TAG, \"Incorrect RDP header.\");"
    },
    {
        "line": 22,
        "fullcodeline": "rdp->autodetect->bandwidthMeasureByteCount += length;"
    },
    {
        "line": 14,
        "fullcodeline": "return -1;"
    },
    {
        "line": 27,
        "fullcodeline": "if (!rdp_read_security_header(s, &securityFlags, &length))"
    },
    {
        "line": 33,
        "fullcodeline": "if (securityFlags & (SEC_ENCRYPT | SEC_REDIRECTION_PKT))"
    },
    {
        "line": 42,
        "fullcodeline": "if (securityFlags & SEC_REDIRECTION_PKT)"
    },
    {
        "line": 58,
        "fullcodeline": "while (Stream_GetRemainingLength(s) > 3)"
    },
    {
        "line": 148,
        "fullcodeline": "return -1;"
    },
    {
        "line": 29,
        "fullcodeline": "WLog_ERR(TAG, \"rdp_recv_tpkt_pdu: rdp_read_security_header() fail\");"
    },
    {
        "line": 48,
        "fullcodeline": "Stream_Rewind(s, 2);"
    },
    {
        "line": 49,
        "fullcodeline": "rdp->inPackets++;"
    },
    {
        "line": 51,
        "fullcodeline": "rc = rdp_recv_enhanced_security_redirection_packet(rdp, s);"
    },
    {
        "line": 62,
        "fullcodeline": "startheader = Stream_GetPosition(s);"
    },
    {
        "line": 68,
        "fullcodeline": "start = endheader = Stream_GetPosition(s);"
    },
    {
        "line": 69,
        "fullcodeline": "headerdiff = endheader - startheader;"
    },
    {
        "line": 78,
        "fullcodeline": "pduLength -= headerdiff;"
    },
    {
        "line": 80,
        "fullcodeline": "rdp->settings->PduSource = pduSource;"
    },
    {
        "line": 81,
        "fullcodeline": "rdp->inPackets++;"
    },
    {
        "line": 117,
        "fullcodeline": "end = Stream_GetPosition(s);"
    },
    {
        "line": 118,
        "fullcodeline": "diff = end - start;"
    },
    {
        "line": 130,
        "fullcodeline": "else if (rdp->mcs->messageChannelId && (channelId == rdp->mcs->messageChannelId))"
    },
    {
        "line": 30,
        "fullcodeline": "return -1;"
    },
    {
        "line": 35,
        "fullcodeline": "if (!rdp_decrypt(rdp, s, &length, securityFlags))"
    },
    {
        "line": 63,
        "fullcodeline": "if (!rdp_read_share_control_header(s, &pduLength, &pduType, &pduSource))"
    },
    {
        "line": 70,
        "fullcodeline": "if (pduLength < headerdiff)"
    },
    {
        "line": 119,
        "fullcodeline": "if (diff != pduLength)"
    },
    {
        "line": 135,
        "fullcodeline": "rdp->inPackets++;"
    },
    {
        "line": 136,
        "fullcodeline": "rc = rdp_recv_message_channel_pdu(rdp, s, securityFlags);"
    },
    {
        "line": 37,
        "fullcodeline": "WLog_ERR(TAG, \"rdp_decrypt failed\");"
    },
    {
        "line": 65,
        "fullcodeline": "WLog_ERR(TAG, \"rdp_recv_tpkt_pdu: rdp_read_share_control_header() fail\");"
    },
    {
        "line": 86,
        "fullcodeline": "rc = rdp_recv_data_pdu(rdp, s);"
    },
    {
        "line": 140,
        "fullcodeline": "rdp->inPackets++;"
    },
    {
        "line": 38,
        "fullcodeline": "return -1;"
    },
    {
        "line": 66,
        "fullcodeline": "return -1;"
    },
    {
        "line": 76,
        "fullcodeline": "return -1;"
    },
    {
        "line": 87,
        "fullcodeline": "if (rc < 0)"
    },
    {
        "line": 92,
        "fullcodeline": "if (!rdp_recv_deactivate_all(rdp, s))"
    },
    {
        "line": 101,
        "fullcodeline": "return rdp_recv_enhanced_security_redirection_packet(rdp, s);"
    },
    {
        "line": 108,
        "fullcodeline": "if (!Stream_SafeSeek(s, pduLength))"
    },
    {
        "line": 125,
        "fullcodeline": "if (!Stream_SafeSeek(s, pduLength))"
    },
    {
        "line": 142,
        "fullcodeline": "if (!freerdp_channel_process(rdp->instance, s, channelId, length))"
    },
    {
        "line": 94,
        "fullcodeline": "WLog_ERR(TAG, \"rdp_recv_tpkt_pdu: rdp_recv_deactivate_all() fail\");"
    },
    {
        "line": 133,
        "fullcodeline": "if (!rdp_read_security_header(s, &securityFlags, NULL))"
    },
    {
        "line": 95,
        "fullcodeline": "return -1;"
    },
    {
        "line": 109,
        "fullcodeline": "return -1;"
    },
    {
        "line": 126,
        "fullcodeline": "return -1;"
    },
    {
        "line": 143,
        "fullcodeline": "return -1;"
    },
    {
        "line": 134,
        "fullcodeline": "return -1;"
    }
]