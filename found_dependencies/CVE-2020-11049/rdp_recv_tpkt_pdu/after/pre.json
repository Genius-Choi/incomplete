[
    {
        "line": 3,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "UINT16 channelId = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "UINT16 securityFlags = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "if (!rdp_read_header(rdp, s, &length, &channelId))"
    },
    {
        "line": 16,
        "fullcodeline": "if (freerdp_shall_disconnect(rdp->instance))"
    },
    {
        "line": 55,
        "fullcodeline": "if (channelId == MCS_GLOBAL_CHANNEL_ID)"
    },
    {
        "line": 12,
        "fullcodeline": "WLog_ERR(TAG, \"Incorrect RDP header.\");"
    },
    {
        "line": 137,
        "fullcodeline": "if (!tpkt_ensure_stream_consumed(s, length))"
    },
    {
        "line": 13,
        "fullcodeline": "return -1;"
    },
    {
        "line": 32,
        "fullcodeline": "if (securityFlags & (SEC_ENCRYPT | SEC_REDIRECTION_PKT))"
    },
    {
        "line": 41,
        "fullcodeline": "if (securityFlags & SEC_REDIRECTION_PKT)"
    },
    {
        "line": 138,
        "fullcodeline": "return -1;"
    },
    {
        "line": 26,
        "fullcodeline": "if (!rdp_read_security_header(s, &securityFlags, &length))"
    },
    {
        "line": 47,
        "fullcodeline": "Stream_Rewind(s, 2);"
    },
    {
        "line": 48,
        "fullcodeline": "rdp->inPackets++;"
    },
    {
        "line": 50,
        "fullcodeline": "rc = rdp_recv_enhanced_security_redirection_packet(rdp, s);"
    },
    {
        "line": 57,
        "fullcodeline": "while (Stream_GetRemainingLength(s) > 3)"
    },
    {
        "line": 69,
        "fullcodeline": "Stream_StaticInit(&sub, Stream_Pointer(s), remain);"
    },
    {
        "line": 74,
        "fullcodeline": "rdp->inPackets++;"
    },
    {
        "line": 110,
        "fullcodeline": "diff = Stream_GetRemainingLength(&sub);"
    },
    {
        "line": 29,
        "fullcodeline": "return -1;"
    },
    {
        "line": 120,
        "fullcodeline": "else if (rdp->mcs->messageChannelId && (channelId == rdp->mcs->messageChannelId))"
    },
    {
        "line": 125,
        "fullcodeline": "rdp->inPackets++;"
    },
    {
        "line": 126,
        "fullcodeline": "rc = rdp_recv_message_channel_pdu(rdp, s, securityFlags);"
    },
    {
        "line": 34,
        "fullcodeline": "if (!rdp_decrypt(rdp, s, &length, securityFlags))"
    },
    {
        "line": 63,
        "fullcodeline": "if (!rdp_read_share_control_header(s, NULL, &remain, &pduType, &pduSource))"
    },
    {
        "line": 70,
        "fullcodeline": "if (!Stream_SafeSeek(s, remain))"
    },
    {
        "line": 79,
        "fullcodeline": "rc = rdp_recv_data_pdu(rdp, &sub);"
    },
    {
        "line": 37,
        "fullcodeline": "return -1;"
    },
    {
        "line": 66,
        "fullcodeline": "return -1;"
    },
    {
        "line": 71,
        "fullcodeline": "return -1;"
    },
    {
        "line": 80,
        "fullcodeline": "if (rc < 0)"
    },
    {
        "line": 94,
        "fullcodeline": "return rdp_recv_enhanced_security_redirection_packet(rdp, &sub);"
    },
    {
        "line": 85,
        "fullcodeline": "if (!rdp_recv_deactivate_all(rdp, &sub))"
    },
    {
        "line": 101,
        "fullcodeline": "if (!Stream_SafeSeek(&sub, remain))"
    },
    {
        "line": 132,
        "fullcodeline": "if (!freerdp_channel_process(rdp->instance, s, channelId, length))"
    },
    {
        "line": 88,
        "fullcodeline": "return -1;"
    },
    {
        "line": 102,
        "fullcodeline": "return -1;"
    },
    {
        "line": 123,
        "fullcodeline": "if (!rdp_read_security_header(s, &securityFlags, NULL))"
    },
    {
        "line": 133,
        "fullcodeline": "return -1;"
    },
    {
        "line": 124,
        "fullcodeline": "return -1;"
    }
]