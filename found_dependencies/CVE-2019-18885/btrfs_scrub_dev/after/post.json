[
    {
        "line": 51,
        "fullcodeline": "sctx = scrub_setup_ctx(fs_info, is_dev_replace);"
    },
    {
        "line": 56,
        "fullcodeline": "dev = btrfs_find_device(fs_info->fs_devices, devid, NULL, NULL, true);"
    },
    {
        "line": 73,
        "fullcodeline": "mutex_lock(&fs_info->scrub_lock);"
    },
    {
        "line": 92,
        "fullcodeline": "up_read(&fs_info->dev_replace.rwsem);"
    },
    {
        "line": 94,
        "fullcodeline": "ret = scrub_workers_get(fs_info, is_dev_replace);"
    },
    {
        "line": 101,
        "fullcodeline": "sctx->readonly = readonly;"
    },
    {
        "line": 102,
        "fullcodeline": "dev->scrub_ctx = sctx;"
    },
    {
        "line": 103,
        "fullcodeline": "mutex_unlock(&fs_info->fs_devices->device_list_mutex);"
    },
    {
        "line": 109,
        "fullcodeline": "__scrub_blocked_if_needed(fs_info);"
    },
    {
        "line": 110,
        "fullcodeline": "atomic_inc(&fs_info->scrubs_running);"
    },
    {
        "line": 111,
        "fullcodeline": "mutex_unlock(&fs_info->scrub_lock);"
    },
    {
        "line": 122,
        "fullcodeline": "nofs_flag = memalloc_nofs_save();"
    },
    {
        "line": 135,
        "fullcodeline": "memalloc_nofs_restore(nofs_flag);"
    },
    {
        "line": 137,
        "fullcodeline": "wait_event(sctx->list_wait, atomic_read(&sctx->bios_in_flight) == 0);"
    },
    {
        "line": 138,
        "fullcodeline": "atomic_dec(&fs_info->scrubs_running);"
    },
    {
        "line": 139,
        "fullcodeline": "wake_up(&fs_info->scrub_pause_wait);"
    },
    {
        "line": 141,
        "fullcodeline": "wait_event(sctx->list_wait, atomic_read(&sctx->workers_pending) == 0);"
    },
    {
        "line": 146,
        "fullcodeline": "mutex_lock(&fs_info->scrub_lock);"
    },
    {
        "line": 147,
        "fullcodeline": "dev->scrub_ctx = NULL;"
    },
    {
        "line": 148,
        "fullcodeline": "scrub_workers_put(fs_info);"
    },
    {
        "line": 149,
        "fullcodeline": "mutex_unlock(&fs_info->scrub_lock);"
    },
    {
        "line": 151,
        "fullcodeline": "scrub_put_ctx(sctx);"
    },
    {
        "line": 156,
        "fullcodeline": "scrub_free_ctx(sctx);"
    },
    {
        "line": 10,
        "fullcodeline": "if (btrfs_fs_closing(fs_info))"
    },
    {
        "line": 13,
        "fullcodeline": "if (fs_info->nodesize > BTRFS_STRIPE_LEN) {"
    },
    {
        "line": 26,
        "fullcodeline": "if (fs_info->sectorsize != PAGE_SIZE) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (fs_info->nodesize >"
    },
    {
        "line": 52,
        "fullcodeline": "if (IS_ERR(sctx))"
    },
    {
        "line": 57,
        "fullcodeline": "if (!dev || (test_bit(BTRFS_DEV_STATE_MISSING, &dev->dev_state) &&"
    },
    {
        "line": 64,
        "fullcodeline": "if (!is_dev_replace && !readonly &&"
    },
    {
        "line": 74,
        "fullcodeline": "if (!test_bit(BTRFS_DEV_STATE_IN_FS_METADATA, &dev->dev_state) ||"
    },
    {
        "line": 83,
        "fullcodeline": "if (dev->scrub_ctx ||"
    },
    {
        "line": 123,
        "fullcodeline": "if (!is_dev_replace) {"
    },
    {
        "line": 133,
        "fullcodeline": "if (!ret)"
    },
    {
        "line": 19,
        "fullcodeline": "btrfs_err(fs_info,"
    },
    {
        "line": 28,
        "fullcodeline": "btrfs_err_rl(fs_info,"
    },
    {
        "line": 36,
        "fullcodeline": "fs_info->sectorsize > PAGE_SIZE * SCRUB_MAX_PAGES_PER_BLOCK) {"
    },
    {
        "line": 41,
        "fullcodeline": "btrfs_err(fs_info,"
    },
    {
        "line": 59,
        "fullcodeline": "mutex_unlock(&fs_info->fs_devices->device_list_mutex);"
    },
    {
        "line": 60,
        "fullcodeline": "ret = -ENODEV;"
    },
    {
        "line": 65,
        "fullcodeline": "!test_bit(BTRFS_DEV_STATE_WRITEABLE, &dev->dev_state)) {"
    },
    {
        "line": 66,
        "fullcodeline": "mutex_unlock(&fs_info->fs_devices->device_list_mutex);"
    },
    {
        "line": 67,
        "fullcodeline": "btrfs_err_in_rcu(fs_info, \"scrub: device %s is not writable\","
    },
    {
        "line": 69,
        "fullcodeline": "ret = -EROFS;"
    },
    {
        "line": 75,
        "fullcodeline": "test_bit(BTRFS_DEV_STATE_REPLACE_TGT, &dev->dev_state)) {"
    },
    {
        "line": 76,
        "fullcodeline": "mutex_unlock(&fs_info->scrub_lock);"
    },
    {
        "line": 77,
        "fullcodeline": "mutex_unlock(&fs_info->fs_devices->device_list_mutex);"
    },
    {
        "line": 78,
        "fullcodeline": "ret = -EIO;"
    },
    {
        "line": 84,
        "fullcodeline": "(!is_dev_replace &&"
    },
    {
        "line": 86,
        "fullcodeline": "up_read(&fs_info->dev_replace.rwsem);"
    },
    {
        "line": 87,
        "fullcodeline": "mutex_unlock(&fs_info->scrub_lock);"
    },
    {
        "line": 88,
        "fullcodeline": "mutex_unlock(&fs_info->fs_devices->device_list_mutex);"
    },
    {
        "line": 89,
        "fullcodeline": "ret = -EINPROGRESS;"
    },
    {
        "line": 96,
        "fullcodeline": "mutex_unlock(&fs_info->scrub_lock);"
    },
    {
        "line": 97,
        "fullcodeline": "mutex_unlock(&fs_info->fs_devices->device_list_mutex);"
    },
    {
        "line": 128,
        "fullcodeline": "mutex_lock(&fs_info->fs_devices->device_list_mutex);"
    },
    {
        "line": 129,
        "fullcodeline": "ret = scrub_supers(sctx, dev);"
    },
    {
        "line": 130,
        "fullcodeline": "mutex_unlock(&fs_info->fs_devices->device_list_mutex);"
    },
    {
        "line": 134,
        "fullcodeline": "ret = scrub_enumerate_chunks(sctx, dev, start, end);"
    },
    {
        "line": 144,
        "fullcodeline": "memcpy(progress, &sctx->stat, sizeof(*progress));"
    },
    {
        "line": 11,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 23,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 31,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 35,
        "fullcodeline": "PAGE_SIZE * SCRUB_MAX_PAGES_PER_BLOCK ||"
    },
    {
        "line": 47,
        "fullcodeline": "return -EINVAL;"
    },
    {
        "line": 53,
        "fullcodeline": "return PTR_ERR(sctx);"
    },
    {
        "line": 58,
        "fullcodeline": "!is_dev_replace)) {"
    },
    {
        "line": 68,
        "fullcodeline": "rcu_str_deref(dev->name));"
    },
    {
        "line": 85,
        "fullcodeline": "btrfs_dev_replace_is_ongoing(&fs_info->dev_replace))) {"
    }
]