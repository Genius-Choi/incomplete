[
    {
        "line": 11,
        "fullcodeline": "const char                  *errmsg = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "xdr_free(xdr_gpol_ret,  &ret);"
    },
    {
        "line": 21,
        "fullcodeline": "ret.api_version = handle->api_version;"
    },
    {
        "line": 23,
        "fullcodeline": "funcname = \"kadm5_get_policy\";"
    },
    {
        "line": 29,
        "fullcodeline": "prime_arg = arg->name;"
    },
    {
        "line": 31,
        "fullcodeline": "ret.code = KADM5_AUTH_GET;"
    },
    {
        "line": 68,
        "fullcodeline": "gss_release_buffer(&minor_stat, &client_name);"
    },
    {
        "line": 69,
        "fullcodeline": "gss_release_buffer(&minor_stat, &service_name);"
    },
    {
        "line": 71,
        "fullcodeline": "free_server_handle(handle);"
    },
    {
        "line": 15,
        "fullcodeline": "if ((ret.code = new_server_handle(arg->api_version, rqstp, &handle)))"
    },
    {
        "line": 18,
        "fullcodeline": "if ((ret.code = check_handle((void *)handle)))"
    },
    {
        "line": 25,
        "fullcodeline": "if (setup_gss_names(rqstp, &client_name, &service_name) < 0) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (!CHANGEPW_SERVICE(rqstp) && kadm5int_acl_check(handle->context,"
    },
    {
        "line": 52,
        "fullcodeline": "if (ret.code == KADM5_OK) {"
    },
    {
        "line": 26,
        "fullcodeline": "ret.code = KADM5_FAILURE;"
    },
    {
        "line": 35,
        "fullcodeline": "ret.code = KADM5_OK;"
    },
    {
        "line": 53,
        "fullcodeline": "ret.code = kadm5_get_policy(handle, arg->name, &ret.rec);"
    },
    {
        "line": 58,
        "fullcodeline": "log_done(funcname,"
    },
    {
        "line": 33,
        "fullcodeline": "rqst2name(rqstp),"
    },
    {
        "line": 37,
        "fullcodeline": "ret.code = kadm5_get_principal(handle->lhandle,"
    },
    {
        "line": 55,
        "fullcodeline": "if( ret.code != 0 )"
    },
    {
        "line": 59,
        "fullcodeline": "((prime_arg == NULL) ? \"(null)\" : prime_arg), errmsg,"
    },
    {
        "line": 61,
        "fullcodeline": "if (errmsg != NULL)"
    },
    {
        "line": 65,
        "fullcodeline": "log_unauth(funcname, prime_arg,"
    },
    {
        "line": 41,
        "fullcodeline": "if (ret.code == KADM5_OK) {"
    },
    {
        "line": 56,
        "fullcodeline": "errmsg = krb5_get_error_message(handle->context, ret.code);"
    },
    {
        "line": 62,
        "fullcodeline": "krb5_free_error_message(handle->context, errmsg);"
    },
    {
        "line": 46,
        "fullcodeline": "ret2 = kadm5_free_principal_ent(handle->lhandle,"
    },
    {
        "line": 48,
        "fullcodeline": "ret.code = ret.code ? ret.code : ret2;"
    },
    {
        "line": 42,
        "fullcodeline": "if (caller_ent.aux_attributes & KADM5_POLICY &&"
    },
    {
        "line": 43,
        "fullcodeline": "strcmp(caller_ent.policy, arg->name) == 0) {"
    },
    {
        "line": 44,
        "fullcodeline": "ret.code = KADM5_OK;"
    },
    {
        "line": 45,
        "fullcodeline": "} else ret.code = KADM5_AUTH_GET;"
    }
]