[
    {
        "line": 10,
        "fullcodeline": "whitelist = r\"^docker://[a-zA-Z0-9_.:/@-]+$\""
    },
    {
        "line": 14,
        "fullcodeline": "name = python_safe_name(docker_reference.replace(\"docker://\", \"\"))"
    },
    {
        "line": 15,
        "fullcodeline": "filename = f\"{name}.tar\""
    },
    {
        "line": 16,
        "fullcodeline": "download_directory = to or tempfile.mkdtemp()"
    },
    {
        "line": 17,
        "fullcodeline": "output_file = Path(download_directory, filename)"
    },
    {
        "line": 18,
        "fullcodeline": "target = f\"docker-archive:{output_file}\""
    },
    {
        "line": 20,
        "fullcodeline": "skopeo_executable = _get_skopeo_location()"
    },
    {
        "line": 21,
        "fullcodeline": "platform_args = []"
    },
    {
        "line": 22,
        "fullcodeline": "platform = get_docker_image_platform(docker_reference)"
    },
    {
        "line": 31,
        "fullcodeline": "platform_args = \" \".join(platform_args)"
    },
    {
        "line": 33,
        "fullcodeline": "cmd = ("
    },
    {
        "line": 37,
        "fullcodeline": "logger.info(f\"Fetching image with: {cmd}\")"
    },
    {
        "line": 39,
        "fullcodeline": "logger.info(output)"
    },
    {
        "line": 43,
        "fullcodeline": "checksums = multi_checksums(output_file, (\"md5\", \"sha1\"))"
    },
    {
        "line": 11,
        "fullcodeline": "if not re.match(whitelist, docker_reference):"
    },
    {
        "line": 34,
        "fullcodeline": "f\"{skopeo_executable} copy --insecure-policy \""
    },
    {
        "line": 38,
        "fullcodeline": "exitcode, output = pipes.run_command(cmd)"
    },
    {
        "line": 40,
        "fullcodeline": "if exitcode != 0:"
    },
    {
        "line": 45,
        "fullcodeline": "return Download("
    },
    {
        "line": 12,
        "fullcodeline": "raise ValueError(\"Invalid Docker reference.\")"
    },
    {
        "line": 35,
        "fullcodeline": "f\"{platform_args} {docker_reference} {target}\""
    },
    {
        "line": 41,
        "fullcodeline": "raise FetchDockerImageError(output)"
    },
    {
        "line": 24,
        "fullcodeline": "os, arch, variant = platform"
    },
    {
        "line": 50,
        "fullcodeline": "size=output_file.stat().st_size,"
    },
    {
        "line": 26,
        "fullcodeline": "platform_args.append(f\"--override-os={os}\")"
    },
    {
        "line": 28,
        "fullcodeline": "platform_args.append(f\"--override-arch={arch}\")"
    },
    {
        "line": 30,
        "fullcodeline": "platform_args.append(f\"--override-variant={variant}\")"
    }
]