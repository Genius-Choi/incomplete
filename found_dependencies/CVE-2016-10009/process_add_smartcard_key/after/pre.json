[
    {
        "line": 3,
        "fullcodeline": "char *provider = NULL, *pin, canonical_provider[PATH_MAX];"
    },
    {
        "line": 4,
        "fullcodeline": "int r, i, version, count = 0, success = 0, confirm = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "time_t death = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "struct sshkey **keys = NULL, *k;"
    },
    {
        "line": 45,
        "fullcodeline": "debug(\"%s: add %.100s\", __func__, canonical_provider);"
    },
    {
        "line": 49,
        "fullcodeline": "count = pkcs11_add_provider(canonical_provider, pin, &keys);"
    },
    {
        "line": 70,
        "fullcodeline": "free(pin);"
    },
    {
        "line": 71,
        "fullcodeline": "free(provider);"
    },
    {
        "line": 72,
        "fullcodeline": "free(keys);"
    },
    {
        "line": 73,
        "fullcodeline": "send_status(e, success);"
    },
    {
        "line": 12,
        "fullcodeline": "if ((r = sshbuf_get_cstring(e->request, &provider, NULL)) != 0 ||"
    },
    {
        "line": 16,
        "fullcodeline": "while (sshbuf_len(e->request)) {"
    },
    {
        "line": 35,
        "fullcodeline": "if (realpath(provider, canonical_provider) == NULL) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (match_pattern_list(canonical_provider, pkcs11_whitelist, 0) != 1) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (lifetime && !death)"
    },
    {
        "line": 50,
        "fullcodeline": "for (i = 0; i < count; i++) {"
    },
    {
        "line": 13,
        "fullcodeline": "(r = sshbuf_get_cstring(e->request, &pin, NULL)) != 0)"
    },
    {
        "line": 14,
        "fullcodeline": "fatal(\"%s: buffer error: %s\", __func__, ssh_err(r));"
    },
    {
        "line": 36,
        "fullcodeline": "verbose(\"failed PKCS#11 add of \\\"%.100s\\\": realpath: %s\","
    },
    {
        "line": 41,
        "fullcodeline": "verbose(\"refusing PKCS#11 add of \\\"%.100s\\\": \""
    },
    {
        "line": 47,
        "fullcodeline": "death = monotime() + lifetime;"
    },
    {
        "line": 51,
        "fullcodeline": "k = keys[i];"
    },
    {
        "line": 52,
        "fullcodeline": "version = k->type == KEY_RSA1 ? 1 : 2;"
    },
    {
        "line": 53,
        "fullcodeline": "tab = idtab_lookup(version);"
    },
    {
        "line": 67,
        "fullcodeline": "keys[i] = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "if ((r = sshbuf_get_u8(e->request, &type)) != 0)"
    },
    {
        "line": 37,
        "fullcodeline": "provider, strerror(errno));"
    },
    {
        "line": 54,
        "fullcodeline": "if (lookup_identity(k, version) == NULL) {"
    },
    {
        "line": 18,
        "fullcodeline": "fatal(\"%s: buffer error: %s\", __func__, ssh_err(r));"
    },
    {
        "line": 24,
        "fullcodeline": "death = monotime() + seconds;"
    },
    {
        "line": 27,
        "fullcodeline": "confirm = 1;"
    },
    {
        "line": 30,
        "fullcodeline": "error(\"process_add_smartcard_key: \""
    },
    {
        "line": 55,
        "fullcodeline": "id = xcalloc(1, sizeof(Identity));"
    },
    {
        "line": 56,
        "fullcodeline": "id->key = k;"
    },
    {
        "line": 57,
        "fullcodeline": "id->provider = xstrdup(canonical_provider);"
    },
    {
        "line": 58,
        "fullcodeline": "id->comment = xstrdup(canonical_provider); /* XXX */"
    },
    {
        "line": 59,
        "fullcodeline": "id->death = death;"
    },
    {
        "line": 60,
        "fullcodeline": "id->confirm = confirm;"
    },
    {
        "line": 61,
        "fullcodeline": "TAILQ_INSERT_TAIL(&tab->idlist, id, next);"
    },
    {
        "line": 62,
        "fullcodeline": "tab->nentries++;"
    },
    {
        "line": 63,
        "fullcodeline": "success = 1;"
    },
    {
        "line": 21,
        "fullcodeline": "if ((r = sshbuf_get_u32(e->request, &seconds)) != 0)"
    },
    {
        "line": 65,
        "fullcodeline": "sshkey_free(k);"
    },
    {
        "line": 22,
        "fullcodeline": "fatal(\"%s: buffer error: %s\","
    },
    {
        "line": 23,
        "fullcodeline": "__func__, ssh_err(r));"
    }
]