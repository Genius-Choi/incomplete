[
    {
        "line": 4,
        "fullcodeline": "DH *dh_clnt = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "EVP_PKEY *ckey = NULL, *skey = NULL;"
    },
    {
        "line": 13,
        "fullcodeline": "ckey = ssl_generate_pkey(skey);"
    },
    {
        "line": 14,
        "fullcodeline": "dh_clnt = EVP_PKEY_get0_DH(ckey);"
    },
    {
        "line": 23,
        "fullcodeline": "DH_get0_key(dh_clnt, &pub_key, NULL);"
    },
    {
        "line": 24,
        "fullcodeline": "*len = BN_num_bytes(pub_key);"
    },
    {
        "line": 25,
        "fullcodeline": "s2n(*len, *p);"
    },
    {
        "line": 26,
        "fullcodeline": "BN_bn2bin(pub_key, *p);"
    },
    {
        "line": 27,
        "fullcodeline": "*len += 2;"
    },
    {
        "line": 28,
        "fullcodeline": "EVP_PKEY_free(ckey);"
    },
    {
        "line": 9,
        "fullcodeline": "if (skey == NULL) {"
    },
    {
        "line": 16,
        "fullcodeline": "if (dh_clnt == NULL || ssl_derive(s, ckey, skey) == 0) {"
    },
    {
        "line": 10,
        "fullcodeline": "SSLerr(SSL_F_TLS_CONSTRUCT_CKE_DHE, ERR_R_INTERNAL_ERROR);"
    },
    {
        "line": 17,
        "fullcodeline": "SSLerr(SSL_F_TLS_CONSTRUCT_CKE_DHE, ERR_R_INTERNAL_ERROR);"
    },
    {
        "line": 18,
        "fullcodeline": "EVP_PKEY_free(ckey);"
    }
]