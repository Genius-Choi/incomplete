[
    {
        "line": 4,
        "fullcodeline": "if (!stsz || !stsz->sampleCount) return GF_BAD_PARAM;"
    },
    {
        "line": 13,
        "fullcodeline": "if (!stsz->sizes) {"
    },
    {
        "line": 8,
        "fullcodeline": "stsz->sizes = (u32*)gf_malloc(sizeof(u32)*stsz->sampleCount);"
    },
    {
        "line": 11,
        "fullcodeline": "stsz->sampleSize = 0;"
    },
    {
        "line": 14,
        "fullcodeline": "stsz->sampleSize = data_size;"
    },
    {
        "line": 9,
        "fullcodeline": "if (!stsz->sizes) return GF_OUT_OF_MEM;"
    },
    {
        "line": 10,
        "fullcodeline": "for (i=0; i<stsz->sampleCount; i++) stsz->sizes[i] = stsz->sampleSize;"
    },
    {
        "line": 17,
        "fullcodeline": "stsz->sizes[stsz->sampleCount-1] += data_size;"
    },
    {
        "line": 20,
        "fullcodeline": "for (i=1; i<stsz->sampleCount; i++) {"
    },
    {
        "line": 27,
        "fullcodeline": "stsz->sampleSize = single_size;"
    },
    {
        "line": 28,
        "fullcodeline": "gf_free(stsz->sizes);"
    },
    {
        "line": 29,
        "fullcodeline": "stsz->sizes = NULL;"
    },
    {
        "line": 21,
        "fullcodeline": "if (stsz->sizes[i] != single_size) {"
    },
    {
        "line": 22,
        "fullcodeline": "single_size = 0;"
    }
]