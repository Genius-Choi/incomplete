[
    {
        "line": 2,
        "fullcodeline": "api_endpoint = \"https://vulners.com/api/v3/burp/software/\""
    },
    {
        "line": 3,
        "fullcodeline": "header = {"
    },
    {
        "line": 7,
        "fullcodeline": "version_re = \":([d.-_]+)([^:]*)$\""
    },
    {
        "line": 8,
        "fullcodeline": "nmap = nmap3.Nmap()"
    },
    {
        "line": 9,
        "fullcodeline": "service_scans = nmap.nmap_version_detection(hostname)"
    },
    {
        "line": 10,
        "fullcodeline": "services = []"
    },
    {
        "line": 11,
        "fullcodeline": "vulnerabilities = []"
    },
    {
        "line": 12,
        "fullcodeline": "ip, service_scans = list(service_scans.items())[0]"
    },
    {
        "line": 13,
        "fullcodeline": "for port in service_scans[\"ports\"]:"
    },
    {
        "line": 52,
        "fullcodeline": "return {\"services\": services, \"vulnerabilities\": vulnerabilities}"
    },
    {
        "line": 14,
        "fullcodeline": "if port[\"state\"] != \"closed\":"
    },
    {
        "line": 15,
        "fullcodeline": "services.append(port[\"service\"])"
    },
    {
        "line": 16,
        "fullcodeline": "cpe_list = port[\"cpe\"]"
    },
    {
        "line": 17,
        "fullcodeline": "vuln_list = []"
    },
    {
        "line": 51,
        "fullcodeline": "vulnerabilities.append({\"service\": service_name, \"vuln_list\": vuln_list})"
    },
    {
        "line": 18,
        "fullcodeline": "for item in cpe_list:"
    },
    {
        "line": 46,
        "fullcodeline": "service_name = ("
    },
    {
        "line": 19,
        "fullcodeline": "cpe = item[\"cpe\"]"
    },
    {
        "line": 20,
        "fullcodeline": "version_match = re.search(version_re, cpe)"
    },
    {
        "line": 47,
        "fullcodeline": "f\"{port['service']['product']} - {port['service']['name']}\""
    },
    {
        "line": 50,
        "fullcodeline": "service_name = f\"{port['service']['name']}\""
    },
    {
        "line": 23,
        "fullcodeline": "print(f\"Querying vulns for {cpe}, version {version}, of type cpe\")"
    },
    {
        "line": 24,
        "fullcodeline": "query_url = ("
    },
    {
        "line": 27,
        "fullcodeline": "response = requests.get(query_url, headers=header)"
    },
    {
        "line": 22,
        "fullcodeline": "version, patch = version_match.groups()"
    },
    {
        "line": 25,
        "fullcodeline": "api_endpoint + f\"?software={cpe}&version={version}&type=cpe\""
    },
    {
        "line": 30,
        "fullcodeline": "for search_result in data:"
    },
    {
        "line": 29,
        "fullcodeline": "data = response.json()[\"data\"][\"search\"]"
    },
    {
        "line": 31,
        "fullcodeline": "info = {"
    },
    {
        "line": 44,
        "fullcodeline": "vuln_list.append(info)"
    },
    {
        "line": 36,
        "fullcodeline": "if info[\"type\"] == \"cve\":"
    },
    {
        "line": 37,
        "fullcodeline": "info["
    },
    {
        "line": 41,
        "fullcodeline": "info["
    },
    {
        "line": 39,
        "fullcodeline": "] = f\"https://cvepremium.circl.lu/cve/{info['id']}\""
    },
    {
        "line": 43,
        "fullcodeline": "] = f\"https://vulners.com/{info['type']}/{info['id']}\""
    }
]