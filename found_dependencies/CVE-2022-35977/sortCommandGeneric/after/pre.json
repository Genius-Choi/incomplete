[
    {
        "line": 3,
        "fullcodeline": "unsigned int outputlen = 0;"
    },
    {
        "line": 4,
        "fullcodeline": "int desc = 0, alpha = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "long limit_start = 0, limit_count = -1, start, end;"
    },
    {
        "line": 6,
        "fullcodeline": "int j, dontsort = 0, vectorlen;"
    },
    {
        "line": 7,
        "fullcodeline": "int getop = 0; /* GET operation counter */"
    },
    {
        "line": 8,
        "fullcodeline": "int int_conversion_error = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "int syntax_error = 0;"
    },
    {
        "line": 10,
        "fullcodeline": "robj *sortval, *sortby = NULL, *storekey = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "int user_has_full_key_access = 0; /* ACL - used in order to verify 'get' and 'by' options can be used */"
    },
    {
        "line": 15,
        "fullcodeline": "operations = listCreate();"
    },
    {
        "line": 16,
        "fullcodeline": "listSetFreeMethod(operations,zfree);"
    },
    {
        "line": 17,
        "fullcodeline": "j = 2; /* options start at argv[2] */"
    },
    {
        "line": 19,
        "fullcodeline": "user_has_full_key_access = ACLUserCheckCmdWithUnrestrictedKeyAccess(c->user, c->cmd, c->argv, c->argc, CMD_KEY_ACCESS);"
    },
    {
        "line": 96,
        "fullcodeline": "sortval = lookupKeyRead(c->db, c->argv[1]);"
    },
    {
        "line": 145,
        "fullcodeline": "start = min(max(limit_start, 0), vectorlen);"
    },
    {
        "line": 146,
        "fullcodeline": "limit_count = min(max(limit_count, -1), vectorlen);"
    },
    {
        "line": 147,
        "fullcodeline": "end = (limit_count < 0) ? vectorlen-1 : start+limit_count-1;"
    },
    {
        "line": 172,
        "fullcodeline": "vector = zmalloc(sizeof(redisSortObject)*vectorlen);"
    },
    {
        "line": 173,
        "fullcodeline": "j = 0;"
    },
    {
        "line": 276,
        "fullcodeline": "serverAssertWithInfo(c,sortval,j == vectorlen);"
    },
    {
        "line": 332,
        "fullcodeline": "outputlen = getop ? getop*(end-start+1) : end-start+1;"
    },
    {
        "line": 22,
        "fullcodeline": "while(j < c->argc) {"
    },
    {
        "line": 132,
        "fullcodeline": "if (sortval->type == OBJ_ZSET)"
    },
    {
        "line": 148,
        "fullcodeline": "if (start >= vectorlen) {"
    },
    {
        "line": 152,
        "fullcodeline": "if (end >= vectorlen) end = vectorlen-1;"
    },
    {
        "line": 164,
        "fullcodeline": "if ((sortval->type == OBJ_ZSET || sortval->type == OBJ_LIST) &&"
    },
    {
        "line": 175,
        "fullcodeline": "if (sortval->type == OBJ_LIST && dontsort) {"
    },
    {
        "line": 412,
        "fullcodeline": "for (j = 0; j < vectorlen; j++)"
    },
    {
        "line": 417,
        "fullcodeline": "for (j = 0; j < vectorlen; j++) {"
    },
    {
        "line": 23,
        "fullcodeline": "int leftargs = c->argc-j-1;"
    },
    {
        "line": 86,
        "fullcodeline": "j++;"
    },
    {
        "line": 91,
        "fullcodeline": "listRelease(operations);"
    },
    {
        "line": 97,
        "fullcodeline": "if (sortval && sortval->type != OBJ_SET &&"
    },
    {
        "line": 99,
        "fullcodeline": "sortval->type != OBJ_ZSET)"
    },
    {
        "line": 110,
        "fullcodeline": "incrRefCount(sortval);"
    },
    {
        "line": 121,
        "fullcodeline": "if (dontsort &&"
    },
    {
        "line": 123,
        "fullcodeline": "(storekey || c->flags & CLIENT_SCRIPT))"
    },
    {
        "line": 126,
        "fullcodeline": "dontsort = 0;"
    },
    {
        "line": 127,
        "fullcodeline": "alpha = 1;"
    },
    {
        "line": 128,
        "fullcodeline": "sortby = NULL;"
    },
    {
        "line": 133,
        "fullcodeline": "zsetConvert(sortval, OBJ_ENCODING_SKIPLIST);"
    },
    {
        "line": 137,
        "fullcodeline": "case OBJ_LIST: vectorlen = listTypeLength(sortval); break;"
    },
    {
        "line": 138,
        "fullcodeline": "case OBJ_SET: vectorlen =  setTypeSize(sortval); break;"
    },
    {
        "line": 139,
        "fullcodeline": "case OBJ_ZSET: vectorlen = dictSize(((zset*)sortval->ptr)->dict); break;"
    },
    {
        "line": 140,
        "fullcodeline": "default: vectorlen = 0; serverPanic(\"Bad SORT type\"); /* Avoid GCC warning */"
    },
    {
        "line": 149,
        "fullcodeline": "start = vectorlen-1;"
    },
    {
        "line": 150,
        "fullcodeline": "end = vectorlen-2;"
    },
    {
        "line": 166,
        "fullcodeline": "(start != 0 || end != vectorlen-1))"
    },
    {
        "line": 168,
        "fullcodeline": "vectorlen = end-start+1;"
    },
    {
        "line": 24,
        "fullcodeline": "if (!strcasecmp(c->argv[j]->ptr,\"asc\")) {"
    },
    {
        "line": 98,
        "fullcodeline": "sortval->type != OBJ_LIST &&"
    },
    {
        "line": 112,
        "fullcodeline": "sortval = createQuicklistObject();"
    },
    {
        "line": 122,
        "fullcodeline": "sortval->type == OBJ_SET &&"
    },
    {
        "line": 182,
        "fullcodeline": "if (end >= start) {"
    },
    {
        "line": 280,
        "fullcodeline": "for (j = 0; j < vectorlen; j++) {"
    },
    {
        "line": 418,
        "fullcodeline": "if (alpha && vector[j].u.cmpobj)"
    },
    {
        "line": 25,
        "fullcodeline": "desc = 0;"
    },
    {
        "line": 185,
        "fullcodeline": "li = listTypeInitIterator(sortval,"
    },
    {
        "line": 195,
        "fullcodeline": "listTypeReleaseIterator(li);"
    },
    {
        "line": 197,
        "fullcodeline": "end -= start;"
    },
    {
        "line": 198,
        "fullcodeline": "start = 0;"
    },
    {
        "line": 200,
        "fullcodeline": "} else if (sortval->type == OBJ_LIST) {"
    },
    {
        "line": 324,
        "fullcodeline": "if (sortby && (start != 0 || end != vectorlen-1))"
    },
    {
        "line": 325,
        "fullcodeline": "pqsort(vector,vectorlen,sizeof(redisSortObject),sortCompare, start,end);"
    },
    {
        "line": 335,
        "fullcodeline": "} else if (storekey == NULL) {"
    },
    {
        "line": 201,
        "fullcodeline": "listTypeIterator *li = listTypeInitIterator(sortval,0,LIST_TAIL);"
    },
    {
        "line": 209,
        "fullcodeline": "listTypeReleaseIterator(li);"
    },
    {
        "line": 327,
        "fullcodeline": "qsort(vector,vectorlen,sizeof(redisSortObject),sortCompare);"
    },
    {
        "line": 337,
        "fullcodeline": "addReplyArrayLen(c,outputlen);"
    },
    {
        "line": 26,
        "fullcodeline": "} else if (!strcasecmp(c->argv[j]->ptr,\"desc\")) {"
    },
    {
        "line": 187,
        "fullcodeline": "desc ? LIST_HEAD : LIST_TAIL);"
    },
    {
        "line": 189,
        "fullcodeline": "while(j < vectorlen && listTypeNext(li,&entry)) {"
    },
    {
        "line": 193,
        "fullcodeline": "j++;"
    },
    {
        "line": 203,
        "fullcodeline": "while(listTypeNext(li,&entry)) {"
    },
    {
        "line": 284,
        "fullcodeline": "byval = lookupKeyByPattern(c->db,sortby,vector[j].obj);"
    },
    {
        "line": 338,
        "fullcodeline": "for (j = start; j <= end; j++) {"
    },
    {
        "line": 365,
        "fullcodeline": "robj *sobj = createQuicklistObject();"
    },
    {
        "line": 27,
        "fullcodeline": "desc = 1;"
    },
    {
        "line": 190,
        "fullcodeline": "vector[j].obj = listTypeGet(&entry);"
    },
    {
        "line": 207,
        "fullcodeline": "j++;"
    },
    {
        "line": 210,
        "fullcodeline": "} else if (sortval->type == OBJ_SET) {"
    },
    {
        "line": 285,
        "fullcodeline": "if (!byval) continue;"
    },
    {
        "line": 288,
        "fullcodeline": "byval = vector[j].obj;"
    },
    {
        "line": 343,
        "fullcodeline": "listRewind(operations,&li);"
    },
    {
        "line": 368,
        "fullcodeline": "for (j = start; j <= end; j++) {"
    },
    {
        "line": 186,
        "fullcodeline": "desc ? (long)(listTypeLength(sortval) - start - 1) : start,"
    },
    {
        "line": 204,
        "fullcodeline": "vector[j].obj = listTypeGet(&entry);"
    },
    {
        "line": 211,
        "fullcodeline": "setTypeIterator *si = setTypeInitIterator(sortval);"
    },
    {
        "line": 294,
        "fullcodeline": "if (sdsEncodedObject(byval)) {"
    },
    {
        "line": 344,
        "fullcodeline": "while((ln = listNext(&li))) {"
    },
    {
        "line": 397,
        "fullcodeline": "listTypeTryConversion(sobj,LIST_CONV_AUTO,NULL,NULL);"
    },
    {
        "line": 398,
        "fullcodeline": "setKey(c,c->db,storekey,sobj,0);"
    },
    {
        "line": 399,
        "fullcodeline": "notifyKeyspaceEvent(NOTIFY_LIST,\"sortstore\",storekey,"
    },
    {
        "line": 28,
        "fullcodeline": "} else if (!strcasecmp(c->argv[j]->ptr,\"alpha\")) {"
    },
    {
        "line": 213,
        "fullcodeline": "while((sdsele = setTypeNextObject(si)) != NULL) {"
    },
    {
        "line": 292,
        "fullcodeline": "if (sortby) vector[j].u.cmpobj = getDecodedObject(byval);"
    },
    {
        "line": 297,
        "fullcodeline": "vector[j].u.score = strtod(byval->ptr,&eptr);"
    },
    {
        "line": 342,
        "fullcodeline": "if (!getop) addReplyBulk(c,vector[j].obj);"
    },
    {
        "line": 345,
        "fullcodeline": "redisSortOperation *sop = ln->value;"
    },
    {
        "line": 346,
        "fullcodeline": "robj *val = lookupKeyByPattern(c->db,sop->pattern,"
    },
    {
        "line": 29,
        "fullcodeline": "alpha = 1;"
    },
    {
        "line": 217,
        "fullcodeline": "j++;"
    },
    {
        "line": 220,
        "fullcodeline": "} else if (sortval->type == OBJ_ZSET && dontsort) {"
    },
    {
        "line": 349,
        "fullcodeline": "if (sop->type == SORT_OP_GET) {"
    },
    {
        "line": 373,
        "fullcodeline": "listTypePush(sobj,vector[j].obj,LIST_TAIL);"
    },
    {
        "line": 402,
        "fullcodeline": "} else if (dbDelete(c->db,storekey)) {"
    },
    {
        "line": 214,
        "fullcodeline": "vector[j].obj = createObject(OBJ_STRING,sdsele);"
    },
    {
        "line": 228,
        "fullcodeline": "zset *zs = sortval->ptr;"
    },
    {
        "line": 229,
        "fullcodeline": "zskiplist *zsl = zs->zsl;"
    },
    {
        "line": 232,
        "fullcodeline": "int rangelen = vectorlen;"
    },
    {
        "line": 257,
        "fullcodeline": "end -= start;"
    },
    {
        "line": 258,
        "fullcodeline": "start = 0;"
    },
    {
        "line": 298,
        "fullcodeline": "if (eptr[0] != '\\0' || errno == ERANGE ||"
    },
    {
        "line": 299,
        "fullcodeline": "isnan(vector[j].u.score))"
    },
    {
        "line": 303,
        "fullcodeline": "} else if (byval->encoding == OBJ_ENCODING_INT) {"
    },
    {
        "line": 375,
        "fullcodeline": "listRewind(operations,&li);"
    },
    {
        "line": 403,
        "fullcodeline": "signalModifiedKey(c,c->db,storekey);"
    },
    {
        "line": 404,
        "fullcodeline": "notifyKeyspaceEvent(NOTIFY_GENERIC,\"del\",storekey,c->db->id);"
    },
    {
        "line": 30,
        "fullcodeline": "} else if (!strcasecmp(c->argv[j]->ptr,\"limit\") && leftargs >= 2) {"
    },
    {
        "line": 350,
        "fullcodeline": "if (!val) {"
    },
    {
        "line": 358,
        "fullcodeline": "serverAssertWithInfo(c,sortval,sop->type == SORT_OP_GET);"
    },
    {
        "line": 376,
        "fullcodeline": "while((ln = listNext(&li))) {"
    },
    {
        "line": 39,
        "fullcodeline": "j+=2;"
    },
    {
        "line": 236,
        "fullcodeline": "long zsetlen = dictSize(((zset*)sortval->ptr)->dict);"
    },
    {
        "line": 238,
        "fullcodeline": "ln = zsl->tail;"
    },
    {
        "line": 248,
        "fullcodeline": "serverAssertWithInfo(c,sortval,ln != NULL);"
    },
    {
        "line": 249,
        "fullcodeline": "sdsele = ln->ele;"
    },
    {
        "line": 253,
        "fullcodeline": "j++;"
    },
    {
        "line": 254,
        "fullcodeline": "ln = desc ? ln->backward : ln->level[0].forward;"
    },
    {
        "line": 259,
        "fullcodeline": "} else if (sortval->type == OBJ_ZSET) {"
    },
    {
        "line": 309,
        "fullcodeline": "serverAssertWithInfo(c,sortval,1 != 1);"
    },
    {
        "line": 351,
        "fullcodeline": "addReplyNull(c);"
    },
    {
        "line": 377,
        "fullcodeline": "redisSortOperation *sop = ln->value;"
    },
    {
        "line": 378,
        "fullcodeline": "robj *val = lookupKeyByPattern(c->db,sop->pattern,"
    },
    {
        "line": 31,
        "fullcodeline": "if ((getLongFromObjectOrReply(c, c->argv[j+1], &limit_start, NULL)"
    },
    {
        "line": 239,
        "fullcodeline": "if (start > 0)"
    },
    {
        "line": 242,
        "fullcodeline": "ln = zsl->header->level[0].forward;"
    },
    {
        "line": 250,
        "fullcodeline": "vector[j].obj = createStringObject(sdsele,sdslen(sdsele));"
    },
    {
        "line": 260,
        "fullcodeline": "dict *set = ((zset*)sortval->ptr)->dict;"
    },
    {
        "line": 264,
        "fullcodeline": "di = dictGetIterator(set);"
    },
    {
        "line": 353,
        "fullcodeline": "addReplyBulk(c,val);"
    },
    {
        "line": 381,
        "fullcodeline": "if (sop->type == SORT_OP_GET) {"
    },
    {
        "line": 33,
        "fullcodeline": "(getLongFromObjectOrReply(c, c->argv[j+2], &limit_count, NULL)"
    },
    {
        "line": 36,
        "fullcodeline": "syntax_error++;"
    },
    {
        "line": 40,
        "fullcodeline": "} else if (readonly == 0 && !strcasecmp(c->argv[j]->ptr,\"store\") && leftargs >= 1) {"
    },
    {
        "line": 240,
        "fullcodeline": "ln = zslGetElementByRank(zsl,zsetlen-start);"
    },
    {
        "line": 243,
        "fullcodeline": "if (start > 0)"
    },
    {
        "line": 265,
        "fullcodeline": "while((setele = dictNext(di)) != NULL) {"
    },
    {
        "line": 387,
        "fullcodeline": "listTypePush(sobj,val,LIST_TAIL);"
    },
    {
        "line": 41,
        "fullcodeline": "storekey = c->argv[j+1];"
    },
    {
        "line": 42,
        "fullcodeline": "j++;"
    },
    {
        "line": 244,
        "fullcodeline": "ln = zslGetElementByRank(zsl,start+1);"
    },
    {
        "line": 266,
        "fullcodeline": "sdsele =  dictGetKey(setele);"
    },
    {
        "line": 270,
        "fullcodeline": "j++;"
    },
    {
        "line": 382,
        "fullcodeline": "if (!val) val = createStringObject(\"\",0);"
    },
    {
        "line": 391,
        "fullcodeline": "serverAssertWithInfo(c,sortval,sop->type == SORT_OP_GET);"
    },
    {
        "line": 267,
        "fullcodeline": "vector[j].obj = createStringObject(sdsele,sdslen(sdsele));"
    },
    {
        "line": 43,
        "fullcodeline": "} else if (!strcasecmp(c->argv[j]->ptr,\"by\") && leftargs >= 1) {"
    },
    {
        "line": 44,
        "fullcodeline": "sortby = c->argv[j+1];"
    },
    {
        "line": 65,
        "fullcodeline": "j++;"
    },
    {
        "line": 47,
        "fullcodeline": "if (strchr(c->argv[j+1]->ptr,'*') == NULL) {"
    },
    {
        "line": 48,
        "fullcodeline": "dontsort = 1;"
    },
    {
        "line": 66,
        "fullcodeline": "} else if (!strcasecmp(c->argv[j]->ptr,\"get\") && leftargs >= 1) {"
    },
    {
        "line": 77,
        "fullcodeline": "listAddNodeTail(operations,createSortOperation("
    },
    {
        "line": 79,
        "fullcodeline": "getop++;"
    },
    {
        "line": 80,
        "fullcodeline": "j++;"
    },
    {
        "line": 59,
        "fullcodeline": "if (!user_has_full_key_access) {"
    },
    {
        "line": 72,
        "fullcodeline": "if (!user_has_full_key_access) {"
    },
    {
        "line": 82,
        "fullcodeline": "addReplyErrorObject(c,shared.syntaxerr);"
    },
    {
        "line": 83,
        "fullcodeline": "syntax_error++;"
    },
    {
        "line": 53,
        "fullcodeline": "addReplyError(c,\"BY option of SORT denied in Cluster mode.\");"
    },
    {
        "line": 54,
        "fullcodeline": "syntax_error++;"
    },
    {
        "line": 60,
        "fullcodeline": "addReplyError(c,\"BY option of SORT denied due to insufficient ACL permissions.\");"
    },
    {
        "line": 61,
        "fullcodeline": "syntax_error++;"
    },
    {
        "line": 68,
        "fullcodeline": "addReplyError(c,\"GET option of SORT denied in Cluster mode.\");"
    },
    {
        "line": 69,
        "fullcodeline": "syntax_error++;"
    },
    {
        "line": 73,
        "fullcodeline": "addReplyError(c,\"GET option of SORT denied due to insufficient ACL permissions.\");"
    },
    {
        "line": 74,
        "fullcodeline": "syntax_error++;"
    }
]