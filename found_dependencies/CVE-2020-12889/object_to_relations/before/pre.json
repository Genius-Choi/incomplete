[
    {
        "line": 3,
        "fullcodeline": "if 'Object' in e['Event']:"
    },
    {
        "line": 4,
        "fullcodeline": "for eo in e['Event']['Object']:"
    },
    {
        "line": 5,
        "fullcodeline": "if 'ObjectReference' in eo:"
    },
    {
        "line": 6,
        "fullcodeline": "for ref in eo['ObjectReference']:"
    },
    {
        "line": 8,
        "fullcodeline": "if eo['uuid'] == o['uuid']:"
    },
    {
        "line": 21,
        "fullcodeline": "if ref['referenced_uuid'] == o['uuid']:"
    },
    {
        "line": 10,
        "fullcodeline": "if ref.get('Object'):"
    },
    {
        "line": 15,
        "fullcodeline": "if ref.get('Attribute'):"
    },
    {
        "line": 12,
        "fullcodeline": "sub_object = get_object_in_event(ref['Object']['uuid'], e)"
    },
    {
        "line": 16,
        "fullcodeline": "ref['Attribute']['event_id'] = ref['event_id']   # LATER remove this ugly workaround - object can't be requested directly from MISP using the uuid, and to find a full object we need the event_id"
    },
    {
        "line": 17,
        "fullcodeline": "for item in attribute_to_entity(ref['Attribute'], link_label=ref['relationship_type']):"
    }
]