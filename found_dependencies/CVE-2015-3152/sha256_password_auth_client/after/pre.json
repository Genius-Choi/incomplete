[
    {
        "line": 3,
        "fullcodeline": "bool uses_password= mysql->passwd[0] != 0;"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned char encrypted_password[MAX_CIPHER_LENGTH];"
    },
    {
        "line": 6,
        "fullcodeline": "static char request_public_key= '\\1';"
    },
    {
        "line": 7,
        "fullcodeline": "RSA *public_key= NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "bool got_public_key_from_server= false;"
    },
    {
        "line": 10,
        "fullcodeline": "bool connection_is_secure= false;"
    },
    {
        "line": 11,
        "fullcodeline": "unsigned char scramble_pkt[20];"
    },
    {
        "line": 13,
        "fullcodeline": "my_bool ssl_enforce= FALSE;"
    },
    {
        "line": 16,
        "fullcodeline": "DBUG_ENTER(\"sha256_password_auth_client\");"
    },
    {
        "line": 31,
        "fullcodeline": "memcpy(scramble_pkt, pkt, SCRAMBLE_LENGTH);"
    },
    {
        "line": 22,
        "fullcodeline": "if (vio->read_packet(vio, &pkt) != SCRAMBLE_LENGTH)"
    },
    {
        "line": 33,
        "fullcodeline": "if (mysql_get_option(mysql, MYSQL_OPT_SSL_ENFORCE, &ssl_enforce))"
    },
    {
        "line": 36,
        "fullcodeline": "if (mysql_get_ssl_cipher(mysql) != NULL)"
    },
    {
        "line": 54,
        "fullcodeline": "if (!connection_is_secure)"
    },
    {
        "line": 61,
        "fullcodeline": "if (!uses_password)"
    },
    {
        "line": 24,
        "fullcodeline": "DBUG_PRINT(\"info\",(\"Scramble is not of correct length.\"));"
    },
    {
        "line": 34,
        "fullcodeline": "ssl_enforce= FALSE;"
    },
    {
        "line": 37,
        "fullcodeline": "connection_is_secure= true;"
    },
    {
        "line": 57,
        "fullcodeline": "public_key= rsa_init(mysql);"
    },
    {
        "line": 64,
        "fullcodeline": "static const unsigned char zero_byte= '\\0';"
    },
    {
        "line": 65,
        "fullcodeline": "if (vio->write_packet(vio, (const unsigned char *) &zero_byte, 1))"
    },
    {
        "line": 71,
        "fullcodeline": "unsigned int passwd_len= strlen(mysql->passwd) + 1;"
    },
    {
        "line": 51,
        "fullcodeline": "connection_is_secure= true; // Safely assume connection will be encrypted"
    },
    {
        "line": 100,
        "fullcodeline": "xor_string(mysql->passwd, strlen(mysql->passwd), (char *) scramble_pkt,"
    },
    {
        "line": 103,
        "fullcodeline": "int cipher_length= RSA_size(public_key);"
    },
    {
        "line": 113,
        "fullcodeline": "RSA_public_encrypt(passwd_len, (unsigned char *) mysql->passwd,"
    },
    {
        "line": 78,
        "fullcodeline": "if (public_key == NULL)"
    },
    {
        "line": 88,
        "fullcodeline": "BIO* bio= BIO_new_mem_buf(pkt, pkt_len);"
    },
    {
        "line": 89,
        "fullcodeline": "public_key= PEM_read_bio_RSA_PUBKEY(bio, NULL, NULL, NULL);"
    },
    {
        "line": 131,
        "fullcodeline": "if (vio->write_packet(vio, (uchar*) mysql->passwd, passwd_len))"
    },
    {
        "line": 80,
        "fullcodeline": "if (vio->write_packet(vio, (const unsigned char *) &request_public_key,"
    },
    {
        "line": 91,
        "fullcodeline": "if (public_key == 0)"
    },
    {
        "line": 86,
        "fullcodeline": "if ((pkt_len= vio->read_packet(vio, &pkt)) == -1)"
    }
]