[
    {
        "line": 2,
        "fullcodeline": "data = request.get_json(silent=True)"
    },
    {
        "line": 80,
        "fullcodeline": "abort(400, description=\"Neither user and pass attributes nor passive flag present\")"
    },
    {
        "line": 3,
        "fullcodeline": "if not data:"
    },
    {
        "line": 6,
        "fullcodeline": "if \"user\" in data and \"pass\" in data:"
    },
    {
        "line": 4,
        "fullcodeline": "data = request.values"
    },
    {
        "line": 7,
        "fullcodeline": "username = data[\"user\"]"
    },
    {
        "line": 8,
        "fullcodeline": "password = data[\"pass\"]"
    },
    {
        "line": 9,
        "fullcodeline": "remote_addr = get_remote_address(request)"
    },
    {
        "line": 19,
        "fullcodeline": "user = octoprint.server.userManager.find_user(username)"
    },
    {
        "line": 75,
        "fullcodeline": "abort(403)"
    },
    {
        "line": 11,
        "fullcodeline": "if \"remember\" in data and data[\"remember\"] in valid_boolean_trues:"
    },
    {
        "line": 16,
        "fullcodeline": "if \"usersession.id\" in session:"
    },
    {
        "line": 20,
        "fullcodeline": "if user is not None:"
    },
    {
        "line": 77,
        "fullcodeline": "elif \"passive\" in data:"
    },
    {
        "line": 12,
        "fullcodeline": "remember = True"
    },
    {
        "line": 14,
        "fullcodeline": "remember = False"
    },
    {
        "line": 17,
        "fullcodeline": "_logout(current_user)"
    },
    {
        "line": 71,
        "fullcodeline": "auth_log("
    },
    {
        "line": 72,
        "fullcodeline": "f\"Failed login attempt for user {username} from {remote_addr}, user is unknown\""
    },
    {
        "line": 78,
        "fullcodeline": "return passive_login()"
    },
    {
        "line": 21,
        "fullcodeline": "if octoprint.server.userManager.check_password(username, password):"
    },
    {
        "line": 28,
        "fullcodeline": "user = octoprint.server.userManager.login_user(user)"
    },
    {
        "line": 29,
        "fullcodeline": "session[\"usersession.id\"] = user.session"
    },
    {
        "line": 30,
        "fullcodeline": "session[\"usersession.signature\"] = session_signature("
    },
    {
        "line": 33,
        "fullcodeline": "g.user = user"
    },
    {
        "line": 35,
        "fullcodeline": "login_user(user, remember=remember)"
    },
    {
        "line": 36,
        "fullcodeline": "identity_changed.send("
    },
    {
        "line": 39,
        "fullcodeline": "session[\"login_mechanism\"] = \"http\""
    },
    {
        "line": 47,
        "fullcodeline": "response = user.as_dict()"
    },
    {
        "line": 48,
        "fullcodeline": "response[\"_is_external_client\"] = s().getBoolean("
    },
    {
        "line": 54,
        "fullcodeline": "response[\"_login_mechanism\"] = session[\"login_mechanism\"]"
    },
    {
        "line": 56,
        "fullcodeline": "r = make_response(jsonify(response))"
    },
    {
        "line": 57,
        "fullcodeline": "r.delete_cookie(\"active_logout\")"
    },
    {
        "line": 62,
        "fullcodeline": "auth_log(f\"Logging in user {username} from {remote_addr} via credentials\")"
    },
    {
        "line": 67,
        "fullcodeline": "auth_log("
    },
    {
        "line": 22,
        "fullcodeline": "if not user.is_active:"
    },
    {
        "line": 37,
        "fullcodeline": "current_app._get_current_object(), identity=Identity(user.get_id())"
    },
    {
        "line": 41,
        "fullcodeline": "logging.getLogger(__name__).info("
    },
    {
        "line": 59,
        "fullcodeline": "eventManager().fire("
    },
    {
        "line": 68,
        "fullcodeline": "f\"Failed login attempt for user {username} from {remote_addr}, wrong password\""
    },
    {
        "line": 23,
        "fullcodeline": "auth_log("
    },
    {
        "line": 26,
        "fullcodeline": "abort(403)"
    },
    {
        "line": 50,
        "fullcodeline": ") and not util_net.is_lan_address("
    },
    {
        "line": 24,
        "fullcodeline": "f\"Failed login attempt for user {username} from {remote_addr}, user is deactivated\""
    },
    {
        "line": 42,
        "fullcodeline": "\"Actively logging in user {} from {}\".format("
    },
    {
        "line": 60,
        "fullcodeline": "Events.USER_LOGGED_IN, payload={\"username\": user.get_id()}"
    },
    {
        "line": 43,
        "fullcodeline": "user.get_id(), remote_addr"
    },
    {
        "line": 49,
        "fullcodeline": "[\"server\", \"ipCheck\", \"enabled\"]"
    },
    {
        "line": 52,
        "fullcodeline": "additional_private=s().get([\"server\", \"ipCheck\", \"trustedSubnets\"]),"
    }
]