[
    {
        "line": 28,
        "fullcodeline": "int child_pid = spawn_event_handler_child(dirname, \"post-create\", &child_stdout_fd);"
    },
    {
        "line": 30,
        "fullcodeline": "char *dup_of_dir = NULL;"
    },
    {
        "line": 31,
        "fullcodeline": "struct strbuf *cmd_output = strbuf_new();"
    },
    {
        "line": 33,
        "fullcodeline": "bool child_is_post_create = 1; /* else it is a notify child */"
    },
    {
        "line": 79,
        "fullcodeline": "int status = 0;"
    },
    {
        "line": 107,
        "fullcodeline": "const char *work_dir = (dup_of_dir ? dup_of_dir : dirname);"
    },
    {
        "line": 110,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(work_dir, /*flags:*/ 0);"
    },
    {
        "line": 116,
        "fullcodeline": "char *count_str = dd_load_text_ext(dd, FILENAME_COUNT, DD_FAIL_QUIETLY_ENOENT);"
    },
    {
        "line": 117,
        "fullcodeline": "unsigned long count = strtoul(count_str, NULL, 10);"
    },
    {
        "line": 166,
        "fullcodeline": "dd_sanitize_mode_and_owner(dd);"
    },
    {
        "line": 182,
        "fullcodeline": "child_pid = spawn_event_handler_child("
    },
    {
        "line": 188,
        "fullcodeline": "xmove_fd(fd, child_stdout_fd);"
    },
    {
        "line": 189,
        "fullcodeline": "child_is_post_create = 0;"
    },
    {
        "line": 190,
        "fullcodeline": "strbuf_clear(cmd_output);"
    },
    {
        "line": 192,
        "fullcodeline": "dup_of_dir = NULL;"
    },
    {
        "line": 196,
        "fullcodeline": "log_warning(\"Deleting problem directory '%s'\", dirname);"
    },
    {
        "line": 4,
        "fullcodeline": "if (!dir_is_in_dump_location(dirname))"
    },
    {
        "line": 90,
        "fullcodeline": "if (status != 0)"
    },
    {
        "line": 111,
        "fullcodeline": "if (!dd)"
    },
    {
        "line": 170,
        "fullcodeline": "if (!dup_of_dir)"
    },
    {
        "line": 7,
        "fullcodeline": "error_msg(\"Bad problem directory name '%s', should start with: '%s'\", dirname, g_settings_dump_location);"
    },
    {
        "line": 10,
        "fullcodeline": "if (!dir_has_correct_permissions(dirname))"
    },
    {
        "line": 17,
        "fullcodeline": "struct dump_dir *dd = dd_opendir(dirname, DD_OPEN_READONLY);"
    },
    {
        "line": 42,
        "fullcodeline": "errno = 0;"
    },
    {
        "line": 43,
        "fullcodeline": "int r = safe_read(child_stdout_fd, buf, sizeof(buf) - 1);"
    },
    {
        "line": 46,
        "fullcodeline": "buf[r] = '\\0';"
    },
    {
        "line": 49,
        "fullcodeline": "char *raw = buf;"
    },
    {
        "line": 73,
        "fullcodeline": "strbuf_append_str(cmd_output, raw);"
    },
    {
        "line": 80,
        "fullcodeline": "if (safe_waitpid(child_pid, &status, 0) <= 0)"
    },
    {
        "line": 122,
        "fullcodeline": "if ((status != 0 && dup_of_dir) || count == 0)"
    },
    {
        "line": 124,
        "fullcodeline": "count++;"
    },
    {
        "line": 125,
        "fullcodeline": "char new_count_str[sizeof(long)*3 + 2];"
    },
    {
        "line": 126,
        "fullcodeline": "sprintf(new_count_str, \"%lu\", count);"
    },
    {
        "line": 127,
        "fullcodeline": "dd_save_text(dd, FILENAME_COUNT, new_count_str);"
    },
    {
        "line": 171,
        "fullcodeline": "log_notice(\"New problem directory %s, processing\", work_dir);"
    },
    {
        "line": 18,
        "fullcodeline": "const bool complete = dd && problem_dump_dir_is_complete(dd);"
    },
    {
        "line": 41,
        "fullcodeline": "char buf[250]; /* usually we get one line, no need to have big buf */"
    },
    {
        "line": 51,
        "fullcodeline": "while ((newline = strchr(raw, '\\n')) != NULL)"
    },
    {
        "line": 92,
        "fullcodeline": "if (WIFSIGNALED(status))"
    },
    {
        "line": 99,
        "fullcodeline": "if (!dup_of_dir)"
    },
    {
        "line": 177,
        "fullcodeline": "delete_dump_dir(dirname);"
    },
    {
        "line": 53,
        "fullcodeline": "*newline = '\\0';"
    },
    {
        "line": 54,
        "fullcodeline": "strbuf_append_str(cmd_output, raw);"
    },
    {
        "line": 55,
        "fullcodeline": "char *msg = cmd_output->buf;"
    },
    {
        "line": 58,
        "fullcodeline": "log(\"%s\", msg);"
    },
    {
        "line": 67,
        "fullcodeline": "strbuf_clear(cmd_output);"
    },
    {
        "line": 69,
        "fullcodeline": "raw = newline + 1;"
    },
    {
        "line": 94,
        "fullcodeline": "log(\"'post-create' on '%s' killed by signal %d\","
    },
    {
        "line": 101,
        "fullcodeline": "log(\"'post-create' on '%s' exited with %d\","
    },
    {
        "line": 134,
        "fullcodeline": "if (strcmp(dd->dd_dirname, dirname) != 0)"
    },
    {
        "line": 137,
        "fullcodeline": "struct dump_dir *new_dd = dd_opendir(dirname, DD_OPEN_READONLY);"
    },
    {
        "line": 138,
        "fullcodeline": "char *last_ocr = NULL;"
    },
    {
        "line": 159,
        "fullcodeline": "dd_save_text(dd, FILENAME_LAST_OCCURRENCE, last_ocr);"
    },
    {
        "line": 60,
        "fullcodeline": "if (child_is_post_create"
    },
    {
        "line": 95,
        "fullcodeline": "dirname, WTERMSIG(status));"
    },
    {
        "line": 102,
        "fullcodeline": "dirname, WEXITSTATUS(status));"
    },
    {
        "line": 152,
        "fullcodeline": "if (!last_ocr)"
    },
    {
        "line": 175,
        "fullcodeline": "strrchr(dirname, '/') + 1,"
    },
    {
        "line": 176,
        "fullcodeline": "strrchr(dup_of_dir, '/') + 1);"
    },
    {
        "line": 61,
        "fullcodeline": "&& prefixcmp(msg, \"DUP_OF_DIR: \") == 0"
    },
    {
        "line": 64,
        "fullcodeline": "dup_of_dir = xstrdup(msg + strlen(\"DUP_OF_DIR: \"));"
    },
    {
        "line": 143,
        "fullcodeline": "last_ocr = dd_load_text_ext(new_dd, FILENAME_TIME,"
    },
    {
        "line": 155,
        "fullcodeline": "time_t t = time(NULL);"
    },
    {
        "line": 156,
        "fullcodeline": "last_ocr = xasprintf(\"%lu\", (long)t);"
    },
    {
        "line": 144,
        "fullcodeline": "DD_LOAD_TEXT_RETURN_NULL_ON_FAILURE | DD_FAIL_QUIETLY_ENOENT);"
    }
]