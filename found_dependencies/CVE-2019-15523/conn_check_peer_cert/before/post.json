[
    {
        "line": 5,
        "fullcodeline": "int i, cert_is_ok = -1;"
    },
    {
        "line": 10,
        "fullcodeline": "peercerts = gnutls_certificate_get_peers(conn_tls_session, &npeercerts);"
    },
    {
        "line": 7,
        "fullcodeline": "if (!csync_conn_usessl)"
    },
    {
        "line": 11,
        "fullcodeline": "if(peercerts == NULL || npeercerts == 0) {"
    },
    {
        "line": 19,
        "fullcodeline": "char certdata[2*peercerts[0].size + 1];"
    },
    {
        "line": 23,
        "fullcodeline": "certdata[2*i] = 0;"
    },
    {
        "line": 25,
        "fullcodeline": "SQL_BEGIN(\"Checking peer x509 certificate.\","
    },
    {
        "line": 43,
        "fullcodeline": "csync_debug(2, \"Peer x509 certificate is: %s\\n\", certdata);"
    },
    {
        "line": 14,
        "fullcodeline": "csync_debug(1, \"Peer did not provide an SSL X509 cetrificate.\\n\");"
    },
    {
        "line": 21,
        "fullcodeline": "for (i=0; i<peercerts[0].size; i++)"
    },
    {
        "line": 22,
        "fullcodeline": "sprintf(&certdata[2*i], \"%02X\", peercerts[0].data[i]);"
    },
    {
        "line": 27,
        "fullcodeline": "url_encode(peername))"
    },
    {
        "line": 35,
        "fullcodeline": "if (cert_is_ok < 0) {"
    },
    {
        "line": 45,
        "fullcodeline": "if (!cert_is_ok) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (!strcmp(SQL_V(0), certdata))"
    },
    {
        "line": 36,
        "fullcodeline": "csync_debug(1, \"Adding peer x509 certificate to db: %s\\n\", certdata);"
    },
    {
        "line": 37,
        "fullcodeline": "SQL(\"Adding peer x509 sha1 hash to database.\","
    },
    {
        "line": 48,
        "fullcodeline": "csync_debug(1, \"Peer did provide a wrong SSL X509 cetrificate.\\n\");"
    },
    {
        "line": 13,
        "fullcodeline": "csync_fatal(\"Peer did not provide an SSL X509 cetrificate.\\n\");"
    },
    {
        "line": 30,
        "fullcodeline": "cert_is_ok = 1;"
    },
    {
        "line": 39,
        "fullcodeline": "url_encode(peername), url_encode(certdata));"
    },
    {
        "line": 32,
        "fullcodeline": "cert_is_ok = 0;"
    },
    {
        "line": 47,
        "fullcodeline": "csync_fatal(\"Peer did provide a wrong SSL X509 cetrificate.\\n\");"
    }
]