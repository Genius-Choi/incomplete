[
    {
        "line": 7,
        "fullcodeline": "int handshake_repeat = 0;"
    },
    {
        "line": 12,
        "fullcodeline": "ASPRINTF(&ssl_keyfile, \"%s/csync2_ssl_key.pem\", systemdir);"
    },
    {
        "line": 13,
        "fullcodeline": "ASPRINTF(&ssl_certfile, \"%s/csync2_ssl_cert.pem\", systemdir);"
    },
    {
        "line": 15,
        "fullcodeline": "gnutls_global_init();"
    },
    {
        "line": 16,
        "fullcodeline": "gnutls_global_set_log_function(ssl_log);"
    },
    {
        "line": 17,
        "fullcodeline": "gnutls_global_set_log_level(10);"
    },
    {
        "line": 19,
        "fullcodeline": "gnutls_certificate_allocate_credentials(&conn_x509_cred);"
    },
    {
        "line": 21,
        "fullcodeline": "err = gnutls_certificate_set_x509_key_file(conn_x509_cred, ssl_certfile, ssl_keyfile, GNUTLS_X509_FMT_PEM);"
    },
    {
        "line": 50,
        "fullcodeline": "gnutls_init(&conn_tls_session, (server_role ? GNUTLS_SERVER : GNUTLS_CLIENT));"
    },
    {
        "line": 51,
        "fullcodeline": "gnutls_priority_set_direct(conn_tls_session, \"PERFORMANCE\", NULL);"
    },
    {
        "line": 52,
        "fullcodeline": "gnutls_credentials_set(conn_tls_session, GNUTLS_CRD_CERTIFICATE, conn_x509_cred);"
    },
    {
        "line": 59,
        "fullcodeline": "gnutls_transport_set_ptr2("
    },
    {
        "line": 106,
        "fullcodeline": "csync_conn_usessl = 1;"
    },
    {
        "line": 22,
        "fullcodeline": "if(err != GNUTLS_E_SUCCESS) {"
    },
    {
        "line": 61,
        "fullcodeline": "(gnutls_transport_ptr_t)(long)conn_fd_in,"
    },
    {
        "line": 62,
        "fullcodeline": "(gnutls_transport_ptr_t)(long)conn_fd_out"
    },
    {
        "line": 23,
        "fullcodeline": "gnutls_certificate_free_credentials(conn_x509_cred);"
    },
    {
        "line": 24,
        "fullcodeline": "gnutls_global_deinit();"
    },
    {
        "line": 26,
        "fullcodeline": "csync_fatal("
    },
    {
        "line": 36,
        "fullcodeline": "gnutls_certificate_free_cas(conn_x509_cred);"
    },
    {
        "line": 55,
        "fullcodeline": "gnutls_certificate_send_x509_rdn_sequence(conn_tls_session, 0);"
    },
    {
        "line": 56,
        "fullcodeline": "gnutls_certificate_server_set_request(conn_tls_session, GNUTLS_CERT_REQUIRE);"
    },
    {
        "line": 67,
        "fullcodeline": "handshake_repeat = 0;"
    },
    {
        "line": 68,
        "fullcodeline": "err = gnutls_handshake(conn_tls_session);"
    },
    {
        "line": 30,
        "fullcodeline": "gnutls_strerror(err),"
    },
    {
        "line": 31,
        "fullcodeline": "gnutls_strerror_name(err)"
    },
    {
        "line": 38,
        "fullcodeline": "if(gnutls_certificate_set_x509_trust_file(conn_x509_cred, ssl_certfile, GNUTLS_X509_FMT_PEM) < 1) {"
    },
    {
        "line": 48,
        "fullcodeline": "gnutls_certificate_free_ca_names(conn_x509_cred);"
    },
    {
        "line": 39,
        "fullcodeline": "gnutls_certificate_free_credentials(conn_x509_cred);"
    },
    {
        "line": 40,
        "fullcodeline": "gnutls_global_deinit();"
    },
    {
        "line": 42,
        "fullcodeline": "csync_fatal("
    },
    {
        "line": 74,
        "fullcodeline": "alrt = gnutls_alert_get(conn_tls_session);"
    },
    {
        "line": 75,
        "fullcodeline": "fprintf("
    },
    {
        "line": 80,
        "fullcodeline": "handshake_repeat = 1;"
    },
    {
        "line": 84,
        "fullcodeline": "alrt = gnutls_alert_get(conn_tls_session);"
    },
    {
        "line": 85,
        "fullcodeline": "fprintf("
    },
    {
        "line": 93,
        "fullcodeline": "gnutls_bye(conn_tls_session, GNUTLS_SHUT_RDWR);"
    },
    {
        "line": 94,
        "fullcodeline": "gnutls_deinit(conn_tls_session);"
    },
    {
        "line": 95,
        "fullcodeline": "gnutls_certificate_free_credentials(conn_x509_cred);"
    },
    {
        "line": 96,
        "fullcodeline": "gnutls_global_deinit();"
    },
    {
        "line": 98,
        "fullcodeline": "csync_fatal("
    },
    {
        "line": 78,
        "fullcodeline": "alrt, gnutls_alert_get_name(alrt)"
    },
    {
        "line": 88,
        "fullcodeline": "alrt, gnutls_alert_get_name(alrt)"
    },
    {
        "line": 100,
        "fullcodeline": "gnutls_strerror(err),"
    },
    {
        "line": 101,
        "fullcodeline": "gnutls_strerror_name(err)"
    }
]