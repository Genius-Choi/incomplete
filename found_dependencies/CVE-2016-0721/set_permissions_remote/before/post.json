[
    {
        "line": 12,
        "fullcodeline": "user_set = {}"
    },
    {
        "line": 13,
        "fullcodeline": "perm_list = []"
    },
    {
        "line": 14,
        "fullcodeline": "full_users_new = Set.new"
    },
    {
        "line": 54,
        "fullcodeline": "perm_set = Permissions::PermissionsSet.new(perm_list)"
    },
    {
        "line": 56,
        "fullcodeline": "full_users_old = Set.new"
    },
    {
        "line": 57,
        "fullcodeline": "pcs_config = PCSConfig.new(Cfgsync::PcsdSettings.from_file('{}').text())"
    },
    {
        "line": 58,
        "fullcodeline": "pcs_config.permissions_local.entity_permissions_list.each{ |entity_perm|"
    },
    {
        "line": 81,
        "fullcodeline": "2.times {"
    },
    {
        "line": 2,
        "fullcodeline": "if not allowed_for_local_cluster(session, Permissions::GRANT)"
    },
    {
        "line": 64,
        "fullcodeline": "if full_users_new != full_users_old"
    },
    {
        "line": 7,
        "fullcodeline": "data = JSON.parse(params['json_data'])"
    },
    {
        "line": 17,
        "fullcodeline": "data['permissions'].each { |key, perm|"
    },
    {
        "line": 65,
        "fullcodeline": "label = 'Full'"
    },
    {
        "line": 66,
        "fullcodeline": "Permissions.get_permission_types.each { |perm_type|"
    },
    {
        "line": 72,
        "fullcodeline": "if not allowed_for_local_cluster(session, Permissions::FULL)"
    },
    {
        "line": 9,
        "fullcodeline": "return 400, JSON.generate({'status' => 'bad_json'})"
    },
    {
        "line": 73,
        "fullcodeline": "return ["
    },
    {
        "line": 75,
        "fullcodeline": "\"Permission denied\\nOnly #{SUPERUSER} and users with #{label} \"\\"
    },
    {
        "line": 76,
        "fullcodeline": "+ \"permission can grant or revoke #{label} permission.\""
    }
]