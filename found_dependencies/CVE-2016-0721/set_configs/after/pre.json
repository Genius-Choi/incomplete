[
    {
        "line": 11,
        "fullcodeline": "has_cluster = !($cluster_name == nil or $cluster_name.empty?)"
    },
    {
        "line": 2,
        "fullcodeline": "if not allowed_for_local_cluster(auth_user, Permissions::FULL)"
    },
    {
        "line": 5,
        "fullcodeline": "return JSON.generate({'status' => 'bad_json'}) if not params['configs']"
    },
    {
        "line": 16,
        "fullcodeline": "$semaphore_cfgsync.synchronize {"
    },
    {
        "line": 7,
        "fullcodeline": "configs_json = JSON.parse(params['configs'])"
    },
    {
        "line": 12,
        "fullcodeline": "if has_cluster and $cluster_name != configs_json['cluster_name']"
    },
    {
        "line": 13,
        "fullcodeline": "return JSON.generate({'status' => 'wrong_cluster_name'})"
    },
    {
        "line": 9,
        "fullcodeline": "return JSON.generate({'status' => 'bad_json'})"
    }
]