[
    {
        "line": 6,
        "fullcodeline": "ssl_cert = (params['ssl_cert'] || '').strip"
    },
    {
        "line": 7,
        "fullcodeline": "ssl_key = (params['ssl_key'] || '').strip"
    },
    {
        "line": 2,
        "fullcodeline": "if not allowed_for_local_cluster(session, Permissions::FULL)"
    },
    {
        "line": 8,
        "fullcodeline": "if ssl_cert.empty? and !ssl_key.empty?"
    },
    {
        "line": 11,
        "fullcodeline": "if !ssl_cert.empty? and ssl_key.empty?"
    },
    {
        "line": 42,
        "fullcodeline": "return [200, 'success']"
    },
    {
        "line": 14,
        "fullcodeline": "if !ssl_cert.empty? and !ssl_key.empty?"
    },
    {
        "line": 15,
        "fullcodeline": "ssl_errors = verify_cert_key_pair(ssl_cert, ssl_key)"
    },
    {
        "line": 32,
        "fullcodeline": "cookie_secret = params['cookie_secret'].strip"
    },
    {
        "line": 9,
        "fullcodeline": "return [400, 'cannot save ssl certificate without ssl key']"
    },
    {
        "line": 12,
        "fullcodeline": "return [400, 'cannot save ssl key without ssl certificate']"
    },
    {
        "line": 16,
        "fullcodeline": "if ssl_errors and !ssl_errors.empty?"
    },
    {
        "line": 33,
        "fullcodeline": "if !cookie_secret.empty?"
    },
    {
        "line": 20,
        "fullcodeline": "write_file_lock(CRT_FILE, 0700, ssl_cert)"
    },
    {
        "line": 21,
        "fullcodeline": "write_file_lock(KEY_FILE, 0700, ssl_key)"
    },
    {
        "line": 17,
        "fullcodeline": "return [400, ssl_errors.join]"
    },
    {
        "line": 25,
        "fullcodeline": "FileUtils.rm(CRT_FILE, {:force => true})"
    },
    {
        "line": 26,
        "fullcodeline": "FileUtils.rm(KEY_FILE, {:force => true})"
    },
    {
        "line": 27,
        "fullcodeline": "return [400, \"cannot save ssl files: #{e}\"]"
    },
    {
        "line": 37,
        "fullcodeline": "return [400, \"cannot save cookie secret: #{e}\"]"
    }
]