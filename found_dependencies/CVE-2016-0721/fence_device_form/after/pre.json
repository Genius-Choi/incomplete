[
    {
        "line": 6,
        "fullcodeline": "@cur_resource = get_resource_by_id(params[:resource], get_cib_dom(auth_user))"
    },
    {
        "line": 2,
        "fullcodeline": "if not allowed_for_local_cluster(auth_user, Permissions::READ)"
    },
    {
        "line": 8,
        "fullcodeline": "if @cur_resource.instance_of?(ClusterEntity::Primitive) and @cur_resource.stonith"
    },
    {
        "line": 9,
        "fullcodeline": "@resource_agents = getFenceAgents(auth_user, @cur_resource.agentname)"
    },
    {
        "line": 10,
        "fullcodeline": "@existing_resource = true"
    },
    {
        "line": 11,
        "fullcodeline": "@fenceagent = @resource_agents[@cur_resource.type]"
    },
    {
        "line": 12,
        "fullcodeline": "erb :fenceagentform"
    }
]