[
    {
        "line": 2,
        "fullcodeline": "gui_request = ( # these are URLs for web pages"
    },
    {
        "line": 3,
        "fullcodeline": "request.path == '/' or"
    },
    {
        "line": 8,
        "fullcodeline": "if request.path.start_with?('/remote/') or request.path == '/run_pcs'"
    },
    {
        "line": 6,
        "fullcodeline": "request.path.match('/managec/.+/main')"
    },
    {
        "line": 9,
        "fullcodeline": "@auth_user = PCSAuth.loginByToken(cookies)"
    },
    {
        "line": 5,
        "fullcodeline": "request.path == '/permissions' or"
    },
    {
        "line": 10,
        "fullcodeline": "unless @auth_user"
    },
    {
        "line": 4,
        "fullcodeline": "request.path == '/manage' or"
    },
    {
        "line": 14,
        "fullcodeline": "if !gui_request and"
    },
    {
        "line": 15,
        "fullcodeline": "request.env['HTTP_X_REQUESTED_WITH'] != 'XMLHttpRequest'"
    },
    {
        "line": 21,
        "fullcodeline": "elsif not PCSAuth.isLoggedIn(session)"
    },
    {
        "line": 24,
        "fullcodeline": "redirect '/login'"
    }
]