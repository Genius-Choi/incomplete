[
    {
        "line": 5,
        "fullcodeline": "unsigned char cbuf[2 * CMSG_SPACE(sizeof(struct in6_pktinfo))];"
    },
    {
        "line": 12,
        "fullcodeline": "iovec.iov_base = buf;"
    },
    {
        "line": 13,
        "fullcodeline": "memset(&msghdr, 0, sizeof(msghdr));"
    },
    {
        "line": 14,
        "fullcodeline": "msghdr.msg_name = &sin6;"
    },
    {
        "line": 16,
        "fullcodeline": "msghdr.msg_iov = &iovec;"
    },
    {
        "line": 17,
        "fullcodeline": "msghdr.msg_iovlen = 1;"
    },
    {
        "line": 18,
        "fullcodeline": "msghdr.msg_control = cbuf;"
    },
    {
        "line": 21,
        "fullcodeline": "len = recvmsg(sockfd, &msghdr, flags);"
    },
    {
        "line": 24,
        "fullcodeline": "*buflen = len;"
    },
    {
        "line": 22,
        "fullcodeline": "if (len == -1)"
    },
    {
        "line": 32,
        "fullcodeline": "cmsghdr = CMSG_NXTHDR(&msghdr, cmsghdr)) {"
    },
    {
        "line": 31,
        "fullcodeline": "for (cmsghdr = CMSG_FIRSTHDR(&msghdr); cmsghdr;"
    },
    {
        "line": 23,
        "fullcodeline": "return -errno;"
    },
    {
        "line": 33,
        "fullcodeline": "if (cmsghdr->cmsg_level != IPPROTO_IPV6)"
    },
    {
        "line": 38,
        "fullcodeline": "if (cmsghdr->cmsg_len == CMSG_LEN(sizeof(struct in6_pktinfo))) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (cmsghdr->cmsg_len == CMSG_LEN(sizeof(int))) {"
    },
    {
        "line": 41,
        "fullcodeline": "pktinfo = (struct in6_pktinfo *) CMSG_DATA(cmsghdr);"
    },
    {
        "line": 42,
        "fullcodeline": "*ifindex = pktinfo->ipi6_ifindex;"
    },
    {
        "line": 49,
        "fullcodeline": "val = (int *) CMSG_DATA(cmsghdr);"
    }
]