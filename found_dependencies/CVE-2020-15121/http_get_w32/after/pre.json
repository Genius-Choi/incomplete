[
    {
        "line": 7,
        "fullcodeline": "HINTERNET hOpenUrl = InternetOpenUrlA (hInternet, url, NULL, 0, 0, 0);"
    },
    {
        "line": 14,
        "fullcodeline": "char *ret = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "size_t read_sz = 0x100000;"
    },
    {
        "line": 16,
        "fullcodeline": "DWORD r = 0, w = 0;"
    },
    {
        "line": 17,
        "fullcodeline": "bool res = true;"
    },
    {
        "line": 3,
        "fullcodeline": "if (!hInternet) {"
    },
    {
        "line": 8,
        "fullcodeline": "if (!hOpenUrl) {"
    },
    {
        "line": 29,
        "fullcodeline": "} while (!(res = InternetReadFile (hOpenUrl, ret + w, read_sz, &r)) || r);"
    },
    {
        "line": 4,
        "fullcodeline": "r_sys_perror (\"InternetOpenA\");"
    },
    {
        "line": 19,
        "fullcodeline": "w += r;"
    },
    {
        "line": 23,
        "fullcodeline": "char *tmp = realloc (ret, read_sz + w);"
    },
    {
        "line": 28,
        "fullcodeline": "ret = tmp;"
    },
    {
        "line": 32,
        "fullcodeline": "char *tmp = realloc (ret, (size_t)w + 1);"
    },
    {
        "line": 24,
        "fullcodeline": "if (!tmp) {"
    },
    {
        "line": 40,
        "fullcodeline": "R_FREE (ret);"
    },
    {
        "line": 20,
        "fullcodeline": "if (!res && GetLastError () == ERROR_INSUFFICIENT_BUFFER) {"
    },
    {
        "line": 21,
        "fullcodeline": "read_sz *= 2;"
    },
    {
        "line": 25,
        "fullcodeline": "R_FREE (ret);"
    },
    {
        "line": 34,
        "fullcodeline": "ret = tmp;"
    },
    {
        "line": 35,
        "fullcodeline": "ret[w] = 0;"
    },
    {
        "line": 37,
        "fullcodeline": "R_FREE (ret);"
    }
]