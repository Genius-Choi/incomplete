[
    {
        "line": 3,
        "fullcodeline": "int csock = 0;"
    },
    {
        "line": 4,
        "fullcodeline": "int flag = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "unsigned laddr = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "gnutls_session_t *session = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "crm_client_t *new_client = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "static struct mainloop_fd_callbacks lrmd_remote_fd_cb = {"
    },
    {
        "line": 16,
        "fullcodeline": "memset(&addr, 0, sizeof(addr));"
    },
    {
        "line": 17,
        "fullcodeline": "getsockname(ssock, &addr, &laddr);"
    },
    {
        "line": 59,
        "fullcodeline": "session = create_psk_tls_session(csock, GNUTLS_SERVER, psk_cred_s);"
    },
    {
        "line": 66,
        "fullcodeline": "new_client = calloc(1, sizeof(crm_client_t));"
    },
    {
        "line": 67,
        "fullcodeline": "new_client->remote = calloc(1, sizeof(crm_remote_t));"
    },
    {
        "line": 68,
        "fullcodeline": "new_client->kind = CRM_CLIENT_TLS;"
    },
    {
        "line": 69,
        "fullcodeline": "new_client->remote->tls_session = session;"
    },
    {
        "line": 70,
        "fullcodeline": "new_client->id = crm_generate_uuid();"
    },
    {
        "line": 71,
        "fullcodeline": "new_client->remote->auth_timeout ="
    },
    {
        "line": 73,
        "fullcodeline": "crm_notice(\"LRMD client connection established. %p id: %s\", new_client, new_client->id);"
    },
    {
        "line": 75,
        "fullcodeline": "new_client->remote->source ="
    },
    {
        "line": 78,
        "fullcodeline": "g_hash_table_insert(client_connections, new_client->id, new_client);"
    },
    {
        "line": 21,
        "fullcodeline": "if (addr.sa_family == AF_INET6) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (csock == -1) {"
    },
    {
        "line": 47,
        "fullcodeline": "if ((flag = fcntl(csock, F_GETFL)) >= 0) {"
    },
    {
        "line": 60,
        "fullcodeline": "if (session == NULL) {"
    },
    {
        "line": 72,
        "fullcodeline": "g_timeout_add(LRMD_REMOTE_AUTH_TIMEOUT, lrmd_auth_timeout_cb, new_client);"
    },
    {
        "line": 76,
        "fullcodeline": "mainloop_add_fd(\"lrmd-remote-client\", G_PRIORITY_DEFAULT, csock, new_client,"
    },
    {
        "line": 23,
        "fullcodeline": "char addr_str[INET6_ADDRSTRLEN];"
    },
    {
        "line": 26,
        "fullcodeline": "memset(&sa, 0, sizeof(sa));"
    },
    {
        "line": 27,
        "fullcodeline": "csock = accept(ssock, &sa, &laddr);"
    },
    {
        "line": 28,
        "fullcodeline": "get_ip_str((struct sockaddr *)&sa, addr_str, INET6_ADDRSTRLEN);"
    },
    {
        "line": 29,
        "fullcodeline": "crm_info(\"New remote connection from %s\", addr_str);"
    },
    {
        "line": 43,
        "fullcodeline": "crm_err(\"accept socket failed\");"
    },
    {
        "line": 61,
        "fullcodeline": "crm_err(\"TLS session creation failed\");"
    },
    {
        "line": 62,
        "fullcodeline": "close(csock);"
    },
    {
        "line": 11,
        "fullcodeline": ".dispatch = lrmd_remote_client_msg,"
    },
    {
        "line": 12,
        "fullcodeline": ".destroy = lrmd_remote_client_destroy,"
    },
    {
        "line": 33,
        "fullcodeline": "char addr_str[INET_ADDRSTRLEN];"
    },
    {
        "line": 36,
        "fullcodeline": "memset(&sa, 0, sizeof(sa));"
    },
    {
        "line": 37,
        "fullcodeline": "csock = accept(ssock, &sa, &laddr);"
    },
    {
        "line": 38,
        "fullcodeline": "get_ip_str((struct sockaddr *)&sa, addr_str, INET_ADDRSTRLEN);"
    },
    {
        "line": 39,
        "fullcodeline": "crm_info(\"New remote connection from %s\", addr_str);"
    },
    {
        "line": 48,
        "fullcodeline": "if (fcntl(csock, F_SETFL, flag | O_NONBLOCK) < 0) {"
    },
    {
        "line": 54,
        "fullcodeline": "crm_err(\"fcntl() read failed\");"
    },
    {
        "line": 55,
        "fullcodeline": "close(csock);"
    },
    {
        "line": 49,
        "fullcodeline": "crm_err(\"fcntl() write failed\");"
    },
    {
        "line": 50,
        "fullcodeline": "close(csock);"
    }
]