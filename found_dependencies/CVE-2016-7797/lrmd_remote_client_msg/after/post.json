[
    {
        "line": 3,
        "fullcodeline": "int id = 0;"
    },
    {
        "line": 4,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "int disconnected = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "xmlNode *request = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "crm_client_t *client = data;"
    },
    {
        "line": 37,
        "fullcodeline": "rc = crm_remote_ready(client->remote, 0);"
    },
    {
        "line": 46,
        "fullcodeline": "crm_remote_recv(client->remote, -1, &disconnected);"
    },
    {
        "line": 48,
        "fullcodeline": "request = crm_remote_parse_buffer(client->remote);"
    },
    {
        "line": 9,
        "fullcodeline": "if (client->remote->tls_handshake_complete == FALSE) {"
    },
    {
        "line": 38,
        "fullcodeline": "if (rc == 0) {"
    },
    {
        "line": 10,
        "fullcodeline": "int rc = 0;"
    },
    {
        "line": 50,
        "fullcodeline": "crm_element_value_int(request, F_LRMD_REMOTE_MSG_ID, &id);"
    },
    {
        "line": 51,
        "fullcodeline": "crm_trace(\"processing request from remote client with remote msg id %d\", id);"
    },
    {
        "line": 60,
        "fullcodeline": "lrmd_call_id++;"
    },
    {
        "line": 65,
        "fullcodeline": "crm_xml_add(request, F_LRMD_CLIENTID, client->id);"
    },
    {
        "line": 66,
        "fullcodeline": "crm_xml_add(request, F_LRMD_CLIENTNAME, client->name);"
    },
    {
        "line": 67,
        "fullcodeline": "crm_xml_add_int(request, F_LRMD_CALLID, lrmd_call_id);"
    },
    {
        "line": 69,
        "fullcodeline": "process_lrmd_message(client, id, request);"
    },
    {
        "line": 70,
        "fullcodeline": "free_xml(request);"
    },
    {
        "line": 73,
        "fullcodeline": "request = crm_remote_parse_buffer(client->remote);"
    },
    {
        "line": 77,
        "fullcodeline": "crm_info(\"Client disconnect detected in tls msg dispatcher.\");"
    },
    {
        "line": 21,
        "fullcodeline": "} while (rc == GNUTLS_E_INTERRUPTED);"
    },
    {
        "line": 23,
        "fullcodeline": "if (rc == 0) {"
    },
    {
        "line": 52,
        "fullcodeline": "if (!client->name) {"
    },
    {
        "line": 61,
        "fullcodeline": "if (lrmd_call_id < 1) {"
    },
    {
        "line": 78,
        "fullcodeline": "return -1;"
    },
    {
        "line": 15,
        "fullcodeline": "rc = gnutls_handshake(*client->remote->tls_session);"
    },
    {
        "line": 24,
        "fullcodeline": "crm_debug(\"Remote lrmd tls handshake completed\");"
    },
    {
        "line": 25,
        "fullcodeline": "client->remote->tls_handshake_complete = TRUE;"
    },
    {
        "line": 29,
        "fullcodeline": "client->remote->auth_timeout = 0;"
    },
    {
        "line": 32,
        "fullcodeline": "notify_of_new_client(client);"
    },
    {
        "line": 41,
        "fullcodeline": "} else if (rc < 0) {"
    },
    {
        "line": 53,
        "fullcodeline": "const char *value = crm_element_value(request, F_LRMD_CLIENTNAME);"
    },
    {
        "line": 62,
        "fullcodeline": "lrmd_call_id = 1;"
    },
    {
        "line": 17,
        "fullcodeline": "if (rc < 0 && rc != GNUTLS_E_AGAIN) {"
    },
    {
        "line": 42,
        "fullcodeline": "crm_info(\"Client disconnected during remote client read\");"
    },
    {
        "line": 18,
        "fullcodeline": "crm_err(\"Remote lrmd tls handshake failed\");"
    },
    {
        "line": 43,
        "fullcodeline": "return -1;"
    },
    {
        "line": 56,
        "fullcodeline": "client->name = strdup(value);"
    },
    {
        "line": 19,
        "fullcodeline": "return -1;"
    }
]