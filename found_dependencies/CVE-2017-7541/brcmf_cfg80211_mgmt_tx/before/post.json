[
    {
        "line": 4,
        "fullcodeline": "struct brcmf_cfg80211_info *cfg = wiphy_to_cfg(wiphy);"
    },
    {
        "line": 5,
        "fullcodeline": "struct ieee80211_channel *chan = params->chan;"
    },
    {
        "line": 6,
        "fullcodeline": "const u8 *buf = params->buf;"
    },
    {
        "line": 7,
        "fullcodeline": "size_t len = params->len;"
    },
    {
        "line": 10,
        "fullcodeline": "s32 err = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "brcmf_dbg(TRACE, \"Enter\\n\");"
    },
    {
        "line": 21,
        "fullcodeline": "*cookie = 0;"
    },
    {
        "line": 23,
        "fullcodeline": "mgmt = (const struct ieee80211_mgmt *)buf;"
    },
    {
        "line": 25,
        "fullcodeline": "if (!ieee80211_is_mgmt(mgmt->frame_control)) {"
    },
    {
        "line": 32,
        "fullcodeline": "if (ieee80211_is_probe_resp(mgmt->frame_control)) {"
    },
    {
        "line": 26,
        "fullcodeline": "brcmf_err(\"Driver only allows MGMT packet type\\n\");"
    },
    {
        "line": 44,
        "fullcodeline": "ie_offset =  DOT11_MGMT_HDR_LEN +"
    },
    {
        "line": 46,
        "fullcodeline": "ie_len = len - ie_offset;"
    },
    {
        "line": 49,
        "fullcodeline": "err = brcmf_vif_set_mgmt_ie(vif,"
    },
    {
        "line": 53,
        "fullcodeline": "cfg80211_mgmt_tx_status(wdev, *cookie, buf, len, true,"
    },
    {
        "line": 27,
        "fullcodeline": "return -EPERM;"
    },
    {
        "line": 47,
        "fullcodeline": "if (vif == cfg->p2p.bss_idx[P2PAPI_BSSCFG_PRIMARY].vif)"
    },
    {
        "line": 55,
        "fullcodeline": "} else if (ieee80211_is_action(mgmt->frame_control)) {"
    },
    {
        "line": 56,
        "fullcodeline": "af_params = kzalloc(sizeof(*af_params), GFP_KERNEL);"
    },
    {
        "line": 62,
        "fullcodeline": "action_frame = &af_params->action_frame;"
    },
    {
        "line": 64,
        "fullcodeline": "action_frame->packet_id = cpu_to_le32(*cookie);"
    },
    {
        "line": 66,
        "fullcodeline": "memcpy(&action_frame->da[0], &mgmt->da[0], ETH_ALEN);"
    },
    {
        "line": 67,
        "fullcodeline": "memcpy(&af_params->bssid[0], &mgmt->bssid[0], ETH_ALEN);"
    },
    {
        "line": 69,
        "fullcodeline": "action_frame->len = cpu_to_le16(len - DOT11_MGMT_HDR_LEN);"
    },
    {
        "line": 78,
        "fullcodeline": "chan_nr = ieee80211_frequency_to_channel(freq);"
    },
    {
        "line": 79,
        "fullcodeline": "af_params->channel = cpu_to_le32(chan_nr);"
    },
    {
        "line": 81,
        "fullcodeline": "memcpy(action_frame->data, &buf[DOT11_MGMT_HDR_LEN],"
    },
    {
        "line": 84,
        "fullcodeline": "brcmf_dbg(TRACE, \"Action frame, cookie=%lld, len=%d, freq=%d\\n\","
    },
    {
        "line": 87,
        "fullcodeline": "ack = brcmf_p2p_send_action_frame(cfg, cfg_to_ndev(cfg),"
    },
    {
        "line": 90,
        "fullcodeline": "cfg80211_mgmt_tx_status(wdev, *cookie, buf, len, ack,"
    },
    {
        "line": 92,
        "fullcodeline": "kfree(af_params);"
    },
    {
        "line": 57,
        "fullcodeline": "if (af_params == NULL) {"
    },
    {
        "line": 82,
        "fullcodeline": "le16_to_cpu(action_frame->len));"
    },
    {
        "line": 85,
        "fullcodeline": "*cookie, le16_to_cpu(action_frame->len), freq);"
    },
    {
        "line": 94,
        "fullcodeline": "brcmf_dbg(TRACE, \"Unhandled, fc=%04x!!\\n\", mgmt->frame_control);"
    },
    {
        "line": 95,
        "fullcodeline": "brcmf_dbg_hex_dump(true, buf, len, \"payload, len=%zu\\n\", len);"
    },
    {
        "line": 58,
        "fullcodeline": "brcmf_err(\"unable to allocate frame\\n\");"
    },
    {
        "line": 59,
        "fullcodeline": "err = -ENOMEM;"
    },
    {
        "line": 74,
        "fullcodeline": "freq = chan->center_freq;"
    },
    {
        "line": 76,
        "fullcodeline": "brcmf_fil_cmd_int_get(vif->ifp, BRCMF_C_GET_CHANNEL,"
    }
]