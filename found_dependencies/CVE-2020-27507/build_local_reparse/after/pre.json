[
    {
        "line": 15,
        "fullcodeline": "int hadded = 0;"
    },
    {
        "line": 16,
        "fullcodeline": "sr_cfgenv_t *cenv = NULL;"
    },
    {
        "line": 17,
        "fullcodeline": "hdr_flags_t hdr_flags = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "invite_buf = Trans->uac[branch].request.buffer;"
    },
    {
        "line": 20,
        "fullcodeline": "invite_len = Trans->uac[branch].request.buffer_len;"
    },
    {
        "line": 32,
        "fullcodeline": "reason_len = 0;"
    },
    {
        "line": 33,
        "fullcodeline": "reas1 = 0;"
    },
    {
        "line": 34,
        "fullcodeline": "reas_last = 0;"
    },
    {
        "line": 64,
        "fullcodeline": "invite_buf_end = invite_buf + invite_len;"
    },
    {
        "line": 65,
        "fullcodeline": "s = invite_buf;"
    },
    {
        "line": 71,
        "fullcodeline": "to_len = to ? to->len : 0;"
    },
    {
        "line": 72,
        "fullcodeline": "cancel_buf_len = invite_len + to_len + reason_len;"
    },
    {
        "line": 74,
        "fullcodeline": "cancel_buf = shm_malloc(sizeof(char)*cancel_buf_len);"
    },
    {
        "line": 80,
        "fullcodeline": "d = cancel_buf;"
    },
    {
        "line": 83,
        "fullcodeline": "append_str(d, method, method_len);"
    },
    {
        "line": 84,
        "fullcodeline": "*d = ' ';"
    },
    {
        "line": 85,
        "fullcodeline": "d++;"
    },
    {
        "line": 87,
        "fullcodeline": "s += 7;"
    },
    {
        "line": 88,
        "fullcodeline": "s1 = s;"
    },
    {
        "line": 89,
        "fullcodeline": "s = eat_line(s, invite_buf_end - s);"
    },
    {
        "line": 90,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 92,
        "fullcodeline": "cenv = sr_cfgenv_get();"
    },
    {
        "line": 96,
        "fullcodeline": "first_via = 1;"
    },
    {
        "line": 22,
        "fullcodeline": "if (!invite_buf || invite_len<=0) {"
    },
    {
        "line": 26,
        "fullcodeline": "if ((*invite_buf != 'I') && (*invite_buf != 'i')) {"
    },
    {
        "line": 36,
        "fullcodeline": "if (reason && reason->cause != CANCEL_REAS_UNKNOWN){"
    },
    {
        "line": 75,
        "fullcodeline": "if (!cancel_buf)"
    },
    {
        "line": 97,
        "fullcodeline": "while (s < invite_buf_end) {"
    },
    {
        "line": 98,
        "fullcodeline": "s1 = s;"
    },
    {
        "line": 37,
        "fullcodeline": "if (likely(reason->cause > 0 &&"
    },
    {
        "line": 99,
        "fullcodeline": "if ((*s == '\\n') || (*s == '\\r')) {"
    },
    {
        "line": 40,
        "fullcodeline": "reason_len = REASON_PREFIX_LEN + USHORT2SBUF_MAX_LEN +"
    },
    {
        "line": 101,
        "fullcodeline": "hf_type = HDR_EOH_T;"
    },
    {
        "line": 115,
        "fullcodeline": "hdr_flags |=  HDR_CSEQ_F;"
    },
    {
        "line": 120,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 121,
        "fullcodeline": "append_str(d, method, method_len);"
    },
    {
        "line": 122,
        "fullcodeline": "append_str(d, CRLF, CRLF_LEN);"
    },
    {
        "line": 123,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 127,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 140,
        "fullcodeline": "hdr_flags |=  HDR_TO_F;"
    },
    {
        "line": 161,
        "fullcodeline": "hdr_flags |=  HDR_FROM_F;"
    },
    {
        "line": 162,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 163,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 171,
        "fullcodeline": "hdr_flags |=  HDR_CALLID_F;"
    },
    {
        "line": 172,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 173,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 178,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 179,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 185,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 190,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 193,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 231,
        "fullcodeline": "append_str(d, CRLF, CRLF_LEN);"
    },
    {
        "line": 232,
        "fullcodeline": "*len = d - cancel_buf;"
    },
    {
        "line": 237,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 238,
        "fullcodeline": "hadded = 0;"
    },
    {
        "line": 38,
        "fullcodeline": "cfg_get(tm, tm_cfg, local_cancel_reason))){"
    },
    {
        "line": 104,
        "fullcodeline": "s = lw_get_hf_name(s, invite_buf_end,"
    },
    {
        "line": 111,
        "fullcodeline": "if(hdr_flags &  HDR_CSEQ_F) {"
    },
    {
        "line": 116,
        "fullcodeline": "while ((s < invite_buf_end)"
    },
    {
        "line": 119,
        "fullcodeline": ") s++;"
    },
    {
        "line": 136,
        "fullcodeline": "if(hdr_flags &  HDR_TO_F) {"
    },
    {
        "line": 142,
        "fullcodeline": "if (to_len == 0) {"
    },
    {
        "line": 157,
        "fullcodeline": "if(hdr_flags &  HDR_FROM_F) {"
    },
    {
        "line": 167,
        "fullcodeline": "if(hdr_flags &  HDR_CALLID_F) {"
    },
    {
        "line": 241,
        "fullcodeline": "if(Trans->uas.request &&"
    },
    {
        "line": 258,
        "fullcodeline": "if(likely(hadded==0)) {"
    },
    {
        "line": 44,
        "fullcodeline": "} else if (likely(reason->cause == CANCEL_REAS_PACKED_HDRS &&"
    },
    {
        "line": 117,
        "fullcodeline": "&& ((*s == ':') || (*s == ' ') || (*s == '\\t') ||"
    },
    {
        "line": 130,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 131,
        "fullcodeline": "first_via = 0;"
    },
    {
        "line": 145,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 146,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 242,
        "fullcodeline": "(Trans->uas.request->msg_flags & FL_UAC_AUTH)) {"
    },
    {
        "line": 41,
        "fullcodeline": "(reason->u.text.s?"
    },
    {
        "line": 46,
        "fullcodeline": "reason_len = reason->u.packed_hdrs.len;"
    },
    {
        "line": 118,
        "fullcodeline": "((*s >= '0') && (*s <= '9')))"
    },
    {
        "line": 149,
        "fullcodeline": "append_str(d, to->s, to->len);"
    },
    {
        "line": 151,
        "fullcodeline": "s = lw_next_line(s, invite_buf_end);"
    },
    {
        "line": 202,
        "fullcodeline": "if (likely(reason->cause > 0)) {"
    },
    {
        "line": 243,
        "fullcodeline": "if(s1 + cenv->uac_cseq_auth.len + 2 < invite_buf_end) {"
    },
    {
        "line": 259,
        "fullcodeline": "if (cfg_get(tm, tm_cfg, ac_extra_hdrs).len"
    },
    {
        "line": 42,
        "fullcodeline": "REASON_TEXT_LEN + 1 + reason->u.text.len + 1 : 0) +"
    },
    {
        "line": 45,
        "fullcodeline": "!(Trans->flags & T_NO_E2E_CANCEL_REASON))) {"
    },
    {
        "line": 203,
        "fullcodeline": "append_str(d, REASON_PREFIX, REASON_PREFIX_LEN);"
    },
    {
        "line": 204,
        "fullcodeline": "code_len=ushort2sbuf(reason->cause, d,"
    },
    {
        "line": 208,
        "fullcodeline": "d+=code_len;"
    },
    {
        "line": 216,
        "fullcodeline": "append_str(d, CRLF, CRLF_LEN);"
    },
    {
        "line": 261,
        "fullcodeline": "&& (strncasecmp(s1,"
    },
    {
        "line": 264,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 47,
        "fullcodeline": "} else if (reason->cause == CANCEL_REAS_RCVD_CANCEL &&"
    },
    {
        "line": 206,
        "fullcodeline": "if (unlikely(code_len==0))"
    },
    {
        "line": 244,
        "fullcodeline": "if(s1[cenv->uac_cseq_auth.len]==':'"
    },
    {
        "line": 260,
        "fullcodeline": "&& (s1 + cfg_get(tm, tm_cfg, ac_extra_hdrs).len < invite_buf_end)"
    },
    {
        "line": 49,
        "fullcodeline": "!(Trans->flags & T_NO_E2E_CANCEL_REASON)) {"
    },
    {
        "line": 205,
        "fullcodeline": "cancel_buf_len-(int)(d-cancel_buf));"
    },
    {
        "line": 207,
        "fullcodeline": "LM_BUG(\"not enough space to write reason code\");"
    },
    {
        "line": 210,
        "fullcodeline": "append_str(d, REASON_TEXT, REASON_TEXT_LEN);"
    },
    {
        "line": 211,
        "fullcodeline": "*d='\"'; d++;"
    },
    {
        "line": 212,
        "fullcodeline": "append_str(d, reason->u.text.s,"
    },
    {
        "line": 214,
        "fullcodeline": "*d='\"'; d++;"
    },
    {
        "line": 217,
        "fullcodeline": "} else if (likely(reason->cause =="
    },
    {
        "line": 245,
        "fullcodeline": "&& strncmp(s1, cenv->uac_cseq_auth.s,"
    },
    {
        "line": 247,
        "fullcodeline": "hadded = 1;"
    },
    {
        "line": 248,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 51,
        "fullcodeline": "if(parse_headers(reason->u.e2e_cancel, HDR_EOH_F, 0)<0) {"
    },
    {
        "line": 55,
        "fullcodeline": "hdr; hdr=next_sibling_hdr(hdr)) {"
    },
    {
        "line": 219,
        "fullcodeline": "append_str(d, reason->u.packed_hdrs.s,"
    },
    {
        "line": 262,
        "fullcodeline": "cfg_get(tm, tm_cfg, ac_extra_hdrs).s,"
    },
    {
        "line": 263,
        "fullcodeline": "cfg_get(tm, tm_cfg, ac_extra_hdrs).len) == 0)) {"
    },
    {
        "line": 52,
        "fullcodeline": "LM_WARN(\"failed to parse headers\\n\");"
    },
    {
        "line": 54,
        "fullcodeline": "for(hdr=get_hdr(reason->u.e2e_cancel, HDR_REASON_T), reas1=hdr;"
    },
    {
        "line": 57,
        "fullcodeline": "reason_len += hdr->len;"
    },
    {
        "line": 58,
        "fullcodeline": "reas_last=hdr;"
    },
    {
        "line": 60,
        "fullcodeline": "} else if (unlikely(reason->cause < CANCEL_REAS_MIN))"
    },
    {
        "line": 249,
        "fullcodeline": "} else if(s1[cenv->uac_cseq_refresh.len]==':'"
    },
    {
        "line": 61,
        "fullcodeline": "LM_BUG(\"unhandled reason cause %d\\n\", reason->cause);"
    },
    {
        "line": 221,
        "fullcodeline": "} else if (reason->cause == CANCEL_REAS_RCVD_CANCEL) {"
    },
    {
        "line": 250,
        "fullcodeline": "&& strncmp(s1, cenv->uac_cseq_refresh.s,"
    },
    {
        "line": 252,
        "fullcodeline": "hadded = 1;"
    },
    {
        "line": 253,
        "fullcodeline": "append_str(d, s1, s - s1);"
    },
    {
        "line": 222,
        "fullcodeline": "for(hdr=reas1; hdr; hdr=next_sibling_hdr(hdr)) {"
    },
    {
        "line": 224,
        "fullcodeline": "append_str(d, hdr->name.s, hdr->len);"
    },
    {
        "line": 225,
        "fullcodeline": "if (likely(hdr==reas_last))"
    }
]