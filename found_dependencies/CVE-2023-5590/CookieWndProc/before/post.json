[
    {
        "line": 2,
        "fullcodeline": "CWPSTRUCT* call_window_proc_struct = reinterpret_cast<CWPSTRUCT*>(lParam);"
    },
    {
        "line": 3,
        "fullcodeline": "if (WM_COPYDATA == call_window_proc_struct->message) {"
    },
    {
        "line": 245,
        "fullcodeline": "return ::CallNextHookEx(NULL, nCode, wParam, lParam);"
    },
    {
        "line": 4,
        "fullcodeline": "COPYDATASTRUCT* data = reinterpret_cast<COPYDATASTRUCT*>(call_window_proc_struct->lParam);"
    },
    {
        "line": 5,
        "fullcodeline": "webdriver::HookProcessor::CopyDataToBuffer(data->cbData, data->lpData);"
    },
    {
        "line": 6,
        "fullcodeline": "} else if (WD_GET_ALL_COOKIES == call_window_proc_struct->message) {"
    },
    {
        "line": 7,
        "fullcodeline": "std::wstring url = webdriver::HookProcessor::CopyWStringFromBuffer();"
    },
    {
        "line": 8,
        "fullcodeline": "int driver_process_id = static_cast<int>(call_window_proc_struct->wParam);"
    },
    {
        "line": 10,
        "fullcodeline": "CComPtr<IUri> uri_pointer;"
    },
    {
        "line": 11,
        "fullcodeline": "HRESULT hr = ::CreateUri(url.c_str(), Uri_CREATE_ALLOW_RELATIVE, 0, &uri_pointer);"
    },
    {
        "line": 12,
        "fullcodeline": "DWORD scheme = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "uri_pointer->GetScheme(&scheme);"
    },
    {
        "line": 15,
        "fullcodeline": "uri_pointer->GetSchemeName(&scheme_bstr);"
    },
    {
        "line": 17,
        "fullcodeline": "uri_pointer->GetHost(&host_bstr);"
    },
    {
        "line": 19,
        "fullcodeline": "uri_pointer->GetPath(&path_bstr);"
    },
    {
        "line": 21,
        "fullcodeline": "std::wstring parsed_uri = scheme_bstr;"
    },
    {
        "line": 22,
        "fullcodeline": "parsed_uri.append(L\"://\");"
    },
    {
        "line": 23,
        "fullcodeline": "parsed_uri.append(host_bstr);"
    },
    {
        "line": 24,
        "fullcodeline": "parsed_uri.append(path_bstr);"
    },
    {
        "line": 26,
        "fullcodeline": "InternetGetCookieEx2Proc get_cookie_proc = NULL;"
    },
    {
        "line": 27,
        "fullcodeline": "InternetFreeCookiesProc free_cookies_proc = NULL;"
    },
    {
        "line": 28,
        "fullcodeline": "HMODULE wininet_handle = ::GetModuleHandle(L\"wininet\");"
    },
    {
        "line": 34,
        "fullcodeline": "DWORD cookie_count = 0;"
    },
    {
        "line": 35,
        "fullcodeline": "INTERNETCOOKIE2* cookie_pointer = NULL;"
    },
    {
        "line": 36,
        "fullcodeline": "DWORD success = 1;"
    },
    {
        "line": 88,
        "fullcodeline": "webdriver::HookProcessor::WriteBufferToPipe(driver_process_id);"
    },
    {
        "line": 45,
        "fullcodeline": "if (success == 0) {"
    },
    {
        "line": 30,
        "fullcodeline": "get_cookie_proc = reinterpret_cast<InternetGetCookieEx2Proc>(::GetProcAddress(wininet_handle, \"InternetGetCookieEx2\"));"
    },
    {
        "line": 31,
        "fullcodeline": "free_cookies_proc = reinterpret_cast<InternetFreeCookiesProc>(::GetProcAddress(wininet_handle, \"InternetFreeCookies\"));"
    },
    {
        "line": 38,
        "fullcodeline": "success = get_cookie_proc(parsed_uri.c_str(),"
    },
    {
        "line": 48,
        "fullcodeline": "std::wstring all_cookies = L\"\";"
    },
    {
        "line": 83,
        "fullcodeline": "free_cookies_proc(cookie_pointer, cookie_count);"
    },
    {
        "line": 84,
        "fullcodeline": "webdriver::HookProcessor::CopyWStringToBuffer(all_cookies);"
    },
    {
        "line": 89,
        "fullcodeline": "} else if (WD_GET_HTTPONLY_COOKIES == call_window_proc_struct->message ||"
    },
    {
        "line": 49,
        "fullcodeline": "for (DWORD cookie_index = 0; cookie_index < cookie_count; ++cookie_index) {"
    },
    {
        "line": 91,
        "fullcodeline": "WD_GET_SECURE_COOKIES == call_window_proc_struct->message) {"
    },
    {
        "line": 92,
        "fullcodeline": "std::wstring url = webdriver::HookProcessor::CopyWStringFromBuffer();"
    },
    {
        "line": 93,
        "fullcodeline": "int driver_process_id = static_cast<int>(call_window_proc_struct->wParam);"
    },
    {
        "line": 95,
        "fullcodeline": "DWORD get_cookie_flags = 0;"
    },
    {
        "line": 101,
        "fullcodeline": "CComPtr<IUri> uri_pointer;"
    },
    {
        "line": 102,
        "fullcodeline": "HRESULT hr = ::CreateUri(url.c_str(), Uri_CREATE_ALLOW_RELATIVE, 0, &uri_pointer);"
    },
    {
        "line": 103,
        "fullcodeline": "DWORD scheme = 0;"
    },
    {
        "line": 104,
        "fullcodeline": "uri_pointer->GetScheme(&scheme);"
    },
    {
        "line": 106,
        "fullcodeline": "uri_pointer->GetSchemeName(&scheme_bstr);"
    },
    {
        "line": 108,
        "fullcodeline": "uri_pointer->GetHost(&host_bstr);"
    },
    {
        "line": 110,
        "fullcodeline": "uri_pointer->GetPath(&path_bstr);"
    },
    {
        "line": 116,
        "fullcodeline": "std::wstring parsed_uri = L\"http\";"
    },
    {
        "line": 122,
        "fullcodeline": "parsed_uri.append(L\"://\");"
    },
    {
        "line": 123,
        "fullcodeline": "parsed_uri.append(host_bstr);"
    },
    {
        "line": 124,
        "fullcodeline": "parsed_uri.append(path_bstr);"
    },
    {
        "line": 128,
        "fullcodeline": "DWORD buffer_size = 0;"
    },
    {
        "line": 129,
        "fullcodeline": "BOOL success = ::InternetGetCookieEx(parsed_uri.c_str(),"
    },
    {
        "line": 53,
        "fullcodeline": "INTERNETCOOKIE2* current_cookie = cookie_pointer + cookie_index;"
    },
    {
        "line": 54,
        "fullcodeline": "std::wstring cookie_name = current_cookie->pwszName;"
    },
    {
        "line": 55,
        "fullcodeline": "std::wstring cookie_value = L\"\";"
    },
    {
        "line": 59,
        "fullcodeline": "std::wstring cookie_domain = L\"\";"
    },
    {
        "line": 63,
        "fullcodeline": "std::wstring cookie_path = L\"\";"
    },
    {
        "line": 67,
        "fullcodeline": "DWORD flags = current_cookie->dwFlags;"
    },
    {
        "line": 68,
        "fullcodeline": "FILETIME expires = current_cookie->ftExpires;"
    },
    {
        "line": 69,
        "fullcodeline": "all_cookies.append(cookie_name).append(L\"\\n\");"
    },
    {
        "line": 70,
        "fullcodeline": "all_cookies.append(cookie_value).append(L\"\\n\");"
    },
    {
        "line": 71,
        "fullcodeline": "all_cookies.append(cookie_domain).append(L\"/\").append(cookie_path).append(L\"\\n\");"
    },
    {
        "line": 72,
        "fullcodeline": "all_cookies.append(std::to_wstring(flags)).append(L\"\\n\");"
    },
    {
        "line": 90,
        "fullcodeline": "WD_GET_SCRIPTABLE_COOKIES == call_window_proc_struct->message ||"
    },
    {
        "line": 96,
        "fullcodeline": "if (WD_GET_HTTPONLY_COOKIES == call_window_proc_struct->message ||"
    },
    {
        "line": 117,
        "fullcodeline": "if ((WD_GET_SECURE_COOKIES == call_window_proc_struct->message ||"
    },
    {
        "line": 50,
        "fullcodeline": "if (all_cookies.size() > 0) {"
    },
    {
        "line": 97,
        "fullcodeline": "WD_GET_SECURE_COOKIES == call_window_proc_struct->message) {"
    },
    {
        "line": 98,
        "fullcodeline": "get_cookie_flags = INTERNET_COOKIE_HTTPONLY;"
    },
    {
        "line": 119,
        "fullcodeline": "URL_SCHEME_HTTPS == scheme) {"
    },
    {
        "line": 120,
        "fullcodeline": "parsed_uri.append(L\"s\");"
    },
    {
        "line": 136,
        "fullcodeline": "webdriver::HookProcessor::SetDataBufferSize(buffer_size);"
    },
    {
        "line": 137,
        "fullcodeline": "::InternetGetCookieEx(parsed_uri.c_str(),"
    },
    {
        "line": 144,
        "fullcodeline": "webdriver::HookProcessor::WriteBufferToPipe(driver_process_id);"
    },
    {
        "line": 151,
        "fullcodeline": "} else if (WD_GET_COOKIE_CACHE_FILES == call_window_proc_struct->message) {"
    },
    {
        "line": 51,
        "fullcodeline": "all_cookies.append(L\"\\n*\\n\");"
    },
    {
        "line": 57,
        "fullcodeline": "cookie_value = current_cookie->pwszValue;"
    },
    {
        "line": 61,
        "fullcodeline": "cookie_domain = current_cookie->pwszDomain;"
    },
    {
        "line": 65,
        "fullcodeline": "cookie_path = current_cookie->pwszPath;"
    },
    {
        "line": 77,
        "fullcodeline": "all_cookies.append(std::to_wstring(expires.dwLowDateTime)).append(L\"\\n\");"
    },
    {
        "line": 78,
        "fullcodeline": "all_cookies.append(std::to_wstring(expires.dwHighDateTime)).append(L\"\\n\");"
    },
    {
        "line": 118,
        "fullcodeline": "WD_GET_SCRIPTABLE_COOKIES == call_window_proc_struct->message) &&"
    },
    {
        "line": 139,
        "fullcodeline": "reinterpret_cast<LPTSTR>(webdriver::HookProcessor::GetDataBufferAddress()),"
    },
    {
        "line": 152,
        "fullcodeline": "int driver_process_id = static_cast<int>(call_window_proc_struct->wParam);"
    },
    {
        "line": 153,
        "fullcodeline": "std::wstring file_list = L\"\";"
    },
    {
        "line": 154,
        "fullcodeline": "std::wstring url = webdriver::HookProcessor::CopyWStringFromBuffer();"
    },
    {
        "line": 157,
        "fullcodeline": "CComPtr<IUri> uri_pointer;"
    },
    {
        "line": 158,
        "fullcodeline": "HRESULT hr = ::CreateUri(url.c_str(), Uri_CREATE_ALLOW_RELATIVE, 0, &uri_pointer);"
    },
    {
        "line": 160,
        "fullcodeline": "uri_pointer->GetHost(&host_bstr);"
    },
    {
        "line": 162,
        "fullcodeline": "uri_pointer->GetPath(&path_bstr);"
    },
    {
        "line": 163,
        "fullcodeline": "std::wstring parsed_uri = host_bstr;"
    },
    {
        "line": 164,
        "fullcodeline": "parsed_uri.append(path_bstr);"
    },
    {
        "line": 168,
        "fullcodeline": "HANDLE cache_enum_handle = NULL;"
    },
    {
        "line": 169,
        "fullcodeline": "DWORD entry_size = 2048;"
    },
    {
        "line": 170,
        "fullcodeline": "LPINTERNET_CACHE_ENTRY_INFO entry = NULL;"
    },
    {
        "line": 171,
        "fullcodeline": "std::vector<char> entry_buffer(entry_size);"
    },
    {
        "line": 173,
        "fullcodeline": "cache_enum_handle = ::FindFirstUrlCacheEntry(L\"cookie:\","
    },
    {
        "line": 212,
        "fullcodeline": "webdriver::HookProcessor::CopyWStringToBuffer(file_list);"
    },
    {
        "line": 213,
        "fullcodeline": "webdriver::HookProcessor::WriteBufferToPipe(driver_process_id);"
    },
    {
        "line": 80,
        "fullcodeline": "all_cookies.append(L\"\\n\\n\");"
    },
    {
        "line": 146,
        "fullcodeline": "if (ERROR_NO_MORE_ITEMS == ::GetLastError()) {"
    },
    {
        "line": 176,
        "fullcodeline": "if (cache_enum_handle == NULL &&"
    },
    {
        "line": 184,
        "fullcodeline": "while (cache_enum_handle != NULL) {"
    },
    {
        "line": 148,
        "fullcodeline": "webdriver::HookProcessor::WriteBufferToPipe(driver_process_id);"
    },
    {
        "line": 177,
        "fullcodeline": "ERROR_INSUFFICIENT_BUFFER == ::GetLastError()) {"
    },
    {
        "line": 178,
        "fullcodeline": "entry_buffer.resize(entry_size);"
    },
    {
        "line": 179,
        "fullcodeline": "entry = reinterpret_cast<INTERNET_CACHE_ENTRY_INFO*>(&entry_buffer[0]);"
    },
    {
        "line": 180,
        "fullcodeline": "cache_enum_handle = ::FindFirstUrlCacheEntry(L\"cookie:\","
    },
    {
        "line": 196,
        "fullcodeline": "BOOL success = ::FindNextUrlCacheEntry(cache_enum_handle,"
    },
    {
        "line": 214,
        "fullcodeline": "} else if (WD_SET_COOKIE == call_window_proc_struct->message) {"
    },
    {
        "line": 185,
        "fullcodeline": "if (COOKIE_CACHE_ENTRY == (entry->CacheEntryType & COOKIE_CACHE_ENTRY)) {"
    },
    {
        "line": 199,
        "fullcodeline": "if (!success) {"
    },
    {
        "line": 215,
        "fullcodeline": "DWORD set_cookie_flags = static_cast<DWORD>(call_window_proc_struct->wParam);"
    },
    {
        "line": 216,
        "fullcodeline": "std::wstring cookie_data = webdriver::HookProcessor::CopyWStringFromBuffer();"
    },
    {
        "line": 217,
        "fullcodeline": "size_t url_separator_pos = cookie_data.find_first_of(L\"|\");"
    },
    {
        "line": 218,
        "fullcodeline": "std::wstring url = cookie_data.substr(0, url_separator_pos);"
    },
    {
        "line": 219,
        "fullcodeline": "std::wstring cookie = cookie_data.substr(url_separator_pos + 1);"
    },
    {
        "line": 221,
        "fullcodeline": "CComPtr<IUri> uri_pointer;"
    },
    {
        "line": 222,
        "fullcodeline": "HRESULT hr = ::CreateUri(url.c_str(), Uri_CREATE_ALLOW_RELATIVE, 0, &uri_pointer);"
    },
    {
        "line": 224,
        "fullcodeline": "uri_pointer->GetSchemeName(&scheme_bstr);"
    },
    {
        "line": 226,
        "fullcodeline": "uri_pointer->GetHost(&host_bstr);"
    },
    {
        "line": 227,
        "fullcodeline": "std::wstring parsed_uri = scheme_bstr;"
    },
    {
        "line": 228,
        "fullcodeline": "parsed_uri.append(L\"://\");"
    },
    {
        "line": 229,
        "fullcodeline": "parsed_uri.append(host_bstr);"
    },
    {
        "line": 233,
        "fullcodeline": "DWORD cookie_set = ::InternetSetCookieEx(parsed_uri.c_str(),"
    },
    {
        "line": 186,
        "fullcodeline": "std::wstring name = entry->lpszSourceUrlName;"
    },
    {
        "line": 187,
        "fullcodeline": "size_t name_separator_pos(name.find_first_of(L\"@\"));"
    },
    {
        "line": 188,
        "fullcodeline": "std::wstring domain = name.substr(name_separator_pos + 1);"
    },
    {
        "line": 200,
        "fullcodeline": "DWORD error = ::GetLastError();"
    },
    {
        "line": 189,
        "fullcodeline": "if (parsed_uri.find(domain) != std::wstring::npos) {"
    },
    {
        "line": 201,
        "fullcodeline": "if (ERROR_INSUFFICIENT_BUFFER == error) {"
    },
    {
        "line": 235,
        "fullcodeline": "cookie.c_str(),"
    },
    {
        "line": 239,
        "fullcodeline": "webdriver::HookProcessor::SetDataBufferSize(0);"
    },
    {
        "line": 193,
        "fullcodeline": "file_list.append(entry->lpszLocalFileName);"
    },
    {
        "line": 202,
        "fullcodeline": "entry_buffer.resize(entry_size);"
    },
    {
        "line": 203,
        "fullcodeline": "BOOL other_success = ::FindNextUrlCacheEntry(cache_enum_handle,"
    },
    {
        "line": 241,
        "fullcodeline": "DWORD error = ::GetLastError();"
    },
    {
        "line": 242,
        "fullcodeline": "webdriver::HookProcessor::SetDataBufferSize(error);"
    },
    {
        "line": 190,
        "fullcodeline": "if (file_list.size() > 0) {"
    },
    {
        "line": 191,
        "fullcodeline": "file_list.append(L\"|\");"
    },
    {
        "line": 206,
        "fullcodeline": "} else if (ERROR_NO_MORE_ITEMS == error) {"
    },
    {
        "line": 207,
        "fullcodeline": "::FindCloseUrlCache(cache_enum_handle);"
    },
    {
        "line": 208,
        "fullcodeline": "cache_enum_handle = NULL;"
    }
]