[
    {
        "line": 5,
        "fullcodeline": "trilogy_reader_t reader = TRILOGY_READER(buff, len);"
    },
    {
        "line": 7,
        "fullcodeline": "CHECKED(trilogy_reader_get_uint8(&reader, &out_packet->proto_version));"
    },
    {
        "line": 16,
        "fullcodeline": "CHECKED(trilogy_reader_get_string(&reader, &server_version, &server_version_len));"
    },
    {
        "line": 17,
        "fullcodeline": "server_version_len = min(server_version_len, sizeof(out_packet->server_version) - 1);"
    },
    {
        "line": 18,
        "fullcodeline": "memcpy(out_packet->server_version, server_version, server_version_len);"
    },
    {
        "line": 19,
        "fullcodeline": "out_packet->server_version[server_version_len] = '\\0';"
    },
    {
        "line": 21,
        "fullcodeline": "CHECKED(trilogy_reader_get_uint32(&reader, &out_packet->conn_id));"
    },
    {
        "line": 23,
        "fullcodeline": "CHECKED(trilogy_reader_copy_buffer(&reader, 8, out_packet->scramble));"
    },
    {
        "line": 26,
        "fullcodeline": "uint8_t filler = 0;"
    },
    {
        "line": 27,
        "fullcodeline": "CHECKED(trilogy_reader_get_uint8(&reader, &filler));"
    },
    {
        "line": 34,
        "fullcodeline": "uint16_t caps_part = 0;"
    },
    {
        "line": 35,
        "fullcodeline": "CHECKED(trilogy_reader_get_uint16(&reader, &caps_part));"
    },
    {
        "line": 36,
        "fullcodeline": "out_packet->capabilities = caps_part;"
    },
    {
        "line": 44,
        "fullcodeline": "CHECKED(trilogy_reader_get_uint8(&reader, &server_charset));"
    },
    {
        "line": 46,
        "fullcodeline": "out_packet->server_charset = server_charset;"
    },
    {
        "line": 48,
        "fullcodeline": "CHECKED(trilogy_reader_get_uint16(&reader, &out_packet->server_status));"
    },
    {
        "line": 52,
        "fullcodeline": "CHECKED(trilogy_reader_get_uint16(&reader, &caps_part));"
    },
    {
        "line": 53,
        "fullcodeline": "out_packet->capabilities |= ((uint32_t)caps_part << 16);"
    },
    {
        "line": 55,
        "fullcodeline": "uint8_t auth_data_len = 0;"
    },
    {
        "line": 56,
        "fullcodeline": "CHECKED(trilogy_reader_get_uint8(&reader, &auth_data_len));"
    },
    {
        "line": 69,
        "fullcodeline": "static const uint8_t null_filler[10] = {0};"
    },
    {
        "line": 72,
        "fullcodeline": "CHECKED(trilogy_reader_get_buffer(&reader, 10, &str));"
    },
    {
        "line": 8,
        "fullcodeline": "if (out_packet->proto_version != 0xa) {"
    },
    {
        "line": 28,
        "fullcodeline": "if (filler != '\\0') {"
    },
    {
        "line": 38,
        "fullcodeline": "if (!(out_packet->capabilities & TRILOGY_CAPABILITIES_PROTOCOL_41)) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (!(out_packet->capabilities & TRILOGY_CAPABILITIES_PLUGIN_AUTH)) {"
    },
    {
        "line": 74,
        "fullcodeline": "if (memcmp(str, null_filler, 10) != 0) {"
    },
    {
        "line": 79,
        "fullcodeline": "if (out_packet->capabilities & TRILOGY_CAPABILITIES_SECURE_CONNECTION && auth_data_len > 8) {"
    },
    {
        "line": 92,
        "fullcodeline": "if (out_packet->capabilities & TRILOGY_CAPABILITIES_PLUGIN_AUTH) {"
    },
    {
        "line": 104,
        "fullcodeline": "return trilogy_reader_finish(&reader);"
    },
    {
        "line": 80,
        "fullcodeline": "uint8_t remaining_auth_data_len = auth_data_len - 8;"
    },
    {
        "line": 86,
        "fullcodeline": "CHECKED(trilogy_reader_copy_buffer(&reader, remaining_auth_data_len, out_packet->scramble + 8));"
    },
    {
        "line": 96,
        "fullcodeline": "CHECKED(trilogy_reader_get_string(&reader, &auth_plugin, &auth_plugin_len));"
    },
    {
        "line": 101,
        "fullcodeline": "memcpy(out_packet->auth_plugin, auth_plugin, auth_plugin_len + 1);"
    },
    {
        "line": 59,
        "fullcodeline": "if (auth_data_len != '\\0') {"
    },
    {
        "line": 82,
        "fullcodeline": "if (remaining_auth_data_len > 13) {"
    },
    {
        "line": 97,
        "fullcodeline": "if (auth_plugin_len > sizeof(out_packet->auth_plugin) - 1) {"
    },
    {
        "line": 83,
        "fullcodeline": "remaining_auth_data_len = 13;"
    }
]