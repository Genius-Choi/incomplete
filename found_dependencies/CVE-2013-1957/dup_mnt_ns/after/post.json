[
    {
        "line": 5,
        "fullcodeline": "struct vfsmount *rootmnt = NULL, *pwdmnt = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "struct mount *old = mnt_ns->root;"
    },
    {
        "line": 11,
        "fullcodeline": "new_ns = alloc_mnt_ns(user_ns);"
    },
    {
        "line": 15,
        "fullcodeline": "down_write(&namespace_sem);"
    },
    {
        "line": 17,
        "fullcodeline": "copy_flags = CL_COPY_ALL | CL_EXPIRE;"
    },
    {
        "line": 20,
        "fullcodeline": "new = copy_tree(old, old->mnt.mnt_root, copy_flags);"
    },
    {
        "line": 26,
        "fullcodeline": "new_ns->root = new;"
    },
    {
        "line": 27,
        "fullcodeline": "br_write_lock(&vfsmount_lock);"
    },
    {
        "line": 28,
        "fullcodeline": "list_add_tail(&new_ns->list, &new->mnt_list);"
    },
    {
        "line": 29,
        "fullcodeline": "br_write_unlock(&vfsmount_lock);"
    },
    {
        "line": 36,
        "fullcodeline": "p = old;"
    },
    {
        "line": 37,
        "fullcodeline": "q = new;"
    },
    {
        "line": 53,
        "fullcodeline": "up_write(&namespace_sem);"
    },
    {
        "line": 12,
        "fullcodeline": "if (IS_ERR(new_ns))"
    },
    {
        "line": 18,
        "fullcodeline": "if (user_ns != mnt_ns->user_ns)"
    },
    {
        "line": 21,
        "fullcodeline": "if (IS_ERR(new)) {"
    },
    {
        "line": 19,
        "fullcodeline": "copy_flags |= CL_SHARED_TO_SLAVE | CL_UNPRIVILEGED;"
    },
    {
        "line": 22,
        "fullcodeline": "up_write(&namespace_sem);"
    },
    {
        "line": 23,
        "fullcodeline": "free_mnt_ns(new_ns);"
    },
    {
        "line": 39,
        "fullcodeline": "q->mnt_ns = new_ns;"
    },
    {
        "line": 50,
        "fullcodeline": "p = next_mnt(p, old);"
    },
    {
        "line": 51,
        "fullcodeline": "q = next_mnt(q, new);"
    },
    {
        "line": 56,
        "fullcodeline": "mntput(rootmnt);"
    },
    {
        "line": 58,
        "fullcodeline": "mntput(pwdmnt);"
    },
    {
        "line": 24,
        "fullcodeline": "return ERR_CAST(new);"
    },
    {
        "line": 41,
        "fullcodeline": "if (&p->mnt == fs->root.mnt) {"
    },
    {
        "line": 45,
        "fullcodeline": "if (&p->mnt == fs->pwd.mnt) {"
    },
    {
        "line": 42,
        "fullcodeline": "fs->root.mnt = mntget(&q->mnt);"
    },
    {
        "line": 43,
        "fullcodeline": "rootmnt = &p->mnt;"
    },
    {
        "line": 46,
        "fullcodeline": "fs->pwd.mnt = mntget(&q->mnt);"
    },
    {
        "line": 47,
        "fullcodeline": "pwdmnt = &p->mnt;"
    }
]