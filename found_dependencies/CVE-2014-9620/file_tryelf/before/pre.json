[
    {
        "line": 12,
        "fullcodeline": "int flags = 0;"
    },
    {
        "line": 46,
        "fullcodeline": "clazz = buf[EI_CLASS];"
    },
    {
        "line": 17,
        "fullcodeline": "if (ms->flags & (MAGIC_MIME|MAGIC_APPLE))"
    },
    {
        "line": 26,
        "fullcodeline": "if (buf[EI_MAG0] != ELFMAG0"
    },
    {
        "line": 28,
        "fullcodeline": "|| buf[EI_MAG2] != ELFMAG2 || buf[EI_MAG3] != ELFMAG3)"
    },
    {
        "line": 34,
        "fullcodeline": "if((lseek(fd, (off_t)0, SEEK_SET) == (off_t)-1) && (errno == ESPIPE))"
    },
    {
        "line": 35,
        "fullcodeline": "fd = file_pipe2file(ms, fd, buf, nbytes);"
    },
    {
        "line": 37,
        "fullcodeline": "if (fstat(fd, &st) == -1) {"
    },
    {
        "line": 41,
        "fullcodeline": "if (S_ISREG(st.st_mode) || st.st_size != 0)"
    },
    {
        "line": 39,
        "fullcodeline": "return -1;"
    },
    {
        "line": 44,
        "fullcodeline": "fsize = SIZE_UNKNOWN;"
    },
    {
        "line": 27,
        "fullcodeline": "|| (buf[EI_MAG1] != ELFMAG1 && buf[EI_MAG1] != OLFMAG1)"
    },
    {
        "line": 62,
        "fullcodeline": "if (file_printf(ms, \", unknown class %d\", clazz) == -1)"
    },
    {
        "line": 63,
        "fullcodeline": "return -1;"
    }
]