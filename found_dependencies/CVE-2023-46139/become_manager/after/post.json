[
    {
        "line": 4,
        "fullcodeline": "int i = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "bool result = false;"
    },
    {
        "line": 26,
        "fullcodeline": "buf = (char *)kmalloc(PATH_MAX, GFP_ATOMIC);"
    },
    {
        "line": 32,
        "fullcodeline": "files_table = files_fdtable(current->files);"
    },
    {
        "line": 34,
        "fullcodeline": "int pkg_len = strlen(pkg);"
    },
    {
        "line": 82,
        "fullcodeline": "kfree(buf);"
    },
    {
        "line": 21,
        "fullcodeline": "if (task_uid(current->real_parent).val != 0) {"
    },
    {
        "line": 27,
        "fullcodeline": "if (!buf) {"
    },
    {
        "line": 36,
        "fullcodeline": "for (i = 0; files_table->fd[i] != NULL; i++) {"
    },
    {
        "line": 22,
        "fullcodeline": "pr_info(\"parent is not zygote!\\n\");"
    },
    {
        "line": 28,
        "fullcodeline": "pr_err(\"kalloc path failed.\\n\");"
    },
    {
        "line": 41,
        "fullcodeline": "cwd = d_path(&files_path, buf, PATH_MAX);"
    },
    {
        "line": 47,
        "fullcodeline": "pr_info(\"found apk: %s\\n\", cwd);"
    },
    {
        "line": 48,
        "fullcodeline": "char *pkg_index = strstr(cwd, pkg);"
    },
    {
        "line": 53,
        "fullcodeline": "char *next_char = pkg_index + pkg_len;"
    },
    {
        "line": 38,
        "fullcodeline": "if (!d_is_reg(files_path.dentry)) {"
    },
    {
        "line": 42,
        "fullcodeline": "if (startswith(cwd, \"/data/app/\") != 0 ||"
    },
    {
        "line": 49,
        "fullcodeline": "if (!pkg_index) {"
    },
    {
        "line": 56,
        "fullcodeline": "if (*next_char != '-') {"
    },
    {
        "line": 65,
        "fullcodeline": "if (is_manager_apk(cwd)) {"
    },
    {
        "line": 43,
        "fullcodeline": "endswith(cwd, \"/base.apk\") != 0) {"
    },
    {
        "line": 50,
        "fullcodeline": "pr_info(\"apk path not match package name!\\n\");"
    },
    {
        "line": 62,
        "fullcodeline": "pr_info(\"invalid pkg: %s\\n\", pkg);"
    },
    {
        "line": 68,
        "fullcodeline": "pr_info(\"manager uid: %d\\n\", uid);"
    },
    {
        "line": 70,
        "fullcodeline": "ksu_set_manager_uid(uid);"
    },
    {
        "line": 72,
        "fullcodeline": "result = true;"
    },
    {
        "line": 75,
        "fullcodeline": "pr_info(\"manager signature invalid!\\n\");"
    }
]