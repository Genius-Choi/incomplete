--- before
+++ after
@@ -13,4 +13,18 @@
         data = json.loads(r.data.decode('utf-8'))

 

         self.assertNotIn('X-API-Secret', data)

+        self.assertEqual(data['Authorization'], 'bar')

+

+        r = http.request('GET', '%s/redirect' % self.base_url,

+                         fields={'target': '%s/headers' % self.base_url_alt},

+                         headers={'x-api-secret': 'foo',

+                                  'authorization': 'bar'},

+                         retries=Retry(remove_headers_on_redirect=['X-API-Secret']))

+

+        self.assertEqual(r.status, 200)

+

+        data = json.loads(r.data.decode('utf-8'))

+

+        self.assertNotIn('x-api-secret', data)

+        self.assertNotIn('X-API-Secret', data)

         self.assertEqual(data['Authorization'], 'bar')
