[
    {
        "line": 3,
        "fullcodeline": "char *path = xstrdup(p);"
    },
    {
        "line": 4,
        "fullcodeline": "char *dp = path;"
    },
    {
        "line": 5,
        "fullcodeline": "char *sp = NULL, *bn;"
    },
    {
        "line": 6,
        "fullcodeline": "int oflags = O_RDONLY;"
    },
    {
        "line": 8,
        "fullcodeline": "int dirfd = fsmOpenat(-1, \"/\", oflags);"
    },
    {
        "line": 9,
        "fullcodeline": "int fd = dirfd; /* special case of \"/\" */"
    },
    {
        "line": 41,
        "fullcodeline": "free(path);"
    },
    {
        "line": 11,
        "fullcodeline": "while ((bn = strtok_r(dp, \"/\", &sp)) != NULL) {"
    },
    {
        "line": 13,
        "fullcodeline": "fd = fsmOpenat(dirfd, bn, oflags);"
    },
    {
        "line": 28,
        "fullcodeline": "close(dirfd);"
    },
    {
        "line": 38,
        "fullcodeline": "dp = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "if (fd < 0 && errno == ENOENT && create) {"
    },
    {
        "line": 22,
        "fullcodeline": "if (fd >= 0 && fstat(fd, &sb) == 0 && !S_ISDIR(sb.st_mode)) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (fd >= 0) {"
    },
    {
        "line": 16,
        "fullcodeline": "mode_t mode = S_IFDIR | (_dirPerms & 07777);"
    },
    {
        "line": 23,
        "fullcodeline": "close(fd);"
    },
    {
        "line": 24,
        "fullcodeline": "errno = ENOTDIR;"
    },
    {
        "line": 25,
        "fullcodeline": "fd = -1;"
    },
    {
        "line": 30,
        "fullcodeline": "dirfd = fd;"
    },
    {
        "line": 17,
        "fullcodeline": "if (fsmDoMkDir(plugins, dirfd, bn, owned, mode) == 0) {"
    },
    {
        "line": 32,
        "fullcodeline": "dirfd = -1;"
    },
    {
        "line": 33,
        "fullcodeline": "rpmlog(RPMLOG_ERR, _(\"failed to open dir %s of %s: %s\\n\"),"
    },
    {
        "line": 18,
        "fullcodeline": "fd = fsmOpenat(dirfd, bn, oflags|O_NOFOLLOW);"
    },
    {
        "line": 34,
        "fullcodeline": "bn, p, strerror(errno));"
    }
]