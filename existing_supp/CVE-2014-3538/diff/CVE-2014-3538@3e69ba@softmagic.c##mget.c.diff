--- before
+++ after
@@ -4,7 +4,6 @@
     int *need_separator, int *returnval)

 {

 	uint32_t soffset, offset = ms->offset;

-	uint32_t count = m->str_range;

 	uint32_t lhs;

 	int rv, oneed_separator, in_type;

 	char *sbuf, *rbuf;

@@ -17,13 +16,12 @@
 	}

 

 	if (mcopy(ms, p, m->type, m->flag & INDIR, s, (uint32_t)(offset + o),

-	    (uint32_t)nbytes, count) == -1)

+	    (uint32_t)nbytes, m) == -1)

 		return -1;

 

 	if ((ms->flags & MAGIC_DEBUG) != 0) {

 		fprintf(stderr, "mget(type=%d, flag=%x, offset=%u, o=%zu, "

-		    "nbytes=%zu, count=%u)\n", m->type, m->flag, offset, o,

-		    nbytes, count);

+		    "nbytes=%zu)\n", m->type, m->flag, offset, o, nbytes);

 		mdebug(offset, (char *)(void *)p, sizeof(union VALUETYPE));

 #ifndef COMPILE_ONLY

 		file_mdump(m);

@@ -388,7 +386,7 @@
 			if ((ms->flags & MAGIC_DEBUG) != 0)

 				fprintf(stderr, "indirect +offs=%u\n", offset);

 		}

-		if (mcopy(ms, p, m->type, 0, s, offset, nbytes, count) == -1)

+		if (mcopy(ms, p, m->type, 0, s, offset, nbytes, m) == -1)

 			return -1;

 		ms->offset = offset;

 

