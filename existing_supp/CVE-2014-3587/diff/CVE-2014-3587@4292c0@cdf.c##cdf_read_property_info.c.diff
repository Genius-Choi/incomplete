--- before
+++ after
@@ -65,7 +65,7 @@
 		q = (const uint8_t *)(const void *)

 		    ((const char *)(const void *)p + ofs

 		    - 2 * sizeof(uint32_t));

-		if (q > e) {

+		if (q < p || q > e) {

 			DPRINTF(("Ran of the end %p > %p\n", q, e));

 			goto out;

 		}

