[
    {
        "line": 3,
        "fullcodeline": "char *buf = NULL;"
    },
    {
        "line": 7,
        "fullcodeline": "zval *options = NULL, *classes = NULL;"
    },
    {
        "line": 8,
        "fullcodeline": "HashTable *class_hash = NULL;"
    },
    {
        "line": 18,
        "fullcodeline": "p = (const unsigned char*) buf;"
    },
    {
        "line": 19,
        "fullcodeline": "PHP_VAR_UNSERIALIZE_INIT(var_hash);"
    },
    {
        "line": 54,
        "fullcodeline": "var_push_dtor(&var_hash, return_value);"
    },
    {
        "line": 56,
        "fullcodeline": "PHP_VAR_UNSERIALIZE_DESTROY(var_hash);"
    },
    {
        "line": 10,
        "fullcodeline": "if (zend_parse_parameters(ZEND_NUM_ARGS(), \"s|a\", &buf, &buf_len, &options) == FAILURE) {"
    },
    {
        "line": 14,
        "fullcodeline": "if (buf_len == 0) {"
    },
    {
        "line": 20,
        "fullcodeline": "if(options != NULL) {"
    },
    {
        "line": 39,
        "fullcodeline": "if (!php_var_unserialize_ex(return_value, &p, p + buf_len, &var_hash, class_hash)) {"
    },
    {
        "line": 21,
        "fullcodeline": "classes = zend_hash_str_find(Z_ARRVAL_P(options), \"allowed_classes\", sizeof(\"allowed_classes\")-1);"
    },
    {
        "line": 40,
        "fullcodeline": "PHP_VAR_UNSERIALIZE_DESTROY(var_hash);"
    },
    {
        "line": 45,
        "fullcodeline": "zval_ptr_dtor(return_value);"
    },
    {
        "line": 58,
        "fullcodeline": "zend_hash_destroy(class_hash);"
    },
    {
        "line": 59,
        "fullcodeline": "FREE_HASHTABLE(class_hash);"
    },
    {
        "line": 22,
        "fullcodeline": "if(classes && (Z_TYPE_P(classes) == IS_ARRAY || !zend_is_true(classes))) {"
    },
    {
        "line": 26,
        "fullcodeline": "if(class_hash && Z_TYPE_P(classes) == IS_ARRAY) {"
    },
    {
        "line": 46,
        "fullcodeline": "if (!EG(exception)) {"
    },
    {
        "line": 23,
        "fullcodeline": "ALLOC_HASHTABLE(class_hash);"
    },
    {
        "line": 24,
        "fullcodeline": "zend_hash_init(class_hash, (Z_TYPE_P(classes) == IS_ARRAY)?zend_hash_num_elements(Z_ARRVAL_P(classes)):0, NULL, NULL, 0);"
    },
    {
        "line": 30,
        "fullcodeline": "ZEND_HASH_FOREACH_VAL(Z_ARRVAL_P(classes), entry) {"
    },
    {
        "line": 35,
        "fullcodeline": "} ZEND_HASH_FOREACH_END();"
    },
    {
        "line": 42,
        "fullcodeline": "zend_hash_destroy(class_hash);"
    },
    {
        "line": 43,
        "fullcodeline": "FREE_HASHTABLE(class_hash);"
    },
    {
        "line": 31,
        "fullcodeline": "convert_to_string_ex(entry);"
    },
    {
        "line": 32,
        "fullcodeline": "lcname = zend_string_tolower(Z_STR_P(entry));"
    },
    {
        "line": 33,
        "fullcodeline": "zend_hash_add_empty_element(class_hash, lcname);"
    },
    {
        "line": 34,
        "fullcodeline": "zend_string_release(lcname);"
    }
]