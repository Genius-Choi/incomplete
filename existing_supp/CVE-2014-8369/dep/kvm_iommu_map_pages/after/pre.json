[
    {
        "line": 5,
        "fullcodeline": "int r = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "struct iommu_domain *domain = kvm->arch.iommu_domain;"
    },
    {
        "line": 13,
        "fullcodeline": "gfn     = slot->base_gfn;"
    },
    {
        "line": 14,
        "fullcodeline": "end_gfn = gfn + slot->npages;"
    },
    {
        "line": 16,
        "fullcodeline": "flags = IOMMU_READ;"
    },
    {
        "line": 10,
        "fullcodeline": "if (!domain)"
    },
    {
        "line": 23,
        "fullcodeline": "while (gfn < end_gfn) {"
    },
    {
        "line": 75,
        "fullcodeline": "kvm_iommu_put_pages(kvm, slot->base_gfn, gfn - slot->base_gfn);"
    },
    {
        "line": 17,
        "fullcodeline": "if (!(slot->flags & KVM_MEM_READONLY))"
    },
    {
        "line": 18,
        "fullcodeline": "flags |= IOMMU_WRITE;"
    },
    {
        "line": 20,
        "fullcodeline": "flags |= IOMMU_CACHE;"
    },
    {
        "line": 33,
        "fullcodeline": "page_size = kvm_host_page_size(kvm, gfn);"
    },
    {
        "line": 51,
        "fullcodeline": "pfn = kvm_pin_pages(slot, gfn, page_size >> PAGE_SHIFT);"
    },
    {
        "line": 58,
        "fullcodeline": "r = iommu_map(domain, gfn_to_gpa(gfn), pfn_to_hpa(pfn),"
    },
    {
        "line": 67,
        "fullcodeline": "gfn += page_size >> PAGE_SHIFT;"
    },
    {
        "line": 27,
        "fullcodeline": "if (iommu_iova_to_phys(domain, gfn_to_gpa(gfn))) {"
    },
    {
        "line": 36,
        "fullcodeline": "while ((gfn + (page_size >> PAGE_SHIFT)) > end_gfn)"
    },
    {
        "line": 37,
        "fullcodeline": "page_size >>= 1;"
    },
    {
        "line": 41,
        "fullcodeline": "page_size >>= 1;"
    },
    {
        "line": 45,
        "fullcodeline": "page_size >>= 1;"
    },
    {
        "line": 52,
        "fullcodeline": "if (is_error_noslot_pfn(pfn)) {"
    },
    {
        "line": 28,
        "fullcodeline": "gfn += 1;"
    },
    {
        "line": 40,
        "fullcodeline": "while ((gfn << PAGE_SHIFT) & (page_size - 1))"
    },
    {
        "line": 44,
        "fullcodeline": "while (__gfn_to_hva_memslot(slot, gfn) & (page_size - 1))"
    },
    {
        "line": 53,
        "fullcodeline": "gfn += 1;"
    },
    {
        "line": 63,
        "fullcodeline": "kvm_unpin_pages(kvm, pfn, page_size >> PAGE_SHIFT);"
    }
]