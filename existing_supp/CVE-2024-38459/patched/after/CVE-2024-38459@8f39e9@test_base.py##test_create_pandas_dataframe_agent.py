def test_create_pandas_dataframe_agent() -> None:
    import pandas as pd

    with pytest.raises(ValueError):
        create_pandas_dataframe_agent(
            FakeLLM(), pd.DataFrame(), allow_dangerous_code=False
        )

    create_pandas_dataframe_agent(FakeLLM(), pd.DataFrame(), allow_dangerous_code=True)
    create_pandas_dataframe_agent(
        FakeLLM(), [pd.DataFrame(), pd.DataFrame()], allow_dangerous_code=True
    )
