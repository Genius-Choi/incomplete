--- before
+++ after
@@ -11,9 +11,45 @@
     max_execution_time: Optional[float] = None,

     early_stopping_method: str = "force",

     agent_executor_kwargs: Optional[Dict[str, Any]] = None,

+    allow_dangerous_code: bool = False,

     **kwargs: Dict[str, Any],

 ) -> AgentExecutor:

-    """Construct a xorbits agent from an LLM and dataframe."""

+    """Construct a xorbits agent from an LLM and dataframe.

+

+    Security Notice:

+        This agent relies on access to a python repl tool which can execute

+        arbitrary code. This can be dangerous and requires a specially sandboxed

+        environment to be safely used. Failure to run this code in a properly

+        sandboxed environment can lead to arbitrary code execution vulnerabilities,

+        which can lead to data breaches, data loss, or other security incidents.

+

+        Do not use this code with untrusted inputs, with elevated permissions,

+        or without consulting your security team about proper sandboxing!

+

+        You must opt in to use this functionality by setting allow_dangerous_code=True.

+

+    Args:

+        allow_dangerous_code: bool, default False

+            This agent relies on access to a python repl tool which can execute

+            arbitrary code. This can be dangerous and requires a specially sandboxed

+            environment to be safely used.

+            Failure to properly sandbox this class can lead to arbitrary code execution

+            vulnerabilities, which can lead to data breaches, data loss, or

+            other security incidents.

+            You must opt in to use this functionality by setting

+            allow_dangerous_code=True.

+    """

+    if not allow_dangerous_code:

+        raise ValueError(

+            "This agent relies on access to a python repl tool which can execute "

+            "arbitrary code. This can be dangerous and requires a specially sandboxed "

+            "environment to be safely used. Please read the security notice in the "

+            "doc-string of this function. You must opt-in to use this functionality "

+            "by setting allow_dangerous_code=True."

+            "For general security guidelines, please see: "

+            "https://python.langchain.com/v0.1/docs/security/"

+        )

+

     try:

         from xorbits import numpy as np

         from xorbits import pandas as pd

