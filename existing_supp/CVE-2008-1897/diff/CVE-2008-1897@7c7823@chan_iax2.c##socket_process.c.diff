--- before
+++ after
@@ -56,7 +56,7 @@
 		}

 

 		/* This is a video frame, get call number */

-		fr->callno = find_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd);

+		fr->callno = find_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0);

 		minivid = 1;

 	} else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) {

 		unsigned char metatype;

@@ -114,7 +114,7 @@
 				/* Stop if we don't have enough data */

 				if (len > res)

 					break;

-				fr->callno = find_callno_locked(callno & ~IAX_FLAG_FULL, 0, &sin, NEW_PREVENT, fd);

+				fr->callno = find_callno_locked(callno & ~IAX_FLAG_FULL, 0, &sin, NEW_PREVENT, fd, 0);

 				if (fr->callno) {

 					/* If it's a valid call, deliver the contents.  If not, we

 					   drop it, since we don't have a scallno to use for an INVAL */

@@ -200,7 +200,7 @@
 	}

 

 	if (!fr->callno)

-		fr->callno = find_callno(ntohs(mh->callno) & ~IAX_FLAG_FULL, dcallno, &sin, new, fd);

+		fr->callno = find_callno(ntohs(mh->callno) & ~IAX_FLAG_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX_FLAG_FULL);

 

 	if (fr->callno > 0)

 		ast_mutex_lock(&iaxsl[fr->callno]);

