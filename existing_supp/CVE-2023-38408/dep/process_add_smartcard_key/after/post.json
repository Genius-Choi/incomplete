[
    {
        "line": 3,
        "fullcodeline": "char *provider = NULL, *pin = NULL, canonical_provider[PATH_MAX];"
    },
    {
        "line": 4,
        "fullcodeline": "char **comments = NULL;"
    },
    {
        "line": 5,
        "fullcodeline": "int r, i, count = 0, success = 0, confirm = 0;"
    },
    {
        "line": 6,
        "fullcodeline": "u_int seconds = 0;"
    },
    {
        "line": 7,
        "fullcodeline": "time_t death = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "struct sshkey **keys = NULL, *k;"
    },
    {
        "line": 10,
        "fullcodeline": "struct dest_constraint *dest_constraints = NULL;"
    },
    {
        "line": 11,
        "fullcodeline": "size_t ndest_constraints = 0;"
    },
    {
        "line": 13,
        "fullcodeline": "debug2_f(\"entering\");"
    },
    {
        "line": 39,
        "fullcodeline": "debug_f(\"add %.100s\", canonical_provider);"
    },
    {
        "line": 43,
        "fullcodeline": "count = pkcs11_add_provider(canonical_provider, pin, &keys, &comments);"
    },
    {
        "line": 72,
        "fullcodeline": "free(pin);"
    },
    {
        "line": 73,
        "fullcodeline": "free(provider);"
    },
    {
        "line": 74,
        "fullcodeline": "free(keys);"
    },
    {
        "line": 75,
        "fullcodeline": "free(comments);"
    },
    {
        "line": 76,
        "fullcodeline": "free_dest_constraints(dest_constraints, ndest_constraints);"
    },
    {
        "line": 77,
        "fullcodeline": "send_status(e, success);"
    },
    {
        "line": 14,
        "fullcodeline": "if ((r = sshbuf_get_cstring(e->request, &provider, NULL)) != 0 ||"
    },
    {
        "line": 19,
        "fullcodeline": "if (parse_key_constraints(e->request, NULL, &death, &seconds, &confirm,"
    },
    {
        "line": 24,
        "fullcodeline": "if (e->nsession_ids != 0 && !remote_add_provider) {"
    },
    {
        "line": 29,
        "fullcodeline": "if (realpath(provider, canonical_provider) == NULL) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (match_pattern_list(canonical_provider, allowed_providers, 0) != 1) {"
    },
    {
        "line": 40,
        "fullcodeline": "if (lifetime && !death)"
    },
    {
        "line": 44,
        "fullcodeline": "for (i = 0; i < count; i++) {"
    },
    {
        "line": 15,
        "fullcodeline": "(r = sshbuf_get_cstring(e->request, &pin, NULL)) != 0) {"
    },
    {
        "line": 16,
        "fullcodeline": "error_fr(r, \"parse\");"
    },
    {
        "line": 21,
        "fullcodeline": "error_f(\"failed to parse constraints\");"
    },
    {
        "line": 25,
        "fullcodeline": "verbose(\"failed PKCS#11 add of \\\"%.100s\\\": remote addition of \""
    },
    {
        "line": 30,
        "fullcodeline": "verbose(\"failed PKCS#11 add of \\\"%.100s\\\": realpath: %s\","
    },
    {
        "line": 35,
        "fullcodeline": "verbose(\"refusing PKCS#11 add of \\\"%.100s\\\": \""
    },
    {
        "line": 41,
        "fullcodeline": "death = monotime() + lifetime;"
    },
    {
        "line": 45,
        "fullcodeline": "k = keys[i];"
    },
    {
        "line": 68,
        "fullcodeline": "sshkey_free(keys[i]);"
    },
    {
        "line": 69,
        "fullcodeline": "free(comments[i]);"
    },
    {
        "line": 31,
        "fullcodeline": "provider, strerror(errno));"
    },
    {
        "line": 46,
        "fullcodeline": "if (lookup_identity(k) == NULL) {"
    },
    {
        "line": 47,
        "fullcodeline": "id = xcalloc(1, sizeof(Identity));"
    },
    {
        "line": 48,
        "fullcodeline": "id->key = k;"
    },
    {
        "line": 49,
        "fullcodeline": "keys[i] = NULL; /* transferred */"
    },
    {
        "line": 50,
        "fullcodeline": "id->provider = xstrdup(canonical_provider);"
    },
    {
        "line": 57,
        "fullcodeline": "id->death = death;"
    },
    {
        "line": 58,
        "fullcodeline": "id->confirm = confirm;"
    },
    {
        "line": 59,
        "fullcodeline": "id->dest_constraints = dest_constraints;"
    },
    {
        "line": 60,
        "fullcodeline": "id->ndest_constraints = ndest_constraints;"
    },
    {
        "line": 61,
        "fullcodeline": "dest_constraints = NULL; /* transferred */"
    },
    {
        "line": 62,
        "fullcodeline": "ndest_constraints = 0;"
    },
    {
        "line": 63,
        "fullcodeline": "TAILQ_INSERT_TAIL(&idtab->idlist, id, next);"
    },
    {
        "line": 65,
        "fullcodeline": "success = 1;"
    },
    {
        "line": 51,
        "fullcodeline": "if (*comments[i] != '\\0') {"
    },
    {
        "line": 52,
        "fullcodeline": "id->comment = comments[i];"
    },
    {
        "line": 53,
        "fullcodeline": "comments[i] = NULL; /* transferred */"
    },
    {
        "line": 55,
        "fullcodeline": "id->comment = xstrdup(canonical_provider);"
    }
]