[
    {
        "line": 3,
        "fullcodeline": "int c_flag = 0, d_flag = 0, D_flag = 0, k_flag = 0, s_flag = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "char *shell, *format, *pidstr, *agentsocket = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "char pidstrbuf[1 + 3 * sizeof pid];"
    },
    {
        "line": 13,
        "fullcodeline": "int timeout = -1; /* INFTIM */"
    },
    {
        "line": 14,
        "fullcodeline": "struct pollfd *pfd = NULL;"
    },
    {
        "line": 15,
        "fullcodeline": "size_t npfd = 0;"
    },
    {
        "line": 19,
        "fullcodeline": "sanitise_stdfd();"
    },
    {
        "line": 22,
        "fullcodeline": "(void)setegid(getgid());"
    },
    {
        "line": 23,
        "fullcodeline": "(void)setgid(getgid());"
    },
    {
        "line": 86,
        "fullcodeline": "ac -= optind;"
    },
    {
        "line": 87,
        "fullcodeline": "av += optind;"
    },
    {
        "line": 137,
        "fullcodeline": "maxfds = rlim.rlim_cur - SSH_AGENT_MIN_FDS;"
    },
    {
        "line": 139,
        "fullcodeline": "parent_pid = getpid();"
    },
    {
        "line": 160,
        "fullcodeline": "prev_mask = umask(0177);"
    },
    {
        "line": 161,
        "fullcodeline": "sock = unix_listener(socket_name, SSH_LISTEN_BACKLOG, 0);"
    },
    {
        "line": 167,
        "fullcodeline": "umask(prev_mask);"
    },
    {
        "line": 184,
        "fullcodeline": "pid = fork();"
    },
    {
        "line": 211,
        "fullcodeline": "log_init(__progname, SYSLOG_LEVEL_INFO, SYSLOG_FACILITY_AUTH, 0);"
    },
    {
        "line": 218,
        "fullcodeline": "(void)chdir(\"/\");"
    },
    {
        "line": 223,
        "fullcodeline": "rlim.rlim_cur = rlim.rlim_max = 0;"
    },
    {
        "line": 231,
        "fullcodeline": "cleanup_pid = getpid();"
    },
    {
        "line": 236,
        "fullcodeline": "new_socket(AUTH_SOCKET, sock);"
    },
    {
        "line": 239,
        "fullcodeline": "idtab_init();"
    },
    {
        "line": 240,
        "fullcodeline": "ssh_signal(SIGPIPE, SIG_IGN);"
    },
    {
        "line": 241,
        "fullcodeline": "ssh_signal(SIGINT, (d_flag | D_flag) ? cleanup_handler : SIG_IGN);"
    },
    {
        "line": 242,
        "fullcodeline": "ssh_signal(SIGHUP, cleanup_handler);"
    },
    {
        "line": 243,
        "fullcodeline": "ssh_signal(SIGTERM, cleanup_handler);"
    },
    {
        "line": 25,
        "fullcodeline": "if (getrlimit(RLIMIT_NOFILE, &rlim) == -1)"
    },
    {
        "line": 32,
        "fullcodeline": "while ((ch = getopt(ac, av, \"cDdksE:a:O:P:t:\")) != -1) {"
    },
    {
        "line": 89,
        "fullcodeline": "if (ac > 0 && (c_flag || k_flag || s_flag || d_flag || D_flag))"
    },
    {
        "line": 92,
        "fullcodeline": "if (allowed_providers == NULL)"
    },
    {
        "line": 95,
        "fullcodeline": "if (ac == 0 && !c_flag && !s_flag) {"
    },
    {
        "line": 134,
        "fullcodeline": "if (rlim.rlim_cur < SSH_AGENT_MIN_FDS)"
    },
    {
        "line": 141,
        "fullcodeline": "if (agentsocket == NULL) {"
    },
    {
        "line": 162,
        "fullcodeline": "if (sock < 0) {"
    },
    {
        "line": 173,
        "fullcodeline": "if (D_flag || d_flag) {"
    },
    {
        "line": 185,
        "fullcodeline": "if (pid == -1) {"
    },
    {
        "line": 189,
        "fullcodeline": "if (pid != 0) {\t\t/* Parent - execute the given command. */"
    },
    {
        "line": 213,
        "fullcodeline": "if (setsid() == -1) {"
    },
    {
        "line": 219,
        "fullcodeline": "if (stdfd_devnull(1, 1, 1) == -1)"
    },
    {
        "line": 224,
        "fullcodeline": "if (setrlimit(RLIMIT_CORE, &rlim) == -1) {"
    },
    {
        "line": 237,
        "fullcodeline": "if (ac > 0)"
    },
    {
        "line": 245,
        "fullcodeline": "if (pledge(\"stdio rpath cpath unix id proc exec\", NULL) == -1)"
    },
    {
        "line": 26,
        "fullcodeline": "fatal(\"%s: getrlimit: %s\", __progname, strerror(errno));"
    },
    {
        "line": 90,
        "fullcodeline": "usage();"
    },
    {
        "line": 93,
        "fullcodeline": "allowed_providers = xstrdup(DEFAULT_ALLOWED_PROVIDERS);"
    },
    {
        "line": 96,
        "fullcodeline": "shell = getenv(\"SHELL\");"
    },
    {
        "line": 102,
        "fullcodeline": "const char *errstr = NULL;"
    },
    {
        "line": 104,
        "fullcodeline": "pidstr = getenv(SSH_AGENTPID_ENV_NAME);"
    },
    {
        "line": 110,
        "fullcodeline": "pid = (int)strtonum(pidstr, 2, INT_MAX, &errstr);"
    },
    {
        "line": 121,
        "fullcodeline": "format = c_flag ? \"unsetenv %s;\\n\" : \"unset %s;\\n\";"
    },
    {
        "line": 122,
        "fullcodeline": "printf(format, SSH_AUTHSOCKET_ENV_NAME);"
    },
    {
        "line": 123,
        "fullcodeline": "printf(format, SSH_AGENTPID_ENV_NAME);"
    },
    {
        "line": 124,
        "fullcodeline": "printf(\"echo Agent pid %ld killed;\\n\", (long)pid);"
    },
    {
        "line": 125,
        "fullcodeline": "exit(0);"
    },
    {
        "line": 135,
        "fullcodeline": "fatal(\"%s: file descriptor rlimit %lld too low (minimum %u)\","
    },
    {
        "line": 143,
        "fullcodeline": "mktemp_proto(socket_dir, sizeof(socket_dir));"
    },
    {
        "line": 148,
        "fullcodeline": "snprintf(socket_name, sizeof socket_name, \"%s/agent.%ld\", socket_dir,"
    },
    {
        "line": 164,
        "fullcodeline": "*socket_name = '\\0'; /* Don't unlink any existing file */"
    },
    {
        "line": 165,
        "fullcodeline": "cleanup_exit(1);"
    },
    {
        "line": 174,
        "fullcodeline": "log_init(__progname,"
    },
    {
        "line": 177,
        "fullcodeline": "format = c_flag ? \"setenv %s %s;\\n\" : \"%s=%s; export %s;\\n\";"
    },
    {
        "line": 178,
        "fullcodeline": "printf(format, SSH_AUTHSOCKET_ENV_NAME, socket_name,"
    },
    {
        "line": 180,
        "fullcodeline": "printf(\"echo Agent pid %ld;\\n\", (long)parent_pid);"
    },
    {
        "line": 181,
        "fullcodeline": "fflush(stdout);"
    },
    {
        "line": 186,
        "fullcodeline": "perror(\"fork\");"
    },
    {
        "line": 187,
        "fullcodeline": "cleanup_exit(1);"
    },
    {
        "line": 190,
        "fullcodeline": "close(sock);"
    },
    {
        "line": 191,
        "fullcodeline": "snprintf(pidstrbuf, sizeof pidstrbuf, \"%ld\", (long)pid);"
    },
    {
        "line": 206,
        "fullcodeline": "execvp(av[0], av);"
    },
    {
        "line": 207,
        "fullcodeline": "perror(av[0]);"
    },
    {
        "line": 208,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 214,
        "fullcodeline": "error(\"setsid: %s\", strerror(errno));"
    },
    {
        "line": 215,
        "fullcodeline": "cleanup_exit(1);"
    },
    {
        "line": 220,
        "fullcodeline": "error_f(\"stdfd_devnull failed\");"
    },
    {
        "line": 225,
        "fullcodeline": "error(\"setrlimit RLIMIT_CORE: %s\", strerror(errno));"
    },
    {
        "line": 226,
        "fullcodeline": "cleanup_exit(1);"
    },
    {
        "line": 238,
        "fullcodeline": "parent_alive_interval = 10;"
    },
    {
        "line": 246,
        "fullcodeline": "fatal(\"%s: pledge: %s\", __progname, strerror(errno));"
    },
    {
        "line": 249,
        "fullcodeline": "prepare_poll(&pfd, &npfd, &timeout, maxfds);"
    },
    {
        "line": 250,
        "fullcodeline": "result = poll(pfd, npfd, timeout);"
    },
    {
        "line": 251,
        "fullcodeline": "saved_errno = errno;"
    },
    {
        "line": 254,
        "fullcodeline": "(void) reaper();\t/* remove expired keys */"
    },
    {
        "line": 97,
        "fullcodeline": "if (shell != NULL && (len = strlen(shell)) > 2 &&"
    },
    {
        "line": 105,
        "fullcodeline": "if (pidstr == NULL) {"
    },
    {
        "line": 117,
        "fullcodeline": "if (kill(pid, SIGTERM) == -1) {"
    },
    {
        "line": 136,
        "fullcodeline": "__progname, (long long)rlim.rlim_cur, SSH_AGENT_MIN_FDS);"
    },
    {
        "line": 144,
        "fullcodeline": "if (mkdtemp(socket_dir) == NULL) {"
    },
    {
        "line": 149,
        "fullcodeline": "(long)parent_pid);"
    },
    {
        "line": 152,
        "fullcodeline": "socket_dir[0] = '\\0';"
    },
    {
        "line": 153,
        "fullcodeline": "strlcpy(socket_name, agentsocket, sizeof socket_name);"
    },
    {
        "line": 175,
        "fullcodeline": "d_flag ? SYSLOG_LEVEL_DEBUG3 : SYSLOG_LEVEL_INFO,"
    },
    {
        "line": 192,
        "fullcodeline": "if (ac == 0) {"
    },
    {
        "line": 201,
        "fullcodeline": "if (setenv(SSH_AUTHSOCKET_ENV_NAME, socket_name, 1) == -1 ||"
    },
    {
        "line": 252,
        "fullcodeline": "if (parent_alive_interval != 0)"
    },
    {
        "line": 255,
        "fullcodeline": "if (result == -1) {"
    },
    {
        "line": 35,
        "fullcodeline": "fingerprint_hash = ssh_digest_alg_by_name(optarg);"
    },
    {
        "line": 42,
        "fullcodeline": "c_flag++;"
    },
    {
        "line": 45,
        "fullcodeline": "k_flag++;"
    },
    {
        "line": 56,
        "fullcodeline": "allowed_providers = xstrdup(optarg);"
    },
    {
        "line": 61,
        "fullcodeline": "s_flag++;"
    },
    {
        "line": 66,
        "fullcodeline": "d_flag++;"
    },
    {
        "line": 71,
        "fullcodeline": "D_flag++;"
    },
    {
        "line": 74,
        "fullcodeline": "agentsocket = optarg;"
    },
    {
        "line": 83,
        "fullcodeline": "usage();"
    },
    {
        "line": 98,
        "fullcodeline": "strncmp(shell + len - 3, \"csh\", 3) == 0)"
    },
    {
        "line": 99,
        "fullcodeline": "c_flag = 1;"
    },
    {
        "line": 106,
        "fullcodeline": "fprintf(stderr, \"%s not set, cannot kill agent\\n\","
    },
    {
        "line": 108,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 112,
        "fullcodeline": "fprintf(stderr,"
    },
    {
        "line": 115,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 118,
        "fullcodeline": "perror(\"kill\");"
    },
    {
        "line": 119,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 145,
        "fullcodeline": "perror(\"mkdtemp: private socket dir\");"
    },
    {
        "line": 146,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 193,
        "fullcodeline": "format = c_flag ? \"setenv %s %s;\\n\" : \"%s=%s; export %s;\\n\";"
    },
    {
        "line": 194,
        "fullcodeline": "printf(format, SSH_AUTHSOCKET_ENV_NAME, socket_name,"
    },
    {
        "line": 196,
        "fullcodeline": "printf(format, SSH_AGENTPID_ENV_NAME, pidstrbuf,"
    },
    {
        "line": 198,
        "fullcodeline": "printf(\"echo Agent pid %ld;\\n\", (long)pid);"
    },
    {
        "line": 199,
        "fullcodeline": "exit(0);"
    },
    {
        "line": 202,
        "fullcodeline": "setenv(SSH_AGENTPID_ENV_NAME, pidstrbuf, 1) == -1) {"
    },
    {
        "line": 203,
        "fullcodeline": "perror(\"setenv\");"
    },
    {
        "line": 204,
        "fullcodeline": "exit(1);"
    },
    {
        "line": 253,
        "fullcodeline": "check_parent_exists();"
    },
    {
        "line": 258,
        "fullcodeline": "fatal(\"poll: %s\", strerror(saved_errno));"
    },
    {
        "line": 36,
        "fullcodeline": "if (fingerprint_hash == -1)"
    },
    {
        "line": 48,
        "fullcodeline": "if (strcmp(optarg, \"no-restrict-websafe\") == 0)"
    },
    {
        "line": 54,
        "fullcodeline": "if (allowed_providers != NULL)"
    },
    {
        "line": 64,
        "fullcodeline": "if (d_flag || D_flag)"
    },
    {
        "line": 69,
        "fullcodeline": "if (d_flag || D_flag)"
    },
    {
        "line": 77,
        "fullcodeline": "if ((lifetime = convtime(optarg)) == -1) {"
    },
    {
        "line": 256,
        "fullcodeline": "if (saved_errno == EINTR)"
    },
    {
        "line": 37,
        "fullcodeline": "fatal(\"Invalid hash algorithm \\\"%s\\\"\", optarg);"
    },
    {
        "line": 41,
        "fullcodeline": "usage();"
    },
    {
        "line": 49,
        "fullcodeline": "restrict_websafe  = 0;"
    },
    {
        "line": 55,
        "fullcodeline": "fatal(\"-P option already specified\");"
    },
    {
        "line": 60,
        "fullcodeline": "usage();"
    },
    {
        "line": 65,
        "fullcodeline": "usage();"
    },
    {
        "line": 70,
        "fullcodeline": "usage();"
    },
    {
        "line": 78,
        "fullcodeline": "fprintf(stderr, \"Invalid lifetime\\n\");"
    },
    {
        "line": 79,
        "fullcodeline": "usage();"
    },
    {
        "line": 259,
        "fullcodeline": "} else if (result > 0)"
    },
    {
        "line": 51,
        "fullcodeline": "fatal(\"Unknown -O option\");"
    },
    {
        "line": 260,
        "fullcodeline": "after_poll(pfd, npfd, maxfds);"
    }
]