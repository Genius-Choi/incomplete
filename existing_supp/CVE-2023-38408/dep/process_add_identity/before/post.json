[
    {
        "line": 4,
        "fullcodeline": "int success = 0, confirm = 0;"
    },
    {
        "line": 5,
        "fullcodeline": "char *fp, *comment = NULL, *sk_provider = NULL;"
    },
    {
        "line": 6,
        "fullcodeline": "char canonical_provider[PATH_MAX];"
    },
    {
        "line": 7,
        "fullcodeline": "time_t death = 0;"
    },
    {
        "line": 8,
        "fullcodeline": "u_int seconds = 0;"
    },
    {
        "line": 9,
        "fullcodeline": "struct dest_constraint *dest_constraints = NULL;"
    },
    {
        "line": 10,
        "fullcodeline": "size_t ndest_constraints = 0;"
    },
    {
        "line": 11,
        "fullcodeline": "struct sshkey *k = NULL;"
    },
    {
        "line": 12,
        "fullcodeline": "int r = SSH_ERR_INTERNAL_ERROR;"
    },
    {
        "line": 14,
        "fullcodeline": "debug2_f(\"entering\");"
    },
    {
        "line": 76,
        "fullcodeline": "id->key = k;"
    },
    {
        "line": 77,
        "fullcodeline": "id->comment = comment;"
    },
    {
        "line": 78,
        "fullcodeline": "id->death = death;"
    },
    {
        "line": 79,
        "fullcodeline": "id->confirm = confirm;"
    },
    {
        "line": 80,
        "fullcodeline": "id->sk_provider = sk_provider;"
    },
    {
        "line": 81,
        "fullcodeline": "id->dest_constraints = dest_constraints;"
    },
    {
        "line": 82,
        "fullcodeline": "id->ndest_constraints = ndest_constraints;"
    },
    {
        "line": 87,
        "fullcodeline": "debug_f(\"add %s %s \\\"%.100s\\\" (life: %u) (confirm: %u) \""
    },
    {
        "line": 91,
        "fullcodeline": "free(fp);"
    },
    {
        "line": 93,
        "fullcodeline": "k = NULL;"
    },
    {
        "line": 94,
        "fullcodeline": "comment = NULL;"
    },
    {
        "line": 95,
        "fullcodeline": "sk_provider = NULL;"
    },
    {
        "line": 96,
        "fullcodeline": "dest_constraints = NULL;"
    },
    {
        "line": 97,
        "fullcodeline": "ndest_constraints = 0;"
    },
    {
        "line": 98,
        "fullcodeline": "success = 1;"
    },
    {
        "line": 100,
        "fullcodeline": "free(sk_provider);"
    },
    {
        "line": 101,
        "fullcodeline": "free(comment);"
    },
    {
        "line": 102,
        "fullcodeline": "sshkey_free(k);"
    },
    {
        "line": 103,
        "fullcodeline": "free_dest_constraints(dest_constraints, ndest_constraints);"
    },
    {
        "line": 104,
        "fullcodeline": "send_status(e, success);"
    },
    {
        "line": 15,
        "fullcodeline": "if ((r = sshkey_private_deserialize(e->request, &k)) != 0 ||"
    },
    {
        "line": 21,
        "fullcodeline": "if (parse_key_constraints(e->request, k, &death, &seconds, &confirm,"
    },
    {
        "line": 28,
        "fullcodeline": "if (sk_provider != NULL) {"
    },
    {
        "line": 53,
        "fullcodeline": "if ((r = sshkey_shield_private(k)) != 0) {"
    },
    {
        "line": 57,
        "fullcodeline": "if (lifetime && !death)"
    },
    {
        "line": 59,
        "fullcodeline": "if ((id = lookup_identity(k)) == NULL) {"
    },
    {
        "line": 84,
        "fullcodeline": "if ((fp = sshkey_fingerprint(k, SSH_FP_HASH_DEFAULT,"
    },
    {
        "line": 89,
        "fullcodeline": "sshkey_ssh_name(k), fp, comment, seconds, confirm,"
    },
    {
        "line": 90,
        "fullcodeline": "sk_provider == NULL ? \"none\" : sk_provider, ndest_constraints);"
    },
    {
        "line": 17,
        "fullcodeline": "(r = sshbuf_get_cstring(e->request, &comment, NULL)) != 0) {"
    },
    {
        "line": 18,
        "fullcodeline": "error_fr(r, \"parse\");"
    },
    {
        "line": 23,
        "fullcodeline": "error_f(\"failed to parse constraints\");"
    },
    {
        "line": 24,
        "fullcodeline": "sshbuf_reset(e->request);"
    },
    {
        "line": 54,
        "fullcodeline": "error_fr(r, \"shield private\");"
    },
    {
        "line": 58,
        "fullcodeline": "death = monotime() + lifetime;"
    },
    {
        "line": 60,
        "fullcodeline": "id = xcalloc(1, sizeof(Identity));"
    },
    {
        "line": 61,
        "fullcodeline": "TAILQ_INSERT_TAIL(&idtab->idlist, id, next);"
    },
    {
        "line": 86,
        "fullcodeline": "fatal_f(\"sshkey_fingerprint failed\");"
    },
    {
        "line": 16,
        "fullcodeline": "k == NULL ||"
    },
    {
        "line": 29,
        "fullcodeline": "if (!sshkey_is_sk(k)) {"
    },
    {
        "line": 34,
        "fullcodeline": "if (strcasecmp(sk_provider, \"internal\") == 0) {"
    },
    {
        "line": 69,
        "fullcodeline": "sshkey_free(id->key);"
    },
    {
        "line": 70,
        "fullcodeline": "free(id->comment);"
    },
    {
        "line": 71,
        "fullcodeline": "free(id->sk_provider);"
    },
    {
        "line": 72,
        "fullcodeline": "free_dest_constraints(id->dest_constraints,"
    },
    {
        "line": 30,
        "fullcodeline": "error(\"Cannot add provider: %s is not an \""
    },
    {
        "line": 35,
        "fullcodeline": "debug_f(\"internal provider\");"
    },
    {
        "line": 66,
        "fullcodeline": "if (identity_permitted(id, e, NULL, NULL, NULL) != 0)"
    },
    {
        "line": 31,
        "fullcodeline": "\"authenticator-hosted key\", sshkey_type(k));"
    },
    {
        "line": 43,
        "fullcodeline": "free(sk_provider);"
    },
    {
        "line": 44,
        "fullcodeline": "sk_provider = xstrdup(canonical_provider);"
    },
    {
        "line": 37,
        "fullcodeline": "if (realpath(sk_provider, canonical_provider) == NULL) {"
    },
    {
        "line": 45,
        "fullcodeline": "if (match_pattern_list(sk_provider,"
    },
    {
        "line": 38,
        "fullcodeline": "verbose(\"failed provider \\\"%.100s\\\": \""
    },
    {
        "line": 47,
        "fullcodeline": "error(\"Refusing add key: \""
    },
    {
        "line": 40,
        "fullcodeline": "strerror(errno));"
    }
]