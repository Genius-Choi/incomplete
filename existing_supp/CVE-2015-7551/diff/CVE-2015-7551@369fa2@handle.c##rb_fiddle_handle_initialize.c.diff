--- before
+++ after
@@ -13,11 +13,11 @@
 	cflag = RTLD_LAZY | RTLD_GLOBAL;

 	break;

       case 1:

-	clib = NIL_P(lib) ? NULL : StringValuePtr(lib);

+	clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);

 	cflag = RTLD_LAZY | RTLD_GLOBAL;

 	break;

       case 2:

-	clib = NIL_P(lib) ? NULL : StringValuePtr(lib);

+	clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);

 	cflag = NUM2INT(flag);

 	break;

       default:

