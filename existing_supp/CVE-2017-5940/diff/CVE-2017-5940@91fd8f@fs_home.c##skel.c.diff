--- before
+++ after
@@ -11,18 +11,12 @@
 		if (stat(fname, &s) == 0)

 			return;

 		if (stat("/etc/skel/.zshrc", &s) == 0) {

-			if (copy_file("/etc/skel/.zshrc", fname, u, g, 0644) == 0) {

-				fs_logger("clone /etc/skel/.zshrc");

-			}

+			copy_file("/etc/skel/.zshrc", fname, u, g, 0644);

+			fs_logger("clone /etc/skel/.zshrc");

 		}

-		else { // 

-			FILE *fp = fopen(fname, "w");

-			if (fp) {

-				fprintf(fp, "\n");

-				SET_PERMS_STREAM(fp, u, g, S_IRUSR | S_IWUSR);

-				fclose(fp);

-				fs_logger2("touch", fname);

-			}

+		else {

+			touch_file_as_user(fname, u, g, 0644);

+			fs_logger2("touch", fname);

 		}

 		free(fname);

 	}

@@ -36,19 +30,12 @@
 		if (stat(fname, &s) == 0)

 			return;

 		if (stat("/etc/skel/.cshrc", &s) == 0) {

-			if (copy_file("/etc/skel/.cshrc", fname, u, g, 0644) == 0) {

-				fs_logger("clone /etc/skel/.cshrc");

-			}

+			copy_file("/etc/skel/.cshrc", fname, u, g, 0644);

+			fs_logger("clone /etc/skel/.cshrc");

 		}

-		else { // 

-			/* coverity[toctou] */

-			FILE *fp = fopen(fname, "w");

-			if (fp) {

-				fprintf(fp, "\n");

-				SET_PERMS_STREAM(fp, u, g, S_IRUSR | S_IWUSR);

-				fclose(fp);

-				fs_logger2("touch", fname);

-			}

+		else {

+			touch_file_as_user(fname, u, g, 0644);

+			fs_logger2("touch", fname);

 		}

 		free(fname);

 	}

@@ -62,9 +49,8 @@
 		if (stat(fname, &s) == 0) 

 			return;

 		if (stat("/etc/skel/.bashrc", &s) == 0) {

-			if (copy_file("/etc/skel/.bashrc", fname, u, g, 0644) == 0) {

-				fs_logger("clone /etc/skel/.bashrc");

-			}

+			copy_file("/etc/skel/.bashrc", fname, u, g, 0644);

+			fs_logger("clone /etc/skel/.bashrc");

 		}

 		free(fname);

 	}

