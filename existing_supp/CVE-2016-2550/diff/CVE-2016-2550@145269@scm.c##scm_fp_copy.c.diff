--- before
+++ after
@@ -21,6 +21,7 @@
 		*fplp = fpl;

 		fpl->count = 0;

 		fpl->max = SCM_MAX_FD;

+		fpl->user = NULL;

 	}

 	fpp = &fpl->fp[fpl->count];

 

@@ -41,5 +42,9 @@
 		*fpp++ = file;

 		fpl->count++;

 	}

+

+	if (!fpl->user)

+		fpl->user = get_uid(current_user());

+

 	return num;

 }

