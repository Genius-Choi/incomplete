--- before
+++ after
@@ -1,4 +1,4 @@
-void unix_notinflight(struct file *fp)

+void unix_notinflight(struct user_struct *user, struct file *fp)

 {

 	struct sock *s = unix_get_socket(fp);

 

@@ -13,6 +13,6 @@
 			list_del_init(&u->link);

 		unix_tot_inflight--;

 	}

-	fp->f_cred->user->unix_inflight--;

+	user->unix_inflight--;

 	spin_unlock(&unix_gc_lock);

 }

