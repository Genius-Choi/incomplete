      def select_logger(env)
        @logger = if @logger_proc
          logger_proc = @logger_proc
          @logger_proc = nil
          logger_proc.call

        elsif defined?(Rails) && Rails.respond_to?(:logger) && Rails.logger
          Rails.logger

        elsif env[RACK_LOGGER]
          env[RACK_LOGGER]

        else
          ::Logger.new(STDOUT).tap { |logger| logger.level = ::Logger::Severity::DEBUG }
        end
      end
