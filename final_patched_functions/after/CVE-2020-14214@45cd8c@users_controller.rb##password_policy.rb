  def password_policy(password)
    if Setting.get('password_min_size').to_i > password.length
      return ['Invalid password, it must be at least %s characters long!', Setting.get('password_min_size')]
    end
    if Setting.get('password_need_digit').to_i == 1 && password !~ /\d/
      return ['Invalid password, it must contain at least 1 digit!']
    end
    if Setting.get('password_min_2_lower_2_upper_characters').to_i == 1 && ( password !~ /[A-Z].*[A-Z]/ || password !~ /[a-z].*[a-z]/ )
      return ['Invalid password, it must contain at least 2 lowercase and 2 uppercase characters!']
    end

    true
  end
