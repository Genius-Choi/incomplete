  def edit
    if @user.mfa_enabled?
      @otp_verification_url = otp_edit_user_password_url(@user, token: @user.confirmation_token)
      setup_webauthn_authentication(form_url: webauthn_edit_user_password_url(token: @user.confirmation_token))

      create_new_mfa_expiry

      render template: "multifactor_auths/prompt"
    else
      # When user doesn't have mfa, a valid token is a full "magic link" sign in.
      verified_sign_in
      render template: "passwords/edit"
    end
  end
