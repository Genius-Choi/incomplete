static void handle_put_publish(struct http_conn *conn,
			       const struct http_msg *msg,
			       struct mbuf *mb, size_t clen)
{
	struct ident_entry *ie = NULL;
	struct pl pl;
	char *key = NULL;
	int err;

	err = re_regex(msg->prm.p, msg->prm.l, "?pairid=[0-9]+", &pl);
	if (err) {
		warning("invalid input\n");
		goto out;
	}

	pl_strdup(&key, &pl);

	ie = dict_lookup(verifyd.idents, key);
	if (!ie) {
		info("publish: pairing-id %s not found\n", key);
		http_ereply(conn, 404, "Not found");
		goto out;
	}

	debug("publish: saving content(%zu): %b\n",
		  clen, mbuf_buf(mb), mbuf_get_left(mb));

	mbuf_strdup(mb, &ie->content.publish, clen);

	http_reply(conn, 200, "OK", NULL);

	http_conn_close(conn);

 out:
	mem_deref(key);
}
