async def tests_billion_laughs_attack() -> None:
    parser = XMLOutputParser()
    with pytest.raises(OutputParserException):
        parser.parse(MALICIOUS_XML)

    with pytest.raises(OutputParserException):
        await parser.aparse(MALICIOUS_XML)

    with pytest.raises(ParseError):
        # Right now raises undefined entity error
        assert list(parser.transform(iter(MALICIOUS_XML))) == [
            {"foo": [{"bar": [{"baz": None}]}]}
        ]

    async def _as_iter(string: str) -> AsyncIterator[str]:
        for c in string:
            yield c

    with pytest.raises(ParseError):
        chunks = [chunk async for chunk in parser.atransform(_as_iter(MALICIOUS_XML))]
        assert chunks == [{"foo": [{"bar": [{"baz": None}]}]}]
