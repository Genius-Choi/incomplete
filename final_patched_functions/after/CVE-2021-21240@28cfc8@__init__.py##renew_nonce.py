    def renew_nonce():
        if gnextnonce[0]:
            assert False, "previous nextnonce was not used, probably bug in test code"
        gnextnonce[0] = gen_digest_nonce()
        return gserver_nonce[0], gnextnonce[0]
