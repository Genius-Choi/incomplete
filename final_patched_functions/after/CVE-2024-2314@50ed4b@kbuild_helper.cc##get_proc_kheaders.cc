int get_proc_kheaders(std::string &dirpath)
{
  struct utsname uname_data;
  char dirpath_tmp[256];

  if (uname(&uname_data))
    return -errno;

  snprintf(dirpath_tmp, 256, "%s/kheaders-%s", get_tmp_dir(),
           uname_data.release);
  dirpath = std::string(dirpath_tmp);

  if (file_exists_and_ownedby(dirpath_tmp, 0))
    return 0;

  // First time so extract it
  return extract_kheaders(dirpath, uname_data);
}
