def test_list_artifacts_malicious_path(http_artifact_repo, path):
    with mock.patch(
        "mlflow.store.artifact.http_artifact_repo.http_request",
        return_value=MockResponse(
            {
                "files": [
                    {"path": path, "is_dir": False, "file_size": 1},
                ]
            },
            200,
        ),
    ):
        with pytest.raises(MlflowException, match="Invalid path"):
            http_artifact_repo.list_artifacts()
