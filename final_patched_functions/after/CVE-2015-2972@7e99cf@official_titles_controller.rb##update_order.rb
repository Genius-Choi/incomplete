  def update_order
    Log.add_info(request, params.inspect)

    return unless request.post?

    order_ary = params[:official_titles_order]

    @group_id = params[:group_id]
    SqlHelper.validate_token([@group_id])

    parent_titles = OfficialTitle.get_for(Group.find(@group_id).parent_id, true, true)
    order_offset = parent_titles.length

    @official_titles = OfficialTitle.get_for(@group_id, false, true)

    @official_titles.each do |official_title|
      official_title.update_attribute(:xorder, order_offset + order_ary.index(official_title.id.to_s) + 1)
    end

    render(:text => '')
  end
