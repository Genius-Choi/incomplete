bool NameConstraints::is_permitted(const X509_Certificate& cert, bool reject_unknown) const {
   if(reject_unknown && m_permitted_contains_unknown) {
      return false;
   }

   if(permitted().empty()) {
      return true;
   }

   for(const auto& c : m_permitted_subtrees) {
      const auto m = c.base().matches(cert);

      if(m == GeneralName::MatchResult::All) {
         return true;
      }
   }

   return false;
}
