  StatusOr<std::vector<int64_t>> GetStride(XlaOpKernelContext* ctx) {
    std::vector<int64_t> stride;
    if (ctx->num_inputs() == 1) {
      stride = stride_;
    } else {
      const TensorShape stride_shape = ctx->InputShape(2);
      // Validate input sizes.
      if (!TensorShapeUtils::IsVector(stride_shape)) {
        return errors::InvalidArgument("stride must be a vector, not shape ",
                                       stride_shape.DebugString());
      }
      if (stride_shape.num_elements() != num_dims()) {
        return errors::InvalidArgument(
            "Sliding window stride field must "
            "specify ",
            num_dims(), " dimensions");
      }
      auto status = ctx->ConstantInputAsIntVector(2, &stride);
      if (!status.ok()) {
        return status;
      }
    }
    TF_RETURN_IF_ERROR(ValidateStrides(stride));
    return stride;
  }
