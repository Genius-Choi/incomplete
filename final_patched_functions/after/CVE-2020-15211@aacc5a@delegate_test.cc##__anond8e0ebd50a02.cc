        reg.prepare = [](TfLiteContext* context, TfLiteNode* node) {
          // Shapes should already by propagated by the runtime, just need to
          // check.
          const TfLiteTensor* input1;
          TF_LITE_ENSURE_OK(context, GetInputSafe(context, node, 0, &input1));
          TfLiteTensor* output;
          TF_LITE_ENSURE_OK(context, GetOutputSafe(context, node, 0, &output));
          const int input_dims_size = input1->dims->size;
          TF_LITE_ENSURE(context, output->dims->size == input_dims_size);
          for (int i = 0; i < input_dims_size; ++i) {
            TF_LITE_ENSURE(context,
                           output->dims->data[i] == input1->dims->data[i]);
          }
          return kTfLiteOk;
        };
