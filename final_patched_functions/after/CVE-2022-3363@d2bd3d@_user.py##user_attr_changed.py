def user_attr_changed(mapper, connection, target):
    changes = {}
    state = inspect(target)
    for attr in state.attrs:
        if attr.key in ['user_root', 'email', 'role', 'mfa']:
            hist = attr.load_history()
            if hist.has_changes():
                changes[attr.key] = (
                    hist.deleted[0] if len(hist.deleted) >= 1 else None,
                    hist.added[0] if len(hist.added) >= 1 else None,
                )
    if changes:
        cherrypy.engine.publish('user_attr_changed', target, changes)
