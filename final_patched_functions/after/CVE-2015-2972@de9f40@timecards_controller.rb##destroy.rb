  def destroy
    Log.add_info(request, params.inspect)

    return unless request.post?

    begin
      timecard = Timecard.find(params[:id])

      if timecard.user_id != @login_user.id and !@login_user.admin?(User::AUTH_TIMECARD)
        Log.add_check(request, '[User::AUTH_TIMECARD]'+request.to_s)
        redirect_to(:controller => 'frames', :action => 'http_error', :id => '401')
        return
      end

      date = timecard.date
      timecard.destroy unless timecard.nil?
    rescue => evar
    end

    flash[:notice] = t('msg.delete_success')

    prms = ApplicationHelper.get_fwd_params(params)
    prms.delete(:id)
    prms[:action] = 'edit'
    prms[:date] = date unless date.nil?

    redirect_to(prms)
  end
