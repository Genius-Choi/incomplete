static int get_prop(int fd, uint32_t client_id, const char *name, void **value, size_t *size) {
	// xref VbglR3GuestPropRead() in
	// virtualbox/src/VBox/Additions/common/VBoxGuest/lib/VBoxGuestR3LibGuestProp.cpp

	// init header
	size_t msg_size = sizeof(struct vbg_ioctl_hgcm_call) + 4 * sizeof(struct vmmdev_hgcm_function_parameter64);
	struct vbg_ioctl_hgcm_call _cleanup_free_ *msg = calloc(1, msg_size);
	// init_header re-adds the size of msg->hdr
	init_header(&msg->hdr, msg_size - sizeof(msg->hdr), msg_size - sizeof(msg->hdr));
	msg->client_id = client_id;
	msg->function = GUEST_PROP_FN_GET_PROP;
	msg->timeout_ms = -1;  // inf
	msg->interruptible = 1;
	msg->parm_count = 4;

	// init arguments
	char ch;
	struct vmmdev_hgcm_function_parameter64 *params = (void *) (msg + 1);
	// property name (in)
	params[0].type = VMMDEV_HGCM_PARM_TYPE_LINADDR_IN;
	params[0].u.pointer.size = strlen(name) + 1;
	params[0].u.pointer.u.linear_addr = (uintptr_t) name;
	// property value (out)
	params[1].type = VMMDEV_HGCM_PARM_TYPE_LINADDR;
	params[1].u.pointer.size = 1;
	params[1].u.pointer.u.linear_addr = (uintptr_t) &ch;
	// property timestamp (out)
	params[2].type = VMMDEV_HGCM_PARM_TYPE_64BIT;
	// property size (out)
	params[3].type = VMMDEV_HGCM_PARM_TYPE_32BIT;

	// get value size
	if (ioctl(fd, VBG_IOCTL_HGCM_CALL_64(msg_size), msg)) {
		return VERR_GENERAL_FAILURE;
	}
	switch (msg->hdr.rc) {
	case VINF_SUCCESS:
	case VERR_BUFFER_OVERFLOW:
		// allocate buffer
		; // labels can't point to declarations
		size_t buf_size = params[3].u.value32;
		void _cleanup_free_ *buf = malloc(buf_size);
		params[1].u.pointer.size = buf_size;
		params[1].u.pointer.u.linear_addr = (uintptr_t) buf;

		// get value
		if (ioctl(fd, VBG_IOCTL_HGCM_CALL_64(msg_size), msg)) {
			return VERR_GENERAL_FAILURE;
		}
		if (msg->hdr.rc != VINF_SUCCESS) {
			return msg->hdr.rc;
		}
		*value = buf;
		buf = NULL;
		*size = buf_size;
		return VINF_SUCCESS;
	case VERR_NOT_FOUND:
		*value = NULL;
		*size = 0;
		return VINF_SUCCESS;
	default:
		return msg->hdr.rc;
	}
}
