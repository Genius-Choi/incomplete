async def test_shadow_traversal(shadow_path, manager):
    file_beyond_shadow_root_uri = (Path(shadow_path) / ".." / "test.py").as_uri()

    shadow = setup_shadow_filesystem(Path(shadow_path).as_uri())

    def run_shadow(message):
        return shadow("client", message, "python-lsp-server", manager)

    with pytest.raises(
        ShadowFilesystemError, match="is not relative to shadow filesystem root"
    ):
        await run_shadow(did_open(file_beyond_shadow_root_uri, "content"))
