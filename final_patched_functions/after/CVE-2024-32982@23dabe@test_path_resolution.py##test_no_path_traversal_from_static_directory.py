def test_no_path_traversal_from_static_directory(
    tmp_path: Path, monkeypatch: MonkeyPatch, server_command: List[str], run_server: Callable[[str, List[str]], None]
) -> None:
    import http.client

    static = tmp_path / "static"
    static.mkdir()
    (static / "index.html").write_text("Hello, World!")

    app = """
from pathlib import Path
from litestar import Litestar
from litestar.static_files import create_static_files_router
import uvicorn

app = Litestar(
    route_handlers=[
        create_static_files_router(path="/static", directories=["static"]),
    ],
)
    """

    def send_request(host: str, port: int, path: str) -> http.client.HTTPResponse:
        connection = http.client.HTTPConnection(host, port)
        connection.request("GET", path)
        resp = connection.getresponse()
        connection.close()
        return resp

    run_server(app, server_command)

    response = send_request("127.0.0.1", 9999, "/static/index.html")
    assert response.status == 200

    response = send_request("127.0.0.1", 9999, "/static/../app.py")
    assert response.status == 404
