def test_assets_secure(solara_server, solara_app, extra_include_path):
    assets_url = solara_server.base_url + "/static/assets"
    assets_directory = solara.server.server.solara_static.parent / "assets"

    with extra_include_path(HERE), solara_app("server_test:ClickButton"):
        url = assets_url + "/theme.js"
        response = requests.get(url)
        assert response.status_code == 200
        test_file = assets_directory.parent / "__init__.py"
        assert test_file.exists()
        url = assets_url + "/..%2f__init__.py"
        response = requests.get(url)
        assert response.status_code == 404

        url = assets_url + "/foo/..%2f..%2f__init__.py"
        response = requests.get(url)
        assert response.status_code == 404
