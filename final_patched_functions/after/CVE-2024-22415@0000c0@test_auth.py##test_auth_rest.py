def test_auth_rest(route: str, a_server_url_and_token: Tuple[str, str]) -> None:
    """Verify a REST route only provides access to an authenticated user."""
    base_url, token = a_server_url_and_token

    verify_response(base_url, route)

    url = f"{base_url}{route}"

    with urlopen(f"{url}?token={token}") as response:
        raw_body = response.read().decode("utf-8")

    decode_error = None

    try:
        json.loads(raw_body)
    except json.decoder.JSONDecodeError as err:
        decode_error = err
    assert not decode_error, f"the response for {url} was not JSON"
