  def get_auth_teams
    Log.add_info(request, params.inspect)

    folder_id = params[:id]
    SqlHelper.validate_token([folder_id])

    begin
      @folder = Folder.find(folder_id)
    rescue
      @folder = nil
    end

    target_user_id = (@login_user.admin?(User::AUTH_TEAM))?(nil):(@login_user.id)
    @teams = Team.get_for(target_user_id, true)

    session[:folder_id] = folder_id

    render(:partial => 'ajax_auth_teams', :layout => false)
  end
