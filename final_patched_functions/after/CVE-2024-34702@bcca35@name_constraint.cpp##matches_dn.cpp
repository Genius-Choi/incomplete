bool GeneralName::matches_dn(const X509_DN& name, const X509_DN& constraint) {
   const auto attr = name.get_attributes();
   bool ret = true;
   size_t trys = 0;

   for(const auto& c : constraint.dn_info()) {
      auto i = attr.equal_range(c.first);

      if(i.first != i.second) {
         trys += 1;
         ret = ret && (i.first->second == c.second.value());
      }
   }

   return trys > 0 && ret;
}
