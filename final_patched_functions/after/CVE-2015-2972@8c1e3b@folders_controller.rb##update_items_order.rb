  def update_items_order
    Log.add_info(request, params.inspect)

    return unless request.post?

    folder_id = params[:id]

    if Folder.check_user_auth(folder_id, @login_user, 'w', true)

      order_ary = params[:items_order]

      if !@login_user.nil? and @login_user.admin?(User::AUTH_ITEM)
        items = Folder.get_items_admin(folder_id)
      else
        items = Folder.get_items(@login_user, folder_id)
      end
      items.each do |item|
        item.update_attribute(:xorder, order_ary.index(item.id.to_s) + 1)
      end
    else
      Log.add_error(request, nil, 'No Authority Error')
    end

    render(:text => '')
  end
