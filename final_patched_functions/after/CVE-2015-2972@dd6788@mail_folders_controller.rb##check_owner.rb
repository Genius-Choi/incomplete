  def check_owner
    # '0' for ROOT
    return if params[:id].nil? \
             or params[:id].empty? \
             or params[:id]=='0' \
             or @login_user.nil?

    begin
      owner_id = MailFolder.find(params[:id]).user_id
    rescue
      owner_id = -1
    end
    if !@login_user.admin?(User::AUTH_MAIL) and owner_id != @login_user.id
      Log.add_check(request, '[check_owner]'+request.to_s)

      flash[:notice] = t('msg.need_to_be_owner')
      redirect_to(:controller => 'desktop', :action => 'show')
    end
  end
