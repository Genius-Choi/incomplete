virtio_audio_deinit(struct vmctx *ctx, struct pci_vdev *dev, char *opts)
{
	struct virtio_audio *virt_audio;

	virt_audio = dev->arg;
	if (!virt_audio) {
		DPRINTF(("%s: virtio_audio is NULL!\n", __func__));
		return;
	}
	if (virt_audio->vbs_k.kstatus == VIRTIO_DEV_STARTED) {
		DPRINTF(("%s: deinit virtio_audio_k!\n", __func__));
		virtio_audio_kernel_stop(virt_audio);
		virtio_audio_kernel_reset(virt_audio);
		virt_audio->vbs_k.kstatus = VIRTIO_DEV_INITIAL;
		if (virt_audio->vbs_k.audio_fd < 0) {
			WPRINTF(("virtio_audio: %s  doesn't open!\n",
				vbs_k_audio_dev_path));
			return;
		}
		close(virt_audio->vbs_k.audio_fd);
		virt_audio->vbs_k.audio_fd = -1;
	}
	virtio_audio_reset(virt_audio);
	pthread_mutex_destroy(&virt_audio->mtx);
	DPRINTF(("%s: free struct virtio_audio!\n", __func__));
	free((struct virtio_audio *)dev->arg);
}
