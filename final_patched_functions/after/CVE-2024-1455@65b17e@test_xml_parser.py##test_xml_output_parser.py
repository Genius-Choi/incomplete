async def test_xml_output_parser(result: str) -> None:
    """Test XMLOutputParser."""

    xml_parser = XMLOutputParser()
    assert DEF_RESULT_EXPECTED == xml_parser.parse(result)
    assert DEF_RESULT_EXPECTED == (await xml_parser.aparse(result))
    assert list(xml_parser.transform(iter(result))) == [
        {"foo": [{"bar": [{"baz": None}]}]},
        {"foo": [{"bar": [{"baz": "slim.shady"}]}]},
        {"foo": [{"baz": "tag"}]},
    ]

    async def _as_iter(string: str) -> AsyncIterator[str]:
        for c in string:
            yield c

    chunks = [chunk async for chunk in xml_parser.atransform(_as_iter(result))]
    assert chunks == [
        {"foo": [{"bar": [{"baz": None}]}]},
        {"foo": [{"bar": [{"baz": "slim.shady"}]}]},
        {"foo": [{"baz": "tag"}]},
    ]
