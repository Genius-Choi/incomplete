      def allowed_tokens
        @token_lock.synchronize do

          unless @cycle_at && (@cycle_at > Time.now)
            @token2 = @token1
            @token1 = SecureRandom.hex
            @cycle_at = Time.now + Rack::MiniProfiler::AbstractStore::MAX_TOKEN_AGE
          end

          [@token1, @token2].compact

        end
      end
