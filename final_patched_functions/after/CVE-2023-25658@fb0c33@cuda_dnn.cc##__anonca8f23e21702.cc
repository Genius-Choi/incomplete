  auto check_no_side_input_or_activation = [&]() -> tsl::Status {
    if (activation_mode != dnn::ActivationMode::kNone ||
        !side_input.is_null()) {
      return tsl::Status(
          tsl::error::INTERNAL,
          absl::StrCat(
              "Side input and activation are not supported by cuDNN version: ",
              CUDNN_VERSION));
    } else {
      return ::tsl::OkStatus();
    }
  };
