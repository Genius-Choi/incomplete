int virtualbox_get_guest_property(char *name, void **value, size_t *size) {
	// connect
	uint32_t client_id;
	int ret = start_connection(&client_id);
	if (ret < 0) {
		return ret;
	}
	int _cleanup_close_ fd = ret;

	// get property
	ret = get_prop(fd, client_id, name, value, size);
	if (ret != VINF_SUCCESS) {
		disconnect(fd, client_id);
		return ret;
	}

	// disconnect
	ret = disconnect(fd, client_id);
	if (ret != VINF_SUCCESS) {
		// we could ignore the failure, but better to make sure bugs
		// are noticed
		free(*value);
		*value = NULL;
		return ret;
	}

	// for clarity, ensure the Go error return is nil
	errno = 0;
	return 0;
}
