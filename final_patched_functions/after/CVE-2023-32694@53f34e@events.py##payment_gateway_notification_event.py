def payment_gateway_notification_event(
    *, order: Order, user: UserType, message: str, payment: Payment
) -> OrderEvent:
    if not _user_is_valid(user):
        user = None
    parameters = {"message": message}

    if payment:
        parameters.update({"gateway": payment.gateway, "payment_id": payment.token})

    return OrderEvent.objects.create(
        order=order,
        type=OrderEvents.PAYMENT_GATEWAY_NOTIFICATION,
        user=user,
        parameters=parameters,
    )
