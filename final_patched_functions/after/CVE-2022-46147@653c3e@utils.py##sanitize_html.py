def sanitize_html(raw_body: str) -> str:
    """
    Remove not allowed HTML tags to mitigate XSS vulnerabilities.
    """
    bleach_options = dict(
        tags=ALLOWED_TAGS,
        protocols=bleach.ALLOWED_PROTOCOLS,
        strip=True,
        attributes=ALLOWED_ATTRIBUTES,
    )
    if CSSSanitizer:
        bleach_options['css_sanitizer'] = CSSSanitizer()
    else:
        # pylint: disable=fixme
        # TODO: This is maintaining backward compatibility with bleach 4.1.0 used in Maple release of edx-platform.
        #  This can be removed for the Nutmeg release which uses bleach 5.0.0
        bleach_options['styles'] = ALLOWED_STYLES

    return bleach.clean(raw_body, **bleach_options)
