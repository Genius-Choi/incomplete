get_certificate_type(X509 *cert, bool is_ta, enum cert_type *result)
{
	if (is_ta) {
		*result = TA;
		return 0;
	}

	if (X509_check_ca(cert) == 1) {
		*result = CA;
		return 0;
	}

	if (has_bgpsec_router_eku(cert)) {
		*result = BGPSEC;
		return 0;
	}

	*result = EE; /* Shuts up nonsense gcc 8.3 warning */
	return pr_val_err("Certificate is not TA, CA nor BGPsec. Ignoring...");
}
