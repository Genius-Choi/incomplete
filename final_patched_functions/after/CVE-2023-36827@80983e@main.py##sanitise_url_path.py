def sanitise_url_path(path: str) -> str:
    """Returns a URL path that does not contain any ../ or //"""
    path = unquote(path)
    path = os.path.normpath(path)
    for token in path.split("/"):
        if ".." in token:
            logger.warning(f"Potentially dangerous use of URL hierarchy in path: {path}")
            raise MalisciousUrlException()
    return path
