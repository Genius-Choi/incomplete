def user_can_create_library(user, org):
    """
    Helper method for returning the library creation status for a particular user,
    taking into account the value LIBRARIES_ENABLED.

    if the ENABLE_CREATOR_GROUP value is False, then any user can create a library (in any org),
    if library creation is enabled.

    if the ENABLE_CREATOR_GROUP value is true, then what a user can do varies by thier role.

    Global Staff: can make libraries in any org.
    Course Creator Group Members: can make libraries in any org.
    Organization Staff: Can make libraries in the organization for which they are staff.
    Course Staff: Can make libraries in the organization which has courses of which they are staff.
    Course Admin: Can make libraries in the organization which has courses of which they are Admin.
    """
    if org is None:
        return False
    if not LIBRARIES_ENABLED:
        return False
    elif user.is_staff:
        return True
    if settings.FEATURES.get('ENABLE_CREATOR_GROUP', False):
        is_course_creator = get_course_creator_status(user) == 'granted'
        has_org_staff_role = org in OrgStaffRole().get_orgs_for_user(user)
        has_course_staff_role = (
            UserBasedRole(user=user, role=CourseStaffRole.ROLE)
            .courses_with_role()
            .filter(org=org)
            .exists()
        )
        has_course_admin_role = (
            UserBasedRole(user=user, role=CourseInstructorRole.ROLE)
            .courses_with_role()
            .filter(org=org)
            .exists()
        )
        return is_course_creator or has_org_staff_role or has_course_staff_role or has_course_admin_role

    else:
        # EDUCATOR-1924: DISABLE_LIBRARY_CREATION overrides DISABLE_COURSE_CREATION, if present.
        disable_library_creation = settings.FEATURES.get('DISABLE_LIBRARY_CREATION', None)
        disable_course_creation = settings.FEATURES.get('DISABLE_COURSE_CREATION', False)
        if disable_library_creation is not None:
            return not disable_library_creation
        else:
            return not disable_course_creation
