/* static */ tsl::StatusOr<CUresult> GpuDriver::QueryEvent(GpuContext* context,
                                                           CUevent event) {
  ScopedActivateContext activated{context};
  CUresult res = cuEventQuery(event);
  if (res != CUDA_SUCCESS && res != CUDA_ERROR_NOT_READY) {
    return tsl::Status(
        tsl::error::INTERNAL,
        absl::StrFormat("failed to query event: %s", ToString(res)));
  }

  return res;
}
