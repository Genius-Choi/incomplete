static void handle_get_publish(struct http_conn *conn,
			       const struct http_msg *msg,
			       struct mbuf *mb, size_t clen)
{
	struct ident_entry *ie = NULL;
	struct pl pl;
	char *key = NULL;
	int err;

	info("handle get publish\n");

	err = re_regex(msg->prm.p, msg->prm.l, "?pairid=[0-9]+", &pl);
	if (err) {
		warning("invalid input\n");
		goto out;
	}

	pl_strdup(&key, &pl);

	ie = dict_lookup(verifyd.idents, key);
	if (!ie) {
		info("publish: pairing-id %s not found\n", key);
		http_ereply(conn, 404, "Not found");
		goto out;
	}

	debug("handle get publish (content=%s)\n", ie->content.publish);

	if (ie->content.publish) {
		http_creply(conn, 200, "OK",
			    "application/json", "%s", ie->content.publish);
	}
	else {
		http_ereply(conn, 404, "Not Yet");
	}

	http_conn_close(conn);

 out:
	mem_deref(key);
}
