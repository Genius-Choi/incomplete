  def initialize(client_id)
    @client_id = client_id
    @name = "An unknown application"
    @logo = "/warning.svg"
    @url = @client_id
    @redirects = []
    if should_fetch?
      begin
        URI(client_id).open do |f|
          doc = Nokogiri::HTML(f.read)

          url = ""
          doc.xpath("//div[@class='h-app']//a[contains(@class, 'u-url')]/@href").each {|u| url = u.value}
          @url = client_id.chomp("/") + url if url.start_with? "/"

          name = ""
          doc.xpath("//div[@class='h-app']//a[contains(@class, 'p-name')]/text()").each {|n| name = n.text}
          @name = name unless name.empty?

          logo = ""
          doc.xpath("//div[@class='h-app']//img[contains(@class, 'u-logo')]/@src").each {|l| logo = l.value}
          @logo = client_id.chomp("/") + logo if logo.start_with? "/"

          raw_redirect = []
          doc.xpath("//link[@rel='redirect_uri']").each {|l| raw_redirects << l["href"]}
          raw_redirects.each do |rr|
            if rr.start_with? "/"
              @redirects << client_id.chomp("/") + rr
            else
              @redirects << rr
            end
          end
        end
      rescue
        # do we need to complain loudly if unable to fetch client_id?
      end
    else
      @name = "A test application at #{@client_id}"
    end
  end
