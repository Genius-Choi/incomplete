def get_ohdsi_metadata(label: str) -> OHDSIMetaData:
    """
    Retrieve the OHDSI metadata from the environment variables.

    The following environment variables are expected to be set in the
    node configuration in the `env` key of the `database` section:

    - `CDM_DATABASE`
    - `CDM_SCHEMA`
    - `RESULTS_SCHEMA`

    In case these are not set, the algorithm execution is terminated.

    Example
    -------
    >>> get_ohdsi_metadata("my_database")
    """
    # check that all node environment variables are set
    expected_env_vars = ["CDM_DATABASE", "CDM_SCHEMA", "RESULTS_SCHEMA"]
    label_ = label.upper()
    for var in expected_env_vars:
        _check_environment_var_exists_or_exit(f'{label_}_DB_PARAM_{var}')

    tmp = Path(get_env_var("TEMPORARY_FOLDER"))
    metadata = OHDSIMetaData(
        database=get_env_var(f"{label_}_DB_PARAM_CDM_DATABASE"),
        cdm_schema=get_env_var(f"{label_}_DB_PARAM_CDM_SCHEMA"),
        results_schema=get_env_var(f"{label_}_DB_PARAM_RESULTS_SCHEMA"),
        incremental_folder=tmp / "incremental",
        cohort_statistics_folder=tmp / "cohort_statistics",
        export_folder=tmp / "export"
    )
    return metadata
