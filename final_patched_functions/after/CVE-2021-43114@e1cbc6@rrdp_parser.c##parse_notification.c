parse_notification(struct rpki_uri *uri, struct update_notification **file)
{
	struct update_notification *result;
	int error;

	result = update_notification_create(uri_get_global(uri));
	if (result == NULL)
		return pr_enomem();

	error = relax_ng_parse(uri_get_local(uri), xml_read_notification,
	    result);
	if (error) {
		update_notification_destroy(result);
		return error;
	}

	*file = result;
	return 0;
}
