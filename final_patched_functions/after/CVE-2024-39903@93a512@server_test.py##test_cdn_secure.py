def test_cdn_secure(solara_server, solara_app, extra_include_path):
    cdn_url = solara_server.base_url + "/_solara/cdn"
    assert solara.settings.assets.proxy

    with extra_include_path(HERE), solara_app("server_test:ClickButton"):
        url = cdn_url + "/vue-grid-layout@1.0.2/dist/vue-grid-layout.min.js"
        response = requests.get(url)
        assert response.status_code == 200
        # create a file in /share/solara
        test_file = settings.assets.proxy_cache_dir.parent / "not-allowed"
        test_file.write_text("test")
        url = cdn_url + "/..%2fnot-allowed"
        response = requests.get(url)
        assert response.status_code == 404
