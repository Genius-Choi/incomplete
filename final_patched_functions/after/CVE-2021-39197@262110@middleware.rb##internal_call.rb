    def internal_call(env, opts)
      return no_errors_json_response unless @error_page
      return invalid_error_json_response if opts[:id] != @error_page.id

      request = Rack::Request.new(env)
      return invalid_csrf_token_json_response unless request.cookies[CSRF_TOKEN_COOKIE_NAME]

      request.body.rewind
      body = JSON.parse(request.body.read)
      return invalid_csrf_token_json_response unless request.cookies[CSRF_TOKEN_COOKIE_NAME] == body['csrfToken']

      response = @error_page.send("do_#{opts[:method]}", body)
      [200, { "Content-Type" => "application/json; charset=utf-8" }, [JSON.dump(response)]]
    end
