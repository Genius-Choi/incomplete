  def update_by_ajax
    Log.add_info(request, params.inspect)

    return unless request.post?

    cat_h = {:desktop => User::AUTH_DESKTOP, :user => User::AUTH_USER, :log => User::AUTH_LOG}

    yaml = ApplicationHelper.get_config_yaml

    cat_h.keys.each do |cat|

      next if params[cat].blank?

      unless @login_user.admin?(cat_h[cat])
        render(:text => t('msg.need_to_be_admin'))
        return
      end

      yaml[cat] ||= {}

      params[cat].each do |key, val|
        yaml[cat][key] = val
      end
    end

    ApplicationHelper.save_config_yaml(yaml)

    render(:text => '')
  end
