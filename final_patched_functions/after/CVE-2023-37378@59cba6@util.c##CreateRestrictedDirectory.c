DWORD NSISCALL CreateRestrictedDirectory(LPCTSTR path)
{
  PSID admingrpsid = GetAdminGrpSid();
  SECURITY_DESCRIPTOR sd = { 1, 0, SE_DACL_PRESENT, admingrpsid, admingrpsid, NULL, GetAdminGrpAcl() };
  SECURITY_ATTRIBUTES sa = { sizeof(SECURITY_ATTRIBUTES), &sd, FALSE };
  return CreateDirectory(path, &sa) ? ERROR_SUCCESS : GetLastError();
}
