def test_request_smuggling_validation_disabled(tctx):
    """Test that we don't reject request smuggling when validation is disabled."""
    tctx.options.validate_inbound_headers = False
    assert (
        Playbook(http.HttpLayer(tctx, HTTPMode.regular), hooks=False)
        >> DataReceived(tctx.client, b"GET http://example.com/ HTTP/1.1\r\n"
                                     b"Host: example.com\r\n"
                                     b"Content-Length: 4\r\n"
                                     b"Transfer-Encoding: chunked\r\n\r\n"
                                     b"4\r\n"
                                     b"abcd\r\n"
                                     b"0\r\n"
                                     b"\r\n")
        << OpenConnection(Placeholder(Server))
    )
