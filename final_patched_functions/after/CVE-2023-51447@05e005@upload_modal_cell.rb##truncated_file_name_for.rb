    def truncated_file_name_for(attachment, max_length = 31)
      filename = determine_filename(attachment)
      return decidim_html_escape(filename).html_safe if filename.length <= max_length

      name = File.basename(filename, File.extname(filename))
      decidim_html_escape(name.truncate(max_length, omission: "...#{name.last((max_length / 2) - 3)}#{File.extname(filename)}")).html_safe
    end
