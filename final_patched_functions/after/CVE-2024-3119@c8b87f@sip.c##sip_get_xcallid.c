sip_get_xcallid(const char *payload, char *xcallid)
{
    regmatch_t pmatch[3];

    // Try to get X-Call-ID from payload
    if (regexec(&calls.reg_xcallid, (const char *)payload, 3, pmatch, 0) == 0) {
        int input_len = pmatch[2].rm_eo - pmatch[2].rm_so;

        // Ensure the copy length does not exceed MAX_XCALLID_SIZE - 1
        if (input_len > MAX_XCALLID_SIZE - 1) {
            input_len = MAX_XCALLID_SIZE - 1;
        }

        strncpy(xcallid, (const char *)payload +  pmatch[2].rm_so, input_len);
        xcallid[input_len] = '\0';
    }

    return xcallid;
}
