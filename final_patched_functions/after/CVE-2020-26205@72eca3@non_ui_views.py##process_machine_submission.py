def process_machine_submission(machine_submission, machine, object_queue):
    extra_data = machine_submission.get("extra_data", {})
    machine.hostname = extra_data.get("hostname", "<NO NAME>")
    # Drop the setup assistant user if encountered.
    console_user = extra_data.get("console_user")
    console_user = console_user if console_user != "_mbsetupuser" else None
    machine.console_user = console_user
    machine.os_family = extra_data.get("os_family", "Darwin")
    machine.operating_system = extra_data.get("operating_system")
    machine.hd_space = extra_data.get("hd_space")
    machine.hd_total = extra_data.get("hd_total")
    machine.hd_percent = extra_data.get("hd_percent")
    machine.machine_model = extra_data.get("machine_model")
    machine.machine_model_friendly = extra_data.get("machine_model_friendly")
    machine.cpu_type = extra_data.get("cpu_type")
    machine.cpu_speed = extra_data.get("cpu_speed")
    machine.memory = extra_data.get("memory")
    machine.memory_kb = extra_data.get("memory_kb", 0)
    machine.save()
    return object_queue
