def test__SecretFile_permissions_incorrect(secret_path):
    '''Incorrect permissions are fixed'''
    with open(secret_path, 'w') as fp:
        fp.write('{"existing": "exists"}')

    secret_path.chmod(0o666)

    auth._SecretFile(secret_path)
    assert secret_path.stat().st_mode & 0o777 == 0o600
