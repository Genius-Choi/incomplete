  def read_posts_set
    @read_posts_set ||=
      begin
        result = Set.new
        return result unless @user.present?
        return result unless topic_user.present?

        post_numbers =
          PostTiming
            .where(topic_id: @topic.id, user_id: @user.id)
            .where(post_number: @posts.pluck(:post_number))
            .pluck(:post_number)

        post_numbers.each { |pn| result << pn }
        result
      end
  end
