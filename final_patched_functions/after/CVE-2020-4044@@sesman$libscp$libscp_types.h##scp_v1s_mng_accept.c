scp_v1s_mng_accept(struct SCP_CONNECTION *c, struct SCP_SESSION **s)
{
    enum SCP_SERVER_STATES_E result;
    struct SCP_SESSION *session;

    session = scp_session_create();
    if (NULL == session)
    {
        result = SCP_SERVER_STATE_INTERNAL_ERR;
    }
    else
    {
        scp_session_set_type(session, SCP_SESSION_TYPE_MANAGE);

        result = scp_v1s_mng_init_session(c, session);
        if (result != SCP_SERVER_STATE_START_MANAGE)
        {
            scp_session_destroy(session);
            session = NULL;
        }
    }

    (*s) = session;

    return result;
}
