def credentials_checked_recently():
    minutes = settings().getInt(["accessControl", "defaultReauthenticationTimeout"])
    if not minutes:
        return True

    credentials_seen = flask.session.get("credentials_seen")
    now = datetime.now()

    try:
        if credentials_seen and datetime.fromtimestamp(
            credentials_seen
        ) > now - timedelta(minutes=minutes):
            # credentials seen less than the set minutes ago, proceed
            return True
    except Exception:
        logging.getLogger(__name__).exception("Error while checking for seen credentials")
        pass

    return False
