      def match?(name, ip)
        if ip?
          if pattern.include?(IPAddr.new(ip))
            Puppet.deprecation_warning "Authentication based on IP address is deprecated; please use certname-based rules instead"
            true
          else
            false
          end
        else
          matchname?(name)
        end
      end
