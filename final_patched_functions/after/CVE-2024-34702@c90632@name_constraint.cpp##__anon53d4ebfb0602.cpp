   auto is_excluded_dns_name = [&](const std::string& name) {
      if(name.empty() || name[0] == '.') {
         return true;
      }

      // If no restrictions, then immediate accept
      if(m_excluded_name_types.find("DNS") == m_excluded_name_types.end()) {
         return false;
      }

      for(const auto& c : m_excluded_subtrees) {
         if(c.base().type() == "DNS" && c.base().matches_dns(name)) {
            return true;
         }
      }

      // There is at least one excluded name and we didn't match
      return false;
   };
