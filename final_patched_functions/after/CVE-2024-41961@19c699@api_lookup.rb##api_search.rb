  def api_search(service_manager, object_type, term)
    service_name, methods = service_and_methods(object_type)

    # service = object_service(service_name)
    unless service_manager.respond_to?(service_name)
      raise StandardError, "Service #{service_name} could not be found."
    end
    service = service_manager.send(service_name)

    # encode term to a valid URL format
    term = URI.encode_www_form_component(term)

    methods.each do |m|
      params = Marshal.load(Marshal.dump(m[:params]))
      params.each do |inner_param|
        if inner_param.is_a?(Hash)
          inner_param.transform_values! { |value| value == ":term" ? term : value }
        elsif inner_param.is_a?(String) && inner_param == ":term"
          inner_param.replace(term)
        end
      end

      found_items = service.public_send(m[:method_name], *params)

      if found_items
        items =
          if found_items.is_a?(Hash)
            found_items[:items]
          elsif found_items.is_a?(Array)
            found_items
          else
            [found_items]
          end
        return { items: items, service_call: "#{service_name}->#{m[:method_name]}(#{params})" }
      end
    end

    { items: [], service_call: "" }
  end
