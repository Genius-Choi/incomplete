def search(request):
	context_dict = {}
	q = request.GET['q'].replace('%', '').replace('_', '').strip()
	if 'q' in request.GET and q != '':
		q = '%' + q + '%'
		cursor = connection.cursor()
		cursor.execute("SELECT id,title,artist,cover FROM recordstoreapp_record WHERE title like %s or artist like %s or label like %s or cat_no like %s;", [q,q,q,q])
		rec_list=cursor.fetchall()
		

		total=len(rec_list)
		pg=int(request.GET['page']) if 'page' in request.GET else 1
		ub=min(pg*12, total)

		context_dict['rec_list'] = rec_list[(pg-1)*12:ub]
		maxrange = int(total/12)
		if total%12 > 0: 
			maxrange = maxrange + 1
		if maxrange == 1: 
			maxrange = 0
		context_dict['range'] = range(1,maxrange+1)
		print total
		context_dict['q'] = q

	return render(request, 'search.html', context_dict)
