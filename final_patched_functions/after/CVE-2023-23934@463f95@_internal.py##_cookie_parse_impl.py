def _cookie_parse_impl(b: bytes) -> t.Iterator[t.Tuple[bytes, bytes]]:
    """Lowlevel cookie parsing facility that operates on bytes."""
    i = 0
    n = len(b)
    b += b";"

    while i < n:
        match = _cookie_re.match(b, i)

        if not match:
            break

        i = match.end(0)
        key = match.group("key").strip()

        if not key:
            continue

        value = match.group("val") or b""
        yield key, _cookie_unquote(value)
