def test_static_secure(solara_server, solara_app, extra_include_path):
    static_url = solara_server.base_url + "/static"
    static_directory = solara.server.server.solara_static

    with extra_include_path(HERE), solara_app("server_test:ClickButton"):
        url = static_url + "/main.js"
        response = requests.get(url)
        assert response.status_code == 200
        test_file = static_directory.parent / "__init__.py"
        assert test_file.exists()
        url = static_url + "/..%2f__init__.py"
        response = requests.get(url)
        assert response.status_code == 404

        url = static_url + "/foo/..%2f..%2f__init__.py"
        response = requests.get(url)
        assert response.status_code == 404
