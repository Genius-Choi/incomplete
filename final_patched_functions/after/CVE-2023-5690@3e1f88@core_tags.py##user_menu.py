def user_menu(request, selection):
    entries = [
        {"name": "user",
         "img": "fa fa-user",
         "label": request.user.fullname,
         "menu": [
                {"name": "settings",
                 "img": "fa fa-list",
                 "label": _("Settings"),
                 "url": reverse("core:user_index")}
         ]}
    ]

    extra_entries = signals.extra_user_menu_entries.send(
        sender="user_menu", location="options_menu", user=request.user)
    extra_entries = reduce(
        lambda a, b: a + b, [entry[1] for entry in extra_entries])
    entries[0]["menu"] += (
        extra_entries + [{
            "name": "logout",
            "url": reverse("core:logout"),
            "label": _("Logout"),
            "img": "fa fa-sign-out",
            "method": "post"
        }]
    )
    return render_to_string("common/menulist.html", {
        "request": request, "selection": selection,
        "entries": entries, "user": request.user
    })
