  def destroy
    Log.add_info(request, params.inspect)

    return unless request.post?

    if params[:check_user].nil?
      list
      render(:action => 'list')
      return
    end

    count = 0
    params[:check_user].each do |user_id, value|
      if value == '1'
        SqlHelper.validate_token([user_id])
        begin
          User.destroy(user_id)
        rescue => evar
          Log.add_error(request, evar)
        end

        count += 1
      end
    end
    flash[:notice] = count.to_s + t('user.deleted')
    redirect_to(:action => 'list')
  end
