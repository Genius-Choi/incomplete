def test_request_smuggling_whitespace(tctx):
    """Test that we reject header names with whitespace"""
    err = Placeholder(bytes)
    assert (
        Playbook(http.HttpLayer(tctx, HTTPMode.regular), hooks=False)
        >> DataReceived(tctx.client, b"GET http://example.com/ HTTP/1.1\r\n"
                                     b"Host: example.com\r\n"
                                     b"Content-Length : 42\r\n\r\n")
        << SendData(tctx.client, err)
        << CloseConnection(tctx.client)
    )
    assert b"Received an invalid header name" in err()
