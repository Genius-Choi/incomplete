def test_download_rhsm_pkgs(version, pkgs_to_download, monkeypatch):
    monkeypatch.setattr(system_info, "version", Version(*version))
    monkeypatch.setattr(subscription, "_download_rhsm_pkgs", DownloadRHSMPkgsMocked())
    monkeypatch.setattr(utils, "mkdir_p", DumbCallable())
    subscription.download_rhsm_pkgs()

    assert subscription._download_rhsm_pkgs.called == 1
    assert frozenset(subscription._download_rhsm_pkgs.pkgs_to_download) == pkgs_to_download
