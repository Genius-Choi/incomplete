def test_find_materialization_by_name(macros, adapter_type, expected):
    set_from_args(
        Namespace(
            SEND_ANONYMOUS_USAGE_STATS=False,
            REQUIRE_EXPLICIT_PACKAGE_OVERRIDES_FOR_BUILTIN_MATERIALIZATIONS=True,
        ),
        None,
    )

    manifest = make_manifest(macros=macros)
    result = manifest.find_materialization_macro_by_name(
        project_name="root",
        materialization_name="my_materialization",
        adapter_type=adapter_type,
    )
    if expected is None:
        assert result is expected
    else:
        expected_package, expected_adapter_type = expected
        assert result.adapter_type == expected_adapter_type
        assert result.package_name == expected_package
