PHP_FUNCTION(aws_crt_crc32c) {
    zend_ulong prev = 0;
    const char *input = NULL;
    size_t len = 0;

    aws_php_parse_parameters("sl", &input, &len, &prev);

    if (prev > UINT32_MAX) {
        aws_php_throw_exception("previous crc cannot be larger than UINT32_MAX");
    }
    RETURN_LONG((zend_ulong)aws_crt_crc32c((const uint8_t *)input, len, prev));
}
