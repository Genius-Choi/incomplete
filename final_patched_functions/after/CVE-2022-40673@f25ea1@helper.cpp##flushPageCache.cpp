QVariantMap Helper::flushPageCache()
{
    if (!isCallerAuthorized()) {
        return {};
    }

    QVariantMap reply;
    reply[QStringLiteral("success")] = true;

    if (!isCallerAuthorized()) {
        reply[QStringLiteral("success")] = false;
        return reply;
    }

    QFile file("/proc/sys/vm/drop_caches");

    if (file.open(QIODevice::WriteOnly | QIODevice::Text)) {
        file.write("1");
        file.close();
    }
    else {
        reply[QStringLiteral("success")] = false;
        reply[QStringLiteral("error")] = file.errorString();
    }

    return reply;
}
