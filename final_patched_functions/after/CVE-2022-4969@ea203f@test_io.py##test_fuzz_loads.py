def test_fuzz_loads(dtype, ldtype):
    """Scan for possible segfaults.

    All invalid inputs must lead to a ValueError rather than a seg-fault or
    RaggedArray.loads() could be tricked into reading arbitrary memory addresses
    by a maliciously constructed invalid data file.

    """
    @given(strategies.binary())
    @example(b'\xc0\\\\\xb0\x93\x91\xff\xffpEfe\x167\xee')
    def fuzz(x):
        print(x)
        try:
            self, _ = RaggedArray.loads(x, dtype=dtype, ldtype=ldtype)
        except ValueError:
            pass
        else:
            assert self.dumps(ldtype=ldtype).tobytes() == x

    fuzz()
