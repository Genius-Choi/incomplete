    def make_trusted_full_url(ref)
      return if ref.blank?

      full_url = make_full_url(URI::decode(ref))
      return if full_url.blank?

      # normalize full url
      full_url.fragment = nil
      full_url.query = nil

      # trusted?
      return unless trusted?(full_url)

      full_url.to_s
    end
