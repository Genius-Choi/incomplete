  def create
    Log.add_info(request, params.inspect)

    return unless request.post?

    my_wf_folder = WorkflowsHelper.get_my_wf_folder(@login_user.id)

    tmpl_item = Item.find(params[:select_workflow])

    item = tmpl_item.copy(@login_user.id, my_wf_folder.id)

    attrs = ActionController::Parameters.new({title: tmpl_item.title + t('msg.colon') + User.get_name(@login_user.id), public: false})
    item.update_attributes(attrs.permit(Item::PERMIT_BASE))

    item.workflow.update_attribute(:status, Workflow::STATUS_NOT_ISSUED)

    sql = WorkflowsHelper.get_list_sql(@login_user.id, my_wf_folder.id)
    @workflows = Workflow.find_by_sql(sql)

    render(:partial => 'ajax_workflow', :layout => false)

  rescue => evar
    Log.add_error(request, evar)
    render(:partial => 'ajax_workflow', :layout => false)
  end
