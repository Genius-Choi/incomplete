IListenSocket* TCPSocketFactory::createListen(IArchNetwork::EAddressFamily family,
                                              ConnectionSecurityLevel security_level) const
{
    IListenSocket* socket = NULL;
    if (security_level != ConnectionSecurityLevel::PLAINTEXT) {
        socket = new SecureListenSocket(m_events, m_socketMultiplexer, family, security_level);
    }
    else {
        socket = new TCPListenSocket(m_events, m_socketMultiplexer, family);
    }

    return socket;
}
