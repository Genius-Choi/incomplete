  def update_config
    Log.add_info(request, params.inspect)

    return unless request.post?

    @yaml = ApplicationHelper.get_config_yaml

    unless params[:desktop].blank?
      @yaml[:desktop] = Hash.new if @yaml[:desktop].nil?

      params[:desktop].each do |key, val|
        @yaml[:desktop][key] = val
      end
      ApplicationHelper.save_config_yaml(@yaml)
    end

    flash[:notice] = t('msg.update_success')
    render(:partial => 'ajax_user_before_login', :layout => false)
  end
