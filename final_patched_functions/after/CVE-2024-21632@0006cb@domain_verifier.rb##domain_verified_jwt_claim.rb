      def domain_verified_jwt_claim
        oidc_config = access_token.get(OIDC_CONFIG_URL).parsed
        algorithms = oidc_config['id_token_signing_alg_values_supported']
        keys = JWT::JWK::Set.new(access_token.get(oidc_config['jwks_uri']).parsed)
        decoded_token = JWT.decode(id_token, nil, true, algorithms: algorithms, jwks: keys)
        # https://github.com/MicrosoftDocs/azure-docs/issues/111425#issuecomment-1761043378
        # Comments seemed to indicate the value is not consistent
        ['1', 1, 'true', true].include?(decoded_token.first['xms_edov'])
      rescue JWT::VerificationError, ::OAuth2::Error
        false
      end
