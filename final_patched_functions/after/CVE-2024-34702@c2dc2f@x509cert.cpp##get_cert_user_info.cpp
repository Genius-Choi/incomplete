std::vector<std::string> get_cert_user_info(std::string_view req, const X509_DN& dn, const AlternativeName& alt_name) {
   auto set_to_vector = [](const std::set<std::string>& s) -> std::vector<std::string> { return {s.begin(), s.end()}; };

   if(dn.has_field(req)) {
      return dn.get_attribute(req);
   } else if(req == "RFC822" || req == "Email") {
      return set_to_vector(alt_name.email());
   } else if(req == "DNS") {
      return set_to_vector(alt_name.dns());
   } else if(req == "URI") {
      return set_to_vector(alt_name.uris());
   } else if(req == "IP") {
      std::vector<std::string> ip_str;
      for(uint32_t ipv4 : alt_name.ipv4_address()) {
         ip_str.push_back(ipv4_to_string(ipv4));
      }
      return ip_str;
   } else {
      return {};
   }
}
