bool GeneralName::matches_ip(const std::string& nam) const {
   uint32_t ip = string_to_ipv4(nam);
   std::vector<std::string> p = split_on(name(), '/');

   if(p.size() != 2) {
      throw Decoding_Error("failed to parse IPv4 address");
   }

   uint32_t net = string_to_ipv4(p.at(0));
   uint32_t mask = string_to_ipv4(p.at(1));

   return (ip & mask) == net;
}
