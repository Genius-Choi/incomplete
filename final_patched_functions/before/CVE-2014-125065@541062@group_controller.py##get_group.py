def get_group(db, group_name):
    groups_table = db.get_table('groups')
    group = groups_table.find(name=group_name)
    rows = [x for x in group]
    if not rows:
        return error(404, {'error': 'Not a valid group'})

    userids = ["'%s'" % x['userid'] for x in rows if x['userid']]
    users = db.query("SELECT * FROM users WHERE userid IN (%s) " % ','.join(userids))
    ret = {group_name: list(users) }
    return ret
