static int cjwt_sign_sha_hmac( cjwt_t *jwt, unsigned char **out, const EVP_MD *alg,
                               const char *in, int *out_len )
{
    unsigned char res[EVP_MAX_MD_SIZE];
    unsigned int res_len;
    cjwt_info( "string for signing : %s \n", in );
    HMAC( alg, jwt->header.key, jwt->header.key_len,
          ( const unsigned char * )in, strlen( in ), res, &res_len );
    unsigned char *resptr = ( unsigned char * )malloc( res_len + 1 );

    if( !resptr ) {
        return ENOMEM;
    }

    memcpy( resptr, res, res_len );
    resptr[res_len] = '\0';
    *out = resptr;
    *out_len = res_len;
    return 0;
}
