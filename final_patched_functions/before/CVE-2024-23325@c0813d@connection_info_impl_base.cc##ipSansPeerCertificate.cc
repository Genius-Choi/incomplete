absl::Span<const std::string> ConnectionInfoImplBase::ipSansPeerCertificate() const {
  if (!cached_ip_san_peer_certificate_.empty()) {
    return cached_ip_san_peer_certificate_;
  }

  bssl::UniquePtr<X509> cert(SSL_get_peer_certificate(ssl()));
  if (!cert) {
    ASSERT(cached_ip_san_peer_certificate_.empty());
    return cached_ip_san_peer_certificate_;
  }
  cached_ip_san_peer_certificate_ = Utility::getSubjectAltNames(*cert, GEN_IPADD);
  return cached_ip_san_peer_certificate_;
}
