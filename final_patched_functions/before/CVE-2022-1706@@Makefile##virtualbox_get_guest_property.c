int virtualbox_get_guest_property(char *name, void **value, size_t *size) {
	// clear any previous garbage in errno for error returns
	errno = 0;

	// open character device
	int _cleanup_close_ fd = open("/dev/vboxguest", O_RDWR | O_CLOEXEC);
	if (fd == -1) {
		return VERR_GENERAL_FAILURE;
	}

	// negotiate protocol version
	int ret = version_info(fd);
	if (ret != VINF_SUCCESS) {
		return ret;
	}

	// connect to property service
	uint32_t client_id;
	ret = connect(fd, &client_id);
	if (ret != VINF_SUCCESS) {
		return ret;
	}

	// get property
	ret = get_prop(fd, client_id, name, value, size);
	if (ret != VINF_SUCCESS) {
		disconnect(fd, client_id);
		return ret;
	}

	// disconnect
	ret = disconnect(fd, client_id);
	if (ret != VINF_SUCCESS) {
		// we could ignore the failure, but better to make sure bugs
		// are noticed
		free(*value);
		*value = NULL;
		return ret;
	}

	// for clarity, ensure the Go error return is nil
	errno = 0;
	return 0;
}
