static void test_uri_parser__validate(void)
{
    uri_parser_result_t ures;
    for (unsigned i = 0; i < ARRAY_SIZE(validate_uris); i++) {
        int res = uri_parser_process_string(&ures, validate_uris[i].uri);
        TEST_ASSERT_EQUAL_INT(validate_uris[i].full_uri,
               uri_parser_is_absolute_string(validate_uris[i].uri));
        TEST_ASSERT_EQUAL_INT(validate_uris[i].expected, res);
        if (res == 0) {
            VEC_CHECK(scheme, i, _failure_msg);
            VEC_CHECK(userinfo, i, _failure_msg);
            VEC_CHECK(host, i, _failure_msg);
            VEC_CHECK(ipv6addr, i, _failure_msg);
            VEC_CHECK(zoneid, i, _failure_msg);
            VEC_CHECK(port, i, _failure_msg);
            VEC_CHECK(path, i, _failure_msg);
            VEC_CHECK(query, i, _failure_msg);
        }
    }
}
