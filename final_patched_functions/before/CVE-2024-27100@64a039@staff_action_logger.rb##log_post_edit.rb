  def log_post_edit(post, opts = {})
    raise Discourse::InvalidParameters.new(:post) unless post && post.is_a?(Post)
    UserHistory.create!(
      params(opts).merge(
        action: UserHistory.actions[:post_edit],
        post_id: post.id,
        details: "#{opts[:old_raw]}\n\n---\n\n#{post.raw}",
      ),
    )
  end
