def test_request_smuggling_te_te(tctx):
    """Test that we reject transfer-encoding headers that are weird in some way"""
    err = Placeholder(bytes)
    assert (
        Playbook(http.HttpLayer(tctx, HTTPMode.regular), hooks=False)
        >> DataReceived(tctx.client, ("GET http://example.com/ HTTP/1.1\r\n"
                                      "Host: example.com\r\n"
                                      "Transfer-Encoding: chunKed\r\n\r\n").encode())  # note the non-standard "K"
        << SendData(tctx.client, err)
        << CloseConnection(tctx.client)
    )
    assert b"Invalid transfer encoding" in err()
