def _handle_rsa_enc_dec_error(backend, key):
    errors = backend._consume_errors_with_text()
    if isinstance(key, _RSAPublicKey):
        raise ValueError(
            "Data too long for key size. Encrypt less data or use a "
            "larger key size.",
            errors,
        )
    else:
        raise ValueError("Decryption failed.", errors)
