      def verify(jwt, authorize_params = {})
        if !jwt
          raise OmniAuth::Auth0::TokenValidationError.new('ID token is required but missing')
        end

        parts = jwt.split('.')
        if parts.length != 3
          raise OmniAuth::Auth0::TokenValidationError.new('ID token could not be decoded')
        end

        key, alg = verify_signature(jwt)
        id_token, header = JWT.decode(jwt, key, false)
        verify_claims(id_token, authorize_params)

        return id_token
      end
