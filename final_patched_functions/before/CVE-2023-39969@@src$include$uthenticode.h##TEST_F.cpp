TEST_F(Auth32PlusTest, calculate_checksum) {
  auto unk = uthenticode::calculate_checksum(pe, uthenticode::checksum_kind::UNKNOWN);
  EXPECT_TRUE(unk.empty());

  auto md5 = uthenticode::calculate_checksum(pe, uthenticode::checksum_kind::MD5);
  EXPECT_EQ(md5.size(), 32);
  EXPECT_STRCASEEQ(md5.c_str(), "ea0235b77d552633c5a38974cef0e2b5");

  auto sha1 = uthenticode::calculate_checksum(pe, uthenticode::checksum_kind::SHA1);
  EXPECT_EQ(sha1.size(), 40);
  EXPECT_STRCASEEQ(sha1.c_str(), "2559e91a60953a5e16f9650f5f88953a2cca5425");

  auto sha256 = uthenticode::calculate_checksum(pe, uthenticode::checksum_kind::SHA256);
  EXPECT_EQ(sha256.size(), 64);
  EXPECT_STRCASEEQ(sha256.c_str(),
                   "5c823491c5991914aec971d9456d93d6cf2b8ee7e0ed7abc0b77031d8ec073c0");
}
