avp_find(struct l2tp_avp *avp, const u_char *pkt, int pktlen,
    uint16_t vendor_id, uint16_t attr_type, int fill_data)
{
	int avpsz;

	while (pktlen >= 6 &&
	    (avpsz = avp_enum(avp, pkt, pktlen, fill_data)) > 0) {
		if (avp->vendor_id != vendor_id || avp->attr_type != attr_type) {
			if (avpsz < 6)
				return NULL;
			pkt += avpsz;
			pktlen -= avpsz;
			continue;
		}
		return avp;
	}

	return NULL;
}
