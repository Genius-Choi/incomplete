    def shutdown_handler(*_):
        logger.info("TERM Signal received, shutting down...")
        logger.debug("Stopping revocation notifier...")
        revocation_process.terminate()
        logger.debug("Shutting down HTTP server...")
        server.shutdown()
        server.server_close()
        serverthread.join()
        logger.debug("...HTTP server stopped")
        revocation_process.join()
        logger.debug("... revocation notifier stopped")
        instance_tpm.flush_keys()
        logger.debug("Flushed keys successfully")
        sys.exit(0)
