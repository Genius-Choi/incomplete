  def add_holidays
    Log.add_info(request, params.inspect)

    holidays = params[:thetisBoxEdit]
    unless holidays.nil?
      holidays.split("\n").each do |holiday|
        tokens = holiday.split(',')
        date = DateTime.parse(tokens.shift.strip)
        date += date.offset   # 2011-01-01 09:00:00 +0900 (==> 2011-01-01 00:00:00 UTC)
        name = tokens.join(',').strip

        schedule = Schedule.new
        schedule.xtype = Schedule::XTYPE_HOLIDAY
        schedule.scope = Schedule::SCOPE_ALL
        schedule.title = name
        schedule.start = date
        schedule.end = date
        schedule.allday = true
        schedule.save!
      end
    end

    @holidays = Schedule.get_holidays
    render(:partial => 'config_holidays', :layout => false)

  rescue => evar
    Log.add_error(request, evar)
    flash[:notice] = 'ERROR:' + t('msg.format_invalid')

    @holidays = Schedule.get_holidays
    render(:partial => 'config_holidays', :layout => false)
  end
