async def check_token_expired(request: Request):
    now = int(time.time()) + 10
    auth = request.headers.get('authorization')

    if not auth:
        raise HTTPException(status_code=401, detail="Authorization header missing.")

    user_assertion=auth.split(' ')[1]

    try:
        decoded = jwt.decode(user_assertion, options={"verify_signature": False})
    except:
        raise HTTPException(status_code=401, detail="Authorization token missing or invalid in header.")

    if(now >= int(decoded['exp'])):
        raise HTTPException(status_code=401, detail="Token has expired.")

    request.state.tenant_id = decoded['tid']

    await check_admin(request, decoded['oid'], decoded['tid'])
