  def make_previous_post_the_last_one
    last_post = Post.where("topic_id = ? and id <> ?", @post.topic_id, @post.id)
      .select(:created_at, :user_id, :post_number)
      .where("topic_id = ? and id <> ?", @post.topic_id, @post.id)
      .where.not(user_id: nil)
      .order('created_at desc')
      .limit(1)
      .first

    if last_post.present?
      topic = @post.topic
      topic.last_posted_at = last_post.created_at
      topic.last_post_user_id = last_post.user_id
      topic.highest_post_number = last_post.post_number

      # we go via save here cause we need to run hooks
      topic.save!(validate: false)
    end
  end
