auto create_alt_name_ext(const X509_Cert_Options& opts, Extensions& extensions) {
   AlternativeName subject_alt;

   /*
   If the extension was already created in opts.extension we need to
   merge the values provied in opts with the values set in the extension.
   */
   if(auto ext = extensions.get_extension_object_as<Cert_Extension::Subject_Alternative_Name>()) {
      subject_alt = ext->get_alt_name();
   }

   subject_alt.add_attribute("DNS", opts.dns);
   subject_alt.add_attribute("URI", opts.uri);
   subject_alt.add_attribute("RFC822", opts.email);
   subject_alt.add_attribute("IP", opts.ip);
   subject_alt.add_othername(OID::from_string("PKIX.XMPPAddr"), opts.xmpp, ASN1_Type::Utf8String);

   for(const auto& dns : opts.more_dns) {
      subject_alt.add_attribute("DNS", dns);
   }

   return std::make_unique<Cert_Extension::Subject_Alternative_Name>(subject_alt);
}
