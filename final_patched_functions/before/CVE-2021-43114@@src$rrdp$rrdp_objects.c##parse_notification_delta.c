parse_notification_delta(xmlTextReaderPtr reader,
    struct rdr_notification_ctx *ctx)
{
	struct delta_head *tmp;
	unsigned long serial;
	int error;

	error = delta_head_create(&tmp);
	if (error)
		return error;

	error = parse_long(reader, RRDP_ATTR_SERIAL, &serial);
	if (error)
		goto delta_destroy;
	tmp->serial = serial;

	error = parse_doc_data(reader, true, true, &tmp->doc_data);
	if (error)
		goto delta_destroy;

	error = deltas_parsed_add(&ctx->deltas, &tmp);
	if (error)
		goto delta_destroy;

	return 0;
delta_destroy:
	delta_head_destroy(tmp);
	return error;
}
