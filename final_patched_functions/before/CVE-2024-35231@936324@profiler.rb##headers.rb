      def headers(printer, env, mode)
        headers = { 'content-type' => CONTENT_TYPES[printer.name] }
        if printer == ::RubyProf::CallTreePrinter
          filename = ::File.basename(env['PATH_INFO'])
          headers['content-disposition'] =
            %(attachment; filename="#{filename}.#{mode}.tree")
        end
        headers
      end
