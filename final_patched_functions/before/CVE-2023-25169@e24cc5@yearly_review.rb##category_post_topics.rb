    def category_post_topics(cat_id, start_date, end_date)
      data = {}

      most_read = ranked_topics(cat_id, start_date, end_date, most_read_topic_sql)
      most_liked = ranked_topics(cat_id, start_date, end_date, most_liked_topic_sql)
      most_replied_to = ranked_topics(cat_id, start_date, end_date, most_replied_to_topic_sql)
      most_popular = ranked_topics(cat_id, start_date, end_date, most_popular_topic_sql)
      most_bookmarked = ranked_topics(cat_id, start_date, end_date, most_bookmarked_topic_sql)

      category_topics = {}
      category_topics[:most_read] = most_read if most_read.any?
      category_topics[:most_liked] = most_liked if most_liked.any?
      category_topics[:most_replied_to] = most_replied_to if most_replied_to.any?
      category_topics[:most_popular] = most_popular if most_popular.any?
      category_topics[:most_bookmarked] = most_bookmarked if most_bookmarked.any?
      if category_topics.any?
        category_name = Category.find(cat_id).name
        data[:category_name] = category_name
        data[:topics] = category_topics
      end

      data
    end
