def group_images(
    input_folder,
    output_folder,
    group_size,
    include_subfolders,
    do_not_copy_other_files,
    generate_captions,
    caption_ext,
):
    if input_folder == "":
        msgbox("Input folder is missing...")
        return

    if output_folder == "":
        msgbox("Please provide an output folder.")
        return

    log.info(f"Grouping images in {input_folder}...")

    run_cmd = rf'"{PYTHON}" "{scriptdir}/tools/group_images.py"'
    run_cmd += f' "{input_folder}"'
    run_cmd += f' "{output_folder}"'
    run_cmd += f" {(group_size)}"
    if include_subfolders:
        run_cmd += f" --include_subfolders"
    if do_not_copy_other_files:
        run_cmd += f" --do_not_copy_other_files"
    if generate_captions:
        run_cmd += f" --caption"
        if caption_ext:
            run_cmd += f" --caption_ext={caption_ext}"

    log.info(run_cmd)

    env = os.environ.copy()
    env["PYTHONPATH"] = (
        rf"{scriptdir}{os.pathsep}{scriptdir}/sd-scripts{os.pathsep}{env.get('PYTHONPATH', '')}"
    )

    # Run the command
    subprocess.run(run_cmd, shell=True, env=env)

    log.info("...grouping done")
