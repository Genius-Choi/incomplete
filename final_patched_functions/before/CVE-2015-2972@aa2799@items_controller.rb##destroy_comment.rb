  def destroy_comment
    Log.add_info(request, params.inspect)

    comment = Comment.find(params[:comment_id])
    @item = comment.item

    unless @login_user.admin?(User::AUTH_ITEM) or \
              comment.user_id == @login_user.id or \
              @item.user_id == @login_user.id
      render(:text => 'ERROR:' + t('msg.need_to_be_admin'))
      return
    end

    comment.destroy

    case @item.xtype
      when Item::XTYPE_PROJECT
        if comment.xtype == Comment::XTYPE_APPLY

          flash[:notice] = t('msg.cancel_success')
          render(:partial => 'ajax_team_apply')

        else
          render(:text => '')
        end

      else
        render(:text => '')
    end
  end
