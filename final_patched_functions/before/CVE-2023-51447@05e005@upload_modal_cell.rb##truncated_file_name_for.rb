    def truncated_file_name_for(attachment, max_length = 31)
      filename = file_name_for(attachment)
      return filename if filename.length <= max_length

      name = File.basename(filename, File.extname(filename))
      name.truncate(max_length, omission: "...#{name.last((max_length / 2) - 3)}#{File.extname(filename)}")
    end
