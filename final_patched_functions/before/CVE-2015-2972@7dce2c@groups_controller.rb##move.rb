  def move
    Log.add_info(request, params.inspect)

    @group = Group.find(params[:id])

    unless params[:thetisBoxSelKeeper].blank?

      parent_id = params[:thetisBoxSelKeeper].split(':').last

      childs = @group.get_childs(true, false)
      if childs.include?(parent_id) or (@group.id == parent_id.to_i)
        flash[:notice] = 'ERROR:' + t('group.cannot_be_parent')
        redirect_to(:action => 'show_tree')
        return
      end

      @group.parent_id = parent_id
      @group.xorder = nil
      @group.save
    end
    redirect_to(:action => 'show_tree')

  rescue => evar
    Log.add_error(request, evar)
    redirect_to(:action => 'show_tree')
  end
