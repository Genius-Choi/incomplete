  def exclude_from_group
    Log.add_info(request, params.inspect)

    if params[:group_id].nil? or params[:group_id].empty?
      render(:partial => 'ajax_groups', :layout => false)
      return
    end

    group_id = params[:group_id]

    begin
      @user = User.find(params[:id])
      unless @user.nil?
        if @user.exclude_from(group_id)
          @user.save

          if @user.id == @login_user.id
            @login_user = @user
          end
        end
      end
    rescue => evar
      Log.add_error(request, evar)
    end

    render(:partial => 'ajax_groups', :layout => false)
  end
