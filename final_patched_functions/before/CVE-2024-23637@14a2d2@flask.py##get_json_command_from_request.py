def get_json_command_from_request(request, valid_commands):
    data = request.get_json()

    if "command" not in data or data["command"] not in valid_commands:
        flask.abort(400, description="command is invalid")

    command = data["command"]
    if any(map(lambda x: x not in data, valid_commands[command])):
        flask.abort(400, description="Mandatory parameters missing")

    return command, data, None
