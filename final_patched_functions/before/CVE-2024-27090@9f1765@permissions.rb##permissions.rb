      def permissions
        user_can_enter_space_area?

        return permission_action if assembly && !assembly.is_a?(Decidim::Assembly)

        if read_admin_dashboard_action?
          user_can_read_admin_dashboard?
          return permission_action
        end

        if permission_action.scope == :public
          public_list_assemblies_action?
          public_read_assembly_action?
          public_list_members_action?
          return permission_action
        end

        return permission_action unless user

        if !has_manageable_assemblies? && !user.admin?
          disallow!
          return permission_action
        end
        return permission_action unless permission_action.scope == :admin

        user_can_read_assembly_list?
        user_can_list_assembly_list?
        user_can_read_current_assembly?
        user_can_create_assembly?
        user_can_export_assembly?
        user_can_copy_assembly?
        user_can_read_assemblies_setting?

        # org admins and space admins can do everything in the admin section
        org_admin_action?
        assemblies_type_action?

        return permission_action unless assembly

        moderator_action?
        collaborator_action?
        valuator_action?
        assembly_admin_action?

        permission_action
      end
