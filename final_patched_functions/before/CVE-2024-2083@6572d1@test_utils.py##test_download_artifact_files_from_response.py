def test_download_artifact_files_from_response(
    tmp_path, clean_client_with_run
):
    """Test that we can download artifact files from an artifact version."""
    artifact: ArtifactResponse = clean_client_with_run.get_artifact(
        name_id_or_prefix="connected_two_step_pipeline::step_1::output"
    )
    artifact_version_id = list(artifact.versions.values())[0].id
    av = clean_client_with_run.get_artifact_version(artifact_version_id)
    # create temporary path ending in .zip

    zipfile_path = os.path.join(tmp_path, "some_file.zip")
    av.download_files(path=zipfile_path)
    assert os.path.exists(zipfile_path)

    # unzip the file at zipfile_path
    with zipfile.ZipFile(zipfile_path, "r") as zip_ref:
        zip_ref.extractall(tmp_path)
    with open(os.path.join(tmp_path, "data.json"), "r") as f:
        assert f.read() == "7"

    # clean up
    shutil.rmtree(tmp_path)
