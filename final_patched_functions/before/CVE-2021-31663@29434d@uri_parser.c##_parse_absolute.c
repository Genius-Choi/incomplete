static int _parse_absolute(uri_parser_result_t *result, char *uri,
                           char *uri_end)
{
    bool has_authority;

    uri = _consume_scheme(result, uri, uri_end, &has_authority);
    if (uri == NULL) {
        return -1;
    }

    if (has_authority) {
        uri = _consume_authority(result, uri, uri_end);
        if (uri == NULL) {
            return -1;
        }
    }

    /* parsing the path, starting with '/' */
    return _parse_relative(result, uri, uri_end);
}
