scrypt_SHA256_Final(unsigned char digest[32], struct SHA256_CTX * ctx)
{

  /* Add padding */
  SHA256_Pad(ctx);

  /* Write the hash */
  be32enc_vect(digest, ctx->state, 32);

  /* Clear the context state */
  memset((void *)ctx, 0, sizeof(*ctx));
}
