        def test_with_default_entity
          xml = <<EOF
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE member [
  <!ENTITY a "a">
  <!ENTITY a2 "&a; &a;">
]>
<member>
&a;
&a2;
&lt;
</member>
EOF

          REXML::Security.entity_expansion_limit = 4
          doc = REXML::Document.new(xml)
          assert_equal("\na\na a\n<\n", doc.root.children.first.value)
          REXML::Security.entity_expansion_limit = 3
          doc = REXML::Document.new(xml)
          assert_raise(RuntimeError) do
            doc.root.children.first.value
          end
        end
