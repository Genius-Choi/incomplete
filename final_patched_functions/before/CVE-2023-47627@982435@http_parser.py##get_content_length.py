                        def get_content_length() -> Optional[int]:
                            # payload length
                            length_hdr = msg.headers.get(CONTENT_LENGTH)
                            if length_hdr is None:
                                return None

                            try:
                                length = int(length_hdr)
                            except ValueError:
                                raise InvalidHeader(CONTENT_LENGTH)

                            if length < 0:
                                raise InvalidHeader(CONTENT_LENGTH)

                            return length
