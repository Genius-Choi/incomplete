def change_password_for_user(username):
    if not userManager.enabled:
        return jsonify(SUCCESS)

    if (
        current_user is not None
        and not current_user.is_anonymous
        and (current_user.get_name() == username or current_user.is_admin)
    ):
        if "application/json" not in request.headers["Content-Type"]:
            abort(400, description="Expected content-type JSON")

        data = request.get_json()

        if data is None:
            abort(400, description="Malformed JSON body in request")

        if "password" not in data or not data["password"]:
            abort(400, description="password is missing")

        try:
            userManager.change_user_password(username, data["password"])
        except users.UnknownUser:
            abort(404)

        return jsonify(SUCCESS)
    else:
        abort(403)
