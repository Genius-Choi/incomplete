        def test_parser_context_yielded_io
          doc = Doc.new
          parser = XML::SAX::Parser.new(doc)
          xml = "<foo a='&amp;b'/>"

          block_called = false
          parser.parse(StringIO.new(xml)) do |ctx|
            block_called = true
            ctx.replace_entities = true
          end

          assert(block_called)

          assert_equal([["foo", [["a", "&b"]]]], doc.start_elements)
        end
