def process_facts(management_source, management_data, machine, object_queue):
    now = django.utils.timezone.now()
    for fact_name, fact_data in management_data.get('facts', {}).items():
        if IGNORE_PREFIXES and IGNORE_PREFIXES.match(fact_name):
            continue

        object_queue['facts'].append(
            Fact(
                machine=machine, fact_data=fact_data, fact_name=fact_name,
                management_source=management_source))

        if fact_name in HISTORICAL_FACTS:
            object_queue['historical_facts'].append(
                HistoricalFact(
                    machine=machine, fact_data=fact_data, fact_name=fact_name,
                    management_source=management_source, fact_recorded=now))

    return object_queue
