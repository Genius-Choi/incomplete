void AuthChecker::PassUserInfoOnSuccess() {
  char *json_buf = auth::WriteUserInfoToJson(user_info_);
  if (json_buf == nullptr) {
    return;
  }
  char *base64_json_buf = auth::esp_base64_encode(
      json_buf, strlen(json_buf), true, false, true /*padding*/);
  context_->request()->AddHeaderToBackend(auth::kEndpointApiUserInfo,
                                          base64_json_buf);
  auth::esp_grpc_free(json_buf);
  auth::esp_grpc_free(base64_json_buf);

  TRACE(trace_span_) << "Authenticated.";
  trace_span_.reset();
  on_done_(Status::OK);
}
