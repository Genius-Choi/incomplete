  def _process_user_attrs(user, attrs)

    if attrs[:birthday].nil?
      begin
        attrs[:birthday] = attrs[:birthday_y] + '-' + attrs[:birthday_m] + '-' + attrs[:birthday_d]
      rescue
      end
      attrs.delete(:birthday_y)
      attrs.delete(:birthday_m)
      attrs.delete(:birthday_d)
    end

    if !attrs[:name].nil? or !attrs[:password].nil?
      user_name = attrs[:name]
      user_name ||= user.name unless user.nil?
      password = attrs[:password]
      if password.nil? or password.empty?
        password = UsersHelper.generate_password
        attrs[:password] = password
      end
      attrs[:pass_md5] = UsersHelper.generate_digest_pass(user_name, password)
    end
    return attrs
  end
