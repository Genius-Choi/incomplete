def _create_omop_database_connection(label: str) -> callable:
    """
    Create a connection to an OMOP database.

    It expects that the following environment variables are set:
    - DB_PARAM_DBMS: type of database to connect to
    - DB_PARAM_USER: username to connect to the database
    - DB_PARAM_PASSWORD: password to connect to the database

    These should be provided in the vantage6 node configuration file in the
    `database` section without the `DB_PARAM_` prefix. For example:

    ```yaml
    ...
    databases:
      - label: my_database
        type: OMOP
        uri: jdbc:postgresql://host.docker.internal:5454/postgres
        env:
            DBMS: "postgresql"
            USER: "my_user"
            PASSWORD: "my_password"
    ...
    ```

    Parameters
    ----------
    label : str
        Label of the database to connect to

    Returns
    -------
    callable
        OHDSI Database Connection object
    """

    # check that the OHDSI package is available in this container
    if not OHDSI_AVAILABLE:
        error("OHDSI/DatabaseConnector is not available.")
        error("Did you use 'algorithm-ohdsi-base' image to build this "
              "algorithm?")
        exit(1)

    # environment vars are always uppercase
    label_ = label.upper()

    # check that the required environment variables are set
    for var in ("DBMS", "USER", "PASSWORD"):
        _check_environment_var_exists_or_exit(f'{label_}_DB_PARAM_{var}')

    info("Reading OHDSI environment variables")
    dbms = os.environ[f"{label_}_DB_PARAM_DBMS"]
    uri = os.environ[f"{label_}_DATABASE_URI"]
    user = os.environ[f"{label_}_DB_PARAM_USER"]
    password = os.environ[f"{label_}_DB_PARAM_PASSWORD"]
    info(f' - dbms: {dbms}')
    info(f' - uri: {uri}')
    info(f' - user: {user}')

    info("Creating OHDSI database connection")
    return connect_to_omop(dbms=dbms, connection_string=uri, password=password,
                           user=user)
