def download_and_extract(url, path):
    """Download and extract a tar file.

    :param url: The url of the tar file.
    :param path: The path to the file to download to.
    """
    if not os.path.exists(path):
        os.makedirs(path)
    if not os.listdir(path):
        with tmpdir() as tmp:
            tmp_file = os.path.join(tmp, "tar_file")
            if url.startswith("s3://"):
                s3_download(url, tmp_file)
                with tarfile.open(name=tmp_file, mode="r:gz") as t:
                    t.extractall(path=path)
            elif url.startswith("http://") or url.startswith("https://"):
                with urlopen(url) as response, open(tmp_file, 'wb') as f:
                    shutil.copyfileobj(response, f)
                with tarfile.open(name=tmp_file, mode="r:gz") as t:
                    t.extractall(path=path)
