def gql_injected_client():
    opa_host = "http://localhost:8181"
    oidc_auth = AuthenticationDummy()
    injectable = GraphQLInjectable("gql_injectable")
    opa_config = OPAConfig(
        authentication=oidc_auth, opa_host=opa_host, injectables=[injectable]
    )

    app = FastAPI()
    app.add_middleware(OPAMiddleware, config=opa_config)

    @app.post("/")
    @pytest.mark.asyncio
    async def root() -> Dict:
        return {"msg": "success"}

    yield TestClient(app)
