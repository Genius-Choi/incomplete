diff --git a/app/webroot/theme/admin-third/Elements/admin/uploader_files/index_list.php b/app/webroot/theme/admin-third/Elements/admin/uploader_files/index_list.php
index 9d34abc926..1bb5ee861c 100755
--- a/app/webroot/theme/admin-third/Elements/admin/uploader_files/index_list.php
+++ b/app/webroot/theme/admin-third/Elements/admin/uploader_files/index_list.php
@@ -36,7 +36,7 @@
 					<?php if ($uploaderCategories): ?>
 						<?php echo $this->BcForm->input('UploaderFile.uploader_category_id', ['type' => 'select', 'options' => $uploaderCategories, 'empty' => __d('baser', 'カテゴリ指定なし'), 'id' => 'UploaderFileUploaderCategoryId' . $listId, 'style' => 'width:100px']) ?>&nbsp;
 					<?php endif ?>
-					<span id="SpanUploadFile<?php echo $listId ?>">
+					<span id="SpanUploadFile<?php echo h($listId) ?>">
 			<?php echo $this->BcForm->input('UploaderFile.file', ['type' => 'file', 'id' => 'UploaderFileFile' . $listId, 'class' => 'uploader-file-file', 'div' => false]) ?>
 		</span>
 				</div>
@@ -58,7 +58,7 @@
 						<?php if ($uploaderCategories): ?>
 							<?php echo $this->BcForm->input('UploaderFile.uploader_category_id', ['type' => 'select', 'options' => $uploaderCategories, 'empty' => __d('baser', 'カテゴリ指定なし'), 'id' => 'UploaderFileUploaderCategoryId' . $listId]) ?>
 						<?php endif ?>
-						<span id="SpanUploadFile<?php echo $listId ?>">
+						<span id="SpanUploadFile<?php echo h($listId) ?>">
 					<?php echo $this->BcForm->input('UploaderFile.file', ['type' => 'file', 'id' => 'UploaderFileFile' . $listId, 'class' => 'uploader-file-file', 'div' => false]) ?>
 				</span>
 					</div>
diff --git a/app/webroot/theme/admin-third/Elements/admin/uploader_files/index_panel.php b/app/webroot/theme/admin-third/Elements/admin/uploader_files/index_panel.php
index 7f6c1cf2d6..eaee51bfd4 100755
--- a/app/webroot/theme/admin-third/Elements/admin/uploader_files/index_panel.php
+++ b/app/webroot/theme/admin-third/Elements/admin/uploader_files/index_panel.php
@@ -33,7 +33,7 @@
 					<?php if ($uploaderCategories): ?>
 						<?php echo $this->BcForm->input('UploaderFile.uploader_category_id', ['type' => 'select', 'options' => $uploaderCategories, 'empty' => __d('baser', 'カテゴリ指定なし'), 'id' => 'UploaderFileUploaderCategoryId' . $listId]) ?>&nbsp;
 					<?php endif ?>
-					<span id="SpanUploadFile<?php echo $listId ?>">
+					<span id="SpanUploadFile<?php echo h($listId) ?>">
 				<?php echo $this->BcForm->input('UploaderFile.file', ['type' => 'file', 'id' => 'UploaderFileFile' . $listId, 'class' => 'uploader-file-file', 'div' => false]) ?>
 			</span>
 				</div>
diff --git a/app/webroot/theme/admin-third/FeedConfigs/admin/preview.php b/app/webroot/theme/admin-third/FeedConfigs/admin/preview.php
index 2b3ae5f95b..06c5499d46 100755
--- a/app/webroot/theme/admin-third/FeedConfigs/admin/preview.php
+++ b/app/webroot/theme/admin-third/FeedConfigs/admin/preview.php
@@ -15,4 +15,4 @@
  */
 ?>
 <h2><?php echo h($feedConfig['FeedConfig']['name']); ?></h2>
-<?php echo $this->BcBaser->js('/feed/ajax/' . $id) ?>
+<?php echo $this->BcBaser->js('/feed/ajax/' . h($id)) ?>
diff --git a/lib/Baser/Plugin/Feed/View/FeedConfigs/admin/preview.php b/lib/Baser/Plugin/Feed/View/FeedConfigs/admin/preview.php
index bb8ba2b02a..b486c19df6 100755
--- a/lib/Baser/Plugin/Feed/View/FeedConfigs/admin/preview.php
+++ b/lib/Baser/Plugin/Feed/View/FeedConfigs/admin/preview.php
@@ -15,4 +15,4 @@
  */
 ?>
 <h2><?php $this->BcBaser->contentsTitle() ?></h2>
-<?php echo $this->BcBaser->js('/feed/ajax/' . $id) ?>
+<?php echo $this->BcBaser->js('/feed/ajax/' . h($id)) ?>
diff --git a/lib/Baser/Plugin/Mail/View/Helper/MaildataHelper.php b/lib/Baser/Plugin/Mail/View/Helper/MaildataHelper.php
index a60dcb5908..f6443b13c6 100755
--- a/lib/Baser/Plugin/Mail/View/Helper/MaildataHelper.php
+++ b/lib/Baser/Plugin/Mail/View/Helper/MaildataHelper.php
@@ -95,7 +95,7 @@ public function toDisplayString($type, $value, $prefixSpace = true)
 						$this->BcBaser->getImg($link, ['width' => 400]), $link, ['target' => '_blank']
 					);
 				} else {
-					$result = $this->BcBaser->getLink($file, $link);
+					$result = $this->BcBaser->getLink($file, $link, ['escape' => true]);
 				}
 				break;
 
diff --git a/lib/Baser/Plugin/Uploader/View/Elements/admin/uploader_files/index_list.php b/lib/Baser/Plugin/Uploader/View/Elements/admin/uploader_files/index_list.php
index 09dcf0c2cb..07d6823277 100755
--- a/lib/Baser/Plugin/Uploader/View/Elements/admin/uploader_files/index_list.php
+++ b/lib/Baser/Plugin/Uploader/View/Elements/admin/uploader_files/index_list.php
@@ -33,7 +33,7 @@
 					<?php if ($uploaderCategories): ?>
 						<?php echo $this->BcForm->input('UploaderFile.uploader_category_id', ['type' => 'select', 'options' => $uploaderCategories, 'empty' => __d('baser', 'カテゴリ指定なし'), 'id' => 'UploaderFileUploaderCategoryId' . $listId, 'style' => 'width:100px']) ?>&nbsp;
 					<?php endif ?>
-					<span id="SpanUploadFile<?php echo $listId ?>">
+					<span id="SpanUploadFile<?php echo h($listId) ?>">
 			<?php echo $this->BcForm->input('UploaderFile.file', ['type' => 'file', 'id' => 'UploaderFileFile' . $listId, 'class' => 'uploader-file-file', 'div' => false]) ?>
 		</span>
 				</div>
diff --git a/lib/Baser/Plugin/Uploader/View/Elements/admin/uploader_files/index_panel.php b/lib/Baser/Plugin/Uploader/View/Elements/admin/uploader_files/index_panel.php
index a5dd3ac494..d782388aa3 100755
--- a/lib/Baser/Plugin/Uploader/View/Elements/admin/uploader_files/index_panel.php
+++ b/lib/Baser/Plugin/Uploader/View/Elements/admin/uploader_files/index_panel.php
@@ -33,7 +33,7 @@
 				<?php if ($uploaderCategories): ?>
 					<?php echo $this->BcForm->input('UploaderFile.uploader_category_id', ['type' => 'select', 'options' => $uploaderCategories, 'empty' => __d('baser', 'カテゴリ指定なし'), 'id' => 'UploaderFileUploaderCategoryId' . $listId]) ?>&nbsp;
 				<?php endif ?>
-				<span id="SpanUploadFile<?php echo $listId ?>">
+				<span id="SpanUploadFile<?php echo h($listId) ?>">
 			<?php echo $this->BcForm->input('UploaderFile.file', ['type' => 'file', 'id' => 'UploaderFileFile' . $listId, 'class' => 'uploader-file-file', 'div' => false]) ?>
 		</span>
 			</div>
diff --git a/lib/Baser/View/Helper/BcUploadHelper.php b/lib/Baser/View/Helper/BcUploadHelper.php
index 35b9428e42..2115899409 100755
--- a/lib/Baser/View/Helper/BcUploadHelper.php
+++ b/lib/Baser/View/Helper/BcUploadHelper.php
@@ -141,7 +141,7 @@ public function fileLink($fieldName, $options = [])
 					if (is_array($options['link'])) {
 						$linkOptions = array_merge($linkOptions, $options['link']);
 					}
-					$out = $this->Html->tag('figure', $this->Html->link(__d('baser', 'ダウンロード') . ' ≫', $filePath, $linkOptions) . '<br>' . $this->Html->tag('figcaption', mb_basename($value), $figcaptionOptions), $figureOptions);
+					$out = $this->Html->tag('figure', $this->Html->link(__d('baser', 'ダウンロード') . ' ≫', $filePath, $linkOptions) . '<br>' . $this->Html->tag('figcaption', h(mb_basename($value)), $figcaptionOptions), $figureOptions);
 				}
 			} else {
 				$out = $value;
