diff --git a/src/sp/protocol/mqtt/mqtt_parser.c b/src/sp/protocol/mqtt/mqtt_parser.c
index 92a47f27e..ff9a831de 100644
--- a/src/sp/protocol/mqtt/mqtt_parser.c
+++ b/src/sp/protocol/mqtt/mqtt_parser.c
@@ -299,7 +299,7 @@ copyn_str(const uint8_t *src, uint32_t *pos, int *str_len, int limit)
 	*str_len      = 0;
 	uint8_t *dest = NULL;
 
-	if (!src || !pos) {
+	if (!src || !pos || limit < 2) {
 		*str_len = 0;
 		return NULL;
 	}
