static int sokaka(void) {
	int code = RLC_ERR, l = RLC_MD_LEN;
	sokaka_t k;
	bn_t s;
	uint8_t k1[RLC_MD_LEN], k2[RLC_MD_LEN];
	char *ia = "Alice";
	char *ib = "Bob";

	sokaka_null(k);
	bn_null(s);

	RLC_TRY {
		sokaka_new(k);
		bn_new(s);

		cp_sokaka_gen(s);

		TEST_CASE
				("sakai-ohgishi-kasahara authenticated key agreement is correct")
		{
			TEST_ASSERT(cp_sokaka_gen_prv(k, ia, s) == RLC_OK, end);
			TEST_ASSERT(cp_sokaka_key(k1, l, ia, k, ib) == RLC_OK, end);
			TEST_ASSERT(cp_sokaka_gen_prv(k, ib, s) == RLC_OK, end);
			TEST_ASSERT(cp_sokaka_key(k2, l, ib, k, ia) == RLC_OK, end);
			TEST_ASSERT(memcmp(k1, k2, l) == 0, end);
		} TEST_END;

	} RLC_CATCH_ANY {
		RLC_ERROR(end);
	}
	code = RLC_OK;

  end:
	sokaka_free(k);
	bn_free(s);
	return code;
}
