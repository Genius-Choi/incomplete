static int pdpub(void) {
	int code = RLC_ERR;
	bn_t r1, r2;
	g1_t p, u1, v1;
	g2_t q, u2, v2, w2;
	gt_t e, r, g[3];

	bn_null(r1);
	bn_null(r2);
	g1_null(p);
	g1_null(u1);
	g1_null(v1);
	g2_null(q);
	g2_null(u2);
	g2_null(v2);
	g2_null(w2);
	gt_null(e);
	gt_null(r);
	gt_null(g[0]);
	gt_null(g[1]);
	gt_null(g[2]);

	RLC_TRY {
		bn_new(r1);
		bn_new(r2);
		g1_new(p);
		g1_new(u1);
		g1_new(v1);
		g2_new(q);
		g2_new(u2);
		g2_new(v2);
		g2_new(w2);
		gt_new(e);
		gt_new(r);
		gt_new(g[0]);
		gt_new(g[1]);
		gt_new(g[2]);

		TEST_CASE("delegated pairing computation with public inputs is correct") {
			TEST_ASSERT(cp_pdpub_gen(r1, r2, u1, u2, v2, e) == RLC_OK, end);
			g1_rand(p);
			g2_rand(q);
			TEST_ASSERT(cp_pdpub_ask(v1, w2, p, q, r1, r2, u1, u2, v2) == RLC_OK, end);
			TEST_ASSERT(cp_pdpub_ans(g, p, q, v1, v2, w2) == RLC_OK, end);
			TEST_ASSERT(cp_pdpub_ver(r, g, r1, e) == 1, end);
			pc_map(e, p, q);
			TEST_ASSERT(gt_cmp(r, e) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("faster delegated pairing with public inputs is correct") {
			TEST_ASSERT(cp_lvpub_gen(r2, u1, u2, v2, e) == RLC_OK, end);
			g1_rand(p);
			g2_rand(q);
			TEST_ASSERT(cp_lvpub_ask(r1, v1, w2, p, q, r2, u1, u2, v2) == RLC_OK, end);
			TEST_ASSERT(cp_lvpub_ans(g, p, q, v1, v2, w2) == RLC_OK, end);
			TEST_ASSERT(cp_lvpub_ver(r, g, r1, e) == 1, end);
			pc_map(e, p, q);
			TEST_ASSERT(gt_cmp(r, e) == RLC_EQ, end);
		} TEST_END;
	} RLC_CATCH_ANY {
		RLC_ERROR(end);
	}
	code = RLC_OK;

  end:
	bn_free(r1);
	bn_free(r2);
	g1_free(p);
	g1_free(u1);
	g1_free(v1);
	g2_free(q);
	g2_free(u2);
	g2_free(v2);
	g2_free(w2);
	gt_free(e);
	gt_free(r);
	gt_free(g[0]);
	gt_free(g[1]);
	gt_free(g[2]);
	return code;
}
