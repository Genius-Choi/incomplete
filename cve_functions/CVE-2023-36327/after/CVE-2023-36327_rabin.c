static int rabin(void) {
	int code = RLC_ERR;
	rabin_t pub, prv;
	uint8_t in[10];
	uint8_t out[RLC_BN_BITS / 8 + 1];
	size_t in_len, out_len;
	int result;

	rabin_null(pub);
	rabin_null(prv);

	RLC_TRY {
		rabin_new(pub);
		rabin_new(prv);

		result = cp_rabin_gen(pub, prv, RLC_BN_BITS);

		TEST_CASE("rabin encryption/decryption is correct") {
			TEST_ASSERT(result == RLC_OK, end);
			in_len = 10;
			out_len = RLC_BN_BITS / 8 + 1;
			rand_bytes(in, in_len);
			TEST_ASSERT(cp_rabin_enc(out, &out_len, in, in_len, pub) == RLC_OK,
					end);
			TEST_ASSERT(cp_rabin_dec(out, &out_len, out, out_len,
							prv) == RLC_OK, end);
			TEST_ASSERT(memcmp(in, out, out_len) == 0, end);
		} TEST_END;
	} RLC_CATCH_ANY {
		RLC_ERROR(end);
	}
	code = RLC_OK;

  end:
	rabin_free(pub);
	rabin_free(prv);
	return code;
}
