  Dataset(OpKernelContext* ctx, DatasetContext&& dataset_ctx,
          const DatasetBase* input, int num_threads)
      : DatasetBase(std::move(dataset_ctx)),
        input_(input),
        num_threads_(num_threads == 0 ? port::MaxParallelism() : num_threads),
        traceme_metadata_(
            {{"num_threads",
              strings::Printf("%lld", static_cast<long long>(num_threads_))}}) {
    thread_pool_ = absl::make_unique<thread::ThreadPool>(
        ctx->env(), ThreadOptions{}, "data_private_threadpool", num_threads_);
    input_->Ref();
  }
