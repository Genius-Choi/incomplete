int cjwt_destroy( cjwt_t **jwt )
{
    cjwt_t *del = *jwt;
    *jwt = NULL;

    if( !del ) {
        return 0;
    }

    if(del->header.key)
    {
        free(del->header.key);
    }
    del->header.key = NULL;

    if( del->iss ) {
        free( del->iss );
    }

    del->iss = NULL;

    if( del->sub ) {
        free( del->sub );
    }

    del->sub = NULL;

    if( del->aud ) {
        char** tmp = del->aud->names;
        int cnt_lst = del->aud->count;
        free( del->aud );
        del->aud = NULL;

        while( cnt_lst ) {
            free( tmp[--cnt_lst] );
        }
    }

    if( del->jti ) {
        free( del->jti );
    }

    del->jti = NULL;

    if( del->private_claims ) {
        cJSON_Delete( del->private_claims );
    }

    del->private_claims = NULL;
    free (del);
    return 0;
}
