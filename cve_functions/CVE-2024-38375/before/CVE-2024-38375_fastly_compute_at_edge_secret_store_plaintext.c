bool fastly_compute_at_edge_secret_store_plaintext(
    fastly_compute_at_edge_secret_store_secret_handle_t h, fastly_world_option_list_u8_t *ret,
    fastly_compute_at_edge_secret_store_error_t *err) {
  ret->val.ptr = static_cast<uint8_t *>(JS_malloc(CONTEXT, DICTIONARY_ENTRY_MAX_LEN));
  if (!convert_result(fastly::secret_store_plaintext(h, reinterpret_cast<char *>(ret->val.ptr),
                                                     DICTIONARY_ENTRY_MAX_LEN, &ret->val.len),
                      err)) {
    if (*err == FASTLY_COMPUTE_AT_EDGE_TYPES_ERROR_OPTIONAL_NONE) {
      ret->is_some = false;
      return true;
    } else {
      JS_free(CONTEXT, ret->val.ptr);
      return false;
    }
  }
  ret->is_some = true;
  ret->val.ptr = static_cast<uint8_t *>(
      JS_realloc(CONTEXT, ret->val.ptr, DICTIONARY_ENTRY_MAX_LEN, ret->val.len));
  return true;
}
