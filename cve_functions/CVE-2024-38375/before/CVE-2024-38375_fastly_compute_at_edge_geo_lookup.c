bool fastly_compute_at_edge_geo_lookup(fastly_world_list_u8_t *addr_octets,
                                       fastly_world_string_t *ret,
                                       fastly_compute_at_edge_types_error_t *err) {
  ret->ptr = static_cast<uint8_t *>(cabi_malloc(HOSTCALL_BUFFER_LEN, 1));
  if (!convert_result(fastly::geo_lookup(addr_octets->ptr, addr_octets->len,
                                         reinterpret_cast<char *>(ret->ptr), HOSTCALL_BUFFER_LEN,
                                         &ret->len),
                      err)) {
    cabi_free(ret->ptr);
    return false;
  }
  ret->ptr = static_cast<uint8_t *>(cabi_realloc(ret->ptr, HOSTCALL_BUFFER_LEN, 1, ret->len));
  return true;
}
