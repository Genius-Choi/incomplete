CPubKey CReserveKey::GetReservedKey()
{
    if(nIndex == -1) {
        if(fDefaultKey) vchPubKey = pwallet->vchDefaultKey;
        else {
            CKeyPool keypool;
            pwallet->ReserveKeyFromKeyPool(nIndex, keypool);
            if(nIndex != -1) vchPubKey = keypool.vchPubKey;
            else {
                printf("CReserveKey::GetReservedKey(): key pool is empty, using the default key\n");
                vchPubKey = pwallet->vchDefaultKey;
            }
        }
    } 
    assert(vchPubKey.IsValid());
    return vchPubKey;
}
