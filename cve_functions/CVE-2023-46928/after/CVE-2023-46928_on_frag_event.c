static Bool on_frag_event(void *_udta, GF_Event *evt)
{
	u32 i, count;
	GF_FilterStats stats;
	FragCallback *fc = (FragCallback *)_udta;
	if (!_udta)
		return GF_FALSE;
	if (evt && (evt->type != GF_EVENT_PROGRESS))
		return GF_FALSE;

	stats.report_updated = GF_FALSE;
	if (!fc->filter_idx_plus_one) {
		count = gf_fs_get_filters_count(fc->fsess);
		for (i=0; i<count; i++) {
			if (gf_fs_get_filter_stats(fc->fsess, i, &stats) != GF_OK) continue;
			if (strcmp(stats.reg_name, "mp4mx")) continue;
			fc->filter_idx_plus_one = i+1;
			break;
		}
		if (!fc->filter_idx_plus_one) return GF_FALSE;
	} else {
		if (gf_fs_get_filter_stats(fc->fsess, fc->filter_idx_plus_one-1, &stats) != GF_OK)
			return GF_FALSE;
	}
	if (! stats.report_updated) return GF_FALSE;
	if (stats.percent/100 == fc->last_prog) return GF_FALSE;
	fc->last_prog = stats.percent / 100;

#ifndef GPAC_DISABLE_LOG
	GF_LOG(GF_LOG_INFO, GF_LOG_APP, ("Fragmenting: % 2.2f %%%c", ((Double)stats.percent) / 100, gf_prog_lf));
#else
	fprintf(stderr, "Fragmenting: % 2.2f %%%c", ((Double)stats.percent) / 100, gf_prog_lf);
#endif
	return GF_FALSE;
}
