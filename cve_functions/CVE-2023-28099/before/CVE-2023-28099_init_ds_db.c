int init_ds_db(ds_partition_t *partition)
{
	int _ds_table_version;

	if(partition->table_name.s == 0){
		LM_ERR("invalid database name\n");
		return -1;
	}

	/* Find a database module */
	if (db_bind_mod(&partition->db_url, &partition->dbf) < 0) {
		LM_ERR("Unable to bind to a database driver\n");
		return -1;
	}

	if(ds_connect_db(partition)!=0){
		LM_ERR("unable to connect to the database\n");
		return -1;
	}

	_ds_table_version = db_table_version(&partition->dbf,*partition->db_handle,
											&partition->table_name);
	if (_ds_table_version < 0) {
		LM_ERR("failed to query table version\n");
		return -1;
	} else if (!supported_ds_version(_ds_table_version)) {
		LM_ERR("invalid version for table '%.*s' (found %d, required %d)\n"
		    "(use opensips-cli to migrate to latest schema)\n",
		    partition->table_name.len, partition->table_name.s,
		    _ds_table_version, DS_TABLE_VERSION );
		return -1;
	}

	return 0;
}
