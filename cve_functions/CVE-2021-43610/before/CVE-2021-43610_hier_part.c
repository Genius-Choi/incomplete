hier_part(pbelle_sip_messageParser ctx, belle_generic_uri_t* uri)
{
    belle_generic_uri_t* ret;


    belle_sip_messageParser_query_return query26;
    #undef	RETURN_TYPE_query26
    #define	RETURN_TYPE_query26 belle_sip_messageParser_query_return

    /* Initialize rule variables
     */
    ret = NULL;


    {
        // ../grammars/belle_sip_message.g:346:5: ( ( ( SLASH SLASH path_segments[NULL] )=> ( SLASH SLASH path_segments[uri] ) | ( SLASH SLASH authority[NULL] ( path_segments[NULL] )? )=> ( SLASH SLASH authority[uri] ( path_segments[uri] )? ) | ( path_segments[uri] ) ) ( QMARK query )? )
        // ../grammars/belle_sip_message.g:346:5: ( ( SLASH SLASH path_segments[NULL] )=> ( SLASH SLASH path_segments[uri] ) | ( SLASH SLASH authority[NULL] ( path_segments[NULL] )? )=> ( SLASH SLASH authority[uri] ( path_segments[uri] )? ) | ( path_segments[uri] ) ) ( QMARK query )?
        {
            // ../grammars/belle_sip_message.g:346:5: ( ( SLASH SLASH path_segments[NULL] )=> ( SLASH SLASH path_segments[uri] ) | ( SLASH SLASH authority[NULL] ( path_segments[NULL] )? )=> ( SLASH SLASH authority[uri] ( path_segments[uri] )? ) | ( path_segments[uri] ) )
            {
                int alt18=3;
                alt18 = cdfa18.predict(ctx, RECOGNIZER, ISTREAM, &cdfa18);
                if  (HASEXCEPTION())
                {
                    goto rulehier_partEx;
                }
                if (HASFAILED())
                {
                    return ret;
                }

                switch (alt18)
                {
            	case 1:
            	    // ../grammars/belle_sip_message.g:347:2: ( SLASH SLASH path_segments[NULL] )=> ( SLASH SLASH path_segments[uri] )
            	    {
            	        // ../grammars/belle_sip_message.g:347:37: ( SLASH SLASH path_segments[uri] )
            	        // ../grammars/belle_sip_message.g:347:39: SLASH SLASH path_segments[uri]
            	        {
            	             MATCHT(SLASH, &FOLLOW_SLASH_in_hier_part1146);
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulehier_partEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                return ret;
            	            }


            	             MATCHT(SLASH, &FOLLOW_SLASH_in_hier_part1148);
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulehier_partEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                return ret;
            	            }


            	            FOLLOWPUSH(FOLLOW_path_segments_in_hier_part1150);
            	            path_segments(ctx, uri);

            	            FOLLOWPOP();
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulehier_partEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                return ret;
            	            }


            	        }


            	    }
            	    break;
            	case 2:
            	    // ../grammars/belle_sip_message.g:349:3: ( SLASH SLASH authority[NULL] ( path_segments[NULL] )? )=> ( SLASH SLASH authority[uri] ( path_segments[uri] )? )
            	    {
            	        // ../grammars/belle_sip_message.g:349:57: ( SLASH SLASH authority[uri] ( path_segments[uri] )? )
            	        // ../grammars/belle_sip_message.g:349:59: SLASH SLASH authority[uri] ( path_segments[uri] )?
            	        {
            	             MATCHT(SLASH, &FOLLOW_SLASH_in_hier_part1177);
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulehier_partEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                return ret;
            	            }


            	             MATCHT(SLASH, &FOLLOW_SLASH_in_hier_part1179);
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulehier_partEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                return ret;
            	            }


            	            FOLLOWPUSH(FOLLOW_authority_in_hier_part1181);
            	            authority(ctx, uri);

            	            FOLLOWPOP();
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulehier_partEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                return ret;
            	            }


            	            // ../grammars/belle_sip_message.g:349:86: ( path_segments[uri] )?
            	            {
            	                int alt17=2;
            	                switch ( LA(1) )
            	                {
            	                    case SLASH:
            	                    	{
            	                    		alt17=1;
            	                    	}
            	                        break;
            	                }

            	                switch (alt17)
            	                {
            	            	case 1:
            	            	    // ../grammars/belle_sip_message.g:349:87: path_segments[uri]
            	            	    {
            	            	        FOLLOWPUSH(FOLLOW_path_segments_in_hier_part1185);
            	            	        path_segments(ctx, uri);

            	            	        FOLLOWPOP();
            	            	        if  (HASEXCEPTION())
            	            	        {
            	            	            goto rulehier_partEx;
            	            	        }
            	            	        if (HASFAILED())
            	            	        {
            	            	            return ret;
            	            	        }


            	            	    }
            	            	    break;

            	                }
            	            }

            	        }


            	    }
            	    break;
            	case 3:
            	    // ../grammars/belle_sip_message.g:351:3: ( path_segments[uri] )
            	    {
            	        // ../grammars/belle_sip_message.g:351:3: ( path_segments[uri] )
            	        // ../grammars/belle_sip_message.g:351:5: path_segments[uri]
            	        {
            	            FOLLOWPUSH(FOLLOW_path_segments_in_hier_part1199);
            	            path_segments(ctx, uri);

            	            FOLLOWPOP();
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulehier_partEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                return ret;
            	            }


            	        }


            	    }
            	    break;

                }
            }

            // ../grammars/belle_sip_message.g:352:3: ( QMARK query )?
            {
                int alt19=2;
                switch ( LA(1) )
                {
                    case QMARK:
                    	{
                    		alt19=1;
                    	}
                        break;
                }

                switch (alt19)
                {
            	case 1:
            	    // ../grammars/belle_sip_message.g:352:4: QMARK query
            	    {
            	         MATCHT(QMARK, &FOLLOW_QMARK_in_hier_part1208);
            	        if  (HASEXCEPTION())
            	        {
            	            goto rulehier_partEx;
            	        }
            	        if (HASFAILED())
            	        {
            	            return ret;
            	        }


            	        FOLLOWPUSH(FOLLOW_query_in_hier_part1210);
            	        query26=query(ctx);

            	        FOLLOWPOP();
            	        if  (HASEXCEPTION())
            	        {
            	            goto rulehier_partEx;
            	        }
            	        if (HASFAILED())
            	        {
            	            return ret;
            	        }


            	        if ( BACKTRACKING==0 )
            	        {

            	                        char* unescaped_query;
            	                        unescaped_query=belle_sip_to_unescaped_string((const char *)(STRSTREAM->toStringTT(STRSTREAM, query26.start, query26.stop))
            	            ->chars);
            	                        belle_generic_uri_set_query(uri,(const char*)unescaped_query);
            	                        belle_sip_free(unescaped_query);
            	                        
            	        }


            	    }
            	    break;

                }
            }

        }

    }

    // This is where rules clean up and exit
    //
    goto rulehier_partEx; /* Prevent compiler warnings */
    rulehier_partEx: ;


                if (HASEXCEPTION())
                {

                // This is ugly.  We set the exception type to ANTLR3_RECOGNITION_EXCEPTION so we can always
                // catch them.
                //PREPORTERROR();
                EXCEPTION->type = ANTLR3_RECOGNITION_EXCEPTION;
                }

    return ret;
}
