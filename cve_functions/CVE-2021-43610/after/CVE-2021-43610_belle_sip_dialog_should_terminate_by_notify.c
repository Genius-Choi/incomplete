static int belle_sip_dialog_should_terminate_by_notify(belle_sip_dialog_t *obj, belle_sip_transaction_t* transaction, int as_uas){
	int should_terminate = FALSE;

	if (obj->type == BELLE_SIP_DIALOG_SUBSCRIBE_NOTIFY) {
		belle_sip_request_t *req=belle_sip_transaction_get_request(transaction);
		belle_sip_response_t *resp=belle_sip_transaction_get_response(transaction);
		belle_sip_header_subscription_state_t* subscription_state_header=belle_sip_message_get_header_by_type(req,belle_sip_header_subscription_state_t);
		int code = resp ? belle_sip_response_get_status_code(resp) : 0;

		if (!subscription_state_header || strcasecmp(BELLE_SIP_SUBSCRIPTION_STATE_TERMINATED,belle_sip_header_subscription_state_get_state(subscription_state_header)) ==0) {
			if (as_uas){
				/*terminate the dialog when the application replies the 200 Ok*/
				if (code == 200){
					should_terminate = TRUE;
				}
			}else{
				/*terminate the dialog when we receive the 200OK or the transaction terminates by timeout*/
				if (code == 200 || belle_sip_transaction_get_state(transaction) == BELLE_SIP_TRANSACTION_TERMINATED){
					should_terminate = TRUE;
				}
			}
		}
	}
	return should_terminate;
}
