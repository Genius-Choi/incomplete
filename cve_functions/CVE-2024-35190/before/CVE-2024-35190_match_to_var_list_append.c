static void match_to_var_list_append(struct ast_variable **head, struct ast_ha *ha)
{
	char str[MAX_OBJECT_FIELD];
	const char *addr;

	if (ast_sockaddr_port(&ha->addr)) {
		addr = ast_strdupa(ast_sockaddr_stringify(&ha->addr));
	} else {
		addr = ast_strdupa(ast_sockaddr_stringify_addr(&ha->addr));
	}

	snprintf(str, MAX_OBJECT_FIELD, "%s%s/%s", ha->sense == AST_SENSE_ALLOW ? "!" : "",
			 addr, ast_sockaddr_stringify_addr(&ha->netmask));

	ast_variable_list_append(head, ast_variable_new("match", str, ""));
}
