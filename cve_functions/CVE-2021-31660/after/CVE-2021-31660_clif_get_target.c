ssize_t clif_get_target(const char *input, size_t input_len, char **output)
{
    assert(input);
    char *target_end;

    *output = memchr(input, LF_PATH_BEGIN_C, input_len);
    if (!*output) {
        DEBUG("Path start not found\n");
        return CLIF_NOT_FOUND;
    }
    *output += 1;

    target_end = memchr(*output, LF_PATH_END_C, (input + input_len) - *output);
    if (!target_end) {
        DEBUG("Path end not found\n");
        return CLIF_NOT_FOUND;
    }
    ssize_t res = target_end - *output;
    return res;
}
