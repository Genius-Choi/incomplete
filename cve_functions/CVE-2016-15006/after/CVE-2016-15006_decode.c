void decode(FILE* mainFile)
{
	int mainFileSize = strlen(fileName);
	char decodedFileName[mainFileSize+1];
	char extractedString[BUFFER_SIZE] = "";
	char keyString[BUFFER_SIZE] = "";
	char xoredString[BUFFER_SIZE] = "";
	FILE* decodedFile;

	// Return the file to a unscramble ascii table
	unscramble();

	// naming the file which will be decrypted
	sprintf(decodedFileName, "x%s", fileName);


	// opening the output file
	strcat(pathToMainFile, decodedFileName);
	if ((decodedFile = fopen(pathToMainFile, "w+")) == NULL) {
		perror(decodedFileName);
		printf("exiting\n");
		exit(EXIT_FAILURE);
	}

	// starting decryption
	long bufferCount = 0; //keep trace of the task's completion
	printf("starting decryption...\n");
	if(scrambling){
		while(!feof(mainFile))
		{
			int bufferLength = fillBuffer(mainFile, extractedString, keyString);
			decodingXOR(extractedString, keyString, xoredString, bufferLength);
			fwrite(xoredString, sizeof(char), bufferLength, decodedFile);
			loadBar(++bufferCount, numberOfBuffer, 100, 50);
		}
	} else {
		while(!feof(mainFile))
		{
			int bufferLength = fillBuffer(mainFile, extractedString, keyString);
			standardXOR(extractedString, keyString, xoredString, bufferLength);
			fwrite(xoredString, sizeof(char), bufferLength, decodedFile);
			loadBar(++bufferCount, numberOfBuffer, 100, 50);
		}
	}
	// closing the output file
	fclose(decodedFile);
}
