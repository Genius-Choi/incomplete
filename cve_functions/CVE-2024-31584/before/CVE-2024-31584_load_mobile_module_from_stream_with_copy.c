mobile::Module load_mobile_module_from_stream_with_copy(
    std::istream& in,
    c10::optional<at::Device> device,
    ExtraFilesMap* extra_files) {
  std::shared_ptr<char> data;
  size_t size = 0;
  std::tie(data, size) = get_stream_content(in);
  return parse_and_initialize_mobile_module(
      std::move(data), size, device, extra_files);
}
