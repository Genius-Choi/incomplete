naxsi_can_ignore_cidr(const ngx_str_t* ipstr, ngx_http_naxsi_loc_conf_t* cf)
{
  if (!cf->ignore_cidrs) {
    return 0;
  }
  ngx_uint_t i;
  ip_t       ip = ip_zero;
  if (!naxsi_parse_ip(ipstr, &ip, NULL)) {
    return 0;
  }

  for (i = 0; i < cf->ignore_cidrs->nelts; i++) {
    cidr_t* cidr = &((cidr_t*)cf->ignore_cidrs->elts)[i];
    if (naxsi_is_in_subnet(cidr, &ip)) {
      return 1;
    }
  }

  return 0;
}
