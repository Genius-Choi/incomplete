static void async_nb_on_write_complete(h2o_socket_t *sock, const char *err)
{
    /* add to the read queue the entry for which we have written the request, and start reading from the socket */
    struct async_nb_transaction_t *transaction = async_nb_pop(&async_nb.write_queue);
    if (!transaction->responseless) {
        async_nb_push(&async_nb.read_queue, transaction);
        if (!h2o_socket_is_reading(async_nb.sock))
            h2o_socket_read_start(async_nb.sock, async_nb_read_ready);
    } else {
        // no reponse expected, free the transaction
        assert(!h2o_linklist_is_linked(&transaction->link));
        neverbleed_iobuf_dispose(transaction->buf);
        free(transaction);
    }

    /* submit more requests if there's anything queued */
    async_nb_submit_write_pending();
}
