H2O_NORETURN static void *ticket_redis_updater(void *unused)
{
    while (1) {
        /* connect */
        redisContext *ctx;
        size_t failcnt;
        for (failcnt = 0; (ctx = redisConnect(conf.store.redis.host, conf.store.redis.port)) == NULL || ctx->err != 0; ++failcnt) {
            if (failcnt == 0)
                fprintf(stderr, "[src/ssl.c] failed to connect to redis at %s:%" PRIu16 ", %s\n", conf.store.redis.host,
                        conf.store.redis.port, ctx == NULL ? "redis context allocation failed" : ctx->errstr);
            if (ctx != NULL)
                redisFree(ctx);
            sleep(10);
        }
        /* connected */
        while (ticket_redis_update_tickets(ctx, conf.ticket.vars.redis.key, time(NULL)))
            ;
        /* disconnect */
        redisFree(ctx);

        sleep(10);
    }
}
