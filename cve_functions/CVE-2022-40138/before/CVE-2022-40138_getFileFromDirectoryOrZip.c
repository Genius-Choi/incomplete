std::unique_ptr<llvh::MemoryBuffer> getFileFromDirectoryOrZip(
    zip_t *zip,
    llvh::StringRef rootPath,
    llvh::Twine fileName,
    bool silent = false) {
  llvh::SmallString<32> path{};
  if (!zip) {
    llvh::sys::path::append(path, llvh::sys::path::Style::posix, rootPath);
  }
  llvh::sys::path::append(path, llvh::sys::path::Style::posix, fileName);
  llvh::sys::path::remove_dots(path, false, llvh::sys::path::Style::posix);
  return zip ? memoryBufferFromZipFile(zip, path.c_str(), silent)
             : memoryBufferFromFile(path, false, silent);
}
