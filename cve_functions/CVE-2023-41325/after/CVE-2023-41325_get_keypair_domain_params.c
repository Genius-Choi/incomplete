static TEE_Result get_keypair_domain_params(struct caam_dsa_keypair *outkey,
					    const struct dsa_keypair *key,
					    size_t l_bytes, size_t n_bytes)
{
	enum caam_status retstatus = CAAM_OUT_MEMORY;
	size_t in_q_size = 0;
	size_t in_p_size = 0;
	size_t in_g_size = 0;
	struct prime_data_dsa prime = { };

	DSA_TRACE("DSA conv key param (p, g) of %zu bytes and (q) of %zu bytes",
		  l_bytes, n_bytes);

	retstatus = caam_calloc_buf(&outkey->q, n_bytes);
	if (retstatus != CAAM_NO_ERROR)
		return caam_status_to_tee_result(retstatus);

	retstatus = caam_calloc_buf(&outkey->g, l_bytes);
	if (retstatus != CAAM_NO_ERROR)
		return caam_status_to_tee_result(retstatus);

	retstatus = caam_calloc_buf(&outkey->p, l_bytes);
	if (retstatus != CAAM_NO_ERROR)
		return caam_status_to_tee_result(retstatus);

	/*
	 * Get all inputs parameters size, if one of them is not
	 * define generate new parameters
	 */
	in_g_size = crypto_bignum_num_bytes(key->g);
	in_p_size = crypto_bignum_num_bytes(key->p);
	in_q_size = crypto_bignum_num_bytes(key->q);

	if (!in_q_size || !in_g_size || !in_p_size) {
		/* Generate DSA parameters: Generator G and Primes P/Q */
		prime.g = &outkey->g;
		prime.p = &outkey->p;
		prime.q = &outkey->q;

		retstatus = caam_prime_dsa_gen(&prime);
		DSA_TRACE("Generate G and Primes P/Q returned %#x", retstatus);

		if (retstatus != CAAM_NO_ERROR)
			return caam_status_to_tee_result(retstatus);

		/* Copy Generated DSA Parameter */
		crypto_bignum_bin2bn(outkey->q.data, outkey->q.length, key->q);
		crypto_bignum_bin2bn(outkey->g.data, outkey->g.length, key->g);
		crypto_bignum_bin2bn(outkey->p.data, outkey->p.length, key->p);

	} else {
		DSA_TRACE("Prime Q is defined");

		crypto_bignum_bn2bin(key->q,
				     outkey->q.data + n_bytes - in_q_size);
		cache_operation(TEE_CACHECLEAN, outkey->q.data,
				outkey->q.length);

		DSA_TRACE("Prime G is defined");
		crypto_bignum_bn2bin(key->g,
				     outkey->g.data + l_bytes - in_g_size);
		cache_operation(TEE_CACHECLEAN, outkey->g.data,
				outkey->g.length);

		DSA_TRACE("Prime P is defined");
		crypto_bignum_bn2bin(key->p,
				     outkey->p.data + l_bytes - in_p_size);
		cache_operation(TEE_CACHECLEAN, outkey->p.data,
				outkey->p.length);
	}

	return TEE_SUCCESS;
}
