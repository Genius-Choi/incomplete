NOEXPORT int process_connections() {
#ifndef USE_FORK
    CLI *c;

    s_log(LOG_NOTICE, "Active connections:");
    CRYPTO_THREAD_write_lock(stunnel_locks[LOCK_THREAD_LIST]);
    for(c=thread_head; c; c=c->thread_next) {
        s_log(LOG_NOTICE, "Service [%s]: "
            "%llu byte(s) sent to TLS, "
            "%llu byte(s) sent to socket",
            c->opt->servname,
            (unsigned long long)c->ssl_bytes,
            (unsigned long long)c->sock_bytes);
    }
    CRYPTO_THREAD_unlock(stunnel_locks[LOCK_THREAD_LIST]);
#endif /* USE_FORK */
    return 0; /* continue execution */
}
