void s_poll_init(s_poll_set *fds, int main_thread) {
#ifdef USE_WIN32
    fds->allocated=4; /* prealloc 4 file descriptors */
#endif
    s_poll_realloc(fds);
    FD_ZERO(fds->irfds);
    FD_ZERO(fds->iwfds);
    FD_ZERO(fds->ixfds);
    fds->max=0; /* no file descriptors */
    fds->main_thread=main_thread;
#ifdef USE_WIN32
    /* there seems to be a deadlock in the Windows select() function when
     * waiting for the same terminate_pipe socket in multiple threads */
    if(main_thread)
        s_poll_add(fds, signal_pipe[0], 1, 0);
#else
    s_poll_add(fds, main_thread ? signal_pipe[0] : terminate_pipe[0], 1, 0);
#endif
}
