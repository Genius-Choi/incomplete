static int skip_icc_profile(void *avctx, JXLParseContext *ctx, GetBitContext *gb)
{
    int64_t ret;
    uint32_t last = 0, last2 = 0;
    JXLEntropyDecoder dec;
    uint64_t enc_size = jxl_u64(gb);

    if (!enc_size)
        return AVERROR_INVALIDDATA;

    ret = entropy_decoder_init(avctx, gb, &dec, 41);
    if (ret < 0)
        return ret;

    if (get_bits_left(gb) < 0) {
        entropy_decoder_close(&dec);
        return AVERROR_BUFFER_TOO_SMALL;
    }

    for (uint64_t read = 0; read < enc_size; read++) {
        ret = entropy_decoder_read_symbol(gb, &dec, icc_context(read, last, last2));
        if (ret < 0 || get_bits_left(gb) < 0) {
            entropy_decoder_close(&dec);
            return ret < 0 ? ret : AVERROR_BUFFER_TOO_SMALL;
        }
        last2 = last;
        last = ret;
    }

    entropy_decoder_close(&dec);

    return 0;
}
