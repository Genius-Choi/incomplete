static void convert_cert_types(private_tls_peer_t *this)
{
	bio_reader_t *reader;
	bio_writer_t *writer;
	uint8_t type;

	reader = bio_reader_create(this->cert_types);
	writer = bio_writer_create(0);
	while (reader->remaining(reader) && reader->read_uint8(reader, &type))
	{
		/* each certificate type is mapped to one signature scheme, which is not
		 * ideal but serves our needs in legacy TLS versions */
		switch (type)
		{
			case TLS_RSA_SIGN:
				writer->write_uint16(writer, TLS_SIG_RSA_PKCS1_SHA256);
				break;
			case TLS_ECDSA_SIGN:
				writer->write_uint16(writer, TLS_SIG_ECDSA_SHA256);
				break;
			default:
				continue;
		}
	}
	reader->destroy(reader);
	this->hashsig = writer->extract_buf(writer);
	writer->destroy(writer);
}
