static bool verify_requested_key_type(private_tls_peer_t *this,
									  uint16_t key_type)
{
	enumerator_t *enumerator;
	diffie_hellman_group_t group, found = MODP_NONE;
	tls_named_group_t curve;

	enumerator = this->crypto->create_ec_enumerator(this->crypto);
	while (enumerator->enumerate(enumerator, &group, &curve))
	{
		if (key_type == curve)
		{
			found = group;
			break;
		}
	}
	enumerator->destroy(enumerator);

	if (found == MODP_NONE)
	{
		DBG1(DBG_TLS, "server requested key exchange we didn't propose");
		return FALSE;
	}
	if (this->dh->get_dh_group(this->dh) == found)
	{
		DBG1(DBG_TLS, "server requested key exchange we already use");
		return FALSE;
	}
	return TRUE;
}
