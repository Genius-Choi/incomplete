void PdfXRefStreamParserObject::DelayedLoadImpl()
{
    // NOTE: Ignore the encryption in the XREF as the XREF stream must no be encrypted (see PDF Reference 3.4.7)

    PdfTokenizer tokenizer;
    auto reference = ReadReference(tokenizer);
    SetIndirectReference(reference);
    PdfParserObject::Parse(tokenizer);

    // Do some very basic error checking
    auto& dict = m_Variant.GetDictionary();
    auto keyObj = dict.FindKey(PdfName::KeyType);
    if (keyObj == nullptr)
        PODOFO_RAISE_ERROR(PdfErrorCode::NoXRef);

    if (!keyObj->IsName() || keyObj->GetName() != "XRef")
        PODOFO_RAISE_ERROR(PdfErrorCode::NoXRef);

    if (!dict.HasKey(PdfName::KeySize)
        || !dict.HasKey("W"))
    {
        PODOFO_RAISE_ERROR(PdfErrorCode::NoXRef);
    }

    if (dict.HasKey("Prev"))
        m_NextOffset = static_cast<ssize_t>(dict.FindKeyAs<double>("Prev", 0));

    if (!this->HasStreamToParse())
        PODOFO_RAISE_ERROR(PdfErrorCode::NoXRef);
}
