GF_Err gf_isom_set_forced_text(GF_ISOFile *file, u32 track, u32 stsd_idx, u32 flags)
{
	GF_TrackBox *trak;
	GF_Tx3gSampleEntryBox *a;

	trak = gf_isom_get_track_from_file(file, track);
	if (!trak) return GF_BAD_PARAM;

	a = (GF_Tx3gSampleEntryBox *) gf_list_get(trak->Media->information->sampleTable->SampleDescription->child_boxes, stsd_idx-1);
	if (!a) return GF_BAD_PARAM;
	if ((a->type != GF_ISOM_BOX_TYPE_TX3G) && (a->type != GF_ISOM_BOX_TYPE_TEXT)) return GF_BAD_PARAM;

	switch (flags) {
	case 2:
		a->displayFlags |= GF_TXT_SOME_SAMPLES_FORCED | GF_TXT_ALL_SAMPLES_FORCED;
		break;
	case 1:
		a->displayFlags |= GF_TXT_SOME_SAMPLES_FORCED;
		a->displayFlags &= ~GF_TXT_ALL_SAMPLES_FORCED;
		break;
	default:
		a->displayFlags &= ~GF_TXT_SOME_SAMPLES_FORCED;
		a->displayFlags &= ~GF_TXT_ALL_SAMPLES_FORCED;
		break;
	}
	return GF_OK;
}
