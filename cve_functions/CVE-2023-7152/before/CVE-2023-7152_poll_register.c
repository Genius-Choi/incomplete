STATIC mp_obj_t poll_register(size_t n_args, const mp_obj_t *args) {
    mp_obj_poll_t *self = MP_OBJ_TO_PTR(args[0]);
    mp_uint_t events;
    if (n_args == 3) {
        events = mp_obj_get_int(args[2]);
    } else {
        events = MP_STREAM_POLL_RD | MP_STREAM_POLL_WR;
    }
    poll_set_add_obj(&self->poll_set, &args[1], 1, events, false);
    return mp_const_none;
}
