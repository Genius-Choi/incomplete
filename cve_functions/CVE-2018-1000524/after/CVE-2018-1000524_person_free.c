person_free(person_t* person)
{
	int i, j;

	// call the person's destroy script *before* renouncing leadership.
	// the destroy script may want to reassign followers (they will be orphaned otherwise), so
	// we want to give it a chance to do so.
	person_activate(person, PERSON_SCRIPT_ON_DESTROY, NULL, true);
	for (i = 0; i < s_num_persons; ++i) {
		if (s_persons[i]->leader == person)
			s_persons[i]->leader = NULL;
	}

	// remove the person from the engine
	detach_person(person);
	for (i = 0; i < s_num_persons; ++i) {
		if (s_persons[i] == person) {
			for (j = i; j < s_num_persons - 1; ++j)
				s_persons[j] = s_persons[j + 1];
			--s_num_persons;
			--i;
		}
	}

	vector_free(person->ignore_list);

	free_person(person);
	sort_persons();
}
