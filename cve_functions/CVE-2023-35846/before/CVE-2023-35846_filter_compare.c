int filter_compare(void *filterA, void *filterB)
{

    struct filter_node *a = (struct filter_node *)filterA;
    struct filter_node *b = (struct filter_node *)filterB;
    int cmp = 0;
    if (a->filter_id == 0 || b->filter_id == 0) {
        return filter_match_packet(a, b);
    }

    /* improve the search */
    if(a->filter_id == b->filter_id)
        return 0;

    /* 1. Compare devices */
    cmp = ipfilter_ptr_cmp(a->fdev, a->fdev);
    if (cmp)
        return cmp;

    /* 2. Compare protocol */
    cmp = filter_compare_proto(a, b);
    if(cmp)
        return cmp;

    /* 3. Compare addresses order: in, out */
    /* 4. Compare ports     order: in, out */
    cmp = filter_compare_address_port(a, b);

    return cmp;
}
