make_snapshot(int idx)
{
    clear_snapshot(curtab, idx);
    if (make_snapshot_rec(topframe, &curtab->tp_snapshot[idx]) == FAIL)
    {
	clear_snapshot(curtab, idx);
	return FAIL;
    }
    return OK;
}
