zfs_acl_chown_setattr(znode_t *zp)
{
	int error;
	zfs_acl_t *aclp;

	if (zp->z_zfsvfs->z_replay == B_FALSE)
		ASSERT_VOP_ELOCKED(ZTOV(zp), __func__);
	ASSERT(MUTEX_HELD(&zp->z_acl_lock));
	ASSERT_VOP_IN_SEQC(ZTOV(zp));

	if ((error = zfs_acl_node_read(zp, B_TRUE, &aclp, B_FALSE)) == 0)
		zp->z_mode = zfs_mode_compute(zp->z_mode, aclp,
		    &zp->z_pflags, zp->z_uid, zp->z_gid);
	return (error);
}
