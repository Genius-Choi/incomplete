                 {
                    m_VirtQueue.ProcessTXCompletions();
                    bDoKick = SendMapped(IsInterrupt, pNBLFailNow);
                    pNBLReturnNow = ProcessWaitingList();
                    {
                        CNdisPassiveWriteAutoLock tLock(m_Context->m_PauseLock);

                        if (!m_VirtQueue.HasPacketsInHW() && m_Context->SendState == srsPausing)
                        {
                            CallbackToCall = m_Context->SendPauseCompletionProc;
                            m_Context->SendPauseCompletionProc = nullptr;
                            m_Context->SendState = srsDisabled;
                        }
                    }
                 });
