static void run_http_request_parse(server *srv, connection *con, int line, int status, const char *desc, const char *req, size_t reqlen)
{
    test_request_connection_reset(con);
    buffer_copy_string_len(con->request.request, req, reqlen);
    http_request_parse(srv, con);
    if (con->http_status != status) {
        fprintf(stderr,
                "%s.%d: %s() failed: expected '%d', got '%d' for test %s\n",
                __FILE__, line, "http_request_parse", status, con->http_status,
                desc);
        fflush(stderr);
        abort();
    }
}
