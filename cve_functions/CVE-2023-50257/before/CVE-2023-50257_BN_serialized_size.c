size_t BN_serialized_size(const BIGNUM* bn, size_t current_alignment = 0)
{
    size_t initial_alignment = current_alignment;

    current_alignment += 4 + alignment(current_alignment, 4) + BN_num_bytes(bn);

    return current_alignment - initial_alignment;
}
