bool get_signature_algorithm(X509* certificate, std::string& signature_algorithm)
{
    bool returnedValue = false;
    BUF_MEM* ptr = nullptr;
    X509_ALGOR* sigalg = nullptr;
    ASN1_BIT_STRING* sig = nullptr;

    BIO *out = BIO_new(BIO_s_mem());

    if(out != nullptr)
    {
        X509_get0_signature(&sig, &sigalg, certificate);

        if(sigalg != nullptr)
        {
            if(i2a_ASN1_OBJECT(out, sigalg->algorithm) > 0)
            {
                BIO_get_mem_ptr(out, &ptr);

                if(ptr != nullptr)
                {
                    if(strncmp(ptr->data, "ecdsa-with-SHA256", ptr->length) == 0)
                    {
                        signature_algorithm = ECDSA_SHA256;
                        returnedValue = true;
                    }
                }
                else
                    logError(AUTHENTICATION, "OpenSSL library cannot retrieve mem ptr");
            }
        }
        else
            logError(AUTHENTICATION, "OpenSSL library cannot write cert");

        BIO_free(out);
    }
    else
        logError(AUTHENTICATION, "OpenSSL library cannot allocate mem");

    return returnedValue;
}
