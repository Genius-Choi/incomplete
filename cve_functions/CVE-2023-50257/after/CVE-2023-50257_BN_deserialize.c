const unsigned char* BN_deserialize(BIGNUM** bn, const unsigned char* orig_pointer, const unsigned char* current_pointer)
{
    assert(bn);
    assert(orig_pointer);
    assert(current_pointer);

    size_t align = alignment(current_pointer - orig_pointer, 4);
    const unsigned char* pointer = current_pointer + align;
    uint32_t length = 0;

    if(DEFAULT_ENDIAN == BIGEND)
    {
        ((char*)&length)[0] = pointer[0];
        ((char*)&length)[1] = pointer[1];
        ((char*)&length)[2] = pointer[2];
        ((char*)&length)[3] = pointer[3];
    }
    else
    {
        ((char*)&length)[0] = pointer[3];
        ((char*)&length)[1] = pointer[2];
        ((char*)&length)[2] = pointer[1];
        ((char*)&length)[3] = pointer[0];
    }

    pointer += 4;

    BIGNUM *bnn = BN_new();

    if(bnn != nullptr)
    {
        if(BN_bin2bn(pointer, length, bnn) !=  nullptr)
        {
            *bn = bnn;
            return pointer + length;
        }
        else
            logError(AUTHENTICATION, "Cannot deserialize DH");

        BN_free(bnn);
    }
    else
        logError(AUTHENTICATION, "OpenSSL library cannot create bignum");

    return nullptr;
}
