void tunnel_write(struct st_h2o_http3_server_stream_t *stream)
{
    size_t bytes_to_send;

    assert(!stream->tunnel->up.is_inflight);

    if ((bytes_to_send = stream->req_body->size) == 0)
        return;

    /* move chunk of data into stream->tunnel.up.buf */
    if (bytes_to_send > sizeof(stream->tunnel->up.bytes_inflight))
        bytes_to_send = sizeof(stream->tunnel->up.bytes_inflight);
    memcpy(stream->tunnel->up.bytes_inflight, stream->req_body->bytes, bytes_to_send);
    stream->tunnel->up.is_inflight = 1;
    h2o_buffer_consume(&stream->req_body, bytes_to_send);

    /* send */
    stream->tunnel->tunnel->write_(stream->tunnel->tunnel, stream->tunnel->up.bytes_inflight, bytes_to_send);
}
