static int samldb_get_domain_secdesc_and_oc(struct samldb_ctx *ac,
					    struct security_descriptor **domain_sd,
					    const struct dsdb_class **objectclass)
{
	const char * const sd_attrs[] = {"ntSecurityDescriptor", "objectClass", NULL};
	struct ldb_result *res;
	struct ldb_dn *domain_dn = ldb_get_default_basedn(ldb_module_get_ctx(ac->module));
	const struct dsdb_schema *schema = NULL;
	struct ldb_context *ldb = ldb_module_get_ctx(ac->module);
	int ret = dsdb_module_search_dn(ac->module, ac, &res,
					domain_dn,
					sd_attrs,
					DSDB_FLAG_NEXT_MODULE | DSDB_SEARCH_SHOW_DELETED,
					ac->req);
	if (ret != LDB_SUCCESS) {
		return ret;
	}
	if (res->count != 1) {
		return ldb_module_operr(ac->module);
	}

	schema = dsdb_get_schema(ldb, ac->req);
	if (!schema) {
		return ldb_module_operr(ac->module);;
	}
	*objectclass = dsdb_get_structural_oc_from_msg(schema, res->msgs[0]);
	return dsdb_get_sd_from_ldb_message(ldb_module_get_ctx(ac->module),
					    ac, res->msgs[0], domain_sd);

}
