sudo_auth_approval(const struct sudoers_context *ctx, struct passwd *pw,
    unsigned int validated, bool exempt)
{
    sudo_auth *auth;
    debug_decl(sudo_auth_approval, SUDOERS_DEBUG_AUTH);

    /* Call approval routines. */
    for (auth = auth_switch; auth->name; auth++) {
	if (auth->approval && !IS_DISABLED(auth)) {
	    int status = (auth->approval)(ctx, pw, auth, exempt);
	    if (status != AUTH_SUCCESS) {
		/* Assume error msg already printed. */
		log_auth_failure(ctx, validated, 0);
		debug_return_int(status == AUTH_FAILURE ? false : -1);
	    }
	}
    }
    debug_return_int(true);
}
