static int myeid_wrap_key(struct sc_card *card, u8 *out, size_t outlen)
{
	struct sc_context *ctx;
	struct sc_apdu apdu;
	u8 rbuf[SC_MAX_APDU_BUFFER_SIZE];
	int r;

	assert(card != NULL);
	ctx = card->ctx;
	LOG_FUNC_CALLED(ctx);

	/* INS: 0x2A  PERFORM SECURITY OPERATION
	   P1:  0x84  Resp: Return a cryptogram
	 * P2:  0x00  The data field is absent */
	sc_format_apdu(card, &apdu, SC_APDU_CASE_2_SHORT, 0x2A, 0x84, 0x00);
	apdu.resp = rbuf;
	apdu.resplen = sizeof(rbuf);
	apdu.le = sizeof(rbuf) <= 256 ? sizeof(rbuf) : 256;
	apdu.lc = 0;

	r = sc_transmit_apdu(card, &apdu);
	LOG_TEST_RET(ctx, r, "APDU transmit failed");
	r = sc_check_sw(card, apdu.sw1, apdu.sw2);
	LOG_TEST_RET(ctx, r, "wrap key failed");

	if (apdu.resplen <= outlen && out != NULL)
		memcpy(out, apdu.resp, apdu.resplen);

	LOG_FUNC_RETURN(ctx, apdu.resplen);
}
