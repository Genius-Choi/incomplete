  update_id_client(const std::string &uniqueID, std::string &&cert, op_e op) {
    switch (op) {
      case op_e::ADD: {
        auto &client = map_id_client[uniqueID];
        client.certs.emplace_back(std::move(cert));
        client.uniqueID = uniqueID;
      } break;
      case op_e::REMOVE:
        map_id_client.erase(uniqueID);
        break;
    }

    if (!config::sunshine.flags[config::flag::FRESH_STATE]) {
      save_state();
    }
  }
