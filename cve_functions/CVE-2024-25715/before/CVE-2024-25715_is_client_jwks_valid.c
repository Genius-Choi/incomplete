static int is_client_jwks_valid(struct _oidc_config * config, jwks_t * jwks) {
  size_t index = 0;
  jwk_t * jwk;
  int ret, type;

  if (r_jwks_size(jwks)) {
    ret = G_OK;
    for (index=0; index<r_jwks_size(jwks); index++) {
      jwk = r_jwks_get_at(jwks, index);
      if (jwk != NULL) {
        type = r_jwk_key_type(jwk, NULL, config->x5u_flags);
        if (!(type & R_KEY_TYPE_PUBLIC) || (!(type & R_KEY_TYPE_RSA) && !(type & R_KEY_TYPE_EC) && !(type & R_KEY_TYPE_EDDSA))) {
          y_log_message(Y_LOG_LEVEL_DEBUG, "is_client_jwks_valid - Error invalid key at index %zu", index);
          ret = G_ERROR_PARAM;
        }
        r_jwk_free(jwk);
      } else {
        y_log_message(Y_LOG_LEVEL_DEBUG, "is_client_jwks_valid - Error getting jwk at index %zu", index);
        ret = G_ERROR;
      }
    }
  } else {
    ret = G_ERROR_PARAM;
  }
  return ret;
}
