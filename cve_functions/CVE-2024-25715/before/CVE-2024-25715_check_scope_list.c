static int check_scope_list(const char * scope_expected, const char * scope_token) {
  int ret = 1;
  size_t scope_expected_count, scope_token_count, i;
  char ** scope_expected_list = NULL, ** scope_token_list = NULL;

  if (scope_expected == NULL) {
    return 1;
  }
  if (scope_token != NULL) {
    if ((scope_expected_count = split_string_remove_duplicates(scope_expected, " ", &scope_expected_list)) && (scope_token_count = split_string_remove_duplicates(scope_token, " ", &scope_token_list))) {
      if (scope_token_count >= scope_expected_count) {
        for (i=0; scope_expected_list[i] != NULL; i++) {
          if (!string_array_has_value((const char **)scope_token_list, scope_expected_list[i])) {
            ret = 0;
          }
        }
      } else {
        ret = 0;
      }
    } else {
      y_log_message(Y_LOG_LEVEL_ERROR, "check_scope_list - Error split_string_remove_duplicates");
      ret = 0;
    }
    free_string_array(scope_expected_list);
    free_string_array(scope_token_list);
  } else {
    ret = 0;
  }
  return ret;
}
