static int is_encrypt_token_allowed(struct _oidc_config * config, json_t * j_client, int type) {
  int ret;

  switch (type) {
    case GLEWLWYD_TOKEN_TYPE_CODE:
      ret = is_true(json_string_value(json_object_get(j_client, json_string_value(json_object_get(config->j_params, "client-encrypt_code-parameter")))));
      break;
    case GLEWLWYD_TOKEN_TYPE_ACCESS_TOKEN:
      ret = is_true(json_string_value(json_object_get(j_client, json_string_value(json_object_get(config->j_params, "client-encrypt_at-parameter")))));
      break;
    case GLEWLWYD_TOKEN_TYPE_USERINFO:
      ret = is_true(json_string_value(json_object_get(j_client, json_string_value(json_object_get(config->j_params, "client-encrypt_userinfo-parameter")))));
      break;
    case GLEWLWYD_TOKEN_TYPE_ID_TOKEN:
      ret = is_true(json_string_value(json_object_get(j_client, json_string_value(json_object_get(config->j_params, "client-encrypt_id_token-parameter")))));
      break;
    case GLEWLWYD_TOKEN_TYPE_REFRESH_TOKEN:
      ret = is_true(json_string_value(json_object_get(j_client, json_string_value(json_object_get(config->j_params, "client-encrypt_refresh_token-parameter")))));
      break;
    case GLEWLWYD_TOKEN_TYPE_INTROSPECTION:
      ret = is_true(json_string_value(json_object_get(j_client, json_string_value(json_object_get(config->j_params, "client-encrypt_introspection-parameter")))));
      break;
    case GLEWLWYD_TOKEN_TYPE_CIBA:
      ret = (json_object_get(j_client, "backchannel_authentication_request_encryption_alg") != NULL);
      break;
    case GLEWLWYD_TOKEN_TYPE_AUTH:
      ret = (json_object_get(j_client, "authorization_encrypted_response_alg") != NULL);
      break;
    default:
      ret = 0;
      break;
  }
  return ret;
}
