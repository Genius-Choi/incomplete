static char * get_request_from_uri(struct _oidc_config * config, const char * request_uri) {
  struct _u_request req;
  struct _u_response resp;
  char * str_request = NULL;
  int valid_ct = 1;

  ulfius_init_request(&req);
  ulfius_init_response(&resp);

  req.http_verb = o_strdup("GET");
  req.http_url = o_strdup(request_uri);
  if (json_object_get(config->j_params, "request-uri-allow-https-non-secure") == json_true()) {
    req.check_server_certificate = 0;
  }

  if (ulfius_send_http_request_with_limit(&req, &resp, config->glewlwyd_config->glewlwyd_config->response_body_limit, config->glewlwyd_config->glewlwyd_config->max_header) != U_OK) {
    y_log_message(Y_LOG_LEVEL_ERROR, "get_request_from_uri - Error ulfius_send_http_request_with_limit");
  } else if (resp.status == 200) {
    if (json_object_get(config->j_params, "request-parameter-ietf-strict") == json_true()) {
      valid_ct = !o_strcmp(u_map_get(resp.map_header, ULFIUS_HTTP_HEADER_CONTENT), "application/oauth-authz-req+jwt") || !o_strcmp(u_map_get(resp.map_header, ULFIUS_HTTP_HEADER_CONTENT), "application/jwt");
    }
    if (valid_ct) {
      str_request = o_malloc(resp.binary_body_length + 1);
      if (str_request != NULL) {
        memcpy(str_request, resp.binary_body, resp.binary_body_length);
        str_request[resp.binary_body_length] = '\0';
      } else {
        y_log_message(Y_LOG_LEVEL_ERROR, "get_request_from_uri - Error allocating resources for str_request");
      }
    } else {
      y_log_message(Y_LOG_LEVEL_ERROR, "get_request_from_uri - Error invalid content type");
    }
  } else {
    y_log_message(Y_LOG_LEVEL_ERROR, "get_request_from_uri - Error ulfius_send_http_request_with_limit response status is %d", resp.status);
  }

  ulfius_clean_request(&req);
  ulfius_clean_response(&resp);
  return str_request;
}
