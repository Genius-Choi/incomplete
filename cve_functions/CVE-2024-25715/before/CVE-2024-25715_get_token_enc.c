static jwa_enc get_token_enc(struct _oidc_config * config, json_t * j_client, int type) {
  jwa_enc enc = R_JWA_ENC_A128CBC;
  const char * enc_p = json_string_value(json_object_get(config->j_params, "client-enc-parameter"));

  if (json_object_get(j_client, enc_p) != NULL) {
    enc = r_str_to_jwa_enc(json_string_value(json_object_get(j_client, enc_p)));
  } else {
    switch (type) {
      case GLEWLWYD_TOKEN_TYPE_ACCESS_TOKEN:
        enc = r_str_to_jwa_enc(json_string_value(json_object_get(j_client, "access_token_encryption_enc")));
        break;
      case GLEWLWYD_TOKEN_TYPE_ID_TOKEN:
        enc = r_str_to_jwa_enc(json_string_value(json_object_get(j_client, "id_token_encryption_enc")));
        break;
      case GLEWLWYD_TOKEN_TYPE_USERINFO:
        enc = r_str_to_jwa_enc(json_string_value(json_object_get(j_client, "userinfo_encryption_enc")));
        break;
      case GLEWLWYD_TOKEN_TYPE_AUTH:
        enc = r_str_to_jwa_enc(json_string_value(json_object_get(j_client, "authorization_encrypted_response_enc")));
        break;
      default:
        break;
    }
  }
  return enc;
}
