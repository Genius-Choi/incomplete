static jwa_alg get_token_enc_alg(struct _oidc_config * config, json_t * j_client, int type) {
  jwa_alg alg = R_JWA_ALG_UNKNOWN;
  const char * alg_p = json_string_value(json_object_get(config->j_params, "client-alg-parameter"));

  if (json_object_get(j_client, alg_p) != NULL) {
    alg = r_str_to_jwa_alg(json_string_value(json_object_get(j_client, alg_p)));
  } else {
    switch (type) {
      case GLEWLWYD_TOKEN_TYPE_ACCESS_TOKEN:
        alg = r_str_to_jwa_alg(json_string_value(json_object_get(j_client, "access_token_encryption_alg")));
        break;
      case GLEWLWYD_TOKEN_TYPE_ID_TOKEN:
        alg = r_str_to_jwa_alg(json_string_value(json_object_get(j_client, "id_token_encryption_alg")));
        break;
      case GLEWLWYD_TOKEN_TYPE_USERINFO:
        alg = r_str_to_jwa_alg(json_string_value(json_object_get(j_client, "userinfo_encryption_alg")));
        break;
      case GLEWLWYD_TOKEN_TYPE_AUTH:
        alg = r_str_to_jwa_alg(json_string_value(json_object_get(j_client, "authorization_encrypted_response_alg")));
        break;
      default:
        break;
    }
  }
  return alg;
}
