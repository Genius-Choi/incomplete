int oidc_oauth_return_www_authenticate(request_rec *r, const char *error,
		const char *error_description) {
	char *hdr = apr_psprintf(r->pool, "Bearer");
	if (ap_auth_name(r) != NULL)
		hdr = apr_psprintf(r->pool, "%s realm=\"%s\"", hdr, ap_auth_name(r));
	if (error != NULL)
		hdr = apr_psprintf(r->pool, "%s%s error=\"%s\"", hdr,
				(ap_auth_name(r) ? "," : ""), error);
	if (error_description != NULL)
		hdr = apr_psprintf(r->pool, "%s, error_description=\"%s\"", hdr,
				error_description);
	apr_table_setn(r->err_headers_out, "WWW-Authenticate", hdr);
	return HTTP_UNAUTHORIZED;
}
