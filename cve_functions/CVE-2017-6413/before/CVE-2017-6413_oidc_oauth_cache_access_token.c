static apr_byte_t oidc_oauth_cache_access_token(request_rec *r, oidc_cfg *c,
		apr_time_t cache_until, const char *access_token, json_t *json) {

	oidc_debug(r, "caching introspection result");

	json_t *cache_entry = json_object();
	json_object_set(cache_entry, "response", json);
	json_object_set_new(cache_entry, "timestamp",
			json_integer(apr_time_sec(apr_time_now())));
	char *cache_value = json_dumps(cache_entry, 0);

	/* set it in the cache so subsequent request don't need to validate the access_token and get the claims anymore */
	c->cache->set(r, OIDC_CACHE_SECTION_ACCESS_TOKEN, access_token, cache_value,
			cache_until);

	json_decref(cache_entry);
	free(cache_value);

	return TRUE;
}
