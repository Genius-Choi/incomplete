    bool CFileBinary::ReadAllBytes(const std::wstring&  strFileName, BYTE** ppData, DWORD& nBytesCount)
    {
        *ppData = NULL;
        nBytesCount = 0;
        bool bRes = false;
        CFileBinary oFileBinary;
        if (oFileBinary.OpenFile(strFileName))
        {
            long nFileSize = oFileBinary.GetFileSize();
            BYTE* pData = new BYTE[nFileSize];
            DWORD dwSizeRead;
            if (oFileBinary.ReadFile(pData, nFileSize, dwSizeRead))
            {
                oFileBinary.CloseFile();
                *ppData = pData;
                nBytesCount = dwSizeRead;
                bRes = true;
            }
            else
                RELEASEARRAYOBJECTS(pData);
        }
        return bRes;
    }
