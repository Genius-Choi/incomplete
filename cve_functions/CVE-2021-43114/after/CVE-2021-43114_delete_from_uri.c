delete_from_uri(struct rpki_uri *uri, struct visited_uris *visited_uris)
{
	int error;

	if (visited_uris) {
		error = rem_mft_from_list(visited_uris, uri_get_global(uri));
		if (error)
			return error;
	}

	/* Delete parent dirs only if empty. */
	return delete_dir_recursive_bottom_up(uri_get_local(uri));
}
