crypto_err(struct log_config *cfg, int (*error_fn)(int, const char *, ...))
{
	struct crypto_cb_arg arg;

	error_fn(0, "libcrypto error stack:");

	arg.stack_size = 0;
	arg.error_fn = error_fn;
	ERR_print_errors_cb(log_crypto_error, &arg);
	if (arg.stack_size == 0)
		error_fn(0, "   <Empty>");
	else
		error_fn(0, "End of libcrypto stack.");

	return -EINVAL;
}
