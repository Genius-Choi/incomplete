download_file(struct rpki_uri *uri, long last_update, bool log_operation)
{
	int error;

	if (last_update > 0)
		error = http_download_file_with_ims(uri, last_update,
		    log_operation);
	else
		error = http_download_file(uri, log_operation);

	/*
	 * Since distinct files can be downloaded (notification, snapshot,
	 * delta) just return the error and let the caller to add only the
	 * update notification URI to the request errors DB.
	 */
	if (error == -EREQFAILED)
		return EREQFAILED;

	/* Remember: positive values are expected */
	return error;
}
