void test_mmx_abi_poison(oe_enclave_t* enclave)
{
    double float_result = 0;
    uint64_t dummy = 0;

    printf("=== test_mmx_abi_poison()\n");

#ifdef _WIN32
    oe_dummy_mmx_add();
#else
    asm("movq %0, %%mm0\n\t"
        "paddd %%mm0, %%mm0\n\t" ::"m"(dummy)
        :);
#endif

    OE_TEST(enclave_add_float(enclave, &float_result) == OE_OK);

    printf("x87 FPU result = %f\n", float_result);
    OE_TEST(!isnan(float_result));
}
