saslserv_message_handler(struct sourceinfo *const restrict si, const int parc, char **const restrict parv)
{
	// this should never happen
	if (parv[0][0] == '&')
	{
		(void) slog(LG_ERROR, "%s: got parv with local channel: %s", MOWGLI_FUNC_NAME, parv[0]);
		return;
	}

	// make a copy of the original for debugging
	char orig[BUFSIZE];
	(void) mowgli_strlcpy(orig, parv[parc - 1], sizeof orig);

	// lets go through this to get the command
	char *const cmd = strtok(parv[parc - 1], " ");
	char *const text = strtok(NULL, "");

	if (! cmd)
		return;

	if (*orig == '\001')
	{
		(void) handle_ctcp_common(si, cmd, text);
		return;
	}

	(void) command_fail(si, fault_noprivs, _("This service exists to identify connecting clients "
	                                         "to the network. It has no public interface."));
}
