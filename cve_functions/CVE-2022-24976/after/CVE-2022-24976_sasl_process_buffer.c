sasl_process_buffer(struct sasl_session *const restrict p)
{
	// Ensure the buffer is NULL-terminated so that base64_decode() doesn't overrun it
	p->buf[p->len] = 0x00;

	if (! sasl_process_packet(p, p->buf, p->len))
		return false;

	(void) sfree(p->buf);

	p->buf = NULL;
	p->len = 0;

	return true;
}
