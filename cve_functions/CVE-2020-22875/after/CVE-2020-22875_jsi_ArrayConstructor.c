static Jsi_RC jsi_ArrayConstructor(Jsi_Interp *interp, Jsi_Value *args, Jsi_Value *_this,
    Jsi_Value **ret, Jsi_Func *funcPtr)
{
    int argc = Jsi_ValueGetLength(interp, args), iscons = Jsi_FunctionIsConstructor(funcPtr);
    Jsi_Value *target;
    Jsi_Value *v = Jsi_ValueArrayIndex(interp, args, 0);
    
    if (iscons) {
        target = _this;
        Jsi_ValueMakeArrayObject(interp, &_this, Jsi_ObjNewArray(interp, NULL, 0, 0));
    } else {
        Jsi_Obj *o = Jsi_ObjNewType(interp, JSI_OT_ARRAY);
        o->__proto__ = interp->Array_prototype;
        Jsi_ValueMakeObject(interp, ret, o);
        target = *ret;
    }

    if (argc == 1 && v && Jsi_ValueIsNumber(interp, v)) {
        Jsi_Number nv;
        Jsi_GetNumberFromValue(interp,v, &nv);
        int len = (int)nv;
        if (!Jsi_NumberIsInteger(v->d.num) || len < 0) 
            return Jsi_LogError("Invalid array length");
        target->d.obj->isarrlist = 1;
        if (Jsi_ObjArraySizer(interp, target->d.obj, len) <= 0)
            return JSI_ERROR;
    } else {
    
        int i;
        target->d.obj->isarrlist = 1;
        if (Jsi_ObjArraySizer(interp, target->d.obj, 0) <= 0)
                return JSI_ERROR;
        
        for (i = 0; i < argc; ++i) {
            Jsi_Value *argv = Jsi_ValueArrayIndex(interp, args, i);   ;
            Jsi_ValueInsertArray(interp, _this, i, argv, 0);
        }
    }
    if (iscons)
        Jsi_ValueDup2(interp, ret, target);
    return JSI_OK;
}
