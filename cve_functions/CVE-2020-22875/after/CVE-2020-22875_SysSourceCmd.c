static Jsi_RC SysSourceCmd(Jsi_Interp *interp, Jsi_Value *args, Jsi_Value *_this,
    Jsi_Value **ret, Jsi_Func *funcPtr)
{
    jsi_Pstate *ps = interp->ps;
    Jsi_RC rc = JSI_OK;
    int flags = 0;
    int i, argc;
    SourceData data = {.trace = interp->debugOpts.includeTrace, .once = interp->debugOpts.includeOnce};
    Jsi_Value *v, *va = Jsi_ValueArrayIndex(interp, args, 0);
    Jsi_Value *vo = Jsi_ValueArrayIndex(interp, args, 1);
    if (vo) {
        if (!Jsi_ValueIsObjType(interp, vo, JSI_OT_OBJECT)) { /* Future options. */
            Jsi_LogError("arg2: expected object 'options'");
            return JSI_ERROR;
        }
        if (Jsi_OptionsProcess(interp, SourceOptions, &data, vo, 0) < 0) {
            return JSI_ERROR;
        }
        if (data.autoIndex)
            flags |= JSI_EVAL_AUTOINDEX;
    }
    if ((interp->includeDepth+1) > interp->maxIncDepth) 
        return Jsi_LogError("max source depth exceeded");
    if (data.once)
        flags|= JSI_EVAL_ONCE;
    if (data.exists)
        flags|= JSI_EVAL_EXISTS;
    if (data.noError)
        flags|= JSI_EVAL_ERRIGNORE;
    if (data.global) {
        flags|= JSI_EVAL_GLOBAL;
        if (data.level)
            return Jsi_LogError("invalid ot specify both global and level");
    } else if (!data.level)
        data.level = interp->framePtr->level;
    interp->includeCnt++;
    interp->includeDepth++;
    int oisi = interp->isMain;
    interp->isMain = data.isMain;
    const char *sop = (data.once?" <ONCE>":"");
    if (!Jsi_ValueIsArray(interp, va)) {
        v = va;
        if (v && Jsi_ValueIsString(interp,v)) {
            if (data.trace)
                Jsi_LogInfo("sourcing: %s%s", Jsi_ValueString(interp, v, 0), sop);
            rc = jsi_evalStrFile(ps->interp, v, NULL, flags, data.level);
        } else {
            Jsi_LogError("expected string");
            rc = JSI_ERROR;
        }
        goto done;
    }
    argc = Jsi_ValueGetLength(interp, va);
    for (i=0; i<argc && rc == JSI_OK; i++) {
        v = Jsi_ValueArrayIndex(interp, va, i);
        if (v && Jsi_ValueIsString(interp,v)) {
            if (data.trace)
                Jsi_LogInfo("sourcing: %s%s", Jsi_ValueString(interp, v, 0), sop);
            rc = jsi_evalStrFile(ps->interp, v, 0, flags, data.level);
        } else {
            Jsi_LogError("expected string");
            rc = JSI_ERROR;
            break;
        }
    }
done:
    if (rc == JSI_OK)
        Jsi_ValueCopy(interp, *ret, interp->retValue);
    interp->isMain = oisi;
    interp->includeDepth--;
    return rc;
}
