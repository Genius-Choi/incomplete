    unsigned int EexecDecode   (unsigned char** cursor, unsigned char* limit, unsigned char* buffer, unsigned int n, unsigned short* seed )
    {
        unsigned char*  p;
        unsigned int r;
        unsigned int s = *seed;

        p = *cursor;
        if ( n > (unsigned int)(limit - p) )
          n = (unsigned int)(limit - p);

        for ( r = 0; r < n; r++ )
        {
          unsigned int  val = p[r];
          unsigned int  b   = ( val ^ ( s >> 8 ) );


          s         = ( (val + s)*52845U + 22719 ) & 0xFFFFU;
          buffer[r] = (unsigned char) b;
        }

        *cursor = p + n;
        *seed   = (unsigned short)s;

        return r;
      }
