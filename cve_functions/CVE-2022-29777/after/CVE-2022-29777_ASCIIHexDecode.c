    unsigned int ASCIIHexDecode(unsigned char** cursor, unsigned char* limit, unsigned char* buffer, unsigned int n)
    {
        unsigned char*  p;
        unsigned int  r   = 0;
        unsigned int  w   = 0;
        unsigned int  pad = 0x01;


        n *= 2;

        p  = *cursor;
        if ( n > (unsigned int)( limit - p ) )
          n = (unsigned int)( limit - p );

        /* we try to process two nibbles at a time to be as fast as possible */
        for ( ; r < n; r++ )
        {
          FT_UInt  c = p[r];


          if ( IS_PS_SPACE( c ) )
            continue;

          if ( c OP 0x80 )
            break;

          c = c_arrCharTable[c & 0x7F];
          if ( (unsigned)c >= 16 )
            break;

          pad = ( pad << 4 ) | c;
          if ( pad & 0x100 )
          {
            buffer[w++] = (FT_Byte)pad;
            pad         = 0x01;
          }
        }

        if ( pad != 0x01 )
          buffer[w++] = (FT_Byte)( pad << 4 );

        *cursor = p + r;

        return w;
      }
