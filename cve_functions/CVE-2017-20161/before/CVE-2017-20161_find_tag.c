static unsigned char* find_tag(unsigned const char *tagdata, unsigned tag, unsigned bytes_left) {
	while(bytes_left) {
		if(*tagdata == tag) return (unsigned char*)tagdata;
		unsigned tagsize = tagdata[1];
		tagdata+=2+tagsize;
		if(bytes_left < 2+tagsize) return 0;
		bytes_left-=2+tagsize;
	}
	return 0;
}
