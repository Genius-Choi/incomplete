static int session_attach_stream_item(nghttp2_session *session,
                                      nghttp2_stream *stream,
                                      nghttp2_outbound_item *item) {
  int rv;

  rv = nghttp2_stream_attach_item(stream, item);
  if (rv != 0) {
    return rv;
  }

  if (!(stream->flags & NGHTTP2_STREAM_FLAG_NO_RFC7540_PRIORITIES)) {
    return 0;
  }

  rv = session_ob_data_push(session, stream);
  if (rv != 0) {
    nghttp2_stream_detach_item(stream);

    return rv;
  }

  return 0;
}
