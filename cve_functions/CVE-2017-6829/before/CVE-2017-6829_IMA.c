IMA::IMA(Mode mode, Track *track, File *fh, bool canSeek) :
	BlockCodec(mode, track, fh, canSeek),
	m_imaType(0)
{
	AUpvlist pv = (AUpvlist) track->f.compressionParams;

	m_framesPerPacket = track->f.framesPerPacket;
	m_bytesPerPacket = track->f.bytesPerPacket;

	long l;
	if (_af_pv_getlong(pv, _AF_IMA_ADPCM_TYPE, &l))
		m_imaType = l;

	m_adpcmState = new adpcmState[track->f.channelCount];
}
