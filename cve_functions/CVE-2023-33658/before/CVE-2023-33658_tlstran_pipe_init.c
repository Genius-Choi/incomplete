tlstran_pipe_init(void *arg, nni_pipe *npipe)
{
	log_trace("************tlstran_pipe_init************");
	tlstran_pipe *p = arg;

	nni_pipe_set_conn_param(npipe, p->tcp_cparam);
	p->npipe    = npipe;

	if (!p->conf->sqlite.enable) {
		nni_qos_db_init_id_hash(npipe->nano_qos_db);
	}

	p->conn_buf = NULL;
	p->busy     = false;

	nni_lmq_init(&p->rslmq, 16);
	p->qos_buf = nng_zalloc(16 + NNI_NANO_MAX_PACKET_SIZE);
	return (0);
}
