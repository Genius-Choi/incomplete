media(pbelle_sdpParser ctx)
{
    belle_sdpParser_media_return retval;


    pANTLR3_BASE_TREE root_0;

    pANTLR3_COMMON_TOKEN    EQUAL228;
    pANTLR3_COMMON_TOKEN    SPACE230;
    pANTLR3_COMMON_TOKEN    SLASH232;
    pANTLR3_COMMON_TOKEN    SPACE234;
    pANTLR3_COMMON_TOKEN    SPACE236;
    belle_sdpParser_alpha_num_return alpha_num227;
    #undef	RETURN_TYPE_alpha_num227
    #define	RETURN_TYPE_alpha_num227 belle_sdpParser_alpha_num_return

    belle_sdpParser_media_value_return media_value229;
    #undef	RETURN_TYPE_media_value229
    #define	RETURN_TYPE_media_value229 belle_sdpParser_media_value_return

    belle_sdpParser_port_return port231;
    #undef	RETURN_TYPE_port231
    #define	RETURN_TYPE_port231 belle_sdpParser_port_return

    belle_sdpParser_integer_return integer233;
    #undef	RETURN_TYPE_integer233
    #define	RETURN_TYPE_integer233 belle_sdpParser_integer_return

    belle_sdpParser_proto_return proto235;
    #undef	RETURN_TYPE_proto235
    #define	RETURN_TYPE_proto235 belle_sdpParser_proto_return

    belle_sdpParser_fmt_return fmt237;
    #undef	RETURN_TYPE_fmt237
    #define	RETURN_TYPE_fmt237 belle_sdpParser_fmt_return

    pANTLR3_BASE_TREE EQUAL228_tree;
    pANTLR3_BASE_TREE SPACE230_tree;
    pANTLR3_BASE_TREE SLASH232_tree;
    pANTLR3_BASE_TREE SPACE234_tree;
    pANTLR3_BASE_TREE SPACE236_tree;

    /* Initialize rule variables
     */
    ctx->pbelle_sdpParser_mediaTop = pbelle_sdpParser_mediaPush(ctx);
    root_0 = NULL;

    (SCOPE_TOP(media))->current= belle_sdp_media_new(); 
    retval.ret=(SCOPE_TOP(media))->current;
     
    EQUAL228       = NULL;
    SPACE230       = NULL;
    SLASH232       = NULL;
    SPACE234       = NULL;
    SPACE236       = NULL;
    alpha_num227.tree = NULL;

    media_value229.tree = NULL;

    port231.tree = NULL;

    integer233.tree = NULL;

    proto235.tree = NULL;

    fmt237.tree = NULL;
    retval.start = LT(1); retval.stop = retval.start;


    EQUAL228_tree   = NULL;
    SPACE230_tree   = NULL;
    SLASH232_tree   = NULL;
    SPACE234_tree   = NULL;
    SPACE236_tree   = NULL;


    retval.tree  = NULL;

    {
        // ../grammars/belle_sdp.g:422:11: ({...}? alpha_num EQUAL media_value SPACE port ( SLASH integer )? SPACE proto ( SPACE fmt )+ )
        // ../grammars/belle_sdp.g:422:11: {...}? alpha_num EQUAL media_value SPACE port ( SLASH integer )? SPACE proto ( SPACE fmt )+
        {
            root_0 = (pANTLR3_BASE_TREE)(ADAPTOR->nilNode(ADAPTOR));


            if ( !((IS_TOKEN(m))) )
            {
                if (BACKTRACKING>0)
                {
                    FAILEDFLAG = ANTLR3_TRUE;
                    pbelle_sdpParser_mediaPop(ctx);

                    return retval;
                }

                    CONSTRUCTEX();
                    EXCEPTION->type         = ANTLR3_FAILED_PREDICATE_EXCEPTION;
                    EXCEPTION->message      = (void *)"IS_TOKEN(m)";
                    EXCEPTION->ruleName	 = (void *)"media";


            }

            FOLLOWPUSH(FOLLOW_alpha_num_in_media2469);
            alpha_num227=alpha_num(ctx);

            FOLLOWPOP();
            if  (HASEXCEPTION())
            {
                goto rulemediaEx;
            }
            if (HASFAILED())
            {
                pbelle_sdpParser_mediaPop(ctx);

                return retval;
            }

            if ( BACKTRACKING==0 ) ADAPTOR->addChild(ADAPTOR, root_0, alpha_num227.tree);

            EQUAL228 = (pANTLR3_COMMON_TOKEN) MATCHT(EQUAL, &FOLLOW_EQUAL_in_media2471);
            if  (HASEXCEPTION())
            {
                goto rulemediaEx;
            }
            if (HASFAILED())
            {
                pbelle_sdpParser_mediaPop(ctx);

                return retval;
            }

            if ( BACKTRACKING==0 ) {
            EQUAL228_tree = (pANTLR3_BASE_TREE)(ADAPTOR->create(ADAPTOR, EQUAL228));
            ADAPTOR->addChild(ADAPTOR, root_0, EQUAL228_tree);
            }

            FOLLOWPUSH(FOLLOW_media_value_in_media2483);
            media_value229=media_value(ctx);

            FOLLOWPOP();
            if  (HASEXCEPTION())
            {
                goto rulemediaEx;
            }
            if (HASFAILED())
            {
                pbelle_sdpParser_mediaPop(ctx);

                return retval;
            }

            if ( BACKTRACKING==0 ) ADAPTOR->addChild(ADAPTOR, root_0, media_value229.tree);

            if ( BACKTRACKING==0 )
            {
                belle_sdp_media_set_media_type((SCOPE_TOP(media))->current,(const char*)
                (STRSTREAM->toStringTT(STRSTREAM, media_value229.start, media_value229.stop))
                ->chars);
            }


            SPACE230 = (pANTLR3_COMMON_TOKEN) MATCHT(SPACE, &FOLLOW_SPACE_in_media2497);
            if  (HASEXCEPTION())
            {
                goto rulemediaEx;
            }
            if (HASFAILED())
            {
                pbelle_sdpParser_mediaPop(ctx);

                return retval;
            }

            if ( BACKTRACKING==0 ) {
            SPACE230_tree = (pANTLR3_BASE_TREE)(ADAPTOR->create(ADAPTOR, SPACE230));
            ADAPTOR->addChild(ADAPTOR, root_0, SPACE230_tree);
            }

            FOLLOWPUSH(FOLLOW_port_in_media2499);
            port231=port(ctx);

            FOLLOWPOP();
            if  (HASEXCEPTION())
            {
                goto rulemediaEx;
            }
            if (HASFAILED())
            {
                pbelle_sdpParser_mediaPop(ctx);

                return retval;
            }

            if ( BACKTRACKING==0 ) ADAPTOR->addChild(ADAPTOR, root_0, port231.tree);

            if ( BACKTRACKING==0 )
            {
                belle_sdp_media_set_media_port((SCOPE_TOP(media))->current,atoi((const char*)
                (STRSTREAM->toStringTT(STRSTREAM, port231.start, port231.stop))
                ->chars));
            }


            // ../grammars/belle_sdp.g:425:11: ( SLASH integer )?
            {
                int alt48=2;
                switch ( LA(1) )
                {
                    case SLASH:
                    	{
                    		alt48=1;
                    	}
                        break;
                }

                switch (alt48)
                {
            	case 1:
            	    // ../grammars/belle_sdp.g:425:12: SLASH integer
            	    {
            	        SLASH232 = (pANTLR3_COMMON_TOKEN) MATCHT(SLASH, &FOLLOW_SLASH_in_media2514);
            	        if  (HASEXCEPTION())
            	        {
            	            goto rulemediaEx;
            	        }
            	        if (HASFAILED())
            	        {
            	            pbelle_sdpParser_mediaPop(ctx);

            	            return retval;
            	        }

            	        if ( BACKTRACKING==0 ) {
            	        SLASH232_tree = (pANTLR3_BASE_TREE)(ADAPTOR->create(ADAPTOR, SLASH232));
            	        ADAPTOR->addChild(ADAPTOR, root_0, SLASH232_tree);
            	        }

            	        FOLLOWPUSH(FOLLOW_integer_in_media2516);
            	        integer233=integer(ctx);

            	        FOLLOWPOP();
            	        if  (HASEXCEPTION())
            	        {
            	            goto rulemediaEx;
            	        }
            	        if (HASFAILED())
            	        {
            	            pbelle_sdpParser_mediaPop(ctx);

            	            return retval;
            	        }

            	        if ( BACKTRACKING==0 ) ADAPTOR->addChild(ADAPTOR, root_0, integer233.tree);

            	        if ( BACKTRACKING==0 )
            	        {
            	            belle_sdp_media_set_port_count((SCOPE_TOP(media))->current,atoi((const char*)
            	            (STRSTREAM->toStringTT(STRSTREAM, integer233.start, integer233.stop))
            	            ->chars));
            	        }


            	    }
            	    break;

                }
            }

            SPACE234 = (pANTLR3_COMMON_TOKEN) MATCHT(SPACE, &FOLLOW_SPACE_in_media2531);
            if  (HASEXCEPTION())
            {
                goto rulemediaEx;
            }
            if (HASFAILED())
            {
                pbelle_sdpParser_mediaPop(ctx);

                return retval;
            }

            if ( BACKTRACKING==0 ) {
            SPACE234_tree = (pANTLR3_BASE_TREE)(ADAPTOR->create(ADAPTOR, SPACE234));
            ADAPTOR->addChild(ADAPTOR, root_0, SPACE234_tree);
            }

            FOLLOWPUSH(FOLLOW_proto_in_media2533);
            proto235=proto(ctx);

            FOLLOWPOP();
            if  (HASEXCEPTION())
            {
                goto rulemediaEx;
            }
            if (HASFAILED())
            {
                pbelle_sdpParser_mediaPop(ctx);

                return retval;
            }

            if ( BACKTRACKING==0 ) ADAPTOR->addChild(ADAPTOR, root_0, proto235.tree);

            if ( BACKTRACKING==0 )
            {
                belle_sdp_media_set_protocol((SCOPE_TOP(media))->current,(const char*)
                (STRSTREAM->toStringTT(STRSTREAM, proto235.start, proto235.stop))
                ->chars);
            }


            // ../grammars/belle_sdp.g:427:11: ( SPACE fmt )+
            {
                int cnt49=0;

                for (;;)
                {
                    int alt49=2;
            	switch ( LA(1) )
            	{
            	case SPACE:
            		{
            			alt49=1;
            		}
            	    break;

            	}

            	switch (alt49)
            	{
            	    case 1:
            	        // ../grammars/belle_sdp.g:427:12: SPACE fmt
            	        {
            	            SPACE236 = (pANTLR3_COMMON_TOKEN) MATCHT(SPACE, &FOLLOW_SPACE_in_media2548);
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulemediaEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                pbelle_sdpParser_mediaPop(ctx);

            	                return retval;
            	            }

            	            if ( BACKTRACKING==0 ) {
            	            SPACE236_tree = (pANTLR3_BASE_TREE)(ADAPTOR->create(ADAPTOR, SPACE236));
            	            ADAPTOR->addChild(ADAPTOR, root_0, SPACE236_tree);
            	            }

            	            FOLLOWPUSH(FOLLOW_fmt_in_media2550);
            	            fmt237=fmt(ctx);

            	            FOLLOWPOP();
            	            if  (HASEXCEPTION())
            	            {
            	                goto rulemediaEx;
            	            }
            	            if (HASFAILED())
            	            {
            	                pbelle_sdpParser_mediaPop(ctx);

            	                return retval;
            	            }

            	            if ( BACKTRACKING==0 ) ADAPTOR->addChild(ADAPTOR, root_0, fmt237.tree);

            	        }
            	        break;

            	    default:

            		if ( cnt49 >= 1 )
            		{
            		    goto loop49;
            		}
            		if (BACKTRACKING>0)
            		{
            		    FAILEDFLAG = ANTLR3_TRUE;
            		    pbelle_sdpParser_mediaPop(ctx);

            		    return retval;
            		}

            		/* mismatchedSetEx()
            		 */
            		CONSTRUCTEX();
            		EXCEPTION->type = ANTLR3_EARLY_EXIT_EXCEPTION;
            		EXCEPTION->name = (void *)ANTLR3_EARLY_EXIT_NAME;


            		goto rulemediaEx;
            	}
            	cnt49++;
                }
                loop49: ;	/* Jump to here if this rule does not match */
            }

        }

    }

    // This is where rules clean up and exit
    //
    goto rulemediaEx; /* Prevent compiler warnings */
    rulemediaEx: ;
    retval.stop = LT(-1);


    if ( BACKTRACKING==0 )
    {

    	retval.stop = LT(-1);

    	retval.tree = (pANTLR3_BASE_TREE)(ADAPTOR->rulePostProcessing(ADAPTOR, root_0));
    	ADAPTOR->setTokenBoundaries(ADAPTOR, retval.tree, retval.start, retval.stop);
    }


    if	(HASEXCEPTION())
    {
	/* catch(decl,action)
	 */
	{

	    	ANTLR3_LOG_EXCEPTION();
	      belle_sip_object_unref(retval.ret
	    );
	      retval.ret=NULL;


	}


    }
    else
    {
    }
    pbelle_sdpParser_mediaPop(ctx);

    return retval;
}
