common_response(pbelle_sip_messageParser ctx)
{
    belle_sip_message_t* ret;


    pANTLR3_COMMON_TOKEN    last_crlf;
    belle_sip_response_t* status_line11;
    #undef	RETURN_TYPE_status_line11
    #define	RETURN_TYPE_status_line11 belle_sip_response_t*

    belle_http_response_t* http_status_line12;
    #undef	RETURN_TYPE_http_status_line12
    #define	RETURN_TYPE_http_status_line12 belle_http_response_t*

    /* Initialize rule variables
     */
    ret = NULL;


    last_crlf       = NULL;

    {
        // ../grammars/belle_sip_message.g:222:3: ( ( ( sip_version (~ ( CRLF ) )* CRLF )=> status_line | ( http_version (~ ( CRLF ) )* CRLF )=> http_status_line ) ( ( message_header[BELLE_SIP_MESSAGE($ret)] )+ last_crlf= CRLF )? )
        // ../grammars/belle_sip_message.g:222:7: ( ( sip_version (~ ( CRLF ) )* CRLF )=> status_line | ( http_version (~ ( CRLF ) )* CRLF )=> http_status_line ) ( ( message_header[BELLE_SIP_MESSAGE($ret)] )+ last_crlf= CRLF )?
        {
            // ../grammars/belle_sip_message.g:222:7: ( ( sip_version (~ ( CRLF ) )* CRLF )=> status_line | ( http_version (~ ( CRLF ) )* CRLF )=> http_status_line )
            {
                int alt6=2;
                alt6 = cdfa6.predict(ctx, RECOGNIZER, ISTREAM, &cdfa6);
                if  (HASEXCEPTION())
                {
                    goto rulecommon_responseEx;
                }
                if (HASFAILED())
                {
                    return ret;
                }

                switch (alt6)
                {
            	case 1:
            	    // ../grammars/belle_sip_message.g:222:11: ( sip_version (~ ( CRLF ) )* CRLF )=> status_line
            	    {
            	        FOLLOWPUSH(FOLLOW_status_line_in_common_response533);
            	        status_line11=status_line(ctx);

            	        FOLLOWPOP();
            	        if  (HASEXCEPTION())
            	        {
            	            goto rulecommon_responseEx;
            	        }
            	        if (HASFAILED())
            	        {
            	            return ret;
            	        }


            	        if ( BACKTRACKING==0 )
            	        {
            	            ret=BELLE_SIP_MESSAGE(
            	            status_line11
            	            );

            	        }


            	    }
            	    break;
            	case 2:
            	    // ../grammars/belle_sip_message.g:223:11: ( http_version (~ ( CRLF ) )* CRLF )=> http_status_line
            	    {
            	        FOLLOWPUSH(FOLLOW_http_status_line_in_common_response564);
            	        http_status_line12=http_status_line(ctx);

            	        FOLLOWPOP();
            	        if  (HASEXCEPTION())
            	        {
            	            goto rulecommon_responseEx;
            	        }
            	        if (HASFAILED())
            	        {
            	            return ret;
            	        }


            	        if ( BACKTRACKING==0 )
            	        {
            	            ret=BELLE_SIP_MESSAGE(
            	            http_status_line12
            	            );

            	        }


            	    }
            	    break;

                }
            }

            // ../grammars/belle_sip_message.g:224:3: ( ( message_header[BELLE_SIP_MESSAGE($ret)] )+ last_crlf= CRLF )?
            {
                int alt8=2;
                switch ( LA(1) )
                {
                    case BQUOTE:
                    case COMMON_CHAR:
                    case DASH:
                    case DIGIT:
                    case DOT:
                    case EMARK:
                    case HEX_CHAR:
                    case LPAREN:
                    case PERCENT:
                    case PLUS:
                    case RPAREN:
                    case SQUOTE:
                    case STAR:
                    case TILDE:
                    case USCORE:
                    	{
                    		alt8=1;
                    	}
                        break;
                }

                switch (alt8)
                {
            	case 1:
            	    // ../grammars/belle_sip_message.g:224:4: ( message_header[BELLE_SIP_MESSAGE($ret)] )+ last_crlf= CRLF
            	    {
            	        // ../grammars/belle_sip_message.g:224:4: ( message_header[BELLE_SIP_MESSAGE($ret)] )+
            	        {
            	            int cnt7=0;

            	            for (;;)
            	            {
            	                int alt7=2;
            	        	switch ( LA(1) )
            	        	{
            	        	case BQUOTE:
            	        	case COMMON_CHAR:
            	        	case DASH:
            	        	case DIGIT:
            	        	case DOT:
            	        	case EMARK:
            	        	case HEX_CHAR:
            	        	case LPAREN:
            	        	case PERCENT:
            	        	case PLUS:
            	        	case RPAREN:
            	        	case SQUOTE:
            	        	case STAR:
            	        	case TILDE:
            	        	case USCORE:
            	        		{
            	        			alt7=1;
            	        		}
            	        	    break;

            	        	}

            	        	switch (alt7)
            	        	{
            	        	    case 1:
            	        	        // ../grammars/belle_sip_message.g:224:4: message_header[BELLE_SIP_MESSAGE($ret)]
            	        	        {
            	        	            FOLLOWPUSH(FOLLOW_message_header_in_common_response571);
            	        	            message_header(ctx, BELLE_SIP_MESSAGE(
            	        	            ret
            	        	            ));

            	        	            FOLLOWPOP();
            	        	            if  (HASEXCEPTION())
            	        	            {
            	        	                goto rulecommon_responseEx;
            	        	            }
            	        	            if (HASFAILED())
            	        	            {
            	        	                return ret;
            	        	            }


            	        	        }
            	        	        break;

            	        	    default:

            	        		if ( cnt7 >= 1 )
            	        		{
            	        		    goto loop7;
            	        		}
            	        		if (BACKTRACKING>0)
            	        		{
            	        		    FAILEDFLAG = ANTLR3_TRUE;
            	        		    return ret;
            	        		}

            	        		/* mismatchedSetEx()
            	        		 */
            	        		CONSTRUCTEX();
            	        		EXCEPTION->type = ANTLR3_EARLY_EXIT_EXCEPTION;
            	        		EXCEPTION->name = (void *)ANTLR3_EARLY_EXIT_NAME;


            	        		goto rulecommon_responseEx;
            	        	}
            	        	cnt7++;
            	            }
            	            loop7: ;	/* Jump to here if this rule does not match */
            	        }

            	        last_crlf = (pANTLR3_COMMON_TOKEN) MATCHT(CRLF, &FOLLOW_CRLF_in_common_response577);
            	        if  (HASEXCEPTION())
            	        {
            	            goto rulecommon_responseEx;
            	        }
            	        if (HASFAILED())
            	        {
            	            return ret;
            	        }


            	        if ( BACKTRACKING==0 )
            	        {
            	            *((SCOPE_TOP(message_raw))->message_length)=last_crlf->user1;
            	        }


            	    }
            	    break;

                }
            }

        }

    }

    // This is where rules clean up and exit
    //
    goto rulecommon_responseEx; /* Prevent compiler warnings */
    rulecommon_responseEx: ;


                if (HASEXCEPTION())
                {

                // This is ugly.  We set the exception type to ANTLR3_RECOGNITION_EXCEPTION so we can always
                // catch them.
                //PREPORTERROR();
                EXCEPTION->type = ANTLR3_RECOGNITION_EXCEPTION;
                }

    return ret;
}
