format_list_item(int16_t *ff, char *buff, BOOL isscript)
{
int count;
int maxi = 0;
const char *maxs = "";
size_t max = 0;

for (count = 0; ff[count] >= 0; count++) {}

/* Find the name to put first. For scripts, any 3-character name is chosen.
For non-scripts, or if there is no 3-character name, take the longest. */

for (int i = 0; ff[i] >= 0; i++)
  {
  const char *s = PRIV(utt_names) + ff[i];
  size_t len = strlen(s);
  if (isscript && len == 3)
    {
    maxi = i;
    max = len;
    maxs = s;
    break;
    }
  else if (len > max)
    {
    max = len;
    maxi = i;
    maxs = s;
    }
  }

strcpy(buff, maxs);
buff += max;

if (count > 1)
  {
  const char *sep = " (";
  for (int i = 0; i < count; i++)
    {
    if (i == maxi) continue;
    buff += sprintf(buff, "%s%s", sep, PRIV(utt_names) + ff[i]);
    sep = ", ";
    }
  (void)sprintf(buff, ")");
  }
}
