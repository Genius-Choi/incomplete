display_properties(BOOL wantscripts)
{
#ifndef SUPPORT_UNICODE
(void)wantscripts;
printf("** This version of PCRE2 was compiled without Unicode support.\n");
#else

const char *typename;
uint16_t seentypes[1024];
uint16_t seenvalues[1024];
int seencount = 0;
int16_t found[256][MAX_SYNONYMS + 1];
int fc = 0;
int colwidth = 40;
int n;

if (wantscripts)
  {
  n = ucp_Script_Count;
  typename = "SCRIPTS";
  }
else
  {
  n = ucp_Bprop_Count;
  typename = "PROPERTIES";
  }

for (size_t i = 0; i < PRIV(utt_size); i++)
  {
  int k;
  int m = 0;
  int16_t *fv;
  const ucp_type_table *t = PRIV(utt) + i;
  unsigned int value = t->value;

  if (wantscripts)
    {
    if (t->type != PT_SC && t->type != PT_SCX) continue;
    }
  else
    {
    if (t->type != PT_BOOL) continue;
    }

  for (k = 0; k < seencount; k++)
    {
    if (t->type == seentypes[k] && t->value == seenvalues[k]) break;
    }
  if (k < seencount) continue;

  seentypes[seencount] = t->type;
  seenvalues[seencount++] = t->value;

  fv = found[fc++];
  fv[m++] = t->name_offset;

  for (size_t j = i + 1; j < PRIV(utt_size); j++)
    {
    const ucp_type_table *tt = PRIV(utt) + j;
    if (tt->type != t->type || tt->value != value) continue;
    if (m >= MAX_SYNONYMS)
      printf("** Too many synonyms: %s ignored\n",
        PRIV(utt_names) + tt->name_offset);
    else fv[m++] = tt->name_offset;
    }

  fv[m] = -1;
  }

printf("-------------------------- SUPPORTED %s --------------------------\n\n",
  typename);

if (!wantscripts) printf(
"This release of PCRE2 supports Unicode's general category properties such\n"
"as Lu (upper case letter), bi-directional properties such as Bidi_Class,\n"
"and the following binary (yes/no) properties:\n\n");


for (int k = 0; k < (n+1)/2; k++)
  {
  int x;
  char buff1[128];
  char buff2[128];

  format_list_item(found[k], buff1, wantscripts);
  x = k + (n+1)/2;
  if (x < n) format_list_item(found[x], buff2, wantscripts);
    else buff2[0] = 0;

  x = printf("%s", buff1);
  while (x++ < colwidth) printf(" ");
  printf("%s\n", buff2);
  }

#endif  /* SUPPORT_UNICODE */
}
