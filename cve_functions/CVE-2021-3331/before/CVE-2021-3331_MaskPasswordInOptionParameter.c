bool __fastcall TSessionData::MaskPasswordInOptionParameter(const UnicodeString & Option, UnicodeString & Param)
{
  bool Result = false;
  if (SameText(Option, RawSettingsOption))
  {
    int P = Param.Pos(L"=");
    if (P > 0)
    {
      // TStrings.IndexOfName does not trim
      UnicodeString Key = Param.SubString(1, P - 1);

      if (SameText(Key, L"ProxyPassword") ||
          SameText(Key, L"ProxyPasswordEnc") ||
          SameText(Key, L"TunnelPassword") ||
          SameText(Key, L"TunnelPasswordPlain") ||
          SameText(Key, L"EncryptKey"))
      {
        Param = Key + L"=" + PasswordMask;
        Result = true;
      }
    }
  }
  return Result;
}
