std::optional<SignedData> WinCert::as_signed_data() const {
  if (type_ != certificate_type::CERT_TYPE_PKCS_SIGNED_DATA) {
    return std::nullopt;
  }

  try {
    return std::make_optional<SignedData>(cert_buf_);
  } catch (FormatError) {
    return std::nullopt;
  }
}
