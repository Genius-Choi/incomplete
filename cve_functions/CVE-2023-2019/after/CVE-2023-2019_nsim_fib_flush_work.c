static void nsim_fib_flush_work(struct work_struct *work)
{
	struct nsim_fib_data *data = container_of(work, struct nsim_fib_data,
						  fib_flush_work);
	struct nsim_fib_rt *fib_rt, *fib_rt_tmp;

	/* Process pending work. */
	flush_work(&data->fib_event_work);

	mutex_lock(&data->fib_lock);
	list_for_each_entry_safe(fib_rt, fib_rt_tmp, &data->fib_rt_list, list) {
		rhashtable_remove_fast(&data->fib_rt_ht, &fib_rt->ht_node,
				       nsim_fib_rt_ht_params);
		nsim_fib_rt_free(fib_rt, data);
	}
	mutex_unlock(&data->fib_lock);
}
