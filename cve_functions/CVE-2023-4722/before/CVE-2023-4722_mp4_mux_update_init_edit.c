static void mp4_mux_update_init_edit(GF_MP4MuxCtx *ctx, TrackWriter *tkw, u64 min_ts_service, Bool skip_adjust)
{
	//compute offsets
	s64 dts_diff = ctx->tsalign ? gf_timestamp_rescale(min_ts_service, 1000000, tkw->src_timescale) : 0;

	if (!skip_adjust) {
		dts_diff = (s64) tkw->ts_shift - dts_diff;
	}
	if (ctx->is_rewind) dts_diff = -dts_diff;
	//negative could happen due to rounding, ignore them
	if (dts_diff <= (gf_sys_old_arch_compat() ? 0 : 1)) return;

	// dts_diff > 0, we need to delay the track
	u64 dur = gf_timestamp_rescale(dts_diff, tkw->src_timescale, ctx->moovts);
	if (dur) {
		gf_isom_remove_edits(ctx->file, tkw->track_num);

		gf_isom_set_edit(ctx->file, tkw->track_num, 0, dur, dts_diff, GF_ISOM_EDIT_EMPTY);
		gf_isom_set_edit(ctx->file, tkw->track_num, dur, 0, 0, GF_ISOM_EDIT_NORMAL);
		tkw->empty_init_dur = (u64) dur;
	}
}
