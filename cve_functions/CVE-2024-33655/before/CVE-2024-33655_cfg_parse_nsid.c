uint8_t* cfg_parse_nsid(const char* str, uint16_t* nsid_len)
{
	uint8_t* nsid = NULL;

	if (strncasecmp(str, "ascii_", 6) == 0) {
		if ((nsid = (uint8_t *)strdup(str + 6)))
			*nsid_len = strlen(str + 6);

	} else if (strlen(str) % 2) {
		; /* hex string has even number of characters */
	}

	else if (*str && (nsid = calloc(1, strlen(str) / 2))) {
		const char *ch;
		uint8_t *dp;

		for ( ch = str, dp = nsid
		    ; isxdigit(ch[0]) && isxdigit(ch[1])
		    ; ch += 2, dp++) {
			*dp  = (uint8_t)sldns_hexdigit_to_int(ch[0]) * 16;
			*dp += (uint8_t)sldns_hexdigit_to_int(ch[1]);
		}
		if (*ch) {
			free(nsid);
			nsid = NULL;
		} else
			*nsid_len = strlen(str) / 2;
	}
	return nsid;
}
