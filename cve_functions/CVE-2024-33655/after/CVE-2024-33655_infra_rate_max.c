int infra_rate_max(void* data, time_t now, int backoff)
{
	struct rate_data* d = (struct rate_data*)data;
	int i, max = 0;
	for(i=0; i<RATE_WINDOW; i++) {
		if(backoff) {
			if(now-d->timestamp[i] <= RATE_WINDOW &&
				d->qps[i] > max) {
				max = d->qps[i];
			}
		} else {
			if(now == d->timestamp[i]) {
				return d->qps[i];
			}
		}
	}
	return max;
}
