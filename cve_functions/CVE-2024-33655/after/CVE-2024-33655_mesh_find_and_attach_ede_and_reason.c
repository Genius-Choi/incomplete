mesh_find_and_attach_ede_and_reason(struct mesh_state* m,
	struct reply_info* rep, struct mesh_reply* r)
{
	/* OLD note:
	 * During validation the EDE code can be received via two
	 * code paths. One code path fills the reply_info EDE, and
	 * the other fills it in the errinf_strlist. These paths
	 * intersect at some points, but where is opaque due to
	 * the complexity of the validator. At the time of writing
	 * we make the choice to prefer the EDE from errinf_strlist
	 * but a compelling reason to do otherwise is just as valid
	 * NEW note:
	 * The compelling reason is that with caching support, the value
	 * in the reply_info is cached.
	 * The reason members of the reply_info struct should be
	 * updated as they are already cached. No reason to
	 * try and find the EDE information in errinf anymore.
	 */
	if(rep->reason_bogus != LDNS_EDE_NONE) {
		edns_opt_list_append_ede(&r->edns.opt_list_out,
			m->s.region, rep->reason_bogus, rep->reason_bogus_str);
	}
}
