void NppParameters::writeStyle2Element(const Style & style2Write, Style & style2Sync, TiXmlElement *element)
{
	if (HIBYTE(HIWORD(style2Write._fgColor)) != 0xFF)
	{
		int rgbVal = RGB2int(style2Write._fgColor);
		TCHAR fgStr[7];
		wsprintf(fgStr, TEXT("%.6X"), rgbVal);
		element->SetAttribute(TEXT("fgColor"), fgStr);
	}

	if (HIBYTE(HIWORD(style2Write._bgColor)) != 0xFF)
	{
		int rgbVal = RGB2int(style2Write._bgColor);
		TCHAR bgStr[7];
		wsprintf(bgStr, TEXT("%.6X"), rgbVal);
		element->SetAttribute(TEXT("bgColor"), bgStr);
	}

	if (style2Write._colorStyle != COLORSTYLE_ALL)
	{
		element->SetAttribute(TEXT("colorStyle"), style2Write._colorStyle);
	}

	if (!style2Write._fontName.empty())
	{
		const TCHAR * oldFontName = element->Attribute(TEXT("fontName"));
		if (oldFontName && oldFontName != style2Write._fontName)
		{
			element->SetAttribute(TEXT("fontName"), style2Write._fontName);
			style2Sync._fontName = style2Write._fontName;
		}
	}

	if (style2Write._fontSize != STYLE_NOT_USED)
	{
		if (!style2Write._fontSize)
			element->SetAttribute(TEXT("fontSize"), TEXT(""));
		else
			element->SetAttribute(TEXT("fontSize"), style2Write._fontSize);
	}

	if (style2Write._fontStyle != STYLE_NOT_USED)
	{
		element->SetAttribute(TEXT("fontStyle"), style2Write._fontStyle);
	}


	if (!style2Write._keywords.empty())
	{
		TiXmlNode *teteDeNoeud = element->LastChild();

		if (teteDeNoeud)
			teteDeNoeud->SetValue(style2Write._keywords.c_str());
		else
			element->InsertEndChild(TiXmlText(style2Write._keywords.c_str()));
	}
}
