is_route_rule_present(const NetplanNetDefinition* netdef, const NetplanIPRule* rule)
{
    const GArray* rules = netdef->ip_rules;

    for (guint i = 0; i < rules->len; i++) {
        const NetplanIPRule* entry = g_array_index(rules, NetplanIPRule*, i);
        if (
                entry->family == rule->family &&
                g_strcmp0(entry->from, rule->from) == 0 &&
                g_strcmp0(entry->to, rule->to) == 0 &&
                entry->table == rule->table &&
                entry->priority == rule->priority &&
                entry->fwmark == rule->fwmark &&
                entry->tos == rule->tos
           )
            return TRUE;
    }

    return FALSE;
}
