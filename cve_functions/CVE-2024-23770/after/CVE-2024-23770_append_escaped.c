static void append_escaped(struct apbuf *dst, const char *src) {
    int pos = 0;
    while (src[pos] != '\0') {
        switch (src[pos]) {
            case '<':
                append(dst, "&lt;");
                break;
            case '>':
                append(dst, "&gt;");
                break;
            case '&':
                append(dst, "&amp;");
                break;
            case '\'':
                append(dst, "&apos;");
                break;
            case '"':
                append(dst, "&quot;");
                break;
            default:
                appendl(dst, src+pos, 1);
        }
        pos++;
    }
}
