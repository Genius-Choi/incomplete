RepoOptions::RepoOptions(const char* file) : m_path(file) {
  always_assert(s_init);
  Hdf config{file};
  Hdf parserConfig = config["Parser"];

#define N(_, n, ...) hdfExtract(parserConfig, #n, n, s_defaults.n);
#define P(_, n, ...) hdfExtract(parserConfig, "PHP7." #n, n, s_defaults.n);
#define H(_, n, ...) hdfExtract(parserConfig, "Hack.Lang." #n, n, s_defaults.n);
#define E(_, n, ...) hdfExtract(parserConfig, "Eval." #n, n, s_defaults.n);
PARSERFLAGS();
#undef N
#undef P
#undef H
#undef E

  Hdf autoloadConfig = config["Autoload"];
#define N(_, n, ...) hdfExtract(autoloadConfig, #n, n, s_defaults.n);
#define P(_, n, ...) hdfExtract(autoloadConfig, "PHP7." #n, n, s_defaults.n);
#define H(_, n, ...) hdfExtract(autoloadConfig, "Hack.Lang." #n, n, \
                                s_defaults.n);
#define E(_, n, ...) hdfExtract(autoloadConfig, "Eval." #n, n, s_defaults.n);
AUTOLOADFLAGS();
#undef N
#undef P
#undef H
#undef E

  filterNamespaces();
}
