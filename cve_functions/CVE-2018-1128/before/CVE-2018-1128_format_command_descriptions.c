void Monitor::format_command_descriptions(const std::vector<MonCommand> &commands,
					  Formatter *f,
					  bufferlist *rdata,
					  bool hide_mgr_flag)
{
  int cmdnum = 0;
  f->open_object_section("command_descriptions");
  for (const auto &cmd : commands) {
    unsigned flags = cmd.flags;
    if (hide_mgr_flag) {
      flags &= ~MonCommand::FLAG_MGR;
    }
    ostringstream secname;
    secname << "cmd" << setfill('0') << std::setw(3) << cmdnum;
    dump_cmddesc_to_json(f, secname.str(),
			 cmd.cmdstring, cmd.helpstring, cmd.module,
			 cmd.req_perms, cmd.availability, flags);
    cmdnum++;
  }
  f->close_section();	// command_descriptions

  f->flush(*rdata);
}
