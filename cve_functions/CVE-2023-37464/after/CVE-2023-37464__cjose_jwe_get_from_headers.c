static const char *_cjose_jwe_get_from_headers(cjose_header_t *protected_header,
                                               cjose_header_t *unprotected_header,
                                               cjose_header_t *personal_header,
                                               const char *key)
{

    // TODO: https://github.com/cisco/cjose/issues/52
    cjose_header_t *headers[] = { personal_header, unprotected_header, protected_header };

    for (int i = 0; i < 3; i++)
    {
        if (NULL == headers[i])
        {
            continue;
        }
        json_t *obj = json_object_get((json_t *)headers[i], key);
        if (NULL == obj)
        {
            continue;
        }
        const char *value = json_string_value(obj);
        if (NULL == value)
        {
            continue;
        }
        return value;
    }

    return NULL;
}
