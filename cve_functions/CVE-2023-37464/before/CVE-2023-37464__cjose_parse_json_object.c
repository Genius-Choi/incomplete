static json_t *_cjose_parse_json_object(const char *str, size_t len, cjose_err *err)
{

    // unfortunately, it's not possible to tell whether the error is due
    // to syntax, or memory shortage. See https://github.com/akheron/jansson/issues/352

    json_error_t j_err;
    json_t *json = json_loadb(str, len, 0, &j_err);
    if (NULL == json || !json_is_object(json))
    {
        CJOSE_ERROR(err, CJOSE_ERR_INVALID_ARG);
        json_decref(json);
        return NULL;
    }

    return json;
}
