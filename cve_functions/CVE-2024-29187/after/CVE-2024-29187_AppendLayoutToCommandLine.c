static HRESULT AppendLayoutToCommandLine(
    __in BOOTSTRAPPER_ACTION action,
    __in_z LPCWSTR wzLayoutDirectory,
    __deref_inout_z LPWSTR* psczCommandLine
    )
{
    HRESULT hr = S_OK;

    if (BOOTSTRAPPER_ACTION_LAYOUT == action || wzLayoutDirectory)
    {
        hr = StrAllocConcat(psczCommandLine, L" /layout", 0);
        ExitOnFailure(hr, "Failed to append layout switch.");

        if (wzLayoutDirectory)
        {
            hr = AppAppendCommandLineArgument(psczCommandLine, wzLayoutDirectory);
            ExitOnFailure(hr, "Failed to append layout directory.");
        }
    }

LExit:
    return hr;
}
