static HRESULT VerifyFileSize(
    __in HANDLE hFile,
    __in DWORD64 qwFileSize,
    __in_z LPCWSTR wzUnverifiedPayloadPath
    )
{
    HRESULT hr = S_OK;
    LONGLONG llSize = 0;

    hr = FileSizeByHandle(hFile, &llSize);
    ExitOnFailure(hr, "Failed to get file size for path: %ls", wzUnverifiedPayloadPath);

    if (static_cast<DWORD64>(llSize) != qwFileSize)
    {
        ExitOnRootFailure(hr = ERROR_FILE_CORRUPT, "File size mismatch for path: %ls, expected: %llu, actual: %lld", wzUnverifiedPayloadPath, qwFileSize, llSize);
    }

LExit:
    return hr;
}
