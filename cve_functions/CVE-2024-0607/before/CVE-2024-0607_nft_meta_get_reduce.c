bool nft_meta_get_reduce(struct nft_regs_track *track,
			 const struct nft_expr *expr)
{
	const struct nft_meta *priv = nft_expr_priv(expr);
	const struct nft_meta *meta;

	if (!nft_reg_track_cmp(track, expr, priv->dreg)) {
		nft_reg_track_update(track, expr, priv->dreg, priv->len);
		return false;
	}

	meta = nft_expr_priv(track->regs[priv->dreg].selector);
	if (priv->key != meta->key ||
	    priv->dreg != meta->dreg) {
		nft_reg_track_update(track, expr, priv->dreg, priv->len);
		return false;
	}

	if (!track->regs[priv->dreg].bitwise)
		return true;

	return nft_expr_reduce_bitwise(track, expr);
}
