static int var_full_request_length_generate(modsec_rec *msr, msre_var *var, msre_rule *rule,
    apr_table_t *vartab, apr_pool_t *mptmp)
{
    const apr_array_header_t *arr = NULL;
    char *value = NULL;
    int headers_length = 0;

    arr = apr_table_elts(msr->request_headers);
    headers_length = msc_headers_to_buffer(arr, NULL, 0);
    msr->msc_full_request_length = headers_length + msr->msc_reqbody_length + /* \0: */1;

    value = apr_psprintf(mptmp, "%d", msr->msc_full_request_length);
    return var_simple_generate(var, vartab, mptmp, value);
}
