static int esil_cost(RCore *core, ut64 addr, const char *expr) {
	if (R_STR_ISEMPTY (expr)) {
		return 0;
	}
	int ec = 0;
	RAnalEsil *e = r_anal_esil_new (256, 0, 0);
	r_anal_esil_setup (e, core->anal, false, false, false);
	e->user = &ec;
	e->cb.mem_read = mr;
	e->cb.mem_write = mw;
	r_anal_esil_parse (e, expr);
	r_anal_esil_free (e);
	return ec;
}
