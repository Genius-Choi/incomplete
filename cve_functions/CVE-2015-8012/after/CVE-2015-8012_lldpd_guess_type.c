lldpd_guess_type(struct lldpd *cfg, char *frame, int s)
{
	int i;
	if (s < ETHER_ADDR_LEN)
		return -1;
	for (i=0; cfg->g_protocols[i].mode != 0; i++) {
		if (!cfg->g_protocols[i].enabled)
			continue;
		if (cfg->g_protocols[i].guess == NULL) {
			if (memcmp(frame, cfg->g_protocols[i].mac, ETHER_ADDR_LEN) == 0) {
				log_debug("decode", "guessed protocol is %s (from MAC address)",
				    cfg->g_protocols[i].name);
				return cfg->g_protocols[i].mode;
			}
		} else {
			if (cfg->g_protocols[i].guess(frame, s)) {
				log_debug("decode", "guessed protocol is %s (from detector function)",
				    cfg->g_protocols[i].name);
				return cfg->g_protocols[i].mode;
			}
		}
	}
	return -1;
}
