char *keychain_add(struct Server *server, char *label, char *username, char *secret) {
  SecKeychainItemRef item;

  OSStatus status = SecKeychainAddInternetPassword(
    NULL,
    strlen(server->host), server->host,
    0, NULL,
    strlen(username), username,
    strlen(server->path), server->path,
    server->port,
    server->proto,
    kSecAuthenticationTypeDefault,
    strlen(secret), secret,
    &item
  );

  if (status) {
    return get_error(status);
  }

  SecKeychainAttribute attribute;
  SecKeychainAttributeList attrs;
  attribute.tag = kSecLabelItemAttr;
  attribute.data = label;
  attribute.length = strlen(label);
  attrs.count = 1;
  attrs.attr = &attribute;

  status = SecKeychainItemModifyContent(item, &attrs, 0, NULL);

  if (status) {
    return get_error(status);
  }

  return NULL;
}
