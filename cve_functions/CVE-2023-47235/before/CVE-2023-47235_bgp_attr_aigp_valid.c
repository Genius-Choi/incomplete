static bool bgp_attr_aigp_valid(uint8_t *pnt, int length)
{
	uint8_t *data = pnt;
	uint8_t tlv_type;
	uint16_t tlv_length;
	uint8_t *end = data + length;

	if (length < 3) {
		zlog_err("Bad AIGP attribute length (MUST be minimum 3): %u",
			 length);
		return false;
	}

	while (length) {
		size_t data_len = end - data;

		tlv_type = *data;

		if (data_len - 1 < 2)
			return false;

		ptr_get_be16(data + 1, &tlv_length);
		(void)data;

		if (length < tlv_length) {
			zlog_err(
				"Bad AIGP attribute length: %u, but TLV length: %u",
				length, tlv_length);
			return false;
		}

		if (tlv_length < 3) {
			zlog_err("Bad AIGP TLV length (MUST be minimum 3): %u",
				 tlv_length);
			return false;
		}

		/* AIGP TLV, Length: 11 */
		if (tlv_type == BGP_AIGP_TLV_METRIC &&
		    tlv_length != BGP_AIGP_TLV_METRIC_LEN) {
			zlog_err("Bad AIGP TLV (%s) length: %u",
				 BGP_AIGP_TLV_METRIC_DESC, tlv_length);
			return false;
		}

		data += tlv_length;
		length -= tlv_length;
	}

	return true;
}
