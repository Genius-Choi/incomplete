constructAbortPDU(unsigned char src, unsigned char reason,
                  DUL_REJECTRELEASEABORTPDU * pdu,
                  unsigned long mode)
{
    pdu->type = DUL_TYPEABORT;
    pdu->rsv1 = 0;
    pdu->length = 4;
    pdu->rsv2 = 0;
    pdu->result = 0;
    pdu->source = src;
    pdu->reason = reason;
    if (mode)
    {
      pdu->rsv1   = (unsigned char)(mode >> 24);
      pdu->rsv2   = (unsigned char)(mode >> 16);
      pdu->result = (unsigned char)(mode >> 8);
      pdu->reason = (unsigned char)(mode);
      pdu->source = 0;
    }
    return EC_Normal;
}
