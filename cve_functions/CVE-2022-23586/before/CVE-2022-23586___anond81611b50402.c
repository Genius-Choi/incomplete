  auto substitute = [attr_values, &sig](StringPiece name, AttrValue* val) {
    // Look for a specified value...
    if (const AttrValue* v = attr_values.Find(name)) {
      *val = *v;
      return true;
    }
    // .. and if not, then check for a default value.
    if (const OpDef::AttrDef* attr = FindAttr(name, sig)) {
      if (attr->has_default_value()) {
        *val = attr->default_value();
        return true;
      }
    }
    // No luck finding a substitution.
    return false;
  };
