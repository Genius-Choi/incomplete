DltReturnValue dlt_file_open(DltFile *file, const char *filename, int verbose)
{
    PRINT_FUNCTION_VERBOSE(verbose);

    if ((file == NULL) || (filename == NULL))
        return DLT_RETURN_WRONG_PARAMETER;

    /* reset counters */
    file->counter = 0;
    file->counter_total = 0;
    file->position = 0;
    file->file_position = 0;
    file->file_length = 0;
    file->error_messages = 0;

    if (file->handle)
        fclose(file->handle);

    /* open dlt file */
    file->handle = fopen(filename, "rb");

    if (file->handle == NULL) {
        dlt_vlog(LOG_WARNING, "File %s cannot be opened!\n", filename);
        return DLT_RETURN_ERROR;
    }

    if (0 != fseek(file->handle, 0, SEEK_END)) {
        dlt_vlog(LOG_WARNING, "dlt_file_open: Seek failed to 0,SEEK_END");
        return DLT_RETURN_ERROR;
    }

    file->file_length = ftell(file->handle);

    if (0 != fseek(file->handle, 0, SEEK_SET)) {
        dlt_vlog(LOG_WARNING, "dlt_file_open: Seek failed to 0,SEEK_SET");
        return DLT_RETURN_ERROR;
    }

    if (verbose)
        /* print file length */
        dlt_vlog(LOG_DEBUG, "File is %" PRIu64 "bytes long\n", file->file_length);

    return DLT_RETURN_OK;
}
