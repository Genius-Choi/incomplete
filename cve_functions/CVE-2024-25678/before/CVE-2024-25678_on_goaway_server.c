on_goaway_server (void *ctx, uint64_t max_push_id)
{
    struct ietf_full_conn *const conn = ctx;
    struct push_promise *promise;
    struct lsquic_hash_elem *el;

    EV_LOG_CONN_EVENT(LSQUIC_LOG_CONN_ID, "Received GOAWAY(%"PRIu64")",
                                                                max_push_id);
    for (el = lsquic_hash_first(conn->ifc_pub.u.ietf.promises); el;
                        el = lsquic_hash_next(conn->ifc_pub.u.ietf.promises))
    {
        promise = lsquic_hashelem_getdata(el);
        if (promise->pp_id > max_push_id)
            cancel_push_promise(conn, promise);
    }
}
