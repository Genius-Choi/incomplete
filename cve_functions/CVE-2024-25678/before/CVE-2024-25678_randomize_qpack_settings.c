randomize_qpack_settings (struct ietf_full_conn *conn, const char *side,
                        unsigned *dyn_table_size, unsigned *max_risked_streams)
{
    const unsigned char nybble = lsquic_crand_get_nybble(
                                                    conn->ifc_enpub->enp_crand);
    /* For each setting, select one of four levels:
     *  Table size:     0, 1/4, 1/2, and 1/1 of dyn_table_size
     *  Risked streams: 0, 1, 5, and max_risked_streams
     */
    switch (nybble & 3)
    {   case 0: *dyn_table_size  = 0; break;
        case 1: *dyn_table_size /= 4; break;
        case 2: *dyn_table_size /= 2; break;
        default:                      break;
    }
    if (*dyn_table_size)
        switch ((nybble >> 2) & 3)
        {   case 0: *max_risked_streams = 0;                           break;
            case 1: *max_risked_streams = MIN(1, *max_risked_streams); break;
            case 2: *max_risked_streams = MIN(5, *max_risked_streams); break;
            default:                                                   break;
        }
    else
        *max_risked_streams = 0;
    LSQ_INFO("randomized QPACK %s settings: table size: %u; risked "
        "streams: %u", side, *dyn_table_size, *max_risked_streams);
}
