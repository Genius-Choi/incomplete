parse_regular_packet (struct ietf_full_conn *conn,
                                        struct lsquic_packet_in *packet_in)
{
    const unsigned char *p, *pend;
    unsigned len;

    p = packet_in->pi_data + packet_in->pi_header_sz;
    pend = packet_in->pi_data + packet_in->pi_data_sz;

    if (p < pend)
        do
        {
            len = process_packet_frame(conn, packet_in, p, pend - p);
            if (len > 0)
                p += len;
            else
            {
                ABORT_ERROR("Error parsing frame");
                break;
            }
        }
        while (p < pend);
    else
        ABORT_QUIETLY(0, TEC_PROTOCOL_VIOLATION,
            "packet %"PRIu64" has no frames", packet_in->pi_packno);
}
