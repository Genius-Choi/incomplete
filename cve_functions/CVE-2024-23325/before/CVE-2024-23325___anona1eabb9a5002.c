      .WillRepeatedly(Invoke([&](os_fd_t fd, void* buf, size_t n, int flags) {
        if (flags != MSG_PEEK) {
          return Api::SysCallSizeResult{-1, 0};
        } else {
          const Api::SysCallSizeResult x = os_sys_calls_actual_.recv(fd, buf, n, flags);
          return x;
        }
      }));
