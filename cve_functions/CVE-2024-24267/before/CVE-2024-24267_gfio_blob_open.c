static GF_FileIO *gfio_blob_open(GF_FileIO *fileio_ref, const char *url, const char *mode, GF_Err *out_error)
{
	GF_FileIOBlob *blob = gf_fileio_get_udta(fileio_ref);
	if (!strcmp(mode, "close") || !strcmp(mode, "unref")) {
		if (blob->nb_ref) blob->nb_ref--;
		blob->pos = 0;
		if (blob->nb_ref)
			return NULL;

		gf_free(blob);
		gf_fileio_del(fileio_ref);
		return NULL;
	}
	if (!strcmp(mode, "ref")) {
		blob->nb_ref++;
		*out_error = GF_OK;
		return NULL;
	}
	if (!strcmp(mode, "url")) {
		*out_error = GF_BAD_PARAM;
		return NULL;
	}
	if (!strcmp(mode, "probe")) {
		u32 crc = gf_crc_32(url, (u32) strlen(url) );
		*out_error = (crc==blob->url_crc) ? GF_OK : GF_URL_ERROR;
		return NULL;
	}
	if (mode[0]!='r') {
		*out_error = GF_BAD_PARAM;
		return NULL;
	}
	blob->nb_ref++;
	if (blob->nb_ref>2) {
		*out_error = GF_BAD_PARAM;
		return NULL;
	}
	*out_error = GF_OK;
	return fileio_ref;
}
