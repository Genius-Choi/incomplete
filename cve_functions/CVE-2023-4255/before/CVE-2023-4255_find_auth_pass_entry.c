find_auth_pass_entry(char *host, int port, char *realm, char *uname, 
		     int is_proxy)
{
    struct auth_pass *ent;
    for (ent = passwords; ent != NULL; ent = ent->next) {
	if (ent->is_proxy == is_proxy
	    && (ent->bad != TRUE)
	    && (!ent->host || !Strcasecmp_charp(ent->host, host))
	    && (!ent->port || ent->port == port)
	    && (!ent->uname || !uname || !Strcmp_charp(ent->uname, uname))
	    && (!ent->realm || !realm || !Strcmp_charp(ent->realm, realm))
	    )
	    return ent;
    }
    return NULL;
}
