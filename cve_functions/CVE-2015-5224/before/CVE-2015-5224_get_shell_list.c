static int get_shell_list(const char *shell_name)
{
	FILE *fp;
	int found = 0;
	char *buf = NULL;
	size_t sz = 0;
	ssize_t len;

	fp = fopen(_PATH_SHELLS, "r");
	if (!fp) {
		if (!shell_name)
			warnx(_("No known shells."));
		return 0;
	}
	while ((len = getline(&buf, &sz, fp)) != -1) {
		/* ignore comments and blank lines */
		if (*buf == '#' || len < 2)
			continue;
		/* strip the ending newline */
		if (buf[len - 1] == '\n')
			buf[len - 1] = 0;
		/* check or output the shell */
		if (shell_name) {
			if (!strcmp(shell_name, buf)) {
				found = 1;
				break;
			}
		} else
			printf("%s\n", buf);
	}
	fclose(fp);
	free(buf);
	return found;
}
