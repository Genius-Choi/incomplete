do_hpacc_template_const_value(work, mangled, result)
struct work_stuff *work;
const char **mangled;
string *result;
{
	int unsigned_const;

	if (**mangled != 'U' && **mangled != 'S')
		return 0;

	unsigned_const = (**mangled == 'U');

	(*mangled)++;

	switch (**mangled) {
	case 'N':
		string_append(result, "-");
		/* fall through */
	case 'P':
		(*mangled)++;
		break;
	case 'M':
		/* special case for -2^31 */
		string_append(result, "-2147483648");
		(*mangled)++;
		return 1;
	default:
		return 0;
	}

	/* We have to be looking at an integer now */
	if (!(isdigit((unsigned char)**mangled)))
		return 0;

	/* We only deal with integral values for template
	   parameters -- so it's OK to look only for digits */
	while (isdigit((unsigned char)**mangled)) {
		char_str[0] = **mangled;
		string_append(result, char_str);
		(*mangled)++;
	}

	if (unsigned_const)
		string_append(result, "U");

	/* FIXME? Some day we may have 64-bit (or larger :-) ) constants
	   with L or LL suffixes. pai/1997-09-03 */

	return 1; /* success */
}
