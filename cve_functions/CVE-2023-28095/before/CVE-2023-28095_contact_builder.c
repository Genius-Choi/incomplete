char *contact_builder(struct socket_info* send_sock, int *ct_len)
{
	char *p;
	int proto_len = 0;
	str* address_str = get_adv_host(send_sock);
	str* port_str = get_adv_port(send_sock);

	/* sip: */
	p = uri_buff;
	memcpy(p, "sip:", 4);
	p += 4;

	/* host */
	memcpy(p, address_str->s, address_str->len);
	p += address_str->len;

	/* :port */
	*p++ = ':';
	memcpy(p, port_str->s, port_str->len);
	p += port_str->len;

	/* transport if needed */
	if (send_sock->proto != PROTO_UDP) {
		memcpy(p, ";transport=", 11);
		p += 11;
		proto_len = strlen(protos[send_sock->proto].name);
		memcpy(p, protos[send_sock->proto].name, proto_len);
		p += proto_len;
	}

	*p = '\0';

	if (ct_len)
		*ct_len = p - uri_buff;

	return uri_buff;
}
