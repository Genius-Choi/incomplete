verify_kdc_checksum(krb5_context context, const krb5_pac pac,
                    const krb5_keyblock *privsvr)
{
    krb5_error_code ret;
    krb5_data server_checksum;

    ret = k5_pac_locate_buffer(context, pac, KRB5_PAC_SERVER_CHECKSUM,
                               &server_checksum);
    if (ret)
        return ret;
    if (server_checksum.length < PAC_SIGNATURE_DATA_LENGTH)
        return KRB5_BAD_MSIZE;
    server_checksum.data += PAC_SIGNATURE_DATA_LENGTH;
    server_checksum.length -= PAC_SIGNATURE_DATA_LENGTH;

    return verify_checksum(context, pac, KRB5_PAC_PRIVSVR_CHECKSUM, privsvr,
                           KRB5_KEYUSAGE_APP_DATA_CKSUM, &server_checksum);
}
