static ogs_pkbuf_t *testngap_build_pdu_session_resource_modify_response_trasfer(
        test_sess_t *sess)
{
    NGAP_PDUSessionResourceModifyResponseTransfer_t message;

    NGAP_QosFlowAddOrModifyResponseList_t *qosFlowAddOrModifyResponseList;
    NGAP_QosFlowAddOrModifyResponseItem_t *qosFlowAddOrModifyResponseItem;

    test_bearer_t *qos_flow = NULL;

    ogs_assert(sess);

    memset(&message, 0, sizeof(message));

    message.qosFlowAddOrModifyResponseList =
        qosFlowAddOrModifyResponseList =
            CALLOC(1, sizeof(struct NGAP_QosFlowAddOrModifyResponseList));

    ogs_list_for_each_entry(
                &sess->qos_flow_to_modify_list, qos_flow, to_modify_node) {

        qosFlowAddOrModifyResponseItem =
            CALLOC(1, sizeof(struct NGAP_QosFlowAddOrModifyResponseItem));
        ASN_SEQUENCE_ADD(&qosFlowAddOrModifyResponseList->list,
                qosFlowAddOrModifyResponseItem);

        qosFlowAddOrModifyResponseItem->qosFlowIdentifier = qos_flow->qfi;
    }

    return ogs_asn_encode(
            &asn_DEF_NGAP_PDUSessionResourceModifyResponseTransfer, &message);
}
