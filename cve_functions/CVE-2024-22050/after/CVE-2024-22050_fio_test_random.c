FIO_FUNC void fio_test_random(void) {
  fprintf(stderr, "=== Testing random generator\n");
  uint64_t rnd = fio_rand64();
  FIO_ASSERT((rnd != fio_rand64() && rnd != fio_rand64()),
             "fio_rand64 returned the same result three times in a row.");
#if NODEBUG
  uint64_t buffer1[8];
  uint8_t buffer2[8192];
  clock_t start, end;
  start = clock();
  for (size_t i = 0; i < (8388608 / (64 / 8)); i++) {
    buffer1[i & 7] = fio_rand64();
    __asm__ volatile("" ::: "memory");
  }
  end = clock();
  fprintf(stderr,
          "+ Random generator available\n+ created 8Mb using 64bits "
          "Random %lu CPU clock count ~%.2fMb/s\n",
          end - start, (8.0) / (((double)(end - start)) / CLOCKS_PER_SEC));
  start = clock();
  for (size_t i = 0; i < (8388608 / (8192)); i++) {
    fio_rand_bytes(buffer2, 8192);
    __asm__ volatile("" ::: "memory");
  }
  end = clock();
  fprintf(stderr,
          "+ created 8Mb using 8,192 Bytes "
          "Random %lu CPU clock count ~%.2fMb/s\n",
          end - start, (8.0) / (((double)(end - start)) / CLOCKS_PER_SEC));
  (void)buffer1;
  (void)buffer2;
#endif
}
