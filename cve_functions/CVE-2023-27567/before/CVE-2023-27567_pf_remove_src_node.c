pf_remove_src_node(struct pf_src_node *sn)
{
	if (sn->states > 0 || sn->expire > getuptime())
		return;

	sn->rule.ptr->src_nodes--;
	if (sn->rule.ptr->states_cur == 0 &&
	    sn->rule.ptr->src_nodes == 0)
		pf_rm_rule(NULL, sn->rule.ptr);
	RB_REMOVE(pf_src_tree, &tree_src_tracking, sn);
	pf_status.scounters[SCNT_SRC_NODE_REMOVALS]++;
	pf_status.src_nodes--;
	pfi_kif_unref(sn->kif, PFI_KIF_REF_SRCNODE);
	pool_put(&pf_src_tree_pl, sn);
}
