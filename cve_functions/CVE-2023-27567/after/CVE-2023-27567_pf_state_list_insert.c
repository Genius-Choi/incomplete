pf_state_list_insert(struct pf_state_list *pfs, struct pf_state *st)
{
	/*
	 * we can always put states on the end of the list.
	 *
	 * things reading the list should take a read lock, then
	 * the mutex, get the head and tail pointers, release the
	 * mutex, and then they can iterate between the head and tail.
	 */

	pf_state_ref(st); /* get a ref for the list */

	mtx_enter(&pfs->pfs_mtx);
	TAILQ_INSERT_TAIL(&pfs->pfs_list, st, entry_list);
	mtx_leave(&pfs->pfs_mtx);
}
