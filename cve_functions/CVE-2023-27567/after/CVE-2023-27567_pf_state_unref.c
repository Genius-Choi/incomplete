pf_state_unref(struct pf_state *st)
{
	if ((st != NULL) && PF_REF_RELE(st->refcnt)) {
		/* never inserted or removed */
#if NPFSYNC > 0
		KASSERT((TAILQ_NEXT(st, sync_list) == NULL) ||
		    ((TAILQ_NEXT(st, sync_list) == _Q_INVALID) &&
		    (st->sync_state == PFSYNC_S_NONE)));
#endif	/* NPFSYNC */
		KASSERT((TAILQ_NEXT(st, entry_list) == NULL) ||
		    (TAILQ_NEXT(st, entry_list) == _Q_INVALID));

		pf_state_key_unref(st->key[PF_SK_WIRE]);
		pf_state_key_unref(st->key[PF_SK_STACK]);

		pool_put(&pf_state_pl, st);
	}
}
