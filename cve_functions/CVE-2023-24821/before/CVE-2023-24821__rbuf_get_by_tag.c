static gnrc_sixlowpan_frag_rb_t *_rbuf_get_by_tag(const gnrc_netif_hdr_t *netif_hdr,
                                                  uint16_t tag)
{
    assert(netif_hdr != NULL);
    const uint8_t *src = gnrc_netif_hdr_get_src_addr(netif_hdr);
    const uint8_t *dst = gnrc_netif_hdr_get_dst_addr(netif_hdr);
    const uint8_t src_len = netif_hdr->src_l2addr_len;
    const uint8_t dst_len = netif_hdr->dst_l2addr_len;

    for (unsigned i = 0; i < CONFIG_GNRC_SIXLOWPAN_FRAG_RBUF_SIZE; i++) {
        gnrc_sixlowpan_frag_rb_t *e = &rbuf[i];

        if ((e->pkt != NULL) && (e->super.tag == tag) &&
            (e->super.src_len == src_len) &&
            (e->super.dst_len == dst_len) &&
            (memcmp(e->super.src, src, src_len) == 0) &&
            (memcmp(e->super.dst, dst, dst_len) == 0)) {
            return e;
        }
    }
    return NULL;
}
