static void export_func(const std::map<wcstring, wcstring> &envs, std::vector<std::string> &out)
{
    std::map<wcstring, wcstring>::const_iterator iter;
    for (iter = envs.begin(); iter != envs.end(); ++iter)
    {
        const std::string ks = wcs2string(iter->first);
        std::string vs = wcs2string(iter->second);

        for (size_t i=0; i < vs.size(); i++)
        {
            char &vc = vs.at(i);
            if (vc == ARRAY_SEP)
                vc = ':';
        }

        /* Put a string on the vector */
        out.push_back(std::string());
        std::string &str = out.back();
        str.reserve(ks.size() + 1 + vs.size());

        /* Append our environment variable data to it */
        str.append(ks);
        str.append("=");
        str.append(vs);
    }
}
