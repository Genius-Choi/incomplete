static uint32_t crc32_ccitt_seed(const uint8_t *buf, size_t len, uint32_t seed)
{
    uint32_t crc32 = seed;

    for (unsigned int i = 0; i < len; i++){
        crc32 = crc32_ccitt_table[(crc32 ^ buf[i]) & 0xff] ^ (crc32 >> 8);
    }

    return ( ~crc32 );
}
