void Wifipcap::Run(WifipcapCallbacks *cbs, int maxpkts)
{
    /* NOTE: This needs to be fixed so that the correct handle_packet is called  */

    packetsProcessed = 0;
    
    do {
	PcapUserData data(this,cbs,DLT_IEEE802_11_RADIO);
	pcap_loop(descr, maxpkts > 0 ? maxpkts - packetsProcessed : 0,
		  Wifipcap::handle_packet_callback, reinterpret_cast<u_char *>(&data));
    } while ( InitNext() );
}
