Json::Value SGXWalletServer::getVerificationVectorImpl(const string &_polyName, int _t, int _n) {

    Json::Value result;
    result["status"] = 0;
    result["errorMessage"] = "";

    vector <vector<string>> verifVector;
    try {
        if (!checkName(_polyName, "POLY")) {
            throw SGXException(INVALID_POLY_NAME, "Invalid polynomial name");
        }
        if (!check_n_t(_t, _n)) {
            throw SGXException(INVALID_DKG_PARAMS, "Invalid parameters: n or t ");
        }

        shared_ptr <string> encr_poly_ptr = readFromDb(_polyName);

        verifVector = get_verif_vect(encr_poly_ptr->c_str(), _t, _n);
        //cerr << "verif vect size " << verifVector.size() << endl;

        for (int i = 0; i < _t; i++) {
            vector <string> cur_coef = verifVector.at(i);
            for (int j = 0; j < 4; j++) {
                result["verificationVector"][i][j] = cur_coef.at(j);
                result["Verification Vector"][i][j] = cur_coef.at(j);
            }
        }

    } catch (SGXException &_e) {
        cerr << " err str " << _e.errString << endl;
        result["status"] = _e.status;
        result["errorMessage"] = _e.errString;
        result["verificationVector"] = "";
        result["Verification Vector"] = "";
    }

    return result;
}
