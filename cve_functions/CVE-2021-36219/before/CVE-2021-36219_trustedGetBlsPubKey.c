void trustedGetBlsPubKey(int *errStatus, char *errString, uint8_t *encryptedPrivateKey, uint64_t key_len, char *bls_pub_key) {

    LOG_DEBUG (__FUNCTION__);

    char skey_hex[ECDSA_SKEY_LEN];

    uint32_t len = key_len;

    sgx_status_t status = sgx_unseal_data(
            (const sgx_sealed_data_t *) encryptedPrivateKey, NULL, 0, (uint8_t *) skey_hex, &len);
    if (status != SGX_SUCCESS) {
        *errStatus = 1;
        snprintf(errString, BUF_LEN, "sgx_unseal_data failed with status %d", status);
        return;
    }

    if (calc_bls_public_key(skey_hex, bls_pub_key) != 0) {
        *errStatus = -1;
        snprintf(errString, BUF_LEN, "could not calculate bls public key");
        return;
    }
}
