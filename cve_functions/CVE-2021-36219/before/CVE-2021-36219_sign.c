bool sign(const char *_encryptedKeyHex, const char *_hashHex, size_t _t, size_t _n, size_t _signerIndex,
          char *_sig) {

    //cerr << "ENTER SIGN" << endl;

    auto keyStr = make_shared<string>(_encryptedKeyHex);

    auto hash = make_shared<array<uint8_t, 32>>();

    uint64_t binLen;

    if (!hex2carray(_hashHex, &binLen, hash->data())) {
        throw SGXException(INVALID_HEX, "Invalid hash");
    }




    auto keyShare = make_shared<BLSPrivateKeyShareSGX>(keyStr, _t, _n);

    //cerr << "keyShare created" << endl;
    // {
    auto sigShare = keyShare->signWithHelperSGX(hash, _signerIndex);
    // }

    auto sigShareStr = sigShare->toString();

    strncpy(_sig, sigShareStr->c_str(), BUF_LEN);

    //string sigShareStr = keyShare->signWithHelperSGXstr(hash, _signerIndex);
    //strncpy(_sig, sigShareStr.c_str(), BUF_LEN);

    // string test_sig = "8175162913343900215959836578795929492705714455632345516427532159927644835012:15265825550804683171644566522808807137117748565649051208189914766494241035855:9810286616503120081238481858289626967170509983220853777870754480048381194141:5";
    // auto sig_ptr = make_shared<string>(test_sig);
    // strncpy(_sig, sig_ptr->c_str(), BUF_LEN);

    //cerr<< "sig " << _sig <<endl;

    return true;
}
