static const char *oidc_get_current_url_base(request_rec *r, const apr_byte_t x_forwarded_headers) {

	const char *scheme_str = NULL;
	const char *host_str = NULL;
	const char *port_str = NULL;

	oidc_config_check_x_forwarded(r, x_forwarded_headers);

	scheme_str = oidc_get_current_url_scheme(r, x_forwarded_headers);
	host_str = oidc_get_current_url_host(r, x_forwarded_headers);
	port_str = oidc_get_current_url_port(r, scheme_str, x_forwarded_headers);
	port_str = port_str ? apr_psprintf(r->pool, ":%s", port_str) : "";

	char *url = apr_pstrcat(r->pool, scheme_str, "://", host_str, port_str, NULL);

	return url;
}
