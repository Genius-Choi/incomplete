pkinit_check_dh_params(DH *dh1, DH *dh2)
{
    const BIGNUM *p1, *p2, *g1, *g2;

    DH_get0_pqg(dh1, &p1, NULL, &g1);
    DH_get0_pqg(dh2, &p2, NULL, &g2);
    if (BN_cmp(p1, p2) != 0) {
        pkiDebug("p is not well-known group dhparameter\n");
        return -1;
    }
    if (BN_cmp(g1, g2) != 0) {
        pkiDebug("bad g dhparameter\n");
        return -1;
    }
    pkiDebug("good %d dhparams\n", BN_num_bits(p1));
    return 0;
}
