static int send_json(struct MHD_Connection *connection, const char *json)
{
	char *msg;
	int ret;
	struct MHD_Response *response;

	msg = safe_calloc(SMALL_BUF * 2);

	if (!msg) {
		ret = send_error(connection, 503);
		free(msg);
		return ret;
	}

	safe_asprintf(&msg, "%s", json);

	debug(LOG_DEBUG, "json string [%s],  buffer [%s]", json, msg);

	response = MHD_create_response_from_buffer(strlen(msg), (char *)msg, MHD_RESPMEM_MUST_FREE);

	if (!response) {
		free(msg);
		ret = send_error(connection, 503);
		return ret;
	}

	MHD_add_response_header(response, "Cache-Control", "private");
	MHD_add_response_header(response, "Content-Type", "application/captive+json");
	ret = MHD_queue_response(connection, MHD_HTTP_OK, response);
	MHD_destroy_response(response);
	return ret;

}
