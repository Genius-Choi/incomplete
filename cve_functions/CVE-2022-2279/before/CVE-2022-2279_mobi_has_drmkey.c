bool mobi_has_drmkey(const MOBIData *m) {
#ifdef USE_ENCRYPTION
    if (m == NULL) {
        debug_print("%s", "Mobi structure not initialized\n");
        return false;
    }
    MOBIDrm *drm = m->internals;
    return drm != NULL && drm->key != NULL;
#else
    UNUSED(m);
    return false;
#endif
}
