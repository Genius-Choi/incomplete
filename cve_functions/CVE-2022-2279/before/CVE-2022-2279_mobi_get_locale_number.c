size_t mobi_get_locale_number(const char *locale_string) {
    if (locale_string == NULL || strlen(locale_string) < 2) {
        return 0;
    }
    size_t lang_code = 0;
    while (lang_code < MOBI_LANG_MAX) {
        char *p = (char *) mobi_locale[lang_code][0];
        if (p == NULL) {
            lang_code++;
            continue;
        }
        
        if (tolower(locale_string[0]) != p[0] ||
            tolower(locale_string[1]) != p[1]) {
            lang_code++;
            continue;
        }
        size_t region_code = 0;
        while (region_code < MOBI_REGION_MAX) {
            p = (char *) mobi_locale[lang_code][region_code];
            if (p == NULL) { break; }
            for (int i = 2;; i++) {
                if (tolower(locale_string[i]) != p[i]) { break; }
                if (p[i] == 0) {
                    return (region_code * 4) << 8 | lang_code;
                }
            }
            region_code++;
        }
        return lang_code;
    }
    return 0;
}
