bool mobi_exists_fdst(const MOBIData *m) {
    if (!mobi_exists_mobiheader(m) || mobi_get_fileversion(m) <= 3) {
        return false;
    }
    if (mobi_get_fileversion(m) >= 8) {
        if (m->mh->fdst_index && *m->mh->fdst_index != MOBI_NOTSET) {
            return true;
        }
    } else {
        if ((m->mh->fdst_section_count && *m->mh->fdst_section_count > 1)
            && (m->mh->last_text_index && *m->mh->last_text_index != (uint16_t) -1)) {
            return true;
        }
    }
    debug_print("%s", "FDST record not found\n");
    return false;
}
