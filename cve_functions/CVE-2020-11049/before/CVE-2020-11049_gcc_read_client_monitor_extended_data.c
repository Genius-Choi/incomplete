BOOL gcc_read_client_monitor_extended_data(wStream* s, rdpMcs* mcs, UINT16 blockLength)
{
	UINT32 index;
	UINT32 flags;
	UINT32 monitorCount;
	UINT32 monitorAttributeSize;
	rdpSettings* settings = mcs->settings;

	if (blockLength < 12)
		return FALSE;

	Stream_Read_UINT32(s, flags);                /* flags */
	Stream_Read_UINT32(s, monitorAttributeSize); /* monitorAttributeSize */
	Stream_Read_UINT32(s, monitorCount);         /* monitorCount */

	if (monitorAttributeSize != 20)
		return FALSE;

	if ((blockLength - 12) / monitorAttributeSize < monitorCount)
		return FALSE;

	if (settings->MonitorCount != monitorCount)
		return FALSE;

	settings->HasMonitorAttributes = TRUE;

	for (index = 0; index < monitorCount; index++)
	{
		Stream_Read_UINT32(
		    s, settings->MonitorDefArray[index].attributes.physicalWidth); /* physicalWidth */
		Stream_Read_UINT32(
		    s, settings->MonitorDefArray[index].attributes.physicalHeight); /* physicalHeight */
		Stream_Read_UINT32(
		    s, settings->MonitorDefArray[index].attributes.orientation); /* orientation */
		Stream_Read_UINT32(s, settings->MonitorDefArray[index]
		                          .attributes.desktopScaleFactor); /* desktopScaleFactor */
		Stream_Read_UINT32(
		    s,
		    settings->MonitorDefArray[index].attributes.deviceScaleFactor); /* deviceScaleFactor */
	}

	return TRUE;
}
