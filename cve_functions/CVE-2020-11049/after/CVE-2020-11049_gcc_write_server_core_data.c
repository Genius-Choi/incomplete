BOOL gcc_write_server_core_data(wStream* s, rdpMcs* mcs)
{
	UINT32 earlyCapabilityFlags = 0;
	rdpSettings* settings = mcs->settings;

	if (!Stream_EnsureRemainingCapacity(s, 20))
		return FALSE;

	gcc_write_user_data_header(s, SC_CORE, 16);

	if (settings->SupportDynamicTimeZone)
		earlyCapabilityFlags |= RNS_UD_SC_DYNAMIC_DST_SUPPORTED;

	Stream_Write_UINT32(s, settings->RdpVersion);         /* version (4 bytes) */
	Stream_Write_UINT32(s, settings->RequestedProtocols); /* clientRequestedProtocols (4 bytes) */
	Stream_Write_UINT32(s, earlyCapabilityFlags);         /* earlyCapabilityFlags (4 bytes) */
	return TRUE;
}
