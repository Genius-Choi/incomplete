    void DrachtioController::printStats(bool bDetail) {
       bool bMemoryDebug = m_bMemoryDebug || m_bDumpMemory;

       usize_t irq_hash = -1, orq_hash = -1, leg_hash = -1;
       usize_t irq_used = -1, orq_used = -1, leg_used = -1 ;
       usize_t recv_msg = -1, sent_msg = -1;
       usize_t recv_request = -1, recv_response = -1;
       usize_t bad_message = -1, bad_request = -1, bad_response = -1;
       usize_t drop_request = -1, drop_response = -1;
       usize_t client_tr = -1, server_tr = -1, dialog_tr = -1;
       usize_t acked_tr = -1, canceled_tr = -1;
       usize_t trless_request = -1, trless_to_tr = -1, trless_response = -1;
       usize_t trless_200 = -1, merged_request = -1;
       usize_t sent_request = -1, sent_response = -1;
       usize_t retry_request = -1, retry_response = -1, recv_retry = -1;
       usize_t tout_request = -1, tout_response = -1;
       sip_time_t now = sip_now();
       nta_agent_get_stats(m_nta,
                                NTATAG_S_IRQ_HASH_REF(irq_hash),
                                NTATAG_S_ORQ_HASH_REF(orq_hash),
                                NTATAG_S_LEG_HASH_REF(leg_hash),
                                NTATAG_S_IRQ_HASH_USED_REF(irq_used),
                                NTATAG_S_ORQ_HASH_USED_REF(orq_used),
                                NTATAG_S_LEG_HASH_USED_REF(leg_used),
                                NTATAG_S_RECV_MSG_REF(recv_msg),
                                NTATAG_S_SENT_MSG_REF(sent_msg),
                                NTATAG_S_RECV_REQUEST_REF(recv_request),
                                NTATAG_S_RECV_RESPONSE_REF(recv_response),
                                NTATAG_S_BAD_MESSAGE_REF(bad_message),
                                NTATAG_S_BAD_REQUEST_REF(bad_request),
                                NTATAG_S_BAD_RESPONSE_REF(bad_response),
                                NTATAG_S_DROP_REQUEST_REF(drop_request),
                                NTATAG_S_DROP_RESPONSE_REF(drop_response),
                                NTATAG_S_CLIENT_TR_REF(client_tr),
                                NTATAG_S_SERVER_TR_REF(server_tr),
                                NTATAG_S_DIALOG_TR_REF(dialog_tr),
                                NTATAG_S_ACKED_TR_REF(acked_tr),
                                NTATAG_S_CANCELED_TR_REF(canceled_tr),
                                NTATAG_S_TRLESS_REQUEST_REF(trless_request),
                                NTATAG_S_TRLESS_TO_TR_REF(trless_to_tr),
                                NTATAG_S_TRLESS_RESPONSE_REF(trless_response),
                                NTATAG_S_TRLESS_200_REF(trless_200),
                                NTATAG_S_MERGED_REQUEST_REF(merged_request),
                                NTATAG_S_SENT_REQUEST_REF(sent_request),
                                NTATAG_S_SENT_RESPONSE_REF(sent_response),
                                NTATAG_S_RETRY_REQUEST_REF(retry_request),
                                NTATAG_S_RETRY_RESPONSE_REF(retry_response),
                                NTATAG_S_RECV_RETRY_REF(recv_retry),
                                NTATAG_S_TOUT_REQUEST_REF(tout_request),
                                NTATAG_S_TOUT_RESPONSE_REF(tout_response),
                           TAG_END()) ;
       
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "size of hash table for server-side transactions                  " << dec << irq_hash  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "size of hash table for client-side transactions                  " << orq_hash  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "size of hash table for dialogs                                   " << leg_hash  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of server-side transactions in the hash table             " << irq_used  ;
       if (bDetail && irq_used > 0) {
           nta_incoming_t* irq = NULL;
           std::deque<nta_incoming_t*> aged;
           do {
               irq = nta_get_next_server_txn_from_hash(m_nta, irq);
               if (irq) {
                   const char* method = nta_incoming_method_name(irq);
                   const char* tag = nta_incoming_gettag(irq);
                   uint32_t seq = nta_incoming_cseq(irq);
                   sip_time_t secsSinceReceived = now - nta_incoming_received(irq, NULL);
                   if (secsSinceReceived > 3600) aged.push_back(irq);
                   DR_LOG(bMemoryDebug ? log_info : log_debug) << "    nta_incoming_t*: " << std::hex << (void *) irq  <<
                    " " << method << " " << std::dec << seq << " remote tag: " << tag << 
                    " alive " << secsSinceReceived << " secs";
               }
           } while (irq) ;
           /*
           std::for_each(aged.begin(), aged.end(), [](nta_incoming_t* irq) {
               DR_LOG(bMemoryDebug ? log_info : log_debug) << "        destroying very old nta_incoming_t*: " <<  std::hex << (void *) irq ;
               nta_incoming_destroy(irq);
           });
           */
       }
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of client-side transactions in the hash table             " << orq_used  ;
       if (bDetail && orq_used > 0) {
           nta_outgoing_t* orq = NULL;
           do {
               orq = nta_get_next_client_txn_from_hash(m_nta, orq);
               if (orq) {
                   const char* method = nta_outgoing_method_name(orq);
                   const char* callId = nta_outgoing_call_id(orq);
                   uint32_t seq = nta_outgoing_cseq(orq);
                   DR_LOG(bMemoryDebug ? log_info : log_debug) << "    nta_outgoing_t*: " << std::hex << (void *) orq  <<
                    " " << method << " " << callId << std::dec << " CSeq: " << seq;
               }
           } while (orq) ;
       }
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of dialogs in the hash table                              " << leg_used  ;
       if (bDetail && leg_used > 0) {
           nta_leg_t* leg = NULL;
           do {
               leg = nta_get_next_dialog_from_hash(m_nta, leg);
               if (leg) {
                   const char* localTag = nta_leg_get_tag(leg);
                   DR_LOG(bMemoryDebug ? log_info : log_debug) << "    nta_leg_t*: " << std::hex << (void *) leg  << 
                    " local tag: " << localTag ;
               }
           } while (leg) ;
       }
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of sip messages received                                  " << recv_msg  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of sip messages sent                                      " << sent_msg  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of sip requests received                                  " << recv_request  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of sip requests sent                                      " << sent_request  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of bad sip messages received                              " << bad_message  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of bad sip requests received                              " << bad_request  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of bad sip requests dropped                               " << drop_request  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of bad sip reponses dropped                               " << drop_response  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of client transactions created                            " << client_tr  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of server transactions created                            " << server_tr  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of in-dialog server transactions created                  " << dialog_tr  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of server transactions that have received ack             " << acked_tr  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of server transactions that have received cancel          " << canceled_tr  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of requests that were processed stateless                 " << trless_request  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of requests converted to transactions by message callback " << trless_to_tr  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of responses without matching request                     " << trless_response  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of successful responses missing INVITE client transaction " << trless_200  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of requests merged by UAS                                 " << merged_request  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of SIP responses sent by stack                            " << sent_response  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of SIP requests retransmitted by stack                    " << retry_request  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of SIP responses retransmitted by stack                   " << retry_response  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of retransmitted SIP requests received by stack           " << recv_retry  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of SIP client transactions that has timeout               " << tout_request  ;
       DR_LOG(bMemoryDebug ? log_info : log_debug) << "number of SIP server transactions that has timeout               " << tout_response  ;

       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_SERVER_HASH_SIZE, irq_hash)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_CLIENT_HASH_SIZE, orq_hash)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_DIALOG_HASH_SIZE, leg_hash)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_NUM_SERVER_TXNS, irq_used)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_NUM_CLIENT_TXNS, orq_used)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_NUM_DIALOGS, leg_used)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_MSG_RECV, recv_msg)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_MSG_SENT, sent_msg)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_REQ_RECV, recv_request)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_REQ_SENT, sent_request)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_BAD_MSGS, bad_message)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_BAD_REQS, bad_request)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_RETRANS_REQ, retry_request)
       STATS_GAUGE_SET(STATS_GAUGE_SOFIA_RETRANS_RES, retry_response)

       STATS_GAUGE_SET(STATS_GAUGE_REGISTERED_ENDPOINTS, m_mapUri2InvalidData.size());

    }
