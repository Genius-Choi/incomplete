name_len(netdissect_options *ndo,
         const u_char *s, const u_char *maxbuf)
{
    const u_char *s0 = s;
    unsigned char c;

    if (s >= maxbuf)
	return(-1);	/* name goes past the end of the buffer */
    c = GET_U_1(s);
    if ((c & 0xC0) == 0xC0)
	return(2);
    while (GET_U_1(s)) {
	if (s >= maxbuf)
	    return(-1);	/* name goes past the end of the buffer */
	s += GET_U_1(s) + 1;
	ND_TCHECK_1(s);
    }
    return(ND_BYTES_BETWEEN(s, s0) + 1);

trunc:
    return(-1);	/* name goes past the end of the buffer */
}
