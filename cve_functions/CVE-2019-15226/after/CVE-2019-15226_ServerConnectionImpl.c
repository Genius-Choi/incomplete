ServerConnectionImpl::ServerConnectionImpl(Network::Connection& connection,
                                           Http::ServerConnectionCallbacks& callbacks,
                                           Stats::Scope& scope, const Http2Settings& http2_settings,
                                           const uint32_t max_request_headers_kb)
    : ConnectionImpl(connection, scope, http2_settings, max_request_headers_kb),
      callbacks_(callbacks) {
  Http2Options http2_options(http2_settings);
  nghttp2_session_server_new2(&session_, http2_callbacks_.callbacks(), base(),
                              http2_options.options());
  sendSettings(http2_settings, false);
  allow_metadata_ = http2_settings.allow_metadata_;
}
