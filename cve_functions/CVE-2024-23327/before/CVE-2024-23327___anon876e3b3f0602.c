    config_helper_.addConfigModifier([this](envoy::config::bootstrap::v3::Bootstrap& bootstrap) {
      envoy::extensions::filters::listener::proxy_protocol::v3::ProxyProtocol proxy_protocol;
      auto pass_through_tlvs = proxy_protocol.mutable_pass_through_tlvs();
      if (pass_all_tlvs_) {
        pass_through_tlvs->set_match_type(ProxyProtocolPassThroughTLVs::INCLUDE_ALL);
      } else {
        pass_through_tlvs->set_match_type(ProxyProtocolPassThroughTLVs::INCLUDE);
        for (const auto& tlv_type : tlvs_listener_) {
          pass_through_tlvs->add_tlv_type(tlv_type);
        }
      }

      auto* listener = bootstrap.mutable_static_resources()->mutable_listeners(0);
      auto* ppv_filter = listener->add_listener_filters();
      ppv_filter->set_name("envoy.listener.proxy_protocol");
      ppv_filter->mutable_typed_config()->PackFrom(proxy_protocol);
    });
