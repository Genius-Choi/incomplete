static int HTPCallbackDoubleDecodeUriPart(htp_tx_t *tx, bstr *part)
{
    if (part == NULL)
        return HTP_OK;

    uint64_t flags = 0;
    size_t prevlen = bstr_len(part);
    htp_status_t res = htp_urldecode_inplace(tx->cfg, HTP_DECODER_URLENCODED, part, &flags);
    // shorter string means that uri was encoded
    if (res == HTP_OK && prevlen > bstr_len(part)) {
        HtpTxUserData *htud = (HtpTxUserData *) htp_tx_get_user_data(tx);
        if (htud == NULL)
            return HTP_OK;
        HtpState *s = htp_connp_get_user_data(tx->connp);
        if (s == NULL)
            return HTP_OK;
        HTPSetEvent(s, htud, STREAM_TOSERVER,
                HTTP_DECODER_EVENT_DOUBLE_ENCODED_URI);
    }

    return HTP_OK;
}
