static INLINE BOOL ensure_capacity_(const BYTE* start, const BYTE* end, size_t size, size_t base,
                                    const char* fkt, const char* file, size_t line)
{
	const size_t available = (uintptr_t)end - (uintptr_t)start;
	const BOOL rc = available >= size * base;
	const BOOL res = rc && (start <= end);

	if (!res)
		WLog_ERR(TAG,
		         "[%s:%" PRIuz "] failed: start=%p <= end=%p, available=%" PRIuz " >= size=%" PRIuz
		         " * base=%" PRIuz,
		         fkt, line, start, end, available, size, base);
	return res;
}
