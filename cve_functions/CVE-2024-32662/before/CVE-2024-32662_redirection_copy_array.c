static BOOL redirection_copy_array(char*** dst, UINT32* plen, const char** str, size_t len)
{
	redirection_free_array(dst, plen);

	if (!str || (len == 0))
		return TRUE;

	*dst = calloc(len, sizeof(char*));
	if (!*dst)
		return FALSE;
	*plen = len;

	for (UINT32 x = 0; x < len; x++)
	{
		if (str[x])
			(*dst)[x] = _strdup(str[x]);

		if (!((*dst)[x]))
		{
			redirection_free_array(dst, plen);
			return FALSE;
		}
	}

	return *dst != NULL;
}
