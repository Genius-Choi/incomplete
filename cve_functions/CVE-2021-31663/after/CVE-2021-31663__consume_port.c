bool _consume_port(uri_parser_result_t *result, char *ipv6_end,
                   char *authority_end)
{
    /* check for port after host part */
    char *port_begin = NULL;
    /* repeat until last ':' in authority section */
    /* if ipv6 address, check after ipv6 end marker */
    char *p = (ipv6_end ? ipv6_end : result->host);
    while (p != NULL && (p < authority_end)) {
        port_begin = p;
        p = _strchrb(p + 1, authority_end, ':');
    }

    /* check if match */
    if (port_begin && (port_begin[0] == ':')) {
        /* port should be at least one character, => + 1 */
        if (port_begin + 1 == authority_end) {
            return false;
        }
        result->port = port_begin + 1;
        result->port_len = authority_end - result->port;
        /* cut host part before port and ':' */
        result->host_len -= result->port_len + 1;
    }

    return true;
}
