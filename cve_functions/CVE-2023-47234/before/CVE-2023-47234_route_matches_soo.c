bool route_matches_soo(struct bgp_path_info *pi, struct ecommunity *soo)
{
	struct attr *attr = pi->attr;
	struct ecommunity *ecom;

	if (!CHECK_FLAG(attr->flag, ATTR_FLAG_BIT(BGP_ATTR_EXT_COMMUNITIES)))
		return false;

	ecom = attr->ecommunity;
	if (!ecom || !ecom->size)
		return false;

	return soo_in_ecom(ecom, soo);
}
