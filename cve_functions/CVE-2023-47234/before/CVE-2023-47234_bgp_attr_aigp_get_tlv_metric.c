static bool bgp_attr_aigp_get_tlv_metric(uint8_t *pnt, int length,
					 uint64_t *aigp)
{
	uint8_t *data = pnt;
	uint8_t tlv_type;
	uint16_t tlv_length;

	while (length) {
		tlv_type = *data;
		ptr_get_be16(data + 1, &tlv_length);
		(void)data;

		/* The value field of the AIGP TLV is always 8 octets
		 * long and its value is interpreted as an unsigned 64-bit
		 * integer.
		 */
		if (tlv_type == BGP_AIGP_TLV_METRIC) {
			(void)ptr_get_be64(data + 3, aigp);

			/* If an AIGP attribute is received and its first AIGP
			 * TLV contains the maximum value 0xffffffffffffffff,
			 * the attribute SHOULD be considered to be malformed
			 * and SHOULD be discarded as specified in this section.
			 */
			if (*aigp == BGP_AIGP_TLV_METRIC_MAX) {
				zlog_err("Bad AIGP TLV (%s) length: %llu",
					 BGP_AIGP_TLV_METRIC_DESC,
					 BGP_AIGP_TLV_METRIC_MAX);
				return false;
			}

			return true;
		}

		data += tlv_length;
		length -= tlv_length;
	}

	return false;
}
