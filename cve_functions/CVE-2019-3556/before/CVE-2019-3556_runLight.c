R runLight(const char* call, F1 body, R failureResult) {
  try {
    auto proc = tl_proc ? tl_proc : &g_procs[GetId()];
    Lock lock(proc->mutex());

    return body(proc);
  } catch (...) {
    handleException(call);
  }
  return failureResult;
}
