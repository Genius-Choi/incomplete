static void resume_processing_after_username_check(int success,  int oauth, int max_session_time, hmackey_t hmackey, password_t pwd, turn_turnserver *server, uint64_t ctxkey, ioa_net_data *in_buffer, uint8_t *realm)
{

	if(server && in_buffer && in_buffer->nbh) {

		ts_ur_super_session *ss = get_session_from_map(server,(turnsession_id)ctxkey);
		if(ss && ss->client_socket) {
			turn_turnserver *server = (turn_turnserver *)ss->server;

			if(success) {
				bcopy(hmackey,ss->hmackey,sizeof(hmackey_t));
				ss->hmackey_set = 1;
				ss->oauth = oauth;
				ss->max_session_time_auth = (turn_time_t)max_session_time;
				bcopy(pwd,ss->pwd,sizeof(password_t));
				if(realm && realm[0] && strcmp((char*)realm,ss->realm_options.name)) {
					dec_quota(ss);
					get_realm_options_by_name((char*)realm, &(ss->realm_options));
					inc_quota(ss,ss->username);
				}
			}

			read_client_connection(server,ss,in_buffer,0,0);

			close_ioa_socket_after_processing_if_necessary(ss->client_socket);

			ioa_network_buffer_delete(server->e, in_buffer->nbh);
			in_buffer->nbh=NULL;
		}
	}
}
