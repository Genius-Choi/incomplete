void bn_rand_mod(bn_t a, const bn_t b) {
	bn_t t;

	bn_null(t);

	RLC_TRY {
		bn_new(t);

		bn_copy(t, b);
		do {
			bn_rand(a, bn_sign(t), bn_bits(t) + RAND_DIST);
			bn_mod(a, a, t);
		} while (bn_is_zero(a) || bn_cmp_abs(a, t) != RLC_LT);
	} RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	} RLC_FINALLY {
		bn_free(t);
	}
}
