static int fixed2(void) {
	int code = RLC_ERR;
	g2_t p, q, r;
	g2_t t[RLC_G2_TABLE];
	bn_t n, k;

	bn_null(n);
	bn_null(k);
	g2_null(p);
	g2_null(q);
	g2_null(r);

	for (int i = 0; i < RLC_G2_TABLE; i++) {
		g2_null(t[i]);
	}

	RLC_TRY {
		g2_new(p);
		g2_new(q);
		g2_new(r);
		bn_new(n);
		bn_new(k);

		g2_get_gen(p);
		pc_get_ord(n);

		for (int i = 0; i < RLC_G2_TABLE; i++) {
			g2_new(t[i]);
		}
		TEST_CASE("fixed point multiplication is correct") {
			g2_rand(p);
			g2_mul_pre(t, p);
			bn_zero(k);
			g2_mul_fix(r, t, k);
			TEST_ASSERT(g2_is_infty(r), end);
			bn_set_dig(k, 1);
			g2_mul_fix(r, t, k);
			TEST_ASSERT(g2_cmp(p, r) == RLC_EQ, end);
			bn_rand_mod(k, n);
			g2_mul(q, p, k);
			g2_mul_fix(q, t, k);
			g2_mul(r, p, k);
			TEST_ASSERT(g2_cmp(q, r) == RLC_EQ, end);
			bn_neg(k, k);
			g2_mul_fix(r, t, k);
			g2_neg(r, r);
			TEST_ASSERT(g2_cmp(q, r) == RLC_EQ, end);
		} TEST_END;
		for (int i = 0; i < RLC_G2_TABLE; i++) {
			g2_free(t[i]);
		}
	}
	RLC_CATCH_ANY {
		util_print("FATAL ERROR!\n");
		RLC_ERROR(end);
	}
	code = RLC_OK;
  end:
	g2_free(p);
	g2_free(q);
	g2_free(r);
	bn_free(n);
	bn_free(k);
	return code;
}
