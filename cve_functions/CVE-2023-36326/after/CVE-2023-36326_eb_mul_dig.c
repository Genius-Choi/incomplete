void eb_mul_dig(eb_t r, const eb_t p, dig_t k) {
	eb_t t;

	if (k == 0 || eb_is_infty(p)) {
		eb_set_infty(r);
		return;
	}

	eb_null(t);

	RLC_TRY {
		eb_new(t);

		eb_copy(t, p);
		for (int i = util_bits_dig(k) - 2; i >= 0; i--) {
			eb_dbl(t, t);
			if (k & ((dig_t)1 << i)) {
				eb_add(t, t, p);
			}
		}

		eb_norm(r, t);
	}
	RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	}
	RLC_FINALLY {
		eb_free(t);
	}
}
