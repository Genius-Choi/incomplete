int cp_pbpsi_int(bn_t z[], size_t *len, const g2_t d[], const bn_t x[],
		size_t m, const gt_t t[], const g1_t u[], size_t n) {
	int j, k, result = RLC_OK;
	gt_t e;

	gt_null(e);

	RLC_TRY {
		gt_new(e);

		*len = 0;
		if (m > 0) {
			for (k = 0; k < m; k++) {
				for (j = 0; j < n; j++) {
					pc_map(e, u[j], d[k + 1]);
					if (gt_cmp(e, t[j]) == RLC_EQ && !gt_is_unity(e)) {
						bn_copy(z[*len], x[k]);
						(*len)++;
					}
				}
			}
		}
	}
	RLC_CATCH_ANY {
		result = RLC_ERR;
	}
	RLC_FINALLY {
		gt_free(e);
	}
	return result;
}
