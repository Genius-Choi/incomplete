static void mpss(void) {
	bn_t m[2], n, u[2], v[2], ms[10][2], _v[10][2];
	g1_t g, s[2];
	g2_t h, x[2], y[2], _y[10][2];
	gt_t r[2];
	mt_t tri[3][2];
	pt_t t[2];

	bn_null(n);
	g1_null(g);
	g2_null(h);

	bn_new(n);
	g1_new(g);
	g2_new(h);
	for (int i = 0; i < 2; i++) {
		bn_null(m[i]);
		bn_null(u[i]);
		bn_null(v[i]);
		g1_null(s[i]);
		g2_null(x[i]);
		g2_null(y[i]);
		gt_null(r[i]);
		mt_null(tri[0][i]);
		mt_null(tri[1][i]);
		mt_null(tri[2][i]);
		pt_null(t[i]);
		bn_new(m[i]);
		bn_new(u[i]);
		bn_new(v[i]);
		g1_new(s[i]);
		g2_new(x[i]);
		g2_new(y[i]);
		gt_new(r[i]);
		mt_new(tri[0][i]);
		mt_new(tri[1][i]);
		mt_new(tri[2][i]);
		pt_new(t[i]);

		g1_get_ord(n);
		for (int j = 0; j < 10; j++) {
			bn_null(ms[j][i]);
			bn_null(_v[j][i]);
			g2_null(_y[j][i]);
			bn_new(ms[j][i]);
			bn_rand_mod(ms[j][i], n);
			bn_new(_v[j][i]);
			g2_new(_y[j][i]);
		}
	}

	pc_map_tri(t);
	mpc_mt_gen(tri[0], n);
	mpc_mt_gen(tri[1], n);
	mpc_mt_gen(tri[2], n);

	bn_rand_mod(m[0], n);
	bn_rand_mod(m[1], n);
	bn_sub(m[0], m[1], m[0]);
	if (bn_sign(m[0]) == RLC_NEG) {
		bn_add(m[0], m[0], n);
	}
	gt_exp_gen(r[0], tri[2][0]->c);
	gt_exp_gen(r[1], tri[2][1]->c);
	tri[2][0]->bt = &r[0];
	tri[2][1]->bt = &r[1];
	tri[2][0]->ct = &r[0];
	tri[2][1]->ct = &r[1];

	BENCH_RUN("cp_mpss_gen") {
		BENCH_ADD(cp_mpss_gen(u, v, h, x, y));
	} BENCH_END;

	BENCH_RUN("cp_mpss_bct") {
		BENCH_ADD(cp_mpss_bct(x, y));
	} BENCH_END;

	BENCH_RUN("cp_mpss_sig") {
		BENCH_ADD(cp_mpss_sig(g, s, m, u, v, tri[0], tri[1]));
	} BENCH_DIV(2);

	BENCH_RUN("cp_mpss_ver") {
		BENCH_ADD(cp_mpss_ver(r[0], g, s, m, h, x[0], y[0], tri[2], t));
	} BENCH_DIV(2);

	g1_get_ord(n);
	pc_map_tri(t);
	mpc_mt_gen(tri[0], n);
	mpc_mt_gen(tri[1], n);
	mpc_mt_gen(tri[2], n);

	BENCH_RUN("cp_mpsb_gen (10)") {
		BENCH_ADD(cp_mpsb_gen(u, _v, h, x, _y, 10));
	} BENCH_END;

	BENCH_RUN("cp_mpsb_bct (10)") {
		BENCH_ADD(cp_mpsb_bct(x, _y, 10));
	} BENCH_END;

	BENCH_RUN("cp_mpsb_sig (10)") {
		BENCH_ADD(cp_mpsb_sig(g, s, ms, u, _v, tri[0], tri[1], 10));
	} BENCH_DIV(2);

	BENCH_RUN("cp_mpsb_ver (10)") {
		BENCH_ADD(cp_mpsb_ver(r[1], g, s, ms, h, x[0], _y, NULL, tri[2], t, 10));
	} BENCH_DIV(2);

	BENCH_RUN("cp_mpsb_ver (10,sk)") {
		BENCH_ADD(cp_mpsb_ver(r[1], g, s, ms, h, x[0], _y, _v, tri[2], t, 10));
	} BENCH_DIV(2);

	bn_free(n);
	g1_free(g);
	g2_free(h);
	for (int i = 0; i < 2; i++) {
		bn_free(m[i]);
		bn_free(u[i]);
		bn_free(v[i]);
		g1_free(s[i]);
		g2_free(x[i]);
		g2_free(y[i]);
		gt_null(r[i]);
		mt_free(tri[0][i]);
		mt_free(tri[1][i]);
		mt_free(tri[2][i]);
		pt_free(t[i]);
		for (int j = 0; j < 10; j++) {
			bn_free(ms[j][i]);
			bn_free(_v[j][i]);
			g2_free(_y[j][i]);
		}
	}
}
