static void paillier(void) {
	bn_t c, m, pub;
	phpe_t prv;
    shpe_t spub, sprv;

	bn_null(c);
	bn_null(m);
	bn_null(pub);
	phpe_null(prv);
    shpe_null(spub);
    shpe_null(sprv);


	bn_new(c);
	bn_new(m);
	bn_new(pub);
	phpe_new(prv);
    shpe_new(spub);
    shpe_new(sprv);

	BENCH_ONE("cp_phpe_gen", cp_phpe_gen(pub, prv, RLC_BN_BITS / 2), 1);

	BENCH_RUN("cp_phpe_enc") {
		bn_rand_mod(m, pub);
		BENCH_ADD(cp_phpe_enc(c, m, pub));
	} BENCH_END;

	BENCH_RUN("cp_phpe_add") {
		bn_rand_mod(m, pub);
		cp_phpe_enc(c, m, pub);
		BENCH_ADD(cp_phpe_add(c, c, c, pub));
	} BENCH_END;

	BENCH_RUN("cp_phpe_dec") {
		bn_rand_mod(m, pub);
		cp_phpe_enc(c, m, pub);
		BENCH_ADD(cp_phpe_dec(m, c, prv));
	} BENCH_END;

	BENCH_ONE("cp_shpe_gen", cp_shpe_gen(spub, sprv, RLC_BN_BITS / 10, RLC_BN_BITS / 2), 1);

	BENCH_RUN("cp_shpe_enc") {
		bn_rand_mod(m, spub->crt->n);
		BENCH_ADD(cp_shpe_enc(c, m, spub));
	} BENCH_END;

	BENCH_RUN("cp_shpe_enc_prv") {
		bn_rand_mod(m, spub->crt->n);
		BENCH_ADD(cp_shpe_enc_prv(c, m, sprv));
	} BENCH_END;

	BENCH_RUN("cp_shpe_dec (1)") {
		bn_rand_mod(m, spub->crt->n);
		cp_shpe_enc(c, m, spub);
		BENCH_ADD(cp_shpe_dec(m, c, sprv));
	} BENCH_END;

	BENCH_RUN("cp_shpe_dec (2)") {
		bn_rand_mod(m, spub->crt->n);
		cp_shpe_enc_prv(c, m, sprv);
		BENCH_ADD(cp_shpe_dec(m, c, sprv));
	} BENCH_END;

	BENCH_ONE("cp_ghpe_gen", cp_ghpe_gen(pub, prv->n, RLC_BN_BITS / 2), 1);

	BENCH_RUN("cp_ghpe_enc (1)") {
		bn_rand_mod(m, pub);
		BENCH_ADD(cp_ghpe_enc(c, m, pub, 1));
	} BENCH_END;

	BENCH_RUN("cp_ghpe_dec (1)") {
		bn_rand_mod(m, pub);
		cp_ghpe_enc(m, c, pub, 1);
		BENCH_ADD(cp_ghpe_dec(c, m, pub, prv->n, 1));
	} BENCH_END;

	BENCH_ONE("cp_ghpe_gen", cp_ghpe_gen(pub, prv->n, RLC_BN_BITS / 4), 1);

	BENCH_RUN("cp_ghpe_enc (2)") {
		bn_rand(m, RLC_POS, 2 * bn_bits(pub) - 1);
		BENCH_ADD(cp_ghpe_enc(m, c, pub, 2));
	} BENCH_END;

	BENCH_RUN("cp_ghpe_dec (2)") {
		bn_rand(m, RLC_POS, 2 * bn_bits(pub) - 1);
		cp_ghpe_enc(m, c, pub, 2);
		BENCH_ADD(cp_ghpe_dec(c, m, pub, prv->n, 2));
	} BENCH_END;

	bn_free(c);
	bn_free(m);
	bn_free(pub);
	phpe_free(prv);
    shpe_free(spub);
    shpe_free(sprv);
}
