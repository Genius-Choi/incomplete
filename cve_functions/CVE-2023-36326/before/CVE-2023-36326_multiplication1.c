static int multiplication1(void) {
	int code = RLC_ERR;
	g1_t p, q, r;
	bn_t n, k;

	bn_null(n);
	bn_null(k);
	g1_null(p);
	g1_null(q);
	g1_null(r);

	RLC_TRY {
		g1_new(p);
		g1_new(q);
		g1_new(r);
		bn_new(n);
		bn_new(k);

		g1_get_gen(p);
		pc_get_ord(n);

		TEST_CASE("generator has the right order") {
			g1_mul(r, p, n);
			TEST_ASSERT(g1_is_infty(r) == 1, end);
		} TEST_END;

		TEST_CASE("generator multiplication is correct") {
			bn_zero(k);
			g1_mul_gen(r, k);
			TEST_ASSERT(g1_is_infty(r), end);
			bn_set_dig(k, 1);
			g1_mul_gen(r, k);
			TEST_ASSERT(g1_cmp(p, r) == RLC_EQ, end);
			bn_rand_mod(k, n);
			g1_mul(q, p, k);
			g1_mul_gen(r, k);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
			bn_neg(k, k);
			g1_mul_gen(r, k);
			g1_neg(r, r);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
		} TEST_END;

		TEST_CASE("random element has the right order") {
			g1_rand(p);
			g1_mul(r, p, n);
			TEST_ASSERT(g1_is_infty(r) == 1, end);
		} TEST_END;

		TEST_CASE("point multiplication by digit is correct") {
			g1_mul_dig(r, p, 0);
			TEST_ASSERT(g1_is_infty(r), end);
			g1_mul_dig(r, p, 1);
			TEST_ASSERT(g1_cmp(p, r) == RLC_EQ, end);
			bn_rand(k, RLC_POS, RLC_DIG);
			g1_mul(q, p, k);
			g1_mul_dig(r, p, k->dp[0]);
			TEST_ASSERT(g1_cmp(q, r) == RLC_EQ, end);
		}
		TEST_END;
	}
	RLC_CATCH_ANY {
		util_print("FATAL ERROR!\n");
		RLC_ERROR(end);
	}
	code = RLC_OK;
  end:
	g1_free(p);
	g1_free(q);
	g1_free(r);
	bn_free(n);
	bn_free(k);
	return code;
}
