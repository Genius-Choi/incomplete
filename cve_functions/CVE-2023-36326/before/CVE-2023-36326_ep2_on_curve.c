int ep2_on_curve(const ep2_t p) {
	ep2_t t;
	int r = 0;

	ep2_null(t);

	RLC_TRY {
		ep2_new(t);

		ep2_norm(t, p);

		ep2_rhs(t->x, t);
		fp2_sqr(t->y, t->y);

		r = (fp2_cmp(t->x, t->y) == RLC_EQ) || ep2_is_infty(p);
	} RLC_CATCH_ANY {
		RLC_THROW(ERR_CAUGHT);
	} RLC_FINALLY {
		ep2_free(t);
	}
	return r;
}
