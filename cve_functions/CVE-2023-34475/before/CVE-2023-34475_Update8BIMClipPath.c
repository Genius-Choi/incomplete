MagickPrivate void Update8BIMClipPath(const Image *image,
  const size_t old_columns,const size_t old_rows,
  const RectangleInfo *new_geometry)
{
  const StringInfo
    *profile;

  size_t
    length;

  ssize_t
    count,
    id;

  unsigned char
    *info;

  assert(image != (Image *) NULL);
  assert(new_geometry != (RectangleInfo *) NULL);
  profile=GetImageProfile(image,"8bim");
  if (profile == (StringInfo *) NULL)
    return;
  length=GetStringInfoLength(profile);
  info=GetStringInfoDatum(profile);
  while (length > 0)
  {
    if (ReadProfileByte(&info,&length) != (unsigned char) '8')
      continue;
    if (ReadProfileByte(&info,&length) != (unsigned char) 'B')
      continue;
    if (ReadProfileByte(&info,&length) != (unsigned char) 'I')
      continue;
    if (ReadProfileByte(&info,&length) != (unsigned char) 'M')
      continue;
    id=(ssize_t) ReadProfileMSBShort(&info,&length);
    count=(ssize_t) ReadProfileByte(&info,&length);
    if ((count != 0) && ((size_t) count <= length))
      {
        info+=count;
        length-=count;
      }
    if ((count & 0x01) == 0)
      (void) ReadProfileByte(&info,&length);
    count=(ssize_t) ReadProfileMSBLong(&info,&length);
    if ((count < 0) || ((size_t) count > length))
      {
        length=0;
        continue;
      }
    if ((id > 1999) && (id < 2999))
      UpdateClipPath(info,(size_t) count,old_columns,old_rows,new_geometry);
    info+=count;
    length-=MagickMin(count,(ssize_t) length);
  }
}
