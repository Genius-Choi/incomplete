DWORD NSISCALL WaitForProcess(HANDLE hProcess)
{
  DWORD excod;
  while (WaitForSingleObject(hProcess, 100) == WAIT_TIMEOUT)
    MessageLoop(WM_PAINT);

  GetExitCodeProcess(hProcess, &excod);
  return excod;
}
