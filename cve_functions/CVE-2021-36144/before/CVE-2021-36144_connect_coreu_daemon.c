connect_coreu_daemon()
{
	struct sockaddr_un addr;
	int msg_size;
	int fd;
	int ret;

	fd = socket(AF_UNIX, SOCK_STREAM, 0);
	if (fd < 0) {
		WPRINTF(("socket error %d\n", errno));
		return -1;
	}

	memset(&addr, 0, sizeof(addr));
	addr.sun_family = AF_UNIX;
	strncpy(addr.sun_path, COREU_SERVICE_NAME, sizeof(addr.sun_path));

	ret = connect(fd, &addr, sizeof(struct sockaddr_un));
	if (ret < 0) {
		WPRINTF(("connect error %d\n", errno));
		close(fd);
		return -1;
	}

	msg_size = sizeof(struct coreu_msg);
	ret = setsockopt(fd, SOL_SOCKET,
		SO_RCVLOWAT, &msg_size, sizeof(msg_size));
	if (ret < 0) {
		WPRINTF(("setsockopt error\n"));
		close(fd);
		return -1;
	}
	return fd;
}
