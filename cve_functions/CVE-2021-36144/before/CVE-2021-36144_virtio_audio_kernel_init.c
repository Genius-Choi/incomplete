virtio_audio_kernel_init(struct virtio_audio *virt_audio)
{
	if (virt_audio->vbs_k.audio_fd != -1) {
		WPRINTF(("virtio_audio: Ooops! Re-entered!!\n"));
		return -VIRTIO_ERROR_REENTER;
	}

	virt_audio->vbs_k.audio_fd = open(vbs_k_audio_dev_path, O_RDWR);
	if (virt_audio->vbs_k.audio_fd < 0) {
		WPRINTF(("virtio_audio: Failed to open %s!\n",
			 vbs_k_audio_dev_path));
		return -VIRTIO_ERROR_FD_OPEN_FAILED;
	}
	DPRINTF(("virtio_audio: Open %s success!\n",
		 vbs_k_audio_dev_path));

	memset(&virt_audio->vbs_k.kdev, 0, sizeof(struct vbs_dev_info));
	memset(&virt_audio->vbs_k.kvqs, 0, sizeof(struct vbs_vqs_info));

	return VIRTIO_SUCCESS;
}
