virtio_input_get_bitmap(struct virtio_input *vi, unsigned int cmd, int count,
			struct virtio_input_config *cfg)
{
	int i, size = -1;
	int rc;

	if (count <= 0)
		return -1;

	if (!cfg)
		return -1;

	memset(cfg, 0, sizeof(*cfg));
	rc = ioctl(vi->fd, cmd, cfg->u.bitmap);
	if (rc < 0)
		return -1;

	count = count / 8;
	for (i = count - 1; i >= 0; i--) {
		if (cfg->u.bitmap[i]) {
			size = i + 1;
			break;
		}
	}

	return size;
}
