vm_monitor_blkrescan(void *arg, char *devargs)
{
	char *str;
	char *str_slot, *str_newpath;
	int slot;
	int error = 0;
	struct pci_vdev *dev;
	struct vmctx *ctx = (struct vmctx *)arg;

	/*Extract slot,path and additional params from args*/
	str = strdup(devargs);

	str_slot = strsep(&str, ",");
	str_newpath = strsep(&str, "");

	if ((str_slot != NULL) && (str_newpath != NULL)) {
		error = dm_strtoi(str_slot, &str_slot, 10, &slot);
		if (error) {
			pr_err("Incorrect slot, error=0x%x!\n", error);
			goto end;
		}

	} else {
		pr_err("Slot info or path not available!");
		error = -1;
		goto end;
	}

	dev = pci_get_vdev_info(slot);
	if (dev == NULL) {
		pr_err("vdev info failed for Slot %d\n!", slot);
		error = -1;
		goto end;
	}

	if (strstr(dev->name, "virtio-blk") == NULL) {
		error = -1;
		pr_err("virtio-blk only supports rescan: found %s at slot %d\n", dev->name, slot);
	} else {
		error = virtio_blk_rescan(ctx, dev, str_newpath);
		if (error) {
			pr_err("virtio-blk rescan failed!");
		}
	}
end:
	if (str)
		free(str);
	return error;
}
