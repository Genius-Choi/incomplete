vmei_notify_tx(void *data, struct virtio_vq_info *vq)
{
	struct virtio_mei *vmei = data;
	/*
	 * Any ring entries to process?
	 */
	if (!vq_has_descs(vq))
		return;

	pthread_mutex_lock(&vmei->tx_mutex);
	DPRINTF("TX: New OUT buffer available!\n");
	vq->used->flags |= VRING_USED_F_NO_NOTIFY;
	pthread_mutex_unlock(&vmei->tx_mutex);

	do {
		vmei_proc_tx(vmei, vq);
	} while (vq_has_descs(vq));

	vq_endchains(vq, 1);

	pthread_mutex_lock(&vmei->tx_mutex);
	DPRINTF("TX: New OUT buffer available!\n");
	vq_clear_used_ring_flags(&vmei->base, vq);
	pthread_mutex_unlock(&vmei->tx_mutex);
}
