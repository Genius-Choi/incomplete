int cmd_submodule__helper(int argc, const char **argv, const char *prefix)
{
	const char *cmd = argv[0];
	const char *subcmd;
	parse_opt_subcommand_fn *fn = NULL;
	const char *const usage[] = {
		N_("git submodule--helper <command>"),
		NULL
	};
	struct option options[] = {
		OPT_SUBCOMMAND("clone", &fn, module_clone),
		OPT_SUBCOMMAND("add", &fn, module_add),
		OPT_SUBCOMMAND("update", &fn, module_update),
		OPT_SUBCOMMAND("foreach", &fn, module_foreach),
		OPT_SUBCOMMAND("init", &fn, module_init),
		OPT_SUBCOMMAND("status", &fn, module_status),
		OPT_SUBCOMMAND("sync", &fn, module_sync),
		OPT_SUBCOMMAND("deinit", &fn, module_deinit),
		OPT_SUBCOMMAND("summary", &fn, module_summary),
		OPT_SUBCOMMAND("push-check", &fn, push_check),
		OPT_SUBCOMMAND("absorbgitdirs", &fn, absorb_git_dirs),
		OPT_SUBCOMMAND("set-url", &fn, module_set_url),
		OPT_SUBCOMMAND("set-branch", &fn, module_set_branch),
		OPT_SUBCOMMAND("create-branch", &fn, module_create_branch),
		OPT_END()
	};
	argc = parse_options(argc, argv, prefix, options, usage, 0);
	subcmd = argv[0];

	if (strcmp(subcmd, "clone") && strcmp(subcmd, "update") &&
	    strcmp(subcmd, "foreach") && strcmp(subcmd, "status") &&
	    strcmp(subcmd, "sync") && strcmp(subcmd, "absorbgitdirs") &&
	    get_super_prefix())
		/*
		 * xstrfmt() rather than "%s %s" to keep the translated
		 * string identical to git.c's.
		 */
		die(_("%s doesn't support --super-prefix"),
		    xstrfmt("'%s %s'", cmd, subcmd));

	return fn(argc, argv, prefix);
}
