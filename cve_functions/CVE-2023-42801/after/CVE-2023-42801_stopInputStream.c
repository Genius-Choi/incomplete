int stopInputStream(void) {
    // Signal the input send thread
    LbqSignalQueueShutdown(&packetQueue);
    PltInterruptThread(&inputSendThread);

    if (inputSock != INVALID_SOCKET) {
        shutdownTcpSocket(inputSock);
    }

    PltJoinThread(&inputSendThread);
    PltCloseThread(&inputSendThread);
    
    if (inputSock != INVALID_SOCKET) {
        closeSocket(inputSock);
        inputSock = INVALID_SOCKET;
    }

    return 0;
}
