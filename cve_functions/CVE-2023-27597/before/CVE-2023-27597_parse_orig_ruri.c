int parse_orig_ruri(struct sip_msg* msg)
{
	str *uri;

	if (msg->parsed_orig_ruri_ok)
		return 1;

	uri = &REQ_LINE(msg).uri;

	if (parse_uri(uri->s, uri->len, &msg->parsed_orig_ruri)<0) {
		LM_ERR("bad uri <%.*s>\n", uri->len, ZSW(uri->s));
		msg->parsed_orig_ruri_ok = 0;
		set_err_info(OSER_EC_PARSER, OSER_EL_MEDIUM,
				"error parsing incoming uri");
		set_err_reply(400, "bad i-uri");
		return -1;
	}

	msg->parsed_orig_ruri_ok = 1;
	return 0;
}
