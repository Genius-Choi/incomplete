void cpdbConnectToDBus(cpdb_frontend_obj_t *f)
{
    GMainContext *context;

    if ((f->connection = get_dbus_connection()) == NULL)
    {
        loginfo("Couldn't connect to DBus\n");
        return;
    }
    
    f->own_id = g_bus_own_name_on_connection(f->connection,
                                             f->bus_name,
                                             0,
                                             on_name_acquired,
                                             on_name_lost,
                                             f,
                                             NULL);

    // Wait till either of name acquired/lost callbacks finish
    context = g_main_context_get_thread_default();
    while (!f->name_done)
    {
        g_main_context_iteration(context, TRUE);
    }
}
