static int send_command(ssh_stream *s)
{
	int error;
	git_str request = GIT_STR_INIT;

	error = gen_proto(&request, s->cmd, &s->url);
	if (error < 0)
		goto cleanup;

	error = libssh2_channel_exec(s->channel, request.ptr);
	if (error < LIBSSH2_ERROR_NONE) {
		ssh_error(s->session, "SSH could not execute request");
		goto cleanup;
	}

	s->sent_command = 1;

cleanup:
	git_str_dispose(&request);
	return error;
}
