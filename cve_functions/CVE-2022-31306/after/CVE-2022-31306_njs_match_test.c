njs_match_test(njs_opts_t *opts, njs_str_t *name)
{
    u_char  *p, *start, *end;
    size_t  len;

    if (name->length == 0) {
        return 0;
    }

    if (opts->filter.length == 0) {
        return 1;
    }

    start = opts->filter.start;
    end = start + opts->filter.length;

    for ( ;; ) {
        p = njs_strlchr(start, end, '|');
        len = ((p != NULL) ? p : end) - start;
        len = njs_min(name->length, len);

        if (len != 0 && njs_strncmp(name->start, start, len) == 0) {
            return 1;
        }

        if (p == NULL) {
            break;
        }

        start = p + 1;
    }

    return 0;
}
