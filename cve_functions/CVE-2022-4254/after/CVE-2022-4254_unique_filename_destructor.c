static int unique_filename_destructor(void *memptr)
{
    struct tmpfile_watch *tw = talloc_get_type(memptr, struct tmpfile_watch);

    if (tw == NULL || tw->filename == NULL) {
        DEBUG(SSSDBG_CRIT_FAILURE, "BUG: Wrong private pointer\n");
        return -1;
    }

    DEBUG(SSSDBG_TRACE_INTERNAL, "Unlinking [%s]\n", tw->filename);

    return unlink_dbg(tw->filename);
}
