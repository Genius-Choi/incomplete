static struct tmpfile_watch *tmpfile_watch_set(TALLOC_CTX *owner,
                                               const char *filename)
{
    struct tmpfile_watch *tw = NULL;

    tw = talloc_zero(owner, struct tmpfile_watch);
    if (tw == NULL) {
        return NULL;
    }

    tw->filename = talloc_strdup(tw, filename);
    if (tw->filename == NULL) {
        talloc_free(tw);
        return NULL;
    }

    talloc_set_destructor((TALLOC_CTX *) tw,
                          unique_filename_destructor);
    return tw;
}
