  explicit ExtractGlimpseOp(OpKernelConstruction* context) : OpKernel(context) {
    const string& op = context->def().op();
    version_ = (op == "ExtractGlimpse") ? 1 : 2;
    OP_REQUIRES_OK(context, context->GetAttr("normalized", &normalized_));
    OP_REQUIRES_OK(context, context->GetAttr("centered", &centered_));
    bool uniform_noise = false;
    string noise;
    OP_REQUIRES_OK(context, context->GetAttr("uniform_noise", &uniform_noise));
    OP_REQUIRES_OK(context, context->GetAttr("noise", &noise));
    OP_REQUIRES(context,
                !(uniform_noise && (!noise.empty() && noise != "uniform")),
                errors::InvalidArgument("The uniform_noise and noise could not "
                                        "be specified at the same time"));
    if (noise.empty()) {
      noise_ = uniform_noise ? Eigen::ExtractGlimpsesNoiseMode::UNIFORM
                             : Eigen::ExtractGlimpsesNoiseMode::GAUSSIAN;
    } else {
      OP_REQUIRES(context,
                  noise == "uniform" || noise == "gaussian" || noise == "zero",
                  errors::InvalidArgument(
                      "The noise could only be uniform, gaussian, or zero, got",
                      noise));
      if (noise == "uniform") {
        noise_ = Eigen::ExtractGlimpsesNoiseMode::UNIFORM;
      } else if (noise == "gaussian") {
        noise_ = Eigen::ExtractGlimpsesNoiseMode::GAUSSIAN;
      } else {
        noise_ = Eigen::ExtractGlimpsesNoiseMode::ZERO;
      }
    }
  }
