static char *handle_cli_iax2_prune_realtime(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)
{
	struct iax2_peer *peer;

	switch (cmd) {
	case CLI_INIT:
		e->command = "iax2 prune realtime";
		e->usage =
			"Usage: iax2 prune realtime [<peername>|all]\n"
			"       Prunes object(s) from the cache\n";
		return NULL;
	case CLI_GENERATE:
		return complete_iax2_show_peer(a->line, a->word, a->pos, a->n);
	}

	if (a->argc != 4)
        return CLI_SHOWUSAGE;
	if (!strcmp(a->argv[3], "all")) {
		reload_config();
		ast_cli(a->fd, "Cache flushed successfully.\n");
	} else if ((peer = find_peer(a->argv[3], 0))) {
		if(ast_test_flag(peer, IAX_RTCACHEFRIENDS)) {
			ast_set_flag(peer, IAX_RTAUTOCLEAR);
			expire_registry(peer_ref(peer));
			ast_cli(a->fd, "Peer %s was removed from the cache.\n", a->argv[3]);
		} else {
			ast_cli(a->fd, "Peer %s is not eligible for this operation.\n", a->argv[3]);
		}
		peer_unref(peer);
	} else {
		ast_cli(a->fd, "Peer %s was not found in the cache.\n", a->argv[3]);
	}
	
	return CLI_SUCCESS;
}
