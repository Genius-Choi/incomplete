static int reload_config(void)
{
	char *config = "iax.conf";
	struct iax2_registry *reg;

	if (set_config(config, 1) > 0) {
		prune_peers();
		prune_users();
		trunk_timed = trunk_untimed = 0; 
		trunk_nmaxmtu = trunk_maxmtu = 0; 

		AST_LIST_LOCK(&registrations);
		AST_LIST_TRAVERSE(&registrations, reg, entry)
			iax2_do_register(reg);
		AST_LIST_UNLOCK(&registrations);

		/* Qualify hosts, too */
		poke_all_peers();
	}
	
	reload_firmware(0);
	iax_provision_reload(1);

	return 0;
}
