static void peer_destructor(void *obj)
{
	struct iax2_peer *peer = obj;

	ast_free_ha(peer->ha);

	if (peer->callno > 0) {
		ast_mutex_lock(&iaxsl[peer->callno]);
		iax2_destroy(peer->callno);
		ast_mutex_unlock(&iaxsl[peer->callno]);
	}

	register_peer_exten(peer, 0);

	if (peer->dnsmgr)
		ast_dnsmgr_release(peer->dnsmgr);

	if (peer->mwi_event_sub)
		ast_event_unsubscribe(peer->mwi_event_sub);

	ast_string_field_free_memory(peer);
}
