X509_cmp_time_internal(const ASN1_TIME *ctm, time_t *cmp_time, int is_notafter)
{
	time_t compare, cert_time;

	if (cmp_time == NULL)
		compare = time(NULL);
	else
		compare = *cmp_time;

	if ((cert_time = x509_verify_asn1_time_to_time_t(ctm, is_notafter)) ==
	    -1)
		return 0; /* invalid time */

	if (cert_time <= compare)
		return -1; /* 0 is used for error, so map same to less than */

	return 1;
}
