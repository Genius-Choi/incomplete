ssize_t clif_add_target(const char *target, char *buf, size_t maxlen)
{
    assert(target);

    size_t pos = 0;
    size_t target_len = strlen(target);

    if (!buf) {
        return target_len + 2; /* size after adding '<' and '>' */
    }

    if ((target_len + 2) > maxlen) {
        return CLIF_NO_SPACE;
    }

    buf[pos++] = LF_PATH_BEGIN_C;

    memcpy(&buf[pos], target, target_len);
    pos += target_len;

    buf[pos++] = LF_PATH_END_C;

    return pos;
}
