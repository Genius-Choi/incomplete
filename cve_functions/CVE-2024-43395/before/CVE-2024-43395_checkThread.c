static void* checkThread(void* arg) {
#ifdef __APPLE__
    pthread_setname_np("HTTP Check Thread");
#endif
#ifdef __ANDROID__
    Android_JNI_SetupThread();
#endif
    http_param_t * param = (http_param_t*)arg;
    std::string status;
    if (param->url.find(':') == std::string::npos) status = "Must specify http or https";
    else if (param->url.find("://") == std::string::npos) status = "URL malformed";
    else if (param->url.substr(0, 7) != "http://" && param->url.substr(0, 8) != "https://") status = "Invalid protocol '" + param->url.substr(0, param->url.find("://")) + "'";
    else {
        Poco::URI uri;
        try {
            uri = Poco::URI(param->url);
        } catch (Poco::SyntaxException &e) {
            status = "URL malformed";
        }
        if (status.empty()) {
            bool found = false;
            for (const std::string& wclass : config.http_whitelist) {
                if (matchIPClass(uri.getHost(), wclass)) {
                    found = true;
                    for (const std::string& bclass : config.http_blacklist) {
                        if (matchIPClass(uri.getHost(), bclass)) {
                            found = false;
                            break;
                        }
                    }
                    if (!found) break;
                }
            }
            if (!found) status = "Domain not permitted";
        }
    }
    http_check_t * res = new http_check_t;
    res->url = param->url;
    res->status = status;
    queueEvent(param->comp, http_check, res);
    delete param;
    return NULL;
}
