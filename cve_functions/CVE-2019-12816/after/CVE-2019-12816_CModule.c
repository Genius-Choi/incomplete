CModule::CModule(ModHandle pDLL, CUser* pUser, CIRCNetwork* pNetwork,
                 const CString& sModName, const CString& sDataDir,
                 CModInfo::EModuleType eType)
    : m_eType(eType),
      m_sDescription(""),
      m_sTimers(),
      m_sSockets(),
#ifdef HAVE_PTHREAD
      m_sJobs(),
#endif
      m_pDLL(pDLL),
      m_pManager(&(CZNC::Get().GetManager())),
      m_pUser(pUser),
      m_pNetwork(pNetwork),
      m_pClient(nullptr),
      m_sModName(sModName),
      m_sDataDir(sDataDir),
      m_sSavePath(""),
      m_sArgs(""),
      m_sModPath(""),
      m_Translation("znc-" + sModName),
      m_mssRegistry(),
      m_vSubPages(),
      m_mCommands() {
    if (m_pNetwork) {
        m_sSavePath = m_pNetwork->GetNetworkPath() + "/moddata/" + m_sModName;
    } else if (m_pUser) {
        m_sSavePath = m_pUser->GetUserPath() + "/moddata/" + m_sModName;
    } else {
        m_sSavePath = CZNC::Get().GetZNCPath() + "/moddata/" + m_sModName;
    }
    LoadRegistry();
}
