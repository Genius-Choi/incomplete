static int decode_bgp_link_nlri_srv6_sid_descriptors(tvbuff_t *tvb,
        proto_tree *tree, gint offset, packet_info *pinfo, int length) {

    guint16 sub_length;
    guint16 type;
    guint16 diss_length;
    guint16 tmp16;

    proto_item* tlv_item;
    proto_tree* tlv_tree;
    proto_item* tlv_sub_item;
    proto_tree* tlv_sub_tree;

    tlv_item = proto_tree_add_item(tree, hf_bgp_ls_nlri_srv6_sid_descriptors_tlv, tvb, offset, length + 4, ENC_NA);
    tlv_tree = proto_item_add_subtree(tlv_item, ett_bgp_mp_reach_nlri);

    diss_length = 0;
    while (length > 0) {
        if (length < 4) {
            expert_add_info_format(pinfo, tree, &ei_bgp_ls_error,
                    "Unknown data in Link-State SRv6 SID NLRI!");
            diss_length += length;
            break;
        }

        type = tvb_get_ntohs(tvb, offset);
        sub_length = tvb_get_ntohs(tvb, offset + 2);
        switch (type) {
        case BGP_NLRI_TLV_MULTI_TOPOLOGY_ID:
            if(sub_length != BGP_NLRI_TLV_LEN_MULTI_TOPOLOGY_ID){
                expert_add_info_format(pinfo, tlv_tree, &ei_bgp_ls_error,
                                       "Unexpected Multi Topology ID TLV's length (%u), it must be %u bytes!",
                                       sub_length, BGP_NLRI_TLV_LEN_MULTI_TOPOLOGY_ID);
                return -1;
            }
            tlv_sub_item = proto_tree_add_item(tlv_tree,
                                               hf_bgp_ls_tlv_multi_topology_id, tvb, offset, sub_length + 4,
                                               ENC_NA);
            tlv_sub_tree = proto_item_add_subtree(tlv_sub_item, ett_bgp_mp_reach_nlri);
            break;

        case BGP_NLRI_TLV_SRV6_SID_INFO:
            if (sub_length != 16) {
                expert_add_info_format(pinfo, tlv_tree, &ei_bgp_ls_error,
                                       "Unexpected SRv6 SID Information TLV's length (%u), it must be 16 bytes!",
                                       sub_length);
                return -1;
            }
            tlv_sub_item = proto_tree_add_item(tlv_tree,
                                               hf_bgp_ls_tlv_srv6_sid_info, tvb, offset, sub_length + 4,
                                               ENC_NA);
            tlv_sub_tree = proto_item_add_subtree(tlv_sub_item, ett_bgp_mp_reach_nlri);
            break;

        default:
            expert_add_info_format(pinfo, tlv_tree, &ei_bgp_ls_error,
                                   "Unknown SRv6 SID Descriptor TLV Code (%u)!", type);
            return -1;
        }

        proto_tree_add_item(tlv_sub_tree, hf_bgp_ls_type, tvb, offset, 2, ENC_BIG_ENDIAN);
        proto_tree_add_item(tlv_sub_tree, hf_bgp_ls_length, tvb, offset + 2, 2, ENC_BIG_ENDIAN);

        switch (type) {
        case BGP_NLRI_TLV_MULTI_TOPOLOGY_ID:
            tmp16 = tvb_get_ntohs(tvb, offset + 4);
            tmp16 >>= 12;
            if (tmp16) {
                expert_add_info_format(pinfo, tlv_sub_tree, &ei_bgp_ls_error, "Reserved bits of Multi Topology ID must be set to zero! (%u)", tmp16);
            }
            proto_tree_add_item(tlv_sub_tree, hf_bgp_ls_nlri_multi_topology_id,
                                tvb, offset + 4, BGP_NLRI_TLV_LEN_MULTI_TOPOLOGY_ID, ENC_BIG_ENDIAN);
            break;

        case BGP_NLRI_TLV_SRV6_SID_INFO:
            proto_tree_add_item(tlv_sub_tree, hf_bgp_ls_tlv_srv6_sid_info_sid,
                                tvb, offset + 4, 16, ENC_NA);
            break;
        }

        length -= 4 + sub_length;
        offset += 4 + sub_length;
        diss_length += 4 + sub_length;
    }
    return diss_length;
}
