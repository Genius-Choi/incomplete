decode_mp_next_hop_vpn_ipv6(tvbuff_t *tvb, proto_tree *tree, gint offset, packet_info *pinfo, wmem_strbuf_t *strbuf, gint nhlen)
{
    proto_item    *ti;
    const char    *rd_string;
    const guint8   rd_zero[] = {0x00, 0x00, 0x00, 0x00,
                                0x00, 0x00, 0x00, 0x00 };
    ws_in6_addr    ipv6_addr;
    char           ipv6_buffer[WS_INET6_ADDRSTRLEN];

    switch (nhlen) {
        case (BGP_ROUTE_DISTINGUISHER_SIZE + FT_IPv6_LEN):
            rd_string = decode_bgp_rd(pinfo->pool, tvb, offset);
            ti = proto_tree_add_string(tree, hf_bgp_update_path_attribute_mp_reach_nlri_next_hop_rd, tvb, offset, BGP_ROUTE_DISTINGUISHER_SIZE, rd_string);
            if (tvb_memeql(tvb, offset, rd_zero, BGP_ROUTE_DISTINGUISHER_SIZE) != 0) {
                expert_add_info(pinfo, ti, &ei_bgp_next_hop_rd_nonzero);
            }
            wmem_strbuf_append_printf(strbuf, " RD=%s", rd_string);
            offset += BGP_ROUTE_DISTINGUISHER_SIZE;
            proto_tree_add_item(tree, hf_bgp_update_path_attribute_mp_reach_nlri_next_hop_ipv6, tvb, offset, FT_IPv6_LEN, ENC_NA);
            wmem_strbuf_append_printf(strbuf, " IPv6=%s", tvb_ip6_to_str(pinfo->pool, tvb, offset));
            break;
        case (2*(BGP_ROUTE_DISTINGUISHER_SIZE + FT_IPv6_LEN)):
            rd_string = decode_bgp_rd(pinfo->pool, tvb, offset);
            ti = proto_tree_add_string(tree, hf_bgp_update_path_attribute_mp_reach_nlri_next_hop_rd, tvb, offset, BGP_ROUTE_DISTINGUISHER_SIZE, rd_string);
            if (tvb_memeql(tvb, offset, rd_zero, BGP_ROUTE_DISTINGUISHER_SIZE) != 0) {
                expert_add_info(pinfo, ti, &ei_bgp_next_hop_rd_nonzero);
            }
            wmem_strbuf_append_printf(strbuf, " RD=%s", rd_string);
            offset += BGP_ROUTE_DISTINGUISHER_SIZE;
            proto_tree_add_item(tree, hf_bgp_update_path_attribute_mp_reach_nlri_next_hop_ipv6, tvb, offset, FT_IPv6_LEN, ENC_NA);
            wmem_strbuf_append_printf(strbuf, " IPv6=%s", tvb_ip6_to_str(pinfo->pool, tvb, offset));
            offset += FT_IPv6_LEN;
            rd_string = decode_bgp_rd(pinfo->pool, tvb, offset);
            ti = proto_tree_add_string(tree, hf_bgp_update_path_attribute_mp_reach_nlri_next_hop_rd, tvb, offset, BGP_ROUTE_DISTINGUISHER_SIZE, rd_string);
            if (tvb_memeql(tvb, offset, rd_zero, BGP_ROUTE_DISTINGUISHER_SIZE) != 0) {
                expert_add_info(pinfo, ti, &ei_bgp_next_hop_rd_nonzero);
            }
            wmem_strbuf_append_printf(strbuf, " RD=%s", rd_string);
            offset += BGP_ROUTE_DISTINGUISHER_SIZE;
            ti = proto_tree_add_item(tree, hf_bgp_update_path_attribute_mp_reach_nlri_next_hop_ipv6_link_local, tvb, offset, FT_IPv6_LEN, ENC_NA);
            tvb_get_ipv6(tvb, offset, &ipv6_addr);
            if (!in6_addr_is_linklocal(&ipv6_addr)) {
                expert_add_info_format(pinfo, ti, &ei_bgp_next_hop_ipv6_scope, "Invalid IPv6 address scope; should be link-local");
            }
            ip6_to_str_buf(&ipv6_addr, ipv6_buffer, WS_INET6_ADDRSTRLEN);
            wmem_strbuf_append_printf(strbuf, " Link-local=%s", ipv6_buffer);
            break;
        default:
            return 0;
    }
    return nhlen;
}
