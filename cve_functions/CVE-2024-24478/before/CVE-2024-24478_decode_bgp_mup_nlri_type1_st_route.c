static int decode_bgp_mup_nlri_type1_st_route(proto_tree *tree, tvbuff_t *tvb, gint offset, packet_info *pinfo,
                                              guint16 afi, guint8 architecture_type) {
    /*
        +-----------------------------------+
        |           RD  (8 octets)          |
        +-----------------------------------+
        |      Prefix Length (1 octet)      |
        +-----------------------------------+
        |         Prefix (variable)         |
        +-----------------------------------+
        | Architecture specific (variable)  |
        +-----------------------------------+
    */
    int reader_offset = offset;
    guint32 total_length = 0;

    proto_item  *item;
    guint8      endpoint_address_length;
    proto_item  *arch_spec_item;
    proto_tree  *arch_spec_tree;
    int         arch_spec_byte;

    item = proto_tree_add_item(tree, hf_bgp_mup_nlri_rd, tvb, reader_offset, 8, ENC_NA);
    proto_item_append_text(item, " (%s)", decode_bgp_rd(pinfo->pool, tvb, reader_offset));
    reader_offset += 8;

    reader_offset += decode_bgp_mup_nlri_variable_prefix(tree, tvb, reader_offset, pinfo, afi);

    switch (architecture_type) {
    case BGP_MUP_AT_3GPP_5G:
        /*
            +-----------------------------------1
            |          TEID (4 octets)          |
            +-----------------------------------+
            |          QFI (1 octet)            |
            +-----------------------------------+
            | Endpoint Address Length (1 octet) |
            +-----------------------------------+
            |    Endpoint Address (variable)    |
            +-----------------------------------+
        */
        endpoint_address_length = tvb_get_guint8(tvb, reader_offset+5); // should be multiple of 8
        arch_spec_byte = 6 + endpoint_address_length/8;

        arch_spec_item = proto_tree_add_item(tree, hf_bgp_mup_nlri_3gpp_5g_type1_st_route, tvb, reader_offset, arch_spec_byte, ENC_NA);
        arch_spec_tree = proto_item_add_subtree(arch_spec_item, ett_bgp_mup_nlri_3gpp_5g_type1_st_route);

        proto_tree_add_item(arch_spec_tree, hf_bgp_mup_nlri_3gpp_5g_teid, tvb, reader_offset, 4, ENC_BIG_ENDIAN);
        reader_offset += 4;

        proto_tree_add_item(arch_spec_tree, hf_bgp_mup_nlri_3gpp_5g_qfi, tvb, reader_offset, 1, ENC_BIG_ENDIAN);
        reader_offset++;

        proto_tree_add_item(arch_spec_tree, hf_bgp_mup_nlri_3gpp_5g_ep_addr_len, tvb, reader_offset, 1, ENC_BIG_ENDIAN);
        reader_offset++;

        if (endpoint_address_length==32) {
            proto_tree_add_item(arch_spec_tree, hf_bgp_mup_nlri_3gpp_5g_ep_ip_addr, tvb, reader_offset, 4, ENC_NA);
            reader_offset += 4;
        } else if (endpoint_address_length==128) {
            proto_tree_add_item(arch_spec_tree, hf_bgp_mup_nlri_3gpp_5g_ep_ipv6_addr, tvb, reader_offset, 16, ENC_NA);
            reader_offset += 16;
        } else {
            expert_add_info_format(pinfo, arch_spec_tree, &ei_bgp_mup_nlri_addr_len_err,
                                   "Invalid length (%u) of Endpoint Address Length", endpoint_address_length);
            return -1;
        }
        break;
    default:
        /* return error because the length is unknown */
        proto_tree_add_expert_format(tree, pinfo, &ei_bgp_mup_unknown_at, tvb, reader_offset, -1,
                                     "Architecture specific type 1 ST route for unknown architecture type: %d", architecture_type);
        return -1;
    }

    total_length = reader_offset - offset;
    return total_length;
}
