decode_mcast_vpn_nlri_addresses(proto_tree *tree, tvbuff_t *tvb,
                                gint offset)
{
    guint8 addr_len;

    /* Multicast Source Address */
    proto_tree_add_item(tree, hf_bgp_mcast_vpn_nlri_source_length, tvb, offset,
                        1, ENC_BIG_ENDIAN);
    addr_len = tvb_get_guint8(tvb, offset);
    if (addr_len != 0 && addr_len != 32 && addr_len != 128)
        return -1;
    offset++;
    switch (addr_len) {
        case 32:
            proto_tree_add_item(tree, hf_bgp_mcast_vpn_nlri_source_addr_ipv4, tvb,
                                offset, 4, ENC_BIG_ENDIAN);
            offset += 4;
            break;
        case 128:
             proto_tree_add_item(tree, hf_bgp_mcast_vpn_nlri_source_addr_ipv6, tvb,
                                 offset, 16, ENC_NA);
             offset += 16;
             break;
    }

    /* Multicast Group Address */
    proto_tree_add_item(tree, hf_bgp_mcast_vpn_nlri_group_length, tvb, offset,
                        1, ENC_BIG_ENDIAN);
    addr_len = tvb_get_guint8(tvb, offset);
    if (addr_len != 0 && addr_len != 32 && addr_len != 128)
        return -1;
    offset++;
    switch(addr_len) {
        case 32:
            proto_tree_add_item(tree, hf_bgp_mcast_vpn_nlri_group_addr_ipv4, tvb,
                                offset, 4, ENC_BIG_ENDIAN);
            offset += 4;
            break;
        case 128:
            proto_tree_add_item(tree, hf_bgp_mcast_vpn_nlri_group_addr_ipv6, tvb,
                                offset, 16, ENC_NA);
            offset += 16;
            break;
    }

    return offset;
}
