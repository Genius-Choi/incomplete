pf_purge_states_tick(void *null)
 {
	unsigned int limit = pf_status.states;
	unsigned int interval = pf_default_rule.timeout[PFTM_INTERVAL];

	if (limit == 0) {
		timeout_add_sec(&pf_purge_states_to, 1);
		return;
	}
 
	/*
	 * process a fraction of the state table every second
	 */
 
	if (interval > 1)
		limit /= interval;

	pf_purge_states_limit = limit;
	task_add(systqmp, &pf_purge_states_task);
}
