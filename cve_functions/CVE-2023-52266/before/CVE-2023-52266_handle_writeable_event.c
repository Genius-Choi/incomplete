int EpollSocket::handle_writeable_event(int &epollfd, epoll_event &event, EpollSocketWatcher &socket_handler) {
    EpollContext *epoll_context = (EpollContext *) event.data.ptr;
    if (epoll_context == NULL) {
        LOG_WARN("Get epoll context fail in write event!");
        return -1;
    }
    int fd = epoll_context->fd;
    LOG_DEBUG("start write data");

    int ret = socket_handler.on_writeable(*epoll_context);
    if (ret == WRITE_CONN_CLOSE) {
        return close_and_release(event);
    }

    if (ret == WRITE_CONN_CONTINUE) {
        event.events = EPOLLOUT | EPOLLONESHOT;
    } else if (ret == WRITE_CONN_ALIVE) {
        if (_status == S_REJECT_CONN) {
            return close_and_release(event);
        }
        // wait for next request
        event.events = EPOLLIN | EPOLLONESHOT;
    } else {
        LOG_ERROR("unkonw write ret:%d", ret);
    }
    epoll_ctl(epollfd, EPOLL_CTL_MOD, fd, &event);

    return 0;
}
