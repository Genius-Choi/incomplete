QPDF::getKeyForObject(int objid, int generation, bool use_aes)
{
    if (! this->m->encrypted)
    {
	throw std::logic_error(
	    "request for encryption key in non-encrypted PDF");
    }

    if (! ((objid == this->m->cached_key_objid) &&
	   (generation == this->m->cached_key_generation)))
    {
	this->m->cached_object_encryption_key =
	    compute_data_key(this->m->encryption_key, objid, generation,
                             use_aes, this->m->encryption_V,
                             this->m->encryption_R);
	this->m->cached_key_objid = objid;
	this->m->cached_key_generation = generation;
    }

    return this->m->cached_object_encryption_key;
}
