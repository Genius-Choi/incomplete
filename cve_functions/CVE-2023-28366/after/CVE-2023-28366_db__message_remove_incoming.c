int db__message_remove_incoming(struct mosquitto* context, uint16_t mid)
{
	struct mosquitto_client_msg *tail, *tmp;

	if(!context) return MOSQ_ERR_INVAL;

	DL_FOREACH_SAFE(context->msgs_in.inflight, tail, tmp){
		if(tail->mid == mid) {
			if(tail->store->qos != 2){
				return MOSQ_ERR_PROTOCOL;
			}
			db__message_remove_from_inflight(&context->msgs_in, tail);
			return MOSQ_ERR_SUCCESS;
		}
	}

	return MOSQ_ERR_NOT_FOUND;
}
