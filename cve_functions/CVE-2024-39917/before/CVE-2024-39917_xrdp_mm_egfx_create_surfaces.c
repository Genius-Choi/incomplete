xrdp_mm_egfx_create_surfaces(struct xrdp_mm *self)
{
    int surface_id;
    int index;
    int count;
    int left;
    int top;
    int width;
    int height;
    struct monitor_info *mi;
    struct xrdp_bitmap *screen;

    screen = self->wm->screen;
    count = self->wm->client_info->display_sizes.monitorCount;
    LOG_DEVEL(LOG_LEVEL_INFO, "xrdp_mm_egfx_create_surfaces: "
              "monitor count %d", count);
    if (count < 1)
    {
        left = 0;
        top = 0;
        width = screen->width;
        height = screen->height;
        xrdp_egfx_send_create_surface(self->egfx, self->egfx->surface_id,
                                      width, height,
                                      XR_PIXEL_FORMAT_XRGB_8888);
        xrdp_egfx_send_map_surface(self->egfx, self->egfx->surface_id,
                                   left, top);
        LOG(LOG_LEVEL_INFO, "xrdp_mm_egfx_create_surfaces: map "
            "surface_id %d left %d top %d width %d height %d",
            self->egfx->surface_id, left, top, width, height);
        return 0;
    }
    for (index = 0; index < count; index++)
    {
        surface_id = index;
        mi = self->wm->client_info->display_sizes.minfo_wm + index;
        left = mi->left;
        top = mi->top;
        width = mi->right - mi->left + 1;
        height = mi->bottom - mi->top + 1;
        xrdp_egfx_send_create_surface(self->egfx, surface_id,
                                      width, height,
                                      XR_PIXEL_FORMAT_XRGB_8888);
        xrdp_egfx_send_map_surface(self->egfx, surface_id, left, top);
        LOG(LOG_LEVEL_INFO, "xrdp_mm_egfx_create_surfaces: map "
            "surface_id %d left %d top %d width %d height %d",
            surface_id, left, top, width, height);
    }
    return 0;
}
