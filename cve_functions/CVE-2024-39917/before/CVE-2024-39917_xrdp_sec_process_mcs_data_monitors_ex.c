xrdp_sec_process_mcs_data_monitors_ex(struct xrdp_sec *self, struct stream *s)
{
    int flags;
    struct xrdp_client_info *client_info = &(self->rdp_layer->client_info);

    LOG_DEVEL(LOG_LEVEL_TRACE, "xrdp_sec_process_mcs_data_monitors_ex:");

    /* this is an option set in xrdp.ini */
    if (client_info->multimon != 1) /* are multi-monitors allowed ? */
    {
        /* This should already be logged in
           xrdp_sec_process_mcs_data_monitors() */
        return 0;
    }
    if (!s_check_rem_and_log(s, 4,
                             "xrdp_sec_process_mcs_data_monitors_ex:"
                             " Parsing [MS-RDPBCGR] TS_UD_CS_MONITOR_EX"))
    {
        return SEC_PROCESS_MONITORS_ERR;
    }
    in_uint32_le(s, flags); /* flags */

    //verify flags - must be 0x0
    if (flags != 0)
    {
        LOG(LOG_LEVEL_ERROR,
            "xrdp_sec_process_mcs_data_monitors_ex: [MS-RDPBCGR]"
            " Protocol error: TS_UD_CS_MONITOR_EX flags MUST be zero,"
            " received: 0x%8.8x", flags);
        return SEC_PROCESS_MONITORS_ERR;
    }

    return libxrdp_process_monitor_ex_stream(s, &client_info->display_sizes);
}
