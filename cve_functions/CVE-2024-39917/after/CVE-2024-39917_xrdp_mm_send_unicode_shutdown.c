xrdp_mm_send_unicode_shutdown(struct xrdp_mm *self, struct trans *trans)
{
    struct stream *s = trans_get_out_s(self->chan_trans, 8192);
    if (s == NULL)
    {
        return 1;
    }

    out_uint32_le(s, 0);     /* version */
    out_uint32_le(s, 8 + 8); /* size */
    out_uint32_le(s, 25);    /* msg id */
    out_uint32_le(s, 8);     /* size */
    s_mark_end(s);

    return trans_write_copy(self->chan_trans);
}
