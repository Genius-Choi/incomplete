OFCondition EctEnhancedCT::write(DcmItem& dataset)
{
    if (!check())
    {
        return IOD_EC_InvalidObject;
    }

    OFCondition result = OFvisit<OFCondition>(WriteVisitor(dataset, *this), getImagePixel());
    if (result.good())
        result = writeGeneric(dataset);
    return result;
}
