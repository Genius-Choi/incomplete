OFCondition EctEnhancedCT::writeConcatenation(ConcatenationCreator& cc)
{
    if (!check())
    {
        return IOD_EC_InvalidObject;
    }

    DcmItem* item = new DcmItem();
    if (!item)
        return EC_MemoryExhausted;

    Uint8* pixData       = NULL;
    size_t pixDataLength = 0;

    OFCondition result
        = OFvisit<OFCondition>(WriteVisitorConcatenation(*this, pixData, pixDataLength), getImagePixel());

    if (result.good())
        result = writeGeneric(*item);
    if (result.good())
    {
        result = cc.setCfgInput(item, pixData, pixDataLength, OFTrue /* cc should take ownership */);
    }
    return result;
}
