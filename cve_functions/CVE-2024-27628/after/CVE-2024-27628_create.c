OFCondition EctEnhancedCT::create(EctEnhancedCT*& ct,
                                  const Uint16 rows,
                                  const Uint16 columns,
                                  const OFBool signedPixelData,
                                  const EctTypes::E_ImageType1 imageType1,
                                  const OFString& imageType3,
                                  const OFString& imageType4,
                                  const OFString& instanceNumber,
                                  const EctTypes::E_ContentQualification contentQualification,
                                  const EctTypes::E_PixelPresentation pixelPresentation,
                                  const EctTypes::E_VolumetricProperties volumetricProperties,
                                  const OFString& volumeBasedCalculationTechnique,
                                  const IODEnhGeneralEquipmentModule::EquipmentInfo& equipmentInfo,
                                  const OFString& acquisitionDateTime,
                                  const Float64& acquisitionDuration)
{
    ct = OFnullptr;
    OFCondition status;
    if (!signedPixelData)
    {
        ct = new EctEnhancedCT(OFin_place<IODImagePixelModule<Uint16> >);
        if (ct)
            status
                = SetImagePixelModuleVisitor(rows, columns)(*OFget<IODImagePixelModule<Uint16> >(&ct->getImagePixel()));
        else
            status = EC_MemoryExhausted;
    }
    else
    {
        ct = new EctEnhancedCT(OFin_place<IODImagePixelModule<Sint16> >);
        if (ct)
            status
                = SetImagePixelModuleVisitor(rows, columns)(*OFget<IODImagePixelModule<Sint16> >(&ct->getImagePixel()));
        else
            status = EC_MemoryExhausted;
    }
    if (status.bad())
        return status;

    if (status.good())
        status = ct->getSOPCommon().setSOPClassUID(UID_EnhancedCTImageStorage);

    if (status.good())
        status = ct->setImageType(EctTypes::imageType1ToStr(imageType1) + "\\"
                                  + EctTypes::imageType2ToStr(EctTypes::E_ImageType2_Primary) + "\\" + imageType3 + "\\"
                                  + imageType4);

    if (status.good())
        status = ct->getIODMultiFrameFGModule().setInstanceNumber(instanceNumber);
    if (status.good())
        status = ct->setContentQualification(contentQualification);
    if (status.good())
        status = ct->setPixelPresentation(pixelPresentation);
    if (status.good())
        status = ct->setVolumetricProperties(volumetricProperties);
    if (status.good())
        status = ct->setVolumeBasedCalculationTechnique(volumeBasedCalculationTechnique);
    if (status.good())
        status = ct->setLossyImageCompression(OFFalse);
    if (status.good())
        status = ct->getIODEnhGeneralEquipmentModule().set(equipmentInfo);
    if (status.good() && (!acquisitionDateTime.empty()))
        status = ct->setAcquisitionDateTime(acquisitionDateTime);
    if (status.good() && (acquisitionDuration >= 0))
        status = ct->setAcquisitionDuration(acquisitionDuration);
    if (status.good())
        status = ct->m_BurnedInAnnotation.putOFStringArray("NO");

    if (status.good())
        status = DcmIODUtil::setContentDateAndTimeNow(ct->getIODMultiFrameFGModule());

    return status;
}
