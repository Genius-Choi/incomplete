void ncrush_context_reset(NCRUSH_CONTEXT* ncrush, BOOL flush)
{
	WINPR_ASSERT(ncrush);

	ZeroMemory(&(ncrush->HistoryBuffer), sizeof(ncrush->HistoryBuffer));
	ZeroMemory(&(ncrush->OffsetCache), sizeof(ncrush->OffsetCache));
	ZeroMemory(&(ncrush->MatchTable), sizeof(ncrush->MatchTable));
	ZeroMemory(&(ncrush->HashTable), sizeof(ncrush->HashTable));

	if (flush)
		ncrush->HistoryOffset = ncrush->HistoryBufferSize + 1;
	else
		ncrush->HistoryOffset = 0;

	ncrush->HistoryPtr = &(ncrush->HistoryBuffer[ncrush->HistoryOffset]);
}
