static int ncrush_hash_table_add(NCRUSH_CONTEXT* ncrush, const BYTE* pSrcData, UINT32 SrcSize,
                                 UINT32 HistoryOffset)
{
	const BYTE* SrcPtr = pSrcData;
	UINT32 Hash;
	UINT32 Offset = HistoryOffset;
	UINT32 EndOffset = Offset + SrcSize - 8;

	WINPR_ASSERT(ncrush);
	WINPR_ASSERT(pSrcData);
	WINPR_ASSERT(Offset + SrcSize >= 8);

	while (Offset < EndOffset)
	{
		Hash = ncrush->HashTable[get_word(SrcPtr)];
		ncrush->HashTable[get_word(SrcPtr)] = Offset;
		ncrush->MatchTable[Offset] = Hash;
		SrcPtr++;
		Offset++;
	}

	return 1;
}
