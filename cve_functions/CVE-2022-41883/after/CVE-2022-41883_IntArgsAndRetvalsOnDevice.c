bool IntArgsAndRetvalsOnDevice(EagerOperation* op,
                               const KernelDef* kernel_def) {
  // We choose to leave `EagerConsts`
  // on HOST to avoid `shape` and other arguments that are traditionally pinned
  // to HostMemory from being placed on-device and then being copied to host via
  // an expensive D2H transfer.
  if (op->Name() == "_EagerConst") return false;

  // Check if any of the Op's output_arg(s) are pinned to Host.
  if (kernel_def == nullptr) return false;
  const OpDef& op_def = OpRegistry::Global()->LookUp(op->Name())->op_def;
  for (const string& host_memory_arg : kernel_def->host_memory_arg()) {
    for (const auto& output_arg : op_def.output_arg()) {
      if (output_arg.name() == host_memory_arg) {
        return false;
      }
    }
  }

  return true;
}
