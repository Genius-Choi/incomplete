login_failed_protocol(protocol_t *protocol, int protocol_type, 
		io_t *io, token_t *tag, timed_log_t *auth_log, 
		const char *from_to_host_str, struct auth *auth,
		const char *servername, const char *port,
		const char *reason, int ssl_mode, int tls_state)
{
	sleep(PERDITION_AUTH_FAIL_SLEEP);
	if (protocol->write_str(io, NULL_FLAG, tag,
				protocol->type[protocol_type], reason) < 0) {
		VANESSA_LOGGER_DEBUG("protocol->write");
		VANESSA_LOGGER_ERR("Fatal error writing to client. "
				"Exiting child.");
		perdition_exit_cleanly(-1);
	}

	perdition_log_auth(auth_log, from_to_host_str, auth, servername, port,
			   reason, ssl_mode, tls_state);
}
