static RVecUT64 *get_xrefs(RAnalBlock *block) {
	RVecUT64 *result = RVecUT64_new ();

	size_t i;
	for (i = 0; i < block->ninstr; i++) {
		const ut64 ia = block->addr + block->op_pos[i];
		RVecAnalRef *xrefs = r_anal_xrefs_get (block->anal, ia);
		if (xrefs) {
			RAnalRef *ref;
			R_VEC_FOREACH (xrefs, ref) {
				ut64 *addr = RVecUT64_emplace_back (result);
				if (R_UNLIKELY (!addr)) {
					RVecUT64_free (result);
					return NULL;
				}

				*addr = ref->addr;
			}
		}

		RVecAnalRef_free (xrefs);
	}

	return result;
}
