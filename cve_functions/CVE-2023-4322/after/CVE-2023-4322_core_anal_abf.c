static bool core_anal_abf(RCore *core, const char* input) {
	if (strchr (input, '?')) {
		r_core_cmd_help_match (core, help_msg_ab, "abf", true);
		return false;
	}
	ut64 addr = r_num_math (core->num, input);
	if (!addr || addr == UT64_MAX) {
		addr = core->offset;
	}

	RAnalBlock *bb, *bb2;
	RListIter *iter, *iter2, *bbiter;
	RAnalFunction *fcn;
	RList *bbs = r_anal_get_blocks_in (core->anal, addr);
	r_list_foreach (bbs, bbiter, bb) {
		if (!bb) {
			R_LOG_ERROR ("Cannot find basic block");
			return false;
		}
		r_list_foreach (bb->fcns, iter, fcn) {
			r_list_foreach (fcn->bbs, iter2, bb2) {
				if (bb == bb2) {
					continue;
				}
				if (bb2->jump != UT64_MAX && bb2->jump == bb->addr) {
					r_cons_printf ("0x%"PFMT64x"\n", bb2->addr);
				}
				if (bb2->fail != UT64_MAX && bb2->fail == bb->addr) {
					r_cons_printf ("0x%"PFMT64x"\n", bb2->addr);
				}
			}
			break;
		}
	}
	return true;
}
