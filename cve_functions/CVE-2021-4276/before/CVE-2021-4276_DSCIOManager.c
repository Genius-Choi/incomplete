DSCIOManager::DSCIOManager(const enum INPUT_OUTPUT input, const enum INPUT_OUTPUT output, const string& conn_string, const string& processing_start_date_string, bool rssac) {

    input_ = input;
    output_ = output;
    conn_string_ = conn_string;
    pg_db_conn_ = NULL;
    pg_db_trans_ = NULL;
    processing_start_date_ = NULL;
    rssac_=rssac;

    cout << endl << endl << "----------------------- " << currentDateTime() << " ----------------------" << endl;
    // work out if we have a valid start date
    struct tm p_start_date  = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NULL };
    if ( ! processing_start_date_string.empty() ) {
       cout << "Processing start date defined as " << processing_start_date_string << endl; 
       if ( strptime(processing_start_date_string.c_str(), "%Y-%m-%d", &p_start_date) != NULL ) {   
                processing_start_date_ = new time_t(mktime(&p_start_date));
                //cout << "Time is: " << p_start_date.tm_year << " " << p_start_date.tm_mon << " " << p_start_date.tm_mday << " " << p_start_date.tm_hour << " " << p_start_date.tm_min << " " << p_start_date.tm_sec << endl;   
       } else {
           cerr << "Error: Invalid processing start date \'" << processing_start_date_string << "\' provided. Must be YYYY-MM-DD format. Exiting." << endl;
           exit(1);
       }
    } 
}
