DSCIOManager::dsc_handle_failed_file(bfs::path path_src, int process) {
    
    bfs::path path_newfile;  
    std::string failed = ".failed.";
    std::string reason_string = process ? " Failed to process data " : "Failed to commit data to DB";
    
    try {
        path_newfile = path_src.string() + failed + bfs::unique_path().string();
        bfs::rename(path_src, path_newfile);
        cout << currentDateTime() << ": Error: failed to process: " << path_src.string() << "Reason: " << reason_string << endl;
        cout << currentDateTime() << ": File renamed to:          " << path_newfile.string() << endl;
    }
    catch (const bfs::filesystem_error& ex) {
        cout << "FS Error: " << ex.what() << endl;
        exit(1);
    }
    catch (std::exception &e) {
        cerr << "Error handling failed file: " << e.what() << endl;
        exit(1);
    }
 
}
