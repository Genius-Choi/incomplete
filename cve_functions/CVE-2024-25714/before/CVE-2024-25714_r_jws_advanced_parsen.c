int r_jws_advanced_parsen(jws_t * jws, const char * jws_str, size_t jws_str_len, uint32_t parse_flags, int x5u_flags) {
  int ret;
  char * str = (char *)jws_str;

  if (jws != NULL && str != NULL && jws_str_len) {
    while(isspace((unsigned char)*str) && jws_str_len) {
      str++;
      jws_str_len--;
    }

    if (0 == o_strncmp("ey", str, 2)) {
      ret = r_jws_advanced_compact_parsen(jws, jws_str, jws_str_len, parse_flags, x5u_flags);
    } else if (*str == '{') {
      ret = r_jws_advanced_parsen_json_str(jws, jws_str, jws_str_len, parse_flags, x5u_flags);
    } else {
      ret = RHN_ERROR_PARAM;
    }
  } else {
    ret = RHN_ERROR_PARAM;
  }
  return ret;
}
