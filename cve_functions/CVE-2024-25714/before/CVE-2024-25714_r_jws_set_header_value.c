static int r_jws_set_header_value(jws_t * jws, int force) {
  int ret = RHN_OK;
  char * header_str = NULL;
  struct _o_datum dat = {0, NULL};

  if (jws != NULL) {
    if (jws->header_b64url == NULL || force) {
      if ((header_str = json_dumps(jws->j_header, JSON_COMPACT)) != NULL) {
        if (o_base64url_encode_alloc((const unsigned char *)header_str, o_strlen(header_str), &dat)) {
          o_free(jws->header_b64url);
          jws->header_b64url = (unsigned char *)o_strndup((const char *)dat.data, dat.size);
          o_free(dat.data);
        } else {
          y_log_message(Y_LOG_LEVEL_ERROR, "r_jws_set_header_value - Error o_base64url_encode header_str");
          ret = RHN_ERROR;
        }
        o_free(header_str);
      } else {
        y_log_message(Y_LOG_LEVEL_ERROR, "r_jws_set_header_value - Error json_dumps header_str");
        ret = RHN_ERROR;
      }
    }
  } else {
    ret = RHN_ERROR_PARAM;
  }
  return ret;
}
