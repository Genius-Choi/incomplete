  HeaderHashMethod(const envoy::config::route::v3::RouteAction::HashPolicy::Header& header,
                   bool terminal)
      : HashMethodImplBase(terminal), header_name_(header.header_name()) {
    if (header.has_regex_rewrite()) {
      const auto& rewrite_spec = header.regex_rewrite();
      regex_rewrite_ = Regex::Utility::parseRegex(rewrite_spec.pattern());
      regex_rewrite_substitution_ = rewrite_spec.substitution();
    }
  }
