void LibzipPlugin::emitProgress(double dPercentage)
{
    bool flag = true;
    while (flag) {
        if (QThread::currentThread()->isInterruptionRequested()) { //线程结束
            break;
        }

        // 暂停
        if (m_bPause) {
            sleep(1);
            continue;
        }

        // 处理当前文件名
        if (m_pCurArchive) {
            if (WT_Add == m_workStatus) {
                // 压缩操作显示当前正在压缩的文件名
                zip_uint64_t index = zip_uint64_t(m_curFileCount * dPercentage);
                // 发送当前文件名信号
                emit signalCurFileName(m_common->trans2uft8(zip_get_name(m_pCurArchive, index, ZIP_FL_ENC_RAW), m_mapFileCode[zip_int64_t(index)]));
            } else if (WT_Delete == m_workStatus) {
                // 删除操作显示当前正在删除的文件名
                int iSpan = qRound(m_listCurName.count() * dPercentage);    // 获取占比
                QString strCurFileName;
                // 按照进度占比处理当前文件名
                if (iSpan < 0) {
                    strCurFileName = m_listCurName[0];
                } else if (iSpan >= m_listCurIndex.count()) {
                    strCurFileName = m_listCurName[m_listCurName.count() - 1];
                } else {
                    strCurFileName = m_listCurName[iSpan];
                }

                // 发送当前文件名信号
                emit signalCurFileName(strCurFileName);
            }

        }

        // 发送进度信号
        emit signalprogress(dPercentage * 100);

        flag = false;
    }

    m_bPause = false;
}
