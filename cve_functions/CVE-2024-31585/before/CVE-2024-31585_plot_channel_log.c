static int plot_channel_log(AVFilterContext *ctx, void *arg, int jobnr, int nb_jobs)
{
    ShowSpectrumContext *s = ctx->priv;
    AVFilterLink *inlink = ctx->inputs[0];
    const int h = s->orientation == VERTICAL ? s->channel_height : s->channel_width;
    const int ch = jobnr;
    float yf, uf, vf;

    /* decide color range */
    color_range(s, ch, &yf, &uf, &vf);

    /* draw the channel */
    for (int yy = 0; yy < h; yy++) {
        float range = s->stop ? s->stop - s->start : inlink->sample_rate / 2;
        float pos = bin_pos(yy, h, s->start, s->start + range);
        float delta = pos - floorf(pos);
        float a0, a1;

        a0 = get_value(ctx, ch, av_clip(pos, 0, h-1));
        a1 = get_value(ctx, ch, av_clip(pos+1, 0, h-1));
        {
            int row = (s->mode == COMBINED) ? yy : ch * h + yy;
            float *out = &s->color_buffer[ch][3 * row];

            pick_color(s, yf, uf, vf, delta * a1 + (1.f - delta) * a0, out);
        }
    }

    return 0;
}
