void sighup_handler() {
	struct mt_connection *p;

	syslog(LOG_NOTICE, _("SIGHUP: Reloading interfaces"));

	if (!use_raw_socket) {
		struct net_interface *interface, *tmp;
		DL_FOREACH_SAFE(interfaces, interface, tmp) {
			close(interface->socketfd);
			DL_DELETE(interfaces, interface);
			free(interface);
		}
		interfaces = NULL;
	}

	if (net_get_interfaces(&interfaces) <= 0) {
		syslog(LOG_ERR, _("No devices found! Exiting.\n"));
		exit(1);
	}

	setup_sockets();

	/* Reassign outgoing interfaces to connections again, since they may have changed */
	DL_FOREACH(connections_head, p) {
		if (p->interface_name != NULL) {
			struct net_interface *interface = net_get_interface_ptr(&interfaces, p->interface_name, 0);
			if (interface != NULL) {
				p->interface = interface;
			} else {
				struct mt_connection tmp;
				syslog(LOG_NOTICE, _("(%d) Connection closed because interface %s is gone."), p->seskey, p->interface_name);
				tmp.next = p->next;
				list_remove_connection(p);
				p = &tmp;
			}
		}
	}
}
