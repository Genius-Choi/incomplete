ovn_sb_set_lflow_logical_dp_group(
    struct ovsdb_idl_txn *ovnsb_txn,
    struct hmap *dp_groups,
    const struct sbrec_logical_flow *sbflow,
    const unsigned long *dpg_bitmap)
{
    struct ovn_dp_group *dpg;
    size_t n_ods;

    n_ods = bitmap_count1(dpg_bitmap, n_datapaths);

    if (!n_ods) {
        sbrec_logical_flow_set_logical_dp_group(sbflow, NULL);
        return;
    }

    ovs_assert(n_ods != 1);

    dpg = ovn_dp_group_find(dp_groups, dpg_bitmap, hash_int(n_ods, 0));
    ovs_assert(dpg != NULL);

    if (!dpg->dp_group) {
        dpg->dp_group = ovn_sb_insert_logical_dp_group(ovnsb_txn, dpg->bitmap);
    }
    sbrec_logical_flow_set_logical_dp_group(sbflow, dpg->dp_group);
}
