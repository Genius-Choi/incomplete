ovn_sb_insert_logical_dp_group(struct ovsdb_idl_txn *ovnsb_txn,
                               const unsigned long *dpg_bitmap)
{
    struct sbrec_logical_dp_group *dp_group;
    const struct sbrec_datapath_binding **sb;
    size_t n = 0, index;

    sb = xmalloc(bitmap_count1(dpg_bitmap, n_datapaths) * sizeof *sb);
    BITMAP_FOR_EACH_1 (index, n_datapaths, dpg_bitmap) {
        sb[n++] = datapaths_array[index]->sb;
    }
    dp_group = sbrec_logical_dp_group_insert(ovnsb_txn);
    sbrec_logical_dp_group_set_datapaths(
        dp_group, (struct sbrec_datapath_binding **) sb, n);
    free(sb);

    return dp_group;
}
