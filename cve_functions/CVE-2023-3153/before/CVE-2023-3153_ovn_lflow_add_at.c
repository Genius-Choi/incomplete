ovn_lflow_add_at(struct hmap *lflow_map, const struct ovn_datapath *od,
                 const unsigned long *dp_bitmap,
                 enum ovn_stage stage, uint16_t priority,
                 const char *match, const char *actions, const char *io_port,
                 const char *ctrl_meter,
                 const struct ovsdb_idl_row *stage_hint, const char *where)
    OVS_EXCLUDED(fake_hash_mutex)
{
    struct ovs_mutex *hash_lock;
    uint32_t hash;

    ovs_assert(!od ||
               ovn_stage_to_datapath_type(stage) == ovn_datapath_get_type(od));

    hash = ovn_logical_flow_hash(ovn_stage_get_table(stage),
                                 ovn_stage_get_pipeline(stage),
                                 priority, match,
                                 actions);

    hash_lock = lflow_hash_lock(lflow_map, hash);
    do_ovn_lflow_add(lflow_map, od, dp_bitmap, hash, stage, priority,
                     match, actions, io_port, stage_hint, where, ctrl_meter);
    lflow_hash_unlock(hash_lock);
}
