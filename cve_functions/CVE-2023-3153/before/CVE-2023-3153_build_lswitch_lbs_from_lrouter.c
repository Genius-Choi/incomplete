build_lswitch_lbs_from_lrouter(struct hmap *lbs, struct hmap *lb_groups)
{
    if (!install_ls_lb_from_router) {
        return;
    }

    struct ovn_northd_lb *lb;
    size_t index;

    HMAP_FOR_EACH (lb, hmap_node, lbs) {
        BITMAP_FOR_EACH_1 (index, n_datapaths, lb->nb_lr_map) {
            struct ovn_datapath *od = datapaths_array[index];
            ovn_northd_lb_add_ls(lb, od->n_ls_peers, od->ls_peers);
        }
    }

    struct ovn_lb_group *lb_group;
    HMAP_FOR_EACH (lb_group, hmap_node, lb_groups) {
        for (size_t i = 0; i < lb_group->n_lr; i++) {
            struct ovn_datapath *od = lb_group->lr[i];
            ovn_lb_group_add_ls(lb_group, od->n_ls_peers, od->ls_peers);
            for (size_t j = 0; j < lb_group->n_lbs; j++) {
                ovn_northd_lb_add_ls(lb_group->lbs[j], od->n_ls_peers,
                                     od->ls_peers);
            }
        }
    }
}
