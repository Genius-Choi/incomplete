pci_xhci_parse_extcap(struct pci_xhci_vdev *xdev, char *opts)
{
	char *cap;
	char *s, *o;
	int rc = 0;

	cap = o = s = strdup(opts);

	s = strchr(opts, '=');
	if (!s) {
		rc = -1;
		goto errout;
	}

	cap = s + 1;
	if (!strncmp(cap, "apl", 3)) {
		xdev->excap_write = pci_xhci_apl_drdregs_write;
		xdev->excap_ptr = excap_group_apl;
		xdev->quirks |= XHCI_QUIRK_INTEL_ISOCH_NO_BEI;
		xdev->vid = PCI_INTEL_APL_XHCI_VID;
		xdev->pid = PCI_INTEL_APL_XHCI_PID;
	} else
		rc = -2;

	if (((struct pci_xhci_excap *)(xdev->excap_ptr))->start
			== EXCAP_GROUP_END) {
		xdev->excap_write = NULL;
		xdev->excap_ptr = NULL;
		xdev->vid = PCI_ACRN_XHCI_VID;
		xdev->pid = PCI_ACRN_XHCI_PID;
		UPRINTF(LWRN, "Invalid excap, set to ACRN excap\r\n");
	}

errout:
	if (rc)
		pr_err("USB: fail to set vendor capability, rc=%d\r\n", rc);
	free(o);
	return rc;
}
