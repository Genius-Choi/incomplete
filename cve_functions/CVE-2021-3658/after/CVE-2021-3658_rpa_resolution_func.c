static void rpa_resolution_func(struct btd_adapter *adapter, uint32_t flags)
{
	struct mgmt_cp_set_exp_feature cp;
	uint8_t action = btd_opts.experimental ? 0x01 : 0x00;

	/* If already set don't attempt to set it again */
	if (action == (flags & BIT(0)))
		return;

	memset(&cp, 0, sizeof(cp));
	memcpy(cp.uuid, rpa_resolution_uuid, 16);
	cp.action = action;

	if (mgmt_send(adapter->mgmt, MGMT_OP_SET_EXP_FEATURE,
			adapter->dev_id, sizeof(cp), &cp,
			set_rpa_resolution_complete, adapter, NULL) > 0)
		return;

	btd_error(adapter->dev_id, "Failed to set RPA Resolution");
}
