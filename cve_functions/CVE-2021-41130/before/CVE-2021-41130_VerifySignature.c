void AuthChecker::VerifySignature() {
  Certs &key_cache = context_->service_context()->certs();
  auto cert = key_cache.GetCert(user_info_.issuer);
  if (cert == nullptr) {
    Unauthenticated("Missing verification key");
    return;
  }

  Status status =
      validator_->VerifySignature(cert->first.c_str(), cert->first.size());
  if (!status.ok()) {
    Unauthenticated(status.message());
    return;
  }

  // Inserts the entry to JwtCache.
  JwtCache &cache = context_->service_context()->jwt_cache();
  cache.Insert(auth_token_, user_info_, validator_->GetExpirationTime(),
               system_clock::now());

  PassUserInfoOnSuccess();
}
