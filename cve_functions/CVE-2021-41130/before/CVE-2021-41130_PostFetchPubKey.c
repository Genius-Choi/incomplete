void AuthChecker::PostFetchPubKey(Status status, std::string &&body) {
  if (!status.ok() || body.empty()) {
    FetchFailure("Unable to fetch verification key", status);
    return;
  }

  Certs &key_cache = context_->service_context()->certs();
  int cache_duration_in_s =
      context_->service_context()->global_context()->jwks_cache_duration_in_s();
  key_cache.Update(
      user_info_.issuer, std::move(body),
      system_clock::now() + std::chrono::seconds(cache_duration_in_s));
  VerifySignature();
}
