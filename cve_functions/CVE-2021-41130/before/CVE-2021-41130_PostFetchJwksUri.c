void AuthChecker::PostFetchJwksUri(Status status, std::string &&body) {
  if (!status.ok()) {
    context_->service_context()->SetJwksUri(user_info_.issuer, std::string(),
                                            false);
    FetchFailure("Unable to fetch URI of the key via OpenID discovery", status);
    return;
  }

  // Parse discovery doc and extract jwks_uri
  grpc_json *discovery_json = grpc_json_parse_string_with_len(
      const_cast<char *>(body.c_str()), body.size());
  const char *jwks_uri;
  if (discovery_json != nullptr) {
    jwks_uri = GetStringValue(discovery_json, "jwks_uri");
    grpc_json_destroy(discovery_json);
  } else {
    jwks_uri = nullptr;
  }

  if (jwks_uri == nullptr) {
    env_->LogError("OpenID discovery failed due to invalid doc format");
    context_->service_context()->SetJwksUri(user_info_.issuer, std::string(),
                                            false);
    Unauthenticated("Unable to parse URI of the key via OpenID discovery");
    return;
  }

  // OpenID discovery completed. Set jwks_uri for the issuer in cache.
  context_->service_context()->SetJwksUri(user_info_.issuer, jwks_uri, false);

  FetchPubKey(jwks_uri);
}
