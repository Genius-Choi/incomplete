const char* oidc_get_redirect_uri(request_rec *r, oidc_cfg *cfg) {

	char *redirect_uri = cfg->redirect_uri;

	if ((redirect_uri != NULL)
			&& (redirect_uri[0] == OIDC_CHAR_FORWARD_SLASH)) {
		// relative redirect uri

		redirect_uri = apr_pstrcat(r->pool, oidc_get_current_url_base(r),
				cfg->redirect_uri, NULL);

		oidc_debug(r, "determined absolute redirect uri: %s", redirect_uri);
	}
	return redirect_uri;
}
