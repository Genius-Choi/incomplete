static void ice_on_ice_complete(pj_ice_strans *ice_st, 
                                pj_ice_strans_op op,
                                pj_status_t result)
{
    struct transport_ice *tp_ice;
    ice_listener *il;

    tp_ice = (struct transport_ice*) pj_ice_strans_get_user_data(ice_st);
    if (!tp_ice) {
        /* Destroy on progress */
        return;
    }

    /* Set the flag indicating that local candidate gathering is completed */
    if (op == PJ_ICE_STRANS_OP_INIT && result == PJ_SUCCESS)
        tp_ice->end_of_cand = PJ_TRUE;

    pj_perror(5, tp_ice->base.name, result, "ICE operation complete"
              " (op=%d%s)", op,
              (op==PJ_ICE_STRANS_OP_INIT? "/initialization" :
              (op==PJ_ICE_STRANS_OP_NEGOTIATION? "/negotiation":"")));

    /* Notify application */
    if (tp_ice->cb.on_ice_complete)
        (*tp_ice->cb.on_ice_complete)(&tp_ice->base, op, result);

    for (il=tp_ice->listener.next; il!=&tp_ice->listener; il=il->next) {
        if (il->cb.on_ice_complete2) {
            (*il->cb.on_ice_complete2)(&tp_ice->base, op, result,
                                       il->user_data);
        } else if (il->cb.on_ice_complete) {
            (*il->cb.on_ice_complete)(&tp_ice->base, op, result);
        }
    }
}
