static void destroy_srtp_ctx(transport_srtp *p_srtp, srtp_context *ctx)
{
    srtp_err_status_t err;

    if (ctx->srtp_rx_ctx) {
        err = srtp_dealloc(ctx->srtp_rx_ctx);
        if (err != srtp_err_status_ok) {
            PJ_LOG(4, (p_srtp->pool->obj_name,
                       "Failed to dealloc RX SRTP context: %s",
                       get_libsrtp_errstr(err)));
        }
    }
    if (ctx->srtp_tx_ctx) {
        err = srtp_dealloc(ctx->srtp_tx_ctx);
        if (err != srtp_err_status_ok) {
            PJ_LOG(4, (p_srtp->pool->obj_name,
                       "Failed to dealloc TX SRTP context: %s",
                       get_libsrtp_errstr(err)));
        }
    }
    ctx->srtp_rx_ctx = NULL;
    ctx->srtp_tx_ctx = NULL;

    pj_bzero(&ctx->rx_policy, sizeof(ctx->rx_policy));
    pj_bzero(&ctx->tx_policy, sizeof(ctx->tx_policy));
}
