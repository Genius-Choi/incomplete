rec_parse_field_name_str (const char *str)
{
  rec_parser_t parser;
  char *field_name = NULL;
  char *str2;
  size_t str_size;

  /* Make sure the input string ends with a colon character.  */
  str_size = strlen (str);
  str2 = malloc (str_size + 2);
  if (!str2)
    /* Out of memory.  */
    return NULL;

  memcpy (str2, str, str_size);
  if (str_size > 0 && str2[str_size - 1] == ':')
    str2[str_size] = '\0';
  else
    {
      str2[str_size] = ':';
      str2[str_size + 1] = '\0';
    }

  parser = rec_parser_new_str (str2, "dummy");
  if (!rec_parse_field_name (parser, &field_name))
    field_name = NULL;

  if (!rec_parser_eof (parser))
    {
      /* There is additional stuff after the field name.  */
      free (field_name);
      field_name = NULL;
    }

  rec_parser_destroy (parser);
  free (str2);

  return field_name;
}
