static void mg_tun_do_reconnect(struct mg_tun_client *client) {
  struct mg_connection *dc;
  struct mg_connect_opts opts;
  memset(&opts, 0, sizeof(opts));
#if MG_ENABLE_SSL
  opts.ssl_cert = client->ssl.ssl_cert;
  opts.ssl_key = client->ssl.ssl_key;
  opts.ssl_ca_cert = client->ssl.ssl_ca_cert;
#endif
  /* HTTP/Websocket listener */
  if ((dc = mg_connect_ws_opt(client->mgr, MG_CB(mg_tun_client_handler, client),
                              opts, client->disp_url, MG_TUN_PROTO_NAME,
                              NULL)) == NULL) {
    LOG(LL_ERROR,
        ("Cannot connect to WS server on addr [%s]\n", client->disp_url));
    return;
  }

  client->disp = dc;
#if !MG_ENABLE_CALLBACK_USERDATA
  dc->user_data = client;
#endif
}
