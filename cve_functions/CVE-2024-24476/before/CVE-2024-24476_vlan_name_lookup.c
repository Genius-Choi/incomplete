vlan_name_lookup(const guint id)
{
    hashvlan_t *tp;
    vlan_t *vlan;

    tp = (hashvlan_t *)wmem_map_lookup(vlan_hash_table, GUINT_TO_POINTER(id));
    if (tp == NULL) {
        tp = wmem_new(addr_resolv_scope, hashvlan_t);
        wmem_map_insert(vlan_hash_table, GUINT_TO_POINTER(id), tp);
    } else {
        return tp->name;
    }

    /* fill in a new entry */

    tp->id = id;

    if ( (vlan = get_vlannamebyid(id)) == NULL) {
        /* unknown name */
        snprintf(tp->name, MAXVLANNAMELEN, "<%u>", id);

    } else {
        (void) g_strlcpy(tp->name, vlan->name, MAXVLANNAMELEN);
    }

    return tp->name;

} /* vlan_name_lookup */
