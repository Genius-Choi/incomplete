initialize_ethers(void)
{
    ether_t *eth;
    guint    mask = 0;

    /* hash table initialization */
    ws_assert(wka_hashtable == NULL);
    wka_hashtable   = wmem_map_new(addr_resolv_scope, eth_addr_hash, eth_addr_cmp);
    ws_assert(manuf_hashtable == NULL);
    manuf_hashtable = wmem_map_new(addr_resolv_scope, g_direct_hash, g_direct_equal);
    ws_assert(eth_hashtable == NULL);
    eth_hashtable   = wmem_map_new(addr_resolv_scope, eth_addr_hash, eth_addr_cmp);

    /* Compute the pathname of the ethers file. */
    if (g_ethers_path == NULL) {
        g_ethers_path = g_build_filename(get_systemfile_dir(), ENAME_ETHERS, NULL);
    }

    /* Set g_pethers_path here, but don't actually do anything
     * with it. It's used in get_ethbyaddr().
     */
    if (g_pethers_path == NULL) {
        /* Check profile directory before personal configuration */
        g_pethers_path = get_persconffile_path(ENAME_ETHERS, TRUE);
        if (!file_exists(g_pethers_path)) {
            g_free(g_pethers_path);
            g_pethers_path = get_persconffile_path(ENAME_ETHERS, FALSE);
        }
    }

    /* Compute the pathname of the global manuf file */
    if (g_manuf_path == NULL)
        g_manuf_path = get_datafile_path(ENAME_MANUF);
    /* Read it and initialize the hash table */
    if (file_exists(g_manuf_path)) {
        set_ethent(g_manuf_path);
        while ((eth = get_ethent(&mask, TRUE))) {
            add_manuf_name(eth->addr, mask, eth->name, eth->longname);
        }
        end_ethent();
    }

    /* Compute the pathname of the personal manuf file */
    if (g_pmanuf_path == NULL) {
        /* Check profile directory before personal configuration */
        g_pmanuf_path = get_persconffile_path(ENAME_MANUF, TRUE);
        if (!file_exists(g_pmanuf_path)) {
            g_free(g_pmanuf_path);
            g_pmanuf_path = get_persconffile_path(ENAME_MANUF, FALSE);
        }
    }
    /* Read it and initialize the hash table */
    if (file_exists(g_pmanuf_path)) {
        set_ethent(g_pmanuf_path);
        while ((eth = get_ethent(&mask, TRUE))) {
            add_manuf_name(eth->addr, mask, eth->name, eth->longname);
        }
        end_ethent();
    }

    /* Compute the pathname of the wka file */
    if (g_wka_path == NULL)
        g_wka_path = get_datafile_path(ENAME_WKA);

    /* Read it and initialize the hash table */
    set_ethent(g_wka_path);
    while ((eth = get_ethent(&mask, TRUE))) {
        add_manuf_name(eth->addr, mask, eth->name, eth->longname);
    }
    end_ethent();

} /* initialize_ethers */
