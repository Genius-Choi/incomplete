get_ether_name_if_known(const guint8 *addr)
{
    hashether_t *tp;

    /* Initialize ether structs if we're the first
     * ether-related function called */
    if (!gbl_resolv_flags.mac_name)
        return NULL;

    /* eth_name_lookup will create a (resolved) hash entry
     * if it doesn't exist, so it never returns NULL */
    tp = eth_name_lookup(addr, TRUE);

    if (tp->status == HASHETHER_STATUS_RESOLVED_NAME) {
        /* Name is from an ethers file */
        return tp->resolved_name;
    }
    else {
        /* Name was created */
        return NULL;
    }
}
