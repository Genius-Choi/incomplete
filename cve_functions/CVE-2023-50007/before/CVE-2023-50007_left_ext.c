static int left_ext(int wavelet_length, int levels, uint64_t sn)
{
    if (!sn)
        return 0;
    return (pow2(levels) - 1) * (wavelet_length - 2) + mod_pow2(sn, pow2(levels));
}
