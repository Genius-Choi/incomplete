mmsClient_handleFileCloseRequest(
    MmsConnection connection,
    uint8_t* buffer, int bufPos, int maxBufPos,
    uint32_t invokeId,
    ByteBuffer* response)
{
    int32_t frsmId = BerDecoder_decodeInt32(buffer, maxBufPos - bufPos, bufPos);

    MmsFileReadStateMachine* frsm = getFrsm(connection, frsmId);

    if (frsm) {
        if (frsm->obtainRequest)
            frsm->obtainRequest->timeout = Hal_getTimeInMs() + connection->requestTimeout;

        if(frsm->fileHandle){
            FileSystem_closeFile(frsm->fileHandle);
            frsm->fileHandle = NULL;
        }
        frsm->frsmId = 0;
        frsm->obtainRequest = NULL;

        mmsMsg_createFileCloseResponse(invokeId, response);
    }
    else
        mmsMsg_createServiceErrorPdu(invokeId, response, MMS_ERROR_FILE_OTHER);
}
