static QMetaType qDecodeODBCType(SQLSMALLINT sqltype, bool isSigned = true)
{
    int type = QMetaType::UnknownType;
    switch (sqltype) {
    case SQL_DECIMAL:
    case SQL_NUMERIC:
    case SQL_FLOAT: // 24 or 53 bits precision
    case SQL_DOUBLE:// 53 bits
        type = QMetaType::Double;
        break;
    case SQL_REAL:  // 24 bits
        type = QMetaType::Float;
        break;
    case SQL_SMALLINT:
        type = isSigned ? QMetaType::Short : QMetaType::UShort;
        break;
    case SQL_INTEGER:
    case SQL_BIT:
        type = isSigned ? QMetaType::Int : QMetaType::UInt;
        break;
    case SQL_TINYINT:
        type = QMetaType::UInt;
        break;
    case SQL_BIGINT:
        type = isSigned ? QMetaType::LongLong : QMetaType::ULongLong;
        break;
    case SQL_BINARY:
    case SQL_VARBINARY:
    case SQL_LONGVARBINARY:
        type = QMetaType::QByteArray;
        break;
    case SQL_DATE:
    case SQL_TYPE_DATE:
        type = QMetaType::QDate;
        break;
    case SQL_TIME:
    case SQL_TYPE_TIME:
        type = QMetaType::QTime;
        break;
    case SQL_TIMESTAMP:
    case SQL_TYPE_TIMESTAMP:
        type = QMetaType::QDateTime;
        break;
    case SQL_WCHAR:
    case SQL_WVARCHAR:
    case SQL_WLONGVARCHAR:
        type = QMetaType::QString;
        break;
    case SQL_CHAR:
    case SQL_VARCHAR:
#if (ODBCVER >= 0x0350)
    case SQL_GUID:
#endif
    case SQL_LONGVARCHAR:
        type = QMetaType::QString;
        break;
    default:
        type = QMetaType::QByteArray;
        break;
    }
    return QMetaType(type);
}
