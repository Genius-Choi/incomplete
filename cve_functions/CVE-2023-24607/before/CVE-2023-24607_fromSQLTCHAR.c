inline static QString fromSQLTCHAR(const QVarLengthArray<SQLTCHAR>& input, qsizetype size=-1)
{
    QString result;

    // Remove any trailing \0 as some drivers misguidedly append one
    int realsize = qMin(size, input.size());
    if (realsize > 0 && input[realsize-1] == 0)
        realsize--;
    switch(sizeof(SQLTCHAR)) {
        case 1:
            result=QString::fromUtf8((const char *)input.constData(), realsize);
            break;
        case 2:
            result = QString::fromUtf16(reinterpret_cast<const char16_t *>(input.constData()), realsize);
            break;
        case 4:
            result = QString::fromUcs4(reinterpret_cast<const char32_t *>(input.constData()), realsize);
            break;
        default:
            qCritical("sizeof(SQLTCHAR) is %d. Don't know how to handle this.", int(sizeof(SQLTCHAR)));
    }
    return result;
}
