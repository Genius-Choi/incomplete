PJ_DEF(pj_status_t) pjmedia_vid_conf_destroy(pjmedia_vid_conf *vid_conf)
{
    unsigned i;

    PJ_ASSERT_RETURN(vid_conf, PJ_EINVAL);

    /* Destroy clock */
    if (vid_conf->clock) {
	pjmedia_clock_destroy(vid_conf->clock);
	vid_conf->clock = NULL;
    }

    /* Remove any registered ports (at least to cleanup their pool) */
    for (i=0; i < vid_conf->opt.max_slot_cnt; ++i) {
	pjmedia_vid_conf_remove_port(vid_conf, i);
    }

    /* Destroy mutex */
    if (vid_conf->mutex) {
	pj_mutex_destroy(vid_conf->mutex);
	vid_conf->mutex = NULL;
    }

    PJ_LOG(5,(THIS_FILE, "Video conference bridge destroyed"));

    return PJ_SUCCESS;
}
