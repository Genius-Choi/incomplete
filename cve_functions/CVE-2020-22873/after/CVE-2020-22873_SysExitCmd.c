static Jsi_RC SysExitCmd(Jsi_Interp *interp, Jsi_Value *args, Jsi_Value *_this,
    Jsi_Value **ret, Jsi_Func *funcPtr)
{
    int err = 0;
    Jsi_Value *v = NULL;
    Jsi_Number n;
    if (Jsi_ValueGetLength(interp, args) > 0) {
        v = Jsi_ValueArrayIndex(interp, args, 0);
        if (v && Jsi_GetNumberFromValue(interp,v, &n) == JSI_OK)
            err = (int)n;
        else 
            return Jsi_LogError("arg1: expected number 'code'");
    }
    if (interp->onExit && interp->parent) {
        bool b = Jsi_FunctionInvokeBool(interp->parent, interp->onExit, v);
        if (Jsi_InterpGone(interp))
            return JSI_ERROR;
        if (b)
            return JSI_OK;
    }
    if (interp->parent == NULL && interp == interp->mainInterp && interp->debugOpts.isDebugger)
        jsi_DoExit(interp, err); // In debugger, skip memory cleanup.
    else {
        interp->exited = 1;
        interp->exitCode = err;
        return JSI_ERROR;
        /* TODO: cleanup events, etc. */
    }
    return JSI_OK;
}
