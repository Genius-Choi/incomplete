static Jsi_RC SysEncryptCmd_(Jsi_Interp *interp, Jsi_Value *args, Jsi_Value *_this,
    Jsi_Value **ret, Jsi_Func *funcPtr, bool decrypt)
{
    int ilen, klen;
    Jsi_RC rc = JSI_OK;
    const char *key, *str = Jsi_ValueArrayIndexToStr(interp, args, 0, &ilen);
    Jsi_DString dStr = {};
    if (!str || !ilen) 
        return Jsi_LogError("data must be a non-empty string");
    if (decrypt && (ilen%4) != 1) {
        rc = Jsi_LogError("data length incorrect and can not be decrypted");
        goto done;
    }
    key = Jsi_ValueArrayIndexToStr(interp, args, 1, &klen);
    Jsi_DSAppendLen(&dStr, str, ilen);
    rc = Jsi_Encrypt(interp, &dStr, key, klen, decrypt);

    if (rc == JSI_OK)
        Jsi_ValueMakeDStringObject(interp, ret, &dStr);
    else
        Jsi_DSFree(&dStr);
done:
    return rc;
}
