void wcall_i_mcat_changed(struct calling_instance *inst,
			  enum mediamgr_state state)
{
	struct le *le;
	
	info("wcall: mcat changed to: %d inst=%p\n", state, inst);

	if (!inst) {
		warning("wcall_i mcat_changed: no instance\n");
		return;
	}

	lock_write_get(inst->lock);
	le = inst->wcalls.head;
	while(le) {
		struct wcall *wcall = le->data;
		le = le->next;
		lock_rel(inst->lock);
	
		switch(state) {
		case MEDIAMGR_STATE_INCALL:
		case MEDIAMGR_STATE_INVIDEOCALL:
		case MEDIAMGR_STATE_RESUME:
			if (wcall->icall) {
				ICALL_CALL(wcall->icall, media_start);
			}
			break;
		
		case MEDIAMGR_STATE_HOLD:
			if (wcall->icall) {
				ICALL_CALL(wcall->icall, media_stop);
			}
			break;

		case MEDIAMGR_STATE_ERROR:
			if (wcall) {
				wcall_end_internal(wcall);
			}
			break;

		case MEDIAMGR_STATE_NORMAL:
		default:
			//if (wcall->icall) {
			//	ICALL_CALL(wcall->icall, media_stop);
			//}
			break;
		}
		lock_write_get(inst->lock);
	}
	lock_rel(inst->lock);	
}
