static int handle_propsync(struct ecall *ecall, struct econn_message *msg)
{
	int err = 0;

	if (!ecall->devpair &&
	    econn_message_isrequest(msg) &&
	    econn_can_send_propsync(ecall->econn)) {

		err = econn_send_propsync(ecall->econn, true,
					  ecall->props_local);
		if (err) {
			warning("ecall: data_recv:"
				" econn_send_propsync"
				" failed (%m)\n",
				err);
		}
	}

	if (ecall->propsynch) {
		return ecall->propsynch(ecall, msg, ecall->icall.arg);
	}

	if (msg->u.propsync.props) {
		mem_deref(ecall->props_remote);
		ecall->props_remote = mem_ref(msg->u.propsync.props);
	}

	propsync_handler(ecall);

	return err;
}
