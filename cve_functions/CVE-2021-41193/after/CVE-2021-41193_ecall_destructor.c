static void ecall_destructor(void *data)
{
	struct ecall *ecall = data;
	struct iflow *flow = NULL;

#if 1
	info("--------------------------------------\n");
	info("%H\n", ecall_debug, ecall);
	info("--------------------------------------\n");
#endif

	list_unlink(&ecall->le);
	list_unlink(&ecall->ecall_le);

	tmr_cancel(&ecall->dc_tmr);
	tmr_cancel(&ecall->media_start_tmr);
	tmr_cancel(&ecall->connection_tmr);

	tmr_cancel(&ecall->quality.tmr);
	tmr_cancel(&ecall->audio.level.tmr);

	if (ecall->conf_part) {
		//ecall->conf_part->data = NULL;
		mem_deref(ecall->conf_part);
	}
	flow = ecall->flow;
	ecall->flow = NULL;
	IFLOW_CALL(flow, close);
	flow = ecall->oldflow;
	ecall->oldflow = NULL;
	IFLOW_CALL(flow, close);

	mem_deref(ecall->userid_self);
	mem_deref(ecall->userid_peer);
	mem_deref(ecall->clientid_self);
	mem_deref(ecall->clientid_peer);
	mem_deref(ecall->clientid_real);
	mem_deref(ecall->sessid);
	mem_deref(ecall->convid);
	mem_deref(ecall->msys);
	mem_deref(ecall->usrd);

	mem_deref(ecall->props_remote);
	mem_deref(ecall->props_local);
	mem_deref(ecall->keystore);

	mem_deref(ecall->econn);

	mem_deref(ecall->sdp.offer);
	mem_deref(ecall->media_laddr);

	//list_flush(&ecall->audio.level.l);
	
	list_flush(&ecall->tracel);

	/* last thing to do */
	ecall->magic = 0;
}
