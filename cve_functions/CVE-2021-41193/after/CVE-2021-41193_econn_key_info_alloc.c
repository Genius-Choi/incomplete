struct econn_key_info *econn_key_info_alloc(size_t keysz)
{
	struct econn_key_info *key;

	key = mem_zalloc(sizeof(*key), key_destructor);
	if (!key) {
		warning("econn: key_decode_handler: could not alloc key\n");
		return NULL;
	}

	key->data = mem_zalloc(keysz, NULL);
	if (!key->data) {
		warning("econn: key_decode_handler: could not alloc key\n");
		mem_deref(key);
		return NULL;
	}
	key->dlen = keysz;

	return key;
}
