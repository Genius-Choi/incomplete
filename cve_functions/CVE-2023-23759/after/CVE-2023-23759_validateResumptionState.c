static bool validateResumptionState(
    const ResumptionState& resState,
    PskKeyExchangeMode /* mode */,
    ProtocolVersion version,
    CipherSuite cipher) {
  if (resState.version != version) {
    FOLLY_SDT(fizz, resumption_state_ProtocolVersionMismatch);
    VLOG(8) << "Protocol version mismatch, rejecting PSK.";
    return false;
  }

  if (getHashFunction(resState.cipher) != getHashFunction(cipher)) {
    FOLLY_SDT(fizz, resumption_state_HashFunctionMismatch);
    VLOG(8) << "Hash mismatch, rejecting PSK.";
    return false;
  }

  return true;
}
