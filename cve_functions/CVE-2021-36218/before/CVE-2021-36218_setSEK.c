void setSEK(shared_ptr <string> hex_encrypted_SEK) {

    CHECK_STATE(hex_encrypted_SEK);

    vector<char> errMsg(1024, 0);
    int err_status = 0;

    SAFE_UINT8_BUF(encrypted_SEK, BUF_LEN);

    uint64_t len = 0;

    if (!hex2carray(hex_encrypted_SEK->c_str(), &len, encrypted_SEK,
                    BUF_LEN)) {
        throw SGXException(INVALID_HEX, "Invalid encrypted SEK Hex");
    }

    sgx_status_t status = trustedSetSEK(eid, &err_status, errMsg.data(), encrypted_SEK);

    HANDLE_TRUSTED_FUNCTION_ERROR(status, err_status, errMsg.data());


    validate_SEK();


}
