void Filter::onUpstreamHostSelected(Upstream::HostDescriptionConstSharedPtr host,
                                    bool pool_success) {
  if (retry_state_ && host) {
    retry_state_->onHostAttempted(host);
  }

  if (!pool_success) {
    return;
  }

  if (request_vcluster_) {
    // The cluster increases its upstream_rq_total_ counter right before firing this onPoolReady
    // callback. Hence, the upstream request increases the virtual cluster's upstream_rq_total_ stat
    // here.
    request_vcluster_->stats().upstream_rq_total_.inc();
  }
  if (route_stats_context_.has_value()) {
    // The cluster increases its upstream_rq_total_ counter right before firing this onPoolReady
    // callback. Hence, the upstream request increases the route level upstream_rq_total_ stat
    // here.
    route_stats_context_->stats().upstream_rq_total_.inc();
  }
}
