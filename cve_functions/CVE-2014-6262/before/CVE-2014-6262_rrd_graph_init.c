void rrd_graph_init(
    image_desc_t
    *im)
{
    unsigned int i;
    char     *deffont = getenv("RRD_DEFAULT_FONT");
    static PangoFontMap *fontmap = NULL;
    PangoContext *context;

#ifdef HAVE_TZSET
    tzset();
#endif
    im->gdef_map = g_hash_table_new_full(g_str_hash, g_str_equal,g_free,NULL);
    im->rrd_map = g_hash_table_new_full(g_str_hash, g_str_equal,g_free,NULL);
    im->base = 1000;
    im->daemon_addr = NULL;
    im->draw_x_grid = 1;
    im->draw_y_grid = 1;
    im->draw_3d_border = 2;
    im->dynamic_labels = 0;
    im->extra_flags = 0;
    im->font_options = cairo_font_options_create();
    im->forceleftspace = 0;
    im->gdes_c = 0;
    im->gdes = NULL;
    im->graph_antialias = CAIRO_ANTIALIAS_GRAY;
    im->grid_dash_off = 1;
    im->grid_dash_on = 1;
    im->gridfit = 1;
    im->grinfo = (rrd_info_t *) NULL;
    im->grinfo_current = (rrd_info_t *) NULL;
    im->imgformat = IF_PNG;
    im->imginfo = NULL;
    im->lazy = 0;
    im->legenddirection = TOP_DOWN;
    im->legendheight = 0;
    im->legendposition = SOUTH;
    im->legendwidth = 0;
    im->logarithmic = 0;
    im->maxval = DNAN;
    im->minval = 0;
    im->minval = DNAN;
    im->magfact = 1;
    im->prt_c = 0;
    im->rigid = 0;
    im->rendered_image_size = 0;
    im->rendered_image = NULL;
    im->slopemode = 0;
    im->step = 0;
    im->symbol = ' ';
    im->tabwidth = 40.0;
    im->title[0] = '\0';
    im->unitsexponent = 9999;
    im->unitslength = 6;
    im->viewfactor = 1.0;
    im->watermark[0] = '\0';
    im->with_markup = 0;
    im->ximg = 0;
    im->xlab_user.minsec = -1;
    im->xorigin = 0;
    im->xOriginLegend = 0;
    im->xOriginLegendY = 0;
    im->xOriginLegendY2 = 0;
    im->xOriginTitle = 0;
    im->xsize = 400;
    im->ygridstep = DNAN;
    im->yimg = 0;
    im->ylegend[0] = '\0';
    im->second_axis_scale = 0; /* 0 disables it */
    im->second_axis_shift = 0; /* no shift by default */
    im->second_axis_legend[0] = '\0';
    im->second_axis_format[0] = '\0';
    im->primary_axis_format[0] = '\0';
    im->yorigin = 0;
    im->yOriginLegend = 0;
    im->yOriginLegendY = 0;
    im->yOriginLegendY2 = 0;
    im->yOriginTitle = 0;
    im->ysize = 100;
    im->zoom = 1;

    im->surface = cairo_image_surface_create(CAIRO_FORMAT_ARGB32, 10, 10);
    im->cr = cairo_create(im->surface);

    for (i = 0; i < DIM(text_prop); i++) {
        im->text_prop[i].size = -1;
        im->text_prop[i].font_desc = NULL;
        rrd_set_font_desc(im,i, deffont ? deffont : text_prop[i].font,text_prop[i].size);
    }

    if (fontmap == NULL){
        fontmap = pango_cairo_font_map_get_default();
    }

    context =  pango_cairo_font_map_create_context((PangoCairoFontMap*)fontmap);

    pango_cairo_context_set_resolution(context, 100);

    pango_cairo_update_context(im->cr,context);

    im->layout = pango_layout_new(context);
    g_object_unref (context);

//  im->layout = pango_cairo_create_layout(im->cr);


    cairo_font_options_set_hint_style
        (im->font_options, CAIRO_HINT_STYLE_FULL);
    cairo_font_options_set_hint_metrics
        (im->font_options, CAIRO_HINT_METRICS_ON);
    cairo_font_options_set_antialias(im->font_options, CAIRO_ANTIALIAS_GRAY);



    for (i = 0; i < DIM(graph_col); i++)
        im->graph_col[i] = graph_col[i];


}
